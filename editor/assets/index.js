var e,t,n,i,r,s,o,a,l,c,h,u,d,p,f,m,g,v,y,b,w=Object.defineProperty,x=(e,t,n)=>((e,t,n)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var C,S,k,L,E,P,T,A,M,I,_,O,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function D(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function R(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var i=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,i.get?i:{enumerable:!0,get:function(){return e[t]}})}),n}function F(){if(S)return C;function e(e,t,n,i,r,s){return{tag:e,key:t,attrs:n,children:i,text:r,dom:s,domSize:void 0,state:void 0,events:void 0,instance:void 0}}return S=1,e.normalize=function(t){return Array.isArray(t)?e("[",void 0,void 0,e.normalizeChildren(t),void 0,void 0):null==t||"boolean"==typeof t?null:"object"==typeof t?t:e("#",void 0,void 0,String(t),void 0,void 0)},e.normalizeChildren=function(t){var n=[];if(t.length){for(var i=null!=t[0]&&null!=t[0].key,r=1;r<t.length;r++)if((null!=t[r]&&null!=t[r].key)!==i)throw new TypeError("Vnodes must either always have keys or never have keys!");for(r=0;r<t.length;r++)n[r]=e.normalize(t[r])}return n},C=e}function B(){if(L)return k;L=1;var e=F();return k=function(){var t,n=arguments[this],i=this+1;if(null==n?n={}:("object"!=typeof n||null!=n.tag||Array.isArray(n))&&(n={},i=this),arguments.length===i+1)t=arguments[i],Array.isArray(t)||(t=[t]);else for(t=[];i<arguments.length;)t.push(arguments[i++]);return e("",n.key,n,t)},k}function V(){if(P)return E;P=1;var e=F(),t=B(),n=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,i={},r={}.hasOwnProperty;function s(e){for(var t in e)if(r.call(e,t))return!1;return!0}return E=function(o){if(null==o||"string"!=typeof o&&"function"!=typeof o&&"function"!=typeof o.view)throw Error("The selector must be either a string or a component.");var a=t.apply(1,arguments);return"string"==typeof o&&(a.children=e.normalizeChildren(a.children),"["!==o)?function(t,n){var i=n.attrs,o=e.normalizeChildren(n.children),a=r.call(i,"class"),l=a?i.class:i.className;if(n.tag=t.tag,n.attrs=null,n.children=void 0,!s(t.attrs)&&!s(i)){var c={};for(var h in i)r.call(i,h)&&(c[h]=i[h]);i=c}for(var h in t.attrs)r.call(t.attrs,h)&&"className"!==h&&!r.call(i,h)&&(i[h]=t.attrs[h]);for(var h in null==l&&null==t.attrs.className||(i.className=null!=l?null!=t.attrs.className?String(t.attrs.className)+" "+String(l):l:null!=t.attrs.className?t.attrs.className:null),a&&(i.class=null),i)if(r.call(i,h)&&"key"!==h){n.attrs=i;break}return Array.isArray(o)&&1===o.length&&null!=o[0]&&"#"===o[0].tag?n.text=o[0].children:n.children=o,n}(i[o]||function(e){for(var t,r="div",s=[],o={};t=n.exec(e);){var a=t[1],l=t[2];if(""===a&&""!==l)r=l;else if("#"===a)o.id=l;else if("."===a)s.push(l);else if("["===t[3][0]){var c=t[6];c&&(c=c.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4]?s.push(c):o[t[4]]=""===c?c:c||!0}}return s.length>0&&(o.className=s.join(" ")),i[e]={tag:r,attrs:o}}(o),a):(a.tag=o,a)},E}function j(){if(O)return _;O=1;var e=V();return e.trust=function(){if(A)return T;A=1;var e=F();return T=function(t){return null==t&&(t=""),e("<",void 0,void 0,t,void 0,void 0)}}(),e.fragment=function(){if(I)return M;I=1;var e=F(),t=B();return M=function(){var n=t.apply(0,arguments);return n.tag="[",n.children=e.normalizeChildren(n.children),n},M}(),_=e}var H,U,z,W,G,$,Z,q,K,Y,X,J,Q,ee,te,ne,ie,re,se,oe,ae,le,ce,he,ue,de,pe,fe,me,ge,ve,ye,be,we={exports:{}};function xe(){if(U)return H;U=1;var e=function(t){if(!(this instanceof e))throw new Error("Promise must be called with `new`");if("function"!=typeof t)throw new TypeError("executor must be a function");var n=this,i=[],r=[],s=c(i,!0),o=c(r,!1),a=n._instance={resolvers:i,rejectors:r},l="function"==typeof setImmediate?setImmediate:setTimeout;function c(e,t){return function s(c){var u;try{if(!t||null==c||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof(u=c.then))l(function(){t||0!==e.length||console.error("Possible unhandled promise rejection:",c);for(var n=0;n<e.length;n++)e[n](c);i.length=0,r.length=0,a.state=t,a.retry=function(){s(c)}});else{if(c===n)throw new TypeError("Promise can't be resolved w/ itself");h(u.bind(c))}}catch(d){o(d)}}}function h(e){var t=0;function n(e){return function(n){t++>0||e(n)}}var i=n(o);try{e(n(s),i)}catch(r){i(r)}}h(t)};return e.prototype.then=function(t,n){var i,r,s=this._instance;function o(e,t,n,o){t.push(function(t){if("function"!=typeof e)n(t);else try{i(e(t))}catch(s){r&&r(s)}}),"function"==typeof s.retry&&o===s.state&&s.retry()}var a=new e(function(e,t){i=e,r=t});return o(t,s.resolvers,i,!0),o(n,s.rejectors,r,!1),a},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(t){return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})},e.resolve=function(t){return t instanceof e?t:new e(function(e){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.all=function(t){return new e(function(e,n){var i=t.length,r=0,s=[];if(0===t.length)e([]);else for(var o=0;o<t.length;o++)(function(o){function a(t){r++,s[o]=t,r===i&&e(s)}null==t[o]||"object"!=typeof t[o]&&"function"!=typeof t[o]||"function"!=typeof t[o].then?a(t[o]):t[o].then(a,n)})(o)})},e.race=function(t){return new e(function(e,n){for(var i=0;i<t.length;i++)t[i].then(e,n)})},H=e}function Ce(){if(z)return we.exports;z=1;var e=xe();return"undefined"!=typeof window?(void 0===window.Promise?window.Promise=e:window.Promise.prototype.finally||(window.Promise.prototype.finally=e.prototype.finally),we.exports=window.Promise):void 0!==N?(void 0===N.Promise?N.Promise=e:N.Promise.prototype.finally||(N.Promise.prototype.finally=e.prototype.finally),we.exports=N.Promise):we.exports=e,we.exports}function Se(){if(G)return W;G=1;var e=F();return W=function(t){var n,i=t&&t.document,r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function s(e){return e.attrs&&e.attrs.xmlns||r[e.tag]}function o(e,t){if(e.state!==t)throw new Error("`vnode.state` must not be modified")}function a(e){var t=e.state;try{return this.apply(t,arguments)}finally{o(e,t)}}function l(){try{return i.activeElement}catch(e){return null}}function c(e,t,n,i,r,s,o){for(var a=n;a<i;a++){var l=t[a];null!=l&&h(e,l,r,o,s)}}function h(t,n,r,o,l){var u=n.tag;if("string"==typeof u)switch(n.state={},null!=n.attrs&&F(n.attrs,n,r),u){case"#":!function(e,t,n){t.dom=i.createTextNode(t.children),w(e,t.dom,n)}(t,n,l);break;case"<":d(t,n,o,l);break;case"[":!function(e,t,n,r,s){var o=i.createDocumentFragment();if(null!=t.children){var a=t.children;c(o,a,0,a.length,n,null,r)}t.dom=o.firstChild,t.domSize=o.childNodes.length,w(e,o,s)}(t,n,r,o,l);break;default:!function(t,n,r,o,a){var l=n.tag,h=n.attrs,u=h&&h.is;o=s(n)||o;var d=o?u?i.createElementNS(o,l,{is:u}):i.createElementNS(o,l):u?i.createElement(l,{is:u}):i.createElement(l);n.dom=d,null!=h&&function(e,t,n){for(var i in t)P(e,i,null,t[i],n)}(n,h,o);if(w(t,d,a),!x(n)&&(null!=n.text&&(""!==n.text?d.textContent=n.text:n.children=[e("#",void 0,void 0,n.text,void 0,void 0)]),null!=n.children)){var p=n.children;c(d,p,0,p.length,r,null,o),"select"===n.tag&&null!=h&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var n=""+t.value;e.dom.value===n&&-1!==e.dom.selectedIndex||(e.dom.value=n)}"selectedIndex"in t&&P(e,"selectedIndex",null,t.selectedIndex,void 0)}(n,h)}}(t,n,r,o,l)}else!function(t,n,i,r,s){(function(t,n){var i;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(i=t.state.view).$$reentrantLock$$)return;i.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(i=t.tag).$$reentrantLock$$)return;i.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}F(t.state,t,n),null!=t.attrs&&F(t.attrs,t,n);if(t.instance=e.normalize(a.call(t.state.view,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");i.$$reentrantLock$$=null})(n,i),null!=n.instance?(h(t,n.instance,i,r,s),n.dom=n.instance.dom,n.domSize=null!=n.dom?n.instance.domSize:0):n.domSize=0}(t,n,r,o,l)}var u={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function d(e,t,n,r){var s=t.children.match(/^\s*?<(\w+)/im)||[],o=i.createElement(u[s[1]]||"div");"http://www.w3.org/2000/svg"===n?(o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",o=o.firstChild):o.innerHTML=t.children,t.dom=o.firstChild,t.domSize=o.childNodes.length,t.instance=[];for(var a,l=i.createDocumentFragment();a=o.firstChild;)t.instance.push(a),l.appendChild(a);w(e,l,r)}function p(e,t,n,i,r,s){if(t!==n&&(null!=t||null!=n))if(null==t||0===t.length)c(e,n,0,n.length,i,r,s);else if(null==n||0===n.length)C(e,t,0,t.length);else{var o=null!=t[0]&&null!=t[0].key,a=null!=n[0]&&null!=n[0].key,l=0,u=0;if(!o)for(;u<t.length&&null==t[u];)u++;if(!a)for(;l<n.length&&null==n[l];)l++;if(null===a&&null==o)return;if(o!==a)C(e,t,u,t.length),c(e,n,l,n.length,i,r,s);else if(a){for(var d,p,b,w,x,k=t.length-1,L=n.length-1;k>=u&&L>=l&&(b=t[k],w=n[L],b.key===w.key);)b!==w&&f(e,b,w,i,r,s),null!=w.dom&&(r=w.dom),k--,L--;for(;k>=u&&L>=l&&(d=t[u],p=n[l],d.key===p.key);)u++,l++,d!==p&&f(e,d,p,i,v(t,u,r),s);for(;k>=u&&L>=l&&l!==L&&d.key===w.key&&b.key===p.key;)y(e,b,x=v(t,u,r)),b!==p&&f(e,b,p,i,x,s),++l<=--L&&y(e,d,r),d!==w&&f(e,d,w,i,r,s),null!=w.dom&&(r=w.dom),u++,b=t[--k],w=n[L],d=t[u],p=n[l];for(;k>=u&&L>=l&&b.key===w.key;)b!==w&&f(e,b,w,i,r,s),null!=w.dom&&(r=w.dom),L--,b=t[--k],w=n[L];if(l>L)C(e,t,u,k+1);else if(u>k)c(e,n,l,L+1,i,r,s);else{var E,P,T=r,A=L-l+1,M=new Array(A),I=0,_=0,O=2147483647,N=0;for(_=0;_<A;_++)M[_]=-1;for(_=L;_>=l;_--){null==E&&(E=m(t,u,k+1));var D=E[(w=n[_]).key];null!=D&&(O=D<O?D:-1,M[_-l]=D,b=t[D],t[D]=null,b!==w&&f(e,b,w,i,r,s),null!=w.dom&&(r=w.dom),N++)}if(r=T,N!==k-u+1&&C(e,t,u,k+1),0===N)c(e,n,l,L+1,i,r,s);else if(-1===O)for(P=function(e){var t=[0],n=0,i=0,r=0,s=g.length=e.length;for(r=0;r<s;r++)g[r]=e[r];for(r=0;r<s;++r)if(-1!==e[r]){var o=t[t.length-1];if(e[o]<e[r])g[r]=o,t.push(r);else{for(n=0,i=t.length-1;n<i;){var a=(n>>>1)+(i>>>1)+(n&i&1);e[t[a]]<e[r]?n=a+1:i=a}e[r]<e[t[n]]&&(n>0&&(g[r]=t[n-1]),t[n]=r)}}n=t.length,i=t[n-1];for(;n-- >0;)t[n]=i,i=g[i];return g.length=0,t}(M),I=P.length-1,_=L;_>=l;_--)p=n[_],-1===M[_-l]?h(e,p,i,s,r):P[I]===_-l?I--:y(e,p,r),null!=p.dom&&(r=n[_].dom);else for(_=L;_>=l;_--)p=n[_],-1===M[_-l]&&h(e,p,i,s,r),null!=p.dom&&(r=n[_].dom)}}else{var R=t.length<n.length?t.length:n.length;for(l=l<u?l:u;l<R;l++)(d=t[l])===(p=n[l])||null==d&&null==p||(null==d?h(e,p,i,s,v(t,l+1,r)):null==p?S(e,d):f(e,d,p,i,v(t,l+1,r),s));t.length>R&&C(e,t,l,t.length),n.length>R&&c(e,n,l,n.length,i,r,s)}}}function f(t,n,i,r,o,l){var c=n.tag;if(c===i.tag){if(i.state=n.state,i.events=n.events,function(e,t){do{var n;if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate)if(void 0!==(n=a.call(e.attrs.onbeforeupdate,e,t))&&!n)break;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate)if(void 0!==(n=a.call(e.state.onbeforeupdate,e,t))&&!n)break;return!1}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}(i,n))return;if("string"==typeof c)switch(null!=i.attrs&&B(i.attrs,i,r),c){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children);t.dom=e.dom}(n,i);break;case"<":!function(e,t,n,i,r){t.children!==n.children?(k(e,t),d(e,n,i,r)):(n.dom=t.dom,n.domSize=t.domSize,n.instance=t.instance)}(t,n,i,l,o);break;case"[":!function(e,t,n,i,r,s){p(e,t.children,n.children,i,r,s);var o=0,a=n.children;if(n.dom=null,null!=a){for(var l=0;l<a.length;l++){var c=a[l];null!=c&&null!=c.dom&&(null==n.dom&&(n.dom=c.dom),o+=c.domSize||1)}1!==o&&(n.domSize=o)}}(t,n,i,r,o,l);break;default:!function(t,n,i,r){var o=n.dom=t.dom;r=s(n)||r,"textarea"===n.tag&&(null==n.attrs&&(n.attrs={}),null!=n.text&&(n.attrs.value=n.text,n.text=void 0));(function(e,t,n,i){if(null!=n)for(var r in n)P(e,r,t&&t[r],n[r],i);var s;if(null!=t)for(var r in t)null==(s=t[r])||null!=n&&null!=n[r]||T(e,r,s,i)})(n,t.attrs,n.attrs,r),x(n)||(null!=t.text&&null!=n.text&&""!==n.text?t.text.toString()!==n.text.toString()&&(t.dom.firstChild.nodeValue=n.text):(null!=t.text&&(t.children=[e("#",void 0,void 0,t.text,void 0,t.dom.firstChild)]),null!=n.text&&(n.children=[e("#",void 0,void 0,n.text,void 0,void 0)]),p(o,t.children,n.children,i,null,r)))}(n,i,r,l)}else!function(t,n,i,r,s,o){if(i.instance=e.normalize(a.call(i.state.view,i)),i.instance===i)throw Error("A view cannot return the vnode it received as argument");B(i.state,i,r),null!=i.attrs&&B(i.attrs,i,r);null!=i.instance?(null==n.instance?h(t,i.instance,r,o,s):f(t,n.instance,i.instance,r,s,o),i.dom=i.instance.dom,i.domSize=i.instance.domSize):null!=n.instance?(S(t,n.instance),i.dom=void 0,i.domSize=0):(i.dom=n.dom,i.domSize=n.domSize)}(t,n,i,r,o,l)}else S(t,n),h(t,i,r,l,o)}function m(e,t,n){for(var i=Object.create(null);t<n;t++){var r=e[t];if(null!=r){var s=r.key;null!=s&&(i[s]=t)}}return i}var g=[];function v(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function y(e,t,n){var r=i.createDocumentFragment();b(e,r,t),w(e,r,n)}function b(e,t,n){for(;null!=n.dom&&n.dom.parentNode===e;){if("string"!=typeof n.tag){if(null!=(n=n.instance))continue}else if("<"===n.tag)for(var i=0;i<n.instance.length;i++)t.appendChild(n.instance[i]);else if("["!==n.tag)t.appendChild(n.dom);else if(1===n.children.length){if(null!=(n=n.children[0]))continue}else for(i=0;i<n.children.length;i++){var r=n.children[i];null!=r&&b(e,t,r)}break}}function w(e,t,n){null!=n?e.insertBefore(t,n):e.appendChild(t)}function x(e){if(null==e.attrs||null==e.attrs.contenteditable&&null==e.attrs.contentEditable)return!1;var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=e.text||null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted");return!0}function C(e,t,n,i){for(var r=n;r<i;r++){var s=t[r];null!=s&&S(e,s)}}function S(e,t){var n,i,r,s=0,l=t.state;"string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&(null!=(r=a.call(t.state.onbeforeremove,t))&&"function"==typeof r.then&&(s=1,n=r));t.attrs&&"function"==typeof t.attrs.onbeforeremove&&(null!=(r=a.call(t.attrs.onbeforeremove,t))&&"function"==typeof r.then&&(s|=2,i=r));if(o(t,l),s){if(null!=n){var c=function(){1&s&&((s&=2)||h())};n.then(c,c)}if(null!=i){c=function(){2&s&&((s&=1)||h())};i.then(c,c)}}else E(t),L(e,t);function h(){o(t,l),E(t),L(e,t)}}function k(e,t){for(var n=0;n<t.instance.length;n++)e.removeChild(t.instance[n])}function L(e,t){for(;null!=t.dom&&t.dom.parentNode===e;){if("string"!=typeof t.tag){if(null!=(t=t.instance))continue}else if("<"===t.tag)k(e,t);else{if("["!==t.tag&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(1===t.children.length){if(null!=(t=t.children[0]))continue}else for(var n=0;n<t.children.length;n++){var i=t.children[n];null!=i&&L(e,i)}}break}}function E(e){if("string"!=typeof e.tag&&"function"==typeof e.state.onremove&&a.call(e.state.onremove,e),e.attrs&&"function"==typeof e.attrs.onremove&&a.call(e.attrs.onremove,e),"string"!=typeof e.tag)null!=e.instance&&E(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];null!=i&&E(i)}}}function P(e,t,n,r,s){if("key"!==t&&"is"!==t&&null!=r&&!A(t)&&(n!==r||function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===l()||"option"===e.tag&&e.dom.parentNode===i.activeElement}(e,t)||"object"==typeof r)){if("o"===t[0]&&"n"===t[1])return R(e,t,r);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),r);else if("style"===t)N(e.dom,n,r);else if(M(e,t,s)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+r&&e.dom===l())return;if("select"===e.tag&&null!==n&&e.dom.value===""+r)return;if("option"===e.tag&&null!==n&&e.dom.value===""+r)return}"input"===e.tag&&"type"===t?e.dom.setAttribute(t,r):e.dom[t]=r}else"boolean"==typeof r?r?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,r)}}function T(e,t,n,i){if("key"!==t&&"is"!==t&&null!=n&&!A(t))if("o"!==t[0]||"n"!==t[1]||A(t))if("style"===t)N(e.dom,n,null);else if(!M(e,t,i)||"className"===t||"value"===t&&("option"===e.tag||"select"===e.tag&&-1===e.dom.selectedIndex&&e.dom===l())||"input"===e.tag&&"type"===t){var r=t.indexOf(":");-1!==r&&(t=t.slice(r+1)),!1!==n&&e.dom.removeAttribute("className"===t?"class":t)}else e.dom[t]=null;else R(e,t,void 0)}function A(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function M(e,t,n){return void 0===n&&(e.tag.indexOf("-")>-1||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var I=/[A-Z]/g;function _(e){return"-"+e.toLowerCase()}function O(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(I,_)}function N(e,t,n){if(t===n);else if(null==n)e.style.cssText="";else if("object"!=typeof n)e.style.cssText=n;else if(null==t||"object"!=typeof t)for(var i in e.style.cssText="",n){null!=(r=n[i])&&e.style.setProperty(O(i),String(r))}else{for(var i in n){var r;null!=(r=n[i])&&(r=String(r))!==String(t[i])&&e.style.setProperty(O(i),r)}for(var i in t)null!=t[i]&&null==n[i]&&e.style.removeProperty(O(i))}}function D(){this._=n}function R(e,t,n){if(null!=e.events){if(e.events[t]===n)return;null==n||"function"!=typeof n&&"object"!=typeof n?(null!=e.events[t]&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0):(null==e.events[t]&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}else null==n||"function"!=typeof n&&"object"!=typeof n||(e.events=new D,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}function F(e,t,n){"function"==typeof e.oninit&&a.call(e.oninit,t),"function"==typeof e.oncreate&&n.push(a.bind(e.oncreate,t))}function B(e,t,n){"function"==typeof e.onupdate&&n.push(a.bind(e.onupdate,t))}return D.prototype=Object.create(null),D.prototype.handleEvent=function(e){var t,n=this["on"+e.type];"function"==typeof n?t=n.call(e.currentTarget,e):"function"==typeof n.handleEvent&&n.handleEvent(e),this._&&!1!==e.redraw&&(0,this._)(),!1===t&&(e.preventDefault(),e.stopPropagation())},function(t,i,r){if(!t)throw new TypeError("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var s=[],o=l(),a=t.namespaceURI;null==t.vnodes&&(t.textContent=""),i=e.normalizeChildren(Array.isArray(i)?i:[i]);var c=n;try{n="function"==typeof r?r:void 0,p(t,t.vnodes,i,s,null,"http://www.w3.org/1999/xhtml"===a?void 0:a)}finally{n=c}t.vnodes=i,null!=o&&l()!==o&&"function"==typeof o.focus&&o.focus();for(var h=0;h<s.length;h++)s[h]()}},W}function ke(){return Z?$:(Z=1,$=Se()(window))}function Le(){if(X)return Y;X=1;var e=ke();return Y=function(){if(K)return q;K=1;var e=F();return q=function(t,n,i){var r=[],s=!1,o=!1;function a(){if(s)throw new Error("Nested m.redraw.sync() call");s=!0;for(var n=0;n<r.length;n+=2)try{t(r[n],e(r[n+1]),l)}catch(o){i.error(o)}s=!1}function l(){o||(o=!0,n(function(){o=!1,a()}))}return l.sync=a,{mount:function(n,i){if(null!=i&&null==i.view&&"function"!=typeof i)throw new TypeError("m.mount(element, component) expects a component, not a vnode");var s=r.indexOf(n);s>=0&&(r.splice(s,2),t(n,[],l)),null!=i&&(r.push(n,i),t(n,e(i),l))},redraw:l}},q}()(e,requestAnimationFrame,console),Y}function Ee(){return Q||(Q=1,J=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var n in e)i(n,e[n]);return t.join("&");function i(e,n){if(Array.isArray(n))for(var r=0;r<n.length;r++)i(e+"["+r+"]",n[r]);else if("[object Object]"===Object.prototype.toString.call(n))for(var r in n)i(e+"["+r+"]",n[r]);else t.push(encodeURIComponent(e)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}}),J}function Pe(){return te?ee:(te=1,ee=Object.assign||function(e,t){t&&Object.keys(t).forEach(function(n){e[n]=t[n]})})}function Te(){if(ie)return ne;ie=1;var e=Ee(),t=Pe();return ne=function(n,i){if(/:([^\/\.-]+)(\.{3})?:/.test(n))throw new SyntaxError("Template parameter names *must* be separated");if(null==i)return n;var r=n.indexOf("?"),s=n.indexOf("#"),o=s<0?n.length:s,a=r<0?o:r,l=n.slice(0,a),c={};t(c,i);var h=l.replace(/:([^\/\.-]+)(\.{3})?/g,function(e,t,n){return delete c[t],null==i[t]?e:n?i[t]:encodeURIComponent(String(i[t]))}),u=h.indexOf("?"),d=h.indexOf("#"),p=d<0?h.length:d,f=u<0?p:u,m=h.slice(0,f);r>=0&&(m+=n.slice(r,o)),u>=0&&(m+=(r<0?"?":"&")+h.slice(u,p));var g=e(c);return g&&(m+=(r<0&&u<0?"?":"&")+g),s>=0&&(m+=n.slice(s)),d>=0&&(m+=(s<0?"":"&")+h.slice(d)),m}}function Ae(){if(ae)return oe;ae=1;var e=Ce(),t=Le();return oe=function(){if(se)return re;se=1;var e=Te();return re=function(t,n,i){var r=0;function s(e){return new n(e)}function o(t){return function(r,o){"string"!=typeof r?(o=r,r=r.url):null==o&&(o={});var a=new n(function(n,i){t(e(r,o.params),o,function(e){if("function"==typeof o.type)if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t]=new o.type(e[t]);else e=new o.type(e);n(e)},i)});if(!0===o.background)return a;var l=0;function c(){0===--l&&"function"==typeof i&&i()}return function e(t){var n=t.then;return t.constructor=s,t.then=function(){l++;var i=n.apply(t,arguments);return i.then(c,function(e){if(c(),0===l)throw e}),e(i)},t}(a)}}function a(e,t){for(var n in e.headers)if({}.hasOwnProperty.call(e.headers,n)&&t.test(n))return!0;return!1}return s.prototype=n.prototype,s.__proto__=n,{request:o(function(e,n,i,r){var s,o=null!=n.method?n.method.toUpperCase():"GET",l=n.body,c=!(null!=n.serialize&&n.serialize!==JSON.serialize||l instanceof t.FormData),h=n.responseType||("function"==typeof n.extract?"":"json"),u=new t.XMLHttpRequest,d=!1,p=u,f=u.abort;for(var m in u.abort=function(){d=!0,f.call(this)},u.open(o,e,!1!==n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),c&&null!=l&&!a(n,/^content-type$/i)&&u.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof n.deserialize||a(n,/^accept$/i)||u.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(u.withCredentials=n.withCredentials),n.timeout&&(u.timeout=n.timeout),u.responseType=h,n.headers)({}).hasOwnProperty.call(n.headers,m)&&u.setRequestHeader(m,n.headers[m]);u.onreadystatechange=function(t){if(!d&&4===t.target.readyState)try{var s,o=t.target.status>=200&&t.target.status<300||304===t.target.status||/^file:\/\//i.test(e),a=t.target.response;if("json"===h?t.target.responseType||"function"==typeof n.extract||(a=JSON.parse(t.target.responseText)):h&&"text"!==h||null==a&&(a=t.target.responseText),"function"==typeof n.extract?(a=n.extract(t.target,n),o=!0):"function"==typeof n.deserialize&&(a=n.deserialize(a)),o)i(a);else{try{s=t.target.responseText}catch(c){s=a}var l=new Error(s);l.code=t.target.status,l.response=a,r(l)}}catch(c){r(c)}},"function"==typeof n.config&&(u=n.config(u,n,e)||u)!==p&&(s=u.abort,u.abort=function(){d=!0,s.call(this)}),null==l?u.send():"function"==typeof n.serialize?u.send(n.serialize(l)):l instanceof t.FormData?u.send(l):u.send(JSON.stringify(l))}),jsonp:o(function(e,n,i,s){var o=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+r++,a=t.document.createElement("script");t[o]=function(e){delete t[o],a.parentNode.removeChild(a),i(e)},a.onerror=function(){delete t[o],a.parentNode.removeChild(a),s(new Error("JSONP request failed"))},a.src=e+(e.indexOf("?")<0?"?":"&")+encodeURIComponent(n.callbackKey||"callback")+"="+encodeURIComponent(o),t.document.documentElement.appendChild(a)})}},re}()(window,e,t.redraw),oe}function Me(){return ce||(ce=1,le=function(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));for(var t=e.split("&"),n={},i={},r=0;r<t.length;r++){var s=t[r].split("="),o=decodeURIComponent(s[0]),a=2===s.length?decodeURIComponent(s[1]):"";"true"===a?a=!0:"false"===a&&(a=!1);var l=o.split(/\]\[?|\[/),c=i;o.indexOf("[")>-1&&l.pop();for(var h=0;h<l.length;h++){var u=l[h],d=l[h+1],p=""==d||!isNaN(parseInt(d,10));if(""===u)null==n[o=l.slice(0,h).join()]&&(n[o]=Array.isArray(c)?c.length:0),u=n[o]++;else if("__proto__"===u)break;if(h===l.length-1)c[u]=a;else{var f=Object.getOwnPropertyDescriptor(c,u);null!=f&&(f=f.value),null==f&&(c[u]=f=p?[]:{}),c=f}}}return i}),le}function Ie(){if(ue)return he;ue=1;var e=Me();return he=function(t){var n=t.indexOf("?"),i=t.indexOf("#"),r=i<0?t.length:i,s=n<0?r:n,o=t.slice(0,s).replace(/\/{2,}/g,"/");return o?("/"!==o[0]&&(o="/"+o),o.length>1&&"/"===o[o.length-1]&&(o=o.slice(0,-1))):o="/",{path:o,params:n<0?{}:e(t.slice(n+1,r))}}}function _e(){if(me)return fe;me=1;var e=F(),t=V(),n=Ce(),i=Te(),r=Ie(),s=function(){if(pe)return de;pe=1;var e=Ie();return de=function(t){var n=e(t),i=Object.keys(n.params),r=[],s=new RegExp("^"+n.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(e,t,n){return null==t?"\\"+e:(r.push({k:t,r:"..."===n}),"..."===n?"(.*)":"."===n?"([^/]+)\\.":"([^/]+)"+(n||""))})+"$");return function(e){for(var t=0;t<i.length;t++)if(n.params[i[t]]!==e.params[i[t]])return!1;if(!r.length)return s.test(e.path);var o=s.exec(e.path);if(null==o)return!1;for(t=0;t<r.length;t++)e.params[r[t].k]=r[t].r?o[t+1]:decodeURIComponent(o[t+1]);return!0}},de}(),o=Pe(),a={};return fe=function(l,c){var h;function u(e,t,n){if(e=i(e,t),null!=h){h();var r=n?n.state:null,s=n?n.title:null;n&&n.replace?l.history.replaceState(r,s,y.prefix+e):l.history.pushState(r,s,y.prefix+e)}else l.location.href=y.prefix+e}var d,p,f,m,g=a,v=y.SKIP={};function y(t,i,b){if(null==t)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var w,x=0,C=Object.keys(b).map(function(e){if("/"!==e[0])throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:e,component:b[e],check:s(e)}}),S="function"==typeof setImmediate?setImmediate:setTimeout,k=n.resolve(),L=!1;if(h=null,null!=i){var E=r(i);if(!C.some(function(e){return e.check(E)}))throw new ReferenceError("Default route doesn't match any known routes")}function P(){L=!1;var e=l.location.hash;"#"!==y.prefix[0]&&(e=l.location.search+e,"?"!==y.prefix[0]&&"/"!==(e=l.location.pathname+e)[0]&&(e="/"+e));var t=e.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent).slice(y.prefix.length),n=r(t);function s(){if(t===i)throw new Error("Could not resolve default route "+i);u(i,null,{replace:!0})}o(n.params,l.history.state),function e(i){for(;i<C.length;i++)if(C[i].check(n)){var r=C[i].component,o=C[i].route,a=r,l=m=function(s){if(l===m){if(s===v)return e(i+1);d=null==s||"function"!=typeof s.view&&"function"!=typeof s?"div":s,p=n.params,f=t,m=null,g=r.render?r:null,2===x?c.redraw():(x=2,c.redraw.sync())}};return void(r.view||"function"==typeof r?(r={},l(a)):r.onmatch?k.then(function(){return r.onmatch(n.params,t,o)}).then(l,s):l("div"))}s()}(0)}return h=function(){L||(L=!0,S(P))},"function"==typeof l.history.pushState?(w=function(){l.removeEventListener("popstate",h,!1)},l.addEventListener("popstate",h,!1)):"#"===y.prefix[0]&&(h=null,w=function(){l.removeEventListener("hashchange",P,!1)},l.addEventListener("hashchange",P,!1)),c.mount(t,{onbeforeupdate:function(){return!(!(x=x?2:1)||a===g)},oncreate:P,onremove:w,view:function(){if(x&&a!==g){var t=[e(d,p.key,p)];return g&&(t=g.render(t[0])),t}}})}return y.set=function(e,t,n){null!=m&&((n=n||{}).replace=!0),m=null,u(e,t,n)},y.get=function(){return f},y.prefix="#!",y.Link={view:function(e){var n,i,r=e.attrs.options,s={};o(s,e.attrs),s.selector=s.options=s.key=s.oninit=s.oncreate=s.onbeforeupdate=s.onupdate=s.onbeforeremove=s.onremove=null;var a=t(e.attrs.selector||"a",s,e.children);return(a.attrs.disabled=Boolean(a.attrs.disabled))?(a.attrs.href=null,a.attrs["aria-disabled"]="true",a.attrs.onclick=null):(n=a.attrs.onclick,i=a.attrs.href,a.attrs.href=y.prefix+i,a.attrs.onclick=function(e){var t;"function"==typeof n?t=n.call(e.currentTarget,e):null==n||"object"!=typeof n||"function"==typeof n.handleEvent&&n.handleEvent(e),!1===t||e.defaultPrevented||0!==e.button&&0!==e.which&&1!==e.which||e.currentTarget.target&&"_self"!==e.currentTarget.target||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(e.preventDefault(),e.redraw=!1,y.set(i,null,r))}),a}},y.param=function(e){return p&&null!=e?p[e]:p},y},fe}const Oe=D(function(){if(be)return ye;be=1;var e=j(),t=Ae(),n=Le(),i=function(){return e.apply(this,arguments)};return i.m=e,i.trust=e.trust,i.fragment=e.fragment,i.mount=n.mount,i.route=function(){if(ve)return ge;ve=1;var e=Le();return ge=_e()(window,e)}(),i.render=ke(),i.redraw=n.redraw,i.request=t.request,i.jsonp=t.jsonp,i.parseQueryString=Me(),i.buildQueryString=Ee(),i.parsePathname=Ie(),i.buildPathname=Te(),i.vnode=F(),i.PromisePolyfill=xe(),ye=i}());let Ne=(e=class{constructor(e=1,t=0,n=0,i=1,r=0,s=0){this.a=e,this.b=t,this.c=n,this.d=i,this.tx=r,this.ty=s}clone(){return new e(this.a,this.b,this.c,this.d,this.tx,this.ty)}copy(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}invert(){const{a:e,b:t,c:n,d:i,tx:r,ty:s}=this,o=e*i-t*n,a=t*n-e*i;return this.a=i/o,this.b=t/a,this.c=n/a,this.d=e/o,this.tx=(i*r-n*s)/a,this.ty=(t*r-e*s)/o,this}mul(e){const{a:t,b:n,c:i,d:r,tx:s,ty:o}=this,{a:a,b:l,c:c,d:h,tx:u,ty:d}=e;return this.a=t*a+i*l,this.b=n*a+r*l,this.c=t*c+i*h,this.d=n*c+r*h,this.tx=t*u+i*d+s,this.ty=n*u+r*d+o,this}mulWithoutTranslation(e){const{a:t,b:n,c:i,d:r}=this,{a:s,b:o,c:a,d:l}=e;return this.a=t*s+i*o,this.b=n*s+r*o,this.c=t*a+i*l,this.d=n*a+r*l,this}preMul(e){const{a:t,b:n,c:i,d:r,tx:s,ty:o}=e,{a:a,b:l,c:c,d:h,tx:u,ty:d}=this;return this.a=t*a+i*l,this.b=n*a+r*l,this.c=t*c+i*h,this.d=n*c+r*h,this.tx=t*u+i*d+s,this.ty=n*u+r*d+o,this}preMulWithoutTranslation(e){const{a:t,b:n,c:i,d:r}=e,{a:s,b:o,c:a,d:l}=this;return this.a=t*s+i*o,this.b=n*s+r*o,this.c=t*a+i*l,this.d=n*a+r*l,this}translate(e){const{x:t,y:n}=e,{a:i,b:r,c:s,d:o}=this;return this.tx+=i*t+s*n,this.ty+=r*t+o*n,this}preTranslate(e){return this.tx+=e.x,this.ty+=e.y,this}scale(e){return this.a*=e.x,this.b*=e.x,this.c*=e.y,this.d*=e.y,this}scaleScalar(e){return this.a*=e,this.b*=e,this.c*=e,this.d*=e,this}normalize(){const{a:e,b:t,c:n,d:i}=this;let r=e*e+t*t;return r>0&&(r=1/Math.sqrt(r),this.a*=r,this.b*=r),r=n*n+i*i,r>0&&(r=1/Math.sqrt(r),this.c*=r,this.d*=r),this}rotate(t){return this.mul(e.fromRotation(t)),this}skew(e){const t=Math.tan(e*Re);return this.c+=t*this.a,this.d+=t*this.b,this}origin(e){const t=-e.x,n=-e.y;return this.tx+=this.a*t+this.c*n,this.ty+=this.b*t+this.d*n,this}changeBasis(e,t){return void 0===t&&(t=e.clone().invert()),this.preMul(t).mul(e)}ensureMinimumBasisLength(e){const{a:t,b:n,c:i,d:r}=this,s=Math.sqrt(t*t+n*n),o=Math.sqrt(i*i+r*r);if(s<e&&o<e)this.a=e,this.b=0,this.c=0,this.d=e;else if(s<e){const t=e/o;this.a=r*t,this.b=-i*t}else if(o<e){const i=e/s;this.c=-n*i,this.d=t*i}return this}determinant(){const{a:e,b:t,c:n,d:i}=this;return e*i-t*n}equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.tx===e.tx&&this.ty===e.ty}isOrthogonal(e=Be){const{a:t,b:n,c:i,d:r}=this;return Math.abs(t*i+n*r)<=e}isInvertible(){return 0!==this.determinant()}isUniformScale(e=Be){const{a:t,b:n,c:i,d:r}=this;return Math.abs(t*t+n*n-(i*i+r*r))<=e}isMirror(){return this.determinant()<0}isIdentity(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.tx&&0===this.ty}isNaN(){return isNaN(this.a)||isNaN(this.b)||isNaN(this.c)||isNaN(this.d)||isNaN(this.tx)||isNaN(this.ty)}isFinite(){return isFinite(this.a)&&isFinite(this.b)&&isFinite(this.c)&&isFinite(this.d)&&isFinite(this.tx)&&isFinite(this.ty)}isValid(){return"number"==typeof this.a&&"number"==typeof this.b&&"number"==typeof this.c&&"number"==typeof this.d&&"number"==typeof this.tx&&"number"==typeof this.ty&&this.isFinite()}toTransform(){const{a:e,b:t,c:n,d:i,tx:r,ty:s}=this,o=n*n+i*i>1e-7;let a=0,l=0;e*e+t*t>1e-7?(a=Math.atan2(t,e),o&&(l=(a-Math.atan2(-n,i))*Fe,l=Et(l,180),l>90&&(l-=180))):o&&(a=Math.atan2(-n,i));const c=new It(r,s),h=Math.cos(-a),u=Math.sin(-a);return{position:c,rotation:Et(a*Fe,360),scale:new It(e*h-t*u,n*u+i*h),skew:l}}toTransformWithOrigin(e){const t=this.clone().translate(e).toTransform();return t.origin=e.clone(),t}static inverse(e){return e.clone().invert()}static fromTransform(t){const{position:n,rotation:i,scale:r,skew:s,origin:o}=t,a=new e;return n instanceof It&&a.translate(n),"number"==typeof i&&a.rotate(i),"number"==typeof s&&a.skew(s),r instanceof It?a.scale(r):"number"==typeof r&&a.scaleScalar(r),o instanceof It&&a.origin(o),a}static fromTranslation(t){return new e(1,0,0,1,t.x,t.y)}static fromRotation(t){const n=t*Re,i=Math.cos(n),r=Math.sin(n);return new e(i,r,-r,i,0,0)}static fromScale(t){let n,i;return t instanceof It?(n=t.x,i=t.y):(n=t,i=t),new e(n,0,0,i,0,0)}static fromCenterScale(t,n){const{x:i,y:r}=t;let s,o;return n instanceof It?(s=n.x,o=n.y):(s=n,o=n),new e(s,0,0,o,i-i*s,r-r*o)}static fromCenterAndReferencePoints(t,n,i,r){const{allowRotation:s,allowScale:o,rotationIncrement:a}=r,l=n.clone().sub(t),c=i.clone().sub(t);let h=Fe*Math.atan2(l.y,l.x),u=h;s&&(u=Fe*Math.atan2(c.y,c.x),"number"==typeof a&&a>0&&(u=Math.round(u/a)*a));let d=1;o&&(d=s?c.length()/l.length():l.dot(c)/l.dot(l));const p=e.fromTransform({position:t,rotation:h}),f=e.fromTransform({position:t,rotation:u,scale:new It(d,"uniform"===o?d:1)});return p.invert().preMul(f)}static fromCenterAndRotationPoints(t,n,i){const{x:r,y:s}=t,o=Math.atan2(n.y-s,n.x-r),a=Math.atan2(i.y-s,i.x-r)-o,l=Math.cos(a),c=Math.sin(a);return new e(l,c,-c,l,r-r*l+s*c,s-r*c-s*l)}static fromCenterAndQuantizedRotationPoints(t,n,i,r){const{x:s,y:o}=t,a=Math.atan2(n.y-o,n.x-s),l=Math.atan2(i.y-o,i.x-s),c=Math.round((l-a)*Fe/r)*r*Re,h=Math.cos(c),u=Math.sin(c);return new e(h,u,-u,h,s-s*h+o*u,o-s*u-o*h)}static fromCenterAndUniformScalePoints(t,n,i){const{x:r,y:s}=t,o=(i.x-r)/(n.x-r),a=(i.y-s)/(n.y-s),l=Math.min(o,a);return new e(l,0,0,l,r-r*l,s-s*l)}static fromCenterAndNonUniformScalePoints(t,n,i){const{x:r,y:s}=t,o=n.x-r,a=n.y-s,l=0===o?1:(i.x-r)/o,c=0===a?1:(i.y-s)/a;return new e(l,0,0,c,r-r*l,s-s*c)}static fromCenterAndYAxis(t,n){return new e(n.y,-n.x,n.x,n.y,t.x,t.y)}static mul(e,t){return e.clone().mul(t)}static isValid(t){return t instanceof e&&t.isValid()}static fromSVGTransformString(t){const n={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},i=/[\s,]+/,r=new e;let s;return t.split(/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/).forEach(t=>{if(!t.length)return;if(n[t])return void(s=t);const o=t.split(i).map(e=>+e||0);"matrix"===s&&6===o.length?r.mul(new e(o[0],o[1],o[2],o[3],o[4],o[5])):"scale"===s?1===o.length?r.scale(new It(o[0])):2===o.length&&r.scale(new It(o[0],o[1])):"rotate"===s?1===o.length?r.rotate(o[0]):3===o.length&&(r.translate(new It(o[1],o[2])),r.rotate(o[0]),r.translate(new It(-o[1],-o[2]))):"translate"===s?1===o.length?r.translate(new It(o[0],0)):2===o.length&&r.translate(new It(o[0],o[1])):"skewX"===s?1===o.length&&r.mul(new e(1,0,Math.tan(o[0]*Re),1,0,0)):"skewY"===s&&1===o.length&&r.mul(new e(1,Math.tan(o[0]*Re),0,1,0,0))}),r}},e.displayName="AffineMatrix",e.indentity=Object.freeze(new e),e.fromTranslationPoints=(t,n)=>new e(1,0,0,1,n.x-t.x,n.y-t.y),e),De=(t=class{constructor(e=new It,t=new It){this.min=e,this.max=t}clone(){return new t(this.min.clone(),this.max.clone())}isValid(){return this.min.isValid()&&this.max.isValid()}center(){return this.min.clone().add(this.max).mulScalar(.5)}size(){return this.max.clone().sub(this.min)}width(){return this.max.x-this.min.x}height(){return this.max.y-this.min.y}area(){const{min:e,max:t}=this;return(t.x-e.x)*(t.y-e.y)}isFinite(){return this.min.isFinite()&&this.max.isFinite()}canonicalize(){const{x:e,y:t}=this.min,{x:n,y:i}=this.max;return this.min.set(Math.min(e,n),Math.min(t,i)),this.max.set(Math.max(e,n),Math.max(t,i)),this}expandToIncludePoint(e){return this.min.min(e),this.max.max(e),this}expandToIncludeBoundingBox(e){return this.expandToIncludePoint(e.min).expandToIncludePoint(e.max)}expandScalar(e){return this.min.subScalar(e),this.max.addScalar(e),this}containsPoint(e){const{x:t,y:n}=e;return t>=this.min.x&&t<=this.max.x&&n>=this.min.y&&n<=this.max.y}_almostContainsPoint(e){const{x:t,y:n}=e;return gs(t,this.min.x)&&vs(t,this.max.x)&&gs(n,this.min.y)&&vs(n,this.max.y)}containsBoundingBox(e){const{min:t,max:n}=e;return t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y}overlapsBoundingBox(e){const{min:t,max:n}=e;return n.x>=this.min.x&&t.x<=this.max.x&&n.y>=this.min.y&&t.y<=this.max.y}static fromPoints(e){Ps(e.length>0,"A least one point is required to construct a bounding box");const n=new t(e[0].clone(),e[0].clone());for(let t=1,i=e.length;t<i;++t)n.expandToIncludePoint(e[t]);return n}static booleanIntersect(e){Ps(e.length>1,"At least two bounding boxes are required to perform a boolean intersection");let n=-1/0,i=-1/0,r=1/0,s=1/0;for(const t of e){if(n=Math.max(n,t.min.x),r=Math.min(r,t.max.x),n>r)return;if(i=Math.max(i,t.min.y),s=Math.min(s,t.max.y),i>s)return}return new t(new It(n,i),new It(r,s))}static isValid(e){return e instanceof t&&e.isValid()}},t.displayName="BoundingBox",t);const Re=Math.PI/180,Fe=180/Math.PI,Be=.001,Ve=1e-6,je=1e-7,He=Math.PI,Ue=2*He,ze=Ue,We=2*Number.EPSILON,Ge=1e-7,$e=1e-7,Ze=Object.freeze(Object.defineProperty({__proto__:null,APPROXIMATE_EPSILON:$e,DEFAULT_EPSILON:We,DEFAULT_PRECISION:6,DEFAULT_TOLERANCE:Be,DEGREES_PER_RADIAN:Fe,GEOMETRIC_TOLERANCE:je,MINIMUM_TOLERANCE:Ve,PATH_TIME_EPSILON:Ge,PI:He,RADIANS_PER_DEGREE:Re,TAU:ze,TWO_PI:Ue},Symbol.toStringTag,{value:"Module"}));var qe,Ke={exports:{}};function Ye(){return qe||(qe=1,function(e,t){function n(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function r(e,t){var r=new n(e),s=t&&t.state,o=r.next;return o.int32=function(){return 4294967296*r.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=r:this.alea=r}(0,Ke)),Ke.exports}var Xe,Je={exports:{}};var Qe,et={exports:{}};var tt,nt={exports:{}};var it,rt={exports:{}};var st,ot={exports:{}};var at={exports:{}};const lt=R(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var ct,ht,ut,dt=at.exports;function pt(){return ct||(ct=1,e=at,function(t,n,i){var r,s=256,o="random",a=i.pow(s,6),l=i.pow(2,52),c=2*l,h=255;function u(e,h,u){var v=[],y=m(f((h=1==h?{entropy:!0}:h||{}).entropy?[e,g(n)]:null==e?function(){try{var e;return r&&(e=r.randomBytes)?e=e(s):(e=new Uint8Array(s),(t.crypto||t.msCrypto).getRandomValues(e)),g(e)}catch(a){var i=t.navigator,o=i&&i.plugins;return[+new Date,t,o,t.screen,g(n)]}}():e,3),v),b=new d(v),w=function(){for(var e=b.g(6),t=a,n=0;e<l;)e=(e+n)*s,t*=s,n=b.g(1);for(;e>=c;)e/=2,t/=2,n>>>=1;return(e+n)/t};return w.int32=function(){return 0|b.g(4)},w.quick=function(){return b.g(4)/4294967296},w.double=w,m(g(b.S),n),(h.pass||u||function(e,t,n,r){return r&&(r.S&&p(r,b),e.state=function(){return p(b,{})}),n?(i[o]=e,t):e})(w,y,"global"in h?h.global:this==i,h.state)}function d(e){var t,n=e.length,i=this,r=0,o=i.i=i.j=0,a=i.S=[];for(n||(e=[n++]);r<s;)a[r]=r++;for(r=0;r<s;r++)a[r]=a[o=h&o+e[r%n]+(t=a[r])],a[o]=t;(i.g=function(e){for(var t,n=0,r=i.i,o=i.j,a=i.S;e--;)t=a[r=h&r+1],n=n*s+a[h&(a[r]=a[o=h&o+t])+(a[o]=t)];return i.i=r,i.j=o,n})(s)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function f(e,t){var n,i=[],r=typeof e;if(t&&"object"==r)for(n in e)try{i.push(f(e[n],t-1))}catch(s){}return i.length?i:"string"==r?e:e+"\0"}function m(e,t){for(var n,i=e+"",r=0;r<i.length;)t[h&r]=h&(n^=19*t[h&r])+i.charCodeAt(r++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(m(i.random(),n),e.exports){e.exports=u;try{r=lt}catch(v){}}else i["seed"+o]=u}("undefined"!=typeof self?self:dt,[],Math)),at.exports;var e}var ft=function(){if(ut)return ht;ut=1;var e=Ye(),t=(Xe||(Xe=1,function(e,t){function n(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var i=0;i<n.length+64;i++)t.x^=0|n.charCodeAt(i),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function r(e,t){var r=new n(e),s=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=r:this.xor128=r}(0,Je)),Je.exports),n=(Qe||(Qe=1,function(e,t){function n(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var i=0;i<n.length+64;i++)t.x^=0|n.charCodeAt(i),i==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function r(e,t){var r=new n(e),s=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=r:this.xorwow=r}(0,et)),et.exports),i=(tt||(tt=1,function(e,t){function n(e){var t=this;t.next=function(){var e,n,i=t.x,r=t.i;return e=i[r],n=(e^=e>>>7)^e<<24,n^=(e=i[r+1&7])^e>>>10,n^=(e=i[r+3&7])^e>>>3,n^=(e=i[r+4&7])^e<<7,e=i[r+7&7],n^=(e^=e<<13)^e<<9,i[r]=n,t.i=r+1&7,n},function(e,t){var n,i=[];if(t===(0|t))i[0]=t;else for(t=""+t,n=0;n<t.length;++n)i[7&n]=i[7&n]<<15^t.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],e.x=i,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function r(e,t){null==e&&(e=+new Date);var r=new n(e),s=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,s&&(s.x&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=r:this.xorshift7=r}(0,nt)),nt.exports),r=(it||(it=1,function(e,t){function n(e){var t=this;t.next=function(){var e,n,i=t.w,r=t.X,s=t.i;return t.w=i=i+1640531527|0,n=r[s+34&127],e=r[s=s+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=r[s]=n^e,t.i=s,n+(i^i>>>16)|0},function(e,t){var n,i,r,s,o,a=[],l=128;for(t===(0|t)?(i=t,t=null):(t+="\0",i=0,l=Math.max(l,t.length)),r=0,s=-32;s<l;++s)t&&(i^=t.charCodeAt((s+32)%t.length)),0===s&&(o=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(o=o+1640531527|0,r=0==(n=a[127&s]^=i+o)?r+1:0);for(r>=128&&(a[127&(t&&t.length||0)]=-1),r=127,s=512;s>0;--s)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,a[r]=i^n;e.w=o,e.X=a,e.i=r}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function r(e,t){null==e&&(e=+new Date);var r=new n(e),s=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,s&&(s.X&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=r:this.xor4096=r}(0,rt)),rt.exports),s=(st||(st=1,function(e,t){function n(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,i=t.d,r=t.a;return e=e<<25^e>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-i|0,t.d=i<<16^n>>>16^r,t.a=r-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var i=0;i<n.length+20;i++)t.b^=0|n.charCodeAt(i),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function r(e,t){var r=new n(e),s=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=r:this.tychei=r}(0,ot)),ot.exports),o=pt();return o.alea=e,o.xor128=t,o.xorwow=n,o.xorshift7=i,o.xor4096=r,o.tychei=s,ht=o}();const mt=D(ft);function gt(){const e=new Uint8Array(256);return window.crypto.getRandomValues(e),String.fromCharCode(...e)}class vt{constructor(e=gt()){this._rng=mt(e)}seed(e=gt()){this._rng=mt(e)}random(e,t){return void 0===t?(t=void 0===e?1:e,e=0):void 0===e&&(e=0),e+this._rng()*(t-e)}randomInt(e,t){if(void 0===t?(t=void 0===e?0:e,e=0):void 0===e&&(e=0),(e|=0)===(t|=0))return e;const n=Math.abs(this._rng.int32());return t>0?e+n%(t-e+1):n}randomDirection(e=1){return new It(e,0).rotateRadians(this.random(ze))}randomPointInDisk(e=1){return this.randomDirection(e*Math.sqrt(this._rng()))}}const yt=new vt,bt=e=>yt.seed(e),wt=Object.freeze(Object.defineProperty({__proto__:null,RandomGenerator:vt,_seedGlobalRandom:bt,random:(e,t)=>yt.random(e,t),randomDirection:e=>yt.randomDirection(e),randomInt:(e,t)=>yt.randomInt(e,t),randomPointInDisk:e=>yt.randomPointInDisk(e)},Symbol.toStringTag,{value:"Module"})),xt=(e,t,n)=>e+(t-e)*n,Ct=(e,t,n)=>e<t?t:e>n?n:e,St=e=>e<0?0:e>1?1:e,kt=(e,t,n)=>(n=St((n-e)/(t-e)))*n*(3-2*n),Lt=e=>e-(0|e),Et=(e,t)=>{let n=e%t;return n<0&&(n+=t),n===t?0:n},Pt=(e,t,n)=>{const i=Math.abs(t-e)%n;return i>n/2?n-i:i},Tt=(e,t)=>Pt(e,t,360),At=(e,t)=>0===t?e:Math.round(e/t)*t,Mt=Object.freeze(Object.defineProperty({__proto__:null,angularDistance:Tt,clamp:Ct,fract:Lt,mix:xt,mixAngles:(e,t,n)=>{let i=t-e;return Math.abs(i)>180&&(i-=360),e+i*n},mixCyclic:(e,t,n,i)=>{let r=t-e;return 2*Math.abs(r)>i&&(r-=i),e+r*n},modulo:Et,moduloDistance:Pt,roundToMultiple:At,saturate:St,smoothstep:kt},Symbol.toStringTag,{value:"Module"}));let It=((n=class{constructor(e,t){this.x=e||0,this.y=void 0===t?this.x:t}clone(){return new n(this.x,this.y)}isValid(){return"number"==typeof this.x&&"number"==typeof this.y&&this.isFinite()}set(e,t){return this.x=e,this.y=t,this}copy(e){return this.x=e.x,this.y=e.y,this}affineTransform(e){const{x:t,y:n}=this,{a:i,b:r,c:s,d:o,tx:a,ty:l}=e;return this.x=i*t+s*n+a,this.y=r*t+o*n+l,this}affineTransformWithoutTranslation(e){const{x:t,y:n}=this,{a:i,b:r,c:s,d:o}=e;return this.x=i*t+s*n,this.y=r*t+o*n,this}transform(e){return this.affineTransform(Ne.fromTransform(e))}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}mul(e){return this.x*=e.x,this.y*=e.y,this}mulScalar(e){return this.x*=e,this.y*=e,this}div(e){return this.x/=e.x,this.y/=e.y,this}divScalar(e){return this.x/=e,this.y/=e,this}negate(){return this.x*=-1,this.y*=-1,this}equals(e){return this.x===e.x&&this.y===e.y}_almostEquals(e,t){return fs(this.x,e.x,t)&&fs(this.y,e.y,t)}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToFixed(e){const t=Math.pow(10,e),n=1/t;return this.x=Math.round(this.x*t)*n,this.y=Math.round(this.y*t)*n,this}roundToMultiple(e){if(0===e)return this;const t=1/e;return this.x=Math.round(this.x*t)*e,this.y=Math.round(this.y*t)*e,this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}minScalar(e){return this.x=Math.min(this.x,e),this.y=Math.min(this.y,e),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}maxScalar(e){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),this}mix(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}normalize(){const e=this.lengthSquared();return e>0&&this.mulScalar(1/Math.sqrt(e)),this}rotate(e){return this.rotateRadians(e*Re)}rotateRadians(e){const t=Math.cos(e),n=Math.sin(e),{x:i,y:r}=this;return this.x=i*t-r*n,this.y=i*n+r*t,this}rotate90(){const{x:e,y:t}=this;return this.x=-t,this.y=e,this}rotateNeg90(){const{x:e,y:t}=this;return this.x=t,this.y=-e,this}projectOnto(e){const t=e.lengthSquared();if(t>0){const n=this.dot(e)/t;this.x=e.x*n,this.y=e.y*n}return this}closestPoint(e){return{position:this}}angle(){return this.angleRadians()*Fe}angleRadians(){return Math.atan2(this.y,this.x)}isClockwiseFrom(e){const t=-e.y,n=e.x;return this.x*t+this.y*n>0}length(){const{x:e,y:t}=this;return Math.sqrt(e*e+t*t)}lengthSquared(){const{x:e,y:t}=this;return e*e+t*t}distance(e){const t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)}distanceSquared(e){const t=e.x-this.x,n=e.y-this.y;return t*t+n*n}isZero(){return 0===this.x&&0===this.y}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)}static add(e,t){return e.clone().add(t)}static sub(e,t){return e.clone().sub(t)}static mul(e,t){return e.clone().mul(t)}static div(e,t){return e.clone().div(t)}static min(e,t){return e.clone().min(t)}static max(e,t){return e.clone().max(t)}static mix(e,t,n){return e.clone().mix(t,n)}static dot(e,t){return e.dot(t)}static fromAngle(e){return n.fromAngleRadians(e*Re)}static fromAngleRadians(e){return new n(Math.cos(e),Math.sin(e))}static isValid(e){return e instanceof n&&e.isValid()}}).displayName="Vec",n);function _t(e){return null==e?"":ks(e)||e instanceof Dt||e instanceof Nt?e:e instanceof Ot?e.items:Ls(e)?e.flatMap(_t):Wr(e)}let Ot=(i=class{constructor(...e){return this.items=e.flatMap(_t),this.canonicalize(),new Proxy(this,{get:function(e,t,n){if("string"==typeof t){const n=+t;if(isFinite(n)&&n>=0)return e.charAt(n)}return Reflect.get(e,t,n)}})}append(e){const t=this.items.length-1;return t>=0&&ks(e)&&ks(this.items[t])?this.items[t]+=e:this.items.push(e),this}clone(){const e=this.items.map(e=>ks(e)?e:e.clone());return new i(e)}_cloneAndMapOverStrings(e){const t=this.items.map(t=>ks(t)?e(t):t.clone());return new i(t)}canonicalize(){const e=this.items,t=[];let n="";for(let i of e)ks(i)?n+=i:(n.length>0&&(t.push(n),n=""),t.push(i));return n.length>0&&t.push(n),this.items=t,this}equals(e){return e===this||(ks(e)?0===this.items.length&&""===e||1===this.items.length&&this.items[0]===e:e instanceof i&&(e.items.length===this.items.length&&this.items.every((t,n)=>{const i=e.items[n];return ks(t)?t===i:t instanceof Dt&&i instanceof Dt?t.index===i.index:t instanceof Nt&&i instanceof Nt&&t.source===i.source})))}trim(){const e=this.clone().canonicalize();if(0===e.items.length)return e;const t=e.items[0];ks(t)&&(e.items[0]=t.trimStart());const n=e.items[e.items.length-1];return ks(n)&&(e.items[e.items.length-1]=n.trimEnd()),e}trimStart(){const e=this.clone().canonicalize();if(0===e.items.length)return e;const t=e.items[0];return ks(t)&&(e.items[0]=t.trimStart()),e}trimEnd(){const e=this.clone().canonicalize();if(0===e.items.length)return e;const t=e.items[e.items.length-1];return ks(t)&&(e.items[e.items.length-1]=t.trimEnd()),e}toLowerCase(){return this._cloneAndMapOverStrings(e=>e.toLowerCase())}toUpperCase(){return this._cloneAndMapOverStrings(e=>e.toUpperCase())}toLocaleLowerCase(e){return this._cloneAndMapOverStrings(t=>t.toLocaleLowerCase(e))}toLocaleUpperCase(e){return this._cloneAndMapOverStrings(t=>t.toLocaleUpperCase(e))}charCodeAt(e){return this.toString().charCodeAt(e)}slice(e,t){const n=this.clone().canonicalize(),r=n.length;if(e>=r)return new i;if(e<0&&(e=Math.max(e+r,0)),(void 0===t||t>r)&&(t=r),t<0&&(t=Math.max(t+r,0)),t<=e)return new i;const s=[];let o=0,a="";for(let i of n)o>=e&&o<t&&(ks(i)?a+=i:(a.length&&(s.push(a),a=""),s.push(i))),o++;return a.length&&s.push(a),n.items=s,n}substr(e,t){return void 0===t&&(t=this.length),this.slice(e,e+t)}charAt(e){let t=0;for(let n of this){if(e===t)return new i(n);t++}}replace(e,t){return this._cloneAndMapOverStrings(n=>n.replace(e,t))}toString(){return this.items.join("")}split(e){if(""===e)return Array.from(this).map(e=>new i(e));const t=[];let n=new i;for(let r of this.items)if(ks(r)){const s=r.split(e);for(let e=0;e<s.length;e++)e>0&&(t.push(n),n=new i),n.append(s[e])}else n.append(r);return n.items.length>0&&t.push(n),t}startsWith(e,t){return this.toString().startsWith(e,t)}endsWith(e,t){return this.toString().endsWith(e,t)}get length(){return this.toString().length}*[Symbol.iterator](){for(let e of this.items)if(ks(e))for(let t of e)yield t;else yield e}},i.displayName="RichText",i),Nt=((r=class{constructor(e){this.source=e}clone(){return new r(this.source)}toString(){return"_"}}).displayName="RichTextSymbol",r),Dt=((s=class{constructor(e){this.index=e}clone(){return new s(this.index)}toString(){return"_"}}).displayName="RichTextGlyph",s);class Rt{constructor(e,t,n){this.message=e,this.logLevel=t,this.line=n}withLineNumber(e){return new Rt(this.message,this.logLevel,e)}static fromArgs(e,t){let n=t;return 1===t.length&&(n=t[0]),new Rt(n,e)}toString(){return String(this.message)}}const Ft=new class{constructor(){this.subscribers=[]}subscribe(e){this.subscribers.push(e)}unsubscribe(e){if(e!==this.subscribers.pop())throw"Tried to unsubscribe an inactive subscriber!"}activeSubscriber(){return this.subscribers[this.subscribers.length-1]}consoleMessage(e){const t=this.activeSubscriber();t?t(e):console.warn("Message logged, but no one was listening! ",e)}console(e,...t){const n=Rt.fromArgs(e,t);this.consoleMessage(n)}consoleLog(...e){this.console("log",...e)}consoleInfo(...e){this.console("info",...e)}consoleWarn(...e){this.console("warn",...e)}consoleWarnGlobal(...e){this.console("warn-global",...e)}consoleError(...e){this.console("error",...e)}consoleGeometry(...e){this.console("geometry",...e)}consoleGuide(...e){this.console("guide",...e)}},Bt=Math.pow(2,-65),Vt=(e,t,n=0)=>{const i=jt(e);if(0===i)return[];if(1===i){if(n>=64)return[(e[0].x+e[t].x)/2];if(Ht(e,t))return[Ut(e,t)]}const[r,s]=zt(e,.5),o=Vt(r,t,n+1),a=Vt(s,t,n+1);return o.concat(a)},jt=e=>{let t=0,n=Math.sign(e[0].y);for(let i=1;i<e.length;++i){const r=Math.sign(e[i].y);r!==n&&(++t,n=r)}return t},Ht=(e,t)=>{const n=e[0].y-e[t].y,i=e[t].x-e[0].x,r=e[0].x*e[t].y-e[t].x*e[0].y;let s=0,o=0;for(let m=1;m<t;m++){const t=n*e[m].x+i*e[m].y+r;t>s?s=t:t<o&&(o=t)}let a=n,l=i,c=r-s,h=0*l-1*a,u=1/h;const d=(1*c-0*l)*u;a=n,l=i,c=r-o,h=0*l-1*a,u=1/h;const p=(1*c-0*l)*u,f=Math.min(d,p);return Math.max(d,p)-f<Bt},Ut=(e,t)=>{const n=e[0],i=e[t],r=i.x-n.x,s=i.y-n.y,o=-s;return(r*n.y-s*n.x)/o},zt=(e,t)=>{const n=new Array(e.length),i=e.length-1;n[0]=new Array(e.length);for(let o=0;o<=i;++o)n[0][o]=e[o].clone();for(let o=1;o<=i;++o){const e=i-o+1;n[o]=new Array(e);for(let i=0;i<e;++i)n[o][i]=n[o-1][i].clone().mix(n[o-1][i+1],t)}const r=new Array(i+1),s=new Array(i+1);for(let o=0;o<=i;++o)r[o]=n[o][0],s[o]=n[i-o][o];return[r,s]},Wt=(e,t,n,i,r)=>{const s=((e,t,n,i,r)=>{const s=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],o=[t,n,i,r],a=o.map(t=>t.clone().sub(e)),l=new It,c=Array(3);for(let u=0;u<3;++u){l.copy(o[u+1]).sub(o[u]).mulScalar(3);const e=c[u]=new Array(4);for(let t=0;t<4;++t)e[t]=l.dot(a[t])}const h=new Array(6);for(let u=0;u<=5;++u)h[u]=new It(u/5,0);for(let u=0;u<=5;++u){const e=Math.max(0,u-2),t=Math.min(u,3);for(let n=e;n<=t;++n){const e=u-n;h[n+e].y+=c[e][n]*s[e][n]}}return h})(r,e,t,n,i),o=Vt(s,5);let a=r.distanceSquared(e),l=e.clone(),c=0;const h=new It;for(let u of o){Zt(e,t,n,i,u,h);const s=r.distanceSquared(h);s<a&&(a=s,l.copy(h),c=u)}return r.distanceSquared(i)<a&&(l.copy(i),c=1),{position:l,time:c}},Gt=[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],$t=[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],Zt=(e,t,n,i,r,s)=>{if(0===r)return s.copy(e);if(1===r)return s.copy(i);const o=1-r,a=r*r,l=o*o,c=l*o,h=l*r*3,u=o*a*3,d=r*a;return s.set(c*e.x+h*t.x+u*n.x+d*i.x,c*e.y+h*t.y+u*n.y+d*i.y)},qt=(e,t,n,i=1e-7)=>{const r=n.distance(e),s=n.distance(t);if(r<=s){if(r<=i)return 0}else if(s<=i)return 1;const o=St(Kt(e.x,e.y,t.x-e.x,t.y-e.y,n.x,n.y)),a=e.clone().mix(t,o);if(n.distance(a)<=i)return o},Kt=(e,t,n,i,r,s)=>{const o=n*n+i*i;return 0===o?0:(n*(r-e)+i*(s-t))/o},Yt=(e,t,n,i,r,s)=>{r.copy(e).min(i),s.copy(e).max(i);const o=t.x-e.x,a=t.y-e.y,l=e.x-2*t.x+n.x,c=e.y-2*t.y+n.y,h=3*t.x-3*n.x+i.x-e.x,u=3*t.y-3*n.y+i.y-e.y;let d=l*l-h*o,p=c*c-u*a;const f=0===o&&0===a;if(d>0){d=Math.sqrt(d);let a=f?(-l-d)/h:o/(-l-d);if(a>0&&a<1){const o=1-a,l=o*o*o*e.x+3*o*o*a*t.x+3*o*a*a*n.x+a*a*a*i.x;r.x=Math.min(r.x,l),s.x=Math.max(s.x,l)}if(a=f?(-l+d)/h:o/(-l+d),a>0&&a<1){const o=1-a,l=o*o*o*e.x+3*o*o*a*t.x+3*o*a*a*n.x+a*a*a*i.x;r.x=Math.min(r.x,l),s.x=Math.max(s.x,l)}}if(p>0){p=Math.sqrt(p);let o=f?(-c-p)/u:a/(-c-p);if(o>0&&o<1){const a=1-o,l=a*a*a*e.y+3*a*a*o*t.y+3*a*o*o*n.y+o*o*o*i.y;r.y=Math.min(r.y,l),s.y=Math.max(s.y,l)}if(o=f?(-c+p)/u:a/(-c+p),o>0&&o<1){const a=1-o,l=a*a*a*e.y+3*a*a*o*t.y+3*a*o*o*n.y+o*o*o*i.y;r.y=Math.min(r.y,l),s.y=Math.max(s.y,l)}}},Xt=(e,t,n)=>{let i;if(e.s._almostEquals(t.s,n)&&e.e._almostEquals(t.e,n))i=!1;else{if(!e.s._almostEquals(t.e,n)||!e.e._almostEquals(t.s,n))return!1;i=!0}if(e instanceof Bn&&t instanceof Bn)return!0;if(e instanceof Fn&&t instanceof Fn)if(i){if(e.cs._almostEquals(t.ce,n)&&e.ce._almostEquals(t.cs,n))return!0}else if(e.cs._almostEquals(t.cs,n)&&e.ce._almostEquals(t.ce,n))return!0;return!!((e,t,n,i)=>{const r=e._signedArea();let s=t._signedArea();if(i&&(s*=-1),Math.abs(r-s)>n)return!1;e instanceof Bn&&t instanceof Fn&&([e,t]=[t,e]);for(let o=0;o<8;++o){const i=(o+1)/9,r=e.positionAtTime(i),s=t.closestPoint(r);if(!s)return!1;if(r.distance(s.position)>n)return!1}return!0})(e,t,n,i)},Jt=e=>e instanceof Bn||e instanceof Fn,Qt=(e,t,n,i)=>{const r=.5*n,s=new Array(i);for(let l=0;l<i;++l)s[l]={xMin:1/0,xMax:-1/0,y:t+n*l+r};const o=[],a=e._primitives();for(const l of a){const e=l.looseBoundingBox();if(e)for(let a=0;a<i;++a){const i=t+n*a+r;if(e.min.y>i)continue;if(e.max.y<i)continue;const c=s[a];if(l instanceof Bn){const e=en(l.s,l.e,i);e<c.xMin&&(c.xMin=e),e>c.xMax&&(c.xMax=e)}else if(l instanceof Fn){const{s:e,cs:t,ce:n,e:r}=l,s=tn(e,t,n,r,i,o);for(let i=0;i<s;++i){const e=o[i];e<c.xMin&&(c.xMin=e),e>c.xMax&&(c.xMax=e)}}}}return s},en=(e,t,n)=>{if(e.x===t.x)return e.x;const i=(t.y-e.y)/(t.x-e.x);return(n-(e.y-i*e.x))/i},tn=(e,t,n,i,r,s)=>{const o=1/7,a=new It,l=e.clone();let c=0;for(let h=1;h<8;++h){const u=h*o;if(a.copy(l),Zt(e,t,n,i,u,l),r>=Math.min(a.y,l.y)&&r<=Math.max(a.y,l.y)){const e=en(a,l,r);s[c++]=e}}return c},nn=1e-12,rn=112e-18,sn=(e,t,n,i,r,s,o)=>{let a=an(Math.abs(e),Math.abs(t),Math.abs(n),Math.abs(i)),l=0,c=0,h=0,u=0,d=0;a&&(e*=a,t*=a,n*=a,i*=a);const p=r=>{l=r;let s=e*l;c=s+t,h=c*l+n,u=(s+c)*l+h,d=h*l+i};if(Math.abs(e)<nn)e=t,c=n,h=i,l=1/0;else if(Math.abs(i)<nn)c=t,h=n,l=0;else{p(-t/e/3);let r=d/e,s=Math.pow(Math.abs(r),1/3),o=r<0?-1:1,a=-u/e,f=a>0?1.324717957244746*Math.max(s,Math.sqrt(a)):s,m=l-o*f;if(m!==l){do{p(m),m=0===u?l:l-d/u/(1+rn)}while(o*m>o*l);Math.abs(e)*l*l>Math.abs(i/l)&&(h=-i/l,c=(h-n)/l)}}let f=on(e,c,h,r,s,o);return isFinite(l)&&(0===f||f>0&&l!==r[0]&&l!==r[1])&&l>s-nn&&l<o+nn&&(r[f++]=Ct(l,s,o)),f},on=(e,t,n,i,r,s)=>{let o=1/0,a=1/0;if(Math.abs(e)<nn){if(Math.abs(t)<nn)return Math.abs(n)<nn?-1:0;o=-n/t}else{let i=ln(e,t*=-.5,n);if(i&&Math.abs(i)<rn){let r=an(Math.abs(e),Math.abs(t),Math.abs(n));r&&(i=ln(e*=r,t*=r,n*=r))}if(i>=-112e-18){let r=i<0?0:Math.sqrt(i),s=t+(t<0?-r:r);0===s?(o=n/e,a=-o):(o=s/e,a=n/s)}}let l=0,c=r-nn,h=s+nn;return isFinite(o)&&o>c&&o<h&&(i[l++]=Ct(o,r,s)),a!==o&&isFinite(a)&&a>c&&a<h&&(i[l++]=Ct(a,r,s)),l},an=(...e)=>{let t=Math.max.apply(Math,e);return t&&(t<1e-8||t>1e8)?Math.pow(2,-Math.round(Math.log2(t))):0},ln=(e,t,n)=>{function i(e){let t=134217729*e,n=e-t+t;return[n,e-n]}let r=t*t-e*n,s=t*t+e*n;if(3*Math.abs(r)<s){let s=i(e),o=i(t),a=i(n),l=t*t,c=e*n;r=l-c+(o[0]*o[0]-l+2*o[0]*o[1]+o[1]*o[1]-(s[0]*a[0]-c+s[0]*a[1]+s[1]*a[0]+s[1]*a[1]))}return r},cn=(e,t,n,i=1e-7)=>{if(i<=0&&(i=je),!(n=us(e,t,n,i)))return[];const r=Vn(e,n),s=Vn(t,n),o=[];for(const a of r)for(const e of s){if(a===e)continue;const t=a._overlapWithPrimitive(e,i);t&&o.push(t)}return hn(o)},hn=e=>{const t=[],n=dn(e.map(e=>pn(e))),i=rs(n,(e,t)=>un(e,t));for(const r of i){r.sort((e,t)=>e.span2.time1-t.span2.time1);const e=is(r,(e,t)=>!bn(e,t)).map(mn);gn(e),t.push(...e)}return t},un=(e,t)=>e.span1.path===t.span1.path&&e.span2.path===t.span2.path,dn=e=>e.filter(e=>void 0!==e),pn=e=>{const t=fn(e.span1);if(void 0===t)return;const n=fn(e.span2);return void 0!==n?{span1:t,span2:n}:void 0},fn=e=>{const t=e.primitive;if(!Jt(t))return;const{source:n}=t;return n?{path:n.path,time1:n.time+e.time1,time2:n.time+e.time2}:void 0},mn=e=>{Ps(e.length>0);const t=e[0],n=e[e.length-1];return{span1:{path:t.span1.path,time1:Math.min(t.span1.time1,n.span1.time1),time2:Math.max(t.span1.time2,n.span1.time2)},span2:{path:t.span2.path,time1:t.span2.time1,time2:n.span2.time2}}},gn=e=>{for(let t=1;t<e.length;++t){const n=e[t-1],i=e[t];yn(n,i)&&(n.span1=vn(n.span1,i.span1),n.span2=vn(n.span2,i.span2),e.splice(t--,1))}},vn=(e,t)=>{const{path:n}=e,i=n.anchors.length;if(e.time1%i===t.time2%i){const r=Math.min(e.time2,t.time1),s=Math.max(e.time2,t.time1);return e.time1===t.time2?{path:n,time1:r,time2:s}:{path:n,time1:s,time2:r+i}}if(e.time2%i===t.time1%i){const r=Math.min(e.time1,t.time2),s=Math.max(e.time1,t.time2);return e.time2===t.time1?{path:n,time1:r,time2:s}:{path:n,time1:s,time2:r+i}}Ps(!1)},yn=(e,t)=>{const n=e.span1.path,i=e.span2.path;if(!n.isSameTime(e.span1.time2,t.span1.time1)&&!n.isSameTime(e.span1.time1,t.span1.time2))return!1;if(!i.isSameTime(e.span2.time2,t.span2.time1)&&!i.isSameTime(e.span2.time1,t.span2.time2))return!1;if(n.closed){const i=n.anchors.length;if(0===e.span1.time1&&t.span1.time2===i)return!0;if(0===t.span1.time1&&e.span1.time2===i)return!0}if(i.closed){const n=i.anchors.length;if(0===e.span2.time1&&t.span2.time2===n)return!0;if(0===t.span2.time1&&e.span2.time2===n)return!0}return!1},bn=(e,t)=>!!ys(e.span2.time2,t.span2.time1)&&(!!ys(e.span1.time2,t.span1.time1)||!!ys(e.span1.time1,t.span1.time2)),wn=(e,t,n)=>{let i=e.timeAtPoint(t.s,n),r=e.timeAtPoint(t.e,n),s=t.timeAtPoint(e.s,n),o=t.timeAtPoint(e.e,n);return void 0!==i&&void 0!==r?xn(e,i,r,t,0,1,n):void 0!==s&&void 0!==o?xn(e,0,1,t,s,o,n):void 0!==i&&void 0!==s?xn(e,0,i,t,0,s,n):void 0!==i&&void 0!==o?xn(e,i,1,t,0,o,n):void 0!==s&&void 0!==r?xn(e,0,r,t,s,1,n):void 0!==r&&void 0!==o?xn(e,r,1,t,o,1,n):void 0},xn=(e,t,n,i,r,s,o)=>{const a=ys(t,n),l=ys(r,s);if(a&&l)return;t>n&&([t,n]=[n,t]),r>s&&([r,s]=[s,r]);let c=!1;if(a&&!l||l&&!a){const n=e.positionAtTime(t),s=i.positionAtTime(r);c=n.distance(s)<=o}else{const a=e.slice(t,n),l=i.slice(r,s);c=Xt(a,l,o)}if(c){const a=e.length(),l=i.length();return t*a<=o&&(t=0),(1-n)*a<=o&&(n=1),r*l<=o&&(r=0),(1-s)*l<=o&&(s=1),{span1:{primitive:e,time1:t,time2:n},span2:{primitive:i,time1:r,time2:s}}}},Cn=(e,t,n,i)=>{const r=t.x-e.x,s=t.y-e.y,o=i.x-n.x,a=i.y-n.y,l=a*r-o*s;if(0===l)return;let c=(o*(e.y-n.y)-a*(e.x-n.x))/l;if(!Cs(c))return;let h=(r*(e.y-n.y)-s*(e.x-n.x))/l;return Cs(h)?(c=St(c),h=St(h),{time1:c,time2:h}):void 0},Sn=(e,t,n,i)=>{const r=t.x-e.x,s=t.y-e.y,o=i.y*r-i.x*s;if(0===o)return;const a=(i.x*(e.y-n.y)-i.y*(e.x-n.x))/o;if(!Cs(a))return;return{time1:a,time2:(r*(e.y-n.y)-s*(e.x-n.x))/o}},kn=(e,t,n,i)=>{const r=t.x-e.x,s=t.y-e.y,o=i.y*r-i.x*s;if(0===o)return;const a=(i.x*(e.y-n.y)-i.y*(e.x-n.x))/o;if(!Cs(a))return;const l=(r*(e.y-n.y)-s*(e.x-n.x))/o;return xs(l)?{time1:a,time2:l}:void 0},Ln=(e,t,n,i)=>{const r=i.y*t.x-i.x*t.y;if(0===r)return;return{time1:(i.x*(e.y-n.y)-i.y*(e.x-n.x))/r,time2:(t.x*(e.y-n.y)-t.y*(e.x-n.x))/r}},En=(e,t,n,i)=>{const r=i.y*t.x-i.x*t.y;if(0===r)return;const s=(i.x*(e.y-n.y)-i.y*(e.x-n.x))/r,o=(t.x*(e.y-n.y)-t.y*(e.x-n.x))/r;return xs(o)?{time1:s,time2:o}:void 0},Pn=(e,t,n,i,r,s)=>{const o=t.x,a=t.y;if(ms(o)&&ms(a))return[];const l=e.x,c=e.y,h=Math.atan2(-a,o),u=Math.sin(h),d=Math.cos(h),p=[],f=((e,t,n,i,r,s,o,a)=>{if(e<r&&i<r&&t<r&&n<r||e>r&&i>r&&t>r&&n>r)return 0;const l=3*(t-e),c=3*(n-t)-l;return sn(i-e-l-c,c,l,e-r,s,o,a)})((n.x-l)*u+(n.y-c)*d,(i.x-l)*u+(i.y-c)*d,(r.x-l)*u+(r.y-c)*d,(s.x-l)*u+(s.y-c)*d,0,p,0,1);if(-1===f)return[];const m=[],g=new It;for(let v=0;v<f;++v){const o=p[v];Zt(n,i,r,s,o,g);const a=Kt(e.x,e.y,t.x,t.y,g.x,g.y);m.push({time1:a,time2:o})}return m},Tn=(e,t,n,i,r,s)=>{const o=t.clone().sub(e);return Pn(e,o,n,i,r,s).filter(e=>Cs(e.time1))},An=(e,t,n,i,r,s)=>Pn(e,t,n,i,r,s).filter(e=>xs(e.time1)),Mn=e=>{const{time1:t,time2:n}=e;return e.time1=n,e.time2=t,e},In=e=>{for(let t of e)Mn(t);return e},_n=(e,t)=>{for(let n of e)if(t._almostEquals(n.position))return!0;return!1},On=(e,t,n)=>{if(!(n=us(e,t,n)))return[];const i=Vn(e,n),r=Vn(t,n),s=[];for(const o of i)for(const e of r){if(o===e)continue;const t=o._intersectionsWithPrimitive(e);for(let i of t){const t=o.positionAtTime(i.time1);if(n&&!n.containsPoint(t))continue;if(_n(s,t))continue;const r=i;r.primitive1=o,r.primitive2=e,r.position=t,s.push(r)}}return s},Nn=(e,t,n)=>{const i=e.source,r=t.source;if(i&&r&&i.path===r.path){const e=i.time,t=r.time,{time1:s,time2:o}=n;if(i.path.normalizedTime(e+1)===t&&fs(s,1,Ge)&&fs(o,0,Ge))return!0;if(r.path.normalizedTime(t+1)===e&&fs(s,0,Ge)&&fs(o,1,Ge))return!0}return!1};class Dn{transform(e){return this.affineTransform(Ne.fromTransform(e))}reverse(){return this}boundingBox(){}looseBoundingBox(){}isContainedByBoundingBox(e){return!1}isIntersectedByBoundingBox(e){return!1}isOverlappedByBoundingBox(e){return!1}_primitives(){return[]}intersectionsWith(e,t){return On([this],e,t)}overlapsWith(e,t,n){return cn([this],e,t,n)}distanceToIntersect(e,t,n){return((e,t,n,i)=>{const r=(null==i?void 0:i.minOverlap)??0,s=(n.angle()+180)%360;if(0!==s){const n=Ne.fromRotation(-s);t=t.clone().affineTransform(n),e=e.clone().affineTransform(n)}const o=t.looseBoundingBox(),a=e.looseBoundingBox();if(!(null==o?void 0:o.isFinite())||!(null==a?void 0:a.isFinite()))return;const l=Math.max(o.min.y,a.min.y),c=Math.min(o.max.y,a.max.y)-l;if(c<0)return;const h=r>0?r/8:.01,u=Ct(Math.round(c/h),1,128),d=c/u,p=Qt(t,l,d,u),f=Qt(e,l,d,u),m=new Array(u);for(let v=0;v<u;++v){const e=p[v],t=f[v];m[v]={index:v,distance:t.xMin-e.xMax,leftPos:new It(e.xMax,e.y),rightPos:new It(t.xMin,t.y)}}if(null==i?void 0:i.showDebug){Ft.consoleGeometry(o,a);for(const e of m)Ft.consoleGeometry(new Bn(e.leftPos,e.rightPos))}const g=m.filter(e=>Number.isFinite(e.distance)).sort((e,t)=>e.distance-t.distance);if(!(g.length<1)){for(let e=1;e<g.length;++e){const t=g.slice(0,e+1).sort((e,t)=>e.index-t.index);let n=t[0],i=n;for(let s=1;s<t.length;++s){const o=t[s];if(i.index===o.index-1){if(d+n.leftPos.distance(o.leftPos)>=r)return g[e].distance;i=o}else i=n=o}}return g[g.length-1].distance}})(this,e,t,n)}static intersectionsBetweenAll(e,t){return((e,t)=>{const n=Vn(e,t),i=[],r=n.length;for(let s=0;s<r;++s){const e=n[s];for(let o=s+1;o<r;++o){const r=n[o],s=e._intersectionsWithPrimitive(r);for(let n of s){const s=e.positionAtTime(n.time1);if(t&&!t.containsPoint(s))continue;if(_n(i,s))continue;const o=n;o.primitive1=e,o.primitive2=r,o.position=s,i.push(o)}}}return i})(e,t)}static intersectionsBetweenSets(e,t,n){return On(e,t,n)}static overlapsBetweenAll(e,t,n){return((e,t,n=1e-7)=>{n<=0&&(n=je);const i=Vn(e,t),r=[],s=i.length;for(let o=0;o<s;++o){const e=i[o];for(let t=o+1;t<s;++t){const s=i[t],o=e._overlapWithPrimitive(s,n);o&&r.push(o)}}return hn(r)})(e,t,n)}static overlapsBetweenSets(e,t,n,i){return cn(e,t,n,i)}static isValid(e){return e instanceof Dn&&e.isValid()}}let Rn=((o=class extends Dn{constructor(e,t){super(),this.origin=e,this.direction=t}clone(){return new o(this.origin.clone(),this.direction.clone())}isValid(){return It.isValid(this.origin)&&It.isValid(this.direction)}isHorizontal(){return 0===this.direction.y}isVertical(){return 0===this.direction.x}affineTransform(e){return this.origin.affineTransform(e),this.direction.affineTransformWithoutTranslation(e),this}affineTransformWithoutTranslation(e){return this.direction.affineTransformWithoutTranslation(e),this}boundingBox(){return this.isVertical()?new De(new It(this.origin.x,-1/0),new It(this.origin.x,1/0)):this.isHorizontal()?new De(new It(-1/0,this.origin.y),new It(1/0,this.origin.y)):new De(new It(-1/0),new It(1/0))}looseBoundingBox(){return this.boundingBox()}reverse(){return this.direction.negate(),this}closestPoint(e,t){if(t&&!this._looseOverlapsBoundingBox(t))return;const{origin:n,direction:i}=this,r=e.x-n.x,s=e.y-n.y,o=i.x,a=i.y,l=(r*o+s*a)/(o*o+a*a),c=this.positionAtTime(l);return!t||t.containsPoint(c)?{position:c,time:l,geometry:this}:void 0}positionAtTime(e){return this.direction.clone().mulScalar(e).add(this.origin)}_looseOverlapsBoundingBox(e){const t=this.origin.x,n=this.origin.y,i=this.direction.y,r=-this.direction.x,{min:s,max:o}=e,a=s.x-t,l=s.y-n,c=o.x-t,h=o.y-n,u=Math.sign(i*a+r*l);return u!==Math.sign(i*c+r*l)||(u!==Math.sign(i*c+r*h)||u!==Math.sign(i*a+r*h))}_intersectionWithLineSegment(e){const t=Sn(e.s,e.e,this.origin,this.direction);if(t)return Mn(t)}_intersectionsWithCubicSegment(e){return Pn(this.origin,this.direction,e.s,e.cs,e.ce,e.e)}_intersectionWithAxis(e){return Ln(this.origin,this.direction,e.origin,e.direction)}_intersectionWithRay(e){return En(this.origin,this.direction,e.origin,e.direction)}_intersectionsWithPrimitive(e){if(e instanceof Bn){const t=this._intersectionWithLineSegment(e);if(t)return[t]}else{if(e instanceof Fn)return this._intersectionsWithCubicSegment(e);if(e instanceof o){const t=this._intersectionWithAxis(e);if(t)return[t]}else if(e instanceof jn){const t=this._intersectionWithRay(e);if(t)return[t]}}return[]}_overlapWithPrimitive(e){}_primitives(){return[this]}}).displayName="Axis",o),Fn=(a=class extends Dn{constructor(e=new It,t=new It,n=new It,i=new It){super(),this.s=e,this.cs=t,this.ce=n,this.e=i}clone(){return new a(this.s.clone(),this.cs.clone(),this.ce.clone(),this.e.clone())}isValid(){return It.isValid(this.s)&&It.isValid(this.cs)&&It.isValid(this.ce)&&It.isValid(this.e)}isLinear(){const{s:e,cs:t,ce:n,e:i}=this,r=e.mix(i,1/3);if(!t._almostEquals(r,je))return!1;const s=e.mix(i,2/3);return!!n._almostEquals(s,je)}isStraight(e=1e-7){const{s:t,cs:n,ce:i,e:r}=this;if(t._almostEquals(r,je))return!1;if(t._almostEquals(n,je)&&r._almostEquals(i,je))return!0;const s=qt(t,r,n,e);if(void 0===s||!Cs(s))return!1;const o=qt(t,r,i,e);return!(void 0===o||!Cs(o))}_isCoincidentToCubicSegment(e,t){return this.s._almostEquals(e.s,t)&&this.e._almostEquals(e.e,t)?this.cs._almostEquals(e.cs,t)&&this.ce._almostEquals(e.ce,t):!(!this.s._almostEquals(e.e,t)||!this.e._almostEquals(e.s,t))&&(this.cs._almostEquals(e.ce,t)&&this.ce._almostEquals(e.cs,t))}isTangentToNext(e,t){const n=e instanceof a?e.cs:e.e;return ds(this.ce,this.e,n,t)}equals(e){return this.s.equals(e.s)&&this.cs.equals(e.cs)&&this.ce.equals(e.ce)&&this.e.equals(e.e)}affineTransform(e){return this.s.affineTransform(e),this.cs.affineTransform(e),this.ce.affineTransform(e),this.e.affineTransform(e),this}affineTransformWithoutTranslation(e){return this.s.affineTransformWithoutTranslation(e),this.cs.affineTransformWithoutTranslation(e),this.ce.affineTransformWithoutTranslation(e),this.e.affineTransformWithoutTranslation(e),this}copy(e){return this.s.copy(e.s),this.cs.copy(e.cs),this.ce.copy(e.ce),this.e.copy(e.e),this}mix(e,t){return this.s.mix(e.s,t),this.cs.mix(e.cs,t),this.ce.mix(e.ce,t),this.e.mix(e.e,t),this}setFromAnchors(e,t){return this.s=e.position,this.cs.copy(e.position).add(e.handleOut),this.ce.copy(t.position).add(t.handleIn),this.e=t.position,this}reverse(){return[this.s,this.cs,this.ce,this.e]=[this.e,this.ce,this.cs,this.s],this}length(){return this.distanceAtTime(1)}timeAtDistance(e){if(Ps(e>=0,"Distance must be a positive number"),0===e)return 0;let t=this.length();if(e>=t)return 1;const n=1/99;let i,r,s,o=this.positionAtTime(0);t=0;for(let a=1;a<100;++a){if(r=a/99,i=this.positionAtTime(r),s=o.distance(i),t+s>e)return(a-1+(e-t)/s)*n;t+=s,o=i}return 1}distanceAtTime(e){const t=.5*e;let n=0;for(let i=0;i<24;i++){const e=Gt[i]*t+t,r=this.derivativeAtTime(e);n+=$t[i]*r.length()}return n*t}positionAtTime(e){return Zt(this.s,this.cs,this.ce,this.e,e,new It)}derivativeAtTime(e){const t=e*e,n=-3*t+6*e-3,i=9*t-12*e+3,r=-9*t+6*e,s=3*t,{s:o,cs:a,ce:l,e:c}=this;return new It(n*o.x+i*a.x+r*l.x+s*c.x,n*o.y+i*a.y+r*l.y+s*c.y)}secondDerivativeAtTime(e){const t=-6*e+6,n=18*e-12,i=-18*e+6,r=6*e,{s:s,cs:o,ce:a,e:l}=this;return new It(t*s.x+n*o.x+i*a.x+r*l.x,t*s.y+n*o.y+i*a.y+r*l.y)}curvatureAtTime(e){const t=this.derivativeAtTime(e),n=this.secondDerivativeAtTime(e),i=t.x*n.y-n.x*t.y,r=t.length();return i/(r*r*r)}tangentAtTime(e){if(0===e){const e=this.s;let t=this.cs;return e.equals(t)&&(t=this.ce,e.equals(t)&&(t=this.e)),t.clone().sub(e).normalize()}if(1===e){const e=this.e;let t=this.ce;return e.equals(t)&&(t=this.cs,e.equals(t)&&(t=this.s)),e.clone().sub(t).normalize()}return this.derivativeAtTime(e).normalize()}normalAtTime(e){return this.tangentAtTime(e).rotate90()}timeAtPoint(e,t){return((e,t,n,i,r,s=1e-7)=>{const o=Math.min(e.x,t.x,n.x,i.x)-s,a=Math.max(e.x,t.x,n.x,i.x)+s,l=Math.min(e.y,t.y,n.y,i.y)-s,c=Math.max(e.y,t.y,n.y,i.y)+s;if(r.x<o||r.x>a||r.y<l||r.y>c)return;const h=r.distance(e),u=r.distance(i);if(h<=u){if(h<=s)return 0}else if(u<=s)return 1;const d=Wt(e,t,n,i,r);return r.distance(d.position)<=s?d.time:void 0})(this.s,this.cs,this.ce,this.e,e,t)}closestPoint(e,t){if(t&&!this._looseOverlapsBoundingBox(t))return;const n=Wt(this.s,this.cs,this.ce,this.e,e);return!t||t.containsPoint(n.position)?(n.geometry=this,n):void 0}boundingBox(){const e=new De;return Yt(this.s,this.cs,this.ce,this.e,e.min,e.max),e}looseBoundingBox(){const{s:e,cs:t,ce:n,e:i}=this;return new De(new It(Math.min(e.x,t.x,n.x,i.x),Math.min(e.y,t.y,n.y,i.y)),new It(Math.max(e.x,t.x,n.x,i.x),Math.max(e.y,t.y,n.y,i.y)))}slice(e,t){let n=this;return e>t&&([e,t]=[t,e]),bs(e)||([,n]=n.splitAtTime(e)),ws(t)||([n]=n.splitAtTime((t-e)/(1-e))),n}splitAtTime(e){const{s:t,cs:n,ce:i,e:r}=this,s=n.clone().mix(i,e),o=t.clone().mix(n,e),l=o.clone().mix(s,e),c=i.clone().mix(r,e),h=s.clone().mix(c,e),u=l.clone().mix(h,e);return[new a(t,o,l,u),new a(u,h,c,r)]}isContainedByBoundingBox(e){const t=this.boundingBox();return Boolean(t&&e.containsBoundingBox(t))}isIntersectedByBoundingBox(e){if(this._looseOverlapsBoundingBox(e)){const t=new It,n=new It,i=new Bn(t,n);if(t.set(e.min.x,e.min.y),n.set(e.max.x,e.min.y),this._intersectionsWithLine(i).length>0)return!0;if(t.set(e.max.x,e.min.y),n.set(e.max.x,e.max.y),this._intersectionsWithLine(i).length>0)return!0;if(t.set(e.max.x,e.max.y),n.set(e.min.x,e.max.y),this._intersectionsWithLine(i).length>0)return!0;if(t.set(e.min.x,e.max.y),n.set(e.min.x,e.min.y),this._intersectionsWithLine(i).length>0)return!0}return!1}isOverlappedByBoundingBox(e){return this.isContainedByBoundingBox(e)||this.isIntersectedByBoundingBox(e)}_looseOverlapsBoundingBox(e){const{s:t,cs:n,ce:i,e:r}=this,s=Math.min(t.x,n.x,i.x,r.x),o=Math.max(t.x,n.x,i.x,r.x),a=Math.min(t.y,n.y,i.y,r.y),l=Math.max(t.y,n.y,i.y,r.y);return o>=e.min.x&&s<=e.max.x&&l>=e.min.y&&a<=e.max.y}_intersectionsWithCubic(e){return((e,t)=>{const n=je;if(e._isCoincidentToCubicSegment(t,n))return[];if(wn(e,t,n))return[];let i=[{time1:0,segment1:e,time2:0,segment2:t}],r=1;for(let o=0;o<12;o++){const e=[],t=.5*r;for(const{time1:r,segment1:s,time2:o,segment2:a}of i){const i=s.looseBoundingBox(),l=i.width(),c=i.height();if(l<n&&c<n)continue;const h=a.looseBoundingBox(),u=h.width(),d=h.height();if(u<n&&d<n)continue;if(l<n&&u<n)continue;if(c<n&&d<n)continue;if(!i.expandScalar(n).overlapsBoundingBox(h))continue;const[p,f]=s.splitAtTime(.5),[m,g]=a.splitAtTime(.5);e.push({time1:r,segment1:p,time2:o,segment2:m},{time1:r,segment1:p,time2:o+t,segment2:g},{time1:r+t,segment1:f,time2:o,segment2:m},{time1:r+t,segment1:f,time2:o+t,segment2:g})}if(0===e.length)return[];i=e,r=t}let s=[];for(let{time1:o,segment1:a,time2:l,segment2:c}of i){const e=Cn(a.s,a.e,c.s,c.e);e&&s.push({time1:o+e.time1*r,time2:l+e.time2*r})}return s})(this,e).filter(t=>!Nn(this,e,t))}_intersectionsWithLine(e){let t=Tn(e.s,e.e,this.s,this.cs,this.ce,this.e);return t=t.filter(t=>!(t.time1<0||t.time1>1)&&!Nn(e,this,t)),In(t)}_intersectionsWithAxis(e){const t=Pn(e.origin,e.direction,this.s,this.cs,this.ce,this.e);return In(t)}_intersectionsWithRay(e){const t=An(e.origin,e.direction,this.s,this.cs,this.ce,this.e);return In(t)}_intersectionsWithPrimitive(e){return e instanceof a?this._intersectionsWithCubic(e):e instanceof Bn?this._intersectionsWithLine(e):e instanceof Rn?this._intersectionsWithAxis(e):e instanceof jn?this._intersectionsWithRay(e):[]}_overlapWithPrimitive(e,t){if(e instanceof Bn||e instanceof a)return wn(this,e,t)}_primitives(){return[this]}_signedArea(){const{s:{x:e,y:t},cs:{x:n,y:i},ce:{x:r,y:s},e:{x:o,y:a}}=this;return 3*((a-t)*(n+r)-(o-e)*(i+s)+i*(e-r)-n*(t-s)+a*(r+e/3)-o*(s+t/3))/20}static isValid(e){return e instanceof a&&e.isValid()}static fromAnchors(e,t){return new a(e.position.clone(),e.position.clone().add(e.handleOut),t.position.clone().add(t.handleIn),t.position.clone())}static fromLineSegment(e){const{s:t,e:n}=e;return new a(t.clone(),t.clone().mix(n,1/3),t.clone().mix(n,2/3),n.clone())}},a.displayName="CubicSegment",a),Bn=((l=class extends Dn{constructor(e=new It,t=new It){super(),this.s=e,this.e=t}clone(){return new l(this.s.clone(),this.e.clone())}isValid(){return It.isValid(this.s)&&It.isValid(this.e)}isLinear(){return!0}isStraight(){return!0}isHorizontal(){return this.s.y===this.e.y}isVertical(){return this.s.x===this.e.x}isTangentToNext(e,t){const n=e instanceof Fn?e.cs:e.e;return ds(this.s,this.e,n,t)}equals(e){return this.s.equals(e.s)&&this.e.equals(e.e)}affineTransform(e){return this.s.affineTransform(e),this.e.affineTransform(e),this}affineTransformWithoutTranslation(e){return this.s.affineTransformWithoutTranslation(e),this.e.affineTransformWithoutTranslation(e),this}copy(e){return this.s.copy(e.s),this.e.copy(e.e),this}mix(e,t){return this.s.mix(e.s,t),this.e.mix(e.e,t),this}setFromAnchors(e,t){return this.s=e.position,this.e=t.position,this}reverse(){return[this.s,this.e]=[this.e,this.s],this}length(){return this.s.distance(this.e)}timeAtDistance(e){return e/this.length()}distanceAtTime(e){return this.length()*e}positionAtTime(e){return this.s.clone().mix(this.e,e)}derivativeAtTime(e){return this.e.clone().sub(this.s)}secondDerivativeAtTime(e){return new It(0,0)}curvatureAtTime(e){return 0}tangentAtTime(e){return this.derivativeAtTime(e).normalize()}normalAtTime(e){return this.tangentAtTime(e).rotate90()}timeAtPoint(e,t){return qt(this.s,this.e,e,t)}closestPoint(e,t){if(t&&!this._looseOverlapsBoundingBox(t))return;const{s:n,e:i}=this,r=(s=n.x,o=n.y,a=i.x,l=i.y,c=e.x,h=e.y,St(Kt(s,o,a-s,l-o,c,h)));var s,o,a,l,c,h;const u=this.positionAtTime(r);return!t||t.containsPoint(u)?{position:u,time:r,geometry:this}:void 0}boundingBox(){const{s:e,e:t}=this;return new De(new It(Math.min(e.x,t.x),Math.min(e.y,t.y)),new It(Math.max(e.x,t.x),Math.max(e.y,t.y)))}looseBoundingBox(){return this.boundingBox()}slice(e,t){return new l(this.positionAtTime(e),this.positionAtTime(t))}splitAtTime(e){const t=this.positionAtTime(e);return[new l(this.s,t),new l(t,this.e)]}isContainedByBoundingBox(e){return e.containsPoint(this.s)&&e.containsPoint(this.e)}isIntersectedByBoundingBox(e){return e.containsPoint(this.s)!==e.containsPoint(this.e)}isOverlappedByBoundingBox(e){return this._looseOverlapsBoundingBox(e)}_looseOverlapsBoundingBox(e){const{s:t,e:n}=this,i=Math.min(t.x,n.x),r=Math.max(t.x,n.x),s=Math.min(t.y,n.y),o=Math.max(t.y,n.y);return r>=e.min.x&&i<=e.max.x&&o>=e.min.y&&s<=e.max.y}_intersectionWithLineSegment(e){const t=Cn(this.s,this.e,e.s,e.e);if(t&&!Nn(this,e,t))return t}_intersectionsWithCubicSegment(e){return Tn(this.s,this.e,e.s,e.cs,e.ce,e.e).filter(t=>!(t.time1<0||t.time1>1)&&!Nn(this,e,t))}_intersectionWithAxis(e){return Sn(this.s,this.e,e.origin,e.direction)}_intersectionWithRay(e){return kn(this.s,this.e,e.origin,e.direction)}_intersectionsWithPrimitive(e){if(e instanceof l){const t=this._intersectionWithLineSegment(e);if(t)return[t]}else{if(e instanceof Fn)return this._intersectionsWithCubicSegment(e);if(e instanceof Rn){const t=this._intersectionWithAxis(e);if(t)return[t]}else if(e instanceof jn){const t=this._intersectionWithRay(e);if(t)return[t]}}return[]}_overlapWithPrimitive(e,t){if(e instanceof l||e instanceof Fn)return wn(this,e,t)}_primitives(){return[this]}_signedArea(){return.5*this.s.cross(this.e)}static isValid(e){return e instanceof l&&e.isValid()}static fromAnchors(e,t){return new l(e.position,t.position)}}).displayName="LineSegment",l);const Vn=(e,t)=>{let n=e.flatMap(e=>e._primitives());return t?n.filter(e=>e._looseOverlapsBoundingBox(t)):n};let jn=((c=class extends Dn{constructor(e,t){super(),this.origin=e,this.direction=t}clone(){return new c(this.origin.clone(),this.direction.clone())}isValid(){return It.isValid(this.origin)&&It.isValid(this.direction)}isHorizontal(){return 0===this.direction.y}isVertical(){return 0===this.direction.x}affineTransform(e){return this.origin.affineTransform(e),this.direction.affineTransformWithoutTranslation(e),this}affineTransformWithoutTranslation(e){return this.direction.affineTransformWithoutTranslation(e),this}boundingBox(){return new De(this.origin.clone(),this.direction.clone().mulScalar(1/0)).canonicalize()}looseBoundingBox(){return this.boundingBox()}reverse(){return this.direction.negate(),this}closestPoint(e,t){if(t&&!this._looseOverlapsBoundingBox(t))return;const{origin:n,direction:i}=this,r=e.x-n.x,s=e.y-n.y,o=i.x,a=i.y,l=Math.max(0,(r*o+s*a)/(o*o+a*a)),c=this.positionAtTime(l);return!t||t.containsPoint(c)?{position:c,time:l,geometry:this}:void 0}positionAtTime(e){return this.direction.clone().mulScalar(e).add(this.origin)}_looseOverlapsBoundingBox(e){return!0}_intersectionWithLineSegment(e){const t=kn(e.s,e.e,this.origin,this.direction);if(t)return Mn(t)}_intersectionsWithCubicSegment(e){return An(this.origin,this.direction,e.s,e.cs,e.ce,e.e)}_intersectionWithAxis(e){const t=En(e.origin,e.direction,this.origin,this.direction);if(t)return Mn(t)}_intersectionWithRay(e){return((e,t,n,i)=>{const r=i.y*t.x-i.x*t.y;if(0===r)return;const s=(i.x*(e.y-n.y)-i.y*(e.x-n.x))/r;if(!xs(s))return;const o=(t.x*(e.y-n.y)-t.y*(e.x-n.x))/r;return xs(o)?{time1:s,time2:o}:void 0})(this.origin,this.direction,e.origin,e.direction)}_intersectionsWithPrimitive(e){if(e instanceof Bn){const t=this._intersectionWithLineSegment(e);if(t)return[t]}else{if(e instanceof Fn)return this._intersectionsWithCubicSegment(e);if(e instanceof Rn){const t=this._intersectionWithAxis(e);if(t)return[t]}else if(e instanceof c){const t=this._intersectionWithRay(e);if(t)return[t]}}return[]}_overlapWithPrimitive(e){}_primitives(){return[this]}}).displayName="Ray",c);class Hn extends Dn{allCompoundPaths(){return[]}allPaths(){return[]}allAnchors(){return[]}allPathsAndCompoundPaths(){return[]}allPathsByColor(){const e=this.allPaths(),t=[],n=(e,t)=>e===t||void 0!==e&&(void 0!==t&&(!(e instanceof Hi)&&(!(t instanceof Hi)&&e.color.equals(t.color)))),i=e=>{for(let i of t){const[{stroke:t,fill:r}]=i;if(n(e.stroke,t)&&n(e.fill,r))return void i.push(e)}t.push([e])};for(let r of e)i(r);return t}hasStyle(){return!1}assignFill(e){return this}removeFill(){return this}assignStroke(e){return this}removeStroke(){return this}assignStyle(e,t){return this}copyStyle(e){return this}scaleStroke(e){return this}containsPoint(e){return!1}styleContainsPoint(e){return!1}firstStyled(){}static isValid(e){return e instanceof Hn&&e.isValid()}}const Un=new It,zn=new It;let Wn=((h=class extends Hn{constructor(e=new It,t=new It,n=new It){super(),this.position=e,this.handleIn=t,this.handleOut=n}clone(){return new h(this.position.clone(),this.handleIn.clone(),this.handleOut.clone())}isValid(){return It.isValid(this.position)&&It.isValid(this.handleIn)&&It.isValid(this.handleOut)}affineTransform(e){return this.position.affineTransform(e),this.handleIn.affineTransformWithoutTranslation(e),this.handleOut.affineTransformWithoutTranslation(e),this}affineTransformWithoutTranslation(e){return this.position.affineTransformWithoutTranslation(e),this.handleIn.affineTransformWithoutTranslation(e),this.handleOut.affineTransformWithoutTranslation(e),this}allAnchors(){return[this]}looseBoundingBox(){return new De(this.position.clone(),this.position.clone())}boundingBox(){return new De(this.position.clone(),this.position.clone())}isContainedByBoundingBox(e){return e.containsPoint(this.position)}isIntersectedByBoundingBox(e){const{min:t,max:n}=e,{x:i,y:r}=this.position;return i>=t.x&&i<=n.x&&(r===t.y||r===n.y)||r>=t.y&&r<=n.y&&(i===t.x||i===n.x)}isOverlappedByBoundingBox(e){return e.containsPoint(this.position)}closestPoint(e,t){const{position:n}=this;if(!t||t.containsPoint(n))return{position:n}}reverse(){const{handleIn:e,handleOut:t}=this;return this.handleIn=t,this.handleOut=e,this}hasTangentHandles(e=Be){return Un.copy(this.handleIn).normalize(),zn.copy(this.handleOut).normalize(),Un.dot(zn)<=e-1}hasZeroHandles(){return this.handleIn.isZero()&&this.handleOut.isZero()}static isValid(e){return e instanceof h&&e.isValid()}}).displayName="Anchor",h),Gn=((u=class{constructor(e=0,t=0,n=0,i=1){this.r=e,this.g=t,this.b=n,this.a=i}clone(){return new u(this.r,this.g,this.b,this.a)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}set(e,t,n,i){return this.r=e,this.g=t,this.b=n,this.a=i,this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this}mulScalar(e){return this.r*=e,this.g*=e,this.b*=e,this.a*=e,this}mix(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this.a+=(e.a-this.a)*t,this}luminance(){return.2126*this.r+.7152*this.g+.0722*this.b}toCSSString(){return 1===this.a?this.toCSSHexString():this.toCSSRGBAString()}toCSSHexString(){return"#"+(16777216+this.toRGB8Number()).toString(16).slice(1)}toCSSRGBAString(){return`rgba(${Ct(Math.round(255*this.r),0,255)}, ${Ct(Math.round(255*this.g),0,255)}, ${Ct(Math.round(255*this.b),0,255)}, ${Ct(this.a,0,1)})`}toRGB8Number(){const e=Ct(Math.round(255*this.r),0,255),t=Ct(Math.round(255*this.g),0,255);return Ct(Math.round(255*this.b),0,255)|t<<8|e<<16}toHSVA(){let e,t;const{r:n,g:i,b:r,a:s}=this,o=Math.max(n,i,r),a=o-Math.min(n,i,r),l=e=>(o-e)/6/a+.5;if(0===a)e=t=0;else{t=a/o;const s=l(n),c=l(i),h=l(r);e=n===o?h-c:i===o?1/3+s-h:2/3+c-s,e<0?e+=1:e>1&&(e-=1)}return[e,t,o,s]}static isValid(e){return e instanceof u&&Ss(e.r)&&Ss(e.g)&&Ss(e.b)&&Ss(e.a)}static fromHSVA(e,t,n,i){e*=6;const r=Math.floor(e)%6,s=e-Math.floor(e),o=n*(1-t),a=n*(1-t*s),l=n*(1-t*(1-s));switch(r){case 0:return new u(n,l,o,i);case 1:return new u(a,n,o,i);case 2:return new u(o,n,l,i);case 3:return new u(o,a,n,i);case 4:return new u(l,o,n,i);default:return new u(n,o,a,i)}}static fromCSSString(e){e=e.trim().toLowerCase();const t=Kn[e];if(t)return new u(t[0]/255,t[1]/255,t[2]/255,t[3]);if("#"===e[0]){if(4===e.length)return new u($n(e[1]),$n(e[2]),$n(e[3]));if(5===e.length)return new u($n(e[1]),$n(e[2]),$n(e[3]),$n(e[4]));if(7===e.length)return new u(Zn(e.slice(1,3)),Zn(e.slice(3,5)),Zn(e.slice(5,7)));if(9===e.length)return new u(Zn(e.slice(1,3)),Zn(e.slice(3,5)),Zn(e.slice(5,7)),Zn(e.slice(7,9)))}const n=e.match(/^rgb\s*\(\s*(\d+%?)[\s,]+(\d+%?)[\s,]+(\d+%?)\s*\)$/);if(n)return new u(qn(n[1]),qn(n[2]),qn(n[3]));const i=e.match(/^rgba\s*\(\s*(\d+%?)[\s,]+(\d+%?)[\s,]+(\d+%?)[\s,]+(\d+%?)\s*\)$/);return i?new u(qn(i[1]),qn(i[2]),qn(i[3]),qn(i[4])):new u}static fromRGB8Number(e){return new u((e>>16&255)/255,(e>>8&255)/255,(255&e)/255)}}).displayName="Color",u);const $n=e=>parseInt(""+e+e,16)/255,Zn=e=>parseInt(e,16)/255,qn=e=>{const t=e.match(/^(\d+)%$/);return t?parseInt(t[1],10)/100:parseInt(e,10)/255},Kn={aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],transparent:[0,0,0,0],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1],rebeccapurple:[102,51,153,1]};var Yn,Xn,Jn=(Xn="undefined"!=typeof document?null==(Yn=document.currentScript)?void 0:Yn.src:void 0,"undefined"!=typeof __filename&&(Xn=Xn||__filename),function(e={}){var t,n,i,r,s,o,a,l,c,h=e,u=new Promise((e,i)=>{t=e,n=i}),d="object"==typeof window,p="function"==typeof importScripts,f="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node&&"renderer"!=process.type;c={},(i=h).loadCmdsTypedArray=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].length;if(c[t])var r=c[t];else r=new Float32Array(t),c[t]=r;var s=0;for(n=0;n<e.length;n++)for(var o=0;o<e[n].length;o++){var a=e[n][o];"string"==typeof a&&(a=i.SkBits2FloatUnsigned(parseInt(a))),r[s]=a,s++}return e=i._malloc(r.length*r.BYTES_PER_ELEMENT),i.HEAPF32.set(r,e/r.BYTES_PER_ELEMENT),[e,t]},i.FromCmds=function(e){e=i.loadCmdsTypedArray(e);var t=i._FromCmds(e[0],e[1]);return i._free(e[0]),t},i.cubicYFromX=function(e,t,n,c,h){return r&&s===e&&o===t&&a===n&&l===c||(r&&r.delete(),r=new i._SkCubicMap([e,t],[n,c]),s=e,o=t,a=n,l=c),r.computeYFromX(h)},i.cubicPtFromT=function(e,t,n,c,h){return r&&s===e&&o===t&&a===n&&l===c||(r&&r.delete(),r=new i._SkCubicMap([e,t],[n,c]),s=e,o=t,a=n,l=c),r.computePtFromT(h)},function(e){e.onRuntimeInitialized=function(){e.SkPath.prototype.addPath=function(){var e=arguments[0];if(1===arguments.length)this._addPath(e,1,0,0,0,1,0,0,0,1);else if(2===arguments.length){var t=arguments[1];this._addPath(e,t.a,t.c,t.e,t.b,t.d,t.f,0,0,1)}else if(7===arguments.length)t=arguments,this._addPath(e,t[1],t[3],t[5],t[2],t[4],t[6],0,0,1);else{if(10!==arguments.length)return console.Ma("addPath expected to take 1, 2, 7, or 10 args. Got "+arguments.length),null;t=arguments,this._addPath(e,t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9])}return this},e.SkPath.prototype.reverseAddPath=function(e){return this._reverseAddPath(e),this},e.SkPath.prototype.arc=function(e,t,n,i,r,s){return this._arc(e,t,n,i,r,!!s),this},e.SkPath.prototype.arcTo=function(e,t,n,i,r){return this._arcTo(e,t,n,i,r),this},e.SkPath.prototype.bezierCurveTo=function(e,t,n,i,r,s){return this._cubicTo(e,t,n,i,r,s),this},e.SkPath.prototype.close=function(){return this._close(),this},e.SkPath.prototype.closePath=function(){return this._close(),this},e.SkPath.prototype.conicTo=function(e,t,n,i,r){return this._conicTo(e,t,n,i,r),this},e.SkPath.prototype.cubicTo=function(e,t,n,i,r,s){return this._cubicTo(e,t,n,i,r,s),this},e.SkPath.prototype.dash=function(e,t,n){return this._dash(e,t,n)?this:null},e.SkPath.prototype.ellipse=function(e,t,n,i,r,s,o,a){return this._ellipse(e,t,n,i,r,s,o,!!a),this},e.SkPath.prototype.lineTo=function(e,t){return this._lineTo(e,t),this},e.SkPath.prototype.moveTo=function(e,t){return this._moveTo(e,t),this},e.SkPath.prototype.op=function(e,t){return this._op(e,t)?this:null},e.SkPath.prototype.quadraticCurveTo=function(e,t,n,i){return this._quadTo(e,t,n,i),this},e.SkPath.prototype.quadTo=function(e,t,n,i){return this._quadTo(e,t,n,i),this},e.SkPath.prototype.rect=function(e,t,n,i){return this._rect(e,t,n,i),this},e.SkPath.prototype.simplify=function(){return this._simplify()?this:null},e.SkPath.prototype.asWinding=function(){return this._asWinding()?this:null},e.SkPath.prototype.isEmpty=function(){return this._isEmpty()},e.SkPath.prototype.stroke=function(t){return(t=t||{}).width=t.width||1,t.miter_limit=t.miter_limit||4,t.cap=t.cap||e.StrokeCap.BUTT,t.join=t.join||e.StrokeJoin.MITER,t.res_scale=t.res_scale||1,this._stroke(t)?this:null},e.SkPath.prototype.transform=function(){if(1===arguments.length)this._transform(arguments[0]);else{if(9!==arguments.length)return console.Ma("transform expected to take 1 or 9 arguments. Got "+arguments.length),null;var e=arguments;this._transform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}return this},e.SkPath.prototype.trim=function(e,t,n){return this._trim(e,t,!!n)?this:null}}}(h);var m,g,v=Object.assign({},h),y="";if(f){var b=require("fs"),w=require("path");y=__dirname+"/",g=e=>(e=U(e)?new URL(e):w.normalize(e),b.readFileSync(e)),m=e=>(e=U(e)?new URL(e):w.normalize(e),new Promise((t,n)=>{b.readFile(e,void 0,(e,i)=>{e?n(e):t(i.buffer)})})),process.argv.slice(2)}else(d||p)&&(p?y=self.location.href:"undefined"!=typeof document&&document.currentScript&&(y=document.currentScript.src),Xn&&(y=Xn),y=y.startsWith("blob:")?"":y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1),p&&(g=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),m=e=>U(e)?new Promise((t,n)=>{var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=()=>{200==i.status||0==i.status&&i.response?t(i.response):n(i.status)},i.onerror=n,i.send(null)}):fetch(e,{credentials:"same-origin"}).then(e=>e.ok?e.arrayBuffer():Promise.reject(Error(e.status+" : "+e.url))));var x=function(){}.bind(),C=console.error.bind(console);Object.assign(h,v),v=null;var S,k,L,E,P,T,A,M,I,_=!1;function O(){var e=S.buffer;k=new Int8Array(e),E=new Int16Array(e),L=new Uint8Array(e),P=new Uint16Array(e),T=new Int32Array(e),A=new Uint32Array(e),h.HEAPF32=M=new Float32Array(e),I=new Float64Array(e)}var N=[],D=[],R=[],F=0,B=null;function V(e){throw C(e="Aborted("+e+")"),_=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}var j,H=e=>e.startsWith("data:application/octet-stream;base64,"),U=e=>e.startsWith("file://");function z(e,t,n){return function(e){return m(e).then(e=>new Uint8Array(e),()=>{if(!g)throw"both async and sync fetching of the wasm failed";return g(e)})}(e).then(e=>WebAssembly.instantiate(e,t)).then(n,e=>{C(`failed to asynchronously prepare wasm: ${e}`),V(e)})}var W={},G=e=>{for(;e.length;){var t=e.pop();e.pop()(t)}};function $(e){return this.fromWireType(A[e>>2])}var Z,q,K,Y={},X={},J={},Q=(e,t,n)=>{function i(t){if((t=n(t)).length!==e.length)throw new Z("Mismatched type converter count");for(var i=0;i<e.length;++i)ne(e[i],t[i])}e.forEach(e=>J[e]=t);var r=Array(t.length),s=[],o=0;t.forEach((e,t)=>{X.hasOwnProperty(e)?r[t]=X[e]:(s.push(e),Y.hasOwnProperty(e)||(Y[e]=[]),Y[e].push(()=>{r[t]=X[e],++o===s.length&&i(r)}))}),0===s.length&&i(r)},ee={},te=e=>{for(var t="";L[e];)t+=q[L[e++]];return t};function ne(e,t,n={}){return function(e,t,n={}){var i=t.name;if(!e)throw new K(`type "${i}" must have a positive integer typeid pointer`);if(X.hasOwnProperty(e)){if(n.Qa)return;throw new K(`Cannot register type '${i}' twice`)}X[e]=t,delete J[e],Y.hasOwnProperty(e)&&(t=Y[e],delete Y[e],t.forEach(e=>e()))}(e,t,n)}var ie,re=e=>{throw new K(e.fa.ia.ga.name+" instance already deleted")},se=!1,oe=()=>{},ae=(e,t,n)=>t===n?e:void 0===n.la||null===(e=ae(e,t,n.la))?null:n.La(e),le={},ce=[],he=()=>{for(;ce.length;){var e=ce.pop();e.fa.ra=!1,e.delete()}},ue={},de=(e,t)=>{if(!t.ia||!t.ha)throw new Z("makeClassHandle requires ptr and ptrType");if(!!t.pa!=!!t.ja)throw new Z("Both smartPtrType and smartPtr must be specified");return t.count={value:1},pe(Object.create(e,{fa:{value:t,writable:!0}}))},pe=e=>"undefined"==typeof FinalizationRegistry?(pe=e=>e,e):(se=new FinalizationRegistry(e=>{--(e=e.fa).count.value,0===e.count.value&&(e.ja?e.pa.oa(e.ja):e.ia.ga.oa(e.ha))}),pe=e=>{var t=e.fa;return t.ja&&se.register(e,{fa:t},e),e},oe=e=>{se.unregister(e)},pe(e));function fe(){}var me=(e,t)=>Object.defineProperty(t,"name",{value:e}),ge=(e,t,n)=>{if(void 0===e[t].ka){var i=e[t];e[t]=function(...i){if(!e[t].ka.hasOwnProperty(i.length))throw new K(`Function '${n}' called with an invalid number of arguments (${i.length}) - expects one of (${e[t].ka})!`);return e[t].ka[i.length].apply(this,i)},e[t].ka=[],e[t].ka[i.wa]=i}},ve=(e,t,n)=>{if(h.hasOwnProperty(e)){if(void 0===n||void 0!==h[e].ka&&void 0!==h[e].ka[n])throw new K(`Cannot register public name '${e}' twice`);if(ge(h,e,e),h.hasOwnProperty(n))throw new K(`Cannot register multiple overloads of a function with the same number of arguments (${n})!`);h[e].ka[n]=t}else h[e]=t,void 0!==n&&(h[e].Wa=n)};function ye(e,t,n,i,r,s,o,a){this.name=e,this.constructor=t,this.sa=n,this.oa=i,this.la=r,this.Oa=s,this.va=o,this.La=a,this.Sa=[]}var be=(e,t,n)=>{for(;t!==n;){if(!t.va)throw new K(`Expected null or instance of ${n.name}, got an instance of ${t.name}`);e=t.va(e),t=t.la}return e};function we(e,t){if(null===t){if(this.Ca)throw new K(`null is not a valid ${this.name}`);return 0}if(!t.fa)throw new K(`Cannot pass "${Ue(t)}" as a ${this.name}`);if(!t.fa.ha)throw new K(`Cannot pass deleted object as a pointer of type ${this.name}`);return be(t.fa.ha,t.fa.ia.ga,this.ga)}function xe(e,t){if(null===t){if(this.Ca)throw new K(`null is not a valid ${this.name}`);if(this.ya){var n=this.ua();return null!==e&&e.push(this.oa,n),n}return 0}if(!t||!t.fa)throw new K(`Cannot pass "${Ue(t)}" as a ${this.name}`);if(!t.fa.ha)throw new K(`Cannot pass deleted object as a pointer of type ${this.name}`);if(!this.xa&&t.fa.ia.xa)throw new K(`Cannot convert argument of type ${t.fa.pa?t.fa.pa.name:t.fa.ia.name} to parameter type ${this.name}`);if(n=be(t.fa.ha,t.fa.ia.ga,this.ga),this.ya){if(void 0===t.fa.ja)throw new K("Passing raw pointer to smart pointer is illegal");switch(this.Ua){case 0:if(t.fa.pa!==this)throw new K(`Cannot convert argument of type ${t.fa.pa?t.fa.pa.name:t.fa.ia.name} to parameter type ${this.name}`);n=t.fa.ja;break;case 1:n=t.fa.ja;break;case 2:if(t.fa.pa===this)n=t.fa.ja;else{var i=t.clone();n=this.Ta(n,Be(()=>i.delete())),null!==e&&e.push(this.oa,n)}break;default:throw new K("Unsupporting sharing policy")}}return n}function Ce(e,t){if(null===t){if(this.Ca)throw new K(`null is not a valid ${this.name}`);return 0}if(!t.fa)throw new K(`Cannot pass "${Ue(t)}" as a ${this.name}`);if(!t.fa.ha)throw new K(`Cannot pass deleted object as a pointer of type ${this.name}`);if(t.fa.ia.xa)throw new K(`Cannot convert argument of type ${t.fa.ia.name} to parameter type ${this.name}`);return be(t.fa.ha,t.fa.ia.ga,this.ga)}function Se(e,t,n,i,r,s,o,a,l,c,h){this.name=e,this.ga=t,this.Ca=n,this.xa=i,this.ya=r,this.Ra=s,this.Ua=o,this.Ja=a,this.ua=l,this.Ta=c,this.oa=h,r||void 0!==t.la?this.toWireType=xe:(this.toWireType=i?we:Ce,this.na=null)}var ke,Le,Ee=(e,t,n)=>{if(!h.hasOwnProperty(e))throw new Z("Replacing nonexistent public symbol");void 0!==h[e].ka&&void 0!==n?h[e].ka[n]=t:(h[e]=t,h[e].wa=n)},Pe=(e,t)=>(...n)=>((e,t,n=[])=>(e.includes("j")?(e=e.replace(/p/g,"i"),t=(0,h["dynCall_"+e])(t,...n)):t=ke.get(t)(...n),t))(e,t,n),Te=(e,t)=>{var n=(e=te(e)).includes("j")?Pe(e,t):ke.get(t);if("function"!=typeof n)throw new K(`unknown function pointer with signature ${e}: ${t}`);return n},Ae=e=>{e=ht(e);var t=te(e);return dt(e),t},Me=(e,t)=>{var n=[],i={};throw t.forEach(function e(t){i[t]||X[t]||(J[t]?J[t].forEach(e):(n.push(t),i[t]=!0))}),new Le(`${e}: `+n.map(Ae).join([", "]))},Ie=(e,t)=>{for(var n=[],i=0;i<e;i++)n.push(A[t+4*i>>2]);return n};function _e(e,t,n,i,r){var s=t.length;if(2>s)throw new K("argTypes array size mismatch! Must at least get return value and 'this' types!");var o=null!==t[1]&&null!==n,a=function(e){for(var t=1;t<e.length;++t)if(null!==e[t]&&void 0===e[t].na)return!0;return!1}(t),l="void"!==t[0].name,c=s-2,h=Array(c),u=[],d=[];return me(e,function(...e){if(d.length=0,u.length=o?2:1,u[0]=r,o){var n=t[1].toWireType(d,this);u[1]=n}for(var s=0;s<c;++s)h[s]=t[s+2].toWireType(d,e[s]),u.push(h[s]);if(e=i(...u),a)G(d);else for(s=o?1:2;s<t.length;s++){var p=1===s?n:h[s-2];null!==t[s].na&&t[s].na(p)}return n=l?t[0].fromWireType(e):void 0})}var Oe=e=>{const t=(e=e.trim()).indexOf("(");return-1!==t?e.substr(0,t):e},Ne=[],De=[],Re=e=>{9<e&&0===--De[e+1]&&(De[e]=void 0,Ne.push(e))},Fe=e=>{if(!e)throw new K("Cannot use deleted val. handle = "+e);return De[e]},Be=e=>{switch(e){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:const t=Ne.pop()||De.length;return De[t]=e,De[t+1]=1,t}},Ve={name:"emscripten::val",fromWireType:e=>{var t=Fe(e);return Re(e),t},toWireType:(e,t)=>Be(t),ma:8,readValueFromPointer:$,na:null},je=(e,t,n)=>{switch(t){case 1:return n?function(e){return this.fromWireType(k[e])}:function(e){return this.fromWireType(L[e])};case 2:return n?function(e){return this.fromWireType(E[e>>1])}:function(e){return this.fromWireType(P[e>>1])};case 4:return n?function(e){return this.fromWireType(T[e>>2])}:function(e){return this.fromWireType(A[e>>2])};default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},He=(e,t)=>{var n=X[e];if(void 0===n)throw e=`${t} has unknown type ${Ae(e)}`,new K(e);return n},Ue=e=>{if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e},ze=(e,t)=>{switch(t){case 4:return function(e){return this.fromWireType(M[e>>2])};case 8:return function(e){return this.fromWireType(I[e>>3])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}},We=(e,t,n)=>{switch(t){case 1:return n?e=>k[e]:e=>L[e];case 2:return n?e=>E[e>>1]:e=>P[e>>1];case 4:return n?e=>T[e>>2]:e=>A[e>>2];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},Ge="undefined"!=typeof TextDecoder?new TextDecoder:void 0,$e=(e,t,n)=>{var i=t+n;for(n=t;e[n]&&!(n>=i);)++n;if(16<n-t&&e.buffer&&Ge)return Ge.decode(e.subarray(t,n));for(i="";t<n;){var r=e[t++];if(128&r){var s=63&e[t++];if(192==(224&r))i+=String.fromCharCode((31&r)<<6|s);else{var o=63&e[t++];65536>(r=224==(240&r)?(15&r)<<12|s<<6|o:(7&r)<<18|s<<12|o<<6|63&e[t++])?i+=String.fromCharCode(r):(r-=65536,i+=String.fromCharCode(55296|r>>10,56320|1023&r))}}else i+=String.fromCharCode(r)}return i},Ze="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,qe=(e,t)=>{for(var n=e>>1,i=n+t/2;!(n>=i)&&P[n];)++n;if(32<(n<<=1)-e&&Ze)return Ze.decode(L.subarray(e,n));for(n="",i=0;!(i>=t/2);++i){var r=E[e+2*i>>1];if(0==r)break;n+=String.fromCharCode(r)}return n},Ke=(e,t,n)=>{if(n??(n=2147483647),2>n)return 0;var i=t;n=(n-=2)<2*e.length?n/2:e.length;for(var r=0;r<n;++r)E[t>>1]=e.charCodeAt(r),t+=2;return E[t>>1]=0,t-i},Ye=e=>2*e.length,Xe=(e,t)=>{for(var n=0,i="";!(n>=t/4);){var r=T[e+4*n>>2];if(0==r)break;++n,65536<=r?(r-=65536,i+=String.fromCharCode(55296|r>>10,56320|1023&r)):i+=String.fromCharCode(r)}return i},Je=(e,t,n)=>{if(n??(n=2147483647),4>n)return 0;var i=t;n=i+n-4;for(var r=0;r<e.length;++r){var s=e.charCodeAt(r);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++r)),T[t>>2]=s,(t+=4)+4>n)break}return T[t>>2]=0,t-i},Qe=e=>{for(var t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);55296<=i&&57343>=i&&++n,t+=4}return t},et=[],tt={},nt=e=>{var t=tt[e];return void 0===t?te(e):t},it=()=>{function e(e){e.$$$embind_global$$$=e;var t="object"==typeof $$$embind_global$$$&&e.$$$embind_global$$$==e;return t||delete e.$$$embind_global$$$,t}if("object"==typeof globalThis)return globalThis;if("object"==typeof $$$embind_global$$$)return $$$embind_global$$$;if("object"==typeof global&&e(global)?$$$embind_global$$$=global:"object"==typeof self&&e(self)&&($$$embind_global$$$=self),"object"==typeof $$$embind_global$$$)return $$$embind_global$$$;throw Error("unable to get global object.")},rt=Reflect.construct,st=[null,[],[]];Z=h.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}};for(var ot=Array(256),at=0;256>at;++at)ot[at]=String.fromCharCode(at);q=ot,K=h.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},Object.assign(fe.prototype,{isAliasOf:function(e){if(!(this instanceof fe&&e instanceof fe))return!1;var t=this.fa.ia.ga,n=this.fa.ha;e.fa=e.fa;var i=e.fa.ia.ga;for(e=e.fa.ha;t.la;)n=t.va(n),t=t.la;for(;i.la;)e=i.va(e),i=i.la;return t===i&&n===e},clone:function(){if(this.fa.ha||re(this),this.fa.ta)return this.fa.count.value+=1,this;var e=pe,t=Object,n=t.create,i=Object.getPrototypeOf(this),r=this.fa;return(e=e(n.call(t,i,{fa:{value:{count:r.count,ra:r.ra,ta:r.ta,ha:r.ha,ia:r.ia,ja:r.ja,pa:r.pa}}}))).fa.count.value+=1,e.fa.ra=!1,e},delete(){if(this.fa.ha||re(this),this.fa.ra&&!this.fa.ta)throw new K("Object already scheduled for deletion");oe(this);var e=this.fa;--e.count.value,0===e.count.value&&(e.ja?e.pa.oa(e.ja):e.ia.ga.oa(e.ha)),this.fa.ta||(this.fa.ja=void 0,this.fa.ha=void 0)},isDeleted:function(){return!this.fa.ha},deleteLater:function(){if(this.fa.ha||re(this),this.fa.ra&&!this.fa.ta)throw new K("Object already scheduled for deletion");return ce.push(this),1===ce.length&&ie&&ie(he),this.fa.ra=!0,this}}),h.getInheritedInstanceCount=()=>Object.keys(ue).length,h.getLiveInheritedInstances=()=>{var e,t=[];for(e in ue)ue.hasOwnProperty(e)&&t.push(ue[e]);return t},h.flushPendingDeletes=he,h.setDelayFunction=e=>{ie=e,ce.length&&ie&&ie(he)},Object.assign(Se.prototype,{Pa(e){return this.Ja&&(e=this.Ja(e)),e},Ha(e){var t;null==(t=this.oa)||t.call(this,e)},ma:8,readValueFromPointer:$,fromWireType:function(e){function t(){return this.ya?de(this.ga.sa,{ia:this.Ra,ha:n,pa:this,ja:e}):de(this.ga.sa,{ia:this,ha:e})}var n=this.Pa(e);if(!n)return this.Ha(e),null;var i=((e,t)=>{if(void 0===t)throw new K("ptr should not be undefined");for(;e.la;)t=e.va(t),e=e.la;return ue[t]})(this.ga,n);if(void 0!==i)return 0===i.fa.count.value?(i.fa.ha=n,i.fa.ja=e,i.clone()):(i=i.clone(),this.Ha(e),i);if(i=this.ga.Oa(n),!(i=le[i]))return t.call(this);i=this.xa?i.Ka:i.pointerType;var r=ae(n,this.ga,i.ga);return null===r?t.call(this):this.ya?de(i.ga.sa,{ia:i,ha:r,pa:this,ja:e}):de(i.ga.sa,{ia:i,ha:r})}}),Le=h.UnboundTypeError=((e,t)=>{var n=me(t,function(e){this.name=t,this.message=e,void 0!==(e=Error(e).stack)&&(this.stack=this.toString()+"\n"+e.replace(/^Error(:[^\n]*)?\n/,""))});return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:`${this.name}: ${this.message}`},n})(Error,"UnboundTypeError"),De.push(0,1,void 0,1,null,1,!0,1,!1,1),h.count_emval_handles=()=>De.length/2-5-Ne.length;var lt={A:()=>{V("")},u:e=>{var t=W[e];delete W[e];var n=t.elements,i=n.length,r=n.map(e=>e.Ba).concat(n.map(e=>e.Ea)),s=t.ua,o=t.oa;Q([e],r,e=>(n.forEach((t,n)=>{var r=e[n],s=t.za,o=t.Aa,a=e[n+i],l=t.Da,c=t.Fa;t.read=e=>r.fromWireType(s(o,e)),t.write=(e,t)=>{var n=[];l(c,e,a.toWireType(n,t)),G(n)}}),[{name:t.name,fromWireType:e=>{for(var t=Array(i),r=0;r<i;++r)t[r]=n[r].read(e);return o(e),t},toWireType:(e,r)=>{if(i!==r.length)throw new TypeError(`Incorrect number of tuple elements for ${t.name}: expected=${i}, actual=${r.length}`);for(var a=s(),l=0;l<i;++l)n[l].write(a,r[l]);return null!==e&&e.push(o,a),a},ma:8,readValueFromPointer:$,na:o}]))},m:e=>{var t=ee[e];delete ee[e];var n=t.ua,i=t.oa,r=t.Ia,s=r.map(e=>e.Ba).concat(r.map(e=>e.Ea));Q([e],s,e=>{var s={};return r.forEach((t,n)=>{var i=e[n],o=t.za,a=t.Aa,l=e[n+r.length],c=t.Da,h=t.Fa;s[t.Na]={read:e=>i.fromWireType(o(a,e)),write:(e,t)=>{var n=[];c(h,e,l.toWireType(n,t)),G(n)}}}),[{name:t.name,fromWireType:e=>{var t,n={};for(t in s)n[t]=s[t].read(e);return i(e),n},toWireType:(e,t)=>{for(var r in s)if(!(r in t))throw new TypeError(`Missing field: "${r}"`);var o=n();for(r in s)s[r].write(o,t[r]);return null!==e&&e.push(i,o),o},ma:8,readValueFromPointer:$,na:i}]})},x:()=>{},H:(e,t,n,i)=>{ne(e,{name:t=te(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?n:i},ma:8,readValueFromPointer:function(e){return this.fromWireType(L[e])},na:null})},j:(e,t,n,i,r,s,o,a,l,c,h,u,d)=>{h=te(h),s=Te(r,s),a&&(a=Te(o,a)),c&&(c=Te(l,c)),d=Te(u,d);var p=(e=>{if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=t&&57>=t?`_${e}`:e})(h);ve(p,function(){Me(`Cannot construct ${h} due to unbound types`,[i])}),Q([e,t,n],i?[i]:[],t=>{if(t=t[0],i)var n=t.ga,r=n.sa;else r=fe.prototype;t=me(h,function(...e){if(Object.getPrototypeOf(this)!==o)throw new K("Use 'new' to construct "+h);if(void 0===u.qa)throw new K(h+" has no accessible constructor");var t=u.qa[e.length];if(void 0===t)throw new K(`Tried to invoke ctor of ${h} with invalid number of parameters (${e.length}) - expected (${Object.keys(u.qa).toString()}) parameters instead!`);return t.apply(this,e)});var o=Object.create(r,{constructor:{value:t}});t.prototype=o;var l,u=new ye(h,t,o,d,n,s,a,c);return u.la&&((l=u.la).Ga??(l.Ga=[]),u.la.Ga.push(u)),n=new Se(h,u,!0,!1,!1),l=new Se(h+"*",u,!1,!1,!1),r=new Se(h+" const*",u,!1,!0,!1),le[e]={pointerType:l,Ka:r},Ee(p,t),[n,l,r]})},h:(e,t,n,i,r,s)=>{var o=Ie(t,n);r=Te(i,r),Q([],[e],e=>{var n=`constructor ${(e=e[0]).name}`;if(void 0===e.ga.qa&&(e.ga.qa=[]),void 0!==e.ga.qa[t-1])throw new K(`Cannot register multiple constructors with identical number of parameters (${t-1}) for class '${e.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return e.ga.qa[t-1]=()=>{Me(`Cannot construct ${e.name} due to unbound types`,o)},Q([],o,i=>(i.splice(1,0,null),e.ga.qa[t-1]=_e(n,i,null,r,s),[])),[]})},a:(e,t,n,i,r,s,o,a)=>{var l=Ie(n,i);t=te(t),t=Oe(t),s=Te(r,s),Q([],[e],e=>{function i(){Me(`Cannot call ${r} due to unbound types`,l)}var r=`${(e=e[0]).name}.${t}`;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),a&&e.ga.Sa.push(t);var c=e.ga.sa,h=c[t];return void 0===h||void 0===h.ka&&h.className!==e.name&&h.wa===n-2?(i.wa=n-2,i.className=e.name,c[t]=i):(ge(c,t,r),c[t].ka[n-2]=i),Q([],l,i=>(i=_e(r,i,e,s,o),void 0===c[t].ka?(i.wa=n-2,c[t]=i):c[t].ka[n-2]=i,[])),[]})},E:(e,t,n)=>{e=te(e),Q([],[t],t=>(t=t[0],h[e]=t.fromWireType(n),[]))},G:e=>ne(e,Ve),i:(e,t,n,i)=>{function r(){}t=te(t),r.values={},ne(e,{name:t,constructor:r,fromWireType:function(e){return this.constructor.values[e]},toWireType:(e,t)=>t.value,ma:8,readValueFromPointer:je(t,n,i),na:null}),ve(t,r)},c:(e,t,n)=>{var i=He(e,"enum");t=te(t),e=i.constructor,i=Object.create(i.constructor.prototype,{value:{value:n},constructor:{value:me(`${i.name}_${t}`,function(){})}}),e.values[n]=i,e[t]=i},t:(e,t,n)=>{ne(e,{name:t=te(t),fromWireType:e=>e,toWireType:(e,t)=>t,ma:8,readValueFromPointer:ze(t,n),na:null})},g:(e,t,n,i,r,s)=>{var o=Ie(t,n);e=te(e),e=Oe(e),r=Te(i,r),ve(e,function(){Me(`Cannot call ${e} due to unbound types`,o)},t-1),Q([],o,n=>(n=[n[0],null].concat(n.slice(1)),Ee(e,_e(e,n,null,r,s),t-1),[]))},f:(e,t,n,i,r)=>{if(t=te(t),-1===r&&(r=4294967295),r=e=>e,0===i){var s=32-8*n;r=e=>e<<s>>>s}var o=t.includes("unsigned")?function(e,t){return t>>>0}:function(e,t){return t};ne(e,{name:t,fromWireType:r,toWireType:o,ma:8,readValueFromPointer:We(t,n,0!==i),na:null})},b:(e,t,n)=>{function i(e){return new r(k.buffer,A[e+4>>2],A[e>>2])}var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];ne(e,{name:n=te(n),fromWireType:i,ma:8,readValueFromPointer:i},{Qa:!0})},s:(e,t)=>{var n="std::string"===(t=te(t));ne(e,{name:t,fromWireType:function(e){var t=A[e>>2],i=e+4;if(n)for(var r=i,s=0;s<=t;++s){var o=i+s;if(s==t||0==L[o]){if(r=r?$e(L,r,o-r):"",void 0===a)var a=r;else a+=String.fromCharCode(0),a+=r;r=o+1}}else{for(a=Array(t),s=0;s<t;++s)a[s]=String.fromCharCode(L[i+s]);a=a.join("")}return dt(e),a},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i,r,s="string"==typeof t;if(!(s||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array))throw new K("Cannot pass non-string to std::string");if(n&&s)for(i=r=0;i<t.length;++i){var o=t.charCodeAt(i);127>=o?r++:2047>=o?r+=2:55296<=o&&57343>=o?(r+=4,++i):r+=3}else r=t.length;if(o=(r=pt(4+(i=r)+1))+4,A[r>>2]=i,n&&s){if(s=o,o=i+1,i=L,0<o){o=s+o-1;for(var a=0;a<t.length;++a){var l=t.charCodeAt(a);if(55296<=l&&57343>=l&&(l=65536+((1023&l)<<10)|1023&t.charCodeAt(++a)),127>=l){if(s>=o)break;i[s++]=l}else{if(2047>=l){if(s+1>=o)break;i[s++]=192|l>>6}else{if(65535>=l){if(s+2>=o)break;i[s++]=224|l>>12}else{if(s+3>=o)break;i[s++]=240|l>>18,i[s++]=128|l>>12&63}i[s++]=128|l>>6&63}i[s++]=128|63&l}}i[s]=0}}else if(s)for(s=0;s<i;++s){if(255<(a=t.charCodeAt(s)))throw dt(o),new K("String has UTF-16 code units that do not fit in 8 bits");L[o+s]=a}else for(s=0;s<i;++s)L[o+s]=t[s];return null!==e&&e.push(dt,r),r},ma:8,readValueFromPointer:$,na(e){dt(e)}})},l:(e,t,n)=>{if(n=te(n),2===t)var i=qe,r=Ke,s=Ye,o=e=>P[e>>1];else 4===t&&(i=Xe,r=Je,s=Qe,o=e=>A[e>>2]);ne(e,{name:n,fromWireType:e=>{for(var n,r=A[e>>2],s=e+4,a=0;a<=r;++a){var l=e+4+a*t;a!=r&&0!=o(l)||(s=i(s,l-s),void 0===n?n=s:(n+=String.fromCharCode(0),n+=s),s=l+t)}return dt(e),n},toWireType:(e,i)=>{if("string"!=typeof i)throw new K(`Cannot pass non-string to C++ string type ${n}`);var o=s(i),a=pt(4+o+t);return A[a>>2]=o/t,r(i,a+4,o+t),null!==e&&e.push(dt,a),a},ma:8,readValueFromPointer:$,na(e){dt(e)}})},q:(e,t,n,i,r,s)=>{W[e]={name:te(t),ua:Te(n,i),oa:Te(r,s),elements:[]}},D:(e,t,n,i,r,s,o,a,l)=>{W[e].elements.push({Ba:t,za:Te(n,i),Aa:r,Ea:s,Da:Te(o,a),Fa:l})},r:(e,t,n,i,r,s)=>{ee[e]={name:te(t),ua:Te(n,i),oa:Te(r,s),Ia:[]}},k:(e,t,n,i,r,s,o,a,l,c)=>{ee[e].Ia.push({Na:te(t),Ba:n,za:Te(i,r),Aa:s,Ea:o,Da:Te(a,l),Fa:c})},I:(e,t)=>{ne(e,{Va:!0,name:t=te(t),ma:0,fromWireType:()=>{},toWireType:()=>{}})},o:(e,t,n,i)=>(e=et[e])(null,t=Fe(t),n,i),e:(e,t,n,i,r)=>(e=et[e])(t=Fe(t),t[n=nt(n)],i,r),J:Re,v:e=>0===e?Be(it()):(e=nt(e),Be(it()[e])),d:(e,t,n)=>{var i=((e,t)=>{for(var n=Array(e),i=0;i<e;++i)n[i]=He(A[t+4*i>>2],"parameter "+i);return n})(e,t),r=i.shift();e--;var s=Array(e);return t=`methodCaller<(${i.map(e=>e.name).join(", ")}) => ${r.name}>`,(e=>{var t=et.length;return et.push(e),t})(me(t,(t,o,a,l)=>{for(var c=0,h=0;h<e;++h)s[h]=i[h].readValueFromPointer(l+c),c+=i[h].ma;return o=1===n?rt(o,s):o.apply(t,s),t=[],o=r.toWireType(t,o),t.length&&(A[a>>2]=Be(t)),o}))},n:e=>{9<e&&(De[e+1]+=1)},K:()=>Be([]),C:e=>Be(nt(e)),B:e=>{var t=Fe(e);G(t),Re(e)},F:(e,t)=>(e=(e=He(e,"_emval_take_value")).readValueFromPointer(t),Be(e)),y:e=>{var t=L.length;if(2147483648<(e>>>=0))return!1;for(var n=1;4>=n;n*=2){var i=t*(1+.2/n);i=Math.min(i,e+100663296);e:{i=(Math.min(2147483648,65536*Math.ceil(Math.max(e,i)/65536))-S.buffer.byteLength+65535)/65536;try{S.grow(i),O();var r=1;break e}catch(a){}r=void 0}if(r)return!0}return!1},z:()=>52,w:function(){return 70},p:(e,t,n,i)=>{for(var r=0,s=0;s<n;s++){var o=A[t>>2],a=A[t+4>>2];t+=8;for(var l=0;l<a;l++){var c=L[o+l],h=st[e];0===c||10===c?((1===e?x:C)($e(h,0)),h.length=0):h.push(c)}r+=a}return A[i>>2]=r,0}},ct=function(){var e={a:lt};return F++,j??(j=H("pathkit.wasm")?"pathkit.wasm":h.locateFile?h.locateFile("pathkit.wasm",y):y+"pathkit.wasm"),function(e,t){var n=j;return"function"!=typeof WebAssembly.instantiateStreaming||H(n)||U(n)||f||"function"!=typeof fetch?z(n,e,t):fetch(n,{credentials:"same-origin"}).then(i=>WebAssembly.instantiateStreaming(i,e).then(t,function(i){return C(`wasm streaming compile failed: ${i}`),C("falling back to ArrayBuffer instantiation"),z(n,e,t)}))}(e,function(e){ct=e.instance.exports,S=ct.L,O(),ke=ct.ba,D.unshift(ct.M),0==--F&&B&&(e=B,B=null,e())}).catch(n),{}}(),ht=e=>(ht=ct.N)(e);h.__Z6ToCmdsRK6SkPath=(e,t)=>(h.__Z6ToCmdsRK6SkPath=ct.O)(e,t),h.__Z8FromCmdsmi=(e,t,n)=>(h.__Z8FromCmdsmi=ct.P)(e,t,n),h.__Z7NewPathv=e=>(h.__Z7NewPathv=ct.Q)(e),h.__Z8CopyPathRK6SkPath=(e,t)=>(h.__Z8CopyPathRK6SkPath=ct.R)(e,t),h.__Z6EqualsRK6SkPathS1_=(e,t)=>(h.__Z6EqualsRK6SkPathS1_=ct.S)(e,t),h.__Z7IsEmptyRK6SkPath=e=>(h.__Z7IsEmptyRK6SkPath=ct.T)(e),h.__Z11ToSVGStringRK6SkPath=(e,t)=>(h.__Z11ToSVGStringRK6SkPath=ct.U)(e,t),h.__Z13FromSVGStringNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEE=(e,t)=>(h.__Z13FromSVGStringNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEE=ct.V)(e,t),h.__Z13ApplySimplifyR6SkPath=e=>(h.__Z13ApplySimplifyR6SkPath=ct.W)(e),h.__Z14ApplyAsWindingR6SkPath=e=>(h.__Z14ApplyAsWindingR6SkPath=ct.X)(e),h.__Z11ApplyPathOpR6SkPathRKS_8SkPathOp=(e,t,n)=>(h.__Z11ApplyPathOpR6SkPathRKS_8SkPathOp=ct.Y)(e,t,n),h.__Z10MakeFromOpRK6SkPathS1_8SkPathOp=(e,t,n,i)=>(h.__Z10MakeFromOpRK6SkPathS1_8SkPathOp=ct.Z)(e,t,n,i),h.__Z14ResolveBuilderR11SkOpBuilder=(e,t)=>(h.__Z14ResolveBuilderR11SkOpBuilder=ct._)(e,t),h.__Z8ToCanvasRK6SkPathN10emscripten3valE=(e,t)=>(h.__Z8ToCanvasRK6SkPathN10emscripten3valE=ct.$)(e,t),h.__Z8ToPath2DRK6SkPath=(e,t)=>(h.__Z8ToPath2DRK6SkPath=ct.aa)(e,t);var ut,dt=h._free=e=>(dt=h._free=ct.ca)(e),pt=h._malloc=e=>(pt=h._malloc=ct.da)(e);function ft(){var e;if(!(0<F)){for(;0<N.length;)N.shift()(h);if(!(0<F||ut||(ut=!0,h.calledRun=!0,_))){for(;0<D.length;)D.shift()(h);for(t(h),null==(e=h.onRuntimeInitialized)||e.call(h);0<R.length;)R.shift()(h)}}}return h.dynCall_jiji=(e,t,n,i,r)=>(h.dynCall_jiji=ct.ea)(e,t,n,i,r),B=function e(){ut||ft(),ut||(B=e)},ft(),u});const Qn=e=>{let t=Math.max(e.max.x-e.min.x,e.max.y-e.min.y);return t=1e3/t,t};let ei=null;const ti=(e,t)=>0!==e.handleOut.x||0!==e.handleOut.y||0!==t.handleIn.x||0!==t.handleIn.y?[ei.CUBIC_VERB,e.position.x+e.handleOut.x,e.position.y+e.handleOut.y,t.position.x+t.handleIn.x,t.position.y+t.handleIn.y,t.position.x,t.position.y]:[ei.LINE_VERB,t.position.x,t.position.y];class ni{constructor(e,t,n,i){this.p0=e,this.p1=t,this.p2=n,this.w=i}subdivide(){const{p0:e,p1:t,p2:n,w:i}=this,r=e,s=e.clone().add(t.clone().mulScalar(i)).mulScalar(1/(1+i)),o=e.clone().add(t.clone().mulScalar(2*i)).add(n).mulScalar(1/(2+2*i)),a=t.clone().mulScalar(i).add(n).mulScalar(1/(1+i)),l=n,c=Math.sqrt((1+i)/2);return[new ni(r,s,o,c),new ni(o,a,l,c)]}approximateCubic(){const{p0:e,p1:t,p2:n,w:i}=this,r=4/3*i/(1+i),s=t.clone().sub(e).mulScalar(r),o=t.clone().sub(n).mulScalar(r);return[new Wn(e,new It,s),new Wn(n,o,new It)]}approximateCubicPieces(){if(Math.abs(this.w-1)<.01)return this.approximateCubic();const[e,t]=this.subdivide(),n=e.approximateCubicPieces(),i=t.approximateCubicPieces();return i[0].handleIn=n[n.length-1].handleIn,n.pop(),[...n,...i]}}const ii=e=>{const t=[];let n=null;for(let i of e){const e=i[0];if(e===ei.MOVE_VERB){const e=new It(i[1],i[2]),r=new Wn(e);n=new Ri([r]),t.push(n)}else if(e===ei.LINE_VERB&&n){const e=new It(i[1],i[2]),t=new Wn(e);n.anchors.push(t)}else if(e===ei.CUBIC_VERB&&n){const e=n.anchors[n.anchors.length-1];e.handleOut=new It(i[1]-e.position.x,i[2]-e.position.y);const t=new It(i[5],i[6]),r=new It(i[3]-t.x,i[4]-t.y),s=new Wn(t,r);n.anchors.push(s)}else if(e!==ei.QUAD_VERB&&e!==ei.CONIC_VERB||!n){if(e===ei.CLOSE_VERB&&n){if(n.anchors.length>1){const e=n.anchors[0],t=n.anchors[n.anchors.length-1];e.position._almostEquals(t.position)&&(n.anchors.pop(),e.handleIn=t.handleIn)}n.closed=!0}}else{const t=n.anchors[n.anchors.length-1],r=e===ei.CONIC_VERB?i[5]:1,s=t.position,o=new It(i[1],i[2]),a=new It(i[3],i[4]),l=new ni(s,o,a,r).approximateCubic();for(let e=0;e<l.length;e++){const i=l[e];0===e?t.handleOut=i.handleOut:n.anchors.push(i)}}}return new wi(t)};let ri=0;setInterval(()=>{0!==ri&&console.warn("PathKit memory leak",ri)},1e3);const si=(e,t=ei.FillType.EVENODD)=>{ri++;const n=(e=>{const t=[],n=e=>{if(e instanceof Ri){const n=e;if(0===n.anchors.length)return;let i=n.anchors[0];t.push([ei.MOVE_VERB,i.position.x,i.position.y]);for(let e=1,r=n.anchors.length;e<r;++e){let r=n.anchors[e];t.push(ti(i,r)),i=r}n.closed&&(t.push(ti(i,n.anchors[0])),t.push([ei.CLOSE_VERB]))}else if(e instanceof wi)for(let t of e.paths)n(t);else if(e instanceof xi)for(let t of e.items)n(t)};return n(e),t})(e),i=ei.FromCmds(n);return i.setFillType(t),i},oi=(e,t=!1)=>{e.getFillType()!==ei.FillType.EVENODD&&e.setFillType(ei.FillType.EVENODD);const n=e.toCmds(),i=ii(n);return t&&ci(e),i},ai=()=>(ri++,ei.NewPath()),li=e=>(ri++,e.copy()),ci=e=>{ri--,e.delete()},hi=(e,t,n,i,r,s)=>{const o="centered"!==s&&(e=>{const t=e.toCmds();return 0!==t.length&&t[t.length-1][0]===ei.CLOSE_VERB})(e);if(o){const o=li(e);o.stroke({width:2*t,miter_limit:r,join:ei.StrokeJoin[i.toUpperCase()],cap:ei.StrokeCap[n.toUpperCase()],res_scale:2}),"outer"===s?e.op(o,ei.PathOp.REVERSE_DIFFERENCE):"inner"===s&&e.op(o,ei.PathOp.INTERSECT),ci(o)}else e.stroke({width:t,miter_limit:r,join:ei.StrokeJoin[i.toUpperCase()],cap:ei.StrokeCap[n.toUpperCase()],res_scale:2});e.simplify()},ui=(e,t)=>(e instanceof Gn&&t instanceof Gn||e instanceof Hi&&t instanceof Hi)&&e.equals(t),di=1.6186993128582432,pi=1.6183825806646275,fi=(e,t,n,i)=>{const r=hs(e);if(!r)return new wi;const s="winding"===t?ei.FillType.WINDING:ei.FillType.EVENODD,o=new Array(5);o[0]=Qn(r),o[1]=o[0]*di,o[2]=o[1]*pi,o[3]=o[2]*di,o[4]=o[3]*pi;const a=t=>{const a=(t=>{const o=mi(r,t),a=n?vi(e,s,o):yi(e,s,o),l=i(a,t);bi(l,o.invert());for(const e of a)ci(e);return oi(l,!0)})(o[t]);return{result:a,length:gi(a)}},l=(e,t)=>{const n=e.length,i=t.length;return Math.abs(n-i)/(n+i)<=1e-4},c=[];for(let h=0;h<5;h++){const e=a(h);for(let t of c)if(l(t,e))return t.result;c.push(e)}return c[0].result},mi=(e,t)=>(new Ne).scaleScalar(t).translate(e.size().mulScalar(2)).rotate(t).translate(e.center().negate()),gi=e=>{let t=0;for(const n of e.paths)t+=n.length();return t},vi=(e,t,n)=>e.map(e=>{if(e instanceof xi){let i=ai();for(let r of e.allPathsAndCompoundPaths()){const e=si(r,t);bi(e,n),i.op(e,ei.PathOp.UNION),ci(e)}return i}{const i=si(e,t);return bi(i,n),i}}),yi=(e,t,n)=>e.flatMap(e=>{if(e instanceof xi)return yi(e.items,t,n);{const i=si(e,t);return bi(i,n),i}}),bi=(e,t)=>{const{a:n,b:i,c:r,d:s,tx:o,ty:a}=t;e.transform(n,r,o,i,s,a,0,0,1)};let wi=(d=class extends Hn{constructor(e=[],t,n){super(),this.paths=e,this.stroke=t,this.fill=n}clone(){var e,t;return new d(this.paths.map(e=>e.clone()),null==(e=this.stroke)?void 0:e.clone(),null==(t=this.fill)?void 0:t.clone())}isValid(){return Array.isArray(this.paths)&&(void 0===this.stroke||Vi.isValid(this.stroke))&&(void 0===this.fill||ji.isValid(this.fill)||Hi.isValid(this.fill))&&this.paths.every(Ri.isValid)}affineTransform(e){for(let t of this.paths)t.affineTransform(e);return this.fill instanceof Hi&&this.fill.affineTransform(e),this}affineTransformWithoutTranslation(e){for(let t of this.paths)t.affineTransformWithoutTranslation(e);return this.fill instanceof Hi&&this.fill.affineTransformWithoutTranslation(e),this}allCompoundPaths(){return[this]}allPaths(){return[...this.paths]}allAnchors(){return this.paths.flatMap(e=>e.anchors)}allPathsAndCompoundPaths(){return[this]}hasStyle(){return Boolean(this.stroke)||Boolean(this.fill)}hasStrokeWithNonStandardAlignment(){return this.stroke&&!this.stroke.hairline&&"centered"!==this.stroke.alignment}assignFill(e){this.fill=e.clone();for(let t of this.paths)t.assignFill(e);return this}removeFill(){this.fill=void 0;for(let e of this.paths)e.removeFill();return this}assignStroke(e){this.stroke=e.clone();for(let t of this.paths)t.assignStroke(e);return this}removeStroke(){this.stroke=void 0;for(let e of this.paths)e.removeStroke();return this}assignStyle(e,t){this.stroke=null==t?void 0:t.clone(),this.fill=null==e?void 0:e.clone();for(let n of this.paths)n.assignStyle(e,t);return this}copyStyle(e){const t=e.firstStyled();return t&&(t.fill&&this.assignFill(t.fill),t.stroke&&this.assignStroke(t.stroke)),this}scaleStroke(e){return this.stroke&&(this.stroke.width*=e),this}firstStyled(){if(this.fill||this.stroke)return this}toSVGPathString(e){return this.paths.map(t=>t.toSVGPathString(e)).join("")}looseBoundingBox(){return hs(this.paths)}boundingBox(){return cs(this.paths)}isContainedByBoundingBox(e){const t=this.boundingBox();return!!t&&e.containsBoundingBox(t)}isIntersectedByBoundingBox(e){return this.paths.some(t=>t.isIntersectedByBoundingBox(e))}isOverlappedByBoundingBox(e){return this.paths.some(t=>t.isOverlappedByBoundingBox(e))}closestPoint(e,t){const{paths:n}=this;if(0===n.length)return;if(1===n.length)return n[0].closestPoint(e);let i,r=1/0;for(let s of n){const n=s.closestPoint(e,t);if(!n)continue;const o=e.distanceSquared(n.position);o<r&&(i=n,r=o)}return i}_primitives(){return this.paths.flatMap(e=>e._primitives())}containsPoint(e){return or(this,e)}styleContainsPoint(e){return ar(this,e)}reverse(){for(let e of this.paths)e.reverse();return this.paths.reverse(),this}rasterize(e){const t=nr(this,e);if(!t)return;const n=Ri.fromBoundingBox(t.boundingBox);return n.fill=t.fill,n}static booleanIntersect(e){return fi(e,"evenodd",!0,e=>{let t;for(const n of e)void 0===t?t=li(n):t.op(n,ei.PathOp.INTERSECT);return t})}static booleanDifference(e){return fi(e,"evenodd",!0,e=>{let t;for(const n of e)void 0===t?t=li(n):t.op(n,ei.PathOp.DIFFERENCE);return t})}static stroke(e,t={}){const{width:n=1,alignment:i="centered",miterLimit:r=4,join:s="miter",cap:o="butt"}=t;if(n<=0)return e.clone();return fi([e],"evenodd",!1,(e,t)=>{const a=ai();for(const l of e)hi(l,n*t,o,s,r,i),a.op(l,ei.PathOp.UNION);return a})}},d.displayName="CompoundPath",d.isValid=e=>e instanceof d&&e.isValid(),d.fromSVGPathString=e=>{const t=(e=>(ri++,ei.FromSVGString(e)))(e);return oi(t,!0)},d.fromOpenTypePath=e=>{const t=e.commands.map(e=>"M"===e.type?[ei.MOVE_VERB,e.x,e.y]:"L"===e.type?[ei.LINE_VERB,e.x,e.y]:"C"===e.type?[ei.CUBIC_VERB,e.x1,e.y1,e.x2,e.y2,e.x,e.y]:"Q"===e.type?[ei.QUAD_VERB,e.x1,e.y1,e.x,e.y]:[ei.CLOSE_VERB]);return ii(t)},d.booleanUnion=(e,t)=>{const n=e.flatMap(e=>e.allPathsAndCompoundPaths());return fi(n,t,!1,e=>{const t=ai();for(const n of e)t.op(n,ei.PathOp.UNION);return t})},d),xi=((p=class extends Hn{constructor(e=[]){super(),this.items=e}clone(){return new p(this.items.map(e=>e.clone()))}isValid(){return Array.isArray(this.items)&&this.items.every(Hn.isValid)}affineTransform(e){for(let t of this.items)t.affineTransform(e);return this}affineTransformWithoutTranslation(e){for(let t of this.items)t.affineTransformWithoutTranslation(e);return this}allCompoundPaths(){return this.items.flatMap(e=>e.allCompoundPaths())}allPaths(){return this.items.flatMap(e=>e.allPaths())}allAnchors(){return this.items.flatMap(e=>e.allAnchors())}allPathsAndCompoundPaths(){return this.items.flatMap(e=>e.allPathsAndCompoundPaths())}hasStyle(){for(let e of this.items)if(e.hasStyle())return!0;return!1}assignFill(e){for(let t of this.items)t.assignFill(e);return this}removeFill(){for(let e of this.items)e.removeFill();return this}assignStroke(e){for(let t of this.items)t.assignStroke(e);return this}removeStroke(){for(let e of this.items)e.removeStroke();return this}assignStyle(e,t){for(let n of this.items)n.assignStyle(e,t);return this}copyStyle(e){for(let t of this.items)t.copyStyle(e);return this}scaleStroke(e){for(let t of this.items)t.scaleStroke(e);return this}firstStyled(){for(const e of this.items){const t=e.firstStyled();if(t)return t}}looseBoundingBox(){return hs(this.items)}boundingBox(){return cs(this.items)}isContainedByBoundingBox(e){return 0!==this.items.length&&this.items.every(t=>t.isContainedByBoundingBox(e))}isIntersectedByBoundingBox(e){return this.items.some(t=>t.isIntersectedByBoundingBox(e))}isOverlappedByBoundingBox(e){return this.items.some(t=>t.isOverlappedByBoundingBox(e))}closestPoint(e,t){const{items:n}=this;if(0===n.length)return;if(1===n.length)return n[0].closestPoint(e,t);let i,r=1/0;for(let s of n){const n=s.closestPoint(e,t);if(!n)continue;const o=e.distanceSquared(n.position);o<r&&(i=n,r=o)}return i}_primitives(){return this.items.flatMap(e=>e._primitives())}containsPoint(e){return this.items.some(t=>t.containsPoint(e))}styleContainsPoint(e){return this.items.some(t=>t.styleContainsPoint(e))}reverse(){for(let e of this.items)e.reverse();return this.items.reverse(),this}rasterize(e){const t=nr(this,e);if(!t)return;const n=Ri.fromBoundingBox(t.boundingBox);return n.fill=t.fill,n}static isValid(e){return e instanceof p&&e.isValid()}static flatten(e,t,n){return((e,t,n=!1)=>{const i=e.looseBoundingBox();if(!i)return new xi;const r=Qn(i),s=mi(i,r),o=[],a=(e,i)=>{const r=t&&ui(i,t);let s=!1;for(let{color:t,pkPath:a}of o)ui(t,i)?(s=!0,a.op(e,ei.PathOp.UNION)):!n||s||r?a.op(e,ei.PathOp.DIFFERENCE):a.op(e,ei.PathOp.UNION);s||r?ci(e):o.push({color:i,pkPath:e})};for(let c of e.allPathsAndCompoundPaths()){if(c.fill instanceof ji){const e=si(c);bi(e,s),a(e,c.fill.color)}else if(c.fill instanceof Hi){const e=si(c);bi(e,s),a(e,c.fill)}if(c.stroke&&!c.stroke.hairline){const e=si(c);bi(e,s),hi(e,c.stroke.width*r,c.stroke.cap,c.stroke.join,c.stroke.miterLimit,c.stroke.alignment),a(e,c.stroke.color)}}s.invert();const l=[];for(let{color:c,pkPath:h}of o){bi(h,s);const e=oi(h,!0);c instanceof Hi?e.assignFill(c):e.assignFill(new ji(c.clone())),l.push(e)}return new xi(l)})(e,t,n)}}).displayName="Group",p);const Ci=1/3,Si=.5-Math.sqrt(3)/4,ki=.5+Math.sqrt(3)/4,Li=(e,t,n,i,r,s,o,a,l,c,h)=>{const u=i-n,{x:d,y:p}=t(n+u*Si),{x:f,y:m}=t(n+.25*u),{x:g,y:v}=t(n+.75*u),{x:y,y:b}=t(n+u*ki),w=Ai(s,d,f,o,g,y,a),x=Ai(l,p,m,c,v,b,h);let[C,S,k,L,E,P,T]=w,[A,M,I,_,O,N,D]=x;const R=Math.abs(E)+Math.abs(P)+Math.abs(T),F=Math.abs(O)+Math.abs(N)+Math.abs(D);if(R<r&&F<r){C+=T,S+=P,k+=E,A+=D,M+=N,I+=O;const e=(3*C-5*k)*Ci,t=(15*L-S)*Ci,n=(3*A-5*I)*Ci,i=(15*_-M)*Ci;return[new It(s,l),new It(e+t,n+i),new It(e-t,n-i),new It(a,h)]}if(++e>32)throw"Maximum subdivisions exceeded!\nMake sure your function is smooth or try a larger tolerance.";const B=Li(e,t,n,.5*(n+i),r,s,f,o,l,m,c),V=Li(e,t,.5*(n+i),i,r,o,g,a,c,v,h);return B.pop(),B.push(...V),B},Ei=Math.sqrt(3),Pi=1/6,Ti=1/12,Ai=(e,t,n,i,r,s,o)=>{const a=o+e,l=o-e,c=s+t,h=Ei*(s-t),u=r+n,d=r-n,p=2*i,f=a+p,m=a-p,g=c+u,v=c-u,y=l+d;return[Ti*(f+2*g),Pi*(y+h),Pi*(m+v),Pi*(l-2*d),Pi*(f-g),Pi*(y-h),Ti*(m-2*v)]},Mi=(e,t)=>Math.atan2(e,t)*Fe,Ii=e=>e*Fe,_i=Object.freeze(Object.defineProperty({__proto__:null,acos:e=>Math.acos(e)*Fe,asin:e=>Math.asin(e)*Fe,atan:e=>Math.atan(e)*Fe,atan2:Mi,cos:e=>Math.cos(e*Re),degreesFromRadians:Ii,radiansFromDegrees:e=>e*Re,sin:e=>Math.sin(e*Re),tan:e=>Math.tan(e*Re)},Symbol.toStringTag,{value:"Module"})),Oi=32,Ni=(e,t,n,i)=>{const r=Ln(e,n,t,i);if(!r||r.time1<0||r.time2<0)return;let{time1:s,time2:o}=r,a=0,l=e;s>o&&(a=r.time1-r.time2,l=n.clone().mulScalar(a).add(e));const c=i.isClockwiseFrom(n),h=Math.acos(n.dot(i)),u=Math.tan(.5*h)*(s-a),d=n.clone();c?d.rotate90():d.rotateNeg90();const p=d.clone().negate().mulScalar(u).add(l);let f,m=l.clone().sub(p).angleRadians();f=c?m+h-Math.PI:m-h+Math.PI;const g=Ri.fromArc(p,u,Ii(m),Ii(f));return s>o?bs(s-o)||g.anchors.unshift(new Wn(e)):o>s&&(bs(o-s)||g.anchors.push(new Wn(t))),g},Di=(e,t)=>{const{anchors:n,closed:i}=e;if(i&&n.length<2)return;if(!i&&n.length<3)return;let r;if("number"==typeof t){if(t<=0)return;r=[t]}else r=t;const s=ns(e.segments(),i),o=s.map(([e,t],n)=>{const i=r[n%r.length];if(!(i<=0))return((e,t,n)=>{if(e.isTangentToNext(t))return;const i=[{time1:0,time2:0,radius:0}],r=(e=e.clone().reverse()).tangentAtTime(0),s=t.tangentAtTime(0);if(e instanceof Bn&&t instanceof Bn){const o=.5*Math.acos(r.dot(s)),a=Math.abs(Math.tan(o));let l=n/a;const c=e.length(),h=t.length();return l=Math.min(l,c,h),i.push({time1:l/c,time2:l/h,radius:a*l}),i}const o=s.isClockwiseFrom(r);let a=1,l=1,c=0,h=0,u=0,d=0,p=0;for(let f=0;f<500;f++){let r=a/Oi,s=l/Oi,f=e.positionAtTime(r),m=t.positionAtTime(s),g=e.normalAtTime(r),v=t.normalAtTime(s).negate();o||(g.negate(),v.negate());const y=Ln(f,g,m,v);if(!y)break;const b=y.time1,w=y.time2;if((0!==u||0!==d)&&b>w!=u>d){const y=u-d,x=-y/(b-w-y);r=xt(c,a,x)/Oi,s=xt(h,l,x)/Oi,f=e.positionAtTime(r),m=t.positionAtTime(s),g=e.normalAtTime(r),v=t.normalAtTime(s).negate(),o||(g.negate(),v.negate());const C=xt(u+d,b+w,x)/2;if(C<p)break;const S=g.clone().mulScalar(C).add(f),k=v.clone().mulScalar(C).add(m);if(S.distanceSquared(k)<.001){if(i.push({time1:r,time2:s,radius:C}),C>=n)break;p=C}}if(u=b,d=w,c=a,h=l,b>w){if(a++,a>Oi)break}else if(l++,l>Oi)break}return i})(e,t,i)}),a=ns(o,i).map(([e,t],n)=>{if(void 0!==e&&void 0!==t)return((e,t)=>{const n=new Ri(e.map(e=>new Wn(new It(e.time2,e.radius))));n.anchors.push(new Wn(new It(e[e.length-1].time2,9999)));const i=new Ri(t.map(e=>new Wn(new It(1-e.time1,e.radius))));i.anchors.push(new Wn(new It(1-t[t.length-1].time1,9999)));const r=n.intersectionsWith([i]);if(r.length>0)return{time:r[0].position.x,radius:r[0].position.y}})(e,t)}),l=[];for(let c=0;c<o.length;++c){const t=o[c];if(void 0===t)continue;if(t.length<2)continue;const n=t[t.length-1];let i=n.radius,h=n.radius,u=n.time1,d=n.time2,p=a[e.normalizedTime(c-1)];p&&p.radius<i&&(i=p.radius,u=1-p.time);const f=a[c];f&&f.radius<h&&(h=f.radius,d=f.time);let m=r[c%r.length],g=Math.min(m,i,h);if(g<i||g<h){let e,n=t.length-1,i=t[n];for(;--n>=0;){if(e=t[n],e.radius<g){const t=(g-e.radius)/(i.radius-e.radius),n=xt(e.time1,i.time1,t),r=xt(e.time2,i.time2,t);u=Math.min(u,n),d=Math.min(d,r);break}i=e}}u=1-u;const[v,y]=s[c],b=v.positionAtTime(u),w=v.tangentAtTime(u),x=y.positionAtTime(d),C=y.tangentAtTime(d).negate(),S=Ni(b,x,w,C);S&&l.push({path:S,time1:u+c,time2:d+c+1})}e.splice(l)};let Ri=(f=class extends Hn{constructor(e=[],t=!1,n,i){super(),this.anchors=e,this.closed=t,this.stroke=n,this.fill=i}clone(){var e,t;return new f(this.anchors.map(e=>e.clone()),this.closed,null==(e=this.stroke)?void 0:e.clone(),null==(t=this.fill)?void 0:t.clone())}isValid(){return Array.isArray(this.anchors)&&this.anchors.every(Wn.isValid)&&(void 0===this.stroke||Vi.isValid(this.stroke))&&(void 0===this.fill||ji.isValid(this.fill)||Hi.isValid(this.fill))}affineTransform(e){for(let t of this.anchors)t.affineTransform(e);return this.fill instanceof Hi&&this.fill.affineTransform(e),this}affineTransformWithoutTranslation(e){for(let t of this.anchors)t.affineTransformWithoutTranslation(e);return this.fill instanceof Hi&&this.fill.affineTransformWithoutTranslation(e),this}allPaths(){return[this]}allAnchors(){return[...this.anchors]}allPathsAndCompoundPaths(){return[this]}hasStyle(){return Boolean(this.stroke)||Boolean(this.fill)}hasStrokeWithNonStandardAlignment(){return this.closed&&this.stroke&&!this.stroke.hairline&&"centered"!==this.stroke.alignment}assignFill(e){return this.fill=e.clone(),this}removeFill(){return this.fill=void 0,this}assignStroke(e){return this.stroke=e.clone(),this}removeStroke(){return this.stroke=void 0,this}assignStyle(e,t){return this.stroke=null==t?void 0:t.clone(),this.fill=null==e?void 0:e.clone(),this}copyStyle(e){var t,n;return e instanceof xi&&e.items.length>0?this.copyStyle(e.items[0]):(e instanceof f||e instanceof wi)&&(this.stroke=null==(t=e.stroke)?void 0:t.clone(),this.fill=null==(n=e.fill)?void 0:n.clone()),this}scaleStroke(e){return this.stroke&&(this.stroke.width*=e),this}firstStyled(){if(this.fill||this.stroke)return this}segments(){return ns(this.anchors,this.closed).map(([e,t])=>e.handleOut.isZero()&&t.handleIn.isZero()?Bn.fromAnchors(e,t):Fn.fromAnchors(e,t))}segmentPaths(){return ns(this.anchors,this.closed).map(e=>new f(e))}edgePaths(){const{anchors:e}=this,t=e.length;if(t<2)return[];let n=0;if(this.closed){for(;n<t&&e[n].hasTangentHandles();)++n;if(n===t)return[new f(e,!0)]}const i=[];let r=[];for(let s=n;s<t;++s){const t=e[s];r.push(t),r.length>=2&&!t.hasTangentHandles()&&(i.push(new f(r)),r=[t])}if(n>0)for(let s=0,o=n+1;s<o;++s){const t=e[s];r.push(t),r.length>=2&&!t.hasTangentHandles()&&(i.push(new f(r)),r=[t])}else this.closed&&r.push(e[0]);return r.length>1&&i.push(new f(r)),i}toSVGPathString(e){const t=(t,n)=>{if(0!=t.handleOut.x||0!=t.handleOut.y||0!=n.handleIn.x||0!=n.handleIn.y){return`C${$r(t.position.x+t.handleOut.x,e)} ${$r(t.position.y+t.handleOut.y,e)} ${$r(n.position.x+n.handleIn.x,e)} ${$r(n.position.y+n.handleIn.y,e)} ${$r(n.position.x,e)} ${$r(n.position.y,e)} `}return`L${$r(n.position.x,e)} ${$r(n.position.y,e)} `},{anchors:n}=this;if(n.length>1){const i=[];let r=n[0];const s=$r(r.position.x,e),o=$r(r.position.y,e);i.push(`M${s} ${o} `);for(let e=1,a=n.length;e<a;++e){let s=n[e];i.push(t(r,s)),r=s}return this.closed&&(i.push(t(r,n[0])),i.push("Z ")),i.join("")}return" "}looseBoundingBox(){const{anchors:e,closed:t}=this;if(0===e.length)return;if(1===e.length)return e[0].looseBoundingBox();const n=new It;let i=e[0];const r=new De(i.position.clone(),i.position.clone());r.expandToIncludePoint(n.copy(i.position).add(i.handleOut)),t&&r.expandToIncludePoint(n.copy(i.position).add(i.handleIn));const s=e.length-1;for(let o=1;o<s;++o)i=e[o],r.expandToIncludePoint(i.position),r.expandToIncludePoint(n.copy(i.position).add(i.handleIn)),r.expandToIncludePoint(n.copy(i.position).add(i.handleOut));return i=e[s],r.expandToIncludePoint(i.position),r.expandToIncludePoint(n.copy(i.position).add(i.handleIn)),t&&r.expandToIncludePoint(n.copy(i.position).add(i.handleOut)),r}boundingBox(){const{anchors:e,closed:t}=this,n=e.length;if(0===n)return;if(1===n)return e[0].boundingBox();const i=new De(new It(1/0),new It(-1/0)),r=new It,s=new It,o=new It,a=new It;let l,c;for(let h=1;h<n;++h)l=e[h-1],c=e[h],r.copy(l.position).add(l.handleOut),s.copy(c.position).add(c.handleIn),Yt(l.position,r,s,c.position,o,a),i.min.min(o),i.max.max(a);return t&&(l=e[e.length-1],c=e[0],r.copy(l.position).add(l.handleOut),s.copy(c.position).add(c.handleIn),Yt(l.position,r,s,c.position,o,a),i.min.min(o),i.max.max(a)),i}isContainedByBoundingBox(e){const t=this.boundingBox();return Boolean(t&&e.containsBoundingBox(t))}isIntersectedByBoundingBox(e){const t=this.looseBoundingBox();if(null==t?void 0:t.overlapsBoundingBox(e)){const{min:t,max:n}=e,i=new It(t.x,t.y),r=new It(n.x,t.y),s=new It(n.x,n.y),o=new It(t.x,n.y);return this.intersectionsWith([new Bn(i,r),new Bn(r,s),new Bn(s,o),new Bn(o,i)]).length>0}return!1}isOverlappedByBoundingBox(e){return this.isContainedByBoundingBox(e)||this.isIntersectedByBoundingBox(e)}containsPoint(e){return!!this.closed&&or(this,e)}styleContainsPoint(e){return ar(this,e)}containsPath(e){if(this.containsPoint(e.firstAnchor().position)&&this.containsPoint(e.lastAnchor().position)){const t=e.intersectionsWith([this]);if(t.length>=2)for(let[n,i]of ns(t,e.closed)){Ps(Jt(n.primitive1)&&Jt(i.primitive1));const t=n.primitive1.source.time+n.time1,r=i.primitive1.source.time+i.time1,s=e.mixedTime(t,r,.5),o=e.positionAtTime(s);if(!this.containsPoint(o))return!1}return!0}}reverse(){for(let e of this.anchors)e.reverse();return this.anchors.reverse(),this}length(){let e=0;for(let t of this.segments())e+=t.length();return e}signedArea(){let e=0;const t=this.segments();for(let n of t)e+=n._signedArea();if(!this.closed){e+=new Bn(t[t.length-1].e,t[0].s)._signedArea()}return e}area(){return Math.abs(this.signedArea())}timeAtDistance(e){if(Ps(e>=0,"Distance must be a positive number"),0===e)return 0;const t=this.endTime();let n=0;for(let i=0;i<t;++i){const r=this.segmentAtTime(i),s=r.length();if(n+s>e)return Math.min(t,i+r.timeAtDistance(e-n));n+=s}return t}distanceAtTime(e){if(e<=0)return 0;const{anchors:t,closed:n}=this;if(e>=(n?t.length:t.length-1))return this.length();const i=Math.floor(e);let r=0;for(let o=0;o<i;++o)r+=this.segmentAtTime(o).length();const s=e-i;return s>0&&(r+=this.segmentAtTime(i).distanceAtTime(s)),r}normalizedTime(e){return this.closed?Et(e,this.anchors.length):e}isSameTime(e,t){return this.normalizedTime(e)===this.normalizedTime(t)}firstAnchor(){const{anchors:e}=this;return Ps(e.length>0,"Path contains no anchors"),e[0]}lastAnchor(){const{anchors:e}=this;return Ps(e.length>0,"Path contains no anchors"),e[e.length-1]}endTime(){return this.closed?this.anchors.length:this.anchors.length-1}mixedTime(e,t,n){let i=t-e;if(this.closed){const e=this.anchors.length;2*Math.abs(i)>e&&(i-=e)}return e+i*n}isCorner(e){if(this.isEndpoint(e))return!1;const t=this.anchorAtTime(e);return t&&!t.hasTangentHandles()}isEndpoint(e){return!this.closed&&(0===e||e===this.anchors.length-1)}anchorAtTime(e){e=this.normalizedTime(Math.floor(e));const t=this.anchors[e];return Ps(t,`Path does not contain an anchor at time ${e}`),t}segmentAtTime(e){const{anchors:t,closed:n}=this;Ps(t.length>=2,"A path needs at least 2 anchors to have a segment");let i=Math.floor(e);n||i!==t.length-1||--i;const r=this.anchorAtTime(i),s=this.anchorAtTime(i+1);return Ps(r!==s),r.handleOut.isZero()&&s.handleIn.isZero()?Bn.fromAnchors(r,s):Fn.fromAnchors(r,s)}positionAtTime(e){const{anchors:t,closed:n}=this;return Ps(t.length>0,"A path needs at least 1 anchor to calculate a position"),1===t.length?t[0].position.clone():!n&&fs(e,t.length-1,Ge)?t[t.length-1].position.clone():this.segmentAtTime(e).positionAtTime(Lt(e))}derivativeAtTime(e){const{anchors:t}=this;return Ps(t.length>0,"A path needs at least 1 anchor to calculate a derivative"),1===t.length?t[0].handleOut.clone():!closed&&fs(e,t.length-1,Ge)?t[t.length-1].handleIn.clone().negate():this.segmentAtTime(e).derivativeAtTime(Lt(e))}secondDerivativeAtTime(e){const{anchors:t}=this;return Ps(t.length>0,"A path needs at least 1 anchor to calculate a second derivative"),1===t.length?new It(0,0):!closed&&fs(e,t.length-1,Ge)?this.segmentAtTime(t.length-2).secondDerivativeAtTime(1):this.segmentAtTime(e).secondDerivativeAtTime(Lt(e))}curvatureAtTime(e){const{anchors:t}=this;return Ps(t.length>0,"A path needs at least 1 anchor to calculate curvature"),1===t.length?0:!closed&&fs(e,t.length-1,Ge)?this.segmentAtTime(t.length-2).curvatureAtTime(1):this.segmentAtTime(e).curvatureAtTime(Lt(e))}tangentAtTime(e){if(!closed){const t=this.endTime();if(fs(e,t,Ge))return this.segmentAtTime(t-1).tangentAtTime(1)}return this.segmentAtTime(e).tangentAtTime(Lt(e))}normalAtTime(e){return this.tangentAtTime(e).rotate90()}angleAtTime(e){return this.derivativeAtTime(e).angle()}insertAnchorAtTime(e){const{anchors:t}=this;Ps(t.length>=2,"A path needs at least 2 anchors to insert an anchor at a time"),e=this.normalizedTime(e);const n=Math.trunc(e);if(n===e)return;const i=this.segmentAtTime(e);if(!i)return;const[r,s]=i.splitAtTime(Lt(e)),o=r.e,a=new It,l=new It;if(r instanceof Fn&&(a.copy(r.ce).sub(o),t[n].handleOut.copy(r.cs).sub(r.s)),s instanceof Fn){l.copy(s.cs).sub(o);t[this.normalizedTime(n+1)].handleIn.copy(s.ce).sub(s.e)}const c=new Wn(o,a,l);return t.splice(n+1,0,c),c}splitAtAnchor(e){const t=this.anchors.indexOf(e);return Ps(t>=0,"An anchor must be contained within a path to be used as a split point"),this.splitAtTime(t)}splitAtTime(e){e=this.normalizedTime(e);const t=this.clone(),{anchors:n,closed:i}=t;if(e<=0||e>=n.length-1)return[t];let r=Math.trunc(e);if(t.insertAnchorAtTime(e)&&++r,i)return r>0&&as(n,r),n.push(n[0].clone()),t.closed=!1,[t];const s=new f(n.slice(0,r)),o=new f(n.slice(r));return this.stroke&&(s.stroke=this.stroke.clone(),o.stroke=this.stroke.clone()),this.fill&&(s.fill=this.fill.clone(),o.fill=this.fill.clone()),s.anchors.push(o.anchors[0].clone()),[s,o]}splitAtTimes(e){if(1===e.length)return this.splitAtTime(e[0]);const t=e.slice().sort((e,t)=>e-t),n=[],i=t.length;let r=this.closed?t[i-1]:0;for(let s=0;s<i;++s){const e=t[s],i=this.slice(r,e);n.push(i),r=e}if(!this.closed){const e=this.slice(r,this.anchors.length-1);n.push(e)}return n}roundCorners(e){return Di(this,e),this}roundCornerAtAnchor(e,t){const n=this.anchors.map(n=>n===e?t:0);return this.roundCorners(n)}slice(e,t){var n,i;this.closed&&t<e&&(t+=this.anchors.length);const r=Math.floor(e),s=Math.ceil(t),o=new Array(s-r+1);for(let c=r;c<s+1;++c){const e=this.normalizedTime(c);o[c-r]=this.anchors[e].clone()}const a=this.closed&&t-e===this.endTime(),l=new f(o,a,null==(n=this.stroke)?void 0:n.clone(),null==(i=this.fill)?void 0:i.clone());if(t<s&&l.insertAnchorAtTime(t-r)&&l.anchors.pop(),e>r){let n=e-r;if(r===s-1){const e=Lt(t);e>0&&(n/=e)}l.insertAnchorAtTime(n)&&l.anchors.shift()}return a&&l.anchors.length>=2&&(l.firstAnchor().handleIn.copy(l.lastAnchor().handleIn),l.anchors.pop()),l}splice(e){if(e.length<=0)return this;const{anchors:t,closed:n}=this;let i=this.closed?e[e.length-1].time2:0;const r=[];for(let{path:l,time1:c,time2:h}of e){if(c>i){const e=this.slice(i,c);r.push(e)}r.push(l),i=h}const s=n?t.length+e[0].time1:t.length-1;if(s>i){const e=this.slice(i,s);r.push(e)}const o=[];let a;for(let{anchors:l}of r){let e=0,t=l[e];for(a&&(a.handleOut.copy(t.handleOut),++e);e<l.length;++e)t=l[e],o.push(t);a=t}if(n){const e=o[0];a&&(e.handleIn.copy(a.handleIn),o.pop())}return this.anchors=o,this}warpCoordinates(e,t){let n;for(const i of this.edgePaths()){const r=f.fromSmoothFunction(t=>e(i.positionAtTime(i.timeAtDistance(t))),0,i.length(),t);n?(n[n.length-1].handleOut=r.anchors[0].handleOut,r.anchors.shift(),n.push(...r.anchors)):n=r.anchors}if(n){if(this.closed){const e=n.pop();e&&(n[0].handleIn=e.handleIn)}this.anchors=n}return this}mergeAnchors(e=Be){const{anchors:t,closed:n}=this;let i=t.length;if(i<2)return this;const r=[];let s,o,a,l=0,c=l;const h=n?i+1:i;for(let u=1;u<h;++u){s=u%i,o=t[l],a=t[s];if(o.position.distance(a.position)<e){c=s;continue}const n=Bi(t,l,c);r.push(n),l=c=s}if(l!==c){const e=Bi(t,l,c);n?r[0]=e:r.push(e)}return n||l!==c||l!==i-1||r.push(t[l]),this.anchors=r,this}closestPoint(e,t){const{anchors:n,closed:i}=this,r=n.length;if(0===r)return;if(1===r)return{position:n[0].position,time:0};const s=new It,o=new Bn(s,s),a=new Fn(s,new It,new It,s);let l,c=1/0;for(let h=0,u=i?r:r-1;h<u;++h){const i=n[h],s=n[(h+1)%r];let u;if(u=i.handleOut.isZero()&&s.handleIn.isZero()?o.setFromAnchors(i,s).closestPoint(e,t):a.setFromAnchors(i,s).closestPoint(e,t),!u)continue;const d=e.distanceSquared(u.position);d<c&&(u.time+=h,u.geometry=this,l=u,c=d)}return l}_primitives(){const e=this.segments();for(let t=0;t<e.length;++t)e[t].source={path:this,time:t};return e}rasterize(e){const t=nr(this,e);if(!t)return;const n=f.fromBoundingBox(t.boundingBox);return n.fill=t.fill,n}static isValid(e){return e instanceof f&&e.isValid()}static fromPoints(e,t=!1){return new f(e.map(e=>new Wn(e)),t)}static fromCubicBezierPoints(e,t=!1){let n=new Wn(e[0]);const i=new f([n],t);for(let r=1,s=e.length;r<s&&(n.handleOut.copy(e[r]).sub(n.position),++r!==s);){const o=e[r].clone();if(++r===s){t?i.anchors[0].handleIn.copy(o).sub(i.anchors[0].position):i.anchors.push(new Wn(o));break}const a=new Wn(e[r],o);a.handleIn.sub(a.position),i.anchors.push(a),n=a,++r}return i}static fromSegment(e){return new f(e instanceof Bn?[new Wn(e.s.clone()),new Wn(e.e.clone())]:[new Wn(e.s.clone(),void 0,e.cs.clone().sub(e.s)),new Wn(e.e.clone(),e.ce.clone().sub(e.e))])}static fromFragments(e){if(e.length<=0)return new f;const t=e[0];let n;n=t instanceof f?t:t instanceof Wn?new f([t]):f.fromSegment(t);const i=n.anchors,r=e=>{const t=i[i.length-1];if(e instanceof Bn)e.s._almostEquals(t.position)||i.push(new Wn(e.s.clone())),i.push(new Wn(e.e.clone()));else if(e instanceof Fn)e.s._almostEquals(t.position)?t.handleOut.copy(e.cs).sub(e.s):i.push(new Wn(e.s,new It,e.cs.clone().sub(e.s))),i.push(new Wn(e.e.clone(),e.ce.clone().sub(e.e)));else if(e instanceof f)for(let n of e.segments())r(n);else e instanceof Wn&&(e.position._almostEquals(t.position)?t.handleOut.copy(e.handleOut):i.push(e.clone()))};for(let a=1;a<e.length;++a)r(e[a]);const s=i[0],o=i[i.length-1];return s.position._almostEquals(o.position)&&(s.handleIn=o.handleIn,i.pop(),n.closed=!0),n}static fromBoundingBox(e){const{min:t,max:n}=e;return new f([new Wn(new It(t.x,t.y)),new Wn(new It(n.x,t.y)),new Wn(new It(n.x,n.y)),new Wn(new It(t.x,n.y))],!0)}static fromArc(e,t,n,i){const r=Math.abs(n-i),s=Math.ceil(r/90),o=(i-n)/s;let a=new Wn(new It(1,0));const l=new f([a]);for(let c=0;c<s;c++){const e=Fi(o);e.transform({rotation:c*o}),a.handleOut=e.anchors[0].handleOut,a=e.anchors[1],l.anchors.push(a)}return l.transform({position:e,rotation:n,scale:t}),l}static fromSmoothFunction(e,t,n,i){return((e,t,n,i)=>{const r=e(t),s=e(.5*(t+n)),o=e(n),a=Li(0,e,t,n,i,r.x,s.x,o.x,r.y,s.y,o.y),l=r.distanceSquared(o)<=i*i;return Ri.fromCubicBezierPoints(a,l)})(e,t,n,i)}},f.displayName="Path",f);const Fi=e=>{const t=4/3*Math.tan(e/4*Re);return new Ri([new Wn(new It(1,0),new It(0,0),new It(0,t)),new Wn(new It(1,0).rotate(e),new It(0,-t).rotate(e),new It(0,0))])},Bi=(e,t,n)=>{const i=e.length,r=e[t];if(t===n)return r;n<t&&(n+=i);const s=e[n%i],o=n+1;for(let l=t+1;l<o;++l){const t=e[l%i];r.position.add(t.position)}const a=o-t;return r.position.mulScalar(1/a),r.handleOut.copy(s.handleOut),r};let Vi=((m=class{constructor(e=new Gn,t=!0,n=.1,i="centered",r="butt",s="miter",o=4){this.color=e,this.hairline=t,this.width=n,this.alignment=i,this.cap=r,this.join=s,this.miterLimit=o}clone(){return new m(this.color.clone(),this.hairline,this.width,this.alignment,this.cap,this.join,this.miterLimit)}equals(e){return this.color.equals(e.color)&&this.hairline===e.hairline&&this.width===e.width&&this.alignment===e.alignment&&this.cap===e.cap&&this.join===e.join&&this.miterLimit===e.miterLimit}static isValidAlignment(e){return"centered"===e||"inner"===e||"outer"===e}static isValidCap(e){return"butt"===e||"round"===e||"square"===e}static isValidJoin(e){return"miter"===e||"round"===e||"bevel"===e}static isValid(e){return e instanceof m&&Gn.isValid(e.color)&&"boolean"==typeof e.hairline&&"number"==typeof e.width&&"number"==typeof e.miterLimit&&m.isValidAlignment(e.alignment)&&m.isValidCap(e.cap)&&m.isValidJoin(e.join)}}).displayName="Stroke",m),ji=((g=class{constructor(e=new Gn(0,0,0,1)){this.color=e}clone(){return new g(this.color.clone())}equals(e){return e instanceof g&&this.color.equals(e.color)}static isValid(e){return e instanceof g&&Gn.isValid(e.color)}}).displayName="Fill",g),Hi=((v=class{constructor(e,t=1,n=new Ne){this.image=e,this.opacity=t,this.transform=n}clone(){return new v(this.image,this.opacity,this.transform.clone())}equals(e){return e instanceof v&&(this.image===e.image&&this.transform.equals(e.transform))}affineTransform(e){return this.transform.preMul(e),this}affineTransformWithoutTranslation(e){return this.transform.preMulWithoutTranslation(e),this}static isValid(e){return e instanceof v&&"string"==typeof e.image&&Ne.isValid(e.transform)}}).displayName="ImageFill",v),Ui=class e{constructor(e=[]){this.contained=e}maximumDepth(){return Wi(this,0)}allPaths(){return this.contained.flatMap(e=>e.allPaths())}static fromPaths(t){const n=t.map(e=>new zi(e));n.sort((e,t)=>t._area-e._area);for(let e=n.length;--e>=0;){const t=n[e];if(t.box&&!(t.path.anchors.length<1))for(let i=e;--i>=0;){const r=n[i];if(r.box&&(r.box.containsBoundingBox(t.box)&&r.path.containsPath(t.path))){r.contained.push(t),n.splice(e,1);break}}}return new e(n)}};class zi extends Ui{constructor(e){var t;super(),this.path=e,this.box=e.boundingBox(),this._area=(null==(t=this.box)?void 0:t.area())??0}allPaths(){return[this.path,...this.contained.flatMap(e=>e.allPaths())]}}const Wi=(e,t)=>{let n=t;for(const i of e.contained)n=Math.max(n,Wi(i,t+1));return n},Gi=(e,t)=>Math.min(Math.abs(e.min.y-t),Math.abs(e.max.y-t)),$i=(e,t)=>wi.booleanUnion([e,wi.stroke(e,{width:2*t,join:"round"})]).copyStyle(e),Zi=(e,t)=>{e.geometry=$i(e.geometry,t)},qi=(e,t)=>{if(e.isBlank()||((n=e.geometry)instanceof wi?n.paths.length>10:n instanceof xi&&n.items.length>10))return;var n;const i=(null==t?void 0:t.baseline)??0,r=(null==t?void 0:t.thicken)??0,s=(null==t?void 0:t.minOverlap)??.02,o=(null==t?void 0:t.scrunch)??.01,a=Ui.fromPaths(e.geometry.allPaths()),l=((e,t)=>{let n=e[0],i=1/0;for(let r=0;r<e.length;++r){const s=e[r];if(void 0===s.box)continue;const o=Gi(s.box,t);o<i&&(n=s,i=o)}return n})(a.contained,i);let c=new wi(l.allPaths());r>0&&(c=$i(c,r));const h=[c];for(const u of a.contained){if(u===l)continue;let e=new wi(u.allPaths());if(r>0&&(e=$i(e,r)),!u.box)return;const t=u.box.center(),n=c.closestPoint(t);if(!n)return;const i=n.position.clone().sub(t).normalize(),a=e.distanceToIntersect(c,i,{minOverlap:s});if(Ss(a)&&a>0){const t=i.clone().mulScalar(a+o);e.transform({position:t})}h.push(e)}e.geometry=new xi(h)},Ki=(e,t,n,i)=>{var r;const s=null==(r=e.boundingBox())?void 0:r.center();if(!s)return;const o=t.closestPoint(s);if(!o)return;const a=o.position.clone().sub(s).normalize(),l=e.distanceToIntersect(t,a,{minOverlap:n});if(Ss(l)&&l>0){return a.clone().mulScalar(l+i)}},Yi=(e,t,n)=>{let i=e.geometry;if(t.length<1)return;if(e.isBlank())return;const r=((e,t=4)=>{let n=Math.max(0,e.length-t);for(let i=e.length;--i>=n;)if(e[i].isBlank()){n=i+1;break}return e.slice(n)})(t);if(r.length<1)return;let s=0;const o=new xi(r.map(e=>{const t=e.geometry.clone().transform({position:new It(s,0)});return s+=e.advanceX,t}));i=i.clone().transform({position:new It(s,0)});const a=t[t.length-1];if(a.isBlank())return;const l=(null==n?void 0:n.ignoreInitialConnection)??!1,c=(null==n?void 0:n.minOverlap)??.03,h=(null==n?void 0:n.scrunch)??.025,u=(null==n?void 0:n.showDebug)??!1,d=new It(-1,0),p=i.distanceToIntersect(o,d,{minOverlap:c,showDebug:u});if(void 0===p)return;let f=p<=0;if(!f&&!l){const e=o.items.slice(-1),t=i.intersectionsWith(e);t.length>2&&(f=!0),2===t.length&&t[0].position.distance(t[1].position)>=c&&(f=!0)}if(l&&(f=!1),f)return;const m=o.items[o.items.length-1],g=m.boundingBox(),v=g?Gi(g,0):1/0,y=i.boundingBox(),b=y?Gi(y,0):1/0;if(!f&&"number"==typeof p){const t=d.clone().mulScalar(p+h);(a.advanceX<e.advanceX||.75*a.advanceX>-t.x||b<v)&&(a.advanceX+=t.x,i.transform({position:t}),f=!0)}if(!f){if((1===t.length||t[t.length-2].isBlank())&&b<v){const e=Ki(m,i,c,h);e&&(i.transform({position:new It(-e.x,0)}),a.advanceX-=e.x,a.geometry.transform({position:new It(0,e.y)}))}else{const t=Ki(i,m,c,h);t&&(a.advanceX+=t.x,b>v&&(e.advanceX=-t.x),i.transform({position:t}),e.geometry.transform({position:new It(0,t.y)}))}}},Xi=class e{constructor(e,t,n,i,r){this.name=e,this.x=t,this.advanceWidth=n,this.advanceX=i,this.geometry=r}clone(){return new e(this.name,this.x,this.advanceWidth,this.advanceX,this.geometry.clone())}isBlank(){return this.geometry instanceof wi?0===this.geometry.paths.length:this.geometry instanceof xi&&0===this.geometry.items.length}connect(e){return qi(this,e),this}connectToLine(e,t){return Yi(this,e,t),this}};Xi.displayName="FontGlyph";let Ji=Xi;const Qi=document.createElement("canvas"),er=Qi.getContext("2d");let tr=()=>{};const nr=(e,t)=>{const n=e.clone(),i=n.boundingBox();if(!i)return;if(!er)throw new ir("No canvas context.");const r=(null==t?void 0:t.pixelsPerUnit)??1,s=i.size().mulScalar(r).round();if(s.x>32768||s.y>32768||s.x*s.y>268435456)throw new rr;Qi.width=s.x,Qi.height=s.y;const o=Ne.fromScale(r).translate(i.min.clone().negate());n.affineTransform(o),sr(n,er,s,t);const a=Qi.toDataURL();if("data:,"===a)throw new rr;return{fill:new Hi(a,1,o.clone().invert()),boundingBox:i}};class ir extends Error{constructor(e){super("Rasterize: "+e)}}class rr extends Error{constructor(){super("Rasterize: A path with an image fill was larger than the maximum canvas size.")}}const sr=(e,t,n,i)=>{if(e instanceof Ri||e instanceof wi){const{stroke:r,fill:s}=e;if(!r&&!s)return;const o=new Path2D;if(lr(e,o),s)if(s instanceof ji)t.fillStyle=s.color.toCSSString(),t.fill(o,"evenodd");else{const e=tr(s.image);if(e){const n=t.createPattern(e._image,"no-repeat");if(n){const i=s.transform;t.fillStyle=n,t.save(),t.globalAlpha=St(s.opacity),t.clip(o,"evenodd"),t.transform(i.a,i.b,i.c,i.d,i.tx,i.ty),t.fillRect(0,0,e.width,e.height),t.restore()}}}if(r&&!(null==i?void 0:i.ignoreStroke)){t.strokeStyle=r.color.toCSSString(),t.lineCap=r.cap,t.lineJoin=r.join,t.miterLimit=r.miterLimit;const s=e.hasStrokeWithNonStandardAlignment();if(r.hairline?(t.lineWidth=(null==i?void 0:i.hairlineStrokeWidth)??1,t.lineJoin="round",t.lineCap="round"):t.lineWidth=s?2*r.width:r.width,s){if(t.save(),"outer"===r.alignment){const e=new Path2D(o);e.rect(0,0,n.x,n.y),t.clip(e,"evenodd")}else"inner"===r.alignment&&t.clip(o,"evenodd");t.stroke(o),t.restore()}else t.stroke(o)}}else if(e instanceof xi)for(let r of e.items)sr(r,t,n,i)},or=(e,t)=>!!er&&(er.beginPath(),lr(e,er),er.isPointInPath(t.x,t.y,"evenodd")),ar=(e,t)=>{if(!er)return!1;const{stroke:n,fill:i}=e,r=i instanceof ji&&i.color.a>0||i instanceof Hi&&i.opacity>0,s=n&&!n.hairline&&n.color.a>0;if(!r&&!s)return!1;er.beginPath(),lr(e,er);const o=er.isPointInPath(t.x,t.y,"evenodd");if(r&&o)return!0;if(s&&n){if(er.lineJoin=n.join,er.lineCap=n.cap,er.miterLimit=n.miterLimit,"centered"===n.alignment)return er.lineWidth=n.width,er.isPointInStroke(t.x,t.y);if("outer"===n.alignment)return er.lineWidth=2*n.width,!o&&er.isPointInStroke(t.x,t.y);if("inner"===n.alignment)return er.lineWidth=2*n.width,o&&er.isPointInStroke(t.x,t.y)}return!1},lr=(e,t)=>{if(e instanceof Ri){if(e.anchors.length>1){let n=e.anchors[0];t.moveTo(n.position.x,n.position.y);for(let i=1,r=e.anchors.length;i<r;++i){let r=e.anchors[i];cr(t,n,r),n=r}e.closed&&(cr(t,n,e.anchors[0]),t.closePath())}}else for(let n of e.paths)lr(n,t)},cr=(e,t,n)=>{0!=t.handleOut.x||0!=t.handleOut.y||0!=n.handleIn.x||0!=n.handleIn.y?e.bezierCurveTo(t.position.x+t.handleOut.x,t.position.y+t.handleOut.y,n.position.x+n.handleIn.x,n.position.y+n.handleIn.y,n.position.x,n.position.y):e.lineTo(n.position.x,n.position.y)},hr="https://cuttle.xyz",ur="https://assets.cuttle.xyz";let dr="https://api.cuttle.xyz",pr="https://cuttle.xyz/assets",fr="cuttle-uploads",mr="cuttle-uploads-s3";window.location.hostname.includes("cuttlexyz.com")&&(dr="https://api.cuttlexyz.com",pr="https://cuttlexyz.com/assets"),window.location.hostname.includes("localhost.cuttle.xyz");const gr=e=>e.replace(/-|_/g,e=>"-"===e?"_h":"_u"),vr=e=>e.replace(/_h|_u/g,e=>"_h"===e?"-":"_"),yr={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"},br=e=>e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n"),wr=(e,t)=>{let n=e.length;for(;e.charAt(--n)===t;);return e.substring(0,n+1)},xr=e=>{const t=e.indexOf(".");return-1===t?0:e.length-t-1},Cr=e=>{throw window.alert(e),new Error(e)},Sr=e=>{const t=e?new URL(e):window.location,{search:n,pathname:i}=t,r=new URLSearchParams(n),s=null!==r.get("edit"),o=null!==r.get("view"),a=null!==r.get("embed"),l=i.split("/"),[c,h,u]=l;if("intro"===h)return{projectId:"_intro",edit:!0,view:!1,embed:!1};if(""===h||"editor"===h)return{projectId:"_staging",edit:!0,view:!1,embed:a};const d=u?u.split("-"):[];return{projectId:d.length?d[d.length-1]:void 0,edit:s,view:o,embed:a}},kr=e=>e.startsWith(ur)?pr+e.slice(25):e,Lr=(e,t)=>{if(e===t)return!0;if(Ls(e)&&Ls(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!Lr(e[n],t[n]))return!1;return!0}if(Es(e)&&Es(t)){const n=Er(e),i=Er(t);if(n.length!==i.length)return!1;if(!n.every(e=>i.includes(e)))return!1;for(const r of n)if(!Lr(e[r],t[r]))return!1;return!0}return!1},Er=e=>{const t=[];for(const n in e)void 0!==e[n]&&t.push(n);return t},Pr=()=>{const{hostname:e}=window.location;return"localhost.cuttle.xyz"===e};let Tr=((y=class{constructor(e,t={}){e instanceof y?(this.url=e.url,this.renderOptions={...e.renderOptions,...t}):(this.url=e,this.renderOptions=t)}clone(){return new y(this.url,{...this.renderOptions})}equals(e){return this.url===e.url&&Lr(this.renderOptions,e.renderOptions)}}).displayName="Font",y);const Ar=new Ji("",0,0,0,new wi),Mr={letterSpacing:0,thicken:0,connect:"none",capitalize:"none",lineHeight:1,startStyle:"none",endStyle:"none",betweenStyle:"none",ligatures:"none"},Ir=e=>e in Mr;class _r{constructor(e){this._symbolRetriever=e,this.renderOptions=Mr}withRenderOptions(e){const t=this.clone();return t.renderOptions=t.mergeRenderOptions(e),t}_symbolPlacement(){if(this._measuredSymbolPlacement)return this._measuredSymbolPlacement;const e=this._glyphsFromTextString("O",{ligatures:"none"})[0];if(!e)return Nr;const t=e.geometry.boundingBox();return t?this._measuredSymbolPlacement={height:t.height(),y:t.max.y,startPadding:Math.max(Or,t.min.x),endPadding:Math.max(Or,e.advanceWidth-t.max.x)}:Nr}glyphsFromString(e,t={}){const n=this.mergeRenderOptions(t);let i=e instanceof Ot?e:new Ot(e);const{letterSpacing:r,thicken:s,connect:o,capitalize:a,startStyle:l,betweenStyle:c,endStyle:h}=n;if("uppercase"===a?i=i.toLocaleUpperCase():"lowercase"===a&&(i=i.toLocaleLowerCase()),"none"!==l||"none"!==c||"none"!==h){const e={};"tail"===l&&(e.wordStart="leftTail"),"heart"===c?e.wordConnect="rightHeart":"none"===c&&(e.wordConnect="skip"),"tail"===h&&(e.wordEnd="rightTail"),"heart"===h&&(e.wordEnd="rightHeart"),i=this.replacePatternsWithGlyphAlternates(i,e)}const u=[];for(const p of i.items)if(p instanceof Nt&&u.push(p),ks(p)||p instanceof Dt){const e=u[u.length-1];e&&Ls(e)?e.push(p):u.push([p])}let d=[];for(const p of u)if(p instanceof Nt)d.push(this._glyphForSymbol(p));else{const e=this._glyphsFromTextString(p,n);if("dots and letters"===o||"dots"===o)for(const t of e)qi(t,{thicken:s});else if(s>0)for(const t of e)Zi(t,s);d.push(...e)}if("dots and letters"===o){const e=[];let t;for(const n of d){const i=n instanceof Nt||t instanceof Nt&&n===d[0];n.connectToLine(e,{ignoreInitialConnection:i}),e.push(n),t=n}d=e}if(0!==r)for(let p=0;p<d.length-1;++p)d[p].advanceX+=r;return d}_glyphForSymbol(e){if(e instanceof Nt){const t=this._symbolRetriever(e),n=null==t?void 0:t.boundingBox();if(t&&n){const{height:e,y:i,startPadding:r,endPadding:s}=this._symbolPlacement(),o=new It(n.min.x,n.max.y),a=e/n.height(),l=new It(r,i);t.transform({origin:o,scale:a,position:l});const c=r+n.width()*a+s;return new Ji("",0,c,c,wi.booleanUnion([t],"evenodd"))}return Ft.consoleWarn("Loading in progress, or no geometry found."),Ar.clone()}return Ft.consoleWarn("Unknown symbol type."),Ar.clone()}renderLine(e,t={}){const n=this.mergeRenderOptions(t),i=this.glyphsFromString(e,n),r=[];let s=0;for(let o of i){const{geometry:e,advanceX:t}=o;r.push(e.transform({position:new It(s,0)})),s+=t}return{geometry:new xi(r),advanceX:s,advanceWidth:s}}render(e,t={}){return(ks(e)||e instanceof Ot?e:new Ot(e)).split("\n").map(e=>this.renderLine(e,t))}mergeRenderOptions(e){return{...this.renderOptions,...e}}}const Or=.05,Nr=Object.freeze({height:.8,y:0,startPadding:Or,endPadding:Or});class Dr{constructor(e,t){this._image=e,this.url=t,this.width=e.width,this.height=e.height}pixelData(){var e;if(void 0===this._imageData){const e=this._image,t=Rr(e,e.width,e.height);t&&(this._imageData=t)}return null==(e=this._imageData)?void 0:e.data}}const Rr=(e,t,n,i,r)=>{const s=Math.max(1,Math.floor(t)),o=Math.max(1,Math.floor(n));let a=s,l=o;const c=document.createElement("canvas");c.width=s,c.height=o;const h=c.getContext("2d");if(!h)return;const u=(s-a)/2,d=(o-l)/2;return h.drawImage(e,u,d,a,l),h.getImageData(0,0,s,o)},Fr=(e,t)=>{const n=document.createElement("iframe");n.setAttribute("sandbox","allow-same-origin"),document.body.appendChild(n);const i=n.contentDocument;i.body.innerHTML=e;const r=i.querySelector("svg");if(!r)return;Array.from(i.body.childNodes).some(e=>e.nodeType===window.Node.COMMENT_NODE&&-1!==e.data.indexOf("Generator: Adobe Illustrator"))&&(t={...t,sourceUnits:"pt"});const s=zr(r,r,t);return n.remove(),s},Br=(e,t,n)=>{const i=.551915024494,r=e.position.x,s=e.position.y,o=t.position.x,a=t.position.y;n?(e.handleOut=new It((o-r)*i,0),t.handleIn=new It(0,(s-a)*i)):(e.handleOut=new It(0,(a-s)*i),t.handleIn=new It((r-o)*i,0))},Vr=(e,t,n)=>{const i=e.getAttribute(t);return null!==i?i:n},jr=(e,t,n)=>{const i=e.getAttribute(t);return null!==i?parseFloat(i):n},Hr=(e,t,n)=>{const i=Vr(t,"viewBox",void 0);if(void 0!==i){const r=i.split(/[\s,]+/).map(e=>parseFloat(e)),[s,o,a,l]=r;"middle"===n.origin?e.transform({position:new It(-s-.5*a,-o-.5*l)}):e.transform({position:new It(-s,-o)});let c=Jr("pt",n.units);if(n.fitSize){const e=n.fitSize.x/a,t=n.fitSize.y/l;c=Math.min(e,t)}else if(n.sourceUnits)c=Jr(n.sourceUnits,n.units);else{const e=Vr(t,"width",void 0);if(void 0!==e){let{number:t,unit:i}=(e=>{var t,n;const i=null==(t=e.match(/[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/))?void 0:t[0];return{number:i?parseFloat(i):void 0,unit:null==(n=e.match(/[^\d.]+$/))?void 0:n[0]}})(e);if(i||(i="pt"),void 0!==t&&Yr(i)){c=t*Jr(i,n.units)/a}}}e.transform({scale:c}),e.scaleStroke(c)}},Ur={circle:!0,ellipse:!0,line:!0,path:!0,polygon:!0,polyline:!0,rect:!0,text:!0,textPath:!0,tspan:!0},zr=(e,t,n)=>{let i;const r=t.tagName;function s(i){const r=[];for(const s of Array.from(t.children)){const t=zr(e,s,n);t&&r.push(t)}if(r.length)return new xi(r)}if("svg"===r||"g"===r||"switch"===r||"symbol"===r&&e===t){if(i=s(t.children),i)if("svg"===r){Hr(i,t,n);const e=Qr(.02,"in",n.units);i.allPathsAndCompoundPaths().forEach(t=>{t.stroke&&t.stroke.width<e&&(t.stroke.hairline=!0)})}else"symbol"===r&&Hr(i,t,{units:"pt"})}else if("path"===r){const e=Vr(t,"d","");i=wi.fromSVGPathString(e)}else if("polygon"===r){const e="M"+Vr(t,"points","")+"z";i=wi.fromSVGPathString(e)}else if("polyline"===r){const e="M"+Vr(t,"points","");i=wi.fromSVGPathString(e)}else if("circle"===r){const e=jr(t,"cx",0),n=jr(t,"cy",0),r=jr(t,"r",0);if(r>0){const t=[new Wn(new It(e+r,n)),new Wn(new It(e,n+r)),new Wn(new It(e-r,n)),new Wn(new It(e,n-r))];Br(t[0],t[1],!1),Br(t[1],t[2],!0),Br(t[2],t[3],!1),Br(t[3],t[0],!0),i=new Ri(t,!0)}}else if("ellipse"===r){const e=jr(t,"cx",0),n=jr(t,"cy",0),r=jr(t,"rx",0),s=jr(t,"ry",0);if(r>0&&s>0){const t=[new Wn(new It(e+r,n)),new Wn(new It(e,n+s)),new Wn(new It(e-r,n)),new Wn(new It(e,n-s))];Br(t[0],t[1],!1),Br(t[1],t[2],!0),Br(t[2],t[3],!1),Br(t[3],t[0],!0),i=new Ri(t,!0)}}else if("rect"===r){const e=jr(t,"x",0),n=jr(t,"y",0),r=jr(t,"width",0),s=jr(t,"height",0);let o=jr(t,"rx",void 0),a=jr(t,"ry",void 0);if(void 0!==o&&void 0===a&&(a=o),void 0!==a&&void 0===o&&(o=a),void 0===o||void 0===a){const t=[new Wn(new It(e,n)),new Wn(new It(e+r,n)),new Wn(new It(e+r,n+s)),new Wn(new It(e,n+s))];i=new Ri(t,!0)}else{o=Ct(o,0,r/2),a=Ct(a,0,s/2);const t=[new Wn(new It(e+o,n)),new Wn(new It(e+r-o,n)),new Wn(new It(e+r,n+a)),new Wn(new It(e+r,n+s-a)),new Wn(new It(e+r-o,n+s)),new Wn(new It(e+o,n+s)),new Wn(new It(e,n+s-a)),new Wn(new It(e,n+a))];Br(t[7],t[0],!1),Br(t[1],t[2],!0),Br(t[3],t[4],!1),Br(t[5],t[6],!0),i=new Ri(t,!0)}}else if("line"===r){const e=jr(t,"x1",0),n=jr(t,"y1",0),r=jr(t,"x2",0),s=jr(t,"y2",0),o=new Wn(new It(e,n)),a=new Wn(new It(r,s));i=new Ri([o,a])}else if("use"===r){const r=t.getAttribute("href")??t.getAttribute("xlink:href");if(null!==r){const s=e.querySelector(r);if(i=zr(s,s,n),i){const e=jr(t,"x",0),n=jr(t,"y",0);0===e&&0===n||i.transform({position:new It(e,n)})}}}else"defs"===r||"symbol"===r||"text"===r||"clippath"===r||"lineargradient"===r||"radialgradient"===r||"image"===r||(i=s(t.children));if(void 0===i)return;if(Ur[r]){const e=window.getComputedStyle(t),n=parseFloat(e.fillOpacity);if(("path"===r||"polyline"===r)&&n>0&&"none"!==e.fill&&"nonzero"===e.fillRule){const e=wi.booleanUnion([i],"winding");e.paths.length>0&&(i=e)}const s=e.fill;if("none"!==s){const e=Gn.fromCSSString(s);isNaN(n)||(e.a*=n),i.assignFill(new ji(e))}const o=e.stroke;if("none"!==o){const t=Gn.fromCSSString(o),n=parseFloat(e.strokeOpacity);isNaN(n)||(t.a*=n);const r=parseFloat(e.strokeWidth);let s=e.strokeLinecap;Vi.isValidCap(s)||(s=void 0);let a=e.strokeLinejoin;Vi.isValidJoin(a)||(a=void 0);const l=parseFloat(e.strokeMiterlimit),c=!1;i.assignStroke(new Vi(t,c,r,"centered",s,a,l))}}const o=Vr(t,"transform",null);if(null!==o){const e=Ne.fromSVGTransformString(o);i.affineTransform(e);const t=Math.sqrt(Math.abs(e.determinant()));i.scaleStroke(t)}return i},Wr=e=>"number"==typeof e?Gr(e):"string"==typeof e?e:"function"==typeof e?e.name:"object"==typeof e?Array.isArray(e)?`[${e.map(e=>Wr(e)).join(",")}]`:JSON.stringify(e):String(e),Gr=(e,t=0,n=16)=>{const i=e.toFixed(n-4);if(-1===i.indexOf("e")){let e=i.length,n=e;for(;--n>=0&&"0"===i[n];);if(e-n>4){let e=i.slice(0,n+1);"-0."===e&&(e="0.");const r=e.lastIndexOf(".");return t>0?e.padEnd(r+t+1,"0"):r===e.length-1?e.slice(0,r):e}}return e.toLocaleString("en-US",{minimumFractionDigits:t,maximumFractionDigits:20,useGrouping:!1})},$r=(e,t)=>{if(void 0!==t){let n=e.toFixed(t);if(t>0){let e=n.length,i=e-1,r=e-t;for(;i>=r&&"0"===n[i];)i--;"."===n[i]&&i--,n=n.slice(0,i+1)}return"-0"===n?"0":n}return e.toString()},Zr=["in","ft","mm","cm","m","px","pc","pt"],qr={in:"Inches",ft:"Feet",mm:"Millimeters",cm:"Centimeters",m:"Meters",px:"Pixels",pc:"Picas",pt:"Points"},Kr={in:1,ft:12,mm:1/25.4,cm:1/2.54,m:1e3/25.4,px:1/96,pc:1/6,pt:1/72},Yr=e=>"string"==typeof e&&qr.hasOwnProperty(e),Xr=["mm","cm","m"],Jr=(e,t)=>Kr[e]/Kr[t];function Qr(e,t,n){if(n===t)return e;const i=Jr(t,n);return e instanceof It?new It(e.x*i,e.y*i):e*i}const es=e=>{e=e.toLowerCase();for(let t of Zr)if(qr[t].toLowerCase()===e)return t;throw`Invalid unit name: ${e}`},ts=(e,t,n=1)=>{void 0===t&&(t=e,e=0);const i=0|Math.max(0,Math.ceil((t-e)/n)),r=new Array(i);for(let s=0;s<i;++s)r[s]=e+s*n;return r};function ns(e,t=!1){if(e.length<2)return[];const n=new Array(t?e.length:e.length-1);let i,r=e[0];for(let s=1,o=e.length;s<o;++s)i=e[s],n[s-1]=[r,i],r=i;return t&&(n[n.length-1]=[r,e[0]]),n}const is=(e,t)=>{if(e.length<1)return[];let n=e[0],i=[n];const r=[i];for(let s=1;s<e.length;++s){const o=e[s];t(n,o)&&(i=[],r.push(i)),i.push(o),n=o}return r},rs=(e,t)=>{if(e.length<1)return[];const n=new Array(e.length).fill(!1),i=[],r=e.length;for(let s=0;s<r;++s){if(n[s])continue;const o=e[s],a=[o];for(let i=s+1;i<r;++i){const r=e[i];t(o,r)&&(a.push(r),n[i]=!0)}i.push(a)}return i},ss=(e,t)=>{const n=new Map;for(const i of e){const e=t(i);let r=n.get(e);void 0===r&&(r=[],n.set(e,r)),r.push(i)}return n},as=(e,t)=>{0!==t&&e.push(...e.splice(0,t))},ls=e=>e.filter(e=>null!=e),cs=e=>{let t;for(let n=0,i=e.length;n<i;++n){const i=e[n].boundingBox();i&&(t?(t.min.min(i.min),t.max.max(i.max)):t=i)}return t},hs=e=>{let t;for(let n=0,i=e.length;n<i;++n){const i=e[n].looseBoundingBox();i&&(t?(t.min.min(i.min),t.max.max(i.max)):t=i)}return t},us=(e,t,n,i=1e-7)=>{const r=hs(e),s=hs(t);if(!r||!s)return;r.expandScalar(2*i),s.expandScalar(2*i);const o=[r,s];return n&&o.push(n),De.booleanIntersect(o)},ds=(e,t,n,i=Be)=>{const r=1/e.distance(t),s=1/t.distance(n),o=r*(t.x-e.x),a=r*(t.y-e.y);return o*(s*(n.x-t.x))+a*(s*(n.y-t.y))>=1-i},ps=(e,t)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},fs=(e,t,n=We,i=We)=>{const r=Math.abs(t-e);return r<=n||(e=Math.abs(e),t=Math.abs(t),r<=Math.max(e,t)*i)},ms=(e,t=We)=>Math.abs(e)<=t,gs=(e,t,n=We,i=We)=>e>t||fs(e,t,n,i),vs=(e,t,n=We,i=We)=>e<t||fs(e,t,n,i),ys=(e,t)=>bs(e-t),bs=e=>Math.abs(e)<$e,ws=e=>Math.abs(e-1)<$e,xs=e=>e>-1e-7,Cs=e=>e>-1e-7&&e<1.0000001,Ss=e=>"number"==typeof e&&!isNaN(e),ks=e=>"string"==typeof e,Ls=e=>Array.isArray(e),Es=e=>"object"==typeof e&&null!==e;function Ps(e,t){if(!e)throw new Error(t??"Assertion failed")}const Ts=async e=>{await async function(){console.assert(!ei),ei=await Jn({locateFile:e=>"/editor/"+e})}(),tr=e},As={},Ms=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),r=(null==n?void 0:n.nonce)||(null==n?void 0:n.getAttribute("nonce"));i=e(t.map(e=>{if((e=function(e){return"/editor/"+e}(e))in As)return;As[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script"),i.crossOrigin="",i.href=e,r&&i.setAttribute("nonce",r),document.head.appendChild(i),t?new Promise((t,n)=>{i.addEventListener("load",t),i.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return i.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},Is=async(e,t)=>{const n=(null==t?void 0:t.retries)??2;let i;for(let s=0;s<=n;s++){let o;try{o=await fetch(e,t)}catch(r){throw new Error(`[Network] (${e}) ${r}`)}if(o.ok)return o;if(i=new Error(`[Fetch] (${e}) ${o.statusText} (${o.status})`),s<n){const e=1e3*Math.pow(2,s);await new Promise(t=>setTimeout(t,e))}}throw i},_s=async(e,t,n)=>{const i=dr+"/api/v1/"+e,r=await Is(i,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},credentials:"include",body:JSON.stringify(t)});try{const e=await r.json();return(null==n?void 0:n.skipRedraw)||Oe.redraw(),e}catch(s){throw new Error(`JSON Parse failed (${i}) ${s}`)}},Os=async(e,t,n)=>{const i=await _s(e,t,n);if(i.success)return i;throw new Error("[API] Error: "+i.message)};function Ns(e,t){e=e||[],"string"==typeof(t=t||{})&&(t={type:t});try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<e.length;i+=1)n.append(e[i]);return n.getBlob(t.type)}}function Ds(e,t){var n=[Rs(atob(e))];return t?Ns(n,{type:t}):Ns(n)}function Rs(e){for(var t=e.length,n=new ArrayBuffer(t),i=new Uint8Array(n),r=-1;++r<t;)i[r]=e.charCodeAt(r);return n}var Fs,Bs={exports:{}};var Vs=(Fs||(Fs=1,Bs.exports=function(){var e=1e3,t=6e4,n=36e5,i="millisecond",r="second",s="minute",o="hour",a="day",l="week",c="month",h="quarter",u="year",d="date",p="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},v=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},y={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),i=Math.floor(n/60),r=n%60;return(t<=0?"+":"-")+v(i,2,"0")+":"+v(r,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var i=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(i,c),s=n-r<0,o=t.clone().add(i+(s?-1:1),c);return+(-(i+(n-r)/(s?r-o:o-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:l,d:a,D:d,h:o,m:s,s:r,ms:i,Q:h}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",w={};w[b]=g;var x=function(e){return e instanceof L},C=function e(t,n,i){var r;if(!t)return b;if("string"==typeof t){var s=t.toLowerCase();w[s]&&(r=s),n&&(w[s]=n,r=s);var o=t.split("-");if(!r&&o.length>1)return e(o[0])}else{var a=t.name;w[a]=t,r=a}return!i&&r&&(b=r),r||!i&&b},S=function(e,t){if(x(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new L(n)},k=y;k.l=C,k.i=x,k.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var L=function(){function g(e){this.$L=C(e.locale,null,!0),this.parse(e)}var v=g.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(k.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(f);if(i){var r=i[2]-1||0,s=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)):new Date(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return k},v.isValid=function(){return!(this.$d.toString()===p)},v.isSame=function(e,t){var n=S(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return S(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<S(e)},v.$g=function(e,t,n){return k.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,i=!!k.u(t)||t,h=k.p(e),p=function(e,t){var r=k.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return i?r:r.endOf(a)},f=function(e,t){return k.w(n.toDate()[e].apply(n.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(h){case u:return i?p(1,0):p(31,11);case c:return i?p(1,g):p(0,g+1);case l:var b=this.$locale().weekStart||0,w=(m<b?m+7:m)-b;return p(i?v-w:v+(6-w),g);case a:case d:return f(y+"Hours",0);case o:return f(y+"Minutes",1);case s:return f(y+"Seconds",2);case r:return f(y+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,l=k.p(e),h="set"+(this.$u?"UTC":""),p=(n={},n[a]=h+"Date",n[d]=h+"Date",n[c]=h+"Month",n[u]=h+"FullYear",n[o]=h+"Hours",n[s]=h+"Minutes",n[r]=h+"Seconds",n[i]=h+"Milliseconds",n)[l],f=l===a?this.$D+(t-this.$W):t;if(l===c||l===u){var m=this.clone().set(d,1);m.$d[p](f),m.init(),this.$d=m.set(d,Math.min(this.$D,m.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[k.p(e)]()},v.add=function(i,h){var d,p=this;i=Number(i);var f=k.p(h),m=function(e){var t=S(p);return k.w(t.date(t.date()+Math.round(e*i)),p)};if(f===c)return this.set(c,this.$M+i);if(f===u)return this.set(u,this.$y+i);if(f===a)return m(1);if(f===l)return m(7);var g=(d={},d[s]=t,d[o]=n,d[r]=e,d)[f]||1,v=this.$d.getTime()+i*g;return k.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||p;var i=e||"YYYY-MM-DDTHH:mm:ssZ",r=k.z(this),s=this.$H,o=this.$m,a=this.$M,l=n.weekdays,c=n.months,h=function(e,n,r,s){return e&&(e[n]||e(t,i))||r[n].slice(0,s)},u=function(e){return k.s(s%12||12,e,"0")},d=n.meridiem||function(e,t,n){var i=e<12?"AM":"PM";return n?i.toLowerCase():i},f={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:k.s(a+1,2,"0"),MMM:h(n.monthsShort,a,c,3),MMMM:h(c,a),D:this.$D,DD:k.s(this.$D,2,"0"),d:String(this.$W),dd:h(n.weekdaysMin,this.$W,l,2),ddd:h(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(s),HH:k.s(s,2,"0"),h:u(1),hh:u(2),a:d(s,o,!0),A:d(s,o,!1),m:String(o),mm:k.s(o,2,"0"),s:String(this.$s),ss:k.s(this.$s,2,"0"),SSS:k.s(this.$ms,3,"0"),Z:r};return i.replace(m,function(e,t){return t||f[e]||r.replace(":","")})},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(i,d,p){var f,m=k.p(d),g=S(i),v=(g.utcOffset()-this.utcOffset())*t,y=this-g,b=k.m(this,g);return b=(f={},f[u]=b/12,f[c]=b,f[h]=b/3,f[l]=(y-v)/6048e5,f[a]=(y-v)/864e5,f[o]=y/n,f[s]=y/t,f[r]=y/e,f)[m]||y,p?b:k.a(b)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return w[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),i=C(e,t,!0);return i&&(n.$L=i),n},v.clone=function(){return k.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),E=L.prototype;return S.prototype=E,[["$ms",i],["$s",r],["$m",s],["$H",o],["$W",a],["$M",c],["$y",u],["$D",d]].forEach(function(e){E[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),S.extend=function(e,t){return e.$i||(e(t,L,S),e.$i=!0),S},S.locale=C,S.isDayjs=x,S.unix=function(e){return S(1e3*e)},S.en=w[b],S.Ls=w,S.p={},S}()),Bs.exports);const js=D(Vs);var Hs,Us={exports:{}};var zs=(Hs||(Hs=1,Us.exports=function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(i,r,s){var o=r.prototype;s.utc=function(e){return new r({date:e,utc:!0,args:arguments})},o.utc=function(t){var n=s(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},o.local=function(){return s(this.toDate(),{locale:this.$L,utc:!1})};var a=o.parse;o.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),a.call(this,e)};var l=o.init;o.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var c=o.utcOffset;o.utcOffset=function(i,r){var s=this.$utils().u;if(s(i))return this.$u?0:s(this.$offset)?c.call(this):this.$offset;if("string"==typeof i&&null===(i=function(e){void 0===e&&(e="");var i=e.match(t);if(!i)return null;var r=(""+i[0]).match(n)||["-",0,0],s=r[0],o=60*+r[1]+ +r[2];return 0===o?0:"+"===s?o:-o}(i)))return this;var o=Math.abs(i)<=16?60*i:i,a=this;if(r)return a.$offset=o,a.$u=0===i,a;if(0!==i){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(a=this.local().add(o+l,e)).$offset=o,a.$x.$localOffset=l}else a=this.utc();return a};var h=o.format;o.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,t)},o.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},o.isUTC=function(){return!!this.$u},o.toISOString=function(){return this.toDate().toISOString()},o.toString=function(){return this.toDate().toUTCString()};var u=o.toDate;o.toDate=function(e){return"s"===e&&this.$offset?s(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():u.call(this)};var d=o.diff;o.diff=function(e,t,n){if(e&&this.$u===e.$u)return d.call(this,e,t,n);var i=this.local(),r=s(e).local();return d.call(i,r,t,n)}}}()),Us.exports);const Ws=D(zs);var Gs,$s;var Zs=function(){if($s)return Gs;$s=1;const e=(e,t)=>{if(!e)throw new Error(t)},t=(e,t={})=>n=>({type:e,value:n,...t}),n=(e,n={})=>{const i=t(e,n);return i(i)},i=e=>Array.isArray(e)?e.map(i):"[object Object]"===Object.prototype.toString.call(e)?Object.entries(e).reduce((e,[t,n])=>(e[t]=i(n),e),{}):e,r="\\.^$|?*+()[]{}-".split(""),s=e=>r.reduce((e,t)=>((e,t,n)=>e.replace(new RegExp(`\\${t}`,"g"),n))(e,t,`\\${t}`),e),o=/^[a-z]+\w*$/i,a={oneOrMore:"+",oneOrMoreLazy:"+?",zeroOrMore:"*",zeroOrMoreLazy:"*?",optional:"?",exactly:e=>`{${e}}`,atLeast:e=>`{${e},}`,between:e=>`{${e[0]},${e[1]}}`,betweenLazy:e=>`{${e[0]},${e[1]}}?`},l={root:t("root")(),noop:t("noop")(),startOfInput:t("startOfInput")(),endOfInput:t("endOfInput")(),anyChar:t("anyChar")(),whitespaceChar:t("whitespaceChar")(),nonWhitespaceChar:t("nonWhitespaceChar")(),digit:t("digit")(),nonDigit:t("nonDigit")(),word:t("word")(),nonWord:t("nonWord")(),wordBoundary:t("wordBoundary")(),nonWordBoundary:t("nonWordBoundary")(),newline:t("newline")(),carriageReturn:t("carriageReturn")(),tab:t("tab")(),nullByte:t("nullByte")(),anyOfChars:t("anyOfChars"),anythingButString:t("anythingButString"),anythingButChars:t("anythingButChars"),anythingButRange:t("anythingButRange"),char:t("char"),range:t("range"),string:t("string",{quantifierRequiresGroup:!0}),namedBackreference:e=>n("namedBackreference",{name:e}),backreference:e=>n("backreference",{index:e}),capture:n("capture",{containsChildren:!0}),subexpression:t("subexpression",{containsChildren:!0,quantifierRequiresGroup:!0}),namedCapture:e=>n("namedCapture",{name:e,containsChildren:!0}),group:n("group",{containsChildren:!0}),anyOf:n("anyOf",{containsChildren:!0}),assertAhead:n("assertAhead",{containsChildren:!0}),assertNotAhead:n("assertNotAhead",{containsChildren:!0}),assertBehind:n("assertBehind",{containsChildren:!0}),assertNotBehind:n("assertNotBehind",{containsChildren:!0}),exactly:e=>n("exactly",{times:e,containsChild:!0}),atLeast:e=>n("atLeast",{times:e,containsChild:!0}),between:(e,t)=>n("between",{times:[e,t],containsChild:!0}),betweenLazy:(e,t)=>n("betweenLazy",{times:[e,t],containsChild:!0}),zeroOrMore:n("zeroOrMore",{containsChild:!0}),zeroOrMoreLazy:n("zeroOrMoreLazy",{containsChild:!0}),oneOrMore:n("oneOrMore",{containsChild:!0}),oneOrMoreLazy:n("oneOrMoreLazy",{containsChild:!0}),optional:n("optional",{containsChild:!0})},c=e=>"range"===e.type||"char"===e.type||"anyOfChars"===e.type,h=e=>({type:e,quantifier:null,elements:[]}),u=Symbol("clone"),d=Symbol("getCurrentFrame"),p=Symbol("getCurrentElementArray"),f=Symbol("applyQuantifier"),m=Symbol("evaluate"),g=Symbol("getRegexBody"),v=Symbol("matchElement"),y=Symbol("frameCreatingElement"),b=Symbol("quantifierElement"),w=Symbol("mergeSubexpression"),x=Symbol("trackNamedGroup");class C{constructor(){this.state={hasDefinedStart:!1,hasDefinedEnd:!1,flags:{g:!1,y:!1,m:!1,i:!1,u:!1,s:!1},stack:[h(l.root)],namedGroups:[],totalCaptureGroups:0}}get allowMultipleMatches(){const e=this[u]();return e.state.flags.g=!0,e}get lineByLine(){const e=this[u]();return e.state.flags.m=!0,e}get caseInsensitive(){const e=this[u]();return e.state.flags.i=!0,e}get sticky(){const e=this[u]();return e.state.flags.y=!0,e}get unicode(){const e=this[u]();return e.state.flags.u=!0,e}get singleLine(){const e=this[u]();return e.state.flags.s=!0,e}[v](e){const t=this[u]();return t[p]().push(t[f](e)),t}get anyChar(){return this[v](l.anyChar)}get whitespaceChar(){return this[v](l.whitespaceChar)}get nonWhitespaceChar(){return this[v](l.nonWhitespaceChar)}get digit(){return this[v](l.digit)}get nonDigit(){return this[v](l.nonDigit)}get word(){return this[v](l.word)}get nonWord(){return this[v](l.nonWord)}get wordBoundary(){return this[v](l.wordBoundary)}get nonWordBoundary(){return this[v](l.nonWordBoundary)}get newline(){return this[v](l.newline)}get carriageReturn(){return this[v](l.carriageReturn)}get tab(){return this[v](l.tab)}get nullByte(){return this[v](l.nullByte)}namedBackreference(t){return e(this.state.namedGroups.includes(t),`no capture group called "${t}" exists (create one with .namedCapture())`),this[v](l.namedBackreference(t))}backreference(t){return e("number"==typeof t,"index must be a number"),e(t>0&&t<=this.state.totalCaptureGroups,`invalid index ${t}. There are ${this.state.totalCaptureGroups} capture groups on this SuperExpression`),this[v](l.backreference(t))}[y](e){const t=this[u](),n=h(e);return t.state.stack.push(n),t}get anyOf(){return this[y](l.anyOf)}get group(){return this[y](l.group)}get assertAhead(){return this[y](l.assertAhead)}get assertNotAhead(){return this[y](l.assertNotAhead)}get assertBehind(){return this[y](l.assertBehind)}get assertNotBehind(){return this[y](l.assertNotBehind)}get capture(){const e=this[u](),t=h(l.capture);return e.state.stack.push(t),e.state.totalCaptureGroups++,e}[x](t){e("string"==typeof t,`name must be a string (got ${t})`),e(t.length>0,"name must be at least one character"),e(!this.state.namedGroups.includes(t),`cannot use ${t} again for a capture group`),e(o.test(t),`name "${t}" is not valid (only letters, numbers, and underscores)`),this.state.namedGroups.push(t)}namedCapture(e){const t=this[u](),n=h(l.namedCapture(e));return t[x](e),t.state.stack.push(n),t.state.totalCaptureGroups++,t}[b](e){const t=this[u](),n=t[d]();if(n.quantifier)throw new Error(`cannot quantify regular expression with "${e}" because it's already being quantified with "${n.quantifier.type}"`);return n.quantifier=l[e],t}get optional(){return this[b]("optional")}get zeroOrMore(){return this[b]("zeroOrMore")}get zeroOrMoreLazy(){return this[b]("zeroOrMoreLazy")}get oneOrMore(){return this[b]("oneOrMore")}get oneOrMoreLazy(){return this[b]("oneOrMoreLazy")}exactly(t){e(Number.isInteger(t)&&t>0,`n must be a positive integer (got ${t})`);const n=this[u](),i=n[d]();if(i.quantifier)throw new Error(`cannot quantify regular expression with "exactly" because it's already being quantified with "${i.quantifier.type}"`);return i.quantifier=l.exactly(t),n}atLeast(t){e(Number.isInteger(t)&&t>0,`n must be a positive integer (got ${t})`);const n=this[u](),i=n[d]();if(i.quantifier)throw new Error(`cannot quantify regular expression with "atLeast" because it's already being quantified with "${i.quantifier.type}"`);return i.quantifier=l.atLeast(t),n}between(t,n){e(Number.isInteger(t)&&t>=0,`x must be an integer (got ${t})`),e(Number.isInteger(n)&&n>0,`y must be an integer greater than 0 (got ${n})`),e(t<n,`x must be less than y (x = ${t}, y = ${n})`);const i=this[u](),r=i[d]();if(r.quantifier)throw new Error(`cannot quantify regular expression with "between" because it's already being quantified with "${r.quantifier.type}"`);return r.quantifier=l.between(t,n),i}betweenLazy(t,n){e(Number.isInteger(t)&&t>=0,`x must be an integer (got ${t})`),e(Number.isInteger(n)&&n>0,`y must be an integer greater than 0 (got ${n})`),e(t<n,`x must be less than y (x = ${t}, y = ${n})`);const i=this[u](),r=i[d]();if(r.quantifier)throw new Error(`cannot quantify regular expression with "betweenLazy" because it's already being quantified with "${r.quantifier.type}"`);return r.quantifier=l.betweenLazy(t,n),i}get startOfInput(){e(!this.state.hasDefinedStart,"This regex already has a defined start of input"),e(!this.state.hasDefinedEnd,"Cannot define the start of input after the end of input");const t=this[u]();return t.state.hasDefinedStart=!0,t[p]().push(l.startOfInput),t}get endOfInput(){e(!this.state.hasDefinedEnd,"This regex already has a defined end of input");const t=this[u]();return t.state.hasDefinedEnd=!0,t[p]().push(l.endOfInput),t}anyOfChars(e){const t=this[u](),n=l.anyOfChars(s(e));return t[d]().elements.push(t[f](n)),t}end(){e(this.state.stack.length>1,"Cannot call end while building the root expression.");const t=this[u](),n=t.state.stack.pop();return t[d]().elements.push(t[f](n.type.value(n.elements))),t}anythingButString(t){e("string"==typeof t,`str must be a string (got ${t})`),e(t.length>0,"str must have least one character");const n=this[u](),i=l.anythingButString(s(t));return n[d]().elements.push(n[f](i)),n}anythingButChars(t){e("string"==typeof t,`chars must be a string (got ${t})`),e(t.length>0,"chars must have at least one character");const n=this[u](),i=l.anythingButChars(s(t));return n[d]().elements.push(n[f](i)),n}anythingButRange(t,n){const i=t.toString(),r=n.toString();e(1===i.length,`a must be a single character or number (got ${i})`),e(1===r.length,`b must be a single character or number (got ${r})`),e(i.charCodeAt(0)<r.charCodeAt(0),`a must have a smaller character value than b (a = ${i.charCodeAt(0)}, b = ${r.charCodeAt(0)})`);const s=this[u](),o=l.anythingButRange([t,n]);return s[d]().elements.push(s[f](o)),s}string(t){e("string"==typeof t,`s must be a string (got ${t})`),e(t.length>0,"s cannot be an empty string");const n=this[u](),i=t.length>1?l.string(s(t)):l.char(s(t));return n[d]().elements.push(n[f](i)),n}char(t){e("string"==typeof t,`c must be a string (got ${t})`),e(1===t.length,`char() can only be called with a single character (got ${t})`);const n=this[u]();return n[d]().elements.push(n[f](l.char(s(t)))),n}range(t,n){const i=t.toString(),r=n.toString();e(1===i.length,`a must be a single character or number (got ${i})`),e(1===r.length,`b must be a single character or number (got ${r})`),e(i.charCodeAt(0)<r.charCodeAt(0),`a must have a smaller character value than b (a = ${i.charCodeAt(0)}, b = ${r.charCodeAt(0)})`);const s=this[u](),o=l.range([i,r]);return s[d]().elements.push(s[f](o)),s}static[w](t,n,r,s){let o=i(t);if("backreference"===o.type&&(o.index+=r.state.totalCaptureGroups),"capture"===o.type&&s(),"namedCapture"===o.type){const e=n.namespace?`${n.namespace}${o.name}`:o.name;r[x](e),o.name=e}if("namedBackreference"===o.type&&(o.name=n.namespace?`${n.namespace}${o.name}`:o.name),o.containsChild?o.value=C[w](o.value,n,r,s):o.containsChildren&&(o.value=o.value.map(e=>C[w](e,n,r,s))),"startOfInput"===o.type){if(n.ignoreStartAndEnd)return l.noop;e(!r.state.hasDefinedStart,"The parent regex already has a defined start of input. You can ignore a subexpressions startOfInput/endOfInput markers with the ignoreStartAndEnd option"),e(!r.state.hasDefinedEnd,"The parent regex already has a defined end of input. You can ignore a subexpressions startOfInput/endOfInput markers with the ignoreStartAndEnd option"),r.state.hasDefinedStart=!0}if("endOfInput"===o.type){if(n.ignoreStartAndEnd)return l.noop;e(!r.state.hasDefinedEnd,"The parent regex already has a defined start of input. You can ignore a subexpressions startOfInput/endOfInput markers with the ignoreStartAndEnd option"),r.state.hasDefinedEnd=!0}return o}subexpression(t,n={}){e(t instanceof C,"expr must be a SuperExpressive instance"),e(1===t.state.stack.length,`Cannot call subexpression with a not yet fully specified regex object.\n(Try adding a .end() call to match the "${t[d]().type.type}" on the subexpression)\n`);const i=(t=>{const n={...t};return n.namespace="namespace"in n?n.namespace:"",n.ignoreFlags=!("ignoreFlags"in n)||n.ignoreFlags,n.ignoreStartAndEnd=!("ignoreStartAndEnd"in n)||n.ignoreStartAndEnd,e("string"==typeof n.namespace,"namespace must be a string"),e("boolean"==typeof n.ignoreFlags,"ignoreFlags must be a boolean"),e("boolean"==typeof n.ignoreStartAndEnd,"ignoreStartAndEnd must be a boolean"),n})(n),r=t[u](),s=this[u]();let o=0;const a=r[d]();a.elements=a.elements.map(e=>C[w](e,i,s,()=>o++)),s.state.totalCaptureGroups+=o,i.ignoreFlags||Object.entries(r.state.flags).forEach(([e,t])=>{s.state.flags[e]=t||s.state.flags[e]});return s[d]().elements.push(s[f](l.subexpression(a.elements))),s}toRegexString(){const{pattern:e,flags:t}=this[g]();return`/${e}/${t}`}toRegex(){const{pattern:e,flags:t}=this[g]();return new RegExp(e,t)}[g](){e(1===this.state.stack.length,`Cannot compute the value of a not yet fully specified regex object.\n(Try adding a .end() call to match the "${this[d]().type.type}")\n`);const t=this[p]().map(C[m]).join("");return{pattern:""===t?"(?:)":t,flags:Object.entries(this.state.flags).map(([e,t])=>t?e:"").sort().join("")}}[f](e){const t=this[d]();if(t.quantifier){const n=t.quantifier.value(e);return t.quantifier=null,n}return e}[d](){return this.state.stack[this.state.stack.length-1]}[p](){return this[d]().elements}[u](){const e=new C;return e.state=i(this.state),e}static[m](e){switch(e.type){case"noop":return"";case"anyChar":return".";case"whitespaceChar":return"\\s";case"nonWhitespaceChar":return"\\S";case"digit":return"\\d";case"nonDigit":return"\\D";case"word":return"\\w";case"nonWord":return"\\W";case"wordBoundary":return"\\b";case"nonWordBoundary":return"\\B";case"startOfInput":return"^";case"endOfInput":return"$";case"newline":return"\\n";case"carriageReturn":return"\\r";case"tab":return"\\t";case"nullByte":return"\\0";case"string":case"char":return e.value;case"range":return`[${e.value[0]}-${e.value[1]}]`;case"anythingButRange":return`[^${e.value[0]}-${e.value[1]}]`;case"anyOfChars":return`[${e.value}]`;case"anythingButChars":return`[^${e.value}]`;case"namedBackreference":return`\\k<${e.name}>`;case"backreference":return`\\${e.index}`;case"subexpression":return e.value.map(C[m]).join("");case"optional":case"zeroOrMore":case"zeroOrMoreLazy":case"oneOrMore":case"oneOrMoreLazy":{const t=C[m](e.value);return`${e.value.quantifierRequiresGroup?`(?:${t})`:t}${a[e.type]}`}case"betweenLazy":case"between":case"atLeast":case"exactly":{const t=C[m](e.value);return`${e.value.quantifierRequiresGroup?`(?:${t})`:t}${a[e.type](e.times)}`}case"anythingButString":return`(?:${e.value.split("").map(e=>`[^${e}]`).join("")})`;case"assertAhead":return`(?=${e.value.map(C[m]).join("")})`;case"assertBehind":return`(?<=${e.value.map(C[m]).join("")})`;case"assertNotAhead":return`(?!${e.value.map(C[m]).join("")})`;case"assertNotBehind":return`(?<!${e.value.map(C[m]).join("")})`;case"anyOf":{const[t,n]=(e=>{const[t,n]=(i=c,e.reduce((e,t)=>(i(t)?e[0].push(t):e[1].push(t),e),[[],[]]));var i;return[t.map(e=>"char"===e.type||"anyOfChars"===e.type?e.value:`${e.value[0]}-${e.value[1]}`).join(""),n]})(e.value);if(!n.length)return`[${t}]`;const i=n.map(C[m]),r=i.length>0&&t.length>0?"|":"";return`(?:${i.join("|")}${r}${t?`[${t}]`:""})`}case"capture":return`(${e.value.map(C[m]).join("")})`;case"namedCapture":{const t=e.value.map(C[m]);return`(?<${e.name}>${t.join("")})`}case"group":return`(?:${e.value.map(C[m]).join("")})`;default:throw new Error(`Can't process unsupported element type: ${e.type}`)}}static create(){return new C}}return Gs=C.create}();const qs=D(Zs);js.extend(Ws);const Ks=e=>"number"==typeof e&&!isNaN(e),Ys=e=>"string"==typeof e,Xs=e=>Array.isArray(e),Js=e=>"object"==typeof e&&null!==e,Qs=e=>"boolean"==typeof e,eo=e=>{const t=[];for(let n of Object.keys(e))e[n]&&t.push(n);if(0!==t.length)return t.join(" ")},to=()=>navigator.platform.startsWith("Mac"),no=()=>{var e;return Boolean(null==(e=va.loggedInUser)?void 0:e.isAdmin)},io=()=>{const{activeElement:e}=document;return null!==e&&e!==document.body&&!(e instanceof HTMLInputElement&&"checkbox"===e.type)},ro=e=>!so(e)&&io(),so=e=>{var t,n,i,r;return!!(null==(r=null==(i=null==(n=null==(t=e.target)?void 0:t.parentNode)?void 0:n.parentNode)?void 0:i.classList)?void 0:r.contains("CodeMirror"))},oo=e=>"Shift"===e||("Control"===e||("Alt"===e||"Meta"===e));let ao,lo=!1;window.addEventListener("pointerdown",e=>{var t,n;e.target&&(null==(n=null==(t=e.target)?void 0:t.classList)?void 0:n.contains("CodeMirror-hint"))&&e.preventDefault(),lo=co(e),ao=e});const co=e=>{if(void 0===ao||lo)return!1;const t=ao.timeStamp,n=e.timeStamp-t<400,i=((e,t)=>{const n=e.clientX,i=e.clientY,r=t.clientX-n,s=t.clientY-i;return Math.sqrt(r*r+s*s)})(ao,e)<4;return n&&i},ho=e=>2===e.button,uo=e=>{const t=e.dom;if(!t)throw"vnode doesn't have .dom property";return t},po=e=>{const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)},fo=['a[href]:not([tabindex^="-"])','area[href]:not([tabindex^="-"])','input:not([type="hidden"]):not([type="radio"]):not([disabled]):not([tabindex^="-"])','input[type="radio"]:not([disabled]):not([tabindex^="-"])','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','iframe:not([tabindex^="-"])','audio[controls]:not([tabindex^="-"])','video[controls]:not([tabindex^="-"])','[contenteditable]:not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])'],mo=e=>e.substring(e.lastIndexOf(".")+1).toLowerCase(),go=["svg","gif","mp4"],vo=e=>{const t=mo(e);return go.includes(t)},yo=(e,t)=>`https://${fr}.imgix.net/${e}?auto=compress,format&q=${40+40/t}&fit=fill&fill=blur&width=400&height=225&dpr=${t}`,bo=(e,t)=>{let n;const i=()=>{clearTimeout(n),e()};return()=>{window.clearTimeout(n),n=window.setTimeout(i,t)}},wo=(e,t,n)=>"_intro"===n?"/intro":`/@${e}/${(e=>e.replace(/[^\w]+/g,"-").replace(/(^-)|(-$)/g,""))(t)}-${n}`,xo=qs().startOfInput.string("/@").namedCapture("ProjectOwner").oneOrMore.word.end().string("/").namedCapture("ProjectTitle").oneOrMore.anyOf.word.string("-").end().end().string("-").namedCapture("ProjectId").oneOrMore.anyOf.range("a","z").range("A","Z").range("0","9").end().end().endOfInput.toRegex(),Co=e=>wo(e.owner,e.name,e.projectId),So=Ds("iVBORw0KGgoAAAANSUhEUgAAAyAAAAHCAQMAAAAtrT+LAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAENJREFUeNrtwYEAAAAAw6D7U19hANUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALIDsYoAAZ9qTLEAAAAASUVORK5CYII=","image/png"),ko=URL.createObjectURL(So),Lo=()=>{Oe.route.set("/dashboard")},Eo=e=>js.utc(e).local().format("MMM D, YYYY"),Po=e=>{const t=js(),n=js.utc(e).local();return n.year()===t.year()?n.format("MMM D"):n.format("MMM D, YYYY")};async function To(e){const t=await window.crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}const Ao=(e,t)=>{const{pathname:n}=window.location,i=(e=>{const t=xo.exec(e);if(t&&t.groups)return{owner:t.groups.ProjectOwner,title:t.groups.ProjectTitle,projectId:t.groups.ProjectId}})(n),r={eventName:e,projectId:null==i?void 0:i.projectId,metadata:t};window.location.host.includes("localhost.cuttle.xyz")||Os("logEvent",r,{skipRedraw:!0})},Mo=window.location.href,Io=()=>{const e=navigator.userAgent;return/ipad|tablet/i.test(e)?"tablet":/mobi|android|phone/i.test(e)?"mobile":"desktop"},_o=()=>{var e;null==(e=window.rewardful)||e.call(window,"ready",()=>{const e=window.Rewardful,t=window.location.href,n=document.referrer,i=e.referral,r=e.affiliate.id;i&&Ao("rewardful visit",{referral:i,affiliate:r,url:t,referrer:n})})},Oo=()=>{var e;const t=window.Rewardful;return{url:window.location.href,device:Io(),referrer:document.referrer,landingUrl:Mo,referral:(null==t?void 0:t.referral)||void 0,affiliate:(null==(e=null==t?void 0:t.affiliate)?void 0:e.id)||void 0}},No=()=>{var e;return(null==(e=window.Rewardful)?void 0:e.referral)??void 0};null==(b=window.rewardful)||b.call(window,"ready",()=>{Oe.redraw()});const Do=(e,t)=>{try{window.fbq("track",e,t)}catch(n){}},Ro=Object.freeze(Object.defineProperty({__proto__:null,add_hole:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M19 13C15.6863 13 13 15.6863 13 19H12C12 15.134 15.134 12 19 12V13ZM9.39355 8.68652C9.39625 8.68921 9.39965 8.69164 9.40234 8.69434C9.40505 8.69704 9.40745 8.70042 9.41016 8.70312C9.41276 8.70573 9.41536 8.70833 9.41797 8.71094C9.42068 8.71365 9.42404 8.71604 9.42676 8.71875C9.42948 8.72147 9.43184 8.72481 9.43457 8.72754L9.45898 8.75195C9.46172 8.75469 9.46503 8.75702 9.46777 8.75977C9.47052 8.76251 9.47283 8.7658 9.47559 8.76855L9.52539 8.81836C9.52816 8.82112 9.53141 8.8234 9.53418 8.82617C9.53693 8.82893 9.53923 8.8322 9.54199 8.83496L9.56738 8.86035C9.57015 8.86312 9.5734 8.86539 9.57617 8.86816C9.57892 8.87092 9.58123 8.8742 9.58398 8.87695C9.5868 8.87977 9.58995 8.88292 9.59277 8.88574C9.59554 8.88851 9.59879 8.89079 9.60156 8.89355C9.60432 8.89631 9.60661 8.89958 9.60938 8.90234L9.7041 8.99707C9.70686 8.99983 9.71013 9.00212 9.71289 9.00488C9.71566 9.00765 9.71793 9.0109 9.7207 9.01367L9.81738 9.11035C9.82015 9.11312 9.8234 9.1154 9.82617 9.11816C9.82909 9.12108 9.83204 9.12403 9.83496 9.12695C9.83789 9.12989 9.84081 9.13378 9.84375 9.13672L9.94043 9.2334C9.9434 9.23637 9.94722 9.23921 9.9502 9.24219C9.95316 9.24516 9.95601 9.24898 9.95898 9.25195L10.1748 9.46777C10.1778 9.4708 10.1815 9.47353 10.1846 9.47656C10.1876 9.47959 10.1903 9.4833 10.1934 9.48633L10.2568 9.5498C10.2599 9.55285 10.2636 9.55555 10.2666 9.55859C10.2696 9.56164 10.2723 9.56531 10.2754 9.56836L10.3301 9.62305C10.3331 9.6261 10.3368 9.62878 10.3398 9.63184C10.3429 9.63488 10.3456 9.63856 10.3486 9.6416L10.4678 9.76074C10.4708 9.76381 10.4745 9.76647 10.4775 9.76953C10.4806 9.77259 10.4833 9.77624 10.4863 9.7793L10.624 9.91699C10.6271 9.92005 10.6307 9.92272 10.6338 9.92578C10.6369 9.92884 10.6395 9.93248 10.6426 9.93555L10.7158 10.0088C10.7189 10.0118 10.7225 10.0145 10.7256 10.0176C10.7286 10.0206 10.7313 10.0243 10.7344 10.0273L10.9893 10.2822C10.9923 10.2852 10.996 10.288 10.999 10.291C11.002 10.294 11.0048 10.2978 11.0078 10.3008L11.0703 10.3633C11.0733 10.3663 11.0771 10.3691 11.0801 10.3721C11.0831 10.3751 11.0859 10.3789 11.0889 10.3818L11.2393 10.5322C11.2422 10.5352 11.2461 10.5381 11.249 10.541L11.2754 10.5674C11.2782 10.5702 11.2804 10.5734 11.2832 10.5762L11.3711 10.6641C11.3739 10.6668 11.3771 10.6691 11.3799 10.6719C11.3827 10.6746 11.3849 10.6779 11.3877 10.6807L11.6406 10.9336C11.6433 10.9363 11.6467 10.9387 11.6494 10.9414C11.6521 10.9441 11.6545 10.9475 11.6572 10.9502L11.7217 11.0146C11.7243 11.0173 11.7278 11.0198 11.7305 11.0225C11.7331 11.0251 11.7356 11.0286 11.7383 11.0312L11.7695 11.0625C11.7722 11.0651 11.7757 11.0677 11.7783 11.0703C11.781 11.0729 11.7835 11.0765 11.7861 11.0791L12 11.293V9H13V13H9V12H11.293L11.0791 11.7861C11.0765 11.7835 11.0729 11.781 11.0703 11.7783C11.0677 11.7757 11.0651 11.7722 11.0625 11.7695L11.0312 11.7383C11.0286 11.7356 11.0251 11.7331 11.0225 11.7305C11.0198 11.7278 11.0173 11.7243 11.0146 11.7217L10.9502 11.6572C10.9475 11.6545 10.9441 11.6521 10.9414 11.6494C10.9387 11.6467 10.9363 11.6433 10.9336 11.6406L10.6807 11.3877C10.6779 11.3849 10.6746 11.3827 10.6719 11.3799C10.6691 11.3771 10.6668 11.3739 10.6641 11.3711L10.5762 11.2832C10.5734 11.2804 10.5702 11.2782 10.5674 11.2754L10.541 11.249C10.5381 11.2461 10.5352 11.2422 10.5322 11.2393L10.3818 11.0889C10.3789 11.0859 10.3751 11.0831 10.3721 11.0801C10.3691 11.0771 10.3663 11.0733 10.3633 11.0703L10.3008 11.0078C10.2978 11.0048 10.294 11.002 10.291 10.999C10.288 10.996 10.2852 10.9923 10.2822 10.9893L10.0273 10.7344C10.0243 10.7313 10.0206 10.7286 10.0176 10.7256C10.0145 10.7225 10.0118 10.7189 10.0088 10.7158L9.93555 10.6426C9.93248 10.6395 9.92884 10.6369 9.92578 10.6338C9.92272 10.6307 9.92005 10.6271 9.91699 10.624L9.7793 10.4863C9.77624 10.4833 9.77259 10.4806 9.76953 10.4775C9.76647 10.4745 9.76381 10.4708 9.76074 10.4678L9.6416 10.3486C9.63856 10.3456 9.63488 10.3429 9.63184 10.3398C9.62878 10.3368 9.6261 10.3331 9.62305 10.3301L9.56836 10.2754C9.56531 10.2723 9.56164 10.2696 9.55859 10.2666C9.55555 10.2636 9.55285 10.2599 9.5498 10.2568L9.48633 10.1934C9.4833 10.1903 9.47959 10.1876 9.47656 10.1846C9.47353 10.1815 9.4708 10.1778 9.46777 10.1748L9.25195 9.95898C9.24898 9.95601 9.24516 9.95316 9.24219 9.9502C9.23921 9.94722 9.23637 9.9434 9.2334 9.94043L9.13672 9.84375C9.13378 9.84081 9.12989 9.83789 9.12695 9.83496C9.12403 9.83204 9.12108 9.82909 9.11816 9.82617C9.1154 9.8234 9.11312 9.82015 9.11035 9.81738L9.01367 9.7207C9.0109 9.71793 9.00765 9.71566 9.00488 9.71289C9.00212 9.71013 8.99983 9.70686 8.99707 9.7041L8.90234 9.60938C8.89958 9.60661 8.89631 9.60432 8.89355 9.60156C8.89079 9.59879 8.88851 9.59554 8.88574 9.59277C8.88292 9.58995 8.87977 9.5868 8.87695 9.58398C8.8742 9.58123 8.87092 9.57892 8.86816 9.57617C8.86539 9.5734 8.86312 9.57015 8.86035 9.56738L8.83496 9.54199C8.8322 9.53923 8.82893 9.53693 8.82617 9.53418C8.8234 9.53141 8.82112 9.52816 8.81836 9.52539L8.76855 9.47559C8.7658 9.47283 8.76251 9.47052 8.75977 9.46777C8.75702 9.46503 8.75469 9.46172 8.75195 9.45898L8.72754 9.43457C8.72481 9.43184 8.72147 9.42948 8.71875 9.42676C8.71604 9.42404 8.71365 9.42068 8.71094 9.41797C8.70833 9.41536 8.70573 9.41276 8.70312 9.41016C8.70042 9.40745 8.69704 9.40505 8.69434 9.40234C8.69164 9.39965 8.68921 9.39625 8.68652 9.39355L8.64648 9.35352L9.35352 8.64648L9.39355 8.68652ZM5.5 2C7.433 2 9 3.567 9 5.5C9 7.433 7.433 9 5.5 9C3.567 9 2 7.433 2 5.5C2 3.567 3.567 2 5.5 2ZM5.5 4C4.67157 4 4 4.67157 4 5.5C4 6.32843 4.67157 7 5.5 7C6.32843 7 7 6.32843 7 5.5C7 4.67157 6.32843 4 5.5 4Z" fill="black"/>\n</svg>\n',align_bottom:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<mask id="path-1-inside-1_840:305" fill="white">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17 16L3 16L3 15L17 15L17 16ZM5 14L5 4L9 4L9 14L5 14ZM11 9L11 14L15 14L15 9L11 9Z"/>\n</mask>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17 16L3 16L3 15L17 15L17 16ZM5 14L5 4L9 4L9 14L5 14ZM11 9L11 14L15 14L15 9L11 9Z" fill="black"/>\n<path d="M3 16L2 16L2 17L3 17L3 16ZM17 16L17 17L18 17L18 16L17 16ZM3 15L3 14L2 14L2 15L3 15ZM17 15L18 15L18 14L17 14L17 15ZM5 4L5 3L4 3L4 4L5 4ZM5 14L4 14L4 15L5 15L5 14ZM9 4L10 4L10 3L9 3L9 4ZM9 14L9 15L10 15L10 14L9 14ZM11 14L10 14L10 15L11 15L11 14ZM11 9L11 8L10 8L10 9L11 9ZM15 14L15 15L16 15L16 14L15 14ZM15 9L16 9L16 8L15 8L15 9ZM3 17L17 17L17 15L3 15L3 17ZM2 15L2 16L4 16L4 15L2 15ZM17 14L3 14L3 16L17 16L17 14ZM18 16L18 15L16 15L16 16L18 16ZM4 4L4 14L6 14L6 4L4 4ZM9 3L5 3L5 5L9 5L9 3ZM10 14L10 4L8 4L8 14L10 14ZM5 15L9 15L9 13L5 13L5 15ZM12 14L12 9L10 9L10 14L12 14ZM15 13L11 13L11 15L15 15L15 13ZM14 9L14 14L16 14L16 9L14 9ZM11 10L15 10L15 8L11 8L11 10Z" fill="black" mask="url(#path-1-inside-1_840:305)"/>\n</svg>\n',align_center:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<mask id="path-1-inside-1_840:308" fill="white">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 11V9H15V5H10V3H9V5H4V9H9V11H7V15H9V17H10V15H12V11H10Z"/>\n</mask>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 11V9H15V5H10V3H9V5H4V9H9V11H7V15H9V17H10V15H12V11H10Z" fill="black"/>\n<path d="M10 9H9V8H10V9ZM10 11V12H9V11H10ZM15 9H16V10H15V9ZM15 5V4H16V5H15ZM10 5V6H9V5H10ZM10 3V2H11V3H10ZM9 3H8V2H9V3ZM9 5H10V6H9V5ZM4 5H3V4H4V5ZM4 9V10H3V9H4ZM9 9V8H10V9H9ZM9 11H10V12H9V11ZM7 11H6V10H7V11ZM7 15V16H6V15H7ZM9 15V14H10V15H9ZM9 17V18H8V17H9ZM10 17H11V18H10V17ZM10 15H9V14H10V15ZM12 15H13V16H12V15ZM12 11V10H13V11H12ZM11 9V11H9V9H11ZM15 10H10V8H15V10ZM16 5V9H14V5H16ZM10 4H15V6H10V4ZM11 3V5H9V3H11ZM9 2H10V4H9V2ZM8 5V3H10V5H8ZM4 4H9V6H4V4ZM3 9V5H5V9H3ZM9 10H4V8H9V10ZM8 11V9H10V11H8ZM9 12H7V10H9V12ZM8 11V15H6V11H8ZM7 14H9V16H7V14ZM8 17V15H10V17H8ZM10 18H9V16H10V18ZM11 15V17H9V15H11ZM10 14H12V16H10V14ZM11 15V11H13V15H11ZM12 12H10V10H12V12Z" fill="black" mask="url(#path-1-inside-1_840:308)"/>\n</svg>\n',align_left:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<mask id="path-1-inside-1_840:310" fill="white">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M4 17V3H5V17H4ZM6 5H16V9H6V5ZM11 11H6V15H11V11Z"/>\n</mask>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M4 17V3H5V17H4ZM6 5H16V9H6V5ZM11 11H6V15H11V11Z" fill="black"/>\n<path d="M4 3V2H3V3H4ZM4 17H3V18H4V17ZM5 3H6V2H5V3ZM5 17V18H6V17H5ZM16 5H17V4H16V5ZM6 5V4H5V5H6ZM16 9V10H17V9H16ZM6 9H5V10H6V9ZM6 11V10H5V11H6ZM11 11H12V10H11V11ZM6 15H5V16H6V15ZM11 15V16H12V15H11ZM3 3V17H5V3H3ZM5 2H4V4H5V2ZM6 17V3H4V17H6ZM4 18H5V16H4V18ZM16 4H6V6H16V4ZM17 9V5H15V9H17ZM6 10H16V8H6V10ZM5 5V9H7V5H5ZM6 12H11V10H6V12ZM7 15V11H5V15H7ZM11 14H6V16H11V14ZM10 11V15H12V11H10Z" fill="black" mask="url(#path-1-inside-1_840:310)"/>\n</svg>\n',align_middle:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<mask id="path-1-inside-1_840:306" fill="white">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M11 10L9 10L9 15L5 15L5 10L3 10L3 9L5 9L5 4L9 4L9 9L11 9L11 7L15 7L15 9L17 9L17 10L15 10L15 12L11 12L11 10Z"/>\n</mask>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M11 10L9 10L9 15L5 15L5 10L3 10L3 9L5 9L5 4L9 4L9 9L11 9L11 7L15 7L15 9L17 9L17 10L15 10L15 12L11 12L11 10Z" fill="black"/>\n<path d="M9 10L9 9L8 9L8 10L9 10ZM11 10L12 10L12 9L11 9L11 10ZM9 15L9 16L10 16L10 15L9 15ZM5 15L4 15L4 16L5 16L5 15ZM5 10L6 10L6 9L5 9L5 10ZM3 10L2 10L2 11L3 11L3 10ZM3 9L3 8L2 8L2 9L3 9ZM5 9L5 10L6 10L6 9L5 9ZM5 4L5 3L4 3L4 4L5 4ZM9 4L10 4L10 3L9 3L9 4ZM9 9L8 9L8 10L9 10L9 9ZM11 9L11 10L12 10L12 9L11 9ZM11 7L11 6L10 6L10 7L11 7ZM15 7L16 7L16 6L15 6L15 7ZM15 9L14 9L14 10L15 10L15 9ZM17 9L18 9L18 8L17 8L17 9ZM17 10L17 11L18 11L18 10L17 10ZM15 10L15 9L14 9L14 10L15 10ZM15 12L15 13L16 13L16 12L15 12ZM11 12L10 12L10 13L11 13L11 12ZM9 11L11 11L11 9L9 9L9 11ZM10 15L10 10L8 10L8 15L10 15ZM5 16L9 16L9 14L5 14L5 16ZM4 10L4 15L6 15L6 10L4 10ZM3 11L5 11L5 9L3 9L3 11ZM2 9L2 10L4 10L4 9L2 9ZM5 8L3 8L3 10L5 10L5 8ZM4 4L4 9L6 9L6 4L4 4ZM9 3L5 3L5 5L9 5L9 3ZM10 9L10 4L8 4L8 9L10 9ZM11 8L9 8L9 10L11 10L11 8ZM12 9L12 7L10 7L10 9L12 9ZM11 8L15 8L15 6L11 6L11 8ZM14 7L14 9L16 9L16 7L14 7ZM17 8L15 8L15 10L17 10L17 8ZM18 10L18 9L16 9L16 10L18 10ZM15 11L17 11L17 9L15 9L15 11ZM14 10L14 12L16 12L16 10L14 10ZM15 11L11 11L11 13L15 13L15 11ZM12 12L12 10L10 10L10 12L12 12Z" fill="black" mask="url(#path-1-inside-1_840:306)"/>\n</svg>\n',align_right:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<mask id="path-1-inside-1_840:309" fill="white">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M16 17V3H15V17H16ZM14 5H4V9H14V5ZM9 11H14V15H9V11Z"/>\n</mask>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M16 17V3H15V17H16ZM14 5H4V9H14V5ZM9 11H14V15H9V11Z" fill="black"/>\n<path d="M16 3V2H17V3H16ZM16 17H17V18H16V17ZM15 3H14V2H15V3ZM15 17V18H14V17H15ZM4 5H3V4H4V5ZM14 5V4H15V5H14ZM4 9V10H3V9H4ZM14 9H15V10H14V9ZM14 11V10H15V11H14ZM9 11H8V10H9V11ZM14 15H15V16H14V15ZM9 15V16H8V15H9ZM17 3V17H15V3H17ZM15 2H16V4H15V2ZM14 17V3H16V17H14ZM16 18H15V16H16V18ZM4 4H14V6H4V4ZM3 9V5H5V9H3ZM14 10H4V8H14V10ZM15 5V9H13V5H15ZM14 12H9V10H14V12ZM13 15V11H15V15H13ZM9 14H14V16H9V14ZM10 11V15H8V11H10Z" fill="black" mask="url(#path-1-inside-1_840:309)"/>\n</svg>\n',align_top:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<mask id="path-1-inside-1_840:307" fill="white">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17 4L3 4L3 5L17 5L17 4ZM5 6L5 16L9 16L9 6L5 6ZM11 11L11 6L15 6L15 11L11 11Z"/>\n</mask>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17 4L3 4L3 5L17 5L17 4ZM5 6L5 16L9 16L9 6L5 6ZM11 11L11 6L15 6L15 11L11 11Z" fill="black"/>\n<path d="M3 4L2 4L2 3L3 3L3 4ZM17 4L17 3L18 3L18 4L17 4ZM3 5L3 6L2 6L2 5L3 5ZM17 5L18 5L18 6L17 6L17 5ZM5 16L5 17L4 17L4 16L5 16ZM5 6L4 6L4 5L5 5L5 6ZM9 16L10 16L10 17L9 17L9 16ZM9 6L9 5L10 5L10 6L9 6ZM11 6L10 6L10 5L11 5L11 6ZM11 11L11 12L10 12L10 11L11 11ZM15 6L15 5L16 5L16 6L15 6ZM15 11L16 11L16 12L15 12L15 11ZM3 3L17 3L17 5L3 5L3 3ZM2 5L2 4L4 4L4 5L2 5ZM17 6L3 6L3 4L17 4L17 6ZM18 4L18 5L16 5L16 4L18 4ZM4 16L4 6L6 6L6 16L4 16ZM9 17L5 17L5 15L9 15L9 17ZM10 6L10 16L8 16L8 6L10 6ZM5 5L9 5L9 7L5 7L5 5ZM12 6L12 11L10 11L10 6L12 6ZM15 7L11 7L11 5L15 5L15 7ZM14 11L14 6L16 6L16 11L14 11ZM11 10L15 10L15 12L11 12L11 10Z" fill="black" mask="url(#path-1-inside-1_840:307)"/>\n</svg>\n',all_guides:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7 3.5V3H6V3.5V6H3.5H3V7H3.5H6V13H3.5H3V14H3.5H6V16.5V17H7V16.5V14H9.20094L9.77237 13H7V7H13V8.08576C13.1582 8.0298 13.327 8 13.5 8C13.673 8 13.8418 8.0298 14 8.08576V7H16.5H17V6H16.5H14V3.5V3H13V3.5V6H7V3.5ZM13.9341 9.25193C13.8451 9.09614 13.6794 9 13.5 9C13.3206 9 13.1549 9.09614 13.0659 9.25193L9.06588 16.2519C8.97745 16.4067 8.97808 16.5968 9.06754 16.751C9.15701 16.9051 9.32176 17 9.5 17H17.5C17.6782 17 17.843 16.9051 17.9325 16.751C18.0219 16.5968 18.0226 16.4067 17.9341 16.2519L13.9341 9.25193ZM13.5 10.5078L16.6384 16H10.3616L13.5 10.5078Z" fill="black"/>\n</svg>\n',attach:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M17 14H14.707L17.3535 16.6465L16.6465 17.3535L14 14.707V17H13V13H17V14ZM10 7C11.6569 7 13 8.34315 13 10C13 11.6569 11.6569 13 10 13C8.34315 13 7 11.6569 7 10C7 8.34315 8.34315 7 10 7ZM3.39355 2.68652C3.39624 2.68921 3.39965 2.69164 3.40234 2.69434C3.40505 2.69704 3.40745 2.70042 3.41016 2.70312L3.41797 2.71094C3.42068 2.71365 3.42404 2.71604 3.42676 2.71875C3.42948 2.72147 3.43184 2.72481 3.43457 2.72754L3.45898 2.75195C3.46172 2.75469 3.46503 2.75702 3.46777 2.75977C3.47052 2.76251 3.47283 2.7658 3.47559 2.76855L3.52539 2.81836C3.52816 2.82112 3.53141 2.8234 3.53418 2.82617C3.53693 2.82893 3.53923 2.8322 3.54199 2.83496L3.56738 2.86035C3.57015 2.86312 3.5734 2.86539 3.57617 2.86816C3.57892 2.87092 3.58123 2.8742 3.58398 2.87695L3.59277 2.88574C3.59554 2.88851 3.59879 2.89079 3.60156 2.89355C3.60432 2.89631 3.60661 2.89958 3.60938 2.90234L3.7041 2.99707C3.70686 2.99983 3.71013 3.00212 3.71289 3.00488C3.71566 3.00765 3.71793 3.0109 3.7207 3.01367L3.81738 3.11035C3.82015 3.11312 3.8234 3.1154 3.82617 3.11816L3.83496 3.12695C3.83789 3.12989 3.84081 3.13378 3.84375 3.13672L3.94043 3.2334C3.9434 3.23637 3.94722 3.23921 3.9502 3.24219C3.95316 3.24516 3.95601 3.24898 3.95898 3.25195L4.1748 3.46777C4.17783 3.4708 4.18154 3.47353 4.18457 3.47656C4.1876 3.47959 4.19033 3.4833 4.19336 3.48633L4.25684 3.5498C4.25988 3.55285 4.26356 3.55555 4.2666 3.55859C4.26965 3.56164 4.27234 3.56531 4.27539 3.56836L4.33008 3.62305C4.33313 3.6261 4.33679 3.62878 4.33984 3.63184C4.34289 3.63488 4.34559 3.63856 4.34863 3.6416L4.46777 3.76074C4.47084 3.76381 4.47448 3.76647 4.47754 3.76953C4.48059 3.77259 4.48327 3.77624 4.48633 3.7793L4.62402 3.91699C4.62708 3.92005 4.63073 3.92272 4.63379 3.92578C4.63685 3.92884 4.63952 3.93248 4.64258 3.93555L4.71582 4.00879C4.71887 4.01184 4.72254 4.01453 4.72559 4.01758C4.72864 4.02063 4.73132 4.02429 4.73438 4.02734L4.98926 4.28223C4.99227 4.28524 4.99601 4.288 4.99902 4.29102C5.00203 4.29402 5.00481 4.29778 5.00781 4.30078L5.07031 4.36328C5.07331 4.36627 5.07709 4.36908 5.08008 4.37207C5.08306 4.37505 5.08589 4.37886 5.08887 4.38184L5.23926 4.53223C5.2422 4.53516 5.24609 4.53808 5.24902 4.54102L5.27539 4.56738C5.27816 4.57015 5.28044 4.57341 5.2832 4.57617L5.37109 4.66406C5.37386 4.66682 5.37712 4.66912 5.37988 4.67188C5.38265 4.67464 5.38493 4.6779 5.3877 4.68066L5.64062 4.93359C5.64335 4.93632 5.6467 4.93869 5.64941 4.94141C5.65214 4.94414 5.6545 4.94747 5.65723 4.9502L5.72168 5.01465C5.72435 5.01732 5.72781 5.0198 5.73047 5.02246C5.73314 5.02513 5.73561 5.02858 5.73828 5.03125L5.76953 5.0625C5.77217 5.06514 5.77568 5.06767 5.77832 5.07031C5.78095 5.07294 5.78351 5.07648 5.78613 5.0791L6 5.29297V3H7V7H3V6H5.29297L5.0791 5.78613C5.07648 5.78351 5.07294 5.78095 5.07031 5.77832C5.06767 5.77568 5.06514 5.77217 5.0625 5.76953L5.03125 5.73828C5.02858 5.73561 5.02513 5.73314 5.02246 5.73047C5.0198 5.72781 5.01732 5.72435 5.01465 5.72168L4.9502 5.65723C4.94747 5.6545 4.94414 5.65214 4.94141 5.64941C4.93869 5.6467 4.93632 5.64335 4.93359 5.64062L4.68066 5.3877C4.6779 5.38493 4.67464 5.38265 4.67188 5.37988C4.66912 5.37712 4.66682 5.37386 4.66406 5.37109L4.57617 5.2832C4.57341 5.28044 4.57015 5.27816 4.56738 5.27539L4.54102 5.24902C4.53808 5.24609 4.53516 5.2422 4.53223 5.23926L4.38184 5.08887C4.37886 5.08589 4.37505 5.08306 4.37207 5.08008C4.36908 5.07709 4.36627 5.07331 4.36328 5.07031L4.30078 5.00781C4.29778 5.00481 4.29402 5.00203 4.29102 4.99902C4.288 4.99601 4.28524 4.99227 4.28223 4.98926L4.02734 4.73438C4.02429 4.73132 4.02063 4.72864 4.01758 4.72559C4.01453 4.72254 4.01184 4.71887 4.00879 4.71582L3.93555 4.64258C3.93248 4.63952 3.92884 4.63685 3.92578 4.63379C3.92272 4.63073 3.92005 4.62708 3.91699 4.62402L3.7793 4.48633C3.77624 4.48327 3.77259 4.48059 3.76953 4.47754C3.76647 4.47448 3.76381 4.47084 3.76074 4.46777L3.6416 4.34863C3.63856 4.34559 3.63488 4.34289 3.63184 4.33984C3.62878 4.33679 3.6261 4.33313 3.62305 4.33008L3.56836 4.27539C3.56531 4.27234 3.56164 4.26965 3.55859 4.2666C3.55555 4.26356 3.55285 4.25988 3.5498 4.25684L3.48633 4.19336C3.4833 4.19033 3.47959 4.1876 3.47656 4.18457C3.47353 4.18154 3.4708 4.17783 3.46777 4.1748L3.25195 3.95898C3.24898 3.95601 3.24516 3.95316 3.24219 3.9502C3.23921 3.94722 3.23637 3.9434 3.2334 3.94043L3.13672 3.84375C3.13378 3.84081 3.12989 3.83789 3.12695 3.83496L3.11816 3.82617C3.1154 3.8234 3.11312 3.82015 3.11035 3.81738L3.01367 3.7207C3.0109 3.71793 3.00765 3.71566 3.00488 3.71289C3.00212 3.71013 2.99983 3.70686 2.99707 3.7041L2.90234 3.60938C2.89958 3.60661 2.89631 3.60432 2.89355 3.60156C2.89079 3.59879 2.88851 3.59554 2.88574 3.59277L2.87695 3.58398C2.8742 3.58123 2.87092 3.57892 2.86816 3.57617C2.86539 3.5734 2.86312 3.57015 2.86035 3.56738L2.83496 3.54199C2.8322 3.53923 2.82893 3.53693 2.82617 3.53418C2.8234 3.53141 2.82112 3.52816 2.81836 3.52539L2.76855 3.47559C2.7658 3.47283 2.76251 3.47052 2.75977 3.46777C2.75702 3.46503 2.75469 3.46172 2.75195 3.45898L2.72754 3.43457C2.72481 3.43184 2.72147 3.42948 2.71875 3.42676C2.71604 3.42404 2.71365 3.42068 2.71094 3.41797L2.70312 3.41016C2.70042 3.40745 2.69704 3.40505 2.69434 3.40234C2.69164 3.39965 2.68921 3.39624 2.68652 3.39355L2.64648 3.35352L3.35352 2.64648L3.39355 2.68652Z" fill="black"/>\n</svg>\n',beta:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.26562 7.41562L5 18.0094H6.65625L7.59375 13.6266H7.63281C7.97656 14.7125 9.07812 15.4234 10.375 15.4234C12.9297 15.4234 14.2734 13.6734 14.2734 11.7437C14.2734 10.4781 13.6953 9.57187 12.3125 9.20468V9.17343C13.6484 8.73593 14.2812 7.73593 14.2812 6.47812C14.2812 4.89218 13.0234 3.85312 11.1406 3.85312C8.96094 3.85312 7.76562 4.99374 7.26562 7.41562ZM9.57031 9.97812H10.4219C11.8203 9.97812 12.6094 10.65 12.6094 11.8062C12.6094 13.0406 11.5156 13.9312 10.2969 13.9312C8.96875 13.9312 7.98438 13.1578 7.98438 11.9781C7.98438 11.8297 8.02344 11.5172 8.10156 11.1734L8.92188 7.39218C9.23438 5.93906 10.0547 5.31406 11.0156 5.31406C12.0938 5.31406 12.6953 5.88437 12.6953 6.71249C12.6953 7.83749 11.8672 8.55624 10.5938 8.55624H9.85938L9.57031 9.97812Z" fill="black"/>\n</svg>\n',boolean_difference:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7 13V18H18V7H13V13H7Z" fill="black"/>\n<rect x="2" y="2" width="10" height="10" fill="black" fill-opacity="0.5"/>\n</svg>\n',boolean_intersection:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="7" y="7" width="6" height="6" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2 2H13V6H6V13H2V2ZM7 14V18H18V7H14V14H7Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',boolean_union:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13 2H2V13H7V18H18V7H13V2Z" fill="black"/>\n</svg>\n',builtin_shape_autolayout:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="27pt" height="25.742307pt" viewBox="0 0 27 25.742307">\n<title>Creation Panel - Auto Layout - Auto Layout Thumb</title>\n<g>\n<g>\n<path d="M13.170732 6.585366 C13.170732 10.219928 10.219928 13.170732 6.585366 13.170732 C2.950803 13.170732 0 10.219928 0 6.585366 C0 2.950803 2.950803 0 6.585366 0 C10.219928 0 13.170732 2.950803 13.170732 6.585366 Z " fill="#808080" />\n<path d="M13.829268 0 L27 0 L27 13.170732 L13.829268 13.170732 L13.829268 0 Z " fill="#808080" />\n</g>\n<g>\n<path d="M6.263055 13.829268 L12.52611 18.379644 L10.133836 25.742307 L2.392274 25.742307 L0 18.379644 L6.263055 13.829268 Z " fill="#808080" />\n<path d="M19.447702 13.829268 L21.383092 17.750798 L25.710757 18.379644 L22.579229 21.432129 L23.318483 25.742307 L19.447702 23.707317 L15.576921 25.742307 L16.316174 21.432129 L13.184647 18.379644 L17.512311 17.750798 L19.447702 13.829268 Z " fill="#808080" />\n</g>\n</g>\n</svg>\n\x3c!--\nGenerator: Cuttle.xyz\n--\x3e\n',builtin_shape_emoji:'<svg width="36" height="24" viewBox="0 0 36 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M18.1143 24C16.3771 24 14.7714 23.701 13.2971 23.1029C11.8229 22.5048 10.541 21.6648 9.45143 20.5829C8.3619 19.501 7.51429 18.2305 6.90857 16.7714C6.30286 15.3124 6 13.7219 6 12C6 10.2781 6.30286 8.68762 6.90857 7.22857C7.51429 5.76952 8.3619 4.49905 9.45143 3.41714C10.541 2.33524 11.8229 1.49524 13.2971 0.897143C14.7714 0.299048 16.3771 0 18.1143 0C19.8514 0 21.4571 0.299048 22.9314 0.897143C24.4057 1.49524 25.6876 2.33524 26.7771 3.41714C27.8667 4.49905 28.7143 5.76952 29.32 7.22857C29.9257 8.68762 30.2286 10.2781 30.2286 12C30.2286 13.7219 29.9257 15.3124 29.32 16.7714C28.7143 18.2305 27.8667 19.501 26.7771 20.5829C25.6876 21.6648 24.4057 22.5048 22.9314 23.1029C21.4571 23.701 19.8514 24 18.1143 24ZM18.1143 18.0914C16.301 18.0914 14.5371 17.52 12.8229 16.3771L13.5314 15.3371C15.0095 16.3352 16.5371 16.8343 18.1143 16.8343C19.6914 16.8343 21.219 16.3352 22.6971 15.3371L23.4057 16.3771C21.6914 17.52 19.9276 18.0914 18.1143 18.0914ZM13.9771 11.2571C13.5429 11.2571 13.1714 11.0857 12.8629 10.7429C12.5543 10.4 12.4 9.94286 12.4 9.37143C12.4 8.8 12.5543 8.34286 12.8629 8C13.1714 7.65714 13.5429 7.48571 13.9771 7.48571C14.4114 7.48571 14.7829 7.65714 15.0914 8C15.4 8.34286 15.5543 8.8 15.5543 9.37143C15.5543 9.94286 15.4 10.4 15.0914 10.7429C14.7829 11.0857 14.4114 11.2571 13.9771 11.2571ZM18.1257 22.7429C19.6648 22.7429 21.0876 22.4743 22.3943 21.9371C23.701 21.4 24.8362 20.6495 25.8 19.6857C26.7638 18.7219 27.5143 17.5848 28.0514 16.2743C28.5886 14.9638 28.8571 13.5352 28.8571 11.9886C28.8571 10.4495 28.5886 9.02667 28.0514 7.72C27.5143 6.41333 26.7638 5.2781 25.8 4.31429C24.8362 3.35048 23.701 2.6 22.3943 2.06286C21.0876 1.52571 19.6648 1.25714 18.1257 1.25714C16.579 1.25714 15.1524 1.52571 13.8457 2.06286C12.539 2.6 11.4019 3.35048 10.4343 4.31429C9.46667 5.2781 8.71429 6.41333 8.17714 7.72C7.64 9.02667 7.37143 10.4495 7.37143 11.9886C7.37143 13.5352 7.64 14.9638 8.17714 16.2743C8.71429 17.5848 9.46476 18.7219 10.4286 19.6857C11.3924 20.6495 12.5295 21.4 13.84 21.9371C15.1505 22.4743 16.579 22.7429 18.1257 22.7429ZM22.2514 11.2571C21.8171 11.2571 21.4457 11.0857 21.1371 10.7429C20.8286 10.4 20.6743 9.94286 20.6743 9.37143C20.6743 8.8 20.8286 8.34286 21.1371 8C21.4457 7.65714 21.8171 7.48571 22.2514 7.48571C22.6857 7.48571 23.0571 7.65714 23.3657 8C23.6743 8.34286 23.8286 8.8 23.8286 9.37143C23.8286 9.94286 23.6743 10.4 23.3657 10.7429C23.0571 11.0857 22.6857 11.2571 22.2514 11.2571Z" fill="black"/>\n</svg>\n',builtin_shape_switcher:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="71.999991pt" height="72pt" viewBox="0 0 71.999991 72">\n<title>Creation Panel - Switcher (moved to built-ins) - Switcher Thumbnail</title>\n<path d="M55.79999 72 C64.741015 72 71.999991 64.741007 71.999991 55.79999 C71.999983 46.858973 64.741024 39.599979 55.79999 39.599979 C46.858973 39.599997 39.599988 46.858973 39.599997 55.79999 C39.599988 64.741007 46.858973 72 55.79999 72 Z M55.855617 27.950901 C55.582452 27.278149 55.274071 26.618019 54.930473 25.970512 C53.926735 24.078953 52.665896 22.375774 51.147958 20.860977 C49.630013 19.34618 47.92422 18.088881 46.030578 17.089079 C44.095754 16.067522 42.049104 15.359922 39.890628 14.96628 C39.010445 14.805755 38.166791 15.389156 38.006275 16.269344 C37.845759 17.149532 38.429165 17.99319 39.309348 18.153706 C41.140792 18.487713 42.876952 19.087893 44.517829 19.954245 C46.124173 20.802366 47.571333 21.869076 48.859308 23.154373 C50.147278 24.439682 51.216997 25.88463 52.068466 27.489218 C52.388924 28.093122 52.673266 28.710028 52.921494 29.339933 L48.878097 27.351425 C48.075228 26.956587 47.104294 27.287365 46.709455 28.090239 C46.314617 28.893103 46.645387 29.864033 47.448252 30.258871 L54.757988 33.853718 C55.066008 34.005193 55.414183 34.054916 55.752294 33.995716 L55.766876 33.99309 C56.270543 33.900161 56.700599 33.574515 56.926629 33.114904 L60.521467 25.805185 C60.91631 25.002312 60.58554 24.031374 59.782671 23.636536 C58.979807 23.241697 58.008877 23.572468 57.614038 24.375332 L55.855617 27.950901 Z M21.206068 10.143419 L16.199993 0 L11.193918 10.143411 L0 11.769979 L8.099997 19.665527 L6.187843 30.81423 L16.199993 25.550508 L26.212152 30.814213 L24.29999 19.665527 L32.399986 11.769988 L21.206068 10.143419 Z M25.969397 54.910921 C27.904203 55.932467 29.95085 56.640066 32.109338 57.03372 C32.989526 57.194236 33.833179 56.610834 33.99369 55.730656 C34.154216 54.850468 33.570814 54.00681 32.690626 53.846294 C30.859177 53.512287 29.123022 52.912107 27.482162 52.045755 C25.875813 51.197634 24.42865 50.130919 23.140675 48.84561 C21.852699 47.560312 20.78298 46.115364 19.931517 44.510765 C19.611094 43.906918 19.326751 43.290012 19.078488 42.660049 L23.121886 44.648558 C23.924746 45.043396 24.895672 44.712626 25.29051 43.909761 C25.685358 43.106897 25.354599 42.135967 24.55174 41.741129 L17.241995 38.146265 C17.218458 38.134708 17.194647 38.123713 17.170584 38.113289 C16.875571 37.985593 16.549236 37.94855 16.233107 38.006876 C16.155625 38.021173 16.079279 38.041111 16.004677 38.066528 C15.98571 38.072994 15.966861 38.079804 15.94814 38.086956 C15.566295 38.233069 15.253811 38.518174 15.073371 38.885078 L15.072641 38.886538 L11.478516 46.194815 C11.083677 46.997669 11.414448 47.968599 12.217312 48.363447 C13.020171 48.758286 13.991097 48.427523 14.385936 47.624668 L16.144358 44.049065 C16.417528 44.721828 16.725912 45.381964 17.06951 46.02947 C18.073236 47.92103 19.334075 49.624208 20.852025 51.139006 C22.369992 52.653814 24.075783 53.911119 25.969397 54.910921 Z " fill="#808080" fill-rule="evenodd" stroke="none" />\n</svg>\n\x3c!--\nGenerator: Cuttle.xyz\n--\x3e',check:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M15.7071 6.29289C16.0976 6.68342 16.0976 7.31658 15.7071 7.70711L9.20712 14.2071C8.8166 14.5976 8.18344 14.5976 7.79291 14.2071L4.2929 10.7071C3.90237 10.3166 3.90237 9.68342 4.29289 9.2929C4.68341 8.90237 5.31658 8.90237 5.7071 9.29289L8.50001 12.0858L14.2929 6.29289C14.6834 5.90237 15.3166 5.90237 15.7071 6.29289Z" fill="black"/>\n</svg>\n',check_bullet:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18ZM14.7071 8.70711C15.0976 8.31658 15.0976 7.68342 14.7071 7.29289C14.3166 6.90237 13.6834 6.90237 13.2929 7.29289L9.00001 11.5858L7.2071 9.7929C6.81658 9.40238 6.18341 9.40239 5.79289 9.79291C5.40237 10.1834 5.40237 10.8166 5.7929 11.2071L8.29291 13.7071C8.68344 14.0976 9.3166 14.0976 9.70712 13.7071L14.7071 8.70711Z" fill="black"/>\n</svg>\n',checkbox_checked:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3 5C3 3.89543 3.89543 3 5 3H15C16.1046 3 17 3.89543 17 5V15C17 16.1046 16.1046 17 15 17H5C3.89543 17 3 16.1046 3 15V5Z" fill="#19AAF3"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M15.4041 6.33152L14.7863 7.11783L9.28632 14.1178L8.58993 15.0042L7.79289 14.2071L5.29289 11.7071L4.58579 11L6 9.5858L6.70711 10.2929L8.41007 11.9959L13.2137 5.88219L13.8315 5.09587L15.4041 6.33152Z" fill="white"/>\n</svg>\n',checkbox_mixed:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3 5C3 3.89543 3.89543 3 5 3H15C16.1046 3 17 3.89543 17 5V15C17 16.1046 16.1046 17 15 17H5C3.89543 17 3 16.1046 3 15V5Z" fill="black" fill-opacity="0.5"/>\n<rect x="6" y="9" width="8" height="2" fill="white"/>\n</svg>\n',checkbox_unchecked:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="3" y="3" width="14" height="14" rx="2" fill="#808080"/>\n<rect x="4" y="4" width="12" height="12" rx="1" fill="white"/>\n</svg>\n',chevron_down:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M6.29286 8.29289C6.68339 7.90237 7.31655 7.90237 7.70708 8.29289L9.99997 10.5858L12.2929 8.29289C12.6834 7.90237 13.3166 7.90237 13.7071 8.2929C14.0976 8.68342 14.0976 9.31659 13.7071 9.70711L10.7071 12.7071C10.3165 13.0976 9.68339 13.0976 9.29286 12.7071L6.29286 9.70711C5.90234 9.31658 5.90234 8.68342 6.29286 8.29289Z" fill="black"/>\n</svg>\n',chevron_left:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7071 4.29289C13.0976 4.68341 13.0976 5.31658 12.7071 5.7071L8.41421 9.99996L12.7071 14.2929C13.0976 14.6834 13.0976 15.3166 12.7071 15.7071C12.3166 16.0976 11.6834 16.0976 11.2929 15.7071L6.29289 10.7071C5.90237 10.3165 5.90237 9.68337 6.2929 9.29285L11.2929 4.29288C11.6834 3.90236 12.3166 3.90236 12.7071 4.29289Z" fill="black"/>\n</svg>\n',chevron_right:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.29289 15.7071C6.90237 15.3166 6.90237 14.6834 7.29289 14.2929L11.5858 10L7.29289 5.70711C6.90237 5.31658 6.90237 4.68342 7.29289 4.29289C7.68342 3.90237 8.31658 3.90237 8.70711 4.29289L13.7071 9.29289C14.0976 9.68342 14.0976 10.3166 13.7071 10.7071L8.70711 15.7071C8.31658 16.0976 7.68342 16.0976 7.29289 15.7071Z" fill="black"/>\n</svg>\n',circle:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17ZM10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" fill="black"/>\n</svg>\n',clock:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10ZM10 4.00001C10.5523 4.00001 11 4.44773 11 5.00001V9.38197L13.4472 10.6056C13.9412 10.8526 14.1414 11.4532 13.8944 11.9472C13.6474 12.4412 13.0468 12.6414 12.5528 12.3944L9.55278 10.8944C9.214 10.725 9 10.3788 9 10V5.00001C9 4.44773 9.44772 4.00001 10 4.00001Z" fill="black"/>\n</svg>\n',code_component_badge:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="8" cy="8" r="6.5" fill="white" stroke="#CCCCCC"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8.99883 4.37194C9.41063 4.12506 9.90896 4 10.5 4C10.7761 4 11 4.22386 11 4.5C11 4.77614 10.7761 5 10.5 5C10.052 5 9.73976 5.09369 9.51301 5.22962C9.28675 5.36527 9.11093 5.56375 8.96871 5.82961C8.79541 6.15355 8.6844 6.54958 8.59868 7H9.5C9.77614 7 10 7.22386 10 7.5C10 7.77614 9.77614 8 9.5 8H8.44575C8.44287 8.02169 8.44 8.04345 8.43713 8.06528C8.43306 8.09613 8.42899 8.12714 8.4249 8.15831C8.31689 8.98147 8.195 9.91035 7.83056 10.6317C7.63401 11.0208 7.35756 11.372 6.95882 11.6226C6.55957 11.8734 6.07477 12 5.5 12C5.22386 12 5 11.7761 5 11.5C5 11.2239 5.22386 11 5.5 11C5.92523 11 6.2168 10.9078 6.4268 10.7759C6.63732 10.6436 6.803 10.448 6.938 10.1808C7.21597 9.63058 7.32146 8.8766 7.43708 8H6.5C6.22386 8 6 7.77614 6 7.5C6 7.22386 6.22386 7 6.5 7H7.58184C7.68207 6.42219 7.82703 5.84376 8.08696 5.35789C8.29581 4.9675 8.58654 4.61911 8.99883 4.37194Z" fill="black"/>\n</svg>\n',contract:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 14C12.2091 14 14 12.2091 14 10C14 7.79086 12.2091 6 10 6C7.79086 6 6 7.79086 6 10C6 12.2091 7.79086 14 10 14ZM10 15C12.7614 15 15 12.7614 15 10C15 7.23858 12.7614 5 10 5C7.23858 5 5 7.23858 5 10C5 12.7614 7.23858 15 10 15Z" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17ZM10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',copy_link:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M11.2071 5.20708C11.7964 4.61776 12.4259 4.37497 13 4.37497C13.5741 4.37497 14.2036 4.61777 14.7929 5.20709C15.3822 5.79642 15.625 6.4259 15.625 6.99997C15.625 7.57403 15.3822 8.20352 14.7929 8.79285L14.7929 8.79285L12.7929 10.7929L14.2071 12.2071L16.2071 10.2071C17.1178 9.29637 17.625 8.17588 17.625 6.99997C17.625 5.82406 17.1178 4.70357 16.2071 3.79288C15.2964 2.88218 14.1759 2.37497 13 2.37497C11.8241 2.37497 10.7036 2.88218 9.79289 3.79287L9.79289 3.79287L7.79289 5.79291L9.20711 7.20711L11.2071 5.20708ZM5.20711 11.2071L7.2071 9.20712L5.7929 7.7929L3.7929 9.79287L3.79289 9.79287C2.88221 10.7036 2.375 11.8241 2.375 13C2.375 14.1759 2.8822 15.2964 3.79289 16.2071C4.70358 17.1178 5.82408 17.625 7 17.625C8.17591 17.625 9.29641 17.1178 10.2071 16.2071L12.2071 14.2071L10.7929 12.7929L8.79289 14.7929L9.49999 15.5L8.79289 14.7929C8.20358 15.3822 7.57408 15.625 6.99999 15.625C6.42591 15.625 5.79641 15.3822 5.2071 14.7929C4.61779 14.2036 4.375 13.5741 4.375 13C4.375 12.4259 4.6178 11.7964 5.2071 11.2071L5.20711 11.2071ZM7.29289 11.2929L6.58578 12L8 13.4142L8.7071 12.7071L12.7071 8.70711L13.4142 8L12 6.58579L11.2929 7.29289L7.29289 11.2929Z" fill="black"/>\n</svg>\n',cuttle_logo:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M14.8624 7.35746L8.96098 8.93627C8.58099 9.03827 8.1806 9.0367 7.80143 8.9317C7.42226 8.8267 7.07817 8.62211 6.80494 8.33922C6.76609 8.29859 6.71684 8.26937 6.66254 8.25472C6.60825 8.24007 6.55097 8.24055 6.49694 8.25612L3.38608 9.09323C2.9768 9.20242 2.59314 9.39134 2.25714 9.64914C1.92115 9.90694 1.63945 10.2285 1.42823 10.5955C1.21701 10.9624 1.08042 11.3674 1.02633 11.7872C0.97223 12.207 1.00169 12.6334 1.113 13.0418C1.1335 13.1206 1.18445 13.1881 1.25468 13.2295C1.28976 13.2498 1.32849 13.2629 1.36866 13.2682C1.40883 13.2735 1.44964 13.2708 1.48877 13.2603L12.577 10.2904C12.5437 10.8313 12.6497 11.3717 12.885 11.86C13.1521 12.4006 13.5656 12.8556 14.0784 13.1732C14.5913 13.4909 15.183 13.6586 15.7864 13.6573C15.9451 13.6566 16.1035 13.6453 16.2607 13.6234C16.7238 13.5538 17.1661 13.3839 17.5568 13.1258C17.9474 12.8676 18.277 12.5274 18.5225 12.1289C18.7679 11.7303 18.9234 11.2831 18.978 10.8183C19.0327 10.3535 18.9851 9.88244 18.8387 9.43792C18.5665 8.64981 18.0032 7.99544 17.264 7.60869C16.5248 7.22195 15.6657 7.13208 14.8624 7.35746ZM16.2114 11.9923C15.9031 12.0745 15.5773 12.0636 15.2752 11.9608C14.9731 11.8581 14.7082 11.6681 14.5141 11.415C14.32 11.1619 14.2054 10.857 14.1847 10.5388C14.164 10.2206 14.2382 9.9034 14.3979 9.62731C14.5575 9.35122 14.7955 9.12863 15.0818 8.98767C15.368 8.84671 15.6897 8.7937 16.0061 8.83536C16.3225 8.87701 16.6194 9.01145 16.8593 9.22169C17.0993 9.43192 17.2715 9.70851 17.3541 10.0165C17.4085 10.2218 17.4218 10.4358 17.3933 10.6463C17.3648 10.8567 17.2951 11.0595 17.1881 11.243C17.0811 11.4265 16.939 11.5872 16.7698 11.7157C16.6006 11.8443 16.4077 11.9383 16.2022 11.9923H16.2114Z" fill="black"/>\n<path d="M12.0102 7.48057L12.6262 5.14467C12.8557 4.3439 12.7706 3.48578 12.3882 2.74562C12.0058 2.00546 11.355 1.43911 10.5688 1.16227C10.1204 1.01422 9.64494 0.966657 9.17611 1.02296C8.70729 1.07925 8.25662 1.23803 7.85615 1.48801C7.45567 1.73799 7.1152 2.07303 6.85894 2.46932C6.60268 2.86562 6.43692 3.31345 6.37342 3.78098C6.30993 4.24852 6.35027 4.72429 6.49158 5.17449C6.63288 5.62469 6.87168 6.03827 7.19101 6.38585C7.51034 6.73342 7.90236 7.00645 8.33922 7.18555C8.77608 7.36464 9.24705 7.44541 9.71867 7.42209L9.52155 8.14841L12.0102 7.48057ZM9.13962 5.7725C8.83169 5.68939 8.55532 5.51696 8.34539 5.27701C8.13547 5.03705 8.00141 4.74032 7.96014 4.42429C7.91887 4.10826 7.97225 3.78709 8.11353 3.50135C8.25481 3.21561 8.47766 2.9781 8.75393 2.81882C9.03021 2.65954 9.34753 2.58563 9.66581 2.60642C9.9841 2.62722 10.2891 2.74178 10.5423 2.93564C10.7954 3.12951 10.9854 3.39399 11.0883 3.69568C11.1911 3.99737 11.2022 4.32274 11.1201 4.63072C11.0089 5.04451 10.7379 5.39725 10.3665 5.61137C9.99508 5.82548 9.55378 5.88344 9.13962 5.7725Z" fill="black"/>\n<path d="M8.48666 12.0077L6.74642 18.4984C6.73383 18.5384 6.72954 18.5805 6.73383 18.6222C6.73812 18.6639 6.7509 18.7043 6.77138 18.7409C6.79186 18.7775 6.8196 18.8096 6.85292 18.8351C6.88623 18.8606 6.92441 18.879 6.96511 18.8892C7.23834 18.9625 7.51998 18.9997 7.80288 19C8.50981 18.998 9.19644 18.7637 9.75694 18.3332C10.3174 17.9027 10.7207 17.3 10.9045 16.6179L11.7392 13.5003C11.7548 13.4463 11.7553 13.3891 11.7406 13.3349C11.7259 13.2806 11.6967 13.2314 11.656 13.1926C11.4123 12.9556 11.2264 12.6659 11.1126 12.3457C10.9989 12.0255 10.9603 11.6835 11 11.346L8.48666 12.0077Z" fill="black"/>\n</svg>\n',dashed_lines:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17.7293 12.0713L16.7632 11.8131C16.9175 11.2359 17 10.6284 17 10C17 9.37164 16.9175 8.7641 16.7632 8.18693L17.7293 7.92869C17.9059 8.58934 18 9.28368 18 10C18 10.7163 17.9059 11.4107 17.7293 12.0713ZM16.9294 5.99936L16.0638 6.50017C15.449 5.43754 14.5625 4.55101 13.4998 3.93619L14.0006 3.07063C15.2147 3.77305 16.227 4.78535 16.9294 5.99936ZM12.0713 2.27074L11.8131 3.23682C11.2359 3.08254 10.6284 3 10 3C9.37164 3 8.7641 3.08254 8.18693 3.23682L7.92869 2.27074C8.58934 2.09415 9.28368 2 10 2C10.7163 2 11.4107 2.09415 12.0713 2.27074ZM5.99936 3.07063L6.50017 3.93619C5.43754 4.55101 4.55101 5.43754 3.93619 6.50017L3.07063 5.99936C3.77305 4.78535 4.78535 3.77305 5.99936 3.07063ZM2.27074 7.9287C2.09415 8.58934 2 9.28368 2 10C2 10.7163 2.09415 11.4107 2.27074 12.0713L3.23682 11.8131C3.08254 11.2359 3 10.6284 3 10C3 9.37164 3.08254 8.7641 3.23682 8.18693L2.27074 7.9287ZM3.07063 14.0006L3.93619 13.4998C4.55101 14.5625 5.43754 15.449 6.50017 16.0638L5.99936 16.9294C4.78535 16.227 3.77305 15.2147 3.07063 14.0006ZM7.9287 17.7293L8.18693 16.7632C8.7641 16.9175 9.37164 17 10 17C10.6284 17 11.2359 16.9175 11.8131 16.7632L12.0713 17.7293C11.4107 17.9059 10.7163 18 10 18C9.28368 18 8.58934 17.9059 7.9287 17.7293ZM14.0006 16.9294L13.4998 16.0638C14.5625 15.449 15.449 14.5625 16.0638 13.4998L16.9294 14.0006C16.227 15.2147 15.2147 16.227 14.0006 16.9294Z" fill="black"/>\n</svg>\n',depth:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M16.6181 13.4999L9.72357 16.9472L9.49994 17.0585L9.27631 16.9472L2.38177 13.4999L7.99994 10.6904V11.8085L4.6181 13.4999L9.49994 15.9404L14.3818 13.4999L10.9999 11.8085V10.6904L16.6181 13.4999ZM12.207 6.49994L11.4999 7.20697L9.99994 5.70697V13.9999H8.99994V5.70697L7.49994 7.20697L6.79291 6.49994L9.49994 3.79291L12.207 6.49994Z" fill="black"/>\n</svg>\n',doc:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.69134 1.03807C7.87818 1.11547 8 1.29778 8 1.50001V4.50001V6.50001C8 6.77616 7.77614 7.00001 7.5 7.00001C7.22386 7.00001 7 6.77616 7 6.50001V5.00001H4.70711L2.85355 6.85357C2.65829 7.04883 2.34171 7.04883 2.14645 6.85357C1.95118 6.65831 1.95118 6.34172 2.14645 6.14646L4.14627 4.14664C4.14639 4.14652 4.14651 4.1464 4.14663 4.14628L7.14645 1.14646C7.28945 1.00346 7.5045 0.960684 7.69134 1.03807ZM5.70711 4.00001H7V2.70712L5.70711 4.00001ZM10 3H10.5H17.5H18V4H17.5H10.5H10V3ZM10 6H10.5H17.5H18V7H17.5H10.5H10V6ZM2 9.00002H2.5H17.5H18V10H17.5H2.5H2V9.00002ZM2 12H2.5H17.5H18V13H17.5H2.5H2V12ZM2 15H2.5H17.5H18V16H17.5H2.5H2V15ZM2 18H2.5H14.5H15V19H14.5H2.5H2V18Z" fill="black"/>\n</svg>\n',dotdotdot:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="16" cy="10" r="2" fill="black"/>\n<circle cx="10" cy="10" r="2" fill="black"/>\n<circle cx="4" cy="10" r="2" fill="black"/>\n</svg>\n',download:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M5 14C5 13.4477 4.55228 13 4 13C3.44771 13 3 13.4477 3 14C3 15.4113 4.11805 16.4197 5.31015 17.0157C6.56205 17.6417 8.22156 18 10 18C11.7784 18 13.4379 17.6417 14.6899 17.0157C15.8819 16.4197 17 15.4113 17 14C17 13.4477 16.5523 13 16 13C15.4477 13 15 13.4477 15 14C15 14.2456 14.7749 14.7372 13.7954 15.2269C12.8758 15.6867 11.5353 16 10 16C8.46473 16 7.12424 15.6867 6.20457 15.2269C5.22509 14.7372 5 14.2456 5 14ZM11 3C11 2.44771 10.5523 2 10 2C9.44771 2 9 2.44771 9 3L9 10.5858L7.2071 8.79289C6.81658 8.40237 6.18342 8.40237 5.79289 8.79289C5.40237 9.18342 5.40237 9.81658 5.79289 10.2071L9.29289 13.7071C9.68342 14.0976 10.3166 14.0976 10.7071 13.7071L14.2071 10.2071C14.5976 9.81658 14.5976 9.18342 14.2071 8.79289C13.8166 8.40237 13.1834 8.40237 12.7929 8.79289L11 10.5858L11 3Z" fill="black"/>\n</svg>\n',download_badge:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="8.5" cy="8.5" r="6" fill="white" stroke="#CCCCCC"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8.50001 5C8.77616 5 9.00001 5.22386 9.00001 5.5L9.00001 10.2929L10.1465 9.14645C10.3417 8.95118 10.6583 8.95118 10.8536 9.14645C11.0488 9.34171 11.0488 9.65829 10.8536 9.85355L8.85357 11.8536C8.65831 12.0488 8.34172 12.0488 8.14646 11.8536L6.14646 9.85355C5.9512 9.65829 5.9512 9.34171 6.14646 9.14645C6.34172 8.95118 6.65831 8.95118 6.85357 9.14645L8.00001 10.2929L8.00001 5.5C8.00001 5.22386 8.22387 5 8.50001 5Z" fill="black"/>\n</svg>\n',drag_handle:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M5 5C5 4.44772 5.44772 4 6 4H14C14.5523 4 15 4.44772 15 5C15 5.55228 14.5523 6 14 6H6C5.44772 6 5 5.55228 5 5ZM5 10C5 9.44772 5.44772 9 6 9H14C14.5523 9 15 9.44772 15 10C15 10.5523 14.5523 11 14 11H6C5.44772 11 5 10.5523 5 10ZM6 14C5.44772 14 5 14.4477 5 15C5 15.5523 5.44772 16 6 16H14C14.5523 16 15 15.5523 15 15C15 14.4477 14.5523 14 14 14H6Z" fill="black"/>\n</svg>\n',edit:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.8132 4.01525C14.3641 3.56615 13.6359 3.56615 13.1868 4.01525L12.543 4.6591L15.3409 7.45701L15.9847 6.81317C16.4338 6.36407 16.4338 5.63593 15.9847 5.18682L14.8132 4.01525ZM5.32168 11.8804L11.6591 5.54298L14.457 8.3409L8.11961 14.6783C7.86091 14.1868 7.47962 13.5957 6.94193 13.0581C6.40424 12.5204 5.81314 12.1391 5.32168 11.8804ZM4.5502 12.891C4.32335 13.5082 3.98372 14.6436 3.8807 16.1193C5.3564 16.0163 6.49182 15.6766 7.10902 15.4498C7.10731 15.4463 7.1056 15.4427 7.10388 15.4392C6.88729 14.9935 6.54887 14.4327 6.05806 13.9419C5.56724 13.4511 5.00651 13.1127 4.5608 12.8961C4.55726 12.8944 4.55373 12.8927 4.5502 12.891ZM11.9847 2.81317C13.0977 1.70018 14.9023 1.70017 16.0152 2.81317L17.1868 3.98474C18.2998 5.09774 18.2998 6.90226 17.1868 8.01525L8.71578 16.4863C8.57637 16.6257 8.40316 16.7545 8.19395 16.8461C7.61348 17.1004 5.67821 17.85 2.99999 17.85C2.53055 17.85 2.14999 17.4694 2.14999 17C2.14999 14.3218 2.8996 12.3865 3.15386 11.806C3.24551 11.5968 3.37429 11.4236 3.5137 11.2842L11.9847 2.81317Z" fill="black"/>\n</svg>\n',error:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="10" cy="10" r="9" fill="#C94726"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M9 5C9 4.44772 9.44772 4 10 4H11.5C11.8117 4 12.1055 4.14532 12.2947 4.39301C12.4839 4.64069 12.5468 4.96243 12.4648 5.26312L10.9648 10.7631C10.8329 11.2464 10.3638 11.5576 9.86727 11.4912C9.37072 11.4247 9 11.001 9 10.5V5Z" fill="white"/>\n<path d="M11 14.5C11 15.3284 10.3284 16 9.5 16C8.67157 16 8 15.3284 8 14.5C8 13.6716 8.67157 13 9.5 13C10.3284 13 11 13.6716 11 14.5Z" fill="white"/>\n</svg>\n',expand:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 14C12.2091 14 14 12.2091 14 10C14 7.79086 12.2091 6 10 6C7.79086 6 6 7.79086 6 10C6 12.2091 7.79086 14 10 14ZM10 15C12.7614 15 15 12.7614 15 10C15 7.23858 12.7614 5 10 5C7.23858 5 5 7.23858 5 10C5 12.7614 7.23858 15 10 15Z" fill="black" fill-opacity="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17ZM10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" fill="black"/>\n</svg>\n',expander:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M16 10L6 4V16L16 10Z" fill="black"/>\n</svg>\n',fit_within:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M2 11C2 6 6 2 11 2C18 2 18 2 18 9C18 14 14 18 9 18C2 18 2 18 2 11Z" fill="black" fill-opacity="0.3"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.2929 5H12V4H15.5H16V4.5V8H15V5.70711L14.9991 5.70798L14.9918 5.71532L14.9844 5.72268L14.977 5.73006L14.9696 5.73747L14.9622 5.7449L14.9548 5.75235L14.9473 5.75982L14.9398 5.76731L14.9323 5.77482L14.9248 5.78235L14.9172 5.7899L14.9096 5.79748L14.902 5.80507L14.8944 5.81269L14.8868 5.82032L14.8791 5.82798L14.8715 5.83565L14.8638 5.84335L14.856 5.85106L14.8483 5.8588L14.8406 5.86655L14.8328 5.87432L14.825 5.88211L14.8172 5.88992L14.8094 5.89775L14.8015 5.9056L14.7936 5.91347L14.7858 5.92135L14.7778 5.92926L14.7699 5.93718L14.762 5.94512L14.754 5.95308L14.7461 5.96105L14.7381 5.96905L14.73 5.97706L14.722 5.98509L14.714 5.99313L14.7059 6.0012L14.6978 6.00928L14.6897 6.01737L14.6816 6.02549L14.6735 6.03362L14.6653 6.04177L14.6572 6.04993L14.649 6.05811L14.6408 6.06631L14.6326 6.07452L14.6244 6.08275L14.6161 6.09099L14.6079 6.09925L14.5996 6.10752L14.5913 6.11582L14.583 6.12412L14.5747 6.13244L14.5663 6.14078L14.558 6.14913L14.5496 6.15749L14.5412 6.16587L14.5328 6.17427L14.5244 6.18268L14.516 6.1911L14.5076 6.19954L14.4991 6.20799L14.4907 6.21645L14.4822 6.22493L14.4737 6.23342L14.4652 6.24193L14.4567 6.25045L14.4481 6.25898L14.4396 6.26753L14.431 6.27608L14.4225 6.28465L14.4139 6.29324L14.4053 6.30183L14.3967 6.31044L14.388 6.31906L14.3794 6.3277L14.3708 6.33634L14.3621 6.345L14.3534 6.35367L14.3448 6.36235L14.3361 6.37104L14.3274 6.37974L14.3187 6.38845L14.3099 6.39718L14.3012 6.40592L14.2924 6.41466L14.2837 6.42342L14.2749 6.43219L14.2661 6.44097L14.2573 6.44976L14.2485 6.45856L14.2397 6.46737L14.2309 6.47619L14.2221 6.48502L14.2133 6.49385L14.2044 6.5027L14.1955 6.51156L14.1867 6.52043L14.1778 6.5293L14.1689 6.53819L14.16 6.54708L14.1511 6.55599L14.1422 6.5649L14.1333 6.57382L14.1244 6.58275L14.1154 6.59168L14.1065 6.60063L14.0975 6.60958L14.0886 6.61854L14.0796 6.62751L14.0706 6.63649L14.0616 6.64547L14.0526 6.65446L14.0436 6.66346L14.0346 6.67247L14.0256 6.68148L14.0166 6.6905L14.0076 6.69952L13.9986 6.70856L13.9895 6.71759L13.9805 6.72664L13.9714 6.73569L13.9624 6.74475L13.9533 6.75381L13.9442 6.76288L13.9352 6.77196L13.9261 6.78104L13.917 6.79012L13.9079 6.79921L13.8988 6.80831L13.8897 6.81741L13.8806 6.82652L13.8715 6.83563L13.8624 6.84474L13.8532 6.85386L13.8441 6.86299L13.835 6.87211L13.8259 6.88125L13.8167 6.89038L13.8076 6.89952L13.7984 6.90867L13.7893 6.91781L13.7801 6.92697L13.771 6.93612L13.7618 6.94528L13.7527 6.95444L13.7435 6.9636L13.7343 6.97277L13.7252 6.98194L13.716 6.99111L13.7068 7.00028L13.6976 7.00946L13.6885 7.01864L13.6793 7.02782L13.6701 7.037L13.6609 7.04619L13.6517 7.05537L13.6425 7.06456L13.6334 7.07375L13.6242 7.08294L13.615 7.09213L13.6058 7.10132L13.5966 7.11052L13.5874 7.11971L13.5782 7.1289L13.569 7.1381L13.5598 7.14729L13.5506 7.15649L13.5414 7.16568L13.5322 7.17488L13.523 7.18408L13.5138 7.19327L13.5046 7.20247L13.4954 7.21166L13.4863 7.22085L13.4771 7.23004L13.4679 7.23924L13.4587 7.24843L13.4495 7.25762L13.4403 7.2668L13.4311 7.27599L13.4219 7.28518L13.4127 7.29436L13.4036 7.30354L13.3944 7.31272L13.3852 7.3219L13.376 7.33107L13.3669 7.34024L13.3577 7.34941L13.3485 7.35858L13.3394 7.36775L13.3302 7.37691L13.321 7.38607L13.3119 7.39522L13.3027 7.40437L13.2936 7.41352L13.2844 7.42267L13.2753 7.43181L13.2662 7.44095L13.257 7.45008L13.2479 7.45921L13.2388 7.46834L13.2296 7.47746L13.2205 7.48658L13.2114 7.49569L13.2023 7.5048L13.1932 7.5139L13.1841 7.523L13.175 7.53209L13.1659 7.54118L13.1568 7.55026L13.1478 7.55934L13.1387 7.56841L13.1296 7.57747L13.1206 7.58653L13.1115 7.59559L13.1025 7.60463L13.0934 7.61367L13.0844 7.62271L13.0754 7.63174L13.0663 7.64076L13.0573 7.64977L13.0483 7.65878L13.0393 7.66778L13.0303 7.67678L13.0213 7.68576L13.0124 7.69474L13.0034 7.70371L12.9944 7.71268L12.9855 7.72163L12.9765 7.73058L12.9676 7.73952L12.9587 7.74845L12.9497 7.75737L12.9408 7.76629L12.9319 7.7752L12.923 7.78409L12.9141 7.79298L12.9052 7.80186L12.8964 7.81073L12.8875 7.81959L12.8787 7.82844L12.8698 7.83729L12.861 7.84612L12.8522 7.85494L12.8434 7.86376L12.8345 7.87256L12.8258 7.88135L12.817 7.89013L12.8082 7.89891L12.7994 7.90767L12.7907 7.91642L12.7819 7.92516L12.7732 7.93389L12.7645 7.94261L12.7558 7.95131L12.7471 7.96001L12.7384 7.96869L12.7297 7.97737L12.7211 7.98603L12.7124 7.99468L12.7038 8.00331L12.6952 8.01194L12.6866 8.02055L12.678 8.02915L12.6694 8.03774L12.6608 8.04632L12.6522 8.05488L12.6437 8.06343L12.6351 8.07197L12.6266 8.08049L12.6181 8.089L12.6096 8.0975L12.6011 8.10598L12.5927 8.11445L12.5842 8.12291L12.5758 8.13135L12.5673 8.13978L12.5589 8.14819L12.5505 8.15659L12.5421 8.16497L12.5338 8.17335L12.5254 8.1817L12.5171 8.19004L12.5087 8.19837L12.5004 8.20668L12.4921 8.21498L12.4839 8.22326L12.4756 8.23152L12.4673 8.23977L12.4591 8.248L12.4509 8.25622L12.4427 8.26442L12.4345 8.27261L12.4263 8.28078L12.4182 8.28893L12.41 8.29707L12.4019 8.30519L12.3938 8.31329L12.3857 8.32138L12.3777 8.32945L12.3696 8.3375L12.3616 8.34554L12.3536 8.35355L11.6464 7.64645L11.6545 7.63843L11.6625 7.63039L11.6706 7.62234L11.6786 7.61427L11.6867 7.60619L11.6948 7.59808L11.7029 7.58996L11.7111 7.58183L11.7192 7.57367L11.7274 7.5655L11.7356 7.55732L11.7438 7.54912L11.752 7.5409L11.7602 7.53266L11.7685 7.52441L11.7767 7.51615L11.785 7.50787L11.7933 7.49957L11.8016 7.49126L11.81 7.48294L11.8183 7.47459L11.8267 7.46624L11.835 7.45787L11.8434 7.44948L11.8518 7.44108L11.8602 7.43267L11.8687 7.42424L11.8771 7.4158L11.8856 7.40734L11.894 7.39887L11.9025 7.39039L11.911 7.38189L11.9195 7.37338L11.928 7.36486L11.9366 7.35632L11.9451 7.34777L11.9537 7.33921L11.9623 7.33063L11.9708 7.32205L11.9794 7.31345L11.9881 7.30483L11.9967 7.29621L12.0053 7.28757L12.014 7.27892L12.0226 7.27026L12.0313 7.26159L12.04 7.2529L12.0487 7.24421L12.0574 7.2355L12.0661 7.22678L12.0748 7.21805L12.0836 7.20931L12.0923 7.20056L12.1011 7.1918L12.1099 7.18303L12.1186 7.17425L12.1274 7.16545L12.1362 7.15665L12.1451 7.14784L12.1539 7.13901L12.1627 7.13018L12.1716 7.12134L12.1804 7.11249L12.1893 7.10362L12.1981 7.09475L12.207 7.08587L12.2159 7.07699L12.2248 7.06809L12.2337 7.05918L12.2426 7.05027L12.2515 7.04134L12.2605 7.03241L12.2694 7.02347L12.2784 7.01453L12.2873 7.00557L12.2963 6.99661L12.3053 6.98763L12.3142 6.97866L12.3232 6.96967L12.3322 6.96068L12.3412 6.95167L12.3502 6.94267L12.3592 6.93365L12.3683 6.92463L12.3773 6.9156L12.3863 6.90657L12.3954 6.89753L12.4044 6.88848L12.4135 6.87943L12.4225 6.87037L12.4316 6.8613L12.4407 6.85223L12.4497 6.84315L12.4588 6.83407L12.4679 6.82498L12.477 6.81589L12.4861 6.80679L12.4952 6.79769L12.5043 6.78858L12.5134 6.77947L12.5225 6.77035L12.5317 6.76123L12.5408 6.75211L12.5499 6.74298L12.5591 6.73384L12.5682 6.7247L12.5773 6.71556L12.5865 6.70642L12.5956 6.69727L12.6048 6.68812L12.6139 6.67896L12.6231 6.6698L12.6323 6.66064L12.6414 6.65147L12.6506 6.64231L12.6598 6.63314L12.6689 6.62396L12.6781 6.61479L12.6873 6.60561L12.6965 6.59643L12.7056 6.58725L12.7148 6.57807L12.724 6.56888L12.7332 6.5597L12.7424 6.55051L12.7516 6.54132L12.7608 6.53213L12.77 6.52294L12.7791 6.51375L12.7883 6.50455L12.7975 6.49536L12.8067 6.48616L12.8159 6.47697L12.8251 6.46777L12.8343 6.45858L12.8435 6.44938L12.8527 6.44019L12.8619 6.43099L12.8711 6.4218L12.8803 6.4126L12.8895 6.40341L12.8987 6.39422L12.9079 6.38502L12.9171 6.37583L12.9263 6.36664L12.9354 6.35745L12.9446 6.34827L12.9538 6.33908L12.963 6.3299L12.9722 6.32071L12.9814 6.31153L12.9905 6.30235L12.9997 6.29318L13.0089 6.284L13.0181 6.27483L13.0272 6.26566L13.0364 6.2565L13.0456 6.24733L13.0547 6.23817L13.0639 6.22901L13.073 6.21986L13.0822 6.21071L13.0913 6.20156L13.1005 6.19242L13.1096 6.18328L13.1188 6.17414L13.1279 6.16501L13.137 6.15588L13.1461 6.14675L13.1553 6.13763L13.1644 6.12852L13.1735 6.11941L13.1826 6.1103L13.1917 6.1012L13.2008 6.09211L13.2099 6.08301L13.219 6.07393L13.228 6.06485L13.2371 6.05577L13.2462 6.0467L13.2553 6.03764L13.2643 6.02858L13.2734 6.01953L13.2824 6.01049L13.2914 6.00145L13.3005 5.99242L13.3095 5.98339L13.3185 5.97437L13.3275 5.96536L13.3365 5.95635L13.3455 5.94736L13.3545 5.93836L13.3635 5.92938L13.3725 5.92041L13.3815 5.91144L13.3904 5.90248L13.3994 5.89352L13.4083 5.88458L13.4173 5.87564L13.4262 5.86671L13.4351 5.85779L13.444 5.84888L13.4529 5.83998L13.4618 5.83108L13.4707 5.8222L13.4796 5.81332L13.4884 5.80445L13.4973 5.7956L13.5061 5.78675L13.515 5.77791L13.5238 5.76908L13.5326 5.76026L13.5414 5.75145L13.5502 5.74265L13.559 5.73386L13.5678 5.72508L13.5766 5.71631L13.5853 5.70756L13.5941 5.69881L13.6028 5.69007L13.6115 5.68135L13.6203 5.67263L13.629 5.66393L13.6377 5.65524L13.6463 5.64656L13.655 5.63789L13.6637 5.62923L13.6723 5.62059L13.6809 5.61196L13.6896 5.60334L13.6982 5.59473L13.7068 5.58613L13.7153 5.57755L13.7239 5.56898L13.7325 5.56042L13.741 5.55187L13.7496 5.54334L13.7581 5.53482L13.7666 5.52632L13.7751 5.51782L13.7835 5.50935L13.792 5.50088L13.8005 5.49243L13.8089 5.48399L13.8173 5.47557L13.8257 5.46716L13.8341 5.45877L13.8425 5.45039L13.8509 5.44202L13.8592 5.43367L13.8676 5.42533L13.8759 5.41701L13.8842 5.40871L13.8925 5.40042L13.9008 5.39214L13.909 5.38388L13.9173 5.37564L13.9255 5.36741L13.9337 5.3592L13.9419 5.351L13.9501 5.34282L13.9582 5.33466L13.9664 5.32651L13.9745 5.31838L13.9826 5.31027L13.9907 5.30217L13.9988 5.29409L14.0069 5.28603L14.0149 5.27798L14.0229 5.26995L14.031 5.26194L14.0389 5.25395L14.0469 5.24597L14.0549 5.23801L14.0628 5.23007L14.0707 5.22215L14.0786 5.21425L14.0865 5.20636L14.0944 5.19849L14.1022 5.19065L14.1101 5.18282L14.1179 5.17501L14.1257 5.16721L14.1335 5.15944L14.1412 5.15169L14.1489 5.14395L14.1567 5.13624L14.1643 5.12855L14.172 5.12087L14.1797 5.11322L14.1873 5.10558L14.1949 5.09797L14.2025 5.09037L14.2101 5.0828L14.2176 5.07524L14.2252 5.06771L14.2327 5.0602L14.2402 5.05271L14.2477 5.04524L14.2551 5.03779L14.2625 5.03036L14.2699 5.02296L14.2773 5.01557L14.2847 5.00821L14.292 5.00087L14.2929 5ZM5.70711 15H8V16H4.5H4V15.5V12H5L5 14.2929L5.38388 13.909L7.64645 11.6464L8.35356 12.3536L6.09099 14.6161L5.70711 15Z" fill="black"/>\n<circle cx="10" cy="10" r="1" fill="black"/>\n</svg>\n',flatten:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M11.5 18L18 13L11.5 8L9.5665 9.48731C11.0343 10.247 12 11.5368 12 13C12 14.4632 11.0343 15.753 9.5665 16.5127L11.5 18Z" fill="black" fill-opacity="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M6.5 16.4615C8.98528 16.4615 11 14.9117 11 13C11 11.0882 8.98528 9.53845 6.5 9.53845C4.01472 9.53845 2 11.0882 2 13C2 14.9117 4.01472 16.4615 6.5 16.4615ZM6.5 14.9231C7.88071 14.9231 9 14.0621 9 13C9 11.9379 7.88071 11.0769 6.5 11.0769C5.11929 11.0769 4 11.9379 4 13C4 14.0621 5.11929 14.9231 6.5 14.9231Z" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.00001 6.29289L8.64645 4.64645L9.35356 5.35355L6.85356 7.85355L6.50001 8.20711L6.14645 7.85355L3.64645 5.35355L4.35356 4.64645L6.00001 6.29289V2H7.00001V6.29289Z" fill="black"/>\n</svg>\n',fork:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M4.5 2C5.32787 2 6 2.67213 6 3.5C6 3.57047 5.99513 3.63981 5.98571 3.70771C5.88444 4.43743 5.2574 5 4.5 5C4.48623 5 4.47249 4.99981 4.45881 4.99944C3.64995 4.97759 3 4.3141 3 3.5C3 2.67213 3.67213 2 4.5 2ZM14.0143 3.70771C14.1156 4.43743 14.7426 5 15.5 5C15.5138 5 15.5275 4.99981 15.5412 4.99944C16.3501 4.97759 17 4.3141 17 3.5C17 2.67213 16.3279 2 15.5 2C14.6721 2 14 2.67213 14 3.5C14 3.57047 14.0049 3.63981 14.0143 3.70771ZM14.7829 5.89556C14.6964 5.86955 14.611 5.83868 14.5266 5.80295C14.2275 5.67635 13.9628 5.49789 13.7324 5.26756C13.5361 5.07117 13.3774 4.84979 13.2564 4.60341L10 8.45187L6.7436 4.60341C6.62263 4.84979 6.46395 5.07117 6.26756 5.26756C6.03723 5.49789 5.77252 5.67635 5.47342 5.80295C5.38901 5.83868 5.30356 5.86955 5.21706 5.89556L9 10.3663V14.2085C9.00883 14.2046 9.01769 14.2008 9.02658 14.1971C9.33695 14.0657 9.66142 14 10 14C10.3386 14 10.6631 14.0657 10.9734 14.1971C10.9823 14.2008 10.9912 14.2046 11 14.2085V10.3663L14.7829 5.89556ZM11 15.3823C10.7345 15.1446 10.384 15 10 15C9.61597 15 9.26546 15.1446 9 15.3823C8.69319 15.6571 8.5 16.0562 8.5 16.5C8.5 17.3279 9.17213 18 10 18C10.8279 18 11.5 17.3279 11.5 16.5C11.5 16.0562 11.3068 15.6571 11 15.3823Z" fill="black"/>\n</svg>\n',geometry_snap:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M4.5 5C5.12193 5 5.65546 4.6215 5.88279 4.08228C7.84727 4.31771 9.6595 5.04838 11.1911 6.14585C11.0685 6.40487 11 6.69443 11 7C11 8.10457 11.8954 9 13 9C13.3056 9 13.5951 8.93147 13.8542 8.80895C14.9516 10.3405 15.6823 12.1527 15.9177 14.1172C15.3785 14.3445 15 14.8781 15 15.5C15 16.3284 15.6716 17 16.5 17C17.3284 17 18 16.3284 18 15.5C18 14.8166 17.5429 14.2399 16.9178 14.059C16.667 11.8741 15.8529 9.86048 14.6243 8.16714C14.8607 7.83868 15 7.4356 15 7C15 5.89543 14.1046 5 13 5C12.5644 5 12.1613 5.13926 11.8329 5.37569C10.1395 4.14711 8.12594 3.33296 5.94103 3.08216C5.7601 2.45705 5.18342 2 4.5 2C3.67157 2 3 2.67157 3 3.5C3 4.32843 3.67157 5 4.5 5ZM14 7C14 7.55228 13.5523 8 13 8C12.4477 8 12 7.55228 12 7C12 6.44772 12.4477 6 13 6C13.5523 6 14 6.44772 14 7ZM4.43934 15.5607C3.85355 14.9749 3.85355 14.0251 4.43934 13.4394L6.56066 11.318L7.62133 10.2574L5.5 8.13605L4.43934 9.19671L2.31802 11.318C0.56066 13.0754 0.56066 15.9246 2.31802 17.682C4.07538 19.4394 6.92462 19.4394 8.68198 17.682L10.8033 15.5607L11.864 14.5L9.74264 12.3787L8.68198 13.4394L6.56066 15.5607C5.97487 16.1465 5.02513 16.1465 4.43934 15.5607Z" fill="black"/>\n</svg>\n',grid_snap:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17 3H14V6H17V3ZM10 3H13V6H10V3ZM10 10V7H13V10H10ZM17 10H14V7H17V10ZM10 2H9V3V10V11H10H17H18V10V3V2H17H10ZM4.43934 15.5607C3.85355 14.9749 3.85355 14.0251 4.43934 13.4394L6.56066 11.318L7.62133 10.2574L5.5 8.13605L4.43934 9.19671L2.31802 11.318C0.56066 13.0754 0.56066 15.9246 2.31802 17.682C4.07538 19.4394 6.92462 19.4394 8.68198 17.682L10.8033 15.5607L11.864 14.5L9.74264 12.3787L8.68198 13.4394L6.56066 15.5607C5.97487 16.1465 5.02513 16.1465 4.43934 15.5607Z" fill="black"/>\n</svg>\n',hamburger:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M18 6H2V4H18V6ZM18 11H2V9H18V11ZM2 16H18V14H2V16Z" fill="black"/>\n</svg>\n',height:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M9.50001 3.79291L9.85357 4.14646L11.8536 6.14646L12.2071 6.50001L11.5 7.20712L11.1465 6.85357L10 5.70712V14.2929L11.1465 13.1465L11.5 12.7929L12.2071 13.5L11.8536 13.8536L9.85357 15.8536L9.50001 16.2071L9.14646 15.8536L7.14646 13.8536L6.79291 13.5L7.50001 12.7929L7.85357 13.1465L9.00001 14.2929V5.70712L7.85357 6.85357L7.50001 7.20712L6.79291 6.50001L7.14646 6.14646L9.14646 4.14646L9.50001 3.79291Z" fill="black"/>\n</svg>\n',hide_guides:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M16.1213 14H16.5H17V13H16.5H15.1213L16.1213 14ZM14 11.8787V7H16.5H17V6H16.5H14V3.5V3H13V3.5V6H8.12132L9.12132 7H13V10.8787L14 11.8787ZM7 9.12132V13H10.8787L11.8787 14H7V16.5V17H6V16.5V14H3.5H3V13H3.5H6V8.12132L7 9.12132ZM4.87868 7L3.87868 6H3.5H3V7H3.5H4.87868ZM6 3.87868L7 4.87868V3.5V3H6V3.5V3.87868ZM13 15.1213V16.5V17H14V16.5V16.1213L13 15.1213Z" fill="black" fill-opacity="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M16.6464 17.3536L2.64642 3.35356L3.35353 2.64645L17.3535 16.6465L16.6464 17.3536Z" fill="black"/>\n</svg>\n',info:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="10" cy="10" r="9" fill="#20C573"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5 7C11.3284 7 12 6.32843 12 5.5C12 4.67157 11.3284 4 10.5 4C9.67159 4 9.00001 4.67157 9.00001 5.5C9.00001 6.32843 9.67159 7 10.5 7ZM10.2212 8.00917C11.0446 8.10066 11.6379 8.84229 11.5464 9.66565L10.9908 14.6656C10.8994 15.489 10.1577 16.0823 9.33437 15.9908C8.51101 15.8993 7.9177 15.1577 8.00919 14.3344L8.52437 9.69771L7.24277 8.92875C7.05005 8.81312 6.95817 8.58312 7.01816 8.36653C7.07815 8.14995 7.27527 8 7.50001 8H10C10.0059 8 10.0117 8.0001 10.0176 8.0003C10.0847 7.99869 10.1527 8.00156 10.2212 8.00917Z" fill="white"/>\n</svg>\n',insert_symbol:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 17.9548C11.3252 17.9548 12.3018 18.5215 13.4702 18.5011C15.873 18.4593 16.8068 16.763 16.8068 15.5485C16.8068 13.6735 15.9476 12.6952 14.4231 11.2834C13.159 10.1128 12.4208 7.74903 10 7.74903C7.5792 7.74903 6.84097 10.1128 5.57693 11.2834C4.05238 12.6952 3.19316 13.6735 3.19316 15.5485C3.19316 16.763 4.12704 18.4593 6.52984 18.5011C7.69824 18.5215 8.67484 17.9548 10 17.9548ZM9.53619 3.60369C9.89651 5.29888 9.11334 6.90381 7.78836 7.18544C6.46339 7.46707 5.09514 6.31944 4.73481 4.62425C4.37449 2.92907 5.15766 1.32414 6.48264 1.04251C7.80761 0.760873 9.17586 1.9085 9.53619 3.60369ZM5.28537 7.19306C5.9968 8.58932 5.70112 10.1679 4.6255 10.7159C3.54987 11.264 2.09901 10.5753 1.38758 9.17909C0.67615 7.78283 0.97183 6.20429 2.04746 5.65623C3.12308 5.10817 4.57394 5.79681 5.28537 7.19306ZM10.4638 3.60369C10.1035 5.29888 10.8867 6.90381 12.2116 7.18544C13.5366 7.46707 14.9049 6.31944 15.2652 4.62425C15.6255 2.92907 14.8423 1.32414 13.5174 1.04251C12.1924 0.760873 10.8241 1.9085 10.4638 3.60369ZM14.7146 7.19306C14.0032 8.58932 14.2989 10.1679 15.3745 10.7159C16.4501 11.264 17.901 10.5753 18.6124 9.17909C19.3239 7.78283 19.0282 6.20429 17.9525 5.65623C16.8769 5.10817 15.4261 5.79681 14.7146 7.19306Z" fill="black"/>\n</svg>\n',invisible:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M19 10C17.875 12 14.5 16 10 16C5.5 16 2.125 12 1 10L2.74314 9.01947C3.19344 9.82001 4.15965 11.1182 5.4914 12.1944C6.82035 13.2683 8.35794 14 9.99999 14C11.642 14 13.1796 13.2683 14.5086 12.1944C15.8403 11.1182 16.8065 9.82001 17.2568 9.01947L19 10Z" fill="black"/>\n</svg>\n',layered_stack:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2.65592 10.1995C2.23977 10.724 2 11.3405 2 12C2 13.9118 4.01472 15.4615 6.5 15.4615C7.35824 15.4615 8.16037 15.2767 8.8428 14.956L11.5 17L18 12L11.9816 7.37048C11.8649 8.54126 11.2019 9.54016 10.2917 10.2403C9.82742 10.5974 9.29037 10.8855 8.70428 11.0919C8.89297 11.3624 9 11.6716 9 12C9 13.0621 7.88071 13.9231 6.5 13.9231C5.11929 13.9231 4 13.0621 4 12C4 11.6716 4.10703 11.3624 4.29572 11.0919C3.70963 10.8855 3.17257 10.5974 2.70831 10.2403C2.69075 10.2268 2.67329 10.2132 2.65592 10.1995Z" fill="black" fill-opacity="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M6.5 10.4615C8.98528 10.4615 11 8.91175 11 6.99999C11 5.08824 8.98528 3.53845 6.5 3.53845C4.01472 3.53845 2 5.08824 2 6.99999C2 8.91175 4.01472 10.4615 6.5 10.4615ZM6.5 8.92307C7.88071 8.92307 9 8.06208 9 6.99999C9 5.9379 7.88071 5.07691 6.5 5.07691C5.11929 5.07691 4 5.9379 4 6.99999C4 8.06208 5.11929 8.92307 6.5 8.92307Z" fill="black"/>\n</svg>\n',license:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M16 10C16 13.3137 13.3137 16 10 16C6.68629 16 4 13.3137 4 10C4 6.68629 6.68629 4 10 4C13.3137 4 16 6.68629 16 10ZM18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10ZM8 10C8 8.89543 8.89543 8 10 8C10.5922 8 11.1233 8.25615 11.491 8.66691L12.9812 7.33309C12.2502 6.51635 11.1848 6 10 6C7.79086 6 6 7.79086 6 10C6 12.2091 7.79086 14 10 14C11.1848 14 12.2502 13.4836 12.9812 12.6669L11.491 11.3331C11.1233 11.7438 10.5922 12 10 12C8.89543 12 8 11.1046 8 10Z" fill="black"/>\n</svg>\n',license_allowed:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10C0 4.47715 4.47715 0 10 0C15.5228 0 20 4.47715 20 10Z" fill="#20C573"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M15.7071 6.29289C16.0976 6.68342 16.0976 7.31658 15.7071 7.70711L8.70711 14.7071C8.31658 15.0976 7.68342 15.0976 7.29289 14.7071L4.29289 11.7071C3.90237 11.3166 3.90237 10.6834 4.29289 10.2929C4.68342 9.90237 5.31658 9.90237 5.70711 10.2929L8 12.5858L14.2929 6.29289C14.6834 5.90237 15.3166 5.90237 15.7071 6.29289Z" fill="white"/>\n</svg>\n',license_restricted:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="10" cy="10" r="10" fill="#C94726"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M5.29289 5.29289C5.68342 4.90237 6.31658 4.90237 6.70711 5.29289L10 8.58579L13.2929 5.29289C13.6834 4.90237 14.3166 4.90237 14.7071 5.29289C15.0976 5.68342 15.0976 6.31658 14.7071 6.70711L11.4142 10L14.7071 13.2929C15.0976 13.6834 15.0976 14.3166 14.7071 14.7071C14.3166 15.0976 13.6834 15.0976 13.2929 14.7071L10 11.4142L6.70711 14.7071C6.31658 15.0976 5.68342 15.0976 5.29289 14.7071C4.90237 14.3166 4.90237 13.6834 5.29289 13.2929L8.58579 10L5.29289 6.70711C4.90237 6.31658 4.90237 5.68342 5.29289 5.29289Z" fill="white"/>\n</svg>\n',linear_repeat:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="3" y="3" width="6" height="6" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7 10V13H13V7H10V10H7Z" fill="black" fill-opacity="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M11 14V17H17V11H14V14H11Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',locked:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.75 7C7.75 5.75736 8.75736 4.75 10 4.75C11.2426 4.75 12.25 5.75736 12.25 7V9H7.75V7ZM6.25 9V7C6.25 4.92893 7.92893 3.25 10 3.25C12.0711 3.25 13.75 4.92893 13.75 7V9H14C15.1046 9 16 9.89543 16 11V15C16 16.1046 15.1046 17 14 17H6C4.89543 17 4 16.1046 4 15V11C4 9.89543 4.89543 9 6 9H6.25Z" fill="black"/>\n</svg>\n',logo:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M14.8624 7.35746L8.96098 8.93627C8.58099 9.03827 8.1806 9.0367 7.80143 8.9317C7.42226 8.8267 7.07817 8.62211 6.80494 8.33922C6.76609 8.29859 6.71684 8.26937 6.66254 8.25472C6.60825 8.24007 6.55097 8.24055 6.49694 8.25612L3.38608 9.09323C2.9768 9.20242 2.59314 9.39134 2.25714 9.64914C1.92115 9.90694 1.63945 10.2285 1.42823 10.5955C1.21701 10.9624 1.08042 11.3674 1.02633 11.7872C0.97223 12.207 1.00169 12.6334 1.113 13.0418C1.1335 13.1206 1.18445 13.1881 1.25468 13.2295C1.28976 13.2498 1.32849 13.2629 1.36866 13.2682C1.40883 13.2735 1.44964 13.2708 1.48877 13.2603L12.577 10.2904C12.5437 10.8313 12.6497 11.3717 12.885 11.86C13.1521 12.4006 13.5656 12.8556 14.0784 13.1732C14.5913 13.4909 15.183 13.6586 15.7864 13.6573C15.9451 13.6566 16.1035 13.6453 16.2607 13.6234C16.7238 13.5538 17.1661 13.3839 17.5568 13.1258C17.9474 12.8676 18.277 12.5274 18.5225 12.1289C18.7679 11.7303 18.9234 11.2831 18.978 10.8183C19.0327 10.3535 18.9851 9.88244 18.8387 9.43792C18.5665 8.64981 18.0032 7.99544 17.264 7.60869C16.5248 7.22195 15.6657 7.13208 14.8624 7.35746ZM16.2114 11.9923C15.9031 12.0745 15.5773 12.0636 15.2752 11.9608C14.9731 11.8581 14.7082 11.6681 14.5141 11.415C14.32 11.1619 14.2054 10.857 14.1847 10.5388C14.164 10.2206 14.2382 9.9034 14.3979 9.62731C14.5575 9.35122 14.7955 9.12863 15.0818 8.98767C15.368 8.84671 15.6897 8.7937 16.0061 8.83536C16.3225 8.87701 16.6194 9.01145 16.8593 9.22169C17.0993 9.43192 17.2715 9.70851 17.3541 10.0165C17.4085 10.2218 17.4218 10.4358 17.3933 10.6463C17.3648 10.8567 17.2951 11.0595 17.1881 11.243C17.0811 11.4265 16.939 11.5872 16.7698 11.7157C16.6006 11.8443 16.4077 11.9383 16.2022 11.9923H16.2114Z" fill="black"/>\n<path d="M12.0102 7.48057L12.6262 5.14467C12.8557 4.3439 12.7706 3.48578 12.3882 2.74562C12.0058 2.00546 11.355 1.43911 10.5688 1.16227C10.1204 1.01422 9.64494 0.966657 9.17611 1.02296C8.70729 1.07925 8.25662 1.23803 7.85615 1.48801C7.45567 1.73799 7.1152 2.07303 6.85894 2.46932C6.60268 2.86562 6.43692 3.31345 6.37342 3.78098C6.30993 4.24852 6.35027 4.72429 6.49158 5.17449C6.63288 5.62469 6.87168 6.03827 7.19101 6.38585C7.51034 6.73342 7.90236 7.00645 8.33922 7.18555C8.77608 7.36464 9.24705 7.44541 9.71867 7.42209L9.52155 8.14841L12.0102 7.48057ZM9.13962 5.7725C8.83169 5.68939 8.55532 5.51696 8.34539 5.27701C8.13547 5.03705 8.00141 4.74032 7.96014 4.42429C7.91887 4.10826 7.97225 3.78709 8.11353 3.50135C8.25481 3.21561 8.47766 2.9781 8.75393 2.81882C9.03021 2.65954 9.34753 2.58563 9.66581 2.60642C9.9841 2.62722 10.2891 2.74178 10.5423 2.93564C10.7954 3.12951 10.9854 3.39399 11.0883 3.69568C11.1911 3.99737 11.2022 4.32274 11.1201 4.63072C11.0089 5.04451 10.7379 5.39725 10.3665 5.61137C9.99508 5.82548 9.55378 5.88344 9.13962 5.7725Z" fill="black"/>\n<path d="M8.48666 12.0077L6.74642 18.4984C6.73383 18.5384 6.72954 18.5805 6.73383 18.6222C6.73812 18.6639 6.7509 18.7043 6.77138 18.7409C6.79186 18.7775 6.8196 18.8096 6.85292 18.8351C6.88623 18.8606 6.92441 18.879 6.96511 18.8892C7.23834 18.9625 7.51998 18.9997 7.80288 19C8.50981 18.998 9.19644 18.7637 9.75694 18.3332C10.3174 17.9027 10.7207 17.3 10.9045 16.6179L11.7392 13.5003C11.7548 13.4463 11.7553 13.3891 11.7406 13.3349C11.7259 13.2806 11.6967 13.2314 11.656 13.1926C11.4123 12.9556 11.2264 12.6659 11.1126 12.3457C10.9989 12.0255 10.9603 11.6835 11 11.346L8.48666 12.0077Z" fill="black"/>\n</svg>\n',mask:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="10" cy="10" r="8" fill="black" fill-opacity="0.3"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2.50073 12.7922L12.7921 2.50076C13.1282 2.62595 13.4537 2.7731 13.7667 2.94045L2.94042 13.7667C2.77307 13.4537 2.62592 13.1283 2.50073 12.7922ZM4.00056 15.2923L15.2923 4.00059C15.5424 4.2214 15.7786 4.45759 15.9994 4.7077L4.70767 15.9994C4.45756 15.7786 4.22137 15.5424 4.00056 15.2923ZM6.23331 17.0596L17.0595 6.23334C17.2269 6.54633 17.374 6.87176 17.4992 7.20787L7.20784 17.4992C6.87173 17.3741 6.5463 17.2269 6.23331 17.0596ZM9.32126 17.9716L17.9716 9.32129C17.9904 9.54503 18 9.7714 18 10C18 10.2498 17.9885 10.497 17.9661 10.741L10.7409 17.9661C10.497 17.9885 10.2498 18 9.99997 18C9.77137 18 9.545 17.9904 9.32126 17.9716ZM9.25903 2.03386C9.50301 2.01145 9.75015 2 9.99997 2C10.2286 2 10.455 2.00959 10.6787 2.02839L2.02836 10.6787C2.00956 10.455 1.99997 10.2286 1.99997 10C1.99997 9.75018 2.01142 9.50304 2.03383 9.25906L9.25903 2.03386Z" fill="black"/>\n</svg>\n',merge_paths:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8.6278 6.51022C7.91406 6.9223 7.07698 7.04121 6.00024 7.04121L6.00024 6.04121C7.02202 6.04121 7.6444 5.92329 8.1278 5.6442C8.61121 5.3651 9.02452 4.88507 9.53541 4.00018L10.4014 4.50018C9.86307 5.43266 9.34155 6.09814 8.6278 6.51022ZM14.7441 10.0414C14.7441 9.21729 15.0596 8.4329 15.598 7.50042L16.464 8.00042C15.9531 8.88531 15.7441 9.48326 15.7441 10.0414C15.7441 10.5996 15.9531 11.1976 16.464 12.0825L15.598 12.5825C15.0596 11.65 14.7441 10.8656 14.7441 10.0414ZM8.6278 13.5727C9.34155 13.9848 9.86307 14.6502 10.4014 15.5827L9.53541 16.0827C9.02452 15.1978 8.61121 14.7178 8.1278 14.4387C7.6444 14.1596 7.02202 14.0417 6.00024 14.0417V13.0417C7.07698 13.0417 7.91406 13.1606 8.6278 13.5727Z" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.4998 3.402C13.066 2.57415 11.2293 3.06629 10.4014 4.50016L9.5354 4.00016C10.6394 2.088 13.0877 1.43199 14.9998 2.53597C16.912 3.63996 17.568 6.08824 16.464 8.0004L15.598 7.5004C16.4258 6.06653 15.9337 4.22985 14.4998 3.402ZM6.00024 7.04119C4.34455 7.04119 3 8.38574 3 10.0414C3 11.6971 4.34455 13.0417 6.00024 13.0417V14.0417C3.79226 14.0417 2 12.2494 2 10.0414C2 7.83345 3.79226 6.04119 6.00024 6.04119L6.00024 7.04119ZM14.4998 16.6809C15.9337 15.853 16.4258 14.0163 15.598 12.5825L16.464 12.0825C17.568 13.9946 16.912 16.4429 14.9998 17.5469C13.0877 18.6509 10.6394 17.9949 9.5354 16.0827L10.4014 15.5827C11.2293 17.0166 13.066 17.5087 14.4998 16.6809Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',mirror_repeat:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.58397 2.77734C7.43079 2.54758 7.49288 2.23714 7.72264 2.08397C7.95241 1.93079 8.26284 1.99288 8.41602 2.22264C8.94915 3.02235 9.34246 3.94409 9.60288 4.79045C9.73326 5.21419 9.83304 5.62791 9.89997 6.00656C9.93321 6.00224 9.96661 6.00001 10 6.00001V15C9.5 15 9 14.5 9 14C7.5 21.5 1 16.5 5 12C-0.499998 7.50001 1.5 -2.49996 8.99999 7C8.99999 7 8.99999 7 8.99999 6.99999C8.99999 6.56623 8.88821 5.86812 8.6471 5.08454C8.40752 4.30589 8.05083 3.47764 7.58397 2.77734Z" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12.416 2.77734C12.5692 2.54758 12.5071 2.23714 12.2774 2.08397C12.0476 1.93079 11.7372 1.99288 11.584 2.22264C11.0508 3.02235 10.6575 3.94409 10.3971 4.79045C10.2667 5.21419 10.167 5.62791 10.1 6.00656C10.0668 6.00224 10.0334 6.00001 10 6.00001V15C10.5 15 11 14.5 11 14C12.5 21.5 19 16.5 15 12C20.5 7.50001 18.5 -2.49996 11 7C11 7 11 7 11 6.99999C11 6.56623 11.1118 5.86812 11.3529 5.08454C11.5925 4.30589 11.9492 3.47764 12.416 2.77734Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',mouse:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 2H11C12.6569 2 14 3.34315 14 5V9H10V7.91465C10.5826 7.70873 11 7.15311 11 6.5V4.5C11 3.84689 10.5826 3.29127 10 3.08535V2ZM9 2H8C6.34315 2 5 3.34315 5 5V9H9V7.91465C8.4174 7.70873 8 7.15311 8 6.5V4.5C8 3.84689 8.4174 3.29127 9 3.08535V2ZM5 13.5V10H14V13.5C14 15.9853 11.9853 18 9.5 18C7.01472 18 5 15.9853 5 13.5ZM4 5C4 2.79086 5.79086 1 8 1H11C13.2091 1 15 2.79086 15 5V13.5C15 16.5376 12.5376 19 9.5 19C6.46243 19 4 16.5376 4 13.5V5ZM10 4.5V6.5C10 6.77614 9.77614 7 9.5 7C9.22386 7 9 6.77614 9 6.5V4.5C9 4.22386 9.22386 4 9.5 4C9.77614 4 10 4.22386 10 4.5Z" fill="black"/>\n</svg>\n',new_tab:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12 5H14.2929L8.64645 10.6464L9.35355 11.3536L15 5.70711V8H16V4.5V4H15.5H12V5ZM4.5 6H4V6.5V15.5V16H4.5H13.5H14V15.5V10.5V10H13V10.5V15H5V7H9.5H10V6H9.5H4.5Z" fill="black"/>\n</svg>\n',non_uniform_scale:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7 1V4H6V1H7ZM3.35355 2.64645L5.35355 4.64645L4.64645 5.35355L2.64645 3.35355L3.35355 2.64645ZM1 6H4V7H1V6ZM9.70711 16.7071C7.93587 18.4783 5.06413 18.4783 3.2929 16.7071C1.52166 14.9359 1.52166 12.0641 3.2929 10.2929L4.7929 8.79289L6.20711 10.2071L4.70711 11.7071C3.71692 12.6973 3.71692 14.3027 4.70711 15.2929C5.6973 16.2831 7.30271 16.2831 8.29289 15.2929L9.7929 13.7929L11.2071 15.2071L9.70711 16.7071ZM16.7071 9.70713L15.2071 11.2071L13.7929 9.79289L15.2929 8.29291C16.2831 7.30272 16.2831 5.69731 15.2929 4.70712C14.3027 3.71692 12.6973 3.71692 11.7071 4.70711L10.2071 6.2071L8.7929 4.79289L10.2929 3.2929C12.0641 1.52166 14.9359 1.52166 16.7071 3.29291C18.4783 5.06415 18.4783 7.93589 16.7071 9.70713ZM13 16V19H14V16L13 16ZM14.6464 15.3536L16.6464 17.3536L17.3536 16.6464L15.3536 14.6464L14.6464 15.3536ZM16 14H19V13H16V14Z" fill="black"/>\n</svg>\n',outline_fill:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle class="alpha-background" cx="10" cy="10" r="7" fill="url(#alpha-background-checkerboard)"/>\n<circle cx="10" cy="10" r="7" fill="currentColor"/>\n</svg>\n',outline_fill_none:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="10" cy="10" r="7" fill="white"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 16C13.3137 16 16 13.3137 16 10C16 6.68629 13.3137 4 10 4C6.68629 4 4 6.68629 4 10C4 13.3137 6.68629 16 10 16ZM10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17Z" fill="#E5E5E5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M4.29289 4.29289C4.68342 3.90237 5.31658 3.90237 5.70711 4.29289L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L4.29289 5.70711C3.90237 5.31658 3.90237 4.68342 4.29289 4.29289Z" fill="#FF0000"/>\n</svg>\n',outline_fill_white:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10ZM10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17Z" fill="black" fill-opacity="0.1"/>\n</svg>\n',outline_stroke:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path class="alpha-background" fill-rule="evenodd" clip-rule="evenodd" d="M14.9398 4.65825C15.1285 5.17729 14.8608 5.75105 14.3417 5.93979C13.1691 6.36619 12.4978 6.97957 12.0375 7.67625C11.5503 8.41355 11.2744 9.27462 10.9545 10.2983C10.9488 10.3165 10.9431 10.3348 10.9373 10.3531C10.6362 11.3171 10.2878 12.4325 9.63121 13.4263C8.93526 14.4796 7.91913 15.3662 6.34174 15.9398C5.82271 16.1285 5.24894 15.8608 5.0602 15.3417C4.87146 14.8227 5.13922 14.2489 5.65825 14.0602C6.83086 13.6338 7.50223 13.0204 7.96254 12.3237C8.44968 11.5864 8.72563 10.7254 9.04552 9.70172C9.05122 9.68349 9.05693 9.6652 9.06266 9.64685C9.36378 8.68287 9.71217 7.56753 10.3688 6.57374C11.0647 5.52042 12.0809 4.6338 13.6583 4.0602C14.1773 3.87146 14.7511 4.13922 14.9398 4.65825Z" fill="url(#alpha-background-checkerboard)"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.9398 4.65825C15.1285 5.17729 14.8608 5.75105 14.3417 5.93979C13.1691 6.36619 12.4978 6.97957 12.0375 7.67625C11.5503 8.41355 11.2744 9.27462 10.9545 10.2983C10.9488 10.3165 10.9431 10.3348 10.9373 10.3531C10.6362 11.3171 10.2878 12.4325 9.63121 13.4263C8.93526 14.4796 7.91913 15.3662 6.34174 15.9398C5.82271 16.1285 5.24894 15.8608 5.0602 15.3417C4.87146 14.8227 5.13922 14.2489 5.65825 14.0602C6.83086 13.6338 7.50223 13.0204 7.96254 12.3237C8.44968 11.5864 8.72563 10.7254 9.04552 9.70172C9.05122 9.68349 9.05693 9.6652 9.06266 9.64685C9.36378 8.68287 9.71217 7.56753 10.3688 6.57374C11.0647 5.52042 12.0809 4.6338 13.6583 4.0602C14.1773 3.87146 14.7511 4.13922 14.9398 4.65825Z" fill="currentColor"/>\n</svg>\n',outline_stroke_none:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="10" cy="10" r="7" fill="white"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.9398 4.65853C15.1285 5.17756 14.8608 5.75133 14.3417 5.94007C13.1691 6.36647 12.4978 6.97985 12.0375 7.67653C11.5503 8.41382 11.2744 9.2749 10.9545 10.2985C10.9488 10.3168 10.9431 10.3351 10.9373 10.3534C10.6362 11.3174 10.2878 12.4327 9.63121 13.4265C8.93526 14.4798 7.91913 15.3665 6.34174 15.9401C5.82271 16.1288 5.24894 15.861 5.0602 15.342C4.87146 14.823 5.13922 14.2492 5.65825 14.0605C6.83086 13.6341 7.50223 13.0207 7.96254 12.324C8.44968 11.5867 8.72563 10.7256 9.04552 9.702C9.05122 9.68376 9.05693 9.66547 9.06266 9.64712C9.36378 8.68315 9.71217 7.56781 10.3688 6.57401C11.0647 5.5207 12.0809 4.63407 13.6583 4.06048C14.1773 3.87174 14.7511 4.1395 14.9398 4.65853Z" fill="#E5E5E5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M4.29289 4.29289C4.68342 3.90237 5.31658 3.90237 5.70711 4.29289L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L4.29289 5.70711C3.90237 5.31658 3.90237 4.68342 4.29289 4.29289Z" fill="#FF0000"/>\n</svg>\n',outline_stroke_white:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M11.8918 10.6513C11.8874 10.6656 11.8829 10.6801 11.8783 10.6945C11.5843 11.636 11.2006 12.865 10.4655 13.9775C9.65178 15.2091 8.46327 16.2324 6.68348 16.8796C5.64541 17.2571 4.49789 16.7215 4.12041 15.6835C3.74293 14.6454 4.27844 13.4979 5.31651 13.1204C6.28674 12.7676 6.78572 12.2908 7.1282 11.7725C7.52404 11.1734 7.76324 10.4524 8.09103 9.40345L8.10814 9.34869C8.11262 9.33435 8.11712 9.31993 8.12164 9.30545C8.41565 8.36394 8.79943 7.13494 9.53445 6.02248C10.3482 4.79085 11.5367 3.7676 13.3165 3.12041C14.3546 2.74293 15.5021 3.27844 15.8796 4.31651C16.2571 5.35458 15.7215 6.5021 14.6835 6.87958C13.7133 7.23239 13.2143 7.70915 12.8718 8.22751C12.4759 8.82663 12.2367 9.54761 11.909 10.5965L11.8918 10.6513ZM10.9545 10.2983C11.2744 9.27462 11.5503 8.41355 12.0375 7.67625C12.4978 6.97957 13.1691 6.36619 14.3417 5.93979C14.8608 5.75105 15.1285 5.17729 14.9398 4.65825C14.751 4.13922 14.1773 3.87146 13.6583 4.0602C12.0809 4.6338 11.0647 5.52042 10.3688 6.57374C9.71217 7.56753 9.36378 8.68287 9.06266 9.64685L9.04552 9.70172C8.72562 10.7254 8.44968 11.5864 7.96253 12.3237C7.50223 13.0204 6.83086 13.6338 5.65825 14.0602C5.13922 14.2489 4.87146 14.8227 5.0602 15.3417C5.24894 15.8608 5.8227 16.1285 6.34174 15.9398C7.91913 15.3662 8.93526 14.4796 9.63121 13.4263C10.2878 12.4325 10.6362 11.3171 10.9373 10.3531L10.9545 10.2983Z" fill="black" fill-opacity="0.1"/>\n</svg>\n',outline_transform:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.2929 5.99999L12.6464 4.35356L13.3535 3.64645L15.8535 6.14645L16.2071 6.50001L15.8535 6.85356L13.3535 9.35356L12.6464 8.64645L14.2929 6.99999L8.94996 6.99999C8.98275 6.83844 8.99997 6.67123 8.99997 6.49999C8.99997 6.32876 8.98275 6.16155 8.94996 5.99999L14.2929 5.99999ZM6.49997 8.99999C6.6712 8.99999 6.83841 8.98278 6.99997 8.94998L6.99997 14.2929L8.64642 12.6465L9.35353 13.3536L6.85353 15.8536L6.49998 16.2071L6.14642 15.8536L3.64642 13.3536L4.35353 12.6465L5.99997 14.2929L5.99997 8.94998C6.16152 8.98278 6.32874 8.99999 6.49997 8.99999ZM4.99997 6.49999C4.99997 7.32842 5.67154 7.99999 6.49997 7.99999C7.3284 7.99999 7.99997 7.32842 7.99997 6.49999C7.99997 5.67156 7.3284 4.99999 6.49997 4.99999C5.67154 4.99999 4.99997 5.67156 4.99997 6.49999Z" fill="currentColor" />\n</svg>\n',pen:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8.85329 8.14619L1.85355 1.14645L2 1L13.5 5.5L16 11.5L11.5 16L5.5 13.5L1 2L1.14645 1.85355L8.14619 8.85329C8.05248 9.04911 8 9.26843 8 9.5C8 10.3284 8.67157 11 9.5 11C10.3284 11 11 10.3284 11 9.5C11 8.67157 10.3284 8 9.5 8C9.26843 8 9.04911 8.05248 8.85329 8.14619ZM12 16.5L16.5 12L19 14.5L14.5 19L12 16.5Z" fill="black"/>\n</svg>\n',plan_checked:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM17.707 9.70709C18.0976 9.31656 18.0976 8.6834 17.707 8.29288C17.3165 7.90235 16.6834 7.90235 16.2928 8.29288L9.99994 14.5858L7.70705 12.2929C7.31652 11.9024 6.68336 11.9024 6.29283 12.2929C5.90231 12.6834 5.90231 13.3166 6.29283 13.7071L9.29283 16.7071C9.68336 17.0976 10.3165 17.0976 10.707 16.7071L17.707 9.70709Z" fill="#40BFFF"/>\n</svg>\n',plan_unchecked:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" fill="black" fill-opacity="0.2"/>\n</svg>\n',play:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.49614 5.13176C7.18664 4.9549 6.80639 4.95617 6.49807 5.13509C6.18976 5.31401 6 5.64353 6 6V14C6 14.3565 6.18976 14.686 6.49807 14.8649C6.80639 15.0438 7.18664 15.0451 7.49614 14.8682L14.4961 10.8682C14.8077 10.6902 15 10.3589 15 10C15 9.64114 14.8077 9.3098 14.4961 9.13176L7.49614 5.13176Z" fill="black"/>\n</svg>\n',play_button_overlay:'<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="100" cy="100" r="98" fill="black" fill-opacity="0.2"/>\n<circle cx="100" cy="100" r="88" fill="#3E3E3E" class="play-button-hover-circle"/>\n<path d="M142 96.5359C144.667 98.0755 144.667 101.925 142 103.464L82 138.105C79.3333 139.645 76 137.72 76 134.641V65.359C76 62.2798 79.3333 60.3553 82 61.8949L142 96.5359Z" fill="white"/>\n</svg>\n',plus:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M11 5V4H9V5V9H5H4V11H5H9V15V16H11V15V11H15H16V9H15H11V5Z" fill="black"/>\n</svg>\n',plus_new_project:'<svg height=\'100%\' width=\'100%\' xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve"><g><polygon points="26,1 24,1 24,24 1,24 1,26 24,26 24,49 26,49 26,26 49,26 49,24 26,24  "></polygon></g></svg>',polygon:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 2.95607L2.61606 8.32081L5.43647 17.0012H14.5635L17.3839 8.32081L10 2.95607ZM18.5595 7.93885L10 1.72L1.44049 7.93885L4.70993 18.0012H15.2901L18.5595 7.93885Z" fill="black"/>\n</svg>\n',pro:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2.02902 5.59013C2.00519 5.35923 2.1439 5.14244 2.36353 5.0673C2.58316 4.99216 2.82559 5.07857 2.94819 5.27568L2.95284 5.28315C5.68101 9.66941 7.62194 7.65489 9.52937 2.31433C9.6004 2.11543 9.78881 1.98267 10 1.98267C10.2112 1.98267 10.3996 2.11543 10.4706 2.31433C12.3781 7.65489 14.319 9.66941 17.0472 5.28315L17.0518 5.27568C17.1744 5.07857 17.4169 4.99216 17.6365 5.0673C17.8561 5.14244 17.9948 5.35923 17.971 5.59013L17.0463 14.5513C17.02 14.8062 16.8052 15 16.5489 15H3.45107C3.19479 15 2.98001 14.8062 2.95371 14.5513L2.02902 5.59013Z" fill="#D9F030"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 16C16.7761 16 17 16.2239 17 16.5V17.5C17 17.7761 16.7761 18 16.5 18H3.5C3.22386 18 3 17.7761 3 17.5V16.5C3 16.2239 3.22386 16 3.5 16H16.5Z" fill="#D9F030"/>\n</svg>\n',published:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17.954 3.70952C18.0352 3.53351 18.0074 3.3264 17.8826 3.17807C17.7578 3.02974 17.5585 2.96692 17.3712 3.01687L2.37118 7.01687C2.19848 7.06293 2.06349 7.19767 2.01713 7.37029C1.97076 7.54291 2.02007 7.72715 2.14646 7.85354L5.00001 10.7071V15.5C5.00001 15.7203 5.14424 15.9147 5.35512 15.9785C5.5355 16.0332 5.72828 15.9813 5.85676 15.8504L8.00002 13.7071L11.1465 16.8535C11.2621 16.9691 11.4269 17.0209 11.5878 16.9922C11.7487 16.9635 11.8855 16.858 11.954 16.7095L17.954 3.70952ZM6.00001 13.8486V10.7872L13.5478 6.3843L7.16553 12.1283C7.13452 12.1562 7.10713 12.1879 7.08399 12.2226L6.00001 13.8486ZM3.46678 7.75966L14.0379 4.94068L5.58101 9.87389L3.46678 7.75966ZM8.22622 12.5191L16.027 5.49839L11.3465 15.6394L8.22622 12.5191Z" fill="black"/>\n</svg>\n',rectangle:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17 3H3V17H17V3ZM3 2H2V3V17V18H3H17H18V17V3V2H17H3Z" fill="black"/>\n</svg>\n',remove_holes:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17 3H3V17H17V3ZM10 15C12.7614 15 15 12.7614 15 10C15 7.23858 12.7614 5 10 5C7.23858 5 5 7.23858 5 10C5 12.7614 7.23858 15 10 15Z" fill="black" fill-opacity="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8.00001 7.29291L8.35357 7.64646L10 9.29291L11.6465 7.64646L12 7.29291L12.7071 8.00001L12.3536 8.35357L10.7071 10L12.3536 11.6465L12.7071 12L12 12.7071L11.6465 12.3536L10 10.7071L8.35357 12.3536L8.00001 12.7071L7.29291 12L7.64646 11.6465L9.29291 10L7.64646 8.35357L7.29291 8.00001L8.00001 7.29291Z" fill="black"/>\n</svg>\n',remove_overlaps:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8 14H9V15V16H10H16H17V15V7V6H16H11H10V5V4H9H3H2V5V13V14H3H8ZM3 13H9H10V14V15H16V7H10H9V6V5H3V13Z" fill="black"/>\n<rect x="9" y="7" width="1" height="6" fill="black" fill-opacity="0.4"/>\n</svg>\n',revert:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M5 10C5 7.23858 7.23858 5 10 5C12.7614 5 15 7.23858 15 10C15 12.7614 12.7614 15 10 15C8.7908 15 7.68304 14.5714 6.81839 13.8573C6.60547 13.6815 6.29032 13.7115 6.11448 13.9244C5.93863 14.1374 5.96869 14.4525 6.18161 14.6284C7.21884 15.485 8.54994 16 10 16C13.3137 16 16 13.3137 16 10C16 6.68629 13.3137 4 10 4C6.68629 4 4 6.68629 4 10V10.2929L3.99957 10.2925L3.99508 10.288L3.99058 10.2835L3.98607 10.279L3.98157 10.2745L3.97706 10.27L3.97255 10.2654L3.96804 10.2609L3.96352 10.2564L3.95901 10.2519L3.95449 10.2474L3.94997 10.2429L3.94545 10.2383L3.94092 10.2338L3.9364 10.2293L3.93187 10.2248L3.92734 10.2202L3.92281 10.2157L3.91828 10.2112L3.91374 10.2066L3.90921 10.2021L3.90467 10.1976L3.90013 10.193L3.89559 10.1885L3.89105 10.1839L3.88651 10.1794L3.88197 10.1749L3.87743 10.1703L3.87288 10.1658L3.86834 10.1612L3.86379 10.1567L3.85924 10.1521L3.85469 10.1476L3.85014 10.143L3.8456 10.1385L3.84105 10.1339L3.8365 10.1294L3.83194 10.1248L3.82739 10.1203L3.82284 10.1157L3.81829 10.1112L3.81374 10.1066L3.80919 10.1021L3.80463 10.0975L3.80008 10.093L3.79553 10.0884L3.79098 10.0839L3.78643 10.0793L3.78187 10.0748L3.77732 10.0702L3.77277 10.0657L3.76822 10.0611L3.76367 10.0566L3.75912 10.052L3.75457 10.0475L3.75002 10.0429L3.74547 10.0384L3.74092 10.0338L3.73638 10.0293L3.73183 10.0247L3.72729 10.0202L3.72274 10.0156L3.7182 10.0111L3.71366 10.0066L3.70912 10.002L3.70458 9.99747L3.70004 9.99293L3.6955 9.9884L3.69097 9.98386L3.68643 9.97932L3.6819 9.97479L3.67737 9.97026L3.67284 9.96573L3.66831 9.9612L3.66378 9.95668L3.65926 9.95215L3.65474 9.94763L3.65021 9.94311L3.6457 9.93859L3.64118 9.93407L3.63666 9.92956L3.63215 9.92504L3.62764 9.92053L3.62313 9.91602L3.61862 9.91152L3.61412 9.90701L3.60962 9.90251L3.60512 9.89801L3.60062 9.89352L3.59613 9.88902L3.59164 9.88453L3.58715 9.88004L3.58266 9.87556L3.57818 9.87107L3.5737 9.86659L3.56922 9.86212L3.56475 9.85764L3.56028 9.85317L3.55581 9.8487L3.55134 9.84424L3.54688 9.83978L3.54242 9.83532L3.53797 9.83086L3.53352 9.82641L3.52907 9.82196L3.52462 9.81752L3.52018 9.81308L3.51575 9.80864L3.51131 9.8042L3.50688 9.79977L3.50245 9.79535L3.49803 9.79093L3.49361 9.78651L3.4892 9.78209L3.48479 9.77768L3.48038 9.77327L3.47598 9.76887L3.47158 9.76447L3.46719 9.76008L3.4628 9.75569L3.45841 9.75131L3.45403 9.74692L3.44965 9.74255L3.44528 9.73818L3.44092 9.73381L3.43655 9.72945L3.4322 9.72509L3.42784 9.72074L3.42349 9.71639L3.41915 9.71204L3.41481 9.70771L3.41048 9.70337L3.40615 9.69904L3.40183 9.69472L3.39751 9.6904L3.3932 9.68609L3.38889 9.68178L3.38459 9.67748L3.38029 9.67318L3.376 9.66889L3.37171 9.66461L3.36743 9.66033L3.36316 9.65605L3.35889 9.65178L3.35463 9.64752L3.35037 9.64326L3.34612 9.63901L3.34188 9.63477L3.33764 9.63053L3.3334 9.6263L3.32918 9.62207L3.32496 9.61785L3.32074 9.61363L3.31653 9.60943L3.31233 9.60522L3.30814 9.60103L3.30395 9.59684L3.29976 9.59266L3.29559 9.58848L3.29142 9.58431L3.28726 9.58015L3.2831 9.57599L3.27895 9.57184L3.27481 9.5677L3.27067 9.56357L3.26655 9.55944L3.26242 9.55532L3.25831 9.5512L3.2542 9.5471L3.2501 9.543L3.24601 9.5389L3.24193 9.53482L3.23785 9.53074L3.23378 9.52667L3.22972 9.52261L3.22566 9.51855L3.22161 9.51451L3.21757 9.51047L3.21354 9.50643L3.20952 9.50241L3.2055 9.49839L3.20149 9.49439L3.19749 9.49039L3.1935 9.48639L3.18952 9.48241L3.18554 9.47843L3.18157 9.47446L3.17761 9.4705L3.17366 9.46655L3.16972 9.46261L3.16578 9.45868L3.16186 9.45475L3.15794 9.45083L3.15403 9.44692L3.15013 9.44302L3.14624 9.43913L3.14236 9.43525L3.13848 9.43138L3.13462 9.42751L3.13076 9.42365L3.12691 9.41981L3.12308 9.41597L3.11925 9.41214L3.11543 9.40832L3.11162 9.40451L3.10782 9.40071L3.10403 9.39692L3.10024 9.39314L3.09647 9.38936L3.09271 9.3856L3.08895 9.38185L3.08521 9.3781L3.08148 9.37437L3.07775 9.37065L3.07404 9.36693L3.07033 9.36323L3.06664 9.35953L3.06295 9.35585L3.05928 9.35217L3.05562 9.34851L3.05196 9.34485L3.04832 9.34121L3.04468 9.33758L3.04106 9.33395L3.03745 9.33034L3.03385 9.32674L3.03025 9.32315L3.02667 9.31957L3.0231 9.316L3.01954 9.31244L3.01599 9.30889L3.01245 9.30535L3.00893 9.30182L3.00541 9.2983L3.00191 9.2948L2.99841 9.2913L2.99493 9.28782L2.99146 9.28435L2.988 9.28089L2.98455 9.27744L2.98111 9.274L2.97768 9.27057L2.97427 9.26716L2.97086 9.26375L2.96747 9.26036L2.96409 9.25698L2.96072 9.25361L2.95736 9.25026L2.95402 9.24691L2.95068 9.24358L2.94736 9.24026L2.94405 9.23695L2.94076 9.23365L2.93747 9.23036L2.9342 9.22709L2.93094 9.22383L2.92769 9.22058L2.92445 9.21734L2.92123 9.21412L2.91802 9.21091L2.91482 9.20771L2.91163 9.20452L2.90846 9.20135L2.90529 9.19819L2.90215 9.19504L2.89901 9.1919L2.89589 9.18878L2.89278 9.18567L2.88968 9.18257L2.8866 9.17949L2.88353 9.17642L2.88047 9.17336L2.87743 9.17032L2.87439 9.16729L2.87138 9.16427L2.86837 9.16127L2.86538 9.15827L2.8624 9.1553L2.85944 9.15233L2.85649 9.14938L2.85355 9.14645C2.65829 8.95118 2.34171 8.95118 2.14645 9.14645C1.95118 9.34171 1.95118 9.65829 2.14645 9.85355L2.14938 9.85649L2.15233 9.85944L2.1553 9.8624L2.15827 9.86538L2.16127 9.86837L2.16427 9.87138L2.16729 9.87439L2.17032 9.87743L2.17336 9.88047L2.17642 9.88353L2.17949 9.8866L2.18257 9.88968L2.18567 9.89278L2.18878 9.89589L2.1919 9.89901L2.19504 9.90215L2.19819 9.90529L2.20135 9.90846L2.20452 9.91163L2.20771 9.91482L2.21091 9.91802L2.21412 9.92123L2.21734 9.92445L2.22058 9.92769L2.22383 9.93094L2.22709 9.9342L2.23036 9.93747L2.23365 9.94076L2.23695 9.94405L2.24026 9.94736L2.24358 9.95068L2.24691 9.95402L2.25026 9.95736L2.25361 9.96072L2.25698 9.96409L2.26036 9.96747L2.26375 9.97086L2.26716 9.97427L2.27057 9.97768L2.274 9.98111L2.27744 9.98455L2.28089 9.988L2.28435 9.99146L2.28782 9.99493L2.2913 9.99841L2.2948 10.0019L2.2983 10.0054L2.30182 10.0089L2.30535 10.0125L2.30889 10.016L2.31244 10.0195L2.316 10.0231L2.31957 10.0267L2.32315 10.0303L2.32674 10.0338L2.33034 10.0374L2.33395 10.0411L2.33758 10.0447L2.34121 10.0483L2.34485 10.052L2.34851 10.0556L2.35217 10.0593L2.35585 10.063L2.35953 10.0666L2.36323 10.0703L2.36693 10.074L2.37065 10.0778L2.37437 10.0815L2.3781 10.0852L2.38185 10.089L2.3856 10.0927L2.38936 10.0965L2.39314 10.1002L2.39692 10.104L2.40071 10.1078L2.40451 10.1116L2.40832 10.1154L2.41214 10.1192L2.41597 10.1231L2.41981 10.1269L2.42365 10.1308L2.42751 10.1346L2.43138 10.1385L2.43525 10.1424L2.43913 10.1462L2.44302 10.1501L2.44692 10.154L2.45083 10.1579L2.45475 10.1619L2.45868 10.1658L2.46261 10.1697L2.46655 10.1737L2.4705 10.1776L2.47446 10.1816L2.47843 10.1855L2.48241 10.1895L2.48639 10.1935L2.49039 10.1975L2.49439 10.2015L2.49839 10.2055L2.50241 10.2095L2.50643 10.2135L2.51047 10.2176L2.51451 10.2216L2.51855 10.2257L2.52261 10.2297L2.52667 10.2338L2.53074 10.2378L2.53482 10.2419L2.5389 10.246L2.543 10.2501L2.5471 10.2542L2.5512 10.2583L2.55532 10.2624L2.55944 10.2665L2.56357 10.2707L2.5677 10.2748L2.57184 10.279L2.57599 10.2831L2.58015 10.2873L2.58431 10.2914L2.58848 10.2956L2.59266 10.2998L2.59684 10.3039L2.60103 10.3081L2.60522 10.3123L2.60943 10.3165L2.61363 10.3207L2.61785 10.325L2.62207 10.3292L2.6263 10.3334L2.63053 10.3376L2.63477 10.3419L2.63901 10.3461L2.64326 10.3504L2.64752 10.3546L2.65178 10.3589L2.65605 10.3632L2.66033 10.3674L2.66461 10.3717L2.66889 10.376L2.67318 10.3803L2.67748 10.3846L2.68178 10.3889L2.68609 10.3932L2.6904 10.3975L2.69472 10.4018L2.69904 10.4062L2.70337 10.4105L2.70771 10.4148L2.71204 10.4192L2.71639 10.4235L2.72074 10.4278L2.72509 10.4322L2.72945 10.4366L2.73381 10.4409L2.73818 10.4453L2.74255 10.4497L2.74692 10.454L2.7513 10.4584L2.75569 10.4628L2.76008 10.4672L2.76447 10.4716L2.76887 10.476L2.77327 10.4804L2.77768 10.4848L2.78209 10.4892L2.78651 10.4936L2.79093 10.498L2.79535 10.5025L2.79977 10.5069L2.8042 10.5113L2.80864 10.5157L2.81308 10.5202L2.81752 10.5246L2.82196 10.5291L2.82641 10.5335L2.83086 10.538L2.83532 10.5424L2.83978 10.5469L2.84424 10.5513L2.8487 10.5558L2.85317 10.5603L2.85764 10.5647L2.86212 10.5692L2.86659 10.5737L2.87107 10.5782L2.87556 10.5827L2.88004 10.5871L2.88453 10.5916L2.88902 10.5961L2.89352 10.6006L2.89801 10.6051L2.90251 10.6096L2.90701 10.6141L2.91152 10.6186L2.91602 10.6231L2.92053 10.6276L2.92504 10.6322L2.92956 10.6367L2.93407 10.6412L2.93859 10.6457L2.94311 10.6502L2.94763 10.6547L2.95215 10.6593L2.95668 10.6638L2.9612 10.6683L2.96573 10.6728L2.97026 10.6774L2.97479 10.6819L2.97932 10.6864L2.98386 10.691L2.98839 10.6955L2.99293 10.7L2.99747 10.7046L3.00201 10.7091L3.00655 10.7137L3.01109 10.7182L3.01564 10.7227L3.02018 10.7273L3.02473 10.7318L3.02927 10.7364L3.03382 10.7409L3.03837 10.7455L3.04291 10.75L3.04746 10.7546L3.05201 10.7591L3.05656 10.7637L3.06111 10.7682L3.06566 10.7728L3.07021 10.7773L3.07477 10.7819L3.07932 10.7864L3.08387 10.791L3.08842 10.7955L3.09297 10.8001L3.09753 10.8046L3.10208 10.8092L3.10663 10.8137L3.11118 10.8183L3.11574 10.8228L3.12029 10.8274L3.12484 10.8319L3.12939 10.8365L3.13394 10.841L3.13849 10.8456L3.14304 10.8501L3.14759 10.8547L3.15213 10.8592L3.15668 10.8638L3.16123 10.8683L3.16577 10.8729L3.17032 10.8774L3.17486 10.882L3.1794 10.8865L3.18395 10.8911L3.18849 10.8956L3.19303 10.9001L3.19756 10.9047L3.2021 10.9092L3.20664 10.9137L3.21117 10.9183L3.2157 10.9228L3.22023 10.9273L3.22476 10.9319L3.22929 10.9364L3.23382 10.9409L3.23834 10.9454L3.24286 10.95L3.24738 10.9545L3.2519 10.959L3.25642 10.9635L3.26093 10.968L3.26544 10.9725L3.26995 10.9771L3.27446 10.9816L3.27897 10.9861L3.28347 10.9906L3.28797 10.9951L3.29247 10.9996L3.29696 11.0041L3.30146 11.0086L3.30595 11.0131L3.31043 11.0175L3.31492 11.022L3.3194 11.0265L3.32388 11.031L3.32836 11.0355L3.33283 11.0399L3.3373 11.0444L3.34177 11.0489L3.34623 11.0533L3.35069 11.0578L3.35515 11.0623L3.3596 11.0667L3.36405 11.0712L3.3685 11.0756L3.37294 11.08L3.37738 11.0845L3.38182 11.0889L3.38625 11.0934L3.39068 11.0978L3.3951 11.1022L3.39953 11.1066L3.40394 11.111L3.40836 11.1155L3.41277 11.1199L3.41717 11.1243L3.42157 11.1287L3.42597 11.1331L3.43036 11.1375L3.43475 11.1419L3.43913 11.1462L3.44351 11.1506L3.44789 11.155L3.45226 11.1594L3.45662 11.1637L3.46098 11.1681L3.46534 11.1724L3.46969 11.1768L3.47404 11.1811L3.47838 11.1855L3.48271 11.1898L3.48704 11.1942L3.49137 11.1985L3.49569 11.2028L3.50001 11.2071L3.50432 11.2114L3.50862 11.2157L3.51292 11.22L3.51722 11.2243L3.52151 11.2286L3.52579 11.2329L3.53007 11.2372L3.53434 11.2414L3.53861 11.2457L3.54287 11.25L3.54712 11.2542L3.55137 11.2585L3.55561 11.2627L3.55985 11.267L3.56408 11.2712L3.56831 11.2754L3.57252 11.2796L3.57674 11.2838L3.58094 11.288L3.58514 11.2922L3.58933 11.2964L3.59352 11.3006L3.5977 11.3048L3.60187 11.309L3.60604 11.3131L3.6102 11.3173L3.61435 11.3215L3.6185 11.3256L3.62264 11.3297L3.62677 11.3339L3.6309 11.338L3.63502 11.3421L3.63913 11.3462L3.64323 11.3503L3.64733 11.3544L3.65142 11.3585L3.6555 11.3626L3.65958 11.3667L3.66364 11.3707L3.6677 11.3748L3.67175 11.3789L3.6758 11.3829L3.67984 11.3869L3.68387 11.391L3.68789 11.395L3.6919 11.399L3.6959 11.403L3.6999 11.407L3.70389 11.411L3.70787 11.415L3.71185 11.419L3.71581 11.4229L3.71977 11.4269L3.72372 11.4308L3.72765 11.4348L3.73159 11.4387L3.73551 11.4426L3.73942 11.4465L3.74333 11.4504L3.74723 11.4543L3.75111 11.4582L3.75499 11.4621L3.75886 11.466L3.76272 11.4698L3.76658 11.4737L3.77042 11.4775L3.77425 11.4814L3.77808 11.4852L3.7819 11.489L3.7857 11.4928L3.7895 11.4966L3.79329 11.5004L3.79707 11.5042L3.80083 11.5079L3.80459 11.5117L3.80834 11.5155L3.81208 11.5192L3.81581 11.5229L3.81953 11.5266L3.82325 11.5304L3.82695 11.5341L3.83064 11.5377L3.83432 11.5414L3.83799 11.5451L3.84165 11.5488L3.8453 11.5524L3.84894 11.556L3.85257 11.5597L3.85619 11.5633L3.8598 11.5669L3.86339 11.5705L3.86698 11.5741L3.87056 11.5777L3.87413 11.5812L3.87768 11.5848L3.88123 11.5883L3.88476 11.5919L3.88828 11.5954L3.8918 11.5989L3.8953 11.6024L3.89879 11.6059L3.90227 11.6094L3.90573 11.6128L3.90919 11.6163L3.91264 11.6197L3.91607 11.6232L3.91949 11.6266L3.9229 11.63L3.9263 11.6334L3.92969 11.6368L3.93307 11.6402L3.93643 11.6435L3.93978 11.6469L3.94312 11.6502L3.94645 11.6536L3.94977 11.6569L3.95307 11.6602L3.95637 11.6635L3.95965 11.6668L3.96292 11.67L3.96617 11.6733L3.96942 11.6765L3.97265 11.6798L3.97587 11.683L3.97907 11.6862L3.98227 11.6894L3.98545 11.6926L3.98862 11.6957L3.99178 11.6989L3.99492 11.702L3.99805 11.7052L4.00117 11.7083L4.00427 11.7114L4.00736 11.7145L4.01044 11.7175L4.01351 11.7206L4.01656 11.7237L4.0196 11.7267L4.02263 11.7297L4.02564 11.7327L4.02864 11.7357L4.03162 11.7387L4.0346 11.7417L4.03755 11.7447L4.0405 11.7476L4.04343 11.7505L4.04635 11.7535L4.04925 11.7564L4.05214 11.7592L4.05502 11.7621L4.05788 11.765L4.06073 11.7678L4.06356 11.7707L4.06638 11.7735L4.06919 11.7763L4.07198 11.7791L4.07475 11.7819L4.07752 11.7846L4.08026 11.7874L4.083 11.7901L4.08572 11.7928L4.08842 11.7955L4.09111 11.7982L4.09378 11.8009L4.09644 11.8036L4.09909 11.8062L4.10172 11.8088L4.10434 11.8114L4.10694 11.814L4.10952 11.8166L4.11209 11.8192L4.11465 11.8218L4.11718 11.8243L4.11971 11.8268L4.12222 11.8293L4.12471 11.8318L4.12719 11.8343L4.12965 11.8368L4.1321 11.8392L4.13453 11.8416L4.13694 11.8441L4.13934 11.8465L4.14173 11.8488L4.14409 11.8512L4.14645 11.8536C4.34171 12.0488 4.65829 12.0488 4.85355 11.8536L6.85355 9.85355C7.04882 9.65829 7.04882 9.34171 6.85355 9.14645C6.65829 8.95118 6.34171 8.95118 6.14645 9.14645L5 10.2929V10Z" fill="black"/>\n</svg>\n',rotate:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M6.35355 7.35356L8.85355 4.85356L9.20711 4.50001L8.85355 4.14645L6.35355 1.64645L5.64645 2.35356L7.29289 4.00001H6.5C4.567 4.00001 3 5.56701 3 7.50001V9.00001H4V7.50001C4 6.1193 5.11929 5.00001 6.5 5.00001H7.29289L5.64645 6.64645L6.35355 7.35356ZM17 3.00002H11V9.00002H10V3.00002V2.00002H11H17H18V3.00002V14V15H17H16V14H17V3.00002ZM15 10H2V18H15V10Z" fill="black"/>\n</svg>\n',rotational_repeat:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M12 2H8V6H12V2Z" fill="black"/>\n<path d="M12 14H8V18H12V14Z" fill="black" fill-opacity="0.5"/>\n<path d="M4.07181 15.732L2.07181 12.2679L5.53591 10.2679L7.53591 13.732L4.07181 15.732Z" fill="black" fill-opacity="0.5"/>\n<path d="M12.4641 6.26794L14.4641 9.73205L17.9282 7.73205L15.9282 4.26794L12.4641 6.26794Z" fill="black" fill-opacity="0.5"/>\n<path d="M2.07178 7.73205L4.07178 4.26794L7.53588 6.26794L5.53588 9.73205L2.07178 7.73205Z" fill="black" fill-opacity="0.5"/>\n<path d="M14.4641 10.2679L12.4641 13.732L15.9282 15.732L17.9282 12.2679L14.4641 10.2679Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',round_corners:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7 3H3V4H7V3ZM16 13L16 17L17 17L17 13L16 13Z" fill="black" fill-opacity="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8 4H9.5C13.0899 4 16 6.91015 16 10.5V12H17V10.5C17 6.35786 13.6421 3 9.5 3H8V4ZM9 12C9.55228 12 10 11.5523 10 11C10 10.4477 9.55228 10 9 10C8.44772 10 8 10.4477 8 11C8 11.5523 8.44772 12 9 12Z" fill="black"/>\n</svg>\n',scale:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17 3H5V9H4V3V2H5H17H18V3V15V16H17H11V15H17V3ZM9.29289 10H2V18H10V10.7071L13 7.70711V10H14V6.5V6H13.5H10V7H12.2929L9.29289 10Z" fill="black"/>\n</svg>\n',scale_linear:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.82461 4.82462L6.78077 9H5.74999L6.99999 4L17.9005 1.27487L19 1L18.7251 2.09949L16 13L11 14.25V13.2192L15.1754 12.1754L17.6256 2.37437L7.82461 4.82462ZM9.29289 10H2V18H10V10.7071L13 7.70711V10.0355H14V6.5V6H13.5L9.96447 6V7H12.2929L9.29289 10Z" fill="black"/>\n</svg>\n',search:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12 8.5C12 10.433 10.433 12 8.5 12C6.567 12 5 10.433 5 8.5C5 6.567 6.567 5 8.5 5C10.433 5 12 6.567 12 8.5ZM11.6175 13.0317C10.7315 13.6424 9.6575 14 8.5 14C5.46243 14 3 11.5376 3 8.5C3 5.46243 5.46243 3 8.5 3C11.5376 3 14 5.46243 14 8.5C14 9.6575 13.6424 10.7315 13.0317 11.6175L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.6175 13.0317Z" fill="black"/>\n</svg>\n',select:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.5 17L3 3L17 7.5L10.5 10.5L7.5 17Z" fill="black"/>\n</svg>\n',settings:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M19 8.69999C19 8.20791 18.642 7.78897 18.156 7.71222L16.1574 7.39666L15.3332 5.96919L16.0592 4.0806C16.2358 3.62129 16.052 3.10179 15.6258 2.85576L13.3742 1.55576C12.948 1.30972 12.4062 1.41027 12.0967 1.79283L10.8241 3.36586H9.17585L7.90328 1.79283C7.59379 1.41027 7.05198 1.30972 6.62583 1.55576L4.37417 2.85576C3.94802 3.10179 3.7642 3.62129 3.94076 4.0806L4.66676 5.96919L3.84261 7.39666L1.84404 7.71222C1.35799 7.78897 1 8.20791 1 8.69999V11.3C1 11.7921 1.35799 12.211 1.84404 12.2877L3.84261 12.6033L4.66676 14.0308L3.94076 15.9194C3.7642 16.3787 3.94802 16.8982 4.37417 17.1442L6.62583 18.4442C7.05198 18.6903 7.59379 18.5897 7.90328 18.2071L9.17585 16.6341H10.8241L12.0967 18.2071C12.4062 18.5897 12.948 18.6903 13.3742 18.4442L15.6258 17.1442C16.052 16.8982 16.2358 16.3787 16.0592 15.9194L15.3332 14.0308L16.1574 12.6033L18.156 12.2877C18.642 12.211 19 11.7921 19 11.3V8.69999ZM15.1258 3.72178L14.2286 6.05586L15.53 8.30999L18 8.69999V11.3L15.53 11.69L14.2286 13.9441L15.1258 16.2782L12.8742 17.5782L11.3014 15.6341H8.69858L7.12583 17.5782L4.87417 16.2782L5.77142 13.9441L4.47 11.69L2 11.3V8.69999L4.47 8.30999L5.77142 6.05586L4.87417 3.72178L7.12583 2.42178L8.69858 4.36586H11.3014L12.8742 2.42178L15.1258 3.72178ZM13 10C13 11.6569 11.6569 13 10 13C8.34315 13 7 11.6569 7 10C7 8.34314 8.34315 7 10 7C11.6569 7 13 8.34314 13 10ZM14 10C14 12.2091 12.2091 14 10 14C7.79086 14 6 12.2091 6 10C6 7.79086 7.79086 6 10 6C12.2091 6 14 7.79086 14 10Z" fill="black"/>\n</svg>\n',share_private:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.75 7C7.75 5.75736 8.75736 4.75 10 4.75C11.2426 4.75 12.25 5.75736 12.25 7V9H7.75V7ZM6.25 9V7C6.25 4.92893 7.92893 3.25 10 3.25C12.0711 3.25 13.75 4.92893 13.75 7V9H14C15.1046 9 16 9.89543 16 11V15C16 16.1046 15.1046 17 14 17H6C4.89543 17 4 16.1046 4 15V11C4 9.89543 4.89543 9 6 9H6.25Z" fill="black"/>\n</svg>\n',share_public:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g clip-path="url(#clip0_1912_328)">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M9.50004 18.0003L9.51165 18C9.96745 17.9894 10.273 17.9725 10.4282 17.9493C10.4679 17.9433 10.5046 17.939 10.5383 17.9361L10.5485 17.9352L10.5587 17.9339C10.7028 17.9158 10.8468 17.8939 10.9906 17.8684C11.1923 17.8323 11.3927 17.7891 11.5918 17.7387C11.8695 17.6678 12.1433 17.5833 12.4134 17.4853C12.7858 17.3486 13.1477 17.1871 13.499 17.0007C13.973 16.7463 14.4204 16.4501 14.8413 16.1123C15.3864 15.6683 15.8721 15.1649 16.2986 14.6021C16.6038 14.1901 16.8619 13.7772 17.0729 13.3635C17.2293 13.0569 17.3758 12.7147 17.5126 12.3371C17.7065 11.7734 17.8407 11.2321 17.9154 10.7132C17.9664 10.3586 17.9946 9.95627 18 9.50613L18.0001 9.50014L18 9.49414C17.9946 9.044 17.9664 8.64163 17.9154 8.28704C17.8407 7.76814 17.7074 7.22943 17.5153 6.67091C17.3767 6.28811 17.2293 5.94341 17.0729 5.63682C16.8619 5.22307 16.6049 4.81163 16.3018 4.40252C15.8732 3.83685 15.3873 3.33277 14.8442 2.89027C14.4214 2.5509 13.9737 2.2544 13.5012 2.00076C13.1484 1.81359 12.7863 1.65187 12.415 1.5156C12.1439 1.41712 11.8699 1.33253 11.593 1.26183C11.393 1.21129 11.1925 1.16801 10.9914 1.132C10.8471 1.10639 10.7028 1.0845 10.5587 1.06632L10.5485 1.06504L10.5383 1.06417C10.5046 1.06132 10.4679 1.05693 10.4282 1.05099C10.273 1.02777 9.96746 1.01086 9.51165 1.00027L9.50004 1L9.48842 1.00027C9.03261 1.01086 8.72709 1.02777 8.57186 1.05099C8.53217 1.05693 8.49547 1.06132 8.46176 1.06417L8.45154 1.06504L8.44136 1.06632C8.29723 1.0845 8.15326 1.10634 8.00946 1.13185C7.8078 1.16797 7.6074 1.2112 7.40826 1.26154C7.1306 1.33243 6.85672 1.41693 6.58664 1.51502C6.2143 1.65168 5.85243 1.81321 5.50103 1.99961C5.02706 2.25401 4.57962 2.55014 4.15873 2.88799C3.61369 3.33201 3.12795 3.8354 2.70152 4.39816C2.39629 4.81019 2.13818 5.22307 1.92718 5.63682C1.77082 5.94341 1.62425 6.28554 1.48745 6.66318C1.29362 7.22686 1.15936 7.76815 1.0847 8.28704C1.03367 8.64163 1.00547 9.044 1.00007 9.49414L1 9.50014L1.00007 9.50613C1.00547 9.95628 1.03367 10.3586 1.0847 10.7132C1.15936 11.2321 1.29271 11.7708 1.48473 12.3294C1.62334 12.7122 1.77082 13.0569 1.92718 13.3635C2.13818 13.7772 2.3952 14.1886 2.69826 14.5978C3.12686 15.1634 3.61275 15.6675 4.15592 16.11C4.57869 16.4494 5.02634 16.7459 5.49886 16.9995C5.8517 17.1867 6.21376 17.3484 6.58504 17.4847C6.85619 17.5832 7.13022 17.6677 7.40711 17.7384C7.60701 17.789 7.80752 17.8323 8.00864 17.8683C8.15299 17.8939 8.29723 17.9158 8.44135 17.9339L8.45154 17.9352L8.46176 17.9361C8.49546 17.939 8.53217 17.9433 8.57187 17.9493C8.7271 17.9725 9.03262 17.9894 9.48842 18L9.50004 18.0003ZM5.01365 9.00014C5.04548 8.36409 5.13258 7.73506 5.27498 7.11306C5.34791 6.80568 5.4336 6.50296 5.53204 6.20492C4.72323 6.04561 3.91442 5.83759 3.10561 5.58086C3.00077 5.75066 2.90491 5.92074 2.81802 6.09113C2.68048 6.36083 2.55036 6.66504 2.42767 7.00375C2.25793 7.49763 2.14021 7.97286 2.0745 8.42947C2.0493 8.60464 2.03041 8.79486 2.01785 9.00014H5.01365ZM3.71917 4.72402C4.44564 4.94305 5.17114 5.12094 5.89567 5.25769C6.06497 4.87648 6.25499 4.50702 6.46572 4.14933C6.65105 3.83781 6.8508 3.53709 7.06497 3.24717C7.22888 3.0267 7.40044 2.81326 7.57964 2.60686C7.71423 2.45252 7.85274 2.30244 7.99518 2.15662L7.9999 2.15181C7.88415 2.17549 7.76864 2.20189 7.65335 2.23104C7.40903 2.29342 7.16724 2.36806 6.928 2.45495C6.6004 2.5752 6.28094 2.71788 5.96963 2.88302C5.55267 3.10683 5.1577 3.36843 4.78471 3.66783C4.39632 3.98425 4.04114 4.33632 3.71917 4.72402ZM6.52948 6.37669C6.41987 6.69247 6.32604 7.01488 6.24796 7.34393C6.12333 7.8884 6.04567 8.44047 6.01497 9.00014H9.00004V6.5895C8.17652 6.56906 7.353 6.49812 6.52948 6.37669ZM9.00004 5.59201C8.30756 5.57378 7.61418 5.51767 6.91991 5.42369C7.04428 5.16242 7.17935 4.90806 7.32513 4.66062C7.49348 4.37764 7.67427 4.10537 7.86748 3.84381C8.01634 3.64358 8.17162 3.45035 8.33332 3.2641C8.45552 3.12397 8.5809 2.9881 8.70944 2.8565C8.80302 2.761 8.89816 2.66776 8.99486 2.5768C8.99658 2.57529 8.99831 2.57377 9.00004 2.57225V5.59201ZM13.9864 9.00014C13.9546 8.36409 13.8675 7.73507 13.7251 7.11306C13.6522 6.80568 13.5665 6.50296 13.468 6.20492C14.2768 6.04562 15.0856 5.83761 15.8944 5.5809C15.9994 5.751 16.0953 5.92107 16.1821 6.09113C16.3196 6.36084 16.4488 6.66247 16.5697 6.99603C16.7412 7.49505 16.8599 7.97286 16.9256 8.42947C16.9508 8.60464 16.9697 8.79486 16.9822 9.00014H13.9864ZM15.2811 4.72397C14.9596 4.3368 14.6034 3.984 14.2125 3.66556C13.8414 3.36767 13.4467 3.10644 13.0283 2.88186C12.7184 2.7175 12.3991 2.575 12.0705 2.45437C11.8323 2.36787 11.5907 2.29333 11.3456 2.23075C11.2309 2.20177 11.1158 2.17546 11.0002 2.15182L11.0049 2.15662C11.1473 2.30243 11.2858 2.45251 11.4204 2.60686C11.5996 2.81326 11.7712 3.0267 11.9351 3.24717C12.1493 3.53709 12.349 3.83781 12.5344 4.14933C12.7451 4.50702 12.9351 4.87647 13.1044 5.25769C13.829 5.12093 14.5545 4.94302 15.2811 4.72397ZM12.0802 5.42369C11.9558 5.16242 11.8207 4.90806 11.6749 4.66062C11.5066 4.37764 11.3258 4.10537 11.1326 3.84381C10.9837 3.64358 10.8285 3.45035 10.6668 3.2641C10.5446 3.12397 10.4192 2.9881 10.2906 2.8565C10.197 2.76099 10.1019 2.66776 10.0052 2.5768C10.0035 2.57527 10.0017 2.57376 10 2.57225V5.59201C10.6925 5.57378 11.3859 5.51767 12.0802 5.42369ZM10 6.5895V9.00014H12.9851C12.9544 8.44047 12.8767 7.88841 12.7521 7.34393C12.674 7.01488 12.5802 6.69247 12.4706 6.37669C11.6471 6.49812 10.8236 6.56906 10 6.5895ZM5.01377 10.0001C5.04563 10.6367 5.1324 11.2644 5.27408 11.8833C5.34746 12.1926 5.43345 12.4966 5.53205 12.7953C4.72327 12.9547 3.91449 13.1627 3.10571 13.4194C3.00064 13.2493 2.90474 13.0792 2.81802 12.9091C2.68048 12.6394 2.55127 12.3378 2.4304 12.0042C2.25884 11.5052 2.14021 11.0274 2.0745 10.5708C2.0493 10.3956 2.03041 10.2054 2.01785 10.0001H5.01377ZM6.52949 12.6236C7.35301 12.5021 8.17652 12.4312 9.00004 12.4108V10.0001H6.01485C6.04554 10.5594 6.12354 11.1128 6.24886 11.6602C6.32644 11.9871 6.41998 12.3082 6.52949 12.6236ZM12.9852 10.0001H10V12.4108C10.8236 12.4312 11.6471 12.5021 12.4706 12.6236C12.5801 12.3082 12.6736 11.9871 12.7512 11.6602C12.8765 11.1127 12.9545 10.5594 12.9852 10.0001ZM16.1821 12.9091C16.0952 13.0795 15.9993 13.2496 15.8945 13.4194C15.0857 13.1627 14.2768 12.9547 13.468 12.7953C13.5666 12.4966 13.6526 12.1926 13.726 11.8833C13.8677 11.2644 13.9544 10.6367 13.9863 10.0001H16.9822C16.9697 10.2054 16.9508 10.3956 16.9256 10.5708C16.8599 11.0274 16.7421 11.5027 16.5724 11.9965C16.4497 12.3352 16.3196 12.6394 16.1821 12.9091ZM9.00004 13.4083C8.30755 13.4265 7.61416 13.4826 6.91987 13.5766C7.04423 13.8378 7.17968 14.0928 7.32622 14.3415C7.49385 14.6233 7.67457 14.8953 7.8684 15.1577C8.01664 15.3571 8.17185 15.5502 8.33403 15.737C8.45576 15.8766 8.58108 16.0124 8.70999 16.1443C8.8032 16.2395 8.89816 16.3325 8.99484 16.4235C8.99652 16.4249 8.99825 16.4264 9.00004 16.428V13.4083ZM10 16.428V13.4083C10.6925 13.4265 11.3859 13.4826 12.0802 13.5766C11.9558 13.8378 11.8204 14.0928 11.6738 14.3415C11.5062 14.6232 11.3255 14.8953 11.1317 15.1577C10.9834 15.3571 10.8282 15.5502 10.666 15.737C10.5443 15.8766 10.419 16.0124 10.2901 16.1443C10.1969 16.2395 10.1019 16.3325 10.0052 16.4235C10.0036 16.4249 10.0019 16.4264 10 16.428ZM3.71901 14.2763C4.44555 14.0572 5.17111 13.8793 5.89571 13.7426C6.06529 14.1243 6.25493 14.4932 6.46463 14.8491C6.65069 15.1618 6.8505 15.4628 7.06405 15.7519C7.22857 15.9732 7.4002 16.1867 7.57892 16.3926C7.71397 16.5475 7.85255 16.6976 7.99464 16.8431L7.9999 16.8485C7.88425 16.8248 7.76912 16.7985 7.6545 16.7695C7.40942 16.7069 7.16778 16.6324 6.9296 16.5459C6.60093 16.4253 6.28166 16.2828 5.9718 16.1184C5.5534 15.8938 5.15864 15.6326 4.78752 15.3347C4.39663 15.0163 4.04046 14.6635 3.71901 14.2763ZM12.5354 14.8491C12.7451 14.4932 12.9348 14.1243 13.1044 13.7426C13.8289 13.8793 14.5544 14.0572 15.2809 14.2763C14.9589 14.664 14.6038 15.016 14.2154 15.3324C13.8424 15.6318 13.4474 15.8934 13.0304 16.1173C12.7191 16.2824 12.3997 16.4251 12.0721 16.5453C11.8328 16.6322 11.591 16.7068 11.3467 16.7692C11.2314 16.7984 11.1159 16.8248 11.0002 16.8485L11.0054 16.8431C11.1475 16.6976 11.2861 16.5475 11.4212 16.3926C11.5999 16.1867 11.7715 15.9732 11.936 15.7519C12.1496 15.4628 12.3494 15.1619 12.5354 14.8491Z" fill="black"/>\n</g>\n<defs>\n<clipPath id="clip0_1912_328">\n<rect width="17.0001" height="17.0003" fill="white" transform="translate(1 1)"/>\n</clipPath>\n</defs>\n</svg>\n',share_unlisted:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M9.2071 10.7929C9.56393 11.1497 10.0007 11.378 10.4597 11.4776C10.3871 11.7 10.2625 11.909 10.0858 12.0858L9.06712 13.1044C8.60604 12.8873 8.17399 12.5882 7.79288 12.2071L7.79289 12.2071C6.02167 10.4358 6.02167 7.56411 7.7929 5.79288L10.2929 3.29288C12.0641 1.52164 14.9359 1.52164 16.7071 3.29287L16.7071 3.29289C18.4783 5.06412 18.4783 7.93586 16.7071 9.70709L14.4517 11.9625C14.6064 11.0815 14.547 10.1702 14.2733 9.3125L15.2929 8.29288C16.2831 7.30269 16.2831 5.69728 15.2929 4.70709L15.2929 4.70708C14.3027 3.7169 12.6973 3.7169 11.7071 4.70709L9.20712 7.20709C8.21693 8.19728 8.21693 9.80269 9.20712 10.7929L9.2071 10.7929ZM5.54831 8.03747L3.29288 10.2929C1.52164 12.0641 1.52164 14.9359 3.29287 16.7071C5.0641 18.4783 7.93584 18.4784 9.70708 16.7071L12.2071 14.2071C13.9783 12.4359 13.9783 9.56413 12.2071 7.7929C11.826 7.41178 11.3939 7.11268 10.9328 6.89557L9.91422 7.91419C9.73749 8.09092 9.61285 8.30001 9.54029 8.52239C9.99933 8.62204 10.4361 8.85028 10.7929 9.20711C11.7831 10.1973 11.7831 11.8027 10.7929 12.7929L8.29287 15.2929C7.30268 16.2831 5.69727 16.2831 4.70709 15.2929C3.7169 14.3027 3.7169 12.6973 4.70709 11.7071L5.72674 10.6875C5.45304 9.82973 5.39356 8.91847 5.54831 8.03747Z" fill="black"/>\n</svg>\n',show_guides:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7 3.5V3H6V3.5V6H3.5H3V7H3.5H6V13H3.5H3V14H3.5H6V16.5V17H7V16.5V14H13V16.5V17H14V16.5V14H16.5H17V13H16.5H14V7H16.5H17V6H16.5H14V3.5V3H13V3.5V6H7V3.5ZM7 7V13H13V7H7Z" fill="black"/>\n</svg>\n',split_text:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M18 15H2V14H18V15ZM16.2979 7C16.5856 7.00002 16.8734 7.03826 17.1611 7.11426C17.4543 7.18485 17.734 7.28236 18 7.40723L17.6006 8.40918C17.3836 8.3061 17.1638 8.2166 16.9414 8.14062C16.7243 8.06463 16.5095 8.0264 16.2979 8.02637C16.0644 8.02637 15.8546 8.07272 15.6699 8.16504C15.491 8.25733 15.3386 8.38991 15.2139 8.56348C15.089 8.73177 14.9939 8.93835 14.9287 9.18262C14.869 9.42698 14.8398 9.70177 14.8398 10.0059C14.8399 10.4184 14.8886 10.7713 14.9863 11.0645C15.0895 11.3523 15.2496 11.5726 15.4668 11.7246C15.684 11.8766 15.9613 11.9521 16.2979 11.9521C16.5366 11.9521 16.7726 11.9253 17.0059 11.8711C17.2448 11.8168 17.5033 11.7403 17.7803 11.6426V12.6777C17.5251 12.7809 17.2723 12.8564 17.0225 12.9053C16.7727 12.9541 16.4931 12.9785 16.1836 12.9785C15.5863 12.9785 15.0921 12.8566 14.7012 12.6123C14.3156 12.3625 14.0303 12.0146 13.8457 11.5693C13.6611 11.1187 13.5693 10.5943 13.5693 9.99707C13.5694 9.5574 13.6286 9.1557 13.748 8.79199C13.8675 8.42273 14.0415 8.10495 14.2695 7.83887C14.503 7.57285 14.7884 7.36632 15.125 7.21973C15.467 7.07321 15.8582 7 16.2979 7ZM7.62012 12.8975H6.29297L5.86914 11.5127H3.75098L3.32812 12.8975H2L4.05273 7.05664H5.55957L7.62012 12.8975ZM10.165 7.08105C10.6808 7.08105 11.1125 7.13081 11.46 7.22852C11.8128 7.3208 12.0762 7.47528 12.25 7.69238C12.4292 7.90414 12.5195 8.1919 12.5195 8.55566C12.5195 8.77287 12.4837 8.97119 12.4131 9.15039C12.3425 9.32954 12.2392 9.47583 12.1035 9.58984C11.9732 9.70388 11.8131 9.77797 11.623 9.81055V9.85059C11.8185 9.88858 11.9949 9.957 12.1523 10.0547C12.3098 10.1524 12.435 10.2939 12.5273 10.4785C12.6195 10.6631 12.666 10.9071 12.666 11.2109C12.666 11.5637 12.5789 11.8679 12.4053 12.123C12.2369 12.3728 11.9923 12.5664 11.6719 12.7021C11.3516 12.8324 10.971 12.8975 10.5312 12.8975H8.35645V7.08105H10.165ZM9.58691 11.8789H10.3936C10.7627 11.8789 11.0204 11.8081 11.167 11.667C11.3135 11.5204 11.3867 11.3277 11.3867 11.0889C11.3867 10.9423 11.3542 10.8146 11.2891 10.7061C11.2293 10.5976 11.1235 10.5138 10.9717 10.4541C10.8196 10.3944 10.6132 10.3643 10.3525 10.3643H9.58691V11.8789ZM4.69629 8.36816C4.65287 8.52558 4.60885 8.67766 4.56543 8.82422C4.52743 8.96536 4.49828 9.06624 4.47656 9.12598L4.06055 10.4785H5.57617L5.15234 9.12598C5.12519 9.03366 5.08934 8.91658 5.0459 8.77539C5.00249 8.63432 4.95942 8.49024 4.91602 8.34375C4.8726 8.19721 4.83769 8.0695 4.81055 7.96094C4.78341 8.06949 4.74513 8.20537 4.69629 8.36816ZM9.58691 9.38672H10.3037C10.662 9.38671 10.9092 9.32979 11.0449 9.21582C11.1861 9.10179 11.2568 8.93594 11.2568 8.71875C11.2568 8.49627 11.1754 8.33605 11.0127 8.23828C10.8498 8.14054 10.5912 8.0918 10.2383 8.0918H9.58691V9.38672ZM18 6H2V5H18V6Z" fill="black"/>\n</svg>\n',star_off:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M9.99988 1C10.3805 1 10.7279 1.21631 10.8964 1.55762L13.1356 6.09473L18.1434 6.82227C18.52 6.87698 18.8333 7.1411 18.951 7.50293C19.0686 7.86487 18.9706 8.26263 18.6981 8.52832L15.0741 12.0605L15.9296 17.0479C15.9939 17.423 15.8401 17.8026 15.5321 18.0264C15.2242 18.25 14.8152 18.2787 14.4784 18.1016L9.99988 15.7471L5.52136 18.1016C5.1845 18.2786 4.77555 18.25 4.46765 18.0264C4.15977 17.8026 4.00586 17.423 4.07019 17.0479L4.92468 12.0605L1.30164 8.52832C1.02926 8.26264 0.931135 7.86483 1.04871 7.50293C1.1664 7.14113 1.47981 6.87703 1.85632 6.82227L6.86316 6.09473L9.10339 1.55762L9.17468 1.43555C9.35926 1.1656 9.6669 1.00004 9.99988 1ZM8.42468 7.45215C8.27899 7.74705 7.99726 7.95167 7.67175 7.99902L4.14832 8.50977L6.69812 10.9951C6.93378 11.2249 7.04086 11.5565 6.98523 11.8809L6.38269 15.3887L9.53406 13.7324L9.64636 13.6826C9.9121 13.5821 10.2108 13.5985 10.4657 13.7324L13.6161 15.3887L13.0145 11.8809C12.9589 11.5565 13.066 11.2248 13.3016 10.9951L15.8505 8.50977L12.328 7.99902C12.0025 7.95163 11.7207 7.74704 11.5751 7.45215L9.99988 4.25879L8.42468 7.45215Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',star_off_hover:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M9.99988 1C10.3805 1 10.7279 1.21631 10.8964 1.55762L13.1356 6.09473L18.1434 6.82227C18.52 6.87698 18.8333 7.1411 18.951 7.50293C19.0686 7.86487 18.9706 8.26263 18.6981 8.52832L15.0741 12.0605L15.9296 17.0479C15.9939 17.423 15.8401 17.8026 15.5321 18.0264C15.2242 18.25 14.8152 18.2787 14.4784 18.1016L9.99988 15.7471L5.52136 18.1016C5.1845 18.2786 4.77555 18.25 4.46765 18.0264C4.15977 17.8026 4.00586 17.423 4.07019 17.0479L4.92468 12.0605L1.30164 8.52832C1.02926 8.26264 0.931135 7.86483 1.04871 7.50293C1.1664 7.14113 1.47981 6.87703 1.85632 6.82227L6.86316 6.09473L9.10339 1.55762L9.17468 1.43555C9.35926 1.1656 9.6669 1.00004 9.99988 1ZM8.42468 7.45215C8.27899 7.74705 7.99726 7.95167 7.67175 7.99902L4.14832 8.50977L6.69812 10.9951C6.93378 11.2249 7.04086 11.5565 6.98523 11.8809L6.38269 15.3887L9.53406 13.7324L9.64636 13.6826C9.9121 13.5821 10.2108 13.5985 10.4657 13.7324L13.6161 15.3887L13.0145 11.8809C12.9589 11.5565 13.066 11.2248 13.3016 10.9951L15.8505 8.50977L12.328 7.99902C12.0025 7.95163 11.7207 7.74704 11.5751 7.45215L9.99988 4.25879L8.42468 7.45215Z" fill="black" fill-opacity="0.85"/>\n</svg>\n',star_on:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M9.99988 1C10.3805 1 10.7279 1.21631 10.8964 1.55762L13.1356 6.09473L18.1434 6.82227C18.52 6.87698 18.8333 7.1411 18.951 7.50293C19.0686 7.86487 18.9706 8.26263 18.6981 8.52832L15.0741 12.0605L15.9296 17.0479C15.9939 17.423 15.8401 17.8026 15.5321 18.0264C15.2242 18.25 14.8152 18.2787 14.4784 18.1016L9.99988 15.7471L5.52136 18.1016C5.1845 18.2786 4.77555 18.25 4.46765 18.0264C4.15977 17.8026 4.00586 17.423 4.07019 17.0479L4.92468 12.0605L1.30164 8.52832C1.02926 8.26264 0.931135 7.86483 1.04871 7.50293C1.1664 7.14113 1.47981 6.87703 1.85632 6.82227L6.86316 6.09473L9.10339 1.55762L9.17468 1.43555C9.35926 1.1656 9.6669 1.00004 9.99988 1Z" fill="#F2C45A"/>\n</svg>\n',star_on_hover:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M9.99988 1C10.3805 1 10.7279 1.21631 10.8964 1.55762L13.1356 6.09473L18.1434 6.82227C18.52 6.87698 18.8333 7.1411 18.951 7.50293C19.0686 7.86487 18.9706 8.26263 18.6981 8.52832L15.0741 12.0605L15.9296 17.0479C15.9939 17.423 15.8401 17.8026 15.5321 18.0264C15.2242 18.25 14.8152 18.2787 14.4784 18.1016L9.99988 15.7471L5.52136 18.1016C5.1845 18.2786 4.77555 18.25 4.46765 18.0264C4.15977 17.8026 4.00586 17.423 4.07019 17.0479L4.92468 12.0605L1.30164 8.52832C1.02926 8.26264 0.931135 7.86483 1.04871 7.50293C1.1664 7.14113 1.47981 6.87703 1.85632 6.82227L6.86316 6.09473L9.10339 1.55762L9.17468 1.43555C9.35926 1.1656 9.6669 1.00004 9.99988 1Z" fill="#E5A000"/>\n</svg>\n',stroke:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10ZM19 10C19 14.9706 14.9706 19 10 19C5.02944 19 1 14.9706 1 10C1 5.02944 5.02944 1 10 1C14.9706 1 19 5.02944 19 10ZM14 10C14 12.2091 12.2091 14 10 14C7.79086 14 6 12.2091 6 10C6 7.79086 7.79086 6 10 6C12.2091 6 14 7.79086 14 10ZM15 10C15 12.7614 12.7614 15 10 15C7.23858 15 5 12.7614 5 10C5 7.23858 7.23858 5 10 5C12.7614 5 15 7.23858 15 10Z" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 16C13.3137 16 16 13.3137 16 10C16 6.68629 13.3137 4 10 4C6.68629 4 4 6.68629 4 10C4 13.3137 6.68629 16 10 16ZM10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',tag:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 2.5C9.86739 2.5 9.74021 2.55268 9.64645 2.64645L1.64645 10.6464C1.45118 10.8417 1.45118 11.1583 1.64645 11.3536L8.64645 18.3536C8.84171 18.5488 9.15829 18.5488 9.35355 18.3536L17.3536 10.3536C17.4473 10.2598 17.5 10.1326 17.5 10V3C17.5 2.72386 17.2761 2.5 17 2.5H10ZM2.70711 11L10.2071 3.5H16.5V9.79289L9 17.2929L2.70711 11ZM14 7C14.5523 7 15 6.55228 15 6C15 5.44772 14.5523 5 14 5C13.4477 5 13 5.44772 13 6C13 6.55228 13.4477 7 14 7Z" fill="black"/>\n</svg>\n',text:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M3 3H3.5H9.5H15.5H16V3.5V7H15V4H10V16H13V17H9.5H6V16H9V4H4V7H3V3.5V3Z" fill="black"/>\n</svg>\n',text_along_path:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10.6204 3.81761C11.1455 3.81865 11.5561 4.02432 11.8523 4.43462C12.1485 4.84491 12.2959 5.40672 12.2944 6.12005C12.293 6.85459 12.1387 7.4231 11.8316 7.82556C11.5245 8.22802 11.1071 8.42873 10.5794 8.42767C10.057 8.42663 9.6477 8.23622 9.35146 7.85642L9.26793 7.85625L9.06409 8.3451L8.13729 8.34326L8.14962 2.15399L9.36281 2.15641L9.35994 3.59633C9.35958 3.7793 9.34308 4.07229 9.31046 4.4753L9.35819 4.47539C9.64281 4.03576 10.0636 3.8165 10.6204 3.81761ZM10.2287 4.78739C9.92903 4.78679 9.71008 4.8785 9.57182 5.06253C9.43356 5.24655 9.36135 5.5507 9.3552 5.97498L9.35494 6.10624C9.35399 6.58356 9.42425 6.92578 9.56571 7.13291C9.70716 7.34003 9.9317 7.4439 10.2393 7.44451C10.4886 7.445 10.687 7.33071 10.8347 7.10162C10.9823 6.87254 11.0565 6.53922 11.0574 6.10168C11.0583 5.66413 10.9847 5.33582 10.8366 5.11676C10.6886 4.89769 10.4859 4.7879 10.2287 4.78739ZM6.77365 8.55208L6.18914 9.16541L5.58955 8.91819L5.5676 8.94122C5.61294 9.26649 5.59705 9.54166 5.51993 9.76671C5.44282 9.99177 5.28443 10.23 5.04477 10.4815C4.75023 10.7906 4.43004 10.9497 4.08421 10.959C3.73838 10.9682 3.40229 10.8174 3.07595 10.5064C2.73425 10.1807 2.59618 9.82111 2.66174 9.42752C2.72729 9.03394 2.98103 8.58799 3.42295 8.08969L3.93804 7.51461L3.79695 7.38015C3.47061 7.06914 3.14827 7.08064 2.82995 7.41466C2.5848 7.6719 2.37441 8.04834 2.19877 8.54398L1.32843 8.2695C1.48763 7.71423 1.78219 7.21104 2.21212 6.75992C2.62374 6.328 3.03339 6.0865 3.44105 6.03543C3.84871 5.98436 4.24451 6.14177 4.62844 6.50766L6.77365 8.55208ZM4.7155 8.25554L4.45059 8.00308L4.13829 8.35383C3.90266 8.61646 3.76761 8.85042 3.73316 9.05569C3.69871 9.26096 3.76787 9.44593 3.94064 9.61058C4.18827 9.84658 4.44747 9.82252 4.71823 9.53841C4.91215 9.33493 5.00865 9.11644 5.00772 8.88295C5.0068 8.64945 4.90939 8.44032 4.7155 8.25554ZM14.8662 6.81553C13.6477 7.72336 13.452 8.73228 14.279 9.8423C14.4612 10.0868 14.6313 10.2751 14.7892 10.4072C14.9471 10.5392 15.1346 10.6466 15.3518 10.7295L16.1843 10.1093C15.9592 10.029 15.7622 9.92774 15.5934 9.80549C15.4246 9.68324 15.2705 9.52855 15.1311 9.34142C14.754 8.83532 14.9142 8.32244 15.6117 7.80277C16.3304 7.26726 16.8783 7.25256 17.2554 7.75866C17.3536 7.8905 17.4322 8.03699 17.4911 8.19815C17.55 8.3593 17.6056 8.5394 17.658 8.73845L18.6247 8.46466C18.5423 8.01678 18.3474 7.58657 18.0401 7.17403C17.6202 6.61052 17.1378 6.29701 16.5928 6.23349C16.0478 6.16998 15.4722 6.36399 14.8662 6.81553ZM13 14C13 15.6569 11.6569 17 10 17C8.34315 17 7 15.6569 7 14C7 12.3432 8.34315 11 10 11C11.6569 11 13 12.3432 13 14ZM14 14C14 16.2091 12.2091 18 10 18C7.79086 18 6 16.2091 6 14C6 11.7909 7.79086 10 10 10C12.2091 10 14 11.7909 14 14Z" fill="black"/>\n</svg>\n',text_within_box:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="2" y="3" width="16" height="14" fill="black" fill-opacity="0.3"/>\n<path d="M5.22183 8.4835C5.81647 8.4835 6.27055 8.61324 6.58408 8.87272C6.90302 9.12679 7.06249 9.51871 7.06249 10.0485V13H6.21919L5.98404 12.4H5.95161C5.82728 12.5567 5.69754 12.6865 5.56239 12.7892C5.43266 12.8919 5.2813 12.9649 5.10831 13.0081C4.94073 13.0568 4.73261 13.0811 4.48395 13.0811C4.22447 13.0811 3.98932 13.0324 3.77849 12.9351C3.57308 12.8324 3.4109 12.6784 3.29198 12.473C3.17305 12.2621 3.11359 11.9972 3.11359 11.6783C3.11359 11.208 3.27846 10.862 3.60821 10.6404C3.93796 10.4134 4.43259 10.289 5.09209 10.2674L5.86241 10.2431V10.0485C5.86241 9.81602 5.80025 9.64574 5.67592 9.53763C5.55699 9.42951 5.38941 9.37545 5.17318 9.37545C4.95695 9.37545 4.74613 9.40789 4.54071 9.47276C4.33529 9.53222 4.12987 9.6079 3.92445 9.6998L3.52713 8.88083C3.76498 8.75649 4.02716 8.65919 4.31366 8.58892C4.60558 8.51864 4.9083 8.4835 5.22183 8.4835ZM5.39211 10.9647C5.0029 10.9756 4.73261 11.0458 4.58125 11.1756C4.42989 11.3053 4.35421 11.4756 4.35421 11.6864C4.35421 11.8702 4.40827 12.0027 4.51638 12.0837C4.6245 12.1594 4.76505 12.1973 4.93803 12.1973C5.19751 12.1973 5.41644 12.1216 5.59483 11.9702C5.77322 11.8135 5.86241 11.5945 5.86241 11.3134V10.9485L5.39211 10.9647Z" fill="black"/>\n<path d="M9.33966 8.27266C9.33966 8.44024 9.33426 8.60512 9.32344 8.76729C9.31263 8.92946 9.30182 9.0565 9.29101 9.14839H9.33966C9.45859 8.9646 9.61806 8.81053 9.81807 8.6862C10.0181 8.55646 10.2776 8.49159 10.5965 8.49159C11.0938 8.49159 11.4966 8.6862 11.8047 9.07542C12.1128 9.45923 12.2669 10.0268 12.2669 10.7782C12.2669 11.281 12.1939 11.7053 12.0479 12.0513C11.9074 12.3918 11.7101 12.6486 11.456 12.8216C11.2019 12.9946 10.9046 13.0811 10.5641 13.0811C10.2397 13.0811 9.98295 13.0243 9.79375 12.9108C9.60995 12.7919 9.45859 12.6594 9.33966 12.5135H9.25858L9.05586 13H8.13148V6.83743H9.33966V8.27266ZM10.2073 9.45652C9.99646 9.45652 9.82888 9.49977 9.70455 9.58626C9.58022 9.67275 9.48832 9.80519 9.42886 9.98358C9.3748 10.1566 9.34507 10.3755 9.33966 10.6404V10.7701C9.33966 11.1972 9.40183 11.5269 9.52616 11.7594C9.6559 11.9864 9.88835 12.0999 10.2235 12.0999C10.4722 12.0999 10.6695 11.9864 10.8154 11.7594C10.9614 11.5269 11.0344 11.1945 11.0344 10.762C11.0344 10.3296 10.9587 10.0052 10.8073 9.78898C10.6614 9.56734 10.4614 9.45652 10.2073 9.45652Z" fill="black"/>\n<path d="M15.3197 13.0811C14.8819 13.0811 14.5089 13.0027 14.2007 12.8459C13.8926 12.6838 13.6575 12.4351 13.4953 12.1C13.3331 11.7648 13.252 11.335 13.252 10.8107C13.252 10.2701 13.3439 9.82954 13.5277 9.48897C13.7115 9.14841 13.9656 8.89704 14.2899 8.73487C14.6197 8.5727 14.9981 8.49161 15.4251 8.49161C15.7279 8.49161 15.99 8.52134 16.2117 8.58081C16.4387 8.64027 16.636 8.71054 16.8036 8.79163L16.4468 9.72412C16.2576 9.64844 16.0792 9.58628 15.9117 9.53762C15.7495 9.48897 15.5873 9.46465 15.4251 9.46465C15.2143 9.46465 15.0386 9.516 14.8981 9.61871C14.7575 9.71601 14.6521 9.86467 14.5818 10.0647C14.517 10.2593 14.4845 10.5053 14.4845 10.8026C14.4845 11.0945 14.5197 11.3377 14.5899 11.5323C14.6656 11.7216 14.7737 11.8648 14.9143 11.9621C15.0548 12.054 15.2251 12.1 15.4251 12.1C15.6792 12.1 15.9035 12.0675 16.0982 12.0027C16.2928 11.9324 16.482 11.8378 16.6658 11.7188V12.7486C16.482 12.8676 16.2874 12.9514 16.0819 13C15.8819 13.0541 15.6279 13.0811 15.3197 13.0811Z" fill="black"/>\n</svg>\n',tile_repeat:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="3" y="3" width="4" height="4" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8 3H12V7H8V3ZM7 8H3V12H7V8ZM7 13H3V17H7V13ZM12 8H8V12H12V8ZM8 13H12V17H8V13ZM17 3H13V7H17V3ZM13 8H17V12H13V8ZM17 13H13V17H17V13Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',trackpad:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 2.5C1 1.67157 1.67157 1 2.5 1H16.5C17.3284 1 18 1.67157 18 2.5V10H17V2.5C17 2.22386 16.7761 2 16.5 2H2.5C2.22386 2 2 2.22386 2 2.5V11.5C2 11.7761 2.22386 12 2.5 12H5V13H2.5C1.67157 13 1 12.3284 1 11.5V2.5Z" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12 6.99994C12 6.44765 11.5523 6 11 6C10.4477 6 10 6.4477 10 6.99994V7.99798L10 7.99996L10 14H9L9 7.99996L9 7.99856C8.99925 7.44691 8.55184 6.99994 7.99999 6.99994C7.44772 6.99994 6.99997 7.44769 6.99997 7.99996V17.5857L4.70708 15.2929C4.31656 14.9024 3.68346 14.9023 3.29293 15.2929C2.90244 15.6833 2.90238 16.3166 3.29287 16.707L5.58583 19H4.17162L2.58579 17.4142C1.80474 16.6332 1.80474 15.3668 2.58579 14.5858C3.24017 13.9314 4.23512 13.8252 4.99997 14.2674C5.14804 14.353 5.28749 14.4591 5.41417 14.5858L5.99997 15.1716V7.99996C5.99997 6.8954 6.89543 5.99994 7.99999 5.99994C8.41166 5.99994 8.79427 6.12431 9.11231 6.33753C9.38566 5.55854 10.1276 5 11 5C12.1046 5 13 5.89539 13 6.99994V10.2676C13.2941 10.0974 13.6357 9.99997 14 9.99997C14.8725 9.99997 15.6144 10.5585 15.8877 11.3376C16.2057 11.1243 16.5884 11 17 11C18.1046 11 19 11.8954 19 13L19 17C18.9933 17.6955 18.8849 18.3669 18.689 19H17.633C17.864 18.3725 17.9929 17.6958 17.9998 16.9903L18 16.9613L18 13C18 12.4477 17.5523 12 17 12C16.4506 12 16.0047 12.443 16 12.9913L16 14H15L15 13L15 12.9877L15 12C15 11.4477 14.5523 11 14 11C13.4477 11 13 11.4477 13 12L13 14H12V6.99994Z" fill="black"/>\n</svg>\n',transform_box:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<mask id="path-1-inside-1" fill="white">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M6.5 2L2 2L2 6.5L6.5 2ZM8.00001 2.00001H12V3.00001L8.00001 3.00001V2.00001ZM2.00001 12V8.00001H3.00001V12H2.00001ZM18 8.00001H17V12H18V8.00001ZM8.00001 17H12V18H8.00001V17ZM18 2.00001V6.50001L13.5 2.00001L18 2.00001ZM2 13.5L2 18H6.5L2 13.5ZM18 18H13.5L18 13.5V18ZM11 10C11 10.5523 10.5523 11 10 11C9.44772 11 9.00001 10.5523 9.00001 10C9.00001 9.44772 9.44772 9.00001 10 9.00001C10.5523 9.00001 11 9.44772 11 10ZM12 10C12 11.1046 11.1046 12 10 12C8.89544 12 8.00001 11.1046 8.00001 10C8.00001 8.89544 8.89544 8.00001 10 8.00001C11.1046 8.00001 12 8.89544 12 10Z"/>\n</mask>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M6.5 2L2 2L2 6.5L6.5 2ZM8.00001 2.00001H12V3.00001L8.00001 3.00001V2.00001ZM2.00001 12V8.00001H3.00001V12H2.00001ZM18 8.00001H17V12H18V8.00001ZM8.00001 17H12V18H8.00001V17ZM18 2.00001V6.50001L13.5 2.00001L18 2.00001ZM2 13.5L2 18H6.5L2 13.5ZM18 18H13.5L18 13.5V18ZM11 10C11 10.5523 10.5523 11 10 11C9.44772 11 9.00001 10.5523 9.00001 10C9.00001 9.44772 9.44772 9.00001 10 9.00001C10.5523 9.00001 11 9.44772 11 10ZM12 10C12 11.1046 11.1046 12 10 12C8.89544 12 8.00001 11.1046 8.00001 10C8.00001 8.89544 8.89544 8.00001 10 8.00001C11.1046 8.00001 12 8.89544 12 10Z" fill="black"/>\n<path d="M2 2L2 1L1 1L1 2L2 2ZM6.5 2L7.20711 2.70711L8.91421 1L6.5 1L6.5 2ZM2 6.5L1 6.5L1 8.91421L2.70711 7.20711L2 6.5ZM12 2.00001H13V1.00001H12V2.00001ZM8.00001 2.00001V1.00001H7.00001V2.00001H8.00001ZM12 3.00001L12 4.00001L13 4.00001V3.00001H12ZM8.00001 3.00001H7.00001V4.00001L8.00001 4.00001L8.00001 3.00001ZM2.00001 8.00001V7.00001H1.00001V8.00001H2.00001ZM2.00001 12H1.00001V13H2.00001V12ZM3.00001 8.00001H4.00001V7.00001H3.00001V8.00001ZM3.00001 12V13H4.00001V12H3.00001ZM17 8.00001V7.00001H16V8.00001H17ZM18 8.00001H19V7.00001H18V8.00001ZM17 12H16V13H17V12ZM18 12V13H19V12H18ZM12 17H13V16H12V17ZM8.00001 17V16H7.00001V17H8.00001ZM12 18V19H13V18H12ZM8.00001 18H7.00001V19H8.00001V18ZM18 6.50001L17.2929 7.20711L19 8.91422V6.50001H18ZM18 2.00001H19V1.00001L18 1.00001L18 2.00001ZM13.5 2.00001L13.5 1.00001L11.0858 1.00001L12.7929 2.70711L13.5 2.00001ZM2 18L1 18L1 19H2V18ZM2 13.5L2.70711 12.7929L1 11.0858L1 13.5L2 13.5ZM6.5 18V19H8.91421L7.20711 17.2929L6.5 18ZM13.5 18L12.7929 17.2929L11.0858 19H13.5V18ZM18 18V19H19V18H18ZM18 13.5H19V11.0858L17.2929 12.7929L18 13.5ZM2 3L6.5 3L6.5 1L2 1L2 3ZM3 6.5L3 2L1 2L1 6.5L3 6.5ZM5.79289 1.29289L1.2929 5.79289L2.70711 7.20711L7.20711 2.70711L5.79289 1.29289ZM12 1.00001H8.00001V3.00001H12V1.00001ZM13 3.00001V2.00001H11V3.00001H13ZM8.00001 4.00001L12 4.00001L12 2.00001L8.00001 2.00001L8.00001 4.00001ZM7.00001 2.00001V3.00001H9.00001V2.00001H7.00001ZM1.00001 8.00001V12H3.00001V8.00001H1.00001ZM3.00001 7.00001H2.00001V9.00001H3.00001V7.00001ZM4.00001 12V8.00001H2.00001V12H4.00001ZM2.00001 13H3.00001V11H2.00001V13ZM17 9.00001H18V7.00001H17V9.00001ZM18 12V8.00001H16V12H18ZM18 11H17V13H18V11ZM17 8.00001V12H19V8.00001H17ZM12 16H8.00001V18H12V16ZM13 18V17H11V18H13ZM8.00001 19H12V17H8.00001V19ZM7.00001 17V18H9.00001V17H7.00001ZM19 6.50001V2.00001H17V6.50001H19ZM12.7929 2.70711L17.2929 7.20711L18.7071 5.7929L14.2071 1.2929L12.7929 2.70711ZM18 1.00001L13.5 1.00001L13.5 3.00001L18 3.00001L18 1.00001ZM3 18L3 13.5L1 13.5L1 18L3 18ZM6.5 17H2V19H6.5V17ZM1.29289 14.2071L5.79289 18.7071L7.20711 17.2929L2.70711 12.7929L1.29289 14.2071ZM13.5 19H18V17H13.5V19ZM17.2929 12.7929L12.7929 17.2929L14.2071 18.7071L18.7071 14.2071L17.2929 12.7929ZM19 18V13.5H17V18H19ZM10 12C11.1046 12 12 11.1046 12 10H10V12ZM8.00001 10C8.00001 11.1046 8.89544 12 10 12V10H8.00001ZM10 8.00001C8.89544 8.00001 8.00001 8.89544 8.00001 10H10V8.00001ZM12 10C12 8.89544 11.1046 8.00001 10 8.00001V10H12ZM10 13C11.6569 13 13 11.6569 13 10H11C11 10.5523 10.5523 11 10 11V13ZM7.00001 10C7.00001 11.6569 8.34315 13 10 13V11C9.44772 11 9.00001 10.5523 9.00001 10H7.00001ZM10 7.00001C8.34315 7.00001 7.00001 8.34315 7.00001 10H9.00001C9.00001 9.44772 9.44772 9.00001 10 9.00001V7.00001ZM13 10C13 8.34315 11.6569 7.00001 10 7.00001V9.00001C10.5523 9.00001 11 9.44772 11 10H13Z" fill="black" mask="url(#path-1-inside-1)"/>\n</svg>\n',transform_repeat:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M3 3H9V9H3V3Z" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13.8418 3.5972L16.2208 7.71775L12.1003 10.0967L9.72125 5.9762L13.8418 3.5972Z" fill="black" fill-opacity="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17.7305 11.2797L15.8439 14.5473L12.5763 12.6607L14.4629 9.39313L17.7305 11.2797Z" fill="black" fill-opacity="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13.9963 16.9963H11.0042V14.0043H13.9963V16.9963Z" fill="black" fill-opacity="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8.58973 16.6985L7.40338 14.6437L9.45821 13.4574L10.6446 15.5122L8.58973 16.6985Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',uniform_scale:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M9.2071 10.7929C9.56393 11.1497 10.0007 11.378 10.4597 11.4776C10.3871 11.7 10.2625 11.909 10.0858 12.0858L9.06712 13.1044C8.60604 12.8873 8.17399 12.5882 7.79288 12.2071L7.79289 12.2071C6.02167 10.4358 6.02167 7.56411 7.7929 5.79288L10.2929 3.29288C12.0641 1.52164 14.9359 1.52164 16.7071 3.29287L16.7071 3.29289C18.4783 5.06412 18.4783 7.93586 16.7071 9.70709L14.4517 11.9625C14.6064 11.0815 14.547 10.1702 14.2733 9.3125L15.2929 8.29288C16.2831 7.30269 16.2831 5.69728 15.2929 4.70709L15.2929 4.70708C14.3027 3.7169 12.6973 3.7169 11.7071 4.70709L9.20712 7.20709C8.21693 8.19728 8.21693 9.80269 9.20712 10.7929L9.2071 10.7929ZM5.54831 8.03747L3.29288 10.2929C1.52164 12.0641 1.52164 14.9359 3.29287 16.7071C5.0641 18.4783 7.93584 18.4784 9.70708 16.7071L12.2071 14.2071C13.9783 12.4359 13.9783 9.56413 12.2071 7.7929C11.826 7.41178 11.3939 7.11268 10.9328 6.89557L9.91422 7.91419C9.73749 8.09092 9.61285 8.30001 9.54029 8.52239C9.99933 8.62204 10.4361 8.85028 10.7929 9.20711C11.7831 10.1973 11.7831 11.8027 10.7929 12.7929L8.29287 15.2929C7.30268 16.2831 5.69727 16.2831 4.70709 15.2929C3.7169 14.3027 3.7169 12.6973 4.70709 11.7071L5.72674 10.6875C5.45304 9.82973 5.39356 8.91846 5.54831 8.03747Z" fill="black"/>\n</svg>\n',unlocked:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.75 6C7.75 4.75736 8.75736 3.75 10 3.75C11.2426 3.75 12.25 4.75736 12.25 6V10H6C4.89543 10 4 10.8954 4 12V16C4 17.1046 4.89543 18 6 18H14C15.1046 18 16 17.1046 16 16V12C16 10.8954 15.1046 10 14 10H13.75V6C13.75 3.92893 12.0711 2.25 10 2.25C7.92893 2.25 6.25 3.92893 6.25 6V8H7.75V6Z" fill="black"/>\n</svg>\n',visible:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 10C2.125 8 5.5 4 10 4C14.5 4 17.875 8 19 10C17.875 12 14.5 16 10 16C5.5 16 2.125 12 1 10ZM10 14C12.2091 14 14 12.2091 14 10C14 7.79086 12.2091 6 10 6C7.79086 6 6 7.79086 6 10C6 12.2091 7.79086 14 10 14Z" fill="black"/>\n<circle cx="10" cy="10" r="2" fill="black"/>\n</svg>\n',warning:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g clip-path="url(#clip0_1110_315)">\n<path d="M8.24632 2.04839L1.12383 15.0384C0.393022 16.3713 1.35746 18 2.87751 18H17.1225C18.6425 18 19.607 16.3713 18.8762 15.0385L11.7537 2.0484C10.9945 0.663799 9.00549 0.663794 8.24632 2.04839Z" fill="#F2C45A"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10 5C9.44771 5 9 5.44772 9 6V10.5C9 11.0101 9.38387 11.4384 9.89088 11.494C10.3979 11.5497 10.8655 11.2148 10.9762 10.7169L11.9762 6.21693C12.042 5.92083 11.9698 5.61087 11.78 5.37427C11.5902 5.13767 11.3033 5 11 5H10ZM9.5 16C10.3284 16 11 15.3284 11 14.5C11 13.6716 10.3284 13 9.5 13C8.67157 13 8 13.6716 8 14.5C8 15.3284 8.67157 16 9.5 16Z" fill="white"/>\n</g>\n<defs>\n<clipPath id="clip0_1110_315">\n<rect width="20" height="20" fill="white"/>\n</clipPath>\n</defs>\n</svg>\n',warp_coordinates:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.0211 3.01568C13.2555 2.96199 12.4855 3.05037 11.7082 3.26797L11.7062 3.26854C11.4821 3.33024 11.2574 3.40217 11.0318 3.48228C10.9484 4.30989 11.0325 5.14241 11.268 5.98354L11.2685 5.98558C11.3137 6.14954 11.3643 6.31379 11.4196 6.47852C11.6074 6.41504 11.7958 6.35669 11.9845 6.30471C12.7817 6.08166 13.5849 5.97587 14.392 6.00515C14.3612 5.9059 14.3321 5.80653 14.3047 5.70707C14.0555 4.8165 13.9527 3.91835 14.0211 3.01568ZM8.78697 4.4521C9.19916 4.2574 9.6039 4.06754 10.0036 3.89322C9.98016 4.68396 10.0861 5.47094 10.3047 6.25209C10.3582 6.44633 10.4185 6.64022 10.4841 6.83355C9.94891 7.0561 9.42086 7.30412 8.90477 7.5479C8.39795 7.7873 7.90239 8.01939 7.4137 8.22427C7.3607 8.06545 7.31207 7.90706 7.26854 7.74895L7.26854 7.74895L7.26797 7.7469C7.0318 6.90325 6.94786 6.06827 7.03253 5.23821C7.62769 4.99797 8.21468 4.72243 8.78697 4.4521ZM6.00515 5.60802C5.90594 5.63876 5.80661 5.66792 5.70718 5.6953C4.81658 5.9445 3.91839 6.04734 3.01568 5.97896C2.96199 6.7445 3.05037 7.51447 3.26797 8.2918L3.26854 8.29385L3.26854 8.29385C3.33024 8.51794 3.40217 8.74258 3.48228 8.96823C4.30989 9.05165 5.14241 8.9675 5.98354 8.73204L5.98558 8.73147L5.98558 8.73147C6.14954 8.68632 6.3138 8.63571 6.47852 8.58041C6.41504 8.39255 6.35669 8.20415 6.3047 8.01544C6.08165 7.2183 5.97587 6.4151 6.00515 5.60802ZM6.83355 9.51589C6.64022 9.58154 6.44633 9.6418 6.25209 9.6953C5.47094 9.91388 4.68396 10.0198 3.89322 9.99646C4.06754 10.3961 4.2574 10.8008 4.4521 11.213C4.72243 11.7853 4.99797 12.3723 5.23821 12.9675C6.06827 13.0521 6.90325 12.9682 7.7469 12.732L7.74895 12.7315C7.90706 12.6879 8.06545 12.6393 8.22427 12.5863C8.01939 12.0976 7.7873 11.6021 7.5479 11.0952C7.30412 10.5792 7.0561 10.0511 6.83355 9.51589ZM8.58041 13.5215C8.39254 13.585 8.20415 13.6433 8.01544 13.6953C7.21831 13.9184 6.4151 14.0241 5.60802 13.9949C5.63876 14.0941 5.66792 14.1934 5.69531 14.2929C5.94451 15.1835 6.04733 16.0816 5.97896 16.9843C6.7445 17.038 7.51447 16.9496 8.2918 16.732L8.29385 16.7315C8.51794 16.6698 8.74258 16.5978 8.96823 16.5177C9.05165 15.6901 8.9675 14.8576 8.73204 14.0165L8.73147 14.0144C8.68632 13.8505 8.6357 13.6862 8.58041 13.5215ZM9.99645 16.1068C10.0198 15.316 9.91387 14.529 9.6953 13.7479C9.64179 13.5537 9.58154 13.3598 9.51589 13.1665C10.0511 12.9439 10.5792 12.6959 11.0952 12.4521C11.6021 12.2127 12.0976 11.9806 12.5863 11.7757C12.6393 11.9346 12.6879 12.0929 12.7315 12.2511L12.732 12.2531C12.9682 13.0968 13.0521 13.9317 12.9675 14.7618C12.3723 15.002 11.7853 15.2776 11.213 15.5479C10.8008 15.7426 10.3961 15.9325 9.99645 16.1068ZM9.1598 12.2315C8.93897 11.7018 8.69346 11.1791 8.4521 10.6681C8.20988 10.1553 7.97515 9.65408 7.76851 9.1598C8.29825 8.93897 8.82092 8.69346 9.33188 8.4521C9.84467 8.20988 10.3459 7.97515 10.8402 7.76851C11.061 8.29825 11.3066 8.82092 11.5479 9.33188C11.7901 9.84467 12.0249 10.3459 12.2315 10.8402C11.7018 11.061 11.1791 11.3066 10.6681 11.5479C10.1553 11.7901 9.65408 12.0249 9.1598 12.2315ZM13.6953 11.9845C13.9183 12.7817 14.0241 13.5849 13.9949 14.392C14.0941 14.3612 14.1935 14.3321 14.293 14.3047C15.1835 14.0555 16.0817 13.9527 16.9843 14.0211C17.038 13.2555 16.9496 12.4855 16.732 11.7082L16.7315 11.7062C16.6698 11.4821 16.5978 11.2574 16.5177 11.0318C15.6901 10.9484 14.8576 11.0325 14.0165 11.268L14.0144 11.2685C13.8505 11.3137 13.6862 11.3643 13.5215 11.4196C13.585 11.6074 13.6433 11.7958 13.6953 11.9845ZM12.4521 8.90477C12.6959 9.42086 12.9439 9.94891 13.1665 10.4841C13.3598 10.4185 13.5537 10.3582 13.7479 10.3047C14.529 10.0861 15.316 9.98016 16.1068 10.0036C15.9325 9.6039 15.7426 9.19916 15.5479 8.78697C15.2776 8.21468 15.002 7.62769 14.7618 7.03253C13.9317 6.94786 13.0968 7.0318 12.2531 7.26797L12.2511 7.26854C12.0929 7.31207 11.9346 7.3607 11.7757 7.4137C11.9806 7.90239 12.2127 8.39795 12.4521 8.90477ZM11.4396 2.30471C12.4997 2.00809 13.5705 1.91884 14.6469 2.07885L15.1415 2.15238L15.068 2.64694C14.9307 3.5702 15.0049 4.49904 15.268 5.43863L15.2685 5.44068C15.5306 6.39226 15.9769 7.35388 16.4521 8.35987C16.9215 9.35358 17.4066 10.3916 17.6953 11.4397C17.9919 12.4998 18.0812 13.5706 17.9212 14.6469L17.8476 15.1415L17.3531 15.068C16.4298 14.9307 15.501 15.0049 14.5614 15.268L14.5593 15.2685C13.6078 15.5306 12.6461 15.9769 11.6401 16.4521C10.6464 16.9215 9.60836 17.4066 8.56025 17.6953C7.5002 17.9919 6.42942 18.0812 5.35307 17.9212L4.8585 17.8476L4.93202 17.3531C5.06927 16.4298 4.99506 15.501 4.73204 14.5614L4.73147 14.5593C4.46945 13.6078 4.02309 12.6461 3.5479 11.6401C3.07853 10.6465 2.59343 9.60843 2.3047 8.56035C2.00808 7.50028 1.91884 6.42946 2.07885 5.35307L2.15238 4.8585L2.64694 4.93202C3.5702 5.06927 4.49904 4.99506 5.43863 4.73204L5.44068 4.73147L5.44068 4.73147C6.39226 4.46945 7.35388 4.02309 8.35987 3.5479C9.35354 3.07853 10.3916 2.59344 11.4396 2.30471Z" fill="black"/>\n</svg>\n',warped_text:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2 2.99199C7.33334 1.904 12.6667 5.168 18 4.07999V17.008C12.6667 18.096 7.33334 14.832 2 15.92V2.99199ZM9.43102 13.4714C9.89053 13.5624 10.3494 13.6567 10.8086 13.7492C9.92767 11.1466 9.04693 8.54326 8.16463 5.94754C7.67094 5.85319 7.17556 5.76754 6.67804 5.69607C5.79255 8.00367 4.89574 10.3852 4 12.853C4.46832 12.8423 4.93705 12.8543 5.40452 12.8839C5.6297 12.2574 5.85456 11.6359 6.07891 11.0191C6.97691 11.1119 7.86804 11.2614 8.75436 11.4316C8.98003 12.111 9.20555 12.791 9.43102 13.4714ZM7.81358 8.3324C8.01943 8.97206 8.22513 9.61246 8.43073 10.2534C7.76537 10.1287 7.09723 10.0176 6.42521 9.93546C6.63546 9.35585 6.84522 8.7801 7.05451 8.20753C7.19177 7.76219 7.30775 7.31176 7.41837 6.86068C7.53641 7.35063 7.66273 7.84114 7.81358 8.3324ZM12.2052 9.78984C12.0769 9.46955 11.9487 9.14883 11.8206 8.82779C12.2215 8.67922 12.6951 8.61242 13.1872 8.60656C13.679 8.60737 14.1999 8.64599 14.6842 8.78936C14.9247 8.86168 15.15 8.96531 15.3328 9.09885C15.5165 9.23182 15.6555 9.39256 15.7531 9.56391C15.948 9.90841 15.9985 10.2853 16 10.6574V14.3828C15.6924 14.3918 15.3845 14.388 15.0771 14.3744C14.9951 14.1149 14.9131 13.8548 14.8312 13.5942C14.8176 13.5933 14.8039 13.5925 14.7903 13.5916C14.5859 13.8298 14.355 14.0649 14.0197 14.1915C13.6849 14.32 13.2716 14.3054 12.8789 14.2357C12.4839 14.1641 12.0909 13.9748 11.8163 13.711C11.5419 13.4467 11.382 13.134 11.3079 12.8332C11.2352 12.5313 11.2205 12.2327 11.2604 11.9495C11.303 11.6678 11.4235 11.402 11.6605 11.2113C11.895 11.0186 12.2395 10.9148 12.611 10.876C12.9838 10.8363 13.3815 10.8521 13.7787 10.8846C14.0878 10.9098 14.3978 10.928 14.7083 10.9375L14.7083 10.7023C14.7063 10.4818 14.6862 10.2545 14.5676 10.0417C14.4517 9.82778 14.1698 9.66279 13.8708 9.61319C13.5723 9.56266 13.2711 9.56804 12.997 9.61347C12.7236 9.66109 12.4591 9.71991 12.2052 9.78984ZM14.7083 11.7352C14.4831 11.7274 14.2582 11.715 14.0338 11.6985C13.7762 11.6849 13.5177 11.679 13.2748 11.7095C13.0314 11.7369 12.8131 11.8263 12.6962 11.9785C12.5756 12.1284 12.5435 12.3186 12.5522 12.5095C12.5615 12.6988 12.6154 12.9091 12.7967 13.0777C12.9723 13.2487 13.2474 13.344 13.5021 13.3563C13.7594 13.3755 14.0077 13.3214 14.1982 13.2105C14.3922 13.1022 14.5299 12.9424 14.6054 12.7652C14.6823 12.5878 14.7081 12.3967 14.7083 12.2056L14.7083 11.7352Z" fill="black"/>\n</svg>\n',weld_and_score:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M6 13H7V14V17V18H8H17H18V17V8V7H17H14H13V6V3V2H12H3H2V3V12V13H3H6ZM3 12H7H8V13V17H17V8H13H12V7V3H3V12Z" fill="black"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7 7H7.5H12V8H8V12H7V7.5V7Z" fill="black" fill-opacity="0.5"/>\n</svg>\n',width:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M3.79291 9.50002L4.14646 9.14646L6.14646 7.14646L6.50001 6.79291L7.20712 7.50002L6.85357 7.85357L5.70712 9.00002L14.2929 9.00001L13.1465 7.85357L12.7929 7.50001L13.5 6.79291L13.8536 7.14646L15.8536 9.14646L16.2071 9.50001L15.8536 9.85357L13.8536 11.8536L13.5 12.2071L12.7929 11.5L13.1465 11.1465L14.2929 10L5.70712 10L6.85357 11.1465L7.20712 11.5L6.50001 12.2071L6.14646 11.8536L4.14646 9.85357L3.79291 9.50002Z" fill="black"/>\n</svg>\n',x:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5.79548 4.2045C5.35614 3.76516 4.64383 3.76517 4.20449 4.20451C3.76515 4.64385 3.76515 5.35615 4.20449 5.79549L8.409 10L4.2045 14.2045C3.76516 14.6439 3.76516 15.3562 4.2045 15.7955C4.64384 16.2348 5.35615 16.2348 5.79549 15.7955L9.99999 11.591L14.2045 15.7955C14.6438 16.2348 15.3561 16.2348 15.7955 15.7955C16.2348 15.3562 16.2348 14.6438 15.7955 14.2045L11.591 10L15.7955 5.7955C16.2348 5.35616 16.2348 4.64385 15.7955 4.20451C15.3561 3.76517 14.6438 3.76517 14.2045 4.20451L9.99999 8.40901L5.79548 4.2045Z" fill="black"/>\n</svg>\n'},Symbol.toStringTag,{value:"Module"}));let Fo=[],Bo=0;const Vo=e=>{const t=e.spawnFrom,n=e.placement??"bottom-start",i=e.offset??0,r=e.offsetH??0,s=e.offsetV??0,o=e.overlay??!0,a=e.yMin??0,l=e.closeOnEnter??!1;let c,h;c=t instanceof HTMLElement?t.getBoundingClientRect():qo(t.x,t.y);const u=e=>{("Escape"===e.key||l&&"Enter"===e.key)&&(e.stopPropagation(),p(),Oe.redraw())},d={view:e.view,className:e.className,initialize:e=>{"closeOnOutsidePointerDown"===o&&(h=t=>{t.target instanceof Node&&!Yo(t.target,e)&&(p(),Oe.redraw())},document.addEventListener("pointerdown",h)),document.addEventListener("keydown",u);const t=e.getBoundingClientRect();return Ko(c,t,n,i,r,s,a)},hasBeenInitialized:!1,onclose:e.onclose,overlay:o,id:Bo++};Fo.push(d);const p=()=>{var e;h&&document.removeEventListener("pointerdown",h),document.removeEventListener("keydown",u),d.childPopup&&(d.childPopup.close(),d.childPopup=void 0);const t=Fo.indexOf(d);-1!==t&&(Fo.splice(t,1),null==(e=d.onclose)||e.call(d))};return{close:p,registerChildPopup:e=>{d.childPopup&&d.childPopup.close(),d.childPopup=e}}},jo=()=>{var e;for(let t of Fo)null==(e=t.onclose)||e.call(t);Fo=[]},Ho={view(){let e=null;return Fo.some(e=>!0===e.overlay)&&(e=Oe(".popup-background-overlay",{onpointerdown:jo})),[e,Fo.map(e=>Oe(zo,{popup:e,key:e.id}))]}},Uo=({dom:e,attrs:{popup:t}})=>{if(!t.hasBeenInitialized){const n=e,{x:i,y:r,maxHeight:s}=t.initialize(n);n.style.left=i+"px",n.style.top=r+"px",n.style.maxHeight=s?s+"px":"auto",t.hasBeenInitialized=!0}},zo={oncreate:Uo,onupdate:Uo,view:({attrs:{popup:e}})=>Oe(".popup",{className:e.className},e.view())},Wo=e=>{let t=e.className;t?t+=" scrollable":t="scrollable";const n=Vo({...e,view:()=>Oe(".popup-menu",e.menuItems.map(e=>Oe(Go,{menuItem:e,parentPopup:n}))),className:t});return n},Go={view(e){var t,n;const{menuItem:i,parentPopup:r}=e.attrs;if(!1===(null==(t=i.visible)?void 0:t.call(i)))return;if("separator"===i.type)return Oe(".popup-menu-separator");if(i.custom)return i.custom();const s=eo({disabled:i.enabled&&!i.enabled()});let o;i.submenu&&(o=()=>{i.submenu&&(i.enabled&&!i.enabled()||r.registerChildPopup(Wo({menuItems:i.submenu(),spawnFrom:uo(e),placement:"right-start",offsetV:6})))});const a=i.accelerator?i.accelerator.toString():"",l=Oe(".popup-menu-item",{class:s,onclick:()=>{var e;i.enabled&&!i.enabled()||(jo(),null==(e=i.action)||e.call(i))},onpointerenter:o},[Oe(".popup-menu-item-icon",null==(n=i.icon)?void 0:n.call(i)),Oe(".popup-menu-item-label",i.label),Oe(".popup-menu-item-accelerator",a),i.submenu&&Oe(".popup-menu-item-icon",Oe(Jo,{icon:"chevron_right"}))]);return i.tooltip?Oe(Zo,{message:i.tooltip,placement:"right-start"},l):l}},$o=(e,t)=>{Wo({menuItems:t,spawnFrom:{x:e.clientX,y:e.clientY},placement:"bottom-start"})},Zo=()=>{let e;const t=()=>{e&&e.close()};return{view(n){const i=n.attrs.message,r=n.attrs.placement??"bottom",s=n.attrs.offset??0,o=n.attrs.offsetH??4,a=n.attrs.offsetV??4,l=n.children,c=()=>{t(),e=Vo({spawnFrom:uo(n),placement:r,offset:s,offsetH:o,offsetV:a,className:"tooltip",view:i,overlay:!1})};return Oe("span",{onpointerover:e=>{0===e.buttons&&c()},onpointerup:()=>{c()},onpointerout:()=>{t()},className:n.attrs.className},l)},onremove(){t(),Oe.redraw()}}},qo=(e,t)=>({left:e,top:t,right:e,bottom:t,width:0,height:0}),Ko=(e,t,n,i,r,s,o)=>{let a,l=0,c=0,h=!1;const u=document.documentElement.clientWidth,d=document.documentElement.clientHeight,p=e=>e<0,f=e=>e+t.width>u,m=e=>e<o,g=e=>e+t.height>d,v=e.top-t.height-i-s,y=e.bottom+i+s,b=e.left-t.width-i-r,w=e.right+i+r;if(n.includes("top")?(h=!0,c=v,m(c)&&(c=y+t.height<=d?y:Math.max(o,d-t.height))):n.includes("bottom")?(h=!0,c=y,g(c)&&(c=v>=o?v:Math.max(o,d-t.height))):n.includes("left")?(l=b,p(l)&&(l=w)):n.includes("right")&&(l=w,f(l)&&(l=b)),h){const i=e.left-r,s=e.left+e.width/2-t.width/2,o=e.right-t.width+r;n.includes("start")?(l=i,f(l)&&(l=o)):n.includes("end")?(l=o,p(l)&&(l=i)):(l=s,p(l)?l=0:f(l)&&(l=u-t.width))}else{const i=e.top-s,r=e.top+e.height/2-t.height/2,a=e.bottom-t.height+s;n.includes("start")?(c=i,g(c)&&(c=a)):n.includes("end")?(c=a,m(c)&&(c=i)):(c=r,m(c)?c=o:g(c)&&(c=d-t.height))}return p(l)&&(l=0),f(l)&&(l=Math.max(0,u-t.width)),m(c)&&(c=o),g(c)&&(a=d-c),{x:l,y:c,maxHeight:a}},Yo=(e,t)=>e===t||!!e.parentNode&&Yo(e.parentNode,t),Xo={view({attrs:{icon:e}}){const t=Ro[e];return Oe(".icon16",{"aria-hidden":"true"},Oe.trust(t))}},Jo={view({attrs:{icon:e}}){const t=Ro[e];return Oe(".icon20",{"aria-hidden":"true"},Oe.trust(t))}},Qo={view({attrs:{icon:e}}){const t=Ro[e];return Oe.trust(t)}},ea={view({attrs:{icon:e,label:t,onclick:n,onpointerdown:i,className:r}}){const s=Oe(".icon-button",{onclick:n,onpointerdown:i,className:r,role:"button","aria-label":t},Oe(Jo,{icon:e}));return t?Oe(Zo,{message:()=>t},s):s}};class ta{constructor(e,t){this.view=e,this.onDismiss=t}}const na=e=>{"Escape"===e.key&&(e.stopPropagation(),ia.dismiss())};const ia=new class{open({modalView:e,onDismiss:t}){this.modal=new ta(e,t),document.addEventListener("keydown",na)}dismiss(){var e;const{modal:t}=this;t&&(this.close(),null==(e=t.onDismiss)||e.call(t))}close(){this.modal=void 0,document.removeEventListener("keydown",na)}},ra={view(){const{modal:e}=ia;if(e)return Oe(".modal-container",[Oe(".modal-background-overlay",{onclick:()=>ia.dismiss()}),e.view()])}},sa={view:()=>Oe(".modal-x",{onclick:()=>ia.dismiss()},Oe(Jo,{icon:"x"}))};let oa,aa;const la=async e=>{ia.open({modalView:()=>Oe(".modal-box",[Oe(".google-sign-in-loading",[Oe("p","Signing in with Google..."),Oe(".loading-indicator")])])}),Oe.redraw();const t=e.credential,n=await _s("signInWithGoogleCredential",{googleCredential:t,metadata:Oo()});n.success&&n.newUserCreated&&Do("CompleteRegistration",{}),await va.refreshLoggedInUser(),Ao("sign in with google"),ia.close(),null==aa||aa()};window.addEventListener("load",()=>{oa=window.google,oa&&oa.accounts.id.initialize({client_id:"951058506648-nicpvptr0vpj6ajqqe8qmfh3cvc1nivc.apps.googleusercontent.com",callback:la})});const ca={view:({attrs:{onSuccess:e}})=>(aa=e,Oe(".google-sign-in-button")),oncreate(e){const t=e.dom,n=t.getBoundingClientRect().width,i=()=>{oa?oa.accounts.id.renderButton(t,{theme:"filled_blue",text:"continue_with",width:n,size:"large"}):setTimeout(i,100)};i()}},ha={view:()=>Oe(".policy-agreement",Oe.trust("By continuing, you agree to Cuttle's <a href='/legal/terms-of-service' target='_blank'>terms of service</a> and <a href='/legal/privacy-policy' target='_blank'>privacy policy</a>."))},ua=()=>{let e=!0,t=!0,n=!0;return{view(i){const{onSuccess:r,onDismiss:s,topMessage:o}=i.attrs;let a=Oe("p.account-error"," ");return t||(a=Oe("p.account-error","Please provide your email address or username.")),n||(a=Oe("p.account-error","Please provide your password.")),e||(a=Oe("p.account-error","We don't have that email / username and password combination on file.")),Oe(".modal-box.account-modal",[Oe(sa),Oe("form.form-wrapper",{onsubmit:async s=>{s.preventDefault(),e=!0,t=!0,n=!0;const o=i.dom,a=o.querySelector(".login-email").value,l=o.querySelector(".login-password").value;if(!a)return void(t=!1);if(!l)return void(n=!1);(await _s("login",{emailOrUsername:a,password:l})).success?(e=!0,await va.refreshLoggedInUser(),Ao("sign in"),ia.close(),null==r||r()):e=!1}},[null==o?void 0:o(),Oe(ca,{onSuccess:r}),Oe(".account-modal-or","or continue with email"),Oe(".label-input",[Oe("label.label",{for:"login-email"},"Email / Username"),Oe("input.login-email",{type:"text",id:"login-email"})]),Oe(".label-input",[Oe("label.label",{for:"login-password"},"Password"),Oe("input.login-password",{type:"password",id:"login-password"})]),Oe("button","Log In"),a,Oe("p",[Oe("span[role=link]",{onclick:()=>va.openAccountModal("forgotPassword",r,s,o)},"Forgot Password?")]),Oe("p",[Oe("span","No account? "),Oe("span[role=link]",{onclick:()=>va.openAccountModal("signup",r,s,o)},"Create a free Cuttle account"),"."]),Oe(ha)])])}}},da=()=>{let e=!1,t=!1,n=!1,i=!1,r=!0,s=!0,o=!0,a=!0;return{view(l){const{onSuccess:c,onDismiss:h,topMessage:u}=l.attrs;let d=Oe("p.account-error"," ");return s||(d=Oe("p.account-error","Please provide your email address")),o||(d=Oe("p.account-error","Please provide your username")),a||(d=Oe("p.account-error","Please provide your password")),t&&(d=Oe("p.account-error","Email not available"),t=!1),n&&(d=Oe("p.account-error","Username not available"),n=!1),i&&(d=Oe("p.account-error","Username must be less than 15 characters and can only contain letters, numbers and '_'")),r||(d=Oe("p.account-error","Password must contain a minimum of 8 characters")),Oe(".modal-box.account-modal",[Oe(sa),Oe("form.form-wrapper",{onsubmit:async e=>{e.preventDefault(),s=!0,o=!0,a=!0,t=!1,n=!1,i=!1,r=!0;const h=l.dom,u=h.querySelector(".create-account-email").value,d=h.querySelector(".create-account-username").value,p=h.querySelector(".create-account-password").value;if(!u)return void(s=!1);if(!d)return void(o=!1);if(!p)return void(a=!1);const f=await _s("createAccount",{email:u,username:d,password:p,metadata:Oo()});f.success?(await va.refreshLoggedInUser(),Ao("sign up with email"),Do("CompleteRegistration",{}),ia.close(),null==c||c()):("Email not available"===f.message&&(t=!0),"Username not available"===f.message&&(n=!0),"Username is invalid"===f.message&&(i=!0),"Password is less than 8 characters"===f.message&&(r=!1))}},[null==u?void 0:u(),Oe(ca,{onSuccess:c}),e?[Oe(".account-modal-or","or continue with email"),Oe(".label-input",[Oe("label.label",{for:"create-account-email"},"Email"),Oe("input.create-account-email",{type:"email",id:"create-account-email"})]),Oe(".label-input",[Oe("label.label",{for:"create-account-username"},"Username"),Oe("input.create-account-username",{type:"text",id:"create-account-username",maxLength:"15"})]),Oe(".label-input",[Oe("label.label",{for:"create-account-password"},"Password"),Oe("input.create-account-password",{type:"password",id:"create-account-password"})]),Oe("button",{type:"submit"},"Create Account")]:[Oe(".account-modal-or","or"),Oe("button.secondary.show-email-signup",{onclick:()=>{e=!0}},"Create Account with Email")],d,Oe(".account-call-to-action",[Oe("p",[Oe("span","Already have a Cuttle account? "),Oe("span[role=link]",{onclick:()=>va.openAccountModal("login",c,h,u)},"Log in"),"."])]),Oe(ha)])])}}},pa=()=>{let e=!1;return{view(t){const{onSuccess:n,onDismiss:i,topMessage:r}=t.attrs,s=async n=>{n.preventDefault(),e=!1;const i=t.dom.querySelector(".send-reset-email").value,r=await _s("sendResetToken",{email:i});e=(r.success,!0)};let o;return e||(o=Oe("form.form-wrapper",{onsubmit:s},[Oe("h2","Reset Password"),Oe(".label-input",[Oe("label.label",{for:"send-reset-email"},"Email"),Oe("input.send-reset-email",{type:"email",id:"send-reset-email"})]),Oe("button","Send Reset Email"),Oe("p.account-error"," "),Oe(".account-call-to-action",[Oe("p",[Oe("span","or "),Oe("span[role=link]",{onclick:()=>va.openAccountModal("login",n,i,r)},"Log In")])])])),e&&(o=Oe("p.reset-password-sent","Check your email for further instructions. ")),Oe(".modal-box.account-modal",[Oe(sa),o])}}},fa=["Free","K-12 Education Free"];function ma(){const e=new Date,t=(e.getMonth()+1).toString().padStart(2,"0");return e.getFullYear()+"/"+t}class ga{constructor(e){if(this.hasProFeatures=!1,this.hasAdminFeatures=!1,this.canLicensePro=!1,this.canLicenseMinisite=!1,this.canDownloadUnlimitedFree=!1,this.canCreateUnlimitedProjects=!1,this.canCreateFolders=!1,!e)return;const{subscription:t,isAdmin:n,canLicenseMinisite:i,canLicensePro:r}=e;t&&(fa.includes(t.plan)||(this.hasProFeatures=!0,this.canDownloadUnlimitedFree=!0,this.canCreateUnlimitedProjects=!0,this.canCreateFolders=!0),"K-12 Education Free"===t.plan&&(this.hasProFeatures=!1,this.canDownloadUnlimitedFree=!0,this.canCreateUnlimitedProjects=!0,this.canCreateFolders=!0),n&&(this.hasAdminFeatures=!0,this.canLicensePro=!0),i&&(this.canLicenseMinisite=!0),r&&(this.canLicensePro=!0))}}const va=new class{constructor(){this.featureFlags=new ga,this.subscribers=new Set}async refreshLoggedInUser(){const e=await _s("loggedInUser",{});e.success?(e.isAdmin&&(e.subscription={plan:"Gift",hasEverHadTrial:!1,hasEverBeenInvoiced:!1}),this.loggedInUser=e,this.storage=e.userStorage,this.featureFlags=new ga(this.loggedInUser),this.loggedInUser.userId,this.loggedInUser.username,this.loggedInUser.email,this.loggedInUser.displayName):(this.loggedInUser=void 0,this.featureFlags=new ga,this.storage=void 0),this.notifySubscribers()}async logOut(){await Os("logout",{}),await this.refreshLoggedInUser()}openAccountModal(e,t,n,i){let r;if("login"===e)r=()=>Oe(ua,{onSuccess:t,onDismiss:n,topMessage:i});else if("signup"===e)r=()=>Oe(da,{onSuccess:t,onDismiss:n,topMessage:i});else{if("forgotPassword"!==e)throw new Error('modal is not one of "login", "signup", or "forgotPassword"');r=()=>Oe(pa,{onSuccess:t,onDismiss:n,topMessage:i})}ia.open({modalView:r,onDismiss:n})}openAccountModalPromise(e){return new Promise(t=>{this.openAccountModal(e,()=>t(!0),()=>t(!1))})}storageGet(e){if(this.storage)return this.storage[e];console.warn("User not logged in")}async storageSet(e,t){this.storage?(this.storage[e]=t,await Os("setUserStorage",{property:e,value:t},{skipRedraw:!0})):console.warn("User not logged in")}async storageUpdate(e){this.storage?(this.storage={...this.storage,...e},await Os("updateUserStorage",e,{skipRedraw:!0})):console.warn("User not logged in")}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}notifySubscribers(){for(let e of this.subscribers)e()}downloadsThisMonth(){if(!this.loggedInUser||!this.storage)return void console.warn("User not logged in");if(this.featureFlags.canDownloadUnlimitedFree)return;if(ma()===this.storageGet("downloadMonth")){return this.storageGet("downloadsThisMonth")??0}return 0}downloadsRemaining(){if(!this.loggedInUser||!this.storage)return console.warn("User not logged in"),0;if(this.featureFlags.canDownloadUnlimitedFree)return 1/0;return 10-(this.downloadsThisMonth()??0)}async incrementDownloadsThisMonth(){if(!this.loggedInUser||!this.storage)return void console.warn("User not logged in");if(this.featureFlags.canDownloadUnlimitedFree)return;let e=this.storageGet("downloadsThisMonth")??0;const t=this.storageGet("downloadMonth"),n=ma();n===t?(e+=1,await this.storageUpdate({downloadsThisMonth:e})):(e=1,await this.storageUpdate({downloadMonth:n,downloadsThisMonth:e}))}isSubscriptionEducation(){return this.loggedInUser&&["K-12 Education","K-12 Education Free"].includes(this.loggedInUser.subscription.plan)}isSubscriptionFree(){return this.loggedInUser&&fa.includes(this.loggedInUser.subscription.plan)}isSubscriptionEducationFree(){var e;return"K-12 Education Free"===(null==(e=this.loggedInUser)?void 0:e.subscription.plan)}},ya=()=>{let e=!0;return{view({attrs:{avatarUrl:t,username:n,size:i}}){const r=n.charAt(0);let s;return s=e?Oe("img.avatar",{src:t,width:i,height:i,onerror:()=>{e=!1},alt:n}):Oe(".avatar-letter-container",{style:{width:i+"px",height:i+"px",fontSize:.5*i+"px",lineHeight:i+"px",border:.05*i+"px solid"},"aria-label":n},[Oe(".avatar-letter",{"aria-hidden":"true"},r.toUpperCase())]),s}}},ba={view:()=>Oe("footer",[Oe(".footer-inner",[Oe(".footer-columns",[Oe(".footer-column",[Oe(".footer-column-title","Product"),Oe("a",{href:"/product"},"Overview"),Oe("a",{href:"/templates"},"Templates"),Oe("a",{href:"/pricing"},"Pricing"),Oe("a",{href:"/cuttle-for-k-12-education"},"K-12 Education")]),Oe(".footer-column",[Oe(".footer-column-title","Company"),Oe("a",{href:"/about-us"},"About Us"),Oe("a",{href:"/affiliate"},"Affiliate Program"),Oe("a",{href:"/learn/cuttle-creators"},"Cuttle Creators")]),Oe(".footer-column",[Oe(".footer-column-title","Resources"),Oe("a",{href:"/learn"},"Learn"),Oe("a",{href:"/learn/video-tutorials"},"Video Tutorials"),Oe("a",{href:"/livestream"},"Weekly Live Sessions"),Oe("a",{href:"/blog"},"Blog")]),Oe(".footer-column",[Oe(".footer-column-title","Community"),Oe("a",{href:"https://www.facebook.com/groups/cuttle",target:"_blank"},"Facebook Group"),Oe("a",{href:"/discord",target:"_blank"},"Discord Server")]),Oe(".footer-column",[Oe(".footer-column-title","Follow Us"),Oe("a",{href:"https://www.youtube.com/@Cuttle",target:"_blank"},"YouTube"),Oe("a",{href:"https://www.instagram.com/cuttlexyz/",target:"_blank"},"Instagram"),Oe("a",{href:"https://www.facebook.com/cuttlexyz",target:"_blank"},"Facebook")])]),Oe(".footer-bottom",[Oe(".footer-contact",[Oe("span",["Need help? Email ",Oe("a",{href:"mailto:support@cuttle.xyz"},"support@cuttle.xyz")])]),Oe(".footer-copyright",[Oe("span",` ${(new Date).getFullYear()} - Cuttle Labs, Inc.`)]),Oe(".footer-legal",[Oe("a",{href:"/legal/terms-of-service"},"Terms of Service"),Oe("a",{href:"/legal/privacy-policy"},"Privacy Policy")])])])])};const wa=new class{constructor(){this.sidebarExpandedSections={},this.isHamburgerOpen=!1,this.expandLearnSidebarSectionOnNextRender=!1}},xa={view:()=>Oe(".nav-logo",[Oe(Oe.route.Link,{href:"/","aria-label":"Cuttle home"},[Oe(".nav-logo-image",{"aria-hidden":"true"},Oe(Qo,{icon:"cuttle_logo"}))])])},Ca={view({attrs:{hamburgerExtra:e}}){const t=()=>(wa.isHamburgerOpen=!1,!0),n=void 0!==va.loggedInUser;let i,r;if(va.isSubscriptionEducation()||(i=[Oe("a.nav-link",{href:"https://www.facebook.com/groups/cuttle",target:"_blank",onclick:t},"Facebook Group"),Oe("a.nav-link",{href:"/discord",target:"_blank",onclick:t},"Discord Server")]),wa.isHamburgerOpen){let s;e&&(s=[Oe(".hamburger-menu-separator"),e()]),r=Oe(".hamburger-menu-contents",[Oe(".hamburger-nav-open",[Oe(xa),Oe(".modal-x",{onclick:t},Oe(Jo,{icon:"x"}))]),Oe(".hamburger-links",[n?Oe(Oe.route.Link,{class:"nav-link",href:"/dashboard"},"My Projects"):null,Oe(Oe.route.Link,{class:"nav-link",href:"/templates"},"Templates"),Oe(Oe.route.Link,{class:"nav-link",href:"/learn"},"Learn"),Oe(Oe.route.Link,{class:"nav-link",href:"/pricing",onclick:()=>Ao("clicked pricing",{from:"nav"})},"Pricing"),i,s])])}return Oe(".hamburger-nav",[Oe(".nav-links-container",[Oe(".hamburger-icon",{onclick:()=>wa.isHamburgerOpen=!0},Oe(Jo,{icon:"hamburger"})),r])])}},Sa=()=>Boolean(va.loggedInUser&&(va.loggedInUser.isAdmin||va.loggedInUser.canLicensePro||va.loggedInUser.canLicenseMinisite)),ka={view(e){const{hamburgerExtra:t}=e.attrs,n=void 0!==va.loggedInUser;let i,r;return va.isSubscriptionEducation()||(i=Oe(".nav-link.nav-with-dropdown",[Oe("div",{style:"display: flex"},[Oe("div","Community"),Oe("div",Oe(Jo,{icon:"chevron_down"}))]),Oe(".nav-dropdown",[Oe(".nav-dropdown-items",[Oe("a",{href:"https://www.facebook.com/groups/cuttle",target:"_blank"},"Facebook Group"),Oe("a",{href:"/discord",target:"_blank"},"Discord Server")])])])),r=Oe(".left-nav",[Oe(".nav-links-container",[Oe(xa),n?Oe(Oe.route.Link,{class:"nav-link",href:"/dashboard"},"My Projects"):null,Oe(Oe.route.Link,{class:"nav-link",href:"/templates"},"Templates"),Oe(Oe.route.Link,{class:"nav-link",href:"/learn"},"Learn"),Oe(Oe.route.Link,{class:"nav-link",href:"/pricing",onclick:()=>Ao("clicked pricing",{from:"nav"})},"Pricing"),i])]),Oe(".nav",[Oe(".nav-inner",[r,Oe(Ca,{hamburgerExtra:t}),Oe(Ea),Oe(La)])])}},La={view(e){const t=va.loggedInUser;if(t){const n=t.username,i=t.email,r=t.subscription.plan;let s="";s="Pro"===r?"Cuttle Pro":"K-12 Education"===r?"K-12 Account":"K-12 Education Free"===r?"K-12 Free Account":"Gift"===r?"Gift Account":"Free Account";const o=()=>{Wo({menuItems:[{custom:()=>Oe(".nav-logged-in-user",[Oe("div","Signed in as:"),Oe("div",`${i}`)])},{type:"separator"},{custom:()=>Oe(".nav-logged-in-user",[Oe("div","Current Plan:"),Oe("div",s)])},{type:"separator"},{label:"Profile Page",action:()=>Oe.route.set(`/@${n}`)},{label:"Usage Analytics",action:()=>Oe.route.set("/analytics"),visible:Sa},{label:"Account Settings",action:()=>Oe.route.set("/settings")},{type:"separator"},{label:"Admin",submenu:()=>[{label:"Creator Tags",action:()=>Oe.route.set("/admin/creator-tags")},{label:"Gift Subscription",action:()=>Oe.route.set("/admin/gift")}],visible:()=>no()},{type:"separator",visible:()=>no()},{label:"Log Out",action:()=>Oe.route.set("/logout")}],spawnFrom:e.dom.querySelector(".nav-menu"),placement:"bottom-end"})};return Oe(".right-nav",[Oe(".nav-menu",{onclick:o},[Oe(ya,{avatarUrl:t.avatar,username:t.username,size:45}),Oe(".nav-menu-dropdown-icon",Oe(Jo,{icon:"chevron_down"}))])])}return Oe(".right-nav",[Oe(".login.nav-link",{onclick:()=>va.openAccountModal("login",Lo)},"Log In"),Oe(".nav-signup-button.nav-link",{onclick:()=>va.openAccountModal("signup",Lo)},"Sign Up")])}},Ea={view:e=>Oe(".search-bar",[Oe("form",{onsubmit:async t=>{t.preventDefault();const n=e.dom.querySelector(".query"),i=n.value;if(!i)return;Ao("universal search",{query:i}),n.blur();const r=encodeURIComponent(i);Oe.route.set(`/search/${r}`)}},[Oe("input[type=text][enterkeyhint=search].query",{"aria-label":"Search",placeholder:"Search"})])])},Pa={view:e=>[e.children,Oe(Ho),Oe(ra)]},Ta={view(e){const{displayAboveNav:t,className:n,mainClass:i,hamburgerExtra:r}=e.attrs;return Oe(Pa,[Oe(".site-layout",{className:n},[t,Oe(ka,{hamburgerExtra:r}),Oe("main",{className:i},e.children),Oe(ba)])])}},Aa=["cuttle.xyz","cuttlexyz.com","staging.cuttle.xyz","staging-mobile.cuttle.xyz","experimental.cuttle.xyz","localhost.cuttle.xyz"],Ma=e=>{if(Aa.includes(e))return;const t=e.split("."),n=t[0],i=t.slice(1).join(".");return Aa.includes(i)?n:void 0},Ia=(e,t)=>{let n=Aa.filter(t=>e.endsWith(t)).sort((e,t)=>t.length-e.length)[0];return n||(n="cuttle.xyz"),t?`${t}.${n}`:n},_a=()=>{const e=Ia(window.location.hostname,void 0),t=new URL(window.location.href);return t.hostname=e,t.pathname="/",t.search="",t.hash="",t.toString()},Oa=e=>{const t=Ia(window.location.hostname,e),n=new URL(window.location.href);return n.hostname=t,n.toString()};const Na=new class{constructor(){this.subdomain=(()=>{const e=window.location.hostname;return Ma(e)})(),this.refreshInfo()}async refreshInfo(){if(!this.subdomain)return;const e=await Os("getMinisiteInfo",{subdomain:this.subdomain});this.displayName=e.displayName,this.supportEmail=e.supportEmail,this.joinLink=e.joinLink}isMinisite(){return void 0!==this.subdomain}loggedInUserHasAccess(){return!!va.loggedInUser&&va.loggedInUser.minisiteMemberships.some(e=>e.subdomain===this.subdomain&&("admin"===e.role||"paid"===e.role))}openDownloadPaywall(){ia.open({modalView:()=>Oe($a)})}},Da={view:e=>Oe(Pa,[Oe(".site-layout",[Oe(Ra),Oe("main",e.children),Oe(Ba)])])},Ra={view:()=>Oe(".nav.minisite-nav",[Oe(".nav-inner",[Oe(".left-nav",[Oe(".nav-logo",[Oe(Oe.route.Link,{href:"/"},[Oe("img",{src:`/minisite/logos/${Na.subdomain}.png`,height:"40",alt:Na.displayName??""})])])]),Oe(Fa)])])},Fa={view(){if(va.loggedInUser){const e=va.loggedInUser,t=()=>{Wo({menuItems:[{custom:()=>Oe(".nav-logged-in-user",[Oe("div","Signed in as:"),Oe("div",`${e.email}`)])},{type:"separator"},{label:"Log Out",action:()=>va.logOut()}],spawnFrom:document.querySelector(".nav-menu"),placement:"bottom-end"})};return Oe(".right-nav",[Oe(".nav-menu",{onclick:t},[Oe(ya,{avatarUrl:e.avatar,username:e.username,size:45}),Oe(".nav-menu-dropdown-icon",Oe(Jo,{icon:"chevron_down"}))])])}return Oe(".right-nav",[Oe(".login.nav-link",{onclick:ja},"Log In"),Oe(".nav-signup-button.nav-link",{onclick:()=>window.open(Na.joinLink,"_blank")},`Join ${Na.displayName}`)])}},Ba={view:()=>Oe("footer.minisite-footer",[Oe(".footer-inner",[Oe(".footer-content",[Oe(".footer-left",[Oe(".minisite-footer-contact-container",[Oe("div","Need help?"),Oe("div",["Email ",Oe("a",{href:`mailto:${Na.supportEmail}`},Na.supportEmail)])]),Oe(".footer-copyright",[` ${(new Date).getFullYear()} - `,Oe("a",{href:Na.joinLink},Na.displayName??"")])]),Oe(Va)])])])},Va={view:()=>Oe(".footer-cuttle-logo",[Oe("a.footer-powered-by",{href:_a(),target:"_blank"},[Oe(".footer-cuttle-logo-image",{"aria-hidden":"true"},Oe(Qo,{icon:"cuttle_logo"})),"Powered by Cuttle"])])},ja=()=>{if(va.loggedInUser)Na.loggedInUserHasAccess()?ia.open({modalView:()=>Oe(Ha)}):ia.open({modalView:()=>Oe(Ua)});else{const e=()=>Oe(".minisite-account-modal-top-message","Log in to ",Oe("strong","Cuttle")," to access the paid member area of ",Oe("strong",Na.displayName));va.openAccountModal("signup",ja,void 0,e)}},Ha={view:()=>Oe(".modal-box.minisite-login-modal",[Oe(sa),Oe("p","You now have access to the paid member area of ",Oe("strong",Na.displayName)),Oe("button",{onclick:()=>ia.close()},"Woohoo! ")])},Ua={view(){var e,t;return Oe(".modal-box.minisite-login-modal",[Oe(sa),Oe("p",["You are signed in to Cuttle as ",Oe("strong",null==(e=va.loggedInUser)?void 0:e.email)," which is not a paid member of ",Oe("strong",Na.displayName)]),Oe("button",{onclick:()=>{window.open(Na.joinLink,"_blank"),ia.close()}},`Join ${Na.displayName}`),Oe("button.secondary",{onclick:()=>{ia.open({modalView:()=>Oe(za)})}},"I already paid with a different email"),Oe("button.secondary",{onclick:()=>{va.logOut(),ia.close()}},`Log out of ${null==(t=va.loggedInUser)?void 0:t.email}`)])}},za=()=>{let e="";const t=async t=>{if(t.preventDefault(),!Na.subdomain)return;const n=await Os("tryConnectingToMinisite",{subdomain:Na.subdomain,email:e}),i=n.result.status;if("email is not a paid member"===i)ia.open({modalView:()=>Oe(Wa,{email:e})});else if("email is already connected to another account"===i){const t=n.result.maskedEmail;ia.open({modalView:()=>Oe(Ga,{email:e,maskedEmail:t})})}else await va.refreshLoggedInUser(),ja()};return{view:()=>Oe(".modal-box.minisite-login-modal",[Oe(sa),Oe("p","Enter the email that you used to pay for ",Oe("strong",Na.displayName)),Oe("form",{onsubmit:t},[Oe("input",{type:"email",placeholder:"Email",value:e,oninput:t=>{e=t.target.value}}),Oe("button",{type:"submit"},"Continue")])])}},Wa={view:({attrs:e})=>Oe(".modal-box.minisite-login-modal",[Oe(sa),Oe("p",[Oe("strong",e.email)," is not a paid member of ",Oe("strong",Na.displayName)]),Oe("button",{onclick:()=>{window.open(Na.joinLink,"_blank"),ia.close()}},`Join ${Na.displayName}`),Oe("button.secondary",{onclick:()=>{ia.open({modalView:()=>Oe(za)})}},"Oops, I misspelled my email"),Oe("p",["If you already paid and are having trouble logging in, contact ",Oe("a",{href:`mailto:${Na.supportEmail}`},Na.supportEmail)])])},Ga={view({attrs:e}){var t;return Oe(".modal-box.minisite-login-modal",[Oe(sa),Oe("p",[Oe("strong",e.email)," is already connected to the Cuttle account ",Oe("strong",e.maskedEmail)]),Oe("p",["If you believe this is an error, contact ",Oe("a",{href:`mailto:${Na.supportEmail}`},Na.supportEmail)]),Oe("button.secondary",{onclick:()=>{va.logOut(),ia.close()}},`Log out of ${null==(t=va.loggedInUser)?void 0:t.email}`)])}},$a={view:()=>Oe(".modal-box.minisite-login-modal",[Oe(sa),Oe("p","This template requires a paid membership to ",Oe("strong",Na.displayName)),Oe("button",{onclick:()=>{window.open(Na.joinLink,"_blank"),ia.close()}},`Join ${Na.displayName}`),Oe("button.secondary",{onclick:ja},"I've already joined")])};class Za{constructor(){}canDownload(){if("local"===Oj.storage.type)return{hasAccess:!0,shouldCountTowardsDownloadLimit:!1};if(Na.isMinisite())return Na.loggedInUserHasAccess()?{hasAccess:!0,shouldCountTowardsDownloadLimit:!1}:{hasAccess:!1,reason:"no-minisite"};if(Oj.storage.isProTemplate())return this.hasProFeature("templates")?{hasAccess:!0,shouldCountTowardsDownloadLimit:!1}:{hasAccess:!1,reason:"no-pro",feature:"templates"};if(Oj.project.usesProFont()&&!this.isProjectPartOfTemporaryEtsyExemptionTrial()&&!this.hasProFeature("pro-fonts"))return{hasAccess:!1,reason:"no-pro",feature:"pro-fonts"};if(Oj.project.usesCustomFont()&&!this.hasProFeature("fonts"))return{hasAccess:!1,reason:"no-pro",feature:"fonts"};if(!va.loggedInUser)return{hasAccess:!1,reason:"no-auth"};if(!va.featureFlags.canDownloadUnlimitedFree){if(this.isProjectPartOfTemporaryEtsyExemptionTrial())return{hasAccess:!0,shouldCountTowardsDownloadLimit:!1};const e=va.downloadsRemaining();return!e||e<1?{hasAccess:!1,reason:"no-pro",feature:"downloads"}:{hasAccess:!0,shouldCountTowardsDownloadLimit:!0}}return{hasAccess:!0,shouldCountTowardsDownloadLimit:!1}}canEdit(){return"local"===Oj.storage.type?{hasAccess:!0}:Na.isMinisite()?{hasAccess:!1,reason:"no-minisite"}:Oj.storage.isProTemplate()?this.hasProFeature("templates")?{hasAccess:!0}:{hasAccess:!1,reason:"no-pro",feature:"templates"}:{hasAccess:!0}}canLicensePro(){return va.featureFlags.canLicensePro}canLicenseMinisite(){return va.featureFlags.canLicenseMinisite}canSearchNounProject(){return this.hasProFeature("noun-project")}canUploadImages(){return this.hasProFeature("images")}hasProFeature(e){return!(!va.isSubscriptionEducationFree()||"images"!==e&&"fonts"!==e&&"beta"!==e)||va.featureFlags.hasProFeatures}isProjectPartOfTemporaryEtsyExemptionTrial(){return["taylorlynncrafts","aweebitsouthern"].includes(Oj.storage.getProjectOwner().toLowerCase())&&"unlisted"===Oj.storage.getShareStatus()}}const qa=e=>t=>t instanceof It?new It(e(t.x),e(t.y)):e(t),Ka=e=>(t,n)=>{const i=t instanceof It,r=n instanceof It;if(!i&&!r)return e(t,n);const s=i?t.x:t,o=i?t.y:t,a=r?n.x:n,l=r?n.y:n;return new It(e(s,a),e(o,l))},Ya=e=>(t,n,i)=>{const r=t instanceof It,s=n instanceof It,o=i instanceof It;if(!r&&!s&&!o)return e(t,n,i);const a=r?t.x:t,l=r?t.y:t,c=s?n.x:n,h=s?n.y:n,u=o?i.x:i,d=o?i.y:i;return new It(e(a,c,u),e(l,h,d))},Xa=e=>(...t)=>{if(!t.some(e=>e instanceof It))return e.apply(void 0,t);const n=[],i=[];for(let e of t){const t=e instanceof It;n.push(t?e.x:e),i.push(t?e.y:e)}return new It(e.apply(void 0,n),e.apply(void 0,i))},Ja=qa(Math.abs),Qa=qa(Math.sign),el=qa(Math.floor),tl=qa(Math.ceil),nl=qa(Math.round),il=qa(Math.trunc),rl=Xa(Math.max),sl=Xa(Math.min),ol=Ya(xt),al=Ya(Ct),ll=qa(St),cl=Ya(kt),hl=qa(Lt),ul=Ka(Et),dl=Ya(Pt),pl=Object.freeze(Object.defineProperty({__proto__:null,abs:Ja,ceil:tl,clamp:al,floor:el,fract:hl,max:rl,min:sl,mix:ol,modulo:ul,moduloDistance:dl,round:nl,saturate:ll,sign:Qa,smoothstep:cl,trunc:il},Symbol.toStringTag,{value:"Module"})),fl=(e,t)=>{e.prototype=t.prototype;for(let n of Object.getOwnPropertyNames(t)){const i=t[n];"function"==typeof i&&(e[n]=i)}},ml=function(...e){return new Ot(...e)};fl(ml,Ot);const gl=function(e){return new Dt(e)};fl(gl,Dt);const vl=function(e){return new Nt(e)};fl(vl,Nt);const yl=function(e,t){return new It(e,t)};fl(yl,It);const bl=function(e,t,n,i,r,s){return new Ne(e,t,n,i,r,s)};fl(bl,Ne);const wl=function(e,t){return new De(e,t)};fl(wl,De);const xl=function(e,t,n,i){return new Gn(e,t,n,i)};fl(xl,Gn);const Cl=function(e,t,n,i,r,s,o){return new Vi(e,t,n,i,r,s,o)};fl(Cl,Vi);const Sl=function(e){return new ji(e)};fl(Sl,ji);const kl=function(e,t,n){return new Hi(e,t,n)};fl(kl,Hi);const Ll=function(e,t,n){return new Wn(e,t,n)};fl(Ll,Wn);const El=function(e,t){return new Rn(e,t)};fl(El,Rn);const Pl=function(e,t){return new jn(e,t)};fl(Pl,jn);const Tl=function(e,t){return new Bn(e,t)};fl(Tl,Bn);const Al=function(e,t,n,i){return new Fn(e,t,n,i)};fl(Al,Fn);const Ml=function(e,t,n,i){return new Ri(e,t,n,i)};fl(Ml,Ri);const Il=function(e,t,n){return new wi(e,t,n)};fl(Il,wi);const _l=function(e){return new xi(e)};fl(_l,xi);const Ol=function(e){return new Ui(e)};fl(Ol,Ui);const Nl=function(e,t){return new Tr(e,t)};fl(Nl,Tr);const Dl=Object.freeze(Object.defineProperty({__proto__:null,AffineMatrix:bl,Anchor:Ll,Axis:El,BoundingBox:wl,Color:xl,CompoundPath:Il,Containment:Ol,CubicSegment:Al,Fill:Sl,Font:Nl,Group:_l,ImageFill:kl,LineSegment:Tl,Path:Ml,Ray:Pl,RichText:ml,RichTextGlyph:gl,RichTextSymbol:vl,Stroke:Cl,Vec:yl},Symbol.toStringTag,{value:"Module"})),Rl=(e,t,n)=>{if(!Ss(e)&&!It.isValid(e))throw new Error("Value must be a number or Vec.");if(!Yr(t))throw new Error(`Source unit must be one of ${Zr.map(e=>`"${e}"`).join(", ")}`);if(!Yr(n))throw new Error(`Target unit must be one of ${Zr.map(e=>`"${e}"`).join(", ")}`);return Qr(e,t,n)},Fl=["image/bmp","image/gif","image/jpeg","image/png","image/webp"],Bl=[...Fl,"image/tiff","image/heic","image/heif"],Vl=[...Bl,"image/svg+xml"],jl=["font/ttf","font/otf","font/woff","font/woff2"],Hl=[...jl,"font/ttc"],Ul=[...Vl,...Hl],zl={otf:"font/otf",ttc:"font/ttc",ttf:"font/ttf",woff:"font/woff",woff2:"font/woff2"},Wl={...zl,bmp:"image/bmp",gif:"image/gif",heic:"image/heic",heif:"image/heif",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",webp:"image/webp"},Gl=e=>{const{type:t}=e;return t&&Ul.includes(t)?t:$l(e.name)},$l=e=>{const t=mo(e);if(t&&Wl.hasOwnProperty(t))return Wl[t]},Zl=e=>{const t=Gl(e);return!!t&&Bl.includes(t)};const ql=new class{constructor(){this.loadedImages={},this.subscribers=new Set,this.getImageFromURL=e=>{if(e){if(e=ec(e),this.loadedImages.hasOwnProperty(e))return this.loadedImages[e];this.loadedImages[e]=void 0,Kl(e).then(t=>{this.loadedImages[e]=t;for(let e of this.subscribers)e()}).catch(e=>{console.warn("Image loading error:",e)})}}}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}},Kl=async e=>{const t=await Is(e,{method:"GET",mode:"cors"}),n=await t.blob(),[i,r]=await Promise.all([Xl(n),Yl(n)]);return new Dr(i,r)},Yl=e=>new Promise(async(t,n)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=()=>n(i.error),i.readAsDataURL(e)}),Xl=async e=>new Promise((t,n)=>{const i=document.createElement("img");i.addEventListener("load",()=>t(i)),i.addEventListener("error",()=>n("Could not read image")),i.crossOrigin="anonymous",i.src=URL.createObjectURL(e),i.deleteURL=function(){URL.revokeObjectURL(this.src)}}),Jl="cuttle-image://",Ql={"image/bmp":"jpg","image/gif":"png","image/tiff":"jpg","image/heic":"jpg","image/heif":"jpg"},ec=e=>{if(!e.startsWith(Jl))return e;const t=e.slice(15),n=$l(e);if(n){const e=Ql[n];if(e){return`https://${fr}.imgix.net/${t}${`?q=80&fm=${e}`}`}}return`https://${fr}.imgix.net/${t}`},tc="data:image/svg+xml;nounProjectId=";class nc extends Error{constructor(e,t){super("Noun project icon too large!"),this.id=e,this.fileSize=t}}const ic=new class{constructor(){this.query="",this.results=[],this.error=void 0,this.status="unsearched",this.loadingDataUrlsById=new Map,this.subscribers=new Set,this.queryNounProjectDebounced=bo(this.queryNounProject.bind(this),2e3)}async getDataUrlForIcon(e,t){const n=this.loadingDataUrlsById.get(e);if(ks(n))return n;if(n instanceof Promise)return await n;const i=this.results.find(t=>t.id===e);if(!(null==i?void 0:i.icon_url))throw new Error(`Failed to fetch Noun Project info for ID ${e}`);const r=(null==t?void 0:t.maxFileSize)??1e5,s=await(async e=>{try{const t=(await Is(e,{method:"HEAD"})).headers.get("Content-Length");if(null!==t)return parseFloat(t)}catch(t){}})(i.icon_url);if(s&&s>=r)throw new nc(e,s);const o=this.cuttleDataUrlFromNounProjectSVG(e,i.icon_url);return this.loadingDataUrlsById.set(e,o),o.then(t=>{this.loadingDataUrlsById.set(e,t)}),o}async cuttleDataUrlFromNounProjectSVG(e,t){const n=await cc(t),i=window.btoa(n);return`${tc}${e};base64,${i}`}async queryNounProject(){if(""===this.query)this.results=[],this.status="unsearched";else{const t=this.query;this.pendingQuery=t;try{const e=await Os("nounProjectSearch",{query:t});if(this.pendingQuery!==t)return;e.results&&(this.results=e.results,this.status="success")}catch(e){if(this.pendingQuery!==t)return;console.error("Error searching Noun Project:",e),this.error="Failed to search Noun Project.",this.status="error"}Ao("noun project search",{query:t})}this.notifySubscribers()}setQuery(e){(e=e.toLocaleLowerCase().trim())!==this.query&&(this.query=e,this.results=[],this.error=void 0,""===this.query?this.status="unsearched":(this.status="searching",this.queryNounProjectDebounced()))}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}notifySubscribers(){for(let e of this.subscribers)e()}},rc="cuttle-icon://";function sc(e){if(e.startsWith(tc)){const t=33;let n=e.indexOf(";",t);n<=t&&(n=e.length);return{type:"noun project",nounProjectId:e.slice(t,n)}}if(e.startsWith(rc)){return{type:"icon upload",path:e.slice(14)}}try{const t=new URL(e);if("https:"!==t.protocol)return{type:"error",message:'URL protocol should be "https:"'};if(t.origin!==ur)return{type:"error",message:'URL host should be "assets.cuttle.xyz"'};const[n,i,r]=t.pathname.split("/");if("noto-emoji-600"!==i&&"symbols"!==i)return{type:"error",message:"URL directory should be known"};const[s,o]=r.split(".");return"svg"!==o?{type:"error",message:'URL extension should be "svg"'}:{type:"asset",url:t,directory:i,name:s,extension:o}}catch(t){return{type:"error",message:"Invalid URL"}}}const oc=new class{constructor(){this.loadedExternalSVGs={},this.subscribers=new Set,this.getEmojiSVGFromURL=e=>{const t=sc(e);if("error"===t.type)throw t.message;if(e=lc(e),this.loadedExternalSVGs.hasOwnProperty(e)){const t=this.loadedExternalSVGs[e];return t?t.clone():void 0}this.loadedExternalSVGs[e]=void 0,ac(e).then(t=>{t.removeFill(),t.removeStroke(),this.loadedExternalSVGs[e]=t;for(let e of this.subscribers)e()}).catch(e=>{console.warn("ExternalSVG loading error:",e)})}}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}},ac=async e=>{let t;if(e instanceof File)t=await e.text();else{const n=await Is(e);t=await n.text()}const n=Fr(t,{units:Oj.project.settings.units,origin:"middle",fitSize:new It(1,1)});if(!n)throw new Error("Could not parse external SVG");return n},lc=e=>{if(e.startsWith(rc)){const t=e.slice(14);return`/${mr}/${t}`}return kr(e)},cc=async e=>{const t=await ac(e);if(t.hasStyle())for(const s of t.allPathsAndCompoundPaths())s.stroke&&(s.stroke.hairline=!1);else t.assignFill(new ji);const n=xi.flatten(t);let i;if(1===n.items.length){const e=n.items[0];e instanceof Ri?i=new wi([e]):e instanceof wi&&(i=e)}void 0===i&&(i=wi.booleanUnion(n.items)),i.assignFill(new ji);const r=Ri.fromBoundingBox(new De(new It(-.5,-.5),new It(.5,.5)));i=wi.booleanIntersect([i,r]);return`<svg width="32" height="32" viewBox="-0.5 -0.5 1 1" xmlns="http://www.w3.org/2000/svg"><path d="${i.toSVGPathString(5)}" fill-rule="evenodd"/></svg>`};var hc,uc;
/*! https://mths.be/codepointat v0.2.0 by @mathias */
String.prototype.codePointAt||(hc=function(){try{var e={},t=Object.defineProperty,n=t(e,e,e)&&t}catch(i){}return n}(),uc=function(e){if(null==this)throw TypeError();var t=String(this),n=t.length,i=e?Number(e):0;if(i!=i&&(i=0),!(i<0||i>=n)){var r,s=t.charCodeAt(i);return s>=55296&&s<=56319&&n>i+1&&(r=t.charCodeAt(i+1))>=56320&&r<=57343?1024*(s-55296)+r-56320+65536:s}},hc?hc(String.prototype,"codePointAt",{value:uc,configurable:!0,writable:!0}):String.prototype.codePointAt=uc);function dc(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function pc(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new dc,this.dtree=new dc}var fc=new dc,mc=new dc,gc=new Uint8Array(30),vc=new Uint16Array(30),yc=new Uint8Array(30),bc=new Uint16Array(30),wc=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xc=new dc,Cc=new Uint8Array(320);function Sc(e,t,n,i){var r,s;for(r=0;r<n;++r)e[r]=0;for(r=0;r<30-n;++r)e[r+n]=r/n|0;for(s=i,r=0;r<30;++r)t[r]=s,s+=1<<e[r]}var kc=new Uint16Array(16);function Lc(e,t,n,i){var r,s;for(r=0;r<16;++r)e.table[r]=0;for(r=0;r<i;++r)e.table[t[n+r]]++;for(e.table[0]=0,s=0,r=0;r<16;++r)kc[r]=s,s+=e.table[r];for(r=0;r<i;++r)t[n+r]&&(e.trans[kc[t[n+r]]++]=r)}function Ec(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function Pc(e,t,n){if(!t)return n;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var i=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,i+n}function Tc(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=0,i=0,r=0,s=e.tag;do{i=2*i+(1&s),s>>>=1,++r,n+=t.table[r],i-=t.table[r]}while(i>=0);return e.tag=s,e.bitcount-=r,t.trans[n+i]}function Ac(e,t,n){var i,r,s,o,a,l;for(i=Pc(e,5,257),r=Pc(e,5,1),s=Pc(e,4,4),o=0;o<19;++o)Cc[o]=0;for(o=0;o<s;++o){var c=Pc(e,3,0);Cc[wc[o]]=c}for(Lc(xc,Cc,0,19),a=0;a<i+r;){var h=Tc(e,xc);switch(h){case 16:var u=Cc[a-1];for(l=Pc(e,2,3);l;--l)Cc[a++]=u;break;case 17:for(l=Pc(e,3,3);l;--l)Cc[a++]=0;break;case 18:for(l=Pc(e,7,11);l;--l)Cc[a++]=0;break;default:Cc[a++]=h}}Lc(t,Cc,0,i),Lc(n,Cc,i,r)}function Mc(e,t,n){for(;;){var i,r,s,o,a=Tc(e,t);if(256===a)return 0;if(a<256)e.dest[e.destLen++]=a;else for(i=Pc(e,gc[a-=257],vc[a]),r=Tc(e,n),o=s=e.destLen-Pc(e,yc[r],bc[r]);o<s+i;++o)e.dest[e.destLen++]=e.dest[o]}}function Ic(e){for(var t,n;e.bitcount>8;)e.sourceIndex--,e.bitcount-=8;if((t=256*(t=e.source[e.sourceIndex+1])+e.source[e.sourceIndex])!==(65535&~(256*e.source[e.sourceIndex+3]+e.source[e.sourceIndex+2])))return-3;for(e.sourceIndex+=4,n=t;n;--n)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,0}!function(e,t){var n;for(n=0;n<7;++n)e.table[n]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,n=0;n<24;++n)e.trans[n]=256+n;for(n=0;n<144;++n)e.trans[24+n]=n;for(n=0;n<8;++n)e.trans[168+n]=280+n;for(n=0;n<112;++n)e.trans[176+n]=144+n;for(n=0;n<5;++n)t.table[n]=0;for(t.table[5]=32,n=0;n<32;++n)t.trans[n]=n}(fc,mc),Sc(gc,vc,4,3),Sc(yc,bc,2,1),gc[28]=0,vc[28]=258;var _c=function(e,t){var n,i,r=new pc(e,t);do{switch(n=Ec(r),Pc(r,2,0)){case 0:i=Ic(r);break;case 1:i=Mc(r,fc,mc);break;case 2:Ac(r,r.ltree,r.dtree),i=Mc(r,r.ltree,r.dtree);break;default:i=-3}if(0!==i)throw new Error("Data error")}while(!n);return r.destLen<r.dest.length?"function"==typeof r.dest.slice?r.dest.slice(0,r.destLen):r.dest.subarray(0,r.destLen):r.dest};function Oc(e,t,n,i,r){return Math.pow(1-r,3)*e+3*Math.pow(1-r,2)*r*t+3*(1-r)*Math.pow(r,2)*n+Math.pow(r,3)*i}function Nc(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function Dc(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function Rc(e){throw new Error(e)}function Fc(e,t){e||Rc(t)}Nc.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},Nc.prototype.addPoint=function(e,t){"number"==typeof e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),"number"==typeof t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},Nc.prototype.addX=function(e){this.addPoint(e,null)},Nc.prototype.addY=function(e){this.addPoint(null,e)},Nc.prototype.addBezier=function(e,t,n,i,r,s,o,a){var l=[e,t],c=[n,i],h=[r,s],u=[o,a];this.addPoint(e,t),this.addPoint(o,a);for(var d=0;d<=1;d++){var p=6*l[d]-12*c[d]+6*h[d],f=-3*l[d]+9*c[d]-9*h[d]+3*u[d],m=3*c[d]-3*l[d];if(0!==f){var g=Math.pow(p,2)-4*m*f;if(!(g<0)){var v=(-p+Math.sqrt(g))/(2*f);0<v&&v<1&&(0===d&&this.addX(Oc(l[d],c[d],h[d],u[d],v)),1===d&&this.addY(Oc(l[d],c[d],h[d],u[d],v)));var y=(-p-Math.sqrt(g))/(2*f);0<y&&y<1&&(0===d&&this.addX(Oc(l[d],c[d],h[d],u[d],y)),1===d&&this.addY(Oc(l[d],c[d],h[d],u[d],y)))}}else{if(0===p)continue;var b=-m/p;0<b&&b<1&&(0===d&&this.addX(Oc(l[d],c[d],h[d],u[d],b)),1===d&&this.addY(Oc(l[d],c[d],h[d],u[d],b)))}}},Nc.prototype.addQuad=function(e,t,n,i,r,s){var o=e+2/3*(n-e),a=t+2/3*(i-t),l=o+1/3*(r-e),c=a+1/3*(s-t);this.addBezier(e,t,o,a,l,c,r,s)},Dc.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},Dc.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},Dc.prototype.curveTo=Dc.prototype.bezierCurveTo=function(e,t,n,i,r,s){this.commands.push({type:"C",x1:e,y1:t,x2:n,y2:i,x:r,y:s})},Dc.prototype.quadTo=Dc.prototype.quadraticCurveTo=function(e,t,n,i){this.commands.push({type:"Q",x1:e,y1:t,x:n,y:i})},Dc.prototype.close=Dc.prototype.closePath=function(){this.commands.push({type:"Z"})},Dc.prototype.extend=function(e){if(e.commands)e=e.commands;else if(e instanceof Nc){var t=e;return this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),void this.close()}Array.prototype.push.apply(this.commands,e)},Dc.prototype.getBoundingBox=function(){for(var e=new Nc,t=0,n=0,i=0,r=0,s=0;s<this.commands.length;s++){var o=this.commands[s];switch(o.type){case"M":e.addPoint(o.x,o.y),t=i=o.x,n=r=o.y;break;case"L":e.addPoint(o.x,o.y),i=o.x,r=o.y;break;case"Q":e.addQuad(i,r,o.x1,o.y1,o.x,o.y),i=o.x,r=o.y;break;case"C":e.addBezier(i,r,o.x1,o.y1,o.x2,o.y2,o.x,o.y),i=o.x,r=o.y;break;case"Z":i=t,r=n;break;default:throw new Error("Unexpected path command "+o.type)}}return e.isEmpty()&&e.addPoint(0,0),e},Dc.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var n=this.commands[t];"M"===n.type?e.moveTo(n.x,n.y):"L"===n.type?e.lineTo(n.x,n.y):"C"===n.type?e.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):"Q"===n.type?e.quadraticCurveTo(n.x1,n.y1,n.x,n.y):"Z"===n.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},Dc.prototype.toPathData=function(e){function t(t){return Math.round(t)===t?""+Math.round(t):t.toFixed(e)}function n(){for(var e=arguments,n="",i=0;i<arguments.length;i+=1){var r=e[i];r>=0&&i>0&&(n+=" "),n+=t(r)}return n}e=void 0!==e?e:2;for(var i="",r=0;r<this.commands.length;r+=1){var s=this.commands[r];"M"===s.type?i+="M"+n(s.x,s.y):"L"===s.type?i+="L"+n(s.x,s.y):"C"===s.type?i+="C"+n(s.x1,s.y1,s.x2,s.y2,s.x,s.y):"Q"===s.type?i+="Q"+n(s.x1,s.y1,s.x,s.y):"Z"===s.type&&(i+="Z")}return i},Dc.prototype.toSVG=function(e){var t='<path d="';return t+=this.toPathData(e),t+='"',this.fill&&"black"!==this.fill&&(null===this.fill?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>"},Dc.prototype.toDOMElement=function(e){var t=this.toPathData(e),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",t),n};var Bc={fail:Rc,argument:Fc,assert:Fc},Vc=2147483648,jc={},Hc={},Uc={};function zc(e){return function(){return e}}Hc.BYTE=function(e){return Bc.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},Uc.BYTE=zc(1),Hc.CHAR=function(e){return[e.charCodeAt(0)]},Uc.CHAR=zc(1),Hc.CHARARRAY=function(e){void 0===e&&(e="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var t=[],n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return t},Uc.CHARARRAY=function(e){return void 0===e?0:e.length},Hc.USHORT=function(e){return[e>>8&255,255&e]},Uc.USHORT=zc(2),Hc.SHORT=function(e){return e>=32768&&(e=-(65536-e)),[e>>8&255,255&e]},Uc.SHORT=zc(2),Hc.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},Uc.UINT24=zc(3),Hc.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},Uc.ULONG=zc(4),Hc.LONG=function(e){return e>=Vc&&(e=-(2*Vc-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},Uc.LONG=zc(4),Hc.FIXED=Hc.ULONG,Uc.FIXED=Uc.ULONG,Hc.FWORD=Hc.SHORT,Uc.FWORD=Uc.SHORT,Hc.UFWORD=Hc.USHORT,Uc.UFWORD=Uc.USHORT,Hc.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},Uc.LONGDATETIME=zc(8),Hc.TAG=function(e){return Bc.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},Uc.TAG=zc(4),Hc.Card8=Hc.BYTE,Uc.Card8=Uc.BYTE,Hc.Card16=Hc.USHORT,Uc.Card16=Uc.USHORT,Hc.OffSize=Hc.BYTE,Uc.OffSize=Uc.BYTE,Hc.SID=Hc.USHORT,Uc.SID=Uc.USHORT,Hc.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?[247+((e-=108)>>8),255&e]:e>=-1131&&e<=-108?[251+((e=-e-108)>>8),255&e]:e>=-32768&&e<=32767?Hc.NUMBER16(e):Hc.NUMBER32(e)},Uc.NUMBER=function(e){return Hc.NUMBER(e).length},Hc.NUMBER16=function(e){return[28,e>>8&255,255&e]},Uc.NUMBER16=zc(3),Hc.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},Uc.NUMBER32=zc(5),Hc.REAL=function(e){var t=e.toString(),n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(n){var i=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));t=(Math.round(e*i)/i).toString()}for(var r="",s=0,o=t.length;s<o;s+=1){var a=t[s];r+="e"===a?"-"===t[++s]?"c":"b":"."===a?"a":"-"===a?"e":a}for(var l=[30],c=0,h=(r+=1&r.length?"f":"ff").length;c<h;c+=2)l.push(parseInt(r.substr(c,2),16));return l},Uc.REAL=function(e){return Hc.REAL(e).length},Hc.NAME=Hc.CHARARRAY,Uc.NAME=Uc.CHARARRAY,Hc.STRING=Hc.CHARARRAY,Uc.STRING=Uc.CHARARRAY,jc.UTF8=function(e,t,n){for(var i=[],r=n,s=0;s<r;s++,t+=1)i[s]=e.getUint8(t);return String.fromCharCode.apply(null,i)},jc.UTF16=function(e,t,n){for(var i=[],r=n/2,s=0;s<r;s++,t+=2)i[s]=e.getUint16(t);return String.fromCharCode.apply(null,i)},Hc.UTF16=function(e){for(var t=[],n=0;n<e.length;n+=1){var i=e.charCodeAt(n);t[t.length]=i>>8&255,t[t.length]=255&i}return t},Uc.UTF16=function(e){return 2*e.length};var Wc={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};jc.MACSTRING=function(e,t,n,i){var r=Wc[i];if(void 0!==r){for(var s="",o=0;o<n;o++){var a=e.getUint8(t+o);s+=a<=127?String.fromCharCode(a):r[127&a]}return s}};var Gc,$c="function"==typeof WeakMap&&new WeakMap;function Zc(e){return e>=-128&&e<=127}function qc(e,t,n){for(var i=0,r=e.length;t<r&&i<64&&0===e[t];)++t,++i;return n.push(128|i-1),t}function Kc(e,t,n){for(var i=0,r=e.length,s=t;s<r&&i<64;){var o=e[s];if(!Zc(o))break;if(0===o&&s+1<r&&0===e[s+1])break;++s,++i}n.push(i-1);for(var a=t;a<s;++a)n.push(e[a]+256&255);return s}function Yc(e,t,n){for(var i=0,r=e.length,s=t;s<r&&i<64;){var o=e[s];if(0===o)break;if(Zc(o)&&s+1<r&&Zc(e[s+1]))break;++s,++i}n.push(64|i-1);for(var a=t;a<s;++a){var l=e[a];n.push(l+65536>>8&255,l+256&255)}return s}Hc.MACSTRING=function(e,t){var n=function(e){if(!Gc)for(var t in Gc={},Wc)Gc[t]=new String(t);var n=Gc[e];if(void 0!==n){if($c){var i=$c.get(n);if(void 0!==i)return i}var r=Wc[e];if(void 0!==r){for(var s={},o=0;o<r.length;o++)s[r.charCodeAt(o)]=o+128;return $c&&$c.set(n,s),s}}}(t);if(void 0!==n){for(var i=[],r=0;r<e.length;r++){var s=e.charCodeAt(r);if(s>=128&&void 0===(s=n[s]))return;i[r]=s}return i}},Uc.MACSTRING=function(e,t){var n=Hc.MACSTRING(e,t);return void 0!==n?n.length:0},Hc.VARDELTAS=function(e){for(var t=0,n=[];t<e.length;){var i=e[t];t=0===i?qc(e,t,n):i>=-128&&i<=127?Kc(e,t,n):Yc(e,t,n)}return n},Hc.INDEX=function(e){for(var t=1,n=[t],i=[],r=0;r<e.length;r+=1){var s=Hc.OBJECT(e[r]);Array.prototype.push.apply(i,s),t+=s.length,n.push(t)}if(0===i.length)return[0,0];for(var o=[],a=1+Math.floor(Math.log(t)/Math.log(2))/8|0,l=[void 0,Hc.BYTE,Hc.USHORT,Hc.UINT24,Hc.ULONG][a],c=0;c<n.length;c+=1){var h=l(n[c]);Array.prototype.push.apply(o,h)}return Array.prototype.concat(Hc.Card16(e.length),Hc.OffSize(a),o,i)},Uc.INDEX=function(e){return Hc.INDEX(e).length},Hc.DICT=function(e){for(var t=[],n=Object.keys(e),i=n.length,r=0;r<i;r+=1){var s=parseInt(n[r],0),o=e[s];t=(t=t.concat(Hc.OPERAND(o.value,o.type))).concat(Hc.OPERATOR(s))}return t},Uc.DICT=function(e){return Hc.DICT(e).length},Hc.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},Hc.OPERAND=function(e,t){var n=[];if(Array.isArray(t))for(var i=0;i<t.length;i+=1)Bc.argument(e.length===t.length,"Not enough arguments given for type"+t),n=n.concat(Hc.OPERAND(e[i],t[i]));else if("SID"===t)n=n.concat(Hc.NUMBER(e));else if("offset"===t)n=n.concat(Hc.NUMBER32(e));else if("number"===t)n=n.concat(Hc.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);n=n.concat(Hc.REAL(e))}return n},Hc.OP=Hc.BYTE,Uc.OP=Uc.BYTE;var Xc="function"==typeof WeakMap&&new WeakMap;function Jc(e,t,n){if(t.length&&("coverageFormat"!==t[0].name||1===t[0].value))for(var i=0;i<t.length;i+=1){var r=t[i];this[r.name]=r.value}if(this.tableName=e,this.fields=t,n)for(var s=Object.keys(n),o=0;o<s.length;o+=1){var a=s[o],l=n[a];void 0!==this[a]&&(this[a]=l)}}function Qc(e,t,n){void 0===n&&(n=t.length);var i=new Array(t.length+1);i[0]={name:e+"Count",type:"USHORT",value:n};for(var r=0;r<t.length;r++)i[r+1]={name:e+r,type:"USHORT",value:t[r]};return i}function eh(e,t,n){var i=t.length,r=new Array(i+1);r[0]={name:e+"Count",type:"USHORT",value:i};for(var s=0;s<i;s++)r[s+1]={name:e+s,type:"TABLE",value:n(t[s],s)};return r}function th(e,t,n){var i=t.length,r=[];r[0]={name:e+"Count",type:"USHORT",value:i};for(var s=0;s<i;s++)r=r.concat(n(t[s],s));return r}function nh(e){1===e.format?Jc.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(Qc("glyph",e.glyphs))):2===e.format?Jc.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(th("rangeRecord",e.ranges,function(e){return[{name:"startGlyphID",type:"USHORT",value:e.start},{name:"endGlyphID",type:"USHORT",value:e.end},{name:"startCoverageIndex",type:"USHORT",value:e.index}]}))):Bc.assert(!1,"Coverage format must be 1 or 2.")}function ih(e){Jc.call(this,"scriptListTable",th("scriptRecord",e,function(e,t){var n=e.script,i=n.defaultLangSys;return Bc.assert(!!i,"Unable to write GSUB: script "+e.tag+" has no default language system."),[{name:"scriptTag"+t,type:"TAG",value:e.tag},{name:"script"+t,type:"TABLE",value:new Jc("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new Jc("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:i.reqFeatureIndex}].concat(Qc("featureIndex",i.featureIndexes)))}].concat(th("langSys",n.langSysRecords,function(e,t){var n=e.langSys;return[{name:"langSysTag"+t,type:"TAG",value:e.tag},{name:"langSys"+t,type:"TABLE",value:new Jc("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(Qc("featureIndex",n.featureIndexes)))}]})))}]}))}function rh(e){Jc.call(this,"featureListTable",th("featureRecord",e,function(e,t){var n=e.feature;return[{name:"featureTag"+t,type:"TAG",value:e.tag},{name:"feature"+t,type:"TABLE",value:new Jc("featureTable",[{name:"featureParams",type:"USHORT",value:n.featureParams}].concat(Qc("lookupListIndex",n.lookupListIndexes)))}]}))}function sh(e,t){Jc.call(this,"lookupListTable",eh("lookup",e,function(e){var n=t[e.lookupType];return Bc.assert(!!n,"Unable to write GSUB lookup type "+e.lookupType+" tables."),new Jc("lookupTable",[{name:"lookupType",type:"USHORT",value:e.lookupType},{name:"lookupFlag",type:"USHORT",value:e.lookupFlag}].concat(eh("subtable",e.subtables,n)))}))}Hc.CHARSTRING=function(e){if(Xc){var t=Xc.get(e);if(void 0!==t)return t}for(var n=[],i=e.length,r=0;r<i;r+=1){var s=e[r];n=n.concat(Hc[s.type](s.value))}return Xc&&Xc.set(e,n),n},Uc.CHARSTRING=function(e){return Hc.CHARSTRING(e).length},Hc.OBJECT=function(e){var t=Hc[e.type];return Bc.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},Uc.OBJECT=function(e){var t=Uc[e.type];return Bc.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},Hc.TABLE=function(e){for(var t=[],n=e.fields.length,i=[],r=[],s=0;s<n;s+=1){var o=e.fields[s],a=Hc[o.type];Bc.argument(void 0!==a,"No encoding function for field type "+o.type+" ("+o.name+")");var l=e[o.name];void 0===l&&(l=o.value);var c=a(l);"TABLE"===o.type?(r.push(t.length),t=t.concat([0,0]),i.push(c)):t=t.concat(c)}for(var h=0;h<i.length;h+=1){var u=r[h],d=t.length;Bc.argument(d<65536,"Table "+e.tableName+" too big."),t[u]=d>>8,t[u+1]=255&d,t=t.concat(i[h])}return t},Uc.TABLE=function(e){for(var t=0,n=e.fields.length,i=0;i<n;i+=1){var r=e.fields[i],s=Uc[r.type];Bc.argument(void 0!==s,"No sizeOf function for field type "+r.type+" ("+r.name+")");var o=e[r.name];void 0===o&&(o=r.value),t+=s(o),"TABLE"===r.type&&(t+=2)}return t},Hc.RECORD=Hc.TABLE,Uc.RECORD=Uc.TABLE,Hc.LITERAL=function(e){return e},Uc.LITERAL=function(e){return e.length},Jc.prototype.encode=function(){return Hc.TABLE(this)},Jc.prototype.sizeOf=function(){return Uc.TABLE(this)},nh.prototype=Object.create(Jc.prototype),nh.prototype.constructor=nh,ih.prototype=Object.create(Jc.prototype),ih.prototype.constructor=ih,rh.prototype=Object.create(Jc.prototype),rh.prototype.constructor=rh,sh.prototype=Object.create(Jc.prototype),sh.prototype.constructor=sh;var oh={Table:Jc,Record:Jc,Coverage:nh,ScriptList:ih,FeatureList:rh,LookupList:sh,ushortList:Qc,tableList:eh,recordList:th};function ah(e,t){return e.getUint8(t)}function lh(e,t){return e.getUint16(t,!1)}function ch(e,t){return e.getUint32(t,!1)}function hh(e,t){return e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535}var uh={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function dh(e,t){this.data=e,this.offset=t,this.relativeOffset=0}dh.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},dh.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},dh.prototype.parseCard8=dh.prototype.parseByte,dh.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},dh.prototype.parseCard16=dh.prototype.parseUShort,dh.prototype.parseSID=dh.prototype.parseUShort,dh.prototype.parseOffset16=dh.prototype.parseUShort,dh.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},dh.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},dh.prototype.parseULong=function(){var e=ch(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},dh.prototype.parseOffset32=dh.prototype.parseULong,dh.prototype.parseFixed=function(){var e=hh(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},dh.prototype.parseString=function(e){var t=this.data,n=this.offset+this.relativeOffset,i="";this.relativeOffset+=e;for(var r=0;r<e;r++)i+=String.fromCharCode(t.getUint8(n+r));return i},dh.prototype.parseTag=function(){return this.parseString(4)},dh.prototype.parseLongDateTime=function(){var e=ch(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},dh.prototype.parseVersion=function(e){var t=lh(this.data,this.offset+this.relativeOffset),n=lh(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===e&&(e=4096),t+n/e/10},dh.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=uh[e]*t},dh.prototype.parseULongList=function(e){void 0===e&&(e=this.parseULong());for(var t=new Array(e),n=this.data,i=this.offset+this.relativeOffset,r=0;r<e;r++)t[r]=n.getUint32(i),i+=4;return this.relativeOffset+=4*e,t},dh.prototype.parseOffset16List=dh.prototype.parseUShortList=function(e){void 0===e&&(e=this.parseUShort());for(var t=new Array(e),n=this.data,i=this.offset+this.relativeOffset,r=0;r<e;r++)t[r]=n.getUint16(i),i+=2;return this.relativeOffset+=2*e,t},dh.prototype.parseShortList=function(e){for(var t=new Array(e),n=this.data,i=this.offset+this.relativeOffset,r=0;r<e;r++)t[r]=n.getInt16(i),i+=2;return this.relativeOffset+=2*e,t},dh.prototype.parseByteList=function(e){for(var t=new Array(e),n=this.data,i=this.offset+this.relativeOffset,r=0;r<e;r++)t[r]=n.getUint8(i++);return this.relativeOffset+=e,t},dh.prototype.parseList=function(e,t){t||(t=e,e=this.parseUShort());for(var n=new Array(e),i=0;i<e;i++)n[i]=t.call(this);return n},dh.prototype.parseList32=function(e,t){t||(t=e,e=this.parseULong());for(var n=new Array(e),i=0;i<e;i++)n[i]=t.call(this);return n},dh.prototype.parseRecordList=function(e,t){t||(t=e,e=this.parseUShort());for(var n=new Array(e),i=Object.keys(t),r=0;r<e;r++){for(var s={},o=0;o<i.length;o++){var a=i[o],l=t[a];s[a]=l.call(this)}n[r]=s}return n},dh.prototype.parseRecordList32=function(e,t){t||(t=e,e=this.parseULong());for(var n=new Array(e),i=Object.keys(t),r=0;r<e;r++){for(var s={},o=0;o<i.length;o++){var a=i[o],l=t[a];s[a]=l.call(this)}n[r]=s}return n},dh.prototype.parseStruct=function(e){if("function"==typeof e)return e.call(this);for(var t=Object.keys(e),n={},i=0;i<t.length;i++){var r=t[i],s=e[r];n[r]=s.call(this)}return n},dh.prototype.parseValueRecord=function(e){if(void 0===e&&(e=this.parseUShort()),0!==e){var t={};return 1&e&&(t.xPlacement=this.parseShort()),2&e&&(t.yPlacement=this.parseShort()),4&e&&(t.xAdvance=this.parseShort()),8&e&&(t.yAdvance=this.parseShort()),16&e&&(t.xPlaDevice=void 0,this.parseShort()),32&e&&(t.yPlaDevice=void 0,this.parseShort()),64&e&&(t.xAdvDevice=void 0,this.parseShort()),128&e&&(t.yAdvDevice=void 0,this.parseShort()),t}},dh.prototype.parseValueRecordList=function(){for(var e=this.parseUShort(),t=this.parseUShort(),n=new Array(t),i=0;i<t;i++)n[i]=this.parseValueRecord(e);return n},dh.prototype.parsePointer=function(e){var t=this.parseOffset16();if(t>0)return new dh(this.data,this.offset+t).parseStruct(e)},dh.prototype.parsePointer32=function(e){var t=this.parseOffset32();if(t>0)return new dh(this.data,this.offset+t).parseStruct(e)},dh.prototype.parseListOfLists=function(e){for(var t=this.parseOffset16List(),n=t.length,i=this.relativeOffset,r=new Array(n),s=0;s<n;s++){var o=t[s];if(0!==o)if(this.relativeOffset=o,e){for(var a=this.parseOffset16List(),l=new Array(a.length),c=0;c<a.length;c++)this.relativeOffset=o+a[c],l[c]=e.call(this);r[s]=l}else r[s]=this.parseUShortList();else r[s]=void 0}return this.relativeOffset=i,r},dh.prototype.parseCoverage=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort(),n=this.parseUShort();if(1===t)return{format:1,glyphs:this.parseUShortList(n)};if(2===t){for(var i=new Array(n),r=0;r<n;r++)i[r]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:i}}throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.")},dh.prototype.parseClassDef=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===t)return{format:2,ranges:this.parseRecordList({start:dh.uShort,end:dh.uShort,classId:dh.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},dh.list=function(e,t){return function(){return this.parseList(e,t)}},dh.list32=function(e,t){return function(){return this.parseList32(e,t)}},dh.recordList=function(e,t){return function(){return this.parseRecordList(e,t)}},dh.recordList32=function(e,t){return function(){return this.parseRecordList32(e,t)}},dh.pointer=function(e){return function(){return this.parsePointer(e)}},dh.pointer32=function(e){return function(){return this.parsePointer32(e)}},dh.tag=dh.prototype.parseTag,dh.byte=dh.prototype.parseByte,dh.uShort=dh.offset16=dh.prototype.parseUShort,dh.uShortList=dh.prototype.parseUShortList,dh.uLong=dh.offset32=dh.prototype.parseULong,dh.uLongList=dh.prototype.parseULongList,dh.struct=dh.prototype.parseStruct,dh.coverage=dh.prototype.parseCoverage,dh.classDef=dh.prototype.parseClassDef;var ph={reserved:dh.uShort,reqFeatureIndex:dh.uShort,featureIndexes:dh.uShortList};dh.prototype.parseScriptList=function(){return this.parsePointer(dh.recordList({tag:dh.tag,script:dh.pointer({defaultLangSys:dh.pointer(ph),langSysRecords:dh.recordList({tag:dh.tag,langSys:dh.pointer(ph)})})}))||[]},dh.prototype.parseFeatureList=function(){return this.parsePointer(dh.recordList({tag:dh.tag,feature:dh.pointer({featureParams:dh.offset16,lookupListIndexes:dh.uShortList})}))||[]},dh.prototype.parseLookupList=function(e){return this.parsePointer(dh.list(dh.pointer(function(){var t=this.parseUShort();Bc.argument(1<=t&&t<=9,"GPOS/GSUB lookup type "+t+" unknown.");var n=this.parseUShort(),i=16&n;return{lookupType:t,lookupFlag:n,subtables:this.parseList(dh.pointer(e[t])),markFilteringSet:i?this.parseUShort():void 0}})))||[]},dh.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var e=this.parseUShort(),t=this.parseUShort();return Bc.argument(1===e&&t<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:dh.offset32,featureTableSubstitutionOffset:dh.offset32})})||[]};var fh={getByte:ah,getCard8:ah,getUShort:lh,getCard16:lh,getShort:function(e,t){return e.getInt16(t,!1)},getULong:ch,getFixed:hh,getTag:function(e,t){for(var n="",i=t;i<t+4;i+=1)n+=String.fromCharCode(e.getInt8(i));return n},getOffset:function(e,t,n){for(var i=0,r=0;r<n;r+=1)i<<=8,i+=e.getUint8(t+r);return i},getBytes:function(e,t,n){for(var i=[],r=t;r<n;r+=1)i.push(e.getUint8(r));return i},bytesToString:function(e){for(var t="",n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return t},Parser:dh};function mh(e,t,n){e.segments.push({end:t,start:t,delta:-(t-n),offset:0,glyphIndex:n})}var gh={parse:function(e,t){var n={};n.version=fh.getUShort(e,t),Bc.argument(0===n.version,"cmap table version should be 0."),n.numTables=fh.getUShort(e,t+2);for(var i=-1,r=n.numTables-1;r>=0;r-=1){var s=fh.getUShort(e,t+4+8*r),o=fh.getUShort(e,t+4+8*r+2);if(3===s&&(0===o||1===o||10===o)||0===s&&(0===o||1===o||2===o||3===o||4===o)){i=fh.getULong(e,t+4+8*r+4);break}}if(-1===i)throw new Error("No valid cmap sub-tables found.");var a=new fh.Parser(e,t+i);if(n.format=a.parseUShort(),12===n.format)!function(e,t){var n;t.parseUShort(),e.length=t.parseULong(),e.language=t.parseULong(),e.groupCount=n=t.parseULong(),e.glyphIndexMap={};for(var i=0;i<n;i+=1)for(var r=t.parseULong(),s=t.parseULong(),o=t.parseULong(),a=r;a<=s;a+=1)e.glyphIndexMap[a]=o,o++}(n,a);else{if(4!==n.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+n.format+").");!function(e,t,n,i,r){var s;e.length=t.parseUShort(),e.language=t.parseUShort(),e.segCount=s=t.parseUShort()>>1,t.skip("uShort",3),e.glyphIndexMap={};for(var o=new fh.Parser(n,i+r+14),a=new fh.Parser(n,i+r+16+2*s),l=new fh.Parser(n,i+r+16+4*s),c=new fh.Parser(n,i+r+16+6*s),h=i+r+16+8*s,u=0;u<s-1;u+=1)for(var d=void 0,p=o.parseUShort(),f=a.parseUShort(),m=l.parseShort(),g=c.parseUShort(),v=f;v<=p;v+=1)0!==g?(h=c.offset+c.relativeOffset-2,h+=g,h+=2*(v-f),0!==(d=fh.getUShort(n,h))&&(d=d+m&65535)):d=v+m&65535,e.glyphIndexMap[v]=d}(n,a,e,t,i)}return n},make:function(e){var t,n=!0;for(t=e.length-1;t>0;t-=1){if(e.get(t).unicode>65535){n=!1;break}}var i=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:n?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:n?12:20}];n||(i=i.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),i=i.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var r=new oh.Table("cmap",i);for(r.segments=[],t=0;t<e.length;t+=1){for(var s=e.get(t),o=0;o<s.unicodes.length;o+=1)mh(r,s.unicodes[o],t);r.segments=r.segments.sort(function(e,t){return e.start-t.start})}!function(e){e.segments.push({end:65535,start:65535,delta:1,offset:0})}(r);var a=r.segments.length,l=0,c=[],h=[],u=[],d=[],p=[],f=[];for(t=0;t<a;t+=1){var m=r.segments[t];m.end<=65535&&m.start<=65535?(c=c.concat({name:"end_"+t,type:"USHORT",value:m.end}),h=h.concat({name:"start_"+t,type:"USHORT",value:m.start}),u=u.concat({name:"idDelta_"+t,type:"SHORT",value:m.delta}),d=d.concat({name:"idRangeOffset_"+t,type:"USHORT",value:m.offset}),void 0!==m.glyphId&&(p=p.concat({name:"glyph_"+t,type:"USHORT",value:m.glyphId}))):l+=1,n||void 0===m.glyphIndex||(f=(f=(f=f.concat({name:"cmap12Start_"+t,type:"ULONG",value:m.start})).concat({name:"cmap12End_"+t,type:"ULONG",value:m.end})).concat({name:"cmap12Glyph_"+t,type:"ULONG",value:m.glyphIndex}))}if(r.segCountX2=2*(a-l),r.searchRange=2*Math.pow(2,Math.floor(Math.log(a-l)/Math.log(2))),r.entrySelector=Math.log(r.searchRange/2)/Math.log(2),r.rangeShift=r.segCountX2-r.searchRange,r.fields=r.fields.concat(c),r.fields.push({name:"reservedPad",type:"USHORT",value:0}),r.fields=r.fields.concat(h),r.fields=r.fields.concat(u),r.fields=r.fields.concat(d),r.fields=r.fields.concat(p),r.cmap4Length=14+2*c.length+2+2*h.length+2*u.length+2*d.length+2*p.length,!n){var g=16+4*f.length;r.cmap12Offset=20+r.cmap4Length,r.fields=r.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:g},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:f.length/3}]),r.fields=r.fields.concat(f)}return r}},vh=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],yh=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],bh=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],wh=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function xh(e){this.font=e}function Ch(e){this.cmap=e}function Sh(e,t){this.encoding=e,this.charset=t}function kh(e){switch(e.version){case 1:this.names=wh.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(var t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<wh.length?this.names[t]=wh[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-wh.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(var n=0;n<e.numberOfGlyphs;n++)this.names[n]=wh[n+e.glyphNameIndex[n]];break;default:this.names=[]}}function Lh(e,t){t.lowMemory?function(e){e._IndexToUnicodeMap={};for(var t=e.tables.cmap.glyphIndexMap,n=Object.keys(t),i=0;i<n.length;i+=1){var r=n[i],s=t[r];void 0===e._IndexToUnicodeMap[s]?e._IndexToUnicodeMap[s]={unicodes:[parseInt(r)]}:e._IndexToUnicodeMap[s].unicodes.push(parseInt(r))}}(e):function(e){for(var t,n=e.tables.cmap.glyphIndexMap,i=Object.keys(n),r=0;r<i.length;r+=1){var s=i[r],o=n[s];(t=e.glyphs.get(o)).addUnicode(parseInt(s))}for(var a=0;a<e.glyphs.length;a+=1)t=e.glyphs.get(a),e.cffEncoding?e.isCIDFont?t.name="gid"+a:t.name=e.cffEncoding.charset[a]:e.glyphNames.names&&(t.name=e.glyphNames.glyphIndexToName(a))}(e)}xh.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),n=this.font.glyphs;if(n)for(var i=0;i<n.length;i+=1)for(var r=n.get(i),s=0;s<r.unicodes.length;s+=1)if(r.unicodes[s]===t)return i;return null},Ch.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.codePointAt(0)]||0},Sh.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),n=this.encoding[t];return this.charset.indexOf(n)},kh.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},kh.prototype.glyphIndexToName=function(e){return this.names[e]};var Eh={line:function(e,t,n,i,r){e.beginPath(),e.moveTo(t,n),e.lineTo(i,r),e.stroke()}};function Ph(e){this.bindConstructorValues(e)}function Th(e,t,n){Object.defineProperty(e,t,{get:function(){return e.path,e[n]},set:function(t){e[n]=t},enumerable:!0,configurable:!0})}function Ah(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];i.path.unitsPerEm=e.unitsPerEm,this.glyphs[n]=i}this.length=t&&t.length||0}Ph.prototype.bindConstructorValues=function(e){var t,n;this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],"xMin"in e&&(this.xMin=e.xMin),"yMin"in e&&(this.yMin=e.yMin),"xMax"in e&&(this.xMax=e.xMax),"yMax"in e&&(this.yMax=e.yMax),"advanceWidth"in e&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",(t=e.path,n=t||new Dc,{configurable:!0,get:function(){return"function"==typeof n&&(n=n()),n},set:function(e){n=e}}))},Ph.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},Ph.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},Ph.prototype.getPath=function(e,t,n,i,r){var s,o;e=void 0!==e?e:0,t=void 0!==t?t:0,n=void 0!==n?n:72,i||(i={});var a=i.xScale,l=i.yScale;if(i.hinting&&r&&r.hinting&&(o=this.path&&r.hinting.exec(this,n)),o)s=r.hinting.getCommands(o),e=Math.round(e),t=Math.round(t),a=l=1;else{s=this.path.commands;var c=1/(this.path.unitsPerEm||1e3)*n;void 0===a&&(a=c),void 0===l&&(l=c)}for(var h=new Dc,u=0;u<s.length;u+=1){var d=s[u];"M"===d.type?h.moveTo(e+d.x*a,t+-d.y*l):"L"===d.type?h.lineTo(e+d.x*a,t+-d.y*l):"Q"===d.type?h.quadraticCurveTo(e+d.x1*a,t+-d.y1*l,e+d.x*a,t+-d.y*l):"C"===d.type?h.curveTo(e+d.x1*a,t+-d.y1*l,e+d.x2*a,t+-d.y2*l,e+d.x*a,t+-d.y*l):"Z"===d.type&&h.closePath()}return h},Ph.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],n=0;n<this.points.length;n+=1){var i=this.points[n];t.push(i),i.lastPointOfContour&&(e.push(t),t=[])}return Bc.argument(0===t.length,"There are still points left in the current contour."),e},Ph.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],n=[],i=0;i<e.length;i+=1){var r=e[i];"Z"!==r.type&&(t.push(r.x),n.push(r.y)),"Q"!==r.type&&"C"!==r.type||(t.push(r.x1),n.push(r.y1)),"C"===r.type&&(t.push(r.x2),n.push(r.y2))}var s={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(s.xMin)||(s.xMin=0),isFinite(s.xMax)||(s.xMax=this.advanceWidth),isFinite(s.yMin)||(s.yMin=0),isFinite(s.yMax)||(s.yMax=0),s.rightSideBearing=this.advanceWidth-s.leftSideBearing-(s.xMax-s.xMin),s},Ph.prototype.draw=function(e,t,n,i,r){this.getPath(t,n,i,r).draw(e)},Ph.prototype.drawPoints=function(e,t,n,i){function r(t,n,i,r){e.beginPath();for(var s=0;s<t.length;s+=1)e.moveTo(n+t[s].x*r,i+t[s].y*r),e.arc(n+t[s].x*r,i+t[s].y*r,2,0,2*Math.PI,!1);e.closePath(),e.fill()}t=void 0!==t?t:0,n=void 0!==n?n:0,i=void 0!==i?i:24;for(var s=1/this.path.unitsPerEm*i,o=[],a=[],l=this.path,c=0;c<l.commands.length;c+=1){var h=l.commands[c];void 0!==h.x&&o.push({x:h.x,y:-h.y}),void 0!==h.x1&&a.push({x:h.x1,y:-h.y1}),void 0!==h.x2&&a.push({x:h.x2,y:-h.y2})}e.fillStyle="blue",r(o,t,n,s),e.fillStyle="red",r(a,t,n,s)},Ph.prototype.drawMetrics=function(e,t,n,i){var r;t=void 0!==t?t:0,n=void 0!==n?n:0,i=void 0!==i?i:24,r=1/this.path.unitsPerEm*i,e.lineWidth=1,e.strokeStyle="black",Eh.line(e,t,-1e4,t,1e4),Eh.line(e,-1e4,n,1e4,n);var s=this.xMin||0,o=this.yMin||0,a=this.xMax||0,l=this.yMax||0,c=this.advanceWidth||0;e.strokeStyle="blue",Eh.line(e,t+s*r,-1e4,t+s*r,1e4),Eh.line(e,t+a*r,-1e4,t+a*r,1e4),Eh.line(e,-1e4,n+-o*r,1e4,n+-o*r),Eh.line(e,-1e4,n+-l*r,1e4,n+-l*r),e.strokeStyle="green",Eh.line(e,t+c*r,-1e4,t+c*r,1e4)},Ah.prototype.get=function(e){if(void 0===this.glyphs[e]){this.font._push(e),"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]());var t=this.glyphs[e],n=this.font._IndexToUnicodeMap[e];if(n)for(var i=0;i<n.unicodes.length;i++)t.addUnicode(n.unicodes[i]);this.font.cffEncoding?this.font.isCIDFont?t.name="gid"+e:t.name=this.font.cffEncoding.charset[e]:this.font.glyphNames.names&&(t.name=this.font.glyphNames.glyphIndexToName(e)),this.glyphs[e].advanceWidth=this.font._hmtxTableData[e].advanceWidth,this.glyphs[e].leftSideBearing=this.font._hmtxTableData[e].leftSideBearing}else"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]());return this.glyphs[e]},Ah.prototype.push=function(e,t){this.glyphs[e]=t,this.length++};var Mh={GlyphSet:Ah,glyphLoader:function(e,t){return new Ph({index:t,font:e})},ttfGlyphLoader:function(e,t,n,i,r,s){return function(){var o=new Ph({index:t,font:e});return o.path=function(){n(o,i,r);var t=s(e.glyphs,o);return t.unitsPerEm=e.unitsPerEm,t},Th(o,"xMin","_xMin"),Th(o,"xMax","_xMax"),Th(o,"yMin","_yMin"),Th(o,"yMax","_yMax"),o}},cffGlyphLoader:function(e,t,n,i){return function(){var r=new Ph({index:t,font:e});return r.path=function(){var t=n(e,r,i);return t.unitsPerEm=e.unitsPerEm,t},r}}};function Ih(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n+=1)if(!Ih(e[n],t[n]))return!1;return!0}return!1}function _h(e){return e.length<1240?107:e.length<33900?1131:32768}function Oh(e,t,n){var i,r,s=[],o=[],a=fh.getCard16(e,t);if(0!==a){var l=fh.getByte(e,t+2);i=t+(a+1)*l+2;for(var c=t+3,h=0;h<a+1;h+=1)s.push(fh.getOffset(e,c,l)),c+=l;r=i+s[a]}else r=t+2;for(var u=0;u<s.length-1;u+=1){var d=fh.getBytes(e,i+s[u],i+s[u+1]);n&&(d=n(d)),o.push(d)}return{objects:o,startOffset:t,endOffset:r}}function Nh(e,t){if(28===t)return e.parseByte()<<8|e.parseByte();if(29===t)return e.parseByte()<<24|e.parseByte()<<16|e.parseByte()<<8|e.parseByte();if(30===t)return function(e){for(var t="",n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var i=e.parseByte(),r=i>>4,s=15&i;if(15===r)break;if(t+=n[r],15===s)break;t+=n[s]}return parseFloat(t)}(e);if(t>=32&&t<=246)return t-139;if(t>=247&&t<=250)return 256*(t-247)+e.parseByte()+108;if(t>=251&&t<=254)return 256*-(t-251)-e.parseByte()-108;throw new Error("Invalid b0 "+t)}function Dh(e,t,n){t=void 0!==t?t:0;var i=new fh.Parser(e,t),r=[],s=[];for(n=void 0!==n?n:e.length;i.relativeOffset<n;){var o=i.parseByte();o<=21?(12===o&&(o=1200+i.parseByte()),r.push([o,s]),s=[]):s.push(Nh(i,o))}return function(e){for(var t={},n=0;n<e.length;n+=1){var i=e[n][0],r=e[n][1],s=void 0;if(s=1===r.length?r[0]:r,t.hasOwnProperty(i)&&!isNaN(t[i]))throw new Error("Object "+t+" already has key "+i);t[i]=s}return t}(r)}function Rh(e,t){return t=t<=390?vh[t]:e[t-391]}function Fh(e,t,n){for(var i,r={},s=0;s<t.length;s+=1){var o=t[s];if(Array.isArray(o.type)){var a=[];a.length=o.type.length;for(var l=0;l<o.type.length;l++)void 0===(i=void 0!==e[o.op]?e[o.op][l]:void 0)&&(i=void 0!==o.value&&void 0!==o.value[l]?o.value[l]:null),"SID"===o.type[l]&&(i=Rh(n,i)),a[l]=i;r[o.name]=a}else void 0===(i=e[o.op])&&(i=void 0!==o.value?o.value:null),"SID"===o.type&&(i=Rh(n,i)),r[o.name]=i}return r}var Bh=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Vh=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function jh(e,t){return Fh(Dh(e,0,e.byteLength),Bh,t)}function Hh(e,t,n,i){return Fh(Dh(e,t,n),Vh,i)}function Uh(e,t,n,i){for(var r=[],s=0;s<n.length;s+=1){var o=jh(new DataView(new Uint8Array(n[s]).buffer),i);o._subrs=[],o._subrsBias=0,o._defaultWidthX=0,o._nominalWidthX=0;var a=o.private[0],l=o.private[1];if(0!==a&&0!==l){var c=Hh(e,l+t,a,i);if(o._defaultWidthX=c.defaultWidthX,o._nominalWidthX=c.nominalWidthX,0!==c.subrs){var h=Oh(e,l+c.subrs+t);o._subrs=h.objects,o._subrsBias=_h(o._subrs)}o._privateDict=c}r.push(o)}return r}function zh(e,t,n){var i,r,s,o,a,l,c,h,u=new Dc,d=[],p=0,f=!1,m=!1,g=0,v=0;if(e.isCIDFont){var y=e.tables.cff.topDict._fdSelect[t.index],b=e.tables.cff.topDict._fdArray[y];a=b._subrs,l=b._subrsBias,c=b._defaultWidthX,h=b._nominalWidthX}else a=e.tables.cff.topDict._subrs,l=e.tables.cff.topDict._subrsBias,c=e.tables.cff.topDict._defaultWidthX,h=e.tables.cff.topDict._nominalWidthX;var w=c;function x(e,t){m&&u.closePath(),u.moveTo(e,t),m=!0}function C(){d.length%2!=0&&!f&&(w=d.shift()+h),p+=d.length>>1,d.length=0,f=!0}return function t(n){for(var c,y,b,S,k,L,E,P,T,A,M,I,_=0;_<n.length;){var O=n[_];switch(_+=1,O){case 1:case 3:case 18:case 23:C();break;case 4:d.length>1&&!f&&(w=d.shift()+h,f=!0),v+=d.pop(),x(g,v);break;case 5:for(;d.length>0;)g+=d.shift(),v+=d.shift(),u.lineTo(g,v);break;case 6:for(;d.length>0&&(g+=d.shift(),u.lineTo(g,v),0!==d.length);)v+=d.shift(),u.lineTo(g,v);break;case 7:for(;d.length>0&&(v+=d.shift(),u.lineTo(g,v),0!==d.length);)g+=d.shift(),u.lineTo(g,v);break;case 8:for(;d.length>0;)i=g+d.shift(),r=v+d.shift(),s=i+d.shift(),o=r+d.shift(),g=s+d.shift(),v=o+d.shift(),u.curveTo(i,r,s,o,g,v);break;case 10:k=d.pop()+l,(L=a[k])&&t(L);break;case 11:return;case 12:switch(O=n[_],_+=1,O){case 35:i=g+d.shift(),r=v+d.shift(),s=i+d.shift(),o=r+d.shift(),E=s+d.shift(),P=o+d.shift(),T=E+d.shift(),A=P+d.shift(),M=T+d.shift(),I=A+d.shift(),g=M+d.shift(),v=I+d.shift(),d.shift(),u.curveTo(i,r,s,o,E,P),u.curveTo(T,A,M,I,g,v);break;case 34:i=g+d.shift(),r=v,s=i+d.shift(),o=r+d.shift(),E=s+d.shift(),P=o,T=E+d.shift(),A=o,M=T+d.shift(),I=v,g=M+d.shift(),u.curveTo(i,r,s,o,E,P),u.curveTo(T,A,M,I,g,v);break;case 36:i=g+d.shift(),r=v+d.shift(),s=i+d.shift(),o=r+d.shift(),E=s+d.shift(),P=o,T=E+d.shift(),A=o,M=T+d.shift(),I=A+d.shift(),g=M+d.shift(),u.curveTo(i,r,s,o,E,P),u.curveTo(T,A,M,I,g,v);break;case 37:i=g+d.shift(),r=v+d.shift(),s=i+d.shift(),o=r+d.shift(),E=s+d.shift(),P=o+d.shift(),T=E+d.shift(),A=P+d.shift(),M=T+d.shift(),I=A+d.shift(),Math.abs(M-g)>Math.abs(I-v)?g=M+d.shift():v=I+d.shift(),u.curveTo(i,r,s,o,E,P),u.curveTo(T,A,M,I,g,v);break;default:d.length=0}break;case 14:d.length>0&&!f&&(w=d.shift()+h,f=!0),m&&(u.closePath(),m=!1);break;case 19:case 20:C(),_+=p+7>>3;break;case 21:d.length>2&&!f&&(w=d.shift()+h,f=!0),v+=d.pop(),x(g+=d.pop(),v);break;case 22:d.length>1&&!f&&(w=d.shift()+h,f=!0),x(g+=d.pop(),v);break;case 24:for(;d.length>2;)i=g+d.shift(),r=v+d.shift(),s=i+d.shift(),o=r+d.shift(),g=s+d.shift(),v=o+d.shift(),u.curveTo(i,r,s,o,g,v);g+=d.shift(),v+=d.shift(),u.lineTo(g,v);break;case 25:for(;d.length>6;)g+=d.shift(),v+=d.shift(),u.lineTo(g,v);i=g+d.shift(),r=v+d.shift(),s=i+d.shift(),o=r+d.shift(),g=s+d.shift(),v=o+d.shift(),u.curveTo(i,r,s,o,g,v);break;case 26:for(d.length%2&&(g+=d.shift());d.length>0;)i=g,r=v+d.shift(),s=i+d.shift(),o=r+d.shift(),g=s,v=o+d.shift(),u.curveTo(i,r,s,o,g,v);break;case 27:for(d.length%2&&(v+=d.shift());d.length>0;)i=g+d.shift(),r=v,s=i+d.shift(),o=r+d.shift(),g=s+d.shift(),v=o,u.curveTo(i,r,s,o,g,v);break;case 28:c=n[_],y=n[_+1],d.push((c<<24|y<<16)>>16),_+=2;break;case 29:k=d.pop()+e.gsubrsBias,(L=e.gsubrs[k])&&t(L);break;case 30:for(;d.length>0&&(i=g,r=v+d.shift(),s=i+d.shift(),o=r+d.shift(),g=s+d.shift(),v=o+(1===d.length?d.shift():0),u.curveTo(i,r,s,o,g,v),0!==d.length);)i=g+d.shift(),r=v,s=i+d.shift(),o=r+d.shift(),v=o+d.shift(),g=s+(1===d.length?d.shift():0),u.curveTo(i,r,s,o,g,v);break;case 31:for(;d.length>0&&(i=g+d.shift(),r=v,s=i+d.shift(),o=r+d.shift(),v=o+d.shift(),g=s+(1===d.length?d.shift():0),u.curveTo(i,r,s,o,g,v),0!==d.length);)i=g,r=v+d.shift(),s=i+d.shift(),o=r+d.shift(),g=s+d.shift(),v=o+(1===d.length?d.shift():0),u.curveTo(i,r,s,o,g,v);break;default:O<32||(O<247?d.push(O-139):O<251?(c=n[_],_+=1,d.push(256*(O-247)+c+108)):O<255?(c=n[_],_+=1,d.push(256*-(O-251)-c-108)):(c=n[_],y=n[_+1],b=n[_+2],S=n[_+3],_+=4,d.push((c<<24|y<<16|b<<8|S)/65536)))}}}(n),t.advanceWidth=w,u}function Wh(e,t){var n,i=vh.indexOf(e);return i>=0&&(n=i),(i=t.indexOf(e))>=0?n=i+vh.length:(n=vh.length+t.length,t.push(e)),n}function Gh(e,t,n){for(var i={},r=0;r<e.length;r+=1){var s=e[r],o=t[s.name];void 0===o||Ih(o,s.value)||("SID"===s.type&&(o=Wh(o,n)),i[s.op]={name:s.name,type:s.type,value:o})}return i}function $h(e,t){var n=new oh.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Gh(Bh,e,t),n}function Zh(e){var t=new oh.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}function qh(e){var t=[],n=e.path;t.push({name:"width",type:"NUMBER",value:e.advanceWidth});for(var i=0,r=0,s=0;s<n.commands.length;s+=1){var o=void 0,a=void 0,l=n.commands[s];if("Q"===l.type){var c=1/3,h=2/3;l={type:"C",x:l.x,y:l.y,x1:Math.round(c*i+h*l.x1),y1:Math.round(c*r+h*l.y1),x2:Math.round(c*l.x+h*l.x1),y2:Math.round(c*l.y+h*l.y1)}}if("M"===l.type)o=Math.round(l.x-i),a=Math.round(l.y-r),t.push({name:"dx",type:"NUMBER",value:o}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rmoveto",type:"OP",value:21}),i=Math.round(l.x),r=Math.round(l.y);else if("L"===l.type)o=Math.round(l.x-i),a=Math.round(l.y-r),t.push({name:"dx",type:"NUMBER",value:o}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rlineto",type:"OP",value:5}),i=Math.round(l.x),r=Math.round(l.y);else if("C"===l.type){var u=Math.round(l.x1-i),d=Math.round(l.y1-r),p=Math.round(l.x2-l.x1),f=Math.round(l.y2-l.y1);o=Math.round(l.x-l.x2),a=Math.round(l.y-l.y2),t.push({name:"dx1",type:"NUMBER",value:u}),t.push({name:"dy1",type:"NUMBER",value:d}),t.push({name:"dx2",type:"NUMBER",value:p}),t.push({name:"dy2",type:"NUMBER",value:f}),t.push({name:"dx",type:"NUMBER",value:o}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rrcurveto",type:"OP",value:8}),i=Math.round(l.x),r=Math.round(l.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}var Kh={parse:function(e,t,n,i){n.tables.cff={};var r=function(e,t){var n={};return n.formatMajor=fh.getCard8(e,t),n.formatMinor=fh.getCard8(e,t+1),n.size=fh.getCard8(e,t+2),n.offsetSize=fh.getCard8(e,t+3),n.startOffset=t,n.endOffset=t+4,n}(e,t),s=Oh(e,r.endOffset,fh.bytesToString),o=Oh(e,s.endOffset),a=Oh(e,o.endOffset,fh.bytesToString),l=Oh(e,a.endOffset);n.gsubrs=l.objects,n.gsubrsBias=_h(n.gsubrs);var c=Uh(e,t,o.objects,a.objects);if(1!==c.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+c.length);var h=c[0];if(n.tables.cff.topDict=h,h._privateDict&&(n.defaultWidthX=h._privateDict.defaultWidthX,n.nominalWidthX=h._privateDict.nominalWidthX),void 0!==h.ros[0]&&void 0!==h.ros[1]&&(n.isCIDFont=!0),n.isCIDFont){var u=h.fdArray,d=h.fdSelect;if(0===u||0===d)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");var p=Oh(e,u+=t),f=Uh(e,t,p.objects,a.objects);h._fdArray=f,d+=t,h._fdSelect=function(e,t,n,i){var r,s=[],o=new fh.Parser(e,t),a=o.parseCard8();if(0===a)for(var l=0;l<n;l++){if((r=o.parseCard8())>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+r+" (FD count "+i+")");s.push(r)}else{if(3!==a)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+a);var c,h=o.parseCard16(),u=o.parseCard16();if(0!==u)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+u);for(var d=0;d<h;d++){if(r=o.parseCard8(),c=o.parseCard16(),r>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+r+" (FD count "+i+")");if(c>n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+c);for(;u<c;u++)s.push(r);u=c}if(c!==n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+c)}return s}(e,d,n.numGlyphs,f.length)}var m,g=t+h.private[1],v=Hh(e,g,h.private[0],a.objects);if(n.defaultWidthX=v.defaultWidthX,n.nominalWidthX=v.nominalWidthX,0!==v.subrs){var y=g+v.subrs,b=Oh(e,y);n.subrs=b.objects,n.subrsBias=_h(n.subrs)}else n.subrs=[],n.subrsBias=0;i.lowMemory?(m=function(e,t){var n,i,r=[],s=fh.getCard16(e,t);if(0!==s){var o=fh.getByte(e,t+2);n=t+(s+1)*o+2;for(var a=t+3,l=0;l<s+1;l+=1)r.push(fh.getOffset(e,a,o)),a+=o;i=n+r[s]}else i=t+2;return{offsets:r,startOffset:t,endOffset:i}}(e,t+h.charStrings),n.nGlyphs=m.offsets.length):(m=Oh(e,t+h.charStrings),n.nGlyphs=m.objects.length);var w=function(e,t,n,i){var r,s,o=new fh.Parser(e,t);n-=1;var a=[".notdef"],l=o.parseCard8();if(0===l)for(var c=0;c<n;c+=1)r=o.parseSID(),a.push(Rh(i,r));else if(1===l)for(;a.length<=n;){r=o.parseSID(),s=o.parseCard8();for(var h=0;h<=s;h+=1)a.push(Rh(i,r)),r+=1}else{if(2!==l)throw new Error("Unknown charset format "+l);for(;a.length<=n;){r=o.parseSID(),s=o.parseCard16();for(var u=0;u<=s;u+=1)a.push(Rh(i,r)),r+=1}}return a}(e,t+h.charset,n.nGlyphs,a.objects);if(0===h.encoding?n.cffEncoding=new Sh(yh,w):1===h.encoding?n.cffEncoding=new Sh(bh,w):n.cffEncoding=function(e,t,n){var i,r={},s=new fh.Parser(e,t),o=s.parseCard8();if(0===o)for(var a=s.parseCard8(),l=0;l<a;l+=1)r[i=s.parseCard8()]=l;else{if(1!==o)throw new Error("Unknown encoding format "+o);var c=s.parseCard8();i=1;for(var h=0;h<c;h+=1)for(var u=s.parseCard8(),d=s.parseCard8(),p=u;p<=u+d;p+=1)r[p]=i,i+=1}return new Sh(r,n)}(e,t+h.encoding,w),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new Mh.GlyphSet(n),i.lowMemory)n._push=function(i){var r=function(e,t,n,i){var r=fh.getCard16(n,i),s=0;return 0!==r&&(s=i+(r+1)*fh.getByte(n,i+2)+2),fh.getBytes(n,s+t[e],s+t[e+1])}(i,m.offsets,e,t+h.charStrings);n.glyphs.push(i,Mh.cffGlyphLoader(n,i,zh,r))};else for(var x=0;x<n.nGlyphs;x+=1){var C=m.objects[x];n.glyphs.push(x,Mh.cffGlyphLoader(n,x,zh,C))}},make:function(e,t){for(var n,i=new oh.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),r=1/t.unitsPerEm,s={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},o=[],a=1;a<e.length;a+=1)n=e.get(a),o.push(n.name);var l=[];i.header=new oh.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),i.nameIndex=function(e){var t=new oh.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var n=0;n<e.length;n+=1)t.names.push({name:"name_"+n,type:"NAME",value:e[n]});return t}([t.postScriptName]);var c=$h(s,l);i.topDictIndex=Zh(c),i.globalSubrIndex=new oh.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),i.charsets=function(e,t){for(var n=new oh.Record("Charsets",[{name:"format",type:"Card8",value:0}]),i=0;i<e.length;i+=1){var r=Wh(e[i],t);n.fields.push({name:"glyph_"+i,type:"SID",value:r})}return n}(o,l),i.charStringsIndex=function(e){for(var t=new oh.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),n=0;n<e.length;n+=1){var i=e.get(n),r=qh(i);t.charStrings.push({name:i.name,type:"CHARSTRING",value:r})}return t}(e),i.privateDict=function(e,t){var n=new oh.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Gh(Vh,e,t),n}({},l),i.stringIndex=function(e){var t=new oh.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var n=0;n<e.length;n+=1)t.strings.push({name:"string_"+n,type:"STRING",value:e[n]});return t}(l);var h=i.header.sizeOf()+i.nameIndex.sizeOf()+i.topDictIndex.sizeOf()+i.stringIndex.sizeOf()+i.globalSubrIndex.sizeOf();return s.charset=h,s.encoding=0,s.charStrings=s.charset+i.charsets.sizeOf(),s.private[1]=s.charStrings+i.charStringsIndex.sizeOf(),c=$h(s,l),i.topDictIndex=Zh(c),i}};var Yh={parse:function(e,t){var n={},i=new fh.Parser(e,t);return n.version=i.parseVersion(),n.fontRevision=Math.round(1e3*i.parseFixed())/1e3,n.checkSumAdjustment=i.parseULong(),n.magicNumber=i.parseULong(),Bc.argument(1594834165===n.magicNumber,"Font header has wrong magic number."),n.flags=i.parseUShort(),n.unitsPerEm=i.parseUShort(),n.created=i.parseLongDateTime(),n.modified=i.parseLongDateTime(),n.xMin=i.parseShort(),n.yMin=i.parseShort(),n.xMax=i.parseShort(),n.yMax=i.parseShort(),n.macStyle=i.parseUShort(),n.lowestRecPPEM=i.parseUShort(),n.fontDirectionHint=i.parseShort(),n.indexToLocFormat=i.parseShort(),n.glyphDataFormat=i.parseShort(),n},make:function(e){var t=Math.round((new Date).getTime()/1e3)+2082844800,n=t;return e.createdTimestamp&&(n=e.createdTimestamp+2082844800),new oh.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}};var Xh={parse:function(e,t){var n={},i=new fh.Parser(e,t);return n.version=i.parseVersion(),n.ascender=i.parseShort(),n.descender=i.parseShort(),n.lineGap=i.parseShort(),n.advanceWidthMax=i.parseUShort(),n.minLeftSideBearing=i.parseShort(),n.minRightSideBearing=i.parseShort(),n.xMaxExtent=i.parseShort(),n.caretSlopeRise=i.parseShort(),n.caretSlopeRun=i.parseShort(),n.caretOffset=i.parseShort(),i.relativeOffset+=8,n.metricDataFormat=i.parseShort(),n.numberOfHMetrics=i.parseUShort(),n},make:function(e){return new oh.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}};var Jh={parse:function(e,t,n,i,r,s,o){o.lowMemory?function(e,t,n,i,r){var s,o;e._hmtxTableData={};for(var a=new fh.Parser(t,n),l=0;l<r;l+=1)l<i&&(s=a.parseUShort(),o=a.parseShort()),e._hmtxTableData[l]={advanceWidth:s,leftSideBearing:o}}(e,t,n,i,r):function(e,t,n,i,r){for(var s,o,a=new fh.Parser(e,t),l=0;l<i;l+=1){l<n&&(s=a.parseUShort(),o=a.parseShort());var c=r.get(l);c.advanceWidth=s,c.leftSideBearing=o}}(t,n,i,r,s)},make:function(e){for(var t=new oh.Table("hmtx",[]),n=0;n<e.length;n+=1){var i=e.get(n),r=i.advanceWidth||0,s=i.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:r}),t.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:s})}return t}};var Qh={make:function(e){for(var t=new oh.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]),n="",i=12+4*e.length,r=0;r<e.length;++r){var s=n.indexOf(e[r]);s<0&&(s=n.length,n+=e[r]),t.fields.push({name:"offset "+r,type:"USHORT",value:i+s}),t.fields.push({name:"length "+r,type:"USHORT",value:e[r].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),t},parse:function(e,t){var n=new fh.Parser(e,t),i=n.parseULong();Bc.argument(1===i,"Unsupported ltag table version."),n.skip("uLong",1);for(var r=n.parseULong(),s=[],o=0;o<r;o++){for(var a="",l=t+n.parseUShort(),c=n.parseUShort(),h=l;h<l+c;++h)a+=String.fromCharCode(e.getInt8(h));s.push(a)}return s}};var eu={parse:function(e,t){var n={},i=new fh.Parser(e,t);return n.version=i.parseVersion(),n.numGlyphs=i.parseUShort(),1===n.version&&(n.maxPoints=i.parseUShort(),n.maxContours=i.parseUShort(),n.maxCompositePoints=i.parseUShort(),n.maxCompositeContours=i.parseUShort(),n.maxZones=i.parseUShort(),n.maxTwilightPoints=i.parseUShort(),n.maxStorage=i.parseUShort(),n.maxFunctionDefs=i.parseUShort(),n.maxInstructionDefs=i.parseUShort(),n.maxStackElements=i.parseUShort(),n.maxSizeOfInstructions=i.parseUShort(),n.maxComponentElements=i.parseUShort(),n.maxComponentDepth=i.parseUShort()),n},make:function(e){return new oh.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}},tu=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],nu={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},iu={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},ru={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function su(e,t,n){switch(e){case 0:if(65535===t)return"und";if(n)return n[t];break;case 1:return nu[t];case 3:return ru[t]}}var ou="utf-16",au={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},lu={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function cu(e,t,n){switch(e){case 0:return ou;case 1:return lu[n]||au[t];case 3:if(1===t||10===t)return ou}}function hu(e){var t={};for(var n in e)t[e[n]]=parseInt(n);return t}function uu(e,t,n,i,r,s){return new oh.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:i},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:s}])}function du(e,t){var n=function(e,t){var n=e.length,i=t.length-n+1;e:for(var r=0;r<i;r++)for(;r<i;r++){for(var s=0;s<n;s++)if(t[r+s]!==e[s])continue e;return r}return-1}(e,t);if(n<0){n=t.length;for(var i=0,r=e.length;i<r;++i)t.push(e[i])}return n}var pu={parse:function(e,t,n){for(var i={},r=new fh.Parser(e,t),s=r.parseUShort(),o=r.parseUShort(),a=r.offset+r.parseUShort(),l=0;l<o;l++){var c=r.parseUShort(),h=r.parseUShort(),u=r.parseUShort(),d=r.parseUShort(),p=tu[d]||d,f=r.parseUShort(),m=r.parseUShort(),g=su(c,u,n),v=cu(c,h,u);if(void 0!==v&&void 0!==g){var y=void 0;if(y=v===ou?jc.UTF16(e,a+m,f):jc.MACSTRING(e,a+m,f,v)){var b=i[p];void 0===b&&(b=i[p]={}),b[g]=y}}}return 1===s&&r.parseUShort(),i},make:function(e,t){var n,i=[],r={},s=hu(tu);for(var o in e){var a=s[o];if(void 0===a&&(a=o),n=parseInt(a),isNaN(n))throw new Error('Name table entry "'+o+'" does not exist, see nameTableNames for complete list.');r[n]=e[o],i.push(n)}for(var l=hu(nu),c=hu(ru),h=[],u=[],d=0;d<i.length;d++){var p=r[n=i[d]];for(var f in p){var m=p[f],g=1,v=l[f],y=iu[v],b=cu(g,y,v),w=Hc.MACSTRING(m,b);void 0===w&&(g=0,(v=t.indexOf(f))<0&&(v=t.length,t.push(f)),y=4,w=Hc.UTF16(m));var x=du(w,u);h.push(uu(g,y,v,n,w.length,x));var C=c[f];if(void 0!==C){var S=Hc.UTF16(m),k=du(S,u);h.push(uu(3,1,C,n,S.length,k))}}}h.sort(function(e,t){return e.platformID-t.platformID||e.encodingID-t.encodingID||e.languageID-t.languageID||e.nameID-t.nameID});for(var L=new oh.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:h.length},{name:"stringOffset",type:"USHORT",value:6+12*h.length}]),E=0;E<h.length;E++)L.fields.push({name:"record_"+E,type:"RECORD",value:h[E]});return L.fields.push({name:"strings",type:"LITERAL",value:u}),L}},fu=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];var mu={parse:function(e,t){var n={},i=new fh.Parser(e,t);n.version=i.parseUShort(),n.xAvgCharWidth=i.parseShort(),n.usWeightClass=i.parseUShort(),n.usWidthClass=i.parseUShort(),n.fsType=i.parseUShort(),n.ySubscriptXSize=i.parseShort(),n.ySubscriptYSize=i.parseShort(),n.ySubscriptXOffset=i.parseShort(),n.ySubscriptYOffset=i.parseShort(),n.ySuperscriptXSize=i.parseShort(),n.ySuperscriptYSize=i.parseShort(),n.ySuperscriptXOffset=i.parseShort(),n.ySuperscriptYOffset=i.parseShort(),n.yStrikeoutSize=i.parseShort(),n.yStrikeoutPosition=i.parseShort(),n.sFamilyClass=i.parseShort(),n.panose=[];for(var r=0;r<10;r++)n.panose[r]=i.parseByte();return n.ulUnicodeRange1=i.parseULong(),n.ulUnicodeRange2=i.parseULong(),n.ulUnicodeRange3=i.parseULong(),n.ulUnicodeRange4=i.parseULong(),n.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),n.fsSelection=i.parseUShort(),n.usFirstCharIndex=i.parseUShort(),n.usLastCharIndex=i.parseUShort(),n.sTypoAscender=i.parseShort(),n.sTypoDescender=i.parseShort(),n.sTypoLineGap=i.parseShort(),n.usWinAscent=i.parseUShort(),n.usWinDescent=i.parseUShort(),n.version>=1&&(n.ulCodePageRange1=i.parseULong(),n.ulCodePageRange2=i.parseULong()),n.version>=2&&(n.sxHeight=i.parseShort(),n.sCapHeight=i.parseShort(),n.usDefaultChar=i.parseUShort(),n.usBreakChar=i.parseUShort(),n.usMaxContent=i.parseUShort()),n},make:function(e){return new oh.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)},unicodeRanges:fu,getUnicodeRange:function(e){for(var t=0;t<fu.length;t+=1){var n=fu[t];if(e>=n.begin&&e<n.end)return t}return-1}};var gu={parse:function(e,t){var n={},i=new fh.Parser(e,t);switch(n.version=i.parseVersion(),n.italicAngle=i.parseFixed(),n.underlinePosition=i.parseShort(),n.underlineThickness=i.parseShort(),n.isFixedPitch=i.parseULong(),n.minMemType42=i.parseULong(),n.maxMemType42=i.parseULong(),n.minMemType1=i.parseULong(),n.maxMemType1=i.parseULong(),n.version){case 1:n.names=wh.slice();break;case 2:n.numberOfGlyphs=i.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs);for(var r=0;r<n.numberOfGlyphs;r++)n.glyphNameIndex[r]=i.parseUShort();n.names=[];for(var s=0;s<n.numberOfGlyphs;s++)if(n.glyphNameIndex[s]>=wh.length){var o=i.parseChar();n.names.push(i.parseString(o))}break;case 2.5:n.numberOfGlyphs=i.parseUShort(),n.offset=new Array(n.numberOfGlyphs);for(var a=0;a<n.numberOfGlyphs;a++)n.offset[a]=i.parseChar()}return n},make:function(){return new oh.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},vu=new Array(9);vu[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(dh.coverage),deltaGlyphId:this.parseUShort()}:2===t?{substFormat:2,coverage:this.parsePointer(dh.coverage),substitute:this.parseOffset16List()}:void Bc.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},vu[2]=function(){var e=this.parseUShort();return Bc.argument(1===e,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(dh.coverage),sequences:this.parseListOfLists()}},vu[3]=function(){var e=this.parseUShort();return Bc.argument(1===e,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(dh.coverage),alternateSets:this.parseListOfLists()}},vu[4]=function(){var e=this.parseUShort();return Bc.argument(1===e,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(dh.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var yu={sequenceIndex:dh.uShort,lookupListIndex:dh.uShort};vu[5]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{substFormat:t,coverage:this.parsePointer(dh.coverage),ruleSets:this.parseListOfLists(function(){var e=this.parseUShort(),t=this.parseUShort();return{input:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,yu)}})};if(2===t)return{substFormat:t,coverage:this.parsePointer(dh.coverage),classDef:this.parsePointer(dh.classDef),classSets:this.parseListOfLists(function(){var e=this.parseUShort(),t=this.parseUShort();return{classes:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,yu)}})};if(3===t){var n=this.parseUShort(),i=this.parseUShort();return{substFormat:t,coverages:this.parseList(n,dh.pointer(dh.coverage)),lookupRecords:this.parseRecordList(i,yu)}}Bc.assert(!1,"0x"+e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},vu[6]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(dh.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(yu)}})}:2===t?{substFormat:2,coverage:this.parsePointer(dh.coverage),backtrackClassDef:this.parsePointer(dh.classDef),inputClassDef:this.parsePointer(dh.classDef),lookaheadClassDef:this.parsePointer(dh.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(yu)}})}:3===t?{substFormat:3,backtrackCoverage:this.parseList(dh.pointer(dh.coverage)),inputCoverage:this.parseList(dh.pointer(dh.coverage)),lookaheadCoverage:this.parseList(dh.pointer(dh.coverage)),lookupRecords:this.parseRecordList(yu)}:void Bc.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},vu[7]=function(){var e=this.parseUShort();Bc.argument(1===e,"GSUB Extension Substitution subtable identifier-format must be 1");var t=this.parseUShort(),n=new dh(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:t,extension:vu[t].call(n)}},vu[8]=function(){var e=this.parseUShort();return Bc.argument(1===e,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(dh.coverage),backtrackCoverage:this.parseList(dh.pointer(dh.coverage)),lookaheadCoverage:this.parseList(dh.pointer(dh.coverage)),substitutes:this.parseUShortList()}};var bu=new Array(9);bu[1]=function(e){return 1===e.substFormat?new oh.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new oh.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new oh.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new oh.Coverage(e.coverage)}].concat(oh.ushortList("substitute",e.substitute)))},bu[2]=function(e){return Bc.assert(1===e.substFormat,"Lookup type 2 substFormat must be 1."),new oh.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new oh.Coverage(e.coverage)}].concat(oh.tableList("seqSet",e.sequences,function(e){return new oh.Table("sequenceSetTable",oh.ushortList("sequence",e))})))},bu[3]=function(e){return Bc.assert(1===e.substFormat,"Lookup type 3 substFormat must be 1."),new oh.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new oh.Coverage(e.coverage)}].concat(oh.tableList("altSet",e.alternateSets,function(e){return new oh.Table("alternateSetTable",oh.ushortList("alternate",e))})))},bu[4]=function(e){return Bc.assert(1===e.substFormat,"Lookup type 4 substFormat must be 1."),new oh.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new oh.Coverage(e.coverage)}].concat(oh.tableList("ligSet",e.ligatureSets,function(e){return new oh.Table("ligatureSetTable",oh.tableList("ligature",e,function(e){return new oh.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:e.ligGlyph}].concat(oh.ushortList("component",e.components,e.components.length+1)))}))})))},bu[6]=function(e){if(1===e.substFormat){var t=new oh.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:e.substFormat},{name:"coverage",type:"TABLE",value:new oh.Coverage(e.coverage)}].concat(oh.tableList("chainRuleSet",e.chainRuleSets,function(e){return new oh.Table("chainRuleSetTable",oh.tableList("chainRule",e,function(e){var t=oh.ushortList("backtrackGlyph",e.backtrack,e.backtrack.length).concat(oh.ushortList("inputGlyph",e.input,e.input.length+1)).concat(oh.ushortList("lookaheadGlyph",e.lookahead,e.lookahead.length)).concat(oh.ushortList("substitution",[],e.lookupRecords.length));return e.lookupRecords.forEach(function(e,n){t=t.concat({name:"sequenceIndex"+n,type:"USHORT",value:e.sequenceIndex}).concat({name:"lookupListIndex"+n,type:"USHORT",value:e.lookupListIndex})}),new oh.Table("chainRuleTable",t)}))})));return t}if(2===e.substFormat)Bc.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(3===e.substFormat){var n=[{name:"substFormat",type:"USHORT",value:e.substFormat}];return n.push({name:"backtrackGlyphCount",type:"USHORT",value:e.backtrackCoverage.length}),e.backtrackCoverage.forEach(function(e,t){n.push({name:"backtrackCoverage"+t,type:"TABLE",value:new oh.Coverage(e)})}),n.push({name:"inputGlyphCount",type:"USHORT",value:e.inputCoverage.length}),e.inputCoverage.forEach(function(e,t){n.push({name:"inputCoverage"+t,type:"TABLE",value:new oh.Coverage(e)})}),n.push({name:"lookaheadGlyphCount",type:"USHORT",value:e.lookaheadCoverage.length}),e.lookaheadCoverage.forEach(function(e,t){n.push({name:"lookaheadCoverage"+t,type:"TABLE",value:new oh.Coverage(e)})}),n.push({name:"substitutionCount",type:"USHORT",value:e.lookupRecords.length}),e.lookupRecords.forEach(function(e,t){n=n.concat({name:"sequenceIndex"+t,type:"USHORT",value:e.sequenceIndex}).concat({name:"lookupListIndex"+t,type:"USHORT",value:e.lookupListIndex})}),new oh.Table("chainContextTable",n)}Bc.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};var wu={parse:function(e,t){var n=new dh(e,t=t||0),i=n.parseVersion(1);return Bc.argument(1===i||1.1===i,"Unsupported GSUB table version."),1===i?{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(vu)}:{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(vu),variations:n.parseFeatureVariationsList()}},make:function(e){return new oh.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new oh.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new oh.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new oh.LookupList(e.lookups,bu)}])}};var xu={parse:function(e,t){var n=new fh.Parser(e,t),i=n.parseULong();Bc.argument(1===i,"Unsupported META table version."),n.parseULong(),n.parseULong();for(var r=n.parseULong(),s={},o=0;o<r;o++){var a=n.parseTag(),l=n.parseULong(),c=n.parseULong(),h=jc.UTF8(e,t+l,c);s[a]=h}return s},make:function(e){var t=Object.keys(e).length,n="",i=16+12*t,r=new oh.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:i},{name:"numTags",type:"ULONG",value:t}]);for(var s in e){var o=n.length;n+=e[s],r.fields.push({name:"tag "+s,type:"TAG",value:s}),r.fields.push({name:"offset "+s,type:"ULONG",value:i+o}),r.fields.push({name:"length "+s,type:"ULONG",value:e[s].length})}return r.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),r}};function Cu(e){return Math.log(e)/Math.log(2)|0}function Su(e){for(;e.length%4!=0;)e.push(0);for(var t=0,n=0;n<e.length;n+=4)t+=(e[n]<<24)+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3];return t%=Math.pow(2,32)}function ku(e,t,n,i){return new oh.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==n?n:0},{name:"length",type:"ULONG",value:void 0!==i?i:0}])}function Lu(e){var t=new oh.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=e,t.numTables=e.length;var n=Math.pow(2,Cu(t.numTables));t.searchRange=16*n,t.entrySelector=Cu(n),t.rangeShift=16*t.numTables-t.searchRange;for(var i=[],r=[],s=t.sizeOf()+ku().sizeOf()*t.numTables;s%4!=0;)s+=1,r.push({name:"padding",type:"BYTE",value:0});for(var o=0;o<e.length;o+=1){var a=e[o];Bc.argument(4===a.tableName.length,"Table name"+a.tableName+" is invalid.");var l=a.sizeOf(),c=ku(a.tableName,Su(a.encode()),s,l);for(i.push({name:c.tag+" Table Record",type:"RECORD",value:c}),r.push({name:a.tableName+" table",type:"RECORD",value:a}),s+=l,Bc.argument(!isNaN(s),"Something went wrong calculating the offset.");s%4!=0;)s+=1,r.push({name:"padding",type:"BYTE",value:0})}return i.sort(function(e,t){return e.value.tag>t.value.tag?1:-1}),t.fields=t.fields.concat(i),t.fields=t.fields.concat(r),t}function Eu(e,t,n){for(var i=0;i<t.length;i+=1){var r=e.charToGlyphIndex(t[i]);if(r>0)return e.glyphs.get(r).getMetrics()}return n}function Pu(e){for(var t=0,n=0;n<e.length;n+=1)t+=e[n];return t/e.length}var Tu={make:Lu,fontToTable:function(e){for(var t,n=[],i=[],r=[],s=[],o=[],a=[],l=[],c=0,h=0,u=0,d=0,p=0,f=0;f<e.glyphs.length;f+=1){var m=e.glyphs.get(f),g=0|m.unicode;if(isNaN(m.advanceWidth))throw new Error("Glyph "+m.name+" ("+f+"): advanceWidth is not a number.");(t>g||void 0===t)&&g>0&&(t=g),c<g&&(c=g);var v=mu.getUnicodeRange(g);if(v<32)h|=1<<v;else if(v<64)u|=1<<v-32;else if(v<96)d|=1<<v-64;else{if(!(v<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");p|=1<<v-96}if(".notdef"!==m.name){var y=m.getMetrics();n.push(y.xMin),i.push(y.yMin),r.push(y.xMax),s.push(y.yMax),a.push(y.leftSideBearing),l.push(y.rightSideBearing),o.push(m.advanceWidth)}}var b={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,s),advanceWidthMax:Math.max.apply(null,o),advanceWidthAvg:Pu(o),minLeftSideBearing:Math.min.apply(null,a),maxLeftSideBearing:Math.max.apply(null,a),minRightSideBearing:Math.min.apply(null,l)};b.ascender=e.ascender,b.descender=e.descender;var w=Yh.make({flags:3,unitsPerEm:e.unitsPerEm,xMin:b.xMin,yMin:b.yMin,xMax:b.xMax,yMax:b.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp}),x=Xh.make({ascender:b.ascender,descender:b.descender,advanceWidthMax:b.advanceWidthMax,minLeftSideBearing:b.minLeftSideBearing,minRightSideBearing:b.minRightSideBearing,xMaxExtent:b.maxLeftSideBearing+(b.xMax-b.xMin),numberOfHMetrics:e.glyphs.length}),C=eu.make(e.glyphs.length),S=mu.make(Object.assign({xAvgCharWidth:Math.round(b.advanceWidthAvg),usFirstCharIndex:t,usLastCharIndex:c,ulUnicodeRange1:h,ulUnicodeRange2:u,ulUnicodeRange3:d,ulUnicodeRange4:p,sTypoAscender:b.ascender,sTypoDescender:b.descender,sTypoLineGap:0,usWinAscent:b.yMax,usWinDescent:Math.abs(b.yMin),ulCodePageRange1:1,sxHeight:Eu(e,"xyvw",{yMax:Math.round(b.ascender/2)}).yMax,sCapHeight:Eu(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",b).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0},e.tables.os2)),k=Jh.make(e.glyphs),L=gh.make(e.glyphs),E=e.getEnglishName("fontFamily"),P=e.getEnglishName("fontSubfamily"),T=E+" "+P,A=e.getEnglishName("postScriptName");A||(A=E.replace(/\s/g,"")+"-"+P);var M={};for(var I in e.names)M[I]=e.names[I];M.uniqueID||(M.uniqueID={en:e.getEnglishName("manufacturer")+":"+T}),M.postScriptName||(M.postScriptName={en:A}),M.preferredFamily||(M.preferredFamily=e.names.fontFamily),M.preferredSubfamily||(M.preferredSubfamily=e.names.fontSubfamily);var _=[],O=pu.make(M,_),N=_.length>0?Qh.make(_):void 0,D=gu.make(),R=Kh.make(e.glyphs,{version:e.getEnglishName("version"),fullName:T,familyName:E,weightName:P,postScriptName:A,unitsPerEm:e.unitsPerEm,fontBBox:[0,b.yMin,b.ascender,b.advanceWidthMax]}),F=e.metas&&Object.keys(e.metas).length>0?xu.make(e.metas):void 0,B=[w,x,C,S,O,L,D,R,k];N&&B.push(N),e.tables.gsub&&B.push(wu.make(e.tables.gsub)),F&&B.push(F);for(var V=Lu(B),j=Su(V.encode()),H=V.fields,U=!1,z=0;z<H.length;z+=1)if("head table"===H[z].name){H[z].value.checkSumAdjustment=2981146554-j,U=!0;break}if(!U)throw new Error("Could not find head table with checkSum to adjust.");return V},computeCheckSum:Su};function Au(e,t){for(var n=0,i=e.length-1;n<=i;){var r=n+i>>>1,s=e[r].tag;if(s===t)return r;s<t?n=r+1:i=r-1}return-n-1}function Mu(e,t){for(var n=0,i=e.length-1;n<=i;){var r=n+i>>>1,s=e[r];if(s===t)return r;s<t?n=r+1:i=r-1}return-n-1}function Iu(e,t){for(var n,i=0,r=e.length-1;i<=r;){var s=i+r>>>1,o=(n=e[s]).start;if(o===t)return n;o<t?i=s+1:r=s-1}if(i>0)return t>(n=e[i-1]).end?0:n}function _u(e,t){this.font=e,this.tableName=t}function Ou(e){_u.call(this,e,"gpos")}function Nu(e){_u.call(this,e,"gsub")}function Du(e,t){var n=e.length;if(n!==t.length)return!1;for(var i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}function Ru(e,t,n){for(var i=e.subtables,r=0;r<i.length;r++){var s=i[r];if(s.substFormat===t)return s}if(n)return i.push(n),n}function Fu(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i<e.length;++i)n[i]=e[i];return t}function Bu(e,t){if(!e)throw t}function Vu(e,t,n,i,r){var s;return(t&i)>0?(s=e.parseByte(),0===(t&r)&&(s=-s),s=n+s):s=(t&r)>0?n:n+e.parseShort(),s}function ju(e,t,n){var i,r,s=new fh.Parser(t,n);if(e.numberOfContours=s.parseShort(),e._xMin=s.parseShort(),e._yMin=s.parseShort(),e._xMax=s.parseShort(),e._yMax=s.parseShort(),e.numberOfContours>0){for(var o=e.endPointIndices=[],a=0;a<e.numberOfContours;a+=1)o.push(s.parseUShort());e.instructionLength=s.parseUShort(),e.instructions=[];for(var l=0;l<e.instructionLength;l+=1)e.instructions.push(s.parseByte());var c=o[o.length-1]+1;i=[];for(var h=0;h<c;h+=1)if(r=s.parseByte(),i.push(r),(8&r)>0)for(var u=s.parseByte(),d=0;d<u;d+=1)i.push(r),h+=1;if(Bc.argument(i.length===c,"Bad flags."),o.length>0){var p,f=[];if(c>0){for(var m=0;m<c;m+=1)r=i[m],(p={}).onCurve=!!(1&r),p.lastPointOfContour=o.indexOf(m)>=0,f.push(p);for(var g=0,v=0;v<c;v+=1)r=i[v],(p=f[v]).x=Vu(s,r,g,2,16),g=p.x;for(var y=0,b=0;b<c;b+=1)r=i[b],(p=f[b]).y=Vu(s,r,y,4,32),y=p.y}e.points=f}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var w=!0;w;){i=s.parseUShort();var x={glyphIndex:s.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&i)>0?(2&i)>0?(x.dx=s.parseShort(),x.dy=s.parseShort()):x.matchedPoints=[s.parseUShort(),s.parseUShort()]:(2&i)>0?(x.dx=s.parseChar(),x.dy=s.parseChar()):x.matchedPoints=[s.parseByte(),s.parseByte()],(8&i)>0?x.xScale=x.yScale=s.parseF2Dot14():(64&i)>0?(x.xScale=s.parseF2Dot14(),x.yScale=s.parseF2Dot14()):(128&i)>0&&(x.xScale=s.parseF2Dot14(),x.scale01=s.parseF2Dot14(),x.scale10=s.parseF2Dot14(),x.yScale=s.parseF2Dot14()),e.components.push(x),w=!!(32&i)}if(256&i){e.instructionLength=s.parseUShort(),e.instructions=[];for(var C=0;C<e.instructionLength;C+=1)e.instructions.push(s.parseByte())}}}function Hu(e,t){for(var n=[],i=0;i<e.length;i+=1){var r=e[i],s={x:t.xScale*r.x+t.scale01*r.y+t.dx,y:t.scale10*r.x+t.yScale*r.y+t.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};n.push(s)}return n}function Uu(e){var t=new Dc;if(!e)return t;for(var n=function(e){for(var t=[],n=[],i=0;i<e.length;i+=1){var r=e[i];n.push(r),r.lastPointOfContour&&(t.push(n),n=[])}return Bc.argument(0===n.length,"There are still points left in the current contour."),t}(e),i=0;i<n.length;++i){var r=n[i],s=null,o=r[r.length-1],a=r[0];if(o.onCurve)t.moveTo(o.x,o.y);else if(a.onCurve)t.moveTo(a.x,a.y);else{var l={x:.5*(o.x+a.x),y:.5*(o.y+a.y)};t.moveTo(l.x,l.y)}for(var c=0;c<r.length;++c)if(s=o,o=a,a=r[(c+1)%r.length],o.onCurve)t.lineTo(o.x,o.y);else{var h=a;s.onCurve||(o.x,s.x,o.y,s.y),a.onCurve||(h={x:.5*(o.x+a.x),y:.5*(o.y+a.y)}),t.quadraticCurveTo(o.x,o.y,h.x,h.y)}t.closePath()}return t}function zu(e,t){if(t.isComposite)for(var n=0;n<t.components.length;n+=1){var i=t.components[n],r=e.get(i.glyphIndex);if(r.getPath(),r.points){var s=void 0;if(void 0===i.matchedPoints)s=Hu(r.points,i);else{if(i.matchedPoints[0]>t.points.length-1||i.matchedPoints[1]>r.points.length-1)throw Error("Matched points out of range in "+t.name);var o=t.points[i.matchedPoints[0]],a=r.points[i.matchedPoints[1]],l={xScale:i.xScale,scale01:i.scale01,scale10:i.scale10,yScale:i.yScale,dx:0,dy:0};a=Hu([a],l)[0],l.dx=o.x-a.x,l.dy=o.y-a.y,s=Hu(r.points,l)}t.points=t.points.concat(s)}}return Uu(t.points)}_u.prototype={searchTag:Au,binSearch:Mu,getTable:function(e){var t=this.font.tables[this.tableName];return!t&&e&&(t=this.font.tables[this.tableName]=this.createDefaultTable()),t},getScriptNames:function(){var e=this.getTable();return e?e.scripts.map(function(e){return e.tag}):[]},getDefaultScriptName:function(){var e=this.getTable();if(e){for(var t=!1,n=0;n<e.scripts.length;n++){var i=e.scripts[n].tag;if("DFLT"===i)return i;"latn"===i&&(t=!0)}return t?"latn":void 0}},getScriptTable:function(e,t){var n=this.getTable(t);if(n){e=e||"DFLT";var i=n.scripts,r=Au(n.scripts,e);if(r>=0)return i[r].script;if(t){var s={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return i.splice(-1-r,0,s),s.script}}},getLangSysTable:function(e,t,n){var i=this.getScriptTable(e,n);if(i){if(!t||"dflt"===t||"DFLT"===t)return i.defaultLangSys;var r=Au(i.langSysRecords,t);if(r>=0)return i.langSysRecords[r].langSys;if(n){var s={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return i.langSysRecords.splice(-1-r,0,s),s.langSys}}},getFeatureTable:function(e,t,n,i){var r=this.getLangSysTable(e,t,i);if(r){for(var s,o=r.featureIndexes,a=this.font.tables[this.tableName].features,l=0;l<o.length;l++)if((s=a[o[l]]).tag===n)return s.feature;if(i){var c=a.length;return Bc.assert(0===c||n>=a[c-1].tag,"Features must be added in alphabetical order."),s={tag:n,feature:{params:0,lookupListIndexes:[]}},a.push(s),o.push(c),s.feature}}},getLookupTables:function(e,t,n,i,r){var s=this.getFeatureTable(e,t,n,r),o=[];if(s){for(var a,l=s.lookupListIndexes,c=this.font.tables[this.tableName].lookups,h=0;h<l.length;h++)(a=c[l[h]]).lookupType===i&&o.push(a);if(0===o.length&&r){a={lookupType:i,lookupFlag:0,subtables:[],markFilteringSet:void 0};var u=c.length;return c.push(a),l.push(u),[a]}}return o},getGlyphClass:function(e,t){switch(e.format){case 1:return e.startGlyph<=t&&t<e.startGlyph+e.classes.length?e.classes[t-e.startGlyph]:0;case 2:var n=Iu(e.ranges,t);return n?n.classId:0}},getCoverageIndex:function(e,t){switch(e.format){case 1:var n=Mu(e.glyphs,t);return n>=0?n:-1;case 2:var i=Iu(e.ranges,t);return i?i.index+t-i.start:-1}},expandCoverage:function(e){if(1===e.format)return e.glyphs;for(var t=[],n=e.ranges,i=0;i<n.length;i++)for(var r=n[i],s=r.start,o=r.end,a=s;a<=o;a++)t.push(a);return t}},Ou.prototype=_u.prototype,Ou.prototype.init=function(){var e=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(e)},Ou.prototype.getKerningValue=function(e,t,n){for(var i=0;i<e.length;i++)for(var r=e[i].subtables,s=0;s<r.length;s++){var o=r[s],a=this.getCoverageIndex(o.coverage,t);if(!(a<0))switch(o.posFormat){case 1:for(var l=o.pairSets[a],c=0;c<l.length;c++){var h=l[c];if(h.secondGlyph===n)return h.value1&&h.value1.xAdvance||0}break;case 2:var u=this.getGlyphClass(o.classDef1,t),d=this.getGlyphClass(o.classDef2,n),p=o.classRecords[u][d];return p.value1&&p.value1.xAdvance||0}}return 0},Ou.prototype.getKerningTables=function(e,t){if(this.font.tables.gpos)return this.getLookupTables(e,t,"kern",2)},Nu.prototype=_u.prototype,Nu.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Nu.prototype.getSingle=function(e,t,n){for(var i=[],r=this.getLookupTables(t,n,e,1),s=0;s<r.length;s++)for(var o=r[s].subtables,a=0;a<o.length;a++){var l=o[a],c=this.expandCoverage(l.coverage),h=void 0;if(1===l.substFormat){var u=l.deltaGlyphId;for(h=0;h<c.length;h++){var d=c[h];i.push({sub:d,by:d+u})}}else{var p=l.substitute;for(h=0;h<c.length;h++)i.push({sub:c[h],by:p[h]})}}return i},Nu.prototype.getMultiple=function(e,t,n){for(var i=[],r=this.getLookupTables(t,n,e,2),s=0;s<r.length;s++)for(var o=r[s].subtables,a=0;a<o.length;a++){var l=o[a],c=this.expandCoverage(l.coverage),h=void 0;for(h=0;h<c.length;h++){var u=c[h],d=l.sequences[h];i.push({sub:u,by:d})}}return i},Nu.prototype.getAlternates=function(e,t,n){for(var i=[],r=this.getLookupTables(t,n,e,3),s=0;s<r.length;s++)for(var o=r[s].subtables,a=0;a<o.length;a++)for(var l=o[a],c=this.expandCoverage(l.coverage),h=l.alternateSets,u=0;u<c.length;u++)i.push({sub:c[u],by:h[u]});return i},Nu.prototype.getLigatures=function(e,t,n){for(var i=[],r=this.getLookupTables(t,n,e,4),s=0;s<r.length;s++)for(var o=r[s].subtables,a=0;a<o.length;a++)for(var l=o[a],c=this.expandCoverage(l.coverage),h=l.ligatureSets,u=0;u<c.length;u++)for(var d=c[u],p=h[u],f=0;f<p.length;f++){var m=p[f];i.push({sub:[d].concat(m.components),by:m.ligGlyph})}return i},Nu.prototype.addSingle=function(e,t,n,i){var r=Ru(this.getLookupTables(n,i,e,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});Bc.assert(1===r.coverage.format,"Single: unable to modify coverage table format "+r.coverage.format);var s=t.sub,o=this.binSearch(r.coverage.glyphs,s);o<0&&(o=-1-o,r.coverage.glyphs.splice(o,0,s),r.substitute.splice(o,0,0)),r.substitute[o]=t.by},Nu.prototype.addMultiple=function(e,t,n,i){Bc.assert(t.by instanceof Array&&t.by.length>1,'Multiple: "by" must be an array of two or more ids');var r=Ru(this.getLookupTables(n,i,e,2,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});Bc.assert(1===r.coverage.format,"Multiple: unable to modify coverage table format "+r.coverage.format);var s=t.sub,o=this.binSearch(r.coverage.glyphs,s);o<0&&(o=-1-o,r.coverage.glyphs.splice(o,0,s),r.sequences.splice(o,0,0)),r.sequences[o]=t.by},Nu.prototype.addAlternate=function(e,t,n,i){var r=Ru(this.getLookupTables(n,i,e,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});Bc.assert(1===r.coverage.format,"Alternate: unable to modify coverage table format "+r.coverage.format);var s=t.sub,o=this.binSearch(r.coverage.glyphs,s);o<0&&(o=-1-o,r.coverage.glyphs.splice(o,0,s),r.alternateSets.splice(o,0,0)),r.alternateSets[o]=t.by},Nu.prototype.addLigature=function(e,t,n,i){var r=this.getLookupTables(n,i,e,4,!0)[0],s=r.subtables[0];s||(s={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},r.subtables[0]=s),Bc.assert(1===s.coverage.format,"Ligature: unable to modify coverage table format "+s.coverage.format);var o=t.sub[0],a=t.sub.slice(1),l={ligGlyph:t.by,components:a},c=this.binSearch(s.coverage.glyphs,o);if(c>=0){for(var h=s.ligatureSets[c],u=0;u<h.length;u++)if(Du(h[u].components,a))return;h.push(l)}else c=-1-c,s.coverage.glyphs.splice(c,0,o),s.ligatureSets.splice(c,0,[l])},Nu.prototype.getFeature=function(e,t,n){if(/ss\d\d/.test(e))return this.getSingle(e,t,n);switch(e){case"aalt":case"salt":return this.getSingle(e,t,n).concat(this.getAlternates(e,t,n));case"dlig":case"liga":case"rlig":return this.getLigatures(e,t,n);case"ccmp":return this.getMultiple(e,t,n).concat(this.getLigatures(e,t,n));case"stch":return this.getMultiple(e,t,n)}},Nu.prototype.add=function(e,t,n,i){if(/ss\d\d/.test(e))return this.addSingle(e,t,n,i);switch(e){case"aalt":case"salt":return"number"==typeof t.by?this.addSingle(e,t,n,i):this.addAlternate(e,t,n,i);case"dlig":case"liga":case"rlig":return this.addLigature(e,t,n,i);case"ccmp":return t.by instanceof Array?this.addMultiple(e,t,n,i):this.addLigature(e,t,n,i)}};var Wu,Gu,$u,Zu,qu={getPath:Uu,parse:function(e,t,n,i,r){return r.lowMemory?function(e,t,n,i){var r=new Mh.GlyphSet(i);return i._push=function(s){var o=n[s];o!==n[s+1]?r.push(s,Mh.ttfGlyphLoader(i,s,ju,e,t+o,zu)):r.push(s,Mh.glyphLoader(i,s))},r}(e,t,n,i):function(e,t,n,i){for(var r=new Mh.GlyphSet(i),s=0;s<n.length-1;s+=1){var o=n[s];o!==n[s+1]?r.push(s,Mh.ttfGlyphLoader(i,s,ju,e,t+o,zu)):r.push(s,Mh.glyphLoader(i,s))}return r}(e,t,n,i)}};function Ku(e){this.font=e,this.getCommands=function(e){return qu.getPath(e).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Yu(e){return e}function Xu(e){return Math.sign(e)*Math.round(Math.abs(e))}function Ju(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function Qu(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function ed(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function td(e){return Math.sign(e)*Math.floor(Math.abs(e))}var nd=function(e){var t=this.srPeriod,n=this.srPhase,i=1;return e<0&&(e=-e,i=-1),e+=this.srThreshold-n,e=Math.trunc(e/t)*t,(e+=n)<0?n*i:e*i},id={x:1,y:0,axis:"x",distance:function(e,t,n,i){return(n?e.xo:e.x)-(i?t.xo:t.x)},interpolate:function(e,t,n,i){var r,s,o,a,l,c,h;if(!i||i===this)return r=e.xo-t.xo,s=e.xo-n.xo,l=t.x-t.xo,c=n.x-n.xo,0===(h=(o=Math.abs(r))+(a=Math.abs(s)))?void(e.x=e.xo+(l+c)/2):void(e.x=e.xo+(l*a+c*o)/h);r=i.distance(e,t,!0,!0),s=i.distance(e,n,!0,!0),l=i.distance(t,t,!1,!0),c=i.distance(n,n,!1,!0),0!==(h=(o=Math.abs(r))+(a=Math.abs(s)))?id.setRelative(e,e,(l*a+c*o)/h,i,!0):id.setRelative(e,e,(l+c)/2,i,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,t,n,i,r){if(i&&i!==this){var s=r?t.xo:t.x,o=r?t.yo:t.y,a=s+n*i.x,l=o+n*i.y;e.x=a+(e.y-l)/i.normalSlope}else e.x=(r?t.xo:t.x)+n},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},rd={x:0,y:1,axis:"y",distance:function(e,t,n,i){return(n?e.yo:e.y)-(i?t.yo:t.y)},interpolate:function(e,t,n,i){var r,s,o,a,l,c,h;if(!i||i===this)return r=e.yo-t.yo,s=e.yo-n.yo,l=t.y-t.yo,c=n.y-n.yo,0===(h=(o=Math.abs(r))+(a=Math.abs(s)))?void(e.y=e.yo+(l+c)/2):void(e.y=e.yo+(l*a+c*o)/h);r=i.distance(e,t,!0,!0),s=i.distance(e,n,!0,!0),l=i.distance(t,t,!1,!0),c=i.distance(n,n,!1,!0),0!==(h=(o=Math.abs(r))+(a=Math.abs(s)))?rd.setRelative(e,e,(l*a+c*o)/h,i,!0):rd.setRelative(e,e,(l+c)/2,i,!0)},normalSlope:0,setRelative:function(e,t,n,i,r){if(i&&i!==this){var s=r?t.xo:t.x,o=r?t.yo:t.y,a=s+n*i.x,l=o+n*i.y;e.y=l+i.normalSlope*(e.x-a)}else e.y=(r?t.yo:t.y)+n},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};function sd(e,t){this.x=e,this.y=t,this.axis=void 0,this.slope=t/e,this.normalSlope=-e/t,Object.freeze(this)}function od(e,t){var n=Math.sqrt(e*e+t*t);return t/=n,1===(e/=n)&&0===t?id:0===e&&1===t?rd:new sd(e,t)}function ad(e,t,n,i){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*t)/64,this.lastPointOfContour=n,this.onCurve=i,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(id),Object.freeze(rd),sd.prototype.distance=function(e,t,n,i){return this.x*id.distance(e,t,n,i)+this.y*rd.distance(e,t,n,i)},sd.prototype.interpolate=function(e,t,n,i){var r,s,o,a,l,c,h;o=i.distance(e,t,!0,!0),a=i.distance(e,n,!0,!0),r=i.distance(t,t,!1,!0),s=i.distance(n,n,!1,!0),0!==(h=(l=Math.abs(o))+(c=Math.abs(a)))?this.setRelative(e,e,(r*c+s*l)/h,i,!0):this.setRelative(e,e,(r+s)/2,i,!0)},sd.prototype.setRelative=function(e,t,n,i,r){i=i||this;var s=r?t.xo:t.x,o=r?t.yo:t.y,a=s+n*i.x,l=o+n*i.y,c=i.normalSlope,h=this.slope,u=e.x,d=e.y;e.x=(h*u-c*a+l-d)/(h-c),e.y=h*(e.x-u)+d},sd.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},ad.prototype.nextTouched=function(e){for(var t=this.nextPointOnContour;!e.touched(t)&&t!==this;)t=t.nextPointOnContour;return t},ad.prototype.prevTouched=function(e){for(var t=this.prevPointOnContour;!e.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};var ld=Object.freeze(new ad(0,0)),cd={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function hd(e,t){switch(this.env=e,this.stack=[],this.prog=t,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=id,this.round=Xu}}function ud(e){for(var t=e.tZone=new Array(e.gZone.length),n=0;n<t.length;n++)t[n]=new ad(0,0)}function dd(e,t){var n,i=e.prog,r=e.ip,s=1;do{if(88===(n=i[++r]))s++;else if(89===n)s--;else if(64===n)r+=i[r+1]+1;else if(65===n)r+=2*i[r+1]+1;else if(n>=176&&n<=183)r+=n-176+1;else if(n>=184&&n<=191)r+=2*(n-184+1);else if(t&&1===s&&27===n)break}while(s>0);e.ip=r}function pd(e,t){exports.DEBUG,t.fv=t.pv=t.dpv=e}function fd(e,t){exports.DEBUG,t.pv=t.dpv=e}function md(e,t){exports.DEBUG,t.fv=e}function gd(e,t){var n,i,r=t.stack,s=r.pop(),o=r.pop(),a=t.z2[s],l=t.z1[o];exports.DEBUG,e?(n=a.y-l.y,i=l.x-a.x):(n=l.x-a.x,i=l.y-a.y),t.pv=t.dpv=od(n,i)}function vd(e,t){var n,i,r=t.stack,s=r.pop(),o=r.pop(),a=t.z2[s],l=t.z1[o];exports.DEBUG,e?(n=a.y-l.y,i=l.x-a.x):(n=l.x-a.x,i=l.y-a.y),t.fv=od(n,i)}function yd(e){exports.DEBUG,e.stack.pop()}function bd(e,t){var n=t.stack.pop(),i=t.z0[n],r=t.fv,s=t.pv;exports.DEBUG;var o=s.distance(i,ld);e&&(o=t.round(o)),r.setRelative(i,ld,o,s),r.touch(i),t.rp0=t.rp1=n}function wd(e,t){var n,i,r,s=t.z2,o=s.length-2;exports.DEBUG;for(var a=0;a<o;a++)n=s[a],e.touched(n)||(i=n.prevTouched(e))!==n&&(i===(r=n.nextTouched(e))&&e.setRelative(n,n,e.distance(i,i,!1,!0),e,!0),e.interpolate(n,i,r,e))}function xd(e,t){for(var n=t.stack,i=e?t.rp1:t.rp2,r=(e?t.z0:t.z1)[i],s=t.fv,o=t.pv,a=t.loop,l=t.z2;a--;){var c=l[n.pop()],h=o.distance(r,r,!1,!0);s.setRelative(c,c,h,o),s.touch(c),exports.DEBUG}t.loop=1}function Cd(e,t){var n=t.stack,i=e?t.rp1:t.rp2,r=(e?t.z0:t.z1)[i],s=t.fv,o=t.pv,a=n.pop(),l=t.z2[t.contours[a]],c=l;exports.DEBUG;var h=o.distance(r,r,!1,!0);do{c!==r&&s.setRelative(c,c,h,o),c=c.nextPointOnContour}while(c!==l)}function Sd(e,t){var n,i,r=t.stack,s=e?t.rp1:t.rp2,o=(e?t.z0:t.z1)[s],a=t.fv,l=t.pv,c=r.pop();switch(exports.DEBUG,c){case 0:n=t.tZone;break;case 1:n=t.gZone;break;default:throw new Error("Invalid zone")}for(var h=l.distance(o,o,!1,!0),u=n.length-2,d=0;d<u;d++)i=n[d],a.setRelative(i,i,h,l)}function kd(e,t){var n=t.stack,i=n.pop()/64,r=n.pop(),s=t.z1[r],o=t.z0[t.rp0],a=t.fv,l=t.pv;a.setRelative(s,o,i,l),a.touch(s),exports.DEBUG,t.rp1=t.rp0,t.rp2=r,e&&(t.rp0=r)}function Ld(e,t){var n=t.stack,i=n.pop(),r=n.pop(),s=t.z0[r],o=t.fv,a=t.pv,l=t.cvt[i];exports.DEBUG;var c=a.distance(s,ld);e&&(Math.abs(c-l)<t.cvCutIn&&(c=l),c=t.round(c)),o.setRelative(s,ld,c,a),0===t.zp0&&(s.xo=s.x,s.yo=s.y),o.touch(s),t.rp0=t.rp1=r}function Ed(e,t){var n=t.stack,i=n.pop(),r=t.z2[i];exports.DEBUG,n.push(64*t.dpv.distance(r,ld,e,!1))}function Pd(e,t){var n=t.stack,i=n.pop(),r=n.pop(),s=t.z1[i],o=t.z0[r],a=t.dpv.distance(o,s,e,e);exports.DEBUG,t.stack.push(Math.round(64*a))}function Td(e,t){var n=t.stack,i=n.pop(),r=t.fv,s=t.pv,o=t.ppem,a=t.deltaBase+16*(e-1),l=t.deltaShift,c=t.z0;exports.DEBUG;for(var h=0;h<i;h++){var u=n.pop(),d=n.pop();if(a+((240&d)>>4)===o){var p=(15&d)-8;p>=0&&p++,exports.DEBUG;var f=c[u];r.setRelative(f,f,p*l,s)}}}function Ad(e,t){var n=t.stack,i=n.pop();exports.DEBUG,n.push(64*t.round(i/64))}function Md(e,t){var n=t.stack,i=n.pop(),r=t.ppem,s=t.deltaBase+16*(e-1),o=t.deltaShift;exports.DEBUG;for(var a=0;a<i;a++){var l=n.pop(),c=n.pop();if(s+((240&c)>>4)===r){var h=(15&c)-8;h>=0&&h++;var u=h*o;exports.DEBUG,t.cvt[l]+=u}}}function Id(e,t){var n,i,r=t.stack,s=r.pop(),o=r.pop(),a=t.z2[s],l=t.z1[o];exports.DEBUG,e?(n=a.y-l.y,i=l.x-a.x):(n=l.x-a.x,i=l.y-a.y),t.dpv=od(n,i)}function _d(e,t){var n=t.stack,i=t.prog,r=t.ip;exports.DEBUG;for(var s=0;s<e;s++)n.push(i[++r]);t.ip=r}function Od(e,t){var n=t.ip,i=t.prog,r=t.stack;exports.DEBUG;for(var s=0;s<e;s++){var o=i[++n]<<8|i[++n];32768&o&&(o=-(1+(65535^o))),r.push(o)}t.ip=n}function Nd(e,t,n,i,r,s){var o,a,l,c=s.stack,h=e&&c.pop(),u=c.pop(),d=s.rp0,p=s.z0[d],f=s.z1[u],m=s.minDis,g=s.fv,v=s.dpv;a=(o=v.distance(f,p,!0,!0))>=0?1:-1,o=Math.abs(o),e&&(l=s.cvt[h],i&&Math.abs(o-l)<s.cvCutIn&&(o=l)),n&&o<m&&(o=m),i&&(o=s.round(o)),g.setRelative(f,p,a*o,v),g.touch(f),exports.DEBUG,s.rp1=s.rp0,s.rp2=u,t&&(s.rp0=u)}function Dd(e){this.char=e,this.state={},this.activeState=null}function Rd(e,t,n){this.contextName=n,this.startIndex=e,this.endOffset=t}function Fd(e,t,n){this.contextName=e,this.openRange=null,this.ranges=[],this.checkStart=t,this.checkEnd=n}function Bd(e,t){this.context=e,this.index=t,this.length=e.length,this.current=e[t],this.backtrack=e.slice(0,t),this.lookahead=e.slice(t+1)}function Vd(e){this.eventId=e,this.subscribers=[]}function jd(e){var t=this,n=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];n.forEach(function(e){Object.defineProperty(t.events,e,{value:new Vd(e)})}),e&&n.forEach(function(n){var i=e[n];"function"==typeof i&&t.events[n].subscribe(i)});["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"].forEach(function(e){t.events[e].subscribe(t.updateContextsRanges)})}function Hd(e){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],jd.call(this,e)}function Ud(e){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(e)}function zd(e){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(e)}function Wd(e){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(e)}function Gd(e){return/[A-z]/.test(e)}function $d(e){this.font=e,this.features={}}function Zd(e){this.id=e.id,this.tag=e.tag,this.substitution=e.substitution}function qd(e,t){if(!e)return-1;switch(t.format){case 1:return t.glyphs.indexOf(e);case 2:for(var n=t.ranges,i=0;i<n.length;i++){var r=n[i];if(e>=r.start&&e<=r.end){var s=e-r.start;return r.index+s}}break;default:return-1}return-1}function Kd(e,t){return-1===qd(e,t.coverage)?null:e+t.deltaGlyphId}function Yd(e,t){var n=qd(e,t.coverage);return-1===n?null:t.substitute[n]}function Xd(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i],s=t.current,o=qd(s=Array.isArray(s)?s[0]:s,r);-1!==o&&n.push(o)}return n.length!==e.length?-1:n}function Jd(e,t){var n=t.inputCoverage.length+t.lookaheadCoverage.length+t.backtrackCoverage.length;if(e.context.length<n)return[];var i=Xd(t.inputCoverage,e);if(-1===i)return[];var r=t.inputCoverage.length-1;if(e.lookahead.length<t.lookaheadCoverage.length)return[];for(var s=e.lookahead.slice(r);s.length&&Wd(s[0].char);)s.shift();var o=new Bd(s,0),a=Xd(t.lookaheadCoverage,o),l=[].concat(e.backtrack);for(l.reverse();l.length&&Wd(l[0].char);)l.shift();if(l.length<t.backtrackCoverage.length)return[];var c=new Bd(l,0),h=Xd(t.backtrackCoverage,c),u=[];if(i.length===t.inputCoverage.length&&a.length===t.lookaheadCoverage.length&&h.length===t.backtrackCoverage.length)for(var d=0;d<t.lookupRecords.length;d++)for(var p=t.lookupRecords[d].lookupListIndex,f=this.getLookupByIndex(p),m=0;m<f.subtables.length;m++){var g=f.subtables[m],v=this.getLookupMethod(f,g);if("12"===this.getSubstitutionType(f,g))for(var y=0;y<i.length;y++){var b=v(e.get(y));b&&u.push(b)}}return u}function Qd(e,t){var n,i=qd(e.current,t.coverage);if(-1===i)return null;for(var r=t.ligatureSets[i],s=0;s<r.length;s++){n=r[s];for(var o=0;o<n.components.length;o++){if(e.lookahead[o]!==n.components[o])break;if(o===n.components.length-1)return n}}return null}function ep(e,t){var n=qd(e,t.coverage);return-1===n?null:t.sequences[n]}Ku.prototype.exec=function(e,t){if("number"!=typeof t)throw new Error("Point size is not a number!");if(!(this._errorState>2)){var n=this.font,i=this._prepState;if(!i||i.ppem!==t){var r=this._fpgmState;if(!r){hd.prototype=cd,(r=this._fpgmState=new hd("fpgm",n.tables.fpgm)).funcs=[],r.font=n,exports.DEBUG&&(r.step=-1);try{Gu(r)}catch(c){return void(this._errorState=3)}}hd.prototype=r,(i=this._prepState=new hd("prep",n.tables.prep)).ppem=t;var s=n.tables.cvt;if(s)for(var o=i.cvt=new Array(s.length),a=t/n.unitsPerEm,l=0;l<s.length;l++)o[l]=s[l]*a;else i.cvt=[];exports.DEBUG&&(i.step=-1);try{Gu(i)}catch(c){this._errorState,this._errorState=2}}if(!(this._errorState>1))try{return $u(e,i)}catch(c){return this._errorState,void(this._errorState=1)}}},$u=function(e,t){var n,i,r,s=t.ppem/t.font.unitsPerEm,o=s,a=e.components;if(hd.prototype=t,a){var l=t.font;i=[],n=[];for(var c=0;c<a.length;c++){var h=a[c],u=l.glyphs.get(h.glyphIndex);r=new hd("glyf",u.instructions),exports.DEBUG&&(r.step=-1),Zu(u,r,s,o);for(var d=Math.round(h.dx*s),p=Math.round(h.dy*o),f=r.gZone,m=r.contours,g=0;g<f.length;g++){var v=f[g];v.xTouched=v.yTouched=!1,v.xo=v.x=v.x+d,v.yo=v.y=v.y+p}var y=i.length;i.push.apply(i,f);for(var b=0;b<m.length;b++)n.push(m[b]+y)}e.instructions&&!r.inhibitGridFit&&((r=new hd("glyf",e.instructions)).gZone=r.z0=r.z1=r.z2=i,r.contours=n,i.push(new ad(0,0),new ad(Math.round(e.advanceWidth*s),0)),exports.DEBUG&&(r.step=-1),Gu(r),i.length-=2)}else r=new hd("glyf",e.instructions),exports.DEBUG&&(r.step=-1),Zu(e,r,s,o),i=r.gZone;return i},Zu=function(e,t,n,i){for(var r,s,o,a=e.points||[],l=a.length,c=t.gZone=t.z0=t.z1=t.z2=[],h=t.contours=[],u=0;u<l;u++)r=a[u],c[u]=new ad(r.x*n,r.y*i,r.lastPointOfContour,r.onCurve);for(var d=0;d<l;d++)r=c[d],s||(s=r,h.push(d)),r.lastPointOfContour?(r.nextPointOnContour=s,s.prevPointOnContour=r,s=void 0):(o=c[d+1],r.nextPointOnContour=o,o.prevPointOnContour=r);if(!t.inhibitGridFit){if(exports.DEBUG)for(var p=0;p<l;p++);if(c.push(new ad(0,0),new ad(Math.round(e.advanceWidth*n),0)),Gu(t),c.length-=2,exports.DEBUG)for(var f=0;f<l;f++);}},Gu=function(e){var t=e.prog;if(t){var n,i=t.length;for(e.ip=0;e.ip<i;e.ip++){if(exports.DEBUG&&e.step++,!(n=Wu[t[e.ip]]))throw new Error("unknown instruction: 0x"+Number(t[e.ip]).toString(16));n(e)}}},Wu=[pd.bind(void 0,rd),pd.bind(void 0,id),fd.bind(void 0,rd),fd.bind(void 0,id),md.bind(void 0,rd),md.bind(void 0,id),gd.bind(void 0,0),gd.bind(void 0,1),vd.bind(void 0,0),vd.bind(void 0,1),function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,e.pv=e.dpv=od(i,n)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,e.fv=od(i,n)},function(e){var t=e.stack,n=e.pv;exports.DEBUG,t.push(16384*n.x),t.push(16384*n.y)},function(e){var t=e.stack,n=e.fv;exports.DEBUG,t.push(16384*n.x),t.push(16384*n.y)},function(e){e.fv=e.pv,exports.DEBUG},function(e){var t=e.stack,n=t.pop(),i=t.pop(),r=t.pop(),s=t.pop(),o=t.pop(),a=e.z0,l=e.z1,c=a[n],h=a[i],u=l[r],d=l[s],p=e.z2[o];exports.DEBUG;var f=c.x,m=c.y,g=h.x,v=h.y,y=u.x,b=u.y,w=d.x,x=d.y,C=(f-g)*(b-x)-(m-v)*(y-w),S=f*v-m*g,k=y*x-b*w;p.x=(S*(y-w)-k*(f-g))/C,p.y=(S*(b-x)-k*(m-v))/C},function(e){e.rp0=e.stack.pop(),exports.DEBUG},function(e){e.rp1=e.stack.pop(),exports.DEBUG},function(e){e.rp2=e.stack.pop(),exports.DEBUG},function(e){var t=e.stack.pop();switch(exports.DEBUG,e.zp0=t,t){case 0:e.tZone||ud(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var t=e.stack.pop();switch(exports.DEBUG,e.zp1=t,t){case 0:e.tZone||ud(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var t=e.stack.pop();switch(exports.DEBUG,e.zp2=t,t){case 0:e.tZone||ud(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var t=e.stack.pop();switch(exports.DEBUG,e.zp0=e.zp1=e.zp2=t,t){case 0:e.tZone||ud(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){e.loop=e.stack.pop(),exports.DEBUG},function(e){exports.DEBUG,e.round=Xu},function(e){exports.DEBUG,e.round=Qu},function(e){var t=e.stack.pop();exports.DEBUG,e.minDis=t/64},function(e){exports.DEBUG,dd(e,!1)},function(e){var t=e.stack.pop();exports.DEBUG,e.ip+=t-1},function(e){var t=e.stack.pop();exports.DEBUG,e.cvCutIn=t/64},void 0,void 0,function(e){var t=e.stack;exports.DEBUG,t.push(t[t.length-1])},yd,function(e){exports.DEBUG,e.stack.length=0},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(n),t.push(i)},function(e){var t=e.stack;exports.DEBUG,t.push(t.length)},function(e){var t=e.stack,n=t.pop();exports.DEBUG,t.push(t[t.length-n])},function(e){var t=e.stack,n=t.pop();exports.DEBUG,t.push(t.splice(t.length-n,1)[0])},void 0,void 0,void 0,function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG;var r=e.ip,s=e.prog;e.prog=e.funcs[n];for(var o=0;o<i;o++)Gu(e),exports.DEBUG;e.ip=r,e.prog=s},function(e){var t=e.stack.pop();exports.DEBUG;var n=e.ip,i=e.prog;e.prog=e.funcs[t],Gu(e),e.ip=n,e.prog=i,exports.DEBUG},function(e){if("fpgm"!==e.env)throw new Error("FDEF not allowed here");var t=e.stack,n=e.prog,i=e.ip,r=t.pop(),s=i;for(exports.DEBUG;45!==n[++i];);e.ip=i,e.funcs[r]=n.slice(s+1,i)},void 0,bd.bind(void 0,0),bd.bind(void 0,1),wd.bind(void 0,rd),wd.bind(void 0,id),xd.bind(void 0,0),xd.bind(void 0,1),Cd.bind(void 0,0),Cd.bind(void 0,1),Sd.bind(void 0,0),Sd.bind(void 0,1),function(e){for(var t=e.stack,n=e.loop,i=e.fv,r=t.pop()/64,s=e.z2;n--;){var o=s[t.pop()];exports.DEBUG,i.setRelative(o,o,r),i.touch(o)}e.loop=1},function(e){for(var t=e.stack,n=e.rp1,i=e.rp2,r=e.loop,s=e.z0[n],o=e.z1[i],a=e.fv,l=e.dpv,c=e.z2;r--;){var h=c[t.pop()];exports.DEBUG,a.interpolate(h,s,o,l),a.touch(h)}e.loop=1},kd.bind(void 0,0),kd.bind(void 0,1),function(e){for(var t=e.stack,n=e.rp0,i=e.z0[n],r=e.loop,s=e.fv,o=e.pv,a=e.z1;r--;){var l=a[t.pop()];exports.DEBUG,s.setRelative(l,i,0,o),s.touch(l)}e.loop=1},function(e){exports.DEBUG,e.round=Ju},Ld.bind(void 0,0),Ld.bind(void 0,1),function(e){var t=e.prog,n=e.ip,i=e.stack,r=t[++n];exports.DEBUG;for(var s=0;s<r;s++)i.push(t[++n]);e.ip=n},function(e){var t=e.ip,n=e.prog,i=e.stack,r=n[++t];exports.DEBUG;for(var s=0;s<r;s++){var o=n[++t]<<8|n[++t];32768&o&&(o=-(1+(65535^o))),i.push(o)}e.ip=t},function(e){var t=e.stack,n=e.store;n||(n=e.store=[]);var i=t.pop(),r=t.pop();exports.DEBUG,n[r]=i},function(e){var t=e.stack,n=e.store,i=t.pop();exports.DEBUG;var r=n&&n[i]||0;t.push(r)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,e.cvt[i]=n/64},function(e){var t=e.stack,n=t.pop();exports.DEBUG,t.push(64*e.cvt[n])},Ed.bind(void 0,0),Ed.bind(void 0,1),void 0,Pd.bind(void 0,0),Pd.bind(void 0,1),function(e){exports.DEBUG,e.stack.push(e.ppem)},void 0,function(e){exports.DEBUG,e.autoFlip=!0},void 0,void 0,function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(i<n?1:0)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(i<=n?1:0)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(i>n?1:0)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(i>=n?1:0)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(n===i?1:0)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(n!==i?1:0)},function(e){var t=e.stack,n=t.pop();exports.DEBUG,t.push(Math.trunc(n)%2?1:0)},function(e){var t=e.stack,n=t.pop();exports.DEBUG,t.push(Math.trunc(n)%2?0:1)},function(e){var t=e.stack.pop();exports.DEBUG,t||(dd(e,!0),exports.DEBUG)},function(e){exports.DEBUG},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(n&&i?1:0)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(n||i?1:0)},function(e){var t=e.stack,n=t.pop();exports.DEBUG,t.push(n?0:1)},Td.bind(void 0,1),function(e){var t=e.stack.pop();exports.DEBUG,e.deltaBase=t},function(e){var t=e.stack.pop();exports.DEBUG,e.deltaShift=Math.pow(.5,t)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(i+n)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(i-n)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(64*i/n)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(i*n/64)},function(e){var t=e.stack,n=t.pop();exports.DEBUG,t.push(Math.abs(n))},function(e){var t=e.stack,n=t.pop();exports.DEBUG,t.push(-n)},function(e){var t=e.stack,n=t.pop();exports.DEBUG,t.push(64*Math.floor(n/64))},function(e){var t=e.stack,n=t.pop();exports.DEBUG,t.push(64*Math.ceil(n/64))},Ad.bind(void 0,0),Ad.bind(void 0,1),Ad.bind(void 0,2),Ad.bind(void 0,3),void 0,void 0,void 0,void 0,function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,e.cvt[i]=n*e.ppem/e.font.unitsPerEm},Td.bind(void 0,2),Td.bind(void 0,3),Md.bind(void 0,1),Md.bind(void 0,2),Md.bind(void 0,3),function(e){var t,n=e.stack.pop();switch(exports.DEBUG,e.round=nd,192&n){case 0:t=.5;break;case 64:t=1;break;case 128:t=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=t,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*t;break;case 32:e.srPhase=.5*t;break;case 48:e.srPhase=.75*t;break;default:throw new Error("invalid SROUND value")}n&=15,e.srThreshold=0===n?0:(n/8-.5)*t},function(e){var t,n=e.stack.pop();switch(exports.DEBUG,e.round=nd,192&n){case 0:t=Math.sqrt(2)/2;break;case 64:t=Math.sqrt(2);break;case 128:t=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=t,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*t;break;case 32:e.srPhase=.5*t;break;case 48:e.srPhase=.75*t;break;default:throw new Error("invalid S45ROUND value")}n&=15,e.srThreshold=0===n?0:(n/8-.5)*t},void 0,void 0,function(e){exports.DEBUG,e.round=Yu},void 0,function(e){exports.DEBUG,e.round=ed},function(e){exports.DEBUG,e.round=td},yd,yd,void 0,void 0,void 0,void 0,void 0,function(e){e.stack.pop(),exports.DEBUG},Id.bind(void 0,0),Id.bind(void 0,1),function(e){var t=e.stack,n=t.pop(),i=0;exports.DEBUG,1&n&&(i=35),32&n&&(i|=4096),t.push(i)},void 0,function(e){var t=e.stack,n=t.pop(),i=t.pop(),r=t.pop();exports.DEBUG,t.push(i),t.push(n),t.push(r)},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(Math.max(i,n))},function(e){var t=e.stack,n=t.pop(),i=t.pop();exports.DEBUG,t.push(Math.min(i,n))},function(e){e.stack.pop(),exports.DEBUG},function(e){var t=e.stack.pop(),n=e.stack.pop();switch(exports.DEBUG,t){case 1:return void(e.inhibitGridFit=!!n);case 2:return void(e.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,_d.bind(void 0,1),_d.bind(void 0,2),_d.bind(void 0,3),_d.bind(void 0,4),_d.bind(void 0,5),_d.bind(void 0,6),_d.bind(void 0,7),_d.bind(void 0,8),Od.bind(void 0,1),Od.bind(void 0,2),Od.bind(void 0,3),Od.bind(void 0,4),Od.bind(void 0,5),Od.bind(void 0,6),Od.bind(void 0,7),Od.bind(void 0,8),Nd.bind(void 0,0,0,0,0,0),Nd.bind(void 0,0,0,0,0,1),Nd.bind(void 0,0,0,0,0,2),Nd.bind(void 0,0,0,0,0,3),Nd.bind(void 0,0,0,0,1,0),Nd.bind(void 0,0,0,0,1,1),Nd.bind(void 0,0,0,0,1,2),Nd.bind(void 0,0,0,0,1,3),Nd.bind(void 0,0,0,1,0,0),Nd.bind(void 0,0,0,1,0,1),Nd.bind(void 0,0,0,1,0,2),Nd.bind(void 0,0,0,1,0,3),Nd.bind(void 0,0,0,1,1,0),Nd.bind(void 0,0,0,1,1,1),Nd.bind(void 0,0,0,1,1,2),Nd.bind(void 0,0,0,1,1,3),Nd.bind(void 0,0,1,0,0,0),Nd.bind(void 0,0,1,0,0,1),Nd.bind(void 0,0,1,0,0,2),Nd.bind(void 0,0,1,0,0,3),Nd.bind(void 0,0,1,0,1,0),Nd.bind(void 0,0,1,0,1,1),Nd.bind(void 0,0,1,0,1,2),Nd.bind(void 0,0,1,0,1,3),Nd.bind(void 0,0,1,1,0,0),Nd.bind(void 0,0,1,1,0,1),Nd.bind(void 0,0,1,1,0,2),Nd.bind(void 0,0,1,1,0,3),Nd.bind(void 0,0,1,1,1,0),Nd.bind(void 0,0,1,1,1,1),Nd.bind(void 0,0,1,1,1,2),Nd.bind(void 0,0,1,1,1,3),Nd.bind(void 0,1,0,0,0,0),Nd.bind(void 0,1,0,0,0,1),Nd.bind(void 0,1,0,0,0,2),Nd.bind(void 0,1,0,0,0,3),Nd.bind(void 0,1,0,0,1,0),Nd.bind(void 0,1,0,0,1,1),Nd.bind(void 0,1,0,0,1,2),Nd.bind(void 0,1,0,0,1,3),Nd.bind(void 0,1,0,1,0,0),Nd.bind(void 0,1,0,1,0,1),Nd.bind(void 0,1,0,1,0,2),Nd.bind(void 0,1,0,1,0,3),Nd.bind(void 0,1,0,1,1,0),Nd.bind(void 0,1,0,1,1,1),Nd.bind(void 0,1,0,1,1,2),Nd.bind(void 0,1,0,1,1,3),Nd.bind(void 0,1,1,0,0,0),Nd.bind(void 0,1,1,0,0,1),Nd.bind(void 0,1,1,0,0,2),Nd.bind(void 0,1,1,0,0,3),Nd.bind(void 0,1,1,0,1,0),Nd.bind(void 0,1,1,0,1,1),Nd.bind(void 0,1,1,0,1,2),Nd.bind(void 0,1,1,0,1,3),Nd.bind(void 0,1,1,1,0,0),Nd.bind(void 0,1,1,1,0,1),Nd.bind(void 0,1,1,1,0,2),Nd.bind(void 0,1,1,1,0,3),Nd.bind(void 0,1,1,1,1,0),Nd.bind(void 0,1,1,1,1,1),Nd.bind(void 0,1,1,1,1,2),Nd.bind(void 0,1,1,1,1,3)],Dd.prototype.setState=function(e,t){return this.state[e]=t,this.activeState={key:e,value:this.state[e]},this.activeState},Dd.prototype.getState=function(e){return this.state[e]||null},Hd.prototype.inboundIndex=function(e){return e>=0&&e<this.tokens.length},Hd.prototype.composeRUD=function(e){var t=this,n=e.map(function(e){return t[e[0]].apply(t,e.slice(1).concat(true))}),i=function(e){return"object"==typeof e&&e.hasOwnProperty("FAIL")};if(n.every(i))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:n.filter(i)};this.dispatch("composeRUD",[n.filter(function(e){return!i(e)})])},Hd.prototype.replaceRange=function(e,t,n,i){t=null!==t?t:this.tokens.length;var r=n.every(function(e){return e instanceof Dd});if(!isNaN(e)&&this.inboundIndex(e)&&r){var s=this.tokens.splice.apply(this.tokens,[e,t].concat(n));return i||this.dispatch("replaceToken",[e,t,n]),[s,n]}return{FAIL:"replaceRange: invalid tokens or startIndex."}},Hd.prototype.replaceToken=function(e,t,n){if(!isNaN(e)&&this.inboundIndex(e)&&t instanceof Dd){var i=this.tokens.splice(e,1,t);return n||this.dispatch("replaceToken",[e,t]),[i[0],t]}return{FAIL:"replaceToken: invalid token or index."}},Hd.prototype.removeRange=function(e,t,n){t=isNaN(t)?this.tokens.length:t;var i=this.tokens.splice(e,t);return n||this.dispatch("removeRange",[i,e,t]),i},Hd.prototype.removeToken=function(e,t){if(!isNaN(e)&&this.inboundIndex(e)){var n=this.tokens.splice(e,1);return t||this.dispatch("removeToken",[n,e]),n}return{FAIL:"removeToken: invalid token index."}},Hd.prototype.insertToken=function(e,t,n){return e.every(function(e){return e instanceof Dd})?(this.tokens.splice.apply(this.tokens,[t,0].concat(e)),n||this.dispatch("insertToken",[e,t]),e):{FAIL:"insertToken: invalid token(s)."}},Hd.prototype.registerModifier=function(e,t,n){this.events.newToken.subscribe(function(i,r){var s=[i,r],o=[i,r];if(null===t||!0===t.apply(this,s)){var a=n.apply(this,o);i.setState(e,a)}}),this.registeredModifiers.push(e)},Vd.prototype.subscribe=function(e){return"function"==typeof e?this.subscribers.push(e)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},Vd.prototype.unsubscribe=function(e){this.subscribers.splice(e,1)},Bd.prototype.setCurrentIndex=function(e){this.index=e,this.current=this.context[e],this.backtrack=this.context.slice(0,e),this.lookahead=this.context.slice(e+1)},Bd.prototype.get=function(e){switch(!0){case 0===e:return this.current;case e<0&&Math.abs(e)<=this.backtrack.length:return this.backtrack.slice(e)[0];case e>0&&e<=this.lookahead.length:return this.lookahead[e-1];default:return null}},Hd.prototype.rangeToText=function(e){if(e instanceof Rd)return this.getRangeTokens(e).map(function(e){return e.char}).join("")},Hd.prototype.getText=function(){return this.tokens.map(function(e){return e.char}).join("")},Hd.prototype.getContext=function(e){var t=this.registeredContexts[e];return t||null},Hd.prototype.on=function(e,t){var n=this.events[e];return n?n.subscribe(t):null},Hd.prototype.dispatch=function(e,t){var n=this,i=this.events[e];i instanceof Vd&&i.subscribers.forEach(function(e){e.apply(n,t||[])})},Hd.prototype.registerContextChecker=function(e,t,n){if(this.getContext(e))return{FAIL:"context name '"+e+"' is already registered."};if("function"!=typeof t)return{FAIL:"missing context start check."};if("function"!=typeof n)return{FAIL:"missing context end check."};var i=new Fd(e,t,n);return this.registeredContexts[e]=i,this.contextCheckers.push(i),i},Hd.prototype.getRangeTokens=function(e){var t=e.startIndex+e.endOffset;return[].concat(this.tokens.slice(e.startIndex,t))},Hd.prototype.getContextRanges=function(e){var t=this.getContext(e);return t?t.ranges:{FAIL:"context checker '"+e+"' is not registered."}},Hd.prototype.resetContextsRanges=function(){var e=this.registeredContexts;for(var t in e){if(e.hasOwnProperty(t))e[t].ranges=[]}},Hd.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var e=this.tokens.map(function(e){return e.char}),t=0;t<e.length;t++){var n=new Bd(e,t);this.runContextCheck(n)}this.dispatch("updateContextsRanges",[this.registeredContexts])},Hd.prototype.setEndOffset=function(e,t){var n=new Rd(this.getContext(t).openRange.startIndex,e,t),i=this.getContext(t).ranges;return n.rangeId=t+"."+i.length,i.push(n),this.getContext(t).openRange=null,n},Hd.prototype.runContextCheck=function(e){var t=this,n=e.index;this.contextCheckers.forEach(function(i){var r=i.contextName,s=t.getContext(r).openRange;if(!s&&i.checkStart(e)&&(s=new Rd(n,null,r),t.getContext(r).openRange=s,t.dispatch("contextStart",[r,n])),s&&i.checkEnd(e)){var o=n-s.startIndex+1,a=t.setEndOffset(o,r);t.dispatch("contextEnd",[r,a])}})},Hd.prototype.tokenize=function(e){this.tokens=[],this.resetContextsRanges();var t=Array.from(e);this.dispatch("start");for(var n=0;n<t.length;n++){var i=t[n],r=new Bd(t,n);this.dispatch("next",[r]),this.runContextCheck(r);var s=new Dd(i);this.tokens.push(s),this.dispatch("newToken",[s,r])}return this.dispatch("end",[this.tokens]),this.tokens},$d.prototype.getDefaultScriptFeaturesIndexes=function(){for(var e=this.font.tables.gsub.scripts,t=0;t<e.length;t++){var n=e[t];if("DFLT"===n.tag)return n.script.defaultLangSys.featureIndexes}return[]},$d.prototype.getScriptFeaturesIndexes=function(e){if(!this.font.tables.gsub)return[];if(!e)return this.getDefaultScriptFeaturesIndexes();for(var t=this.font.tables.gsub.scripts,n=0;n<t.length;n++){var i=t[n];if(i.tag===e&&i.script.defaultLangSys)return i.script.defaultLangSys.featureIndexes;var r=i.langSysRecords;if(r)for(var s=0;s<r.length;s++){var o=r[s];if(o.tag===e)return o.langSys.featureIndexes}}return this.getDefaultScriptFeaturesIndexes()},$d.prototype.mapTagsToFeatures=function(e,t){for(var n={},i=0;i<e.length;i++){var r=e[i].tag,s=e[i].feature;n[r]=s}this.features[t].tags=n},$d.prototype.getScriptFeatures=function(e){var t=this.features[e];if(this.features.hasOwnProperty(e))return t;var n=this.getScriptFeaturesIndexes(e);if(!n)return null;var i=this.font.tables.gsub;return t=n.map(function(e){return i.features[e]}),this.features[e]=t,this.mapTagsToFeatures(t,e),t},$d.prototype.getSubstitutionType=function(e,t){return e.lookupType.toString()+t.substFormat.toString()},$d.prototype.getLookupMethod=function(e,t){var n=this;switch(this.getSubstitutionType(e,t)){case"11":return function(e){return Kd.apply(n,[e,t])};case"12":return function(e){return Yd.apply(n,[e,t])};case"63":return function(e){return Jd.apply(n,[e,t])};case"41":return function(e){return Qd.apply(n,[e,t])};case"21":return function(e){return ep.apply(n,[e,t])};default:throw new Error("lookupType: "+e.lookupType+" - substFormat: "+t.substFormat+" is not yet supported")}},$d.prototype.lookupFeature=function(e){var t=e.contextParams,n=t.index,i=this.getFeature({tag:e.tag,script:e.script});if(!i)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+e.tag+"' for script '"+e.script+"'.");for(var r=this.getFeatureLookups(i),s=[].concat(t.context),o=0;o<r.length;o++)for(var a=r[o],l=this.getLookupSubtables(a),c=0;c<l.length;c++){var h=l[c],u=this.getSubstitutionType(a,h),d=this.getLookupMethod(a,h),p=void 0;switch(u){case"11":(p=d(t.current))&&s.splice(n,1,new Zd({id:11,tag:e.tag,substitution:p}));break;case"12":(p=d(t.current))&&s.splice(n,1,new Zd({id:12,tag:e.tag,substitution:p}));break;case"63":p=d(t),Array.isArray(p)&&p.length&&s.splice(n,1,new Zd({id:63,tag:e.tag,substitution:p}));break;case"41":(p=d(t))&&s.splice(n,1,new Zd({id:41,tag:e.tag,substitution:p}));break;case"21":(p=d(t.current))&&s.splice(n,1,new Zd({id:21,tag:e.tag,substitution:p}))}t=new Bd(s,n),Array.isArray(p)&&!p.length||(p=null)}return s.length?s:null},$d.prototype.supports=function(e){if(!e.script)return!1;this.getScriptFeatures(e.script);var t=this.features.hasOwnProperty(e.script);if(!e.tag)return t;var n=this.features[e.script].some(function(t){return t.tag===e.tag});return t&&n},$d.prototype.getLookupSubtables=function(e){return e.subtables||null},$d.prototype.getLookupByIndex=function(e){return this.font.tables.gsub.lookups[e]||null},$d.prototype.getFeatureLookups=function(e){return e.lookupListIndexes.map(this.getLookupByIndex.bind(this))},$d.prototype.getFeature=function(e){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(e.script)||this.getScriptFeatures(e.script);var t=this.features[e.script];return t?t.tags[e.tag]?this.features[e.script].tags[e.tag]:null:{FAIL:"No feature for script "+e.script}};var tp={startCheck:function(e){var t=e.current,n=e.get(-1);return null===n&&Ud(t)||!Ud(n)&&Ud(t)},endCheck:function(e){var t=e.get(1);return null===t||!Ud(t)}};var np={startCheck:function(e){var t=e.current,n=e.get(-1);return(Ud(t)||Wd(t))&&!Ud(n)},endCheck:function(e){var t=e.get(1);switch(!0){case null===t:return!0;case!Ud(t)&&!Wd(t):var n=/\s/.test(t);if(!n)return!0;if(n){var i;if(i=e.lookahead.some(function(e){return Ud(e)||Wd(e)}),!i)return!0}break;default:return!1}}};var ip={11:function(e,t,n){t[n].setState(e.tag,e.substitution)},12:function(e,t,n){t[n].setState(e.tag,e.substitution)},63:function(e,t,n){e.substitution.forEach(function(i,r){t[n+r].setState(e.tag,i)})},41:function(e,t,n){var i=t[n];i.setState(e.tag,e.substitution.ligGlyph);for(var r=e.substitution.components.length,s=0;s<r;s++)(i=t[n+s+1]).setState("deleted",!0)}};function rp(e,t,n){e instanceof Zd&&ip[e.id]&&ip[e.id](e,t,n)}function sp(e){var t=this,n="arab",i=this.featuresTags[n],r=this.tokenizer.getRangeTokens(e);if(1!==r.length){var s=new Bd(r.map(function(e){return e.getState("glyphIndex")}),0),o=new Bd(r.map(function(e){return e.char}),0);r.forEach(function(e,a){if(!Wd(e.char)){s.setCurrentIndex(a),o.setCurrentIndex(a);var l,c=0;switch(function(e){for(var t=[].concat(e.backtrack),n=t.length-1;n>=0;n--){var i=t[n],r=zd(i),s=Wd(i);if(!r&&!s)return!0;if(r)return!1}return!1}(o)&&(c|=1),function(e){if(zd(e.current))return!1;for(var t=0;t<e.lookahead.length;t++)if(!Wd(e.lookahead[t]))return!0;return!1}(o)&&(c|=2),c){case 1:l="fina";break;case 2:l="init";break;case 3:l="medi"}if(-1!==i.indexOf(l)){var h=t.query.lookupFeature({tag:l,script:n,contextParams:s});if(h instanceof Error)return console.info(h.message);h.forEach(function(e,t){e instanceof Zd&&(rp(e,r,t),s.context[t]=e.substitution)})}}})}}function op(e,t){return new Bd(e.map(function(e){return e.activeState.value}),0)}function ap(e){var t=this,n=this.tokenizer.getRangeTokens(e),i=op(n);i.context.forEach(function(e,r){i.setCurrentIndex(r);var s=t.query.lookupFeature({tag:"rlig",script:"arab",contextParams:i});s.length&&(s.forEach(function(e){return rp(e,n,r)}),i=op(n))})}var lp={startCheck:function(e){var t=e.current,n=e.get(-1);return null===n&&Gd(t)||!Gd(n)&&Gd(t)},endCheck:function(e){var t=e.get(1);return null===t||!Gd(t)}};function cp(e,t){return new Bd(e.map(function(e){return e.activeState.value}),0)}function hp(e){var t=this,n=this.tokenizer.getRangeTokens(e),i=cp(n);i.context.forEach(function(e,r){i.setCurrentIndex(r);var s=t.query.lookupFeature({tag:"liga",script:"latn",contextParams:i});s.length&&(s.forEach(function(e){return rp(e,n,r)}),i=cp(n))})}function up(e){this.baseDir=e||"ltr",this.tokenizer=new Hd,this.featuresTags={}}function dp(e){var t=this.contextChecks[e+"Check"];return this.tokenizer.registerContextChecker(e,t.startCheck,t.endCheck)}function pp(){return dp.call(this,"latinWord"),dp.call(this,"arabicWord"),dp.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function fp(){var e=this;this.tokenizer.getContextRanges("arabicSentence").forEach(function(t){var n=e.tokenizer.getRangeTokens(t);e.tokenizer.replaceRange(t.startIndex,t.endOffset,n.reverse())})}function mp(){if(-1===this.tokenizer.registeredModifiers.indexOf("glyphIndex"))throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function gp(){var e=this;this.featuresTags.hasOwnProperty("arab")&&(mp.call(this),this.tokenizer.getContextRanges("arabicWord").forEach(function(t){sp.call(e,t)}))}function vp(){var e=this,t="arab";this.featuresTags.hasOwnProperty(t)&&(-1!==this.featuresTags[t].indexOf("rlig")&&(mp.call(this),this.tokenizer.getContextRanges("arabicWord").forEach(function(t){ap.call(e,t)})))}function yp(){var e=this,t="latn";this.featuresTags.hasOwnProperty(t)&&(-1!==this.featuresTags[t].indexOf("liga")&&(mp.call(this),this.tokenizer.getContextRanges("latinWord").forEach(function(t){hp.call(e,t)})))}function bp(e){(e=e||{}).tables=e.tables||{},e.empty||(Bu(e.familyName,"When creating a new Font object, familyName is required."),Bu(e.styleName,"When creating a new Font object, styleName is required."),Bu(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Bu(e.ascender,"When creating a new Font object, ascender is required."),Bu(e.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||(e.familyName+e.styleName).replace(/\s/g,"")},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables=Object.assign(e.tables,{os2:Object.assign({usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR},e.tables.os2)})),this.supported=!0,this.glyphs=new Mh.GlyphSet(this,e.glyphs||[]),this.encoding=new xh(this),this.position=new Ou(this),this.substitution=new Nu(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:"truetype"===this.outlinesFormat?this._hinting=new Ku(this):void 0}})}function wp(e,t){var n=JSON.stringify(e),i=256;for(var r in t){var s=parseInt(r);if(s&&!(s<256)){if(JSON.stringify(t[r])===n)return s;i<=s&&(i=s+1)}}return t[i]=e,i}function xp(e,t,n){var i=wp(t.name,n);return[{name:"tag_"+e,type:"TAG",value:t.tag},{name:"minValue_"+e,type:"FIXED",value:t.minValue<<16},{name:"defaultValue_"+e,type:"FIXED",value:t.defaultValue<<16},{name:"maxValue_"+e,type:"FIXED",value:t.maxValue<<16},{name:"flags_"+e,type:"USHORT",value:0},{name:"nameID_"+e,type:"USHORT",value:i}]}function Cp(e,t,n){var i={},r=new fh.Parser(e,t);return i.tag=r.parseTag(),i.minValue=r.parseFixed(),i.defaultValue=r.parseFixed(),i.maxValue=r.parseFixed(),r.skip("uShort",1),i.name=n[r.parseUShort()]||{},i}function Sp(e,t,n,i){for(var r=[{name:"nameID_"+e,type:"USHORT",value:wp(t.name,i)},{name:"flags_"+e,type:"USHORT",value:0}],s=0;s<n.length;++s){var o=n[s].tag;r.push({name:"axis_"+e+" "+o,type:"FIXED",value:t.coordinates[o]<<16})}return r}function kp(e,t,n,i){var r={},s=new fh.Parser(e,t);r.name=i[s.parseUShort()]||{},s.skip("uShort",1),r.coordinates={};for(var o=0;o<n.length;++o)r.coordinates[n[o].tag]=s.parseFixed();return r}up.prototype.setText=function(e){this.text=e},up.prototype.contextChecks={latinWordCheck:lp,arabicWordCheck:tp,arabicSentenceCheck:np},up.prototype.registerFeatures=function(e,t){var n=this,i=t.filter(function(t){return n.query.supports({script:e,tag:t})});this.featuresTags.hasOwnProperty(e)?this.featuresTags[e]=this.featuresTags[e].concat(i):this.featuresTags[e]=i},up.prototype.applyFeatures=function(e,t){if(!e)throw new Error("No valid font was provided to apply features");this.query||(this.query=new $d(e));for(var n=0;n<t.length;n++){var i=t[n];this.query.supports({script:i.script})&&this.registerFeatures(i.script,i.tags)}},up.prototype.registerModifier=function(e,t,n){this.tokenizer.registerModifier(e,t,n)},up.prototype.checkContextReady=function(e){return!!this.tokenizer.getContext(e)},up.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(gp.call(this),vp.call(this)),this.checkContextReady("latinWord")&&yp.call(this),this.checkContextReady("arabicSentence")&&fp.call(this)},up.prototype.processText=function(e){this.text&&this.text===e||(this.setText(e),pp.call(this),this.applyFeaturesToContexts())},up.prototype.getBidiText=function(e){return this.processText(e),this.tokenizer.getText()},up.prototype.getTextGlyphs=function(e){this.processText(e);for(var t=[],n=0;n<this.tokenizer.tokens.length;n++){var i=this.tokenizer.tokens[n];if(!i.state.deleted){var r=i.activeState.value;t.push(Array.isArray(r)?r[0]:r)}}return t},bp.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},bp.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},bp.prototype.charToGlyph=function(e){var t=this.charToGlyphIndex(e),n=this.glyphs.get(t);return n||(n=this.glyphs.get(0)),n},bp.prototype.updateFeatures=function(e){return this.defaultRenderOptions.features.map(function(t){return"latn"===t.script?{script:"latn",tags:t.tags.filter(function(t){return e[t]})}:t})},bp.prototype.stringToGlyphs=function(e,t){var n=this,i=new up;i.registerModifier("glyphIndex",null,function(e){return n.charToGlyphIndex(e.char)});var r=t?this.updateFeatures(t.features):this.defaultRenderOptions.features;i.applyFeatures(this,r);for(var s=i.getTextGlyphs(e),o=s.length,a=new Array(o),l=this.glyphs.get(0),c=0;c<o;c+=1)a[c]=this.glyphs.get(s[c])||l;return a},bp.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},bp.prototype.nameToGlyph=function(e){var t=this.nameToGlyphIndex(e),n=this.glyphs.get(t);return n||(n=this.glyphs.get(0)),n},bp.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},bp.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var n=this.position.defaultKerningTables;return n?this.position.getKerningValue(n,e,t):this.kerningPairs[e+","+t]||0},bp.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]},bp.prototype.forEachGlyph=function(e,t,n,i,r,s){t=void 0!==t?t:0,n=void 0!==n?n:0,i=void 0!==i?i:72,r=Object.assign({},this.defaultRenderOptions,r);var o,a=1/this.unitsPerEm*i,l=this.stringToGlyphs(e,r);if(r.kerning){var c=r.script||this.position.getDefaultScriptName();o=this.position.getKerningTables(c,r.language)}for(var h=0;h<l.length;h+=1){var u=l[h];if(s.call(this,u,t,n,i,r),u.advanceWidth&&(t+=u.advanceWidth*a),r.kerning&&h<l.length-1)t+=(o?this.position.getKerningValue(o,u.index,l[h+1].index):this.getKerningValue(u,l[h+1]))*a;r.letterSpacing?t+=r.letterSpacing*i:r.tracking&&(t+=r.tracking/1e3*i)}return t},bp.prototype.getPath=function(e,t,n,i,r){var s=new Dc;return this.forEachGlyph(e,t,n,i,r,function(e,t,n,i){var o=e.getPath(t,n,i,r,this);s.extend(o)}),s},bp.prototype.getPaths=function(e,t,n,i,r){var s=[];return this.forEachGlyph(e,t,n,i,r,function(e,t,n,i){var o=e.getPath(t,n,i,r,this);s.push(o)}),s},bp.prototype.getAdvanceWidth=function(e,t,n){return this.forEachGlyph(e,0,0,t,n,function(){})},bp.prototype.draw=function(e,t,n,i,r,s){this.getPath(t,n,i,r,s).draw(e)},bp.prototype.drawPoints=function(e,t,n,i,r,s){this.forEachGlyph(t,n,i,r,s,function(t,n,i,r){t.drawPoints(e,n,i,r)})},bp.prototype.drawMetrics=function(e,t,n,i,r,s){this.forEachGlyph(t,n,i,r,s,function(t,n,i,r){t.drawMetrics(e,n,i,r)})},bp.prototype.getEnglishName=function(e){var t=this.names[e];if(t)return t.en},bp.prototype.validate=function(){var e=this;function t(t){var n=e.getEnglishName(t);n&&n.trim().length}t("fontFamily"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),this.unitsPerEm},bp.prototype.toTables=function(){return Tu.fontToTable(this)},bp.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},bp.prototype.toArrayBuffer=function(){for(var e=this.toTables().encode(),t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i<e.length;i++)n[i]=e[i];return t},bp.prototype.download=function(e){var t=this.getEnglishName("fontFamily"),n=this.getEnglishName("fontSubfamily");e=e||t.replace(/\s/g,"")+"-"+n+".otf";var i=this.toArrayBuffer();if("undefined"!=typeof window)if(window.URL=window.URL||window.webkitURL,window.URL){var r=new DataView(i),s=new Blob([r],{type:"font/opentype"}),o=document.createElement("a");o.href=window.URL.createObjectURL(s),o.download=e;var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!1),o.dispatchEvent(a)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var l=require("fs"),c=function(e){for(var t=new Buffer(e.byteLength),n=new Uint8Array(e),i=0;i<t.length;++i)t[i]=n[i];return t}(i);l.writeFileSync(e,c)}},bp.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},bp.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},bp.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var Lp={make:function(e,t){var n=new oh.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:e.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:e.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*e.axes.length}]);n.offsetToData=n.sizeOf();for(var i=0;i<e.axes.length;i++)n.fields=n.fields.concat(xp(i,e.axes[i],t));for(var r=0;r<e.instances.length;r++)n.fields=n.fields.concat(Sp(r,e.instances[r],e.axes,t));return n},parse:function(e,t,n){var i=new fh.Parser(e,t),r=i.parseULong();Bc.argument(65536===r,"Unsupported fvar table version.");var s=i.parseOffset16();i.skip("uShort",1);for(var o=i.parseUShort(),a=i.parseUShort(),l=i.parseUShort(),c=i.parseUShort(),h=[],u=0;u<o;u++)h.push(Cp(e,t+s+u*a,n));for(var d=[],p=t+s+o*a,f=0;f<l;f++)d.push(kp(e,p+f*c,h,n));return{axes:h,instances:d}}},Ep=function(){return{coverage:this.parsePointer(dh.coverage),attachPoints:this.parseList(dh.pointer(dh.uShortList))}},Pp=function(){var e=this.parseUShort();return Bc.argument(1===e||2===e||3===e,"Unsupported CaretValue table version."),1===e?{coordinate:this.parseShort()}:2===e?{pointindex:this.parseShort()}:3===e?{coordinate:this.parseShort()}:void 0},Tp=function(){return this.parseList(dh.pointer(Pp))},Ap=function(){return{coverage:this.parsePointer(dh.coverage),ligGlyphs:this.parseList(dh.pointer(Tp))}},Mp=function(){return this.parseUShort(),this.parseList(dh.pointer(dh.coverage))};var Ip={parse:function(e,t){var n=new dh(e,t=t||0),i=n.parseVersion(1);Bc.argument(1===i||1.2===i||1.3===i,"Unsupported GDEF table version.");var r={version:i,classDef:n.parsePointer(dh.classDef),attachList:n.parsePointer(Ep),ligCaretList:n.parsePointer(Ap),markAttachClassDef:n.parsePointer(dh.classDef)};return i>=1.2&&(r.markGlyphSets=n.parsePointer(Mp)),r}},_p=new Array(10);_p[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{posFormat:1,coverage:this.parsePointer(dh.coverage),value:this.parseValueRecord()}:2===t?{posFormat:2,coverage:this.parsePointer(dh.coverage),values:this.parseValueRecordList()}:void Bc.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},_p[2]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();Bc.assert(1===t||2===t,"0x"+e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var n=this.parsePointer(dh.coverage),i=this.parseUShort(),r=this.parseUShort();if(1===t)return{posFormat:t,coverage:n,valueFormat1:i,valueFormat2:r,pairSets:this.parseList(dh.pointer(dh.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(i),value2:this.parseValueRecord(r)}})))};if(2===t){var s=this.parsePointer(dh.classDef),o=this.parsePointer(dh.classDef),a=this.parseUShort(),l=this.parseUShort();return{posFormat:t,coverage:n,valueFormat1:i,valueFormat2:r,classDef1:s,classDef2:o,class1Count:a,class2Count:l,classRecords:this.parseList(a,dh.list(l,function(){return{value1:this.parseValueRecord(i),value2:this.parseValueRecord(r)}}))}}},_p[3]=function(){return{error:"GPOS Lookup 3 not supported"}},_p[4]=function(){return{error:"GPOS Lookup 4 not supported"}},_p[5]=function(){return{error:"GPOS Lookup 5 not supported"}},_p[6]=function(){return{error:"GPOS Lookup 6 not supported"}},_p[7]=function(){return{error:"GPOS Lookup 7 not supported"}},_p[8]=function(){return{error:"GPOS Lookup 8 not supported"}},_p[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var Op=new Array(10);var Np={parse:function(e,t){var n=new dh(e,t=t||0),i=n.parseVersion(1);return Bc.argument(1===i||1.1===i,"Unsupported GPOS table version "+i),1===i?{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(_p)}:{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(_p),variations:n.parseFeatureVariationsList()}},make:function(e){return new oh.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new oh.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new oh.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new oh.LookupList(e.lookups,Op)}])}};var Dp={parse:function(e,t){var n=new fh.Parser(e,t),i=n.parseUShort();if(0===i)return function(e){var t={};e.skip("uShort");var n=e.parseUShort();Bc.argument(0===n,"Unsupported kern sub-table version."),e.skip("uShort",2);var i=e.parseUShort();e.skip("uShort",3);for(var r=0;r<i;r+=1){var s=e.parseUShort(),o=e.parseUShort(),a=e.parseShort();t[s+","+o]=a}return t}(n);if(1===i)return function(e){var t={};e.skip("uShort"),e.parseULong()>1&&console.warn("Only the first kern subtable is supported."),e.skip("uLong");var n=255&e.parseUShort();if(e.skip("uShort"),0===n){var i=e.parseUShort();e.skip("uShort",3);for(var r=0;r<i;r+=1){var s=e.parseUShort(),o=e.parseUShort(),a=e.parseShort();t[s+","+o]=a}}return t}(n);throw new Error("Unsupported kern table version ("+i+").")}};var Rp={parse:function(e,t,n,i){for(var r=new fh.Parser(e,t),s=i?r.parseUShort:r.parseULong,o=[],a=0;a<n+1;a+=1){var l=s.call(r);i&&(l*=2),o.push(l)}return o}};function Fp(e,t){require("fs").readFile(e,function(e,n){if(e)return t(e.message);t(null,Fu(n))})}function Bp(e,t){var n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="arraybuffer",n.onload=function(){return n.response?t(null,n.response):t("Font could not be loaded: "+n.statusText)},n.onerror=function(){t("Font could not be loaded")},n.send()}function Vp(e,t){for(var n=[],i=12,r=0;r<t;r+=1){var s=fh.getTag(e,i),o=fh.getULong(e,i+4),a=fh.getULong(e,i+8),l=fh.getULong(e,i+12);n.push({tag:s,checksum:o,offset:a,length:l,compression:!1}),i+=16}return n}function jp(e,t){if("WOFF"===t.compression){var n=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),i=new Uint8Array(t.length);if(_c(n,i),i.byteLength!==t.length)throw new Error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length");return{data:new DataView(i.buffer,0),offset:0}}return{data:e,offset:t.offset}}function Hp(e,t){var n,i;t=null==t?{}:t;var r,s,o,a,l,c,h,u,d,p,f,m,g,v=new bp({empty:!0}),y=new DataView(e,0),b=[],w=fh.getTag(y,0);if(w===String.fromCharCode(0,1,0,0)||"true"===w||"typ1"===w)v.outlinesFormat="truetype",b=Vp(y,r=fh.getUShort(y,4));else if("OTTO"===w)v.outlinesFormat="cff",b=Vp(y,r=fh.getUShort(y,4));else{if("wOFF"!==w)throw new Error("Unsupported OpenType signature "+w);var x=fh.getTag(y,4);if(x===String.fromCharCode(0,1,0,0))v.outlinesFormat="truetype";else{if("OTTO"!==x)throw new Error("Unsupported OpenType flavor "+w);v.outlinesFormat="cff"}b=function(e,t){for(var n=[],i=44,r=0;r<t;r+=1){var s=fh.getTag(e,i),o=fh.getULong(e,i+4),a=fh.getULong(e,i+8),l=fh.getULong(e,i+12),c=void 0;c=a<l&&"WOFF",n.push({tag:s,offset:o,compression:c,compressedLength:a,length:l}),i+=20}return n}(y,r=fh.getUShort(y,12))}for(var C=0;C<r;C+=1){var S=b[C],k=void 0;switch(S.tag){case"cmap":k=jp(y,S),v.tables.cmap=gh.parse(k.data,k.offset),v.encoding=new Ch(v.tables.cmap);break;case"cvt ":k=jp(y,S),g=new fh.Parser(k.data,k.offset),v.tables.cvt=g.parseShortList(S.length/2);break;case"fvar":o=S;break;case"fpgm":k=jp(y,S),g=new fh.Parser(k.data,k.offset),v.tables.fpgm=g.parseByteList(S.length);break;case"head":k=jp(y,S),v.tables.head=Yh.parse(k.data,k.offset),v.unitsPerEm=v.tables.head.unitsPerEm,n=v.tables.head.indexToLocFormat;break;case"hhea":k=jp(y,S),v.tables.hhea=Xh.parse(k.data,k.offset),v.ascender=v.tables.hhea.ascender,v.descender=v.tables.hhea.descender,v.numberOfHMetrics=v.tables.hhea.numberOfHMetrics;break;case"hmtx":u=S;break;case"ltag":k=jp(y,S),i=Qh.parse(k.data,k.offset);break;case"maxp":k=jp(y,S),v.tables.maxp=eu.parse(k.data,k.offset),v.numGlyphs=v.tables.maxp.numGlyphs;break;case"name":f=S;break;case"OS/2":k=jp(y,S),v.tables.os2=mu.parse(k.data,k.offset);break;case"post":k=jp(y,S),v.tables.post=gu.parse(k.data,k.offset),v.glyphNames=new kh(v.tables.post);break;case"prep":k=jp(y,S),g=new fh.Parser(k.data,k.offset),v.tables.prep=g.parseByteList(S.length);break;case"glyf":a=S;break;case"loca":p=S;break;case"CFF ":s=S;break;case"kern":d=S;break;case"GDEF":l=S;break;case"GPOS":c=S;break;case"GSUB":h=S;break;case"meta":m=S}}var L=jp(y,f);if(v.tables.name=pu.parse(L.data,L.offset,i),v.names=v.tables.name,a&&p){var E=0===n,P=jp(y,p),T=Rp.parse(P.data,P.offset,v.numGlyphs,E),A=jp(y,a);v.glyphs=qu.parse(A.data,A.offset,T,v,t)}else{if(!s)throw new Error("Font doesn't contain TrueType or CFF outlines.");var M=jp(y,s);Kh.parse(M.data,M.offset,v,t)}var I=jp(y,u);if(Jh.parse(v,I.data,I.offset,v.numberOfHMetrics,v.numGlyphs,v.glyphs,t),Lh(v,t),d){var _=jp(y,d);v.kerningPairs=Dp.parse(_.data,_.offset)}else v.kerningPairs={};if(l){var O=jp(y,l);v.tables.gdef=Ip.parse(O.data,O.offset)}if(c){var N=jp(y,c);v.tables.gpos=Np.parse(N.data,N.offset),v.position.init()}if(h){var D=jp(y,h);v.tables.gsub=wu.parse(D.data,D.offset)}if(o){var R=jp(y,o);v.tables.fvar=Lp.parse(R.data,R.offset,v.names)}if(m){var F=jp(y,m);v.tables.meta=xu.parse(F.data,F.offset),v.metas=v.tables.meta}return v}function Up(e,t,n){n=null==n?{}:n;var i="undefined"==typeof window&&!n.isUrl?Fp:Bp;return new Promise(function(r,s){i(e,function(e,i){if(e){if(t)return t(e);s(e)}var o;try{o=Hp(i,n)}catch(a){if(t)return t(a,null);s(a)}if(t)return t(null,o);r(o)})})}var zp=Object.freeze({__proto__:null,Font:bp,Glyph:Ph,Path:Dc,BoundingBox:Nc,_parse:fh,parse:Hp,load:Up,loadSync:function(e,t){return Hp(Fu(require("fs").readFileSync(e)),t)}});const Wp={kerning:!0,features:{liga:!1,rlig:!1}};class Gp extends _r{constructor(e,t,n,i,r,s,o,a,l){super(l),this._family=e,this._variant=t,this.font=n,this.unitsPerEm=i,this.ascenderHeight=r,this.descenderHeight=s,this.isSingleLine=o,this.glyphAlternates=a}static fromOpenTypeFont(e,t,n){const i=e.unitsPerEm;return new Gp(e.getEnglishName("fontFamily"),e.getEnglishName("fontSubfamily"),e,i,e.ascender/i,e.descender/i,n.isSingleLine,n.glyphAlternates??{},t)}clone(){return new Gp(this._family,this._variant,this.font,this.unitsPerEm,this.ascenderHeight,this.descenderHeight,this.isSingleLine,this.glyphAlternates,this._symbolRetriever)}_glyphsFromTextString(e,t){const n=1/this.unitsPerEm,i=this.font,r=this.isSingleLine,s=[];let o,a;return function(e,t,n,i){let r=0;const s=Object.assign({},t.defaultRenderOptions,Wp,{features:{liga:"all"===i.ligatures,rlig:"all"===i.ligatures}}),o=1/t.unitsPerEm*1;let a,l,c=[];if(ks(e))c=t.stringToGlyphs(e,s);else for(const h of e)if(h instanceof Dt){const e=t.glyphs.glyphs[h.index];e?c.push(e):a||(a=`Glyph index ${h.index} not found in font.`)}else c.push(...t.stringToGlyphs(h,s));if(a&&Ft.consoleWarnGlobal(a),s.kerning){const e=s.script||t.position.getDefaultScriptName();l=t.position.getKerningTables(e,s.language)}for(let h=0;h<c.length;h+=1){const e=c[h];n.call(t,e,r,0,1,s),e.advanceWidth&&(r+=e.advanceWidth*o),s.kerning&&h<c.length-1&&(r+=(l?t.position.getKerningValue(l,e.index,c[h+1].index):t.getKerningValue(e,c[h+1]))*o),s.letterSpacing?r+=1*s.letterSpacing:s.tracking&&(r+=s.tracking/1e3*1)}}(e,this.font,(e,t,l,c,h)=>{const{index:u,name:d}=e;let p=n;e.advanceWidth&&(p=e.advanceWidth*n);const f=e.getPath(0,0,c,h,i);let m=wi.fromOpenTypePath(f);if(r)for(const n of m.paths){n.closed=!1;const{anchors:e}=n,t=e.shift();if(t){const n=e[e.length-1];t.position.equals(n.position)||e.push(t)}}else{let e=wi.booleanUnion([m],"winding");e.paths.length>=1&&(m=e)}0!==u||a||(a="Text is not supported by the selected font. Try searching in the font picker for the language of your text, for example Arabic or Japanese.");const g=new Ji(d||"",t,p,p,m);o&&(o.advanceX=g.x-o.x),o=g,s.push(g)},t),a&&Ft.consoleWarnGlobal(a),s}_hasGlyphAlternates(){for(let e in this.glyphAlternates)return!0;return!1}replacePatternsWithGlyphAlternates(e,t){if(e=new Ot(e),!t.wordConnect&&!t.wordStart&&!t.wordEnd)return e;const n=Object.values(this.glyphAlternates||{});if(Ls(t.wordStart)&&n.push(t.wordStart),Ls(t.wordConnect)&&n.push(t.wordConnect),Ls(t.wordEnd)&&n.push(t.wordEnd),0===n.length)return qp(this._family),e;const i="WordConnect",r="WordStart",s="WordEnd",o=[];t.wordConnect&&o.push(qs().namedCapture(i).nonWhitespaceChar.char(" ").end().assertAhead.anythingButChars(" ").end()),t.wordStart&&o.push(qs().anyOf.char(" ").startOfInput.end().namedCapture(r).nonWhitespaceChar.end()),t.wordEnd&&o.push(qs().namedCapture(s).nonWhitespaceChar.end().assertAhead.anyOf.char(" ").endOfInput.end().end());let a=qs().allowMultipleMatches.lineByLine.anyOf;for(const h of o)a=a.subexpression(h,{ignoreStartAndEnd:!1});a=a.end();const l=e.toString().matchAll(a.toRegex()),c=Array.from(l).reverse();if(0===c.length)return e;for(const h of c)if(h&&void 0!==h.index&&h.groups){if(h.groups[i]&&t.wordConnect&&(e=this._replaceMatchWithGlyphAlternate(e,h,t.wordConnect,h.index,0,h.index+2)),h.groups[r]&&t.wordStart){const n=h[0].length-1;e=this._replaceMatchWithGlyphAlternate(e,h,t.wordStart,h.index+n,n,h.index+n+1)}h.groups[s]&&t.wordEnd&&(e=this._replaceMatchWithGlyphAlternate(e,h,t.wordEnd,h.index,0,h.index+1))}return e}_replaceMatchWithGlyphAlternate(e,t,n,i,r,s){if("skip"===n)return e;let o=t[0].codePointAt(r);if(void 0===o)return e;const a=Ls(n)?n:this.glyphAlternates[n];if(!a)return qp(this._family,n),e;let l=$p(a,o);if(!l){const i=String.fromCodePoint(o),r=i.toLocaleLowerCase(),s=r.codePointAt(0);if(s!==o){if(o=s,void 0===o)return e;l=$p(a,o)}if(!l)return qp(this._family,n,t[0]),e;!function(e,t,n,i){const r=n?`${n} `:"";let s="";ks(i)&&(s=Zp.hasOwnProperty(i)?`${Zp[i]} `:`${i} `);const o=`The font ${r}does not have a ${s}variation for uppercase ${e} so a lowercase ${t} was substituted.`;Ft.consoleWarnGlobal(o)}(i,r,this._family,n)}const c=this._findGlyphReplacement(l,o);return void 0===c?(qp(this._family,n,t[0]),e):new Ot(e.slice(0,i),new Dt(c),e.slice(s))}_findGlyphReplacement(e,t){var n;if("glyphIndices"===e.type){const{rangeStart:n,glyphIndices:i}=e;return i[t-n]}if("alternateIndex"===e.type){const{alternateIndex:i}=e,r=String.fromCodePoint(t),s=this.font.charToGlyphIndex(r),o=null==(n=this.font.tables)?void 0:n.gsub;if(!o)return;let a=o.features.find(e=>"aalt"===e.tag);if(!a)return;const{lookupListIndexes:l}=a.feature,c=o.lookups.filter((e,t)=>l.indexOf(t)>-1);let h;for(const e of c){for(const t of e.subtables){const{coverage:e,alternateSets:n}=t;if(n){if(1===e.format){h=n[e.glyphs.indexOf(s)];break}if(2===e.format){const t=e.ranges.find(e=>e.start<=s&&s<=e.end);if(!t)continue;h=n[t.index+s-t.start];break}}}if(h)break}return null==h?void 0:h[i]}}}function $p(e,t){return e.find(e=>t>=e.rangeStart&&t<=e.rangeEnd)}const Zp={leftTail:"left tail",rightTail:"right tail",rightHeart:"heart"};function qp(e,t,n){const i=e?`${e} `:"",r=null==n?void 0:n.trim(),s=r?"a ":"";let o="",a="";ks(t)&&(Zp.hasOwnProperty(t)?o=`${Zp[t]} `:(o=`${t} `,a="Check the variation name"));const l=r?`variation for the character ${r}`:"variations";a||(a="Try another font"),Ft.consoleWarnGlobal(`The font ${i}does not have ${s}${o}${l}. ${a}.`)}class Kp extends _r{constructor(e,t,n,i,r){super(r),this._family="",this._variant="",this.glyphsArray=e,this.missingGlyph=e[0],this.unitsPerEm=t,this.ascenderHeight=n,this.descenderHeight=i,this.isSingleLine=!0,this.glyphsByUnicode={};for(const s of e)this.glyphsByUnicode[s.unicode]=s}static fromSVGDocument(e,t){const n=e.getElementsByTagName("font")[0],i=Yp(n,"horiz-adv-x",300),r=e.getElementsByTagName("font-face")[0],s=Yp(r,"units-per-em",1e3),o=Yp(r,"ascent",800)/s,a=Yp(r,"descent",-200)/s,l=e.getElementsByTagName("missing-glyph")[0],c={index:0,unicode:"",d:"",width:Yp(l,"horiz-adv-x",300)},h=e.getElementsByTagName("glyph"),u=Array.from(h).map((e,t)=>{const n=e.getAttribute("unicode");if(null===n)return c;return{index:t+1,unicode:n,d:e.getAttribute("d")??"",width:Yp(e,"horiz-adv-x",i)}});return u.unshift(c),new Kp(u,s,o,a,t)}clone(){return new Kp(this.glyphsArray,this.unitsPerEm,this.ascenderHeight,this.descenderHeight,this._symbolRetriever)}glyphForCharacter(e){return ks(e)&&this.glyphsByUnicode.hasOwnProperty(e)?this.glyphsByUnicode[e]:this.missingGlyph}_glyphsFromTextString(e,t){const n=1/this.unitsPerEm,i=[];let r,s=0;function o(e,t){!r&&t&&0===e.index&&(r=`Text ${t} is not supported by the selected font. Try searching in the font picker for the language of your text, for example Arabic or Japanese.`);const o=wi.fromSVGPathString(e.d),a=e.width*n,l=a;o.transform({scale:new It(n,-1*n)}),i.push(new Ji(ks(t)?t:"",s,a,l,o)),s+=l}const a=e instanceof Array?e:[e];for(const l of a)if(ks(l))for(const e of l){o(this.glyphForCharacter(e),e)}else if(l instanceof Dt){const e=this.glyphsArray[l.index];e?o(e):r||(r=`Glyph index ${l.index} not found in font.`)}return r&&Ft.consoleWarnGlobal(r),i}_hasGlyphAlternates(){return!1}replacePatternsWithGlyphAlternates(e,t){return Ft.consoleWarnGlobal("Glyph alternates are not yet available for SVG fonts."),e=e instanceof Ot?e:new Ot(e)}}const Yp=(e,t,n)=>{if(void 0===e)return n;const i=e.getAttribute(t);if(null===i)return n;const r=parseFloat(i);return isNaN(r)?n:r};const Xp="cuttle-font://",Jp=e=>{if(e.startsWith(Xp))return e.substring(14)};class Qp{constructor(e){this.message=e}}const ef=new class{constructor(){this.loadedFonts={},this.subscribers=new Set,this.getFontFromURL=e=>{const t=this.loadFont(new Tr(e));if("error"===t.status)throw new Error(t.error.message);if("ready"===t.status)return t.font}}loadFont(e){const t=kr(e.url);if(this.loadedFonts.hasOwnProperty(t)){const n=this.loadedFonts[t];if(void 0===n)return{status:"loading"};if(n instanceof Qp)return{status:"error",error:n};if(n instanceof _r)return{status:"ready",font:n.withRenderOptions(e.renderOptions)}}return this.loadedFonts[t]=void 0,nf(t).then(e=>{this.loadedFonts[t]=e,this.notifySubscribers()}).catch(e=>{console.warn("Font loading error:",e);let n=String(e);n.includes("OpenType")&&(n="Font reading error."),this.loadedFonts[t]=new Qp(n),this.notifySubscribers()}),{status:"loading"}}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}notifySubscribers(){for(let e of this.subscribers)e()}getNames(e){const t=this.loadFont(new Tr(e));if("ready"===t.status)return{family:t.font._family,variant:t.font._variant}}getLabel(e){const t=this.loadFont(new Tr(e));if("ready"===t.status){const{_family:e,_variant:n}=t.font;if(e&&n)return e+(n?` (${n})`:"")}}getError(e){const t=this.loadFont(new Tr(e));if("error"===t.status)return t.error.message}resetErrors(){Object.keys(this.loadedFonts).forEach(e=>{const t=this.loadedFonts[e];t&&t instanceof Qp&&delete this.loadedFonts[e]})}},tf=e=>oc.getEmojiSVGFromURL(e.source),nf=async e=>{const t=Jp(e);if(t){const n=await Oj.storage.getFontByHash(t);if(!n)return Promise.reject("Font not found.");if(!n.url)return Promise.reject((n.family||"Uploaded Font")+(n.variant?` (${n.variant})`:"")+": you do not have access to this font.");e=n.url}const n=mo(e);return"svg"===n?rf(e):"json"===n?of(e):sf(e)},rf=async e=>{const t=await Is(e),n=await t.text(),i=(new DOMParser).parseFromString(n,"image/svg+xml");return Kp.fromSVGDocument(i,tf)},sf=async e=>{const t=await Up(e);return Gp.fromOpenTypeFont(t,tf,{isSingleLine:!1})},of=async e=>{const t=await Is(e),{payload:{type:n,isSingleLine:i,glyphAlternates:r,encryptedData:s}}=await t.json(),o=await Ds(s).arrayBuffer(),a=await async function(e,t){let n=new Uint8Array(e);const i=(new TextEncoder).encode(t),r=n.slice(8,16),s=await window.crypto.subtle.importKey("raw",i,{name:"PBKDF2"},!1,["deriveBits"]).catch(function(e){console.error(e)});Ps(s);const o=await window.crypto.subtle.deriveBits({name:"PBKDF2",salt:r,iterations:1e4,hash:"SHA-256"},s,384).catch(function(e){console.error(e)});Ps(o);const a=new Uint8Array(o),l=a.slice(0,32),c=a.slice(32);n=n.slice(16);const h=await window.crypto.subtle.importKey("raw",l,{name:"AES-CBC",length:256},!1,["decrypt"]).catch(function(e){console.error(e)});Ps(h);const u=await window.crypto.subtle.decrypt({name:"AES-CBC",iv:c},h,n).catch(function(e){console.error(e)});return Ps(u),u}(o,"Cuttle's font licenses allow you to use these fonts within our app, but not to download them. Thanks for understanding.");if("image/svg+xml"===n)throw new Error("SVG fonts not supported yet.");const l=Hp(a);return Gp.fromOpenTypeFont(l,tf,{isSingleLine:i,glyphAlternates:r})};class af{constructor(e){this.data={},this.subscribers=new Set,this.parent=e}get(e){let t;return t=this.data.hasOwnProperty(e)?this.data[e]:this.parent?this.parent.get(e):void 0,this.subscribers.forEach(n=>n("get",e,t)),t}has(e){return!!this.data.hasOwnProperty(e)||!!this.parent&&this.parent.has(e)}peek(e){return this.data.hasOwnProperty(e)?this.data[e]:this.parent?this.parent.peek(e):void 0}set(e,t){return this.data[e]=t,this.subscribers.forEach(n=>n("set",e,t)),this}setAll(e){for(let t of Object.keys(e))this.set(t,e[t]);return this}peekAll(){var e;return{...null==(e=this.parent)?void 0:e.peekAll(),...this.data}}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}}const lf={sub:Ka((e,t)=>e-t),mul:Ka((e,t)=>e*t),div:Ka((e,t)=>e/t),mod:Ka((e,t)=>e%t),add:(e,t)=>e instanceof It&&t instanceof It?new It(e.x+t.x,e.y+t.y):e instanceof It&&Ks(t)?new It(e.x+t,e.y+t):Ks(e)&&t instanceof It?new It(e+t.x,e+t.y):Ks(e)&&Ks(t)?e+t:e instanceof Ot||t instanceof Ot?new Ot(e,t):Wr(e)+Wr(t),negate:e=>e instanceof It?e.clone().negate():-e,doubleEquals:(e,t)=>e instanceof It&&t instanceof It||e instanceof Ot&&(t instanceof Ot||ks(t))?e.equals(t):t instanceof Ot&&(e instanceof Ot||ks(e))?t.equals(e):e==t,tripleEquals:(e,t)=>e instanceof It&&t instanceof It||e instanceof Ot&&(t instanceof Ot||ks(t))?e.equals(t):t instanceof Ot&&(e instanceof Ot||ks(e))?t.equals(e):e===t,doubleNotEquals:(e,t)=>e instanceof It&&t instanceof It||e instanceof Ot&&(t instanceof Ot||ks(t))?!e.equals(t):t instanceof Ot&&(e instanceof Ot||ks(e))?!t.equals(e):e!=t,tripleNotEquals:(e,t)=>e instanceof It&&t instanceof It||e instanceof Ot&&(t instanceof Ot||ks(t))?!e.equals(t):t instanceof Ot&&(e instanceof Ot||ks(e))?!t.equals(e):e!==t},cf={};for(let os of Object.getOwnPropertyNames(Math))cf[os]=Math[os];const hf={};for(let os of Object.getOwnPropertyNames(JSON))hf[os]=JSON[os];const uf={...cf,...Ze,...Mt,..._i,...pl,...wt,...Dl,Geometry:Dn,Graphic:Hn,convertUnits:Rl,pairs:ns,range:ts,toString:Wr,getFontFromURL:ef.getFontFromURL,getImageFromURL:ql.getImageFromURL,getEmojiSVGFromURL:oc.getEmojiSVGFromURL,operatorOverloads:lf,console:window.console,performance:{now:()=>performance.now()},Math:cf,JSON:hf,NaN:NaN,Infinity:1/0,isNaN:isNaN,isFinite:isFinite,parseInt:parseInt,parseFloat:parseFloat,decodeURI:decodeURI,decodeURIComponent:decodeURIComponent,encodeURI:encodeURI,encodeURIComponent:encodeURIComponent,escape:escape,unescape:unescape,Object:Object,Function:Function,String:String,Boolean:Boolean,Number:Number,Date:Date,RegExp:RegExp,Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError,Array:Array,ArrayBuffer:ArrayBuffer,DataView:DataView,Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,Set:Set,WeakSet:WeakSet,Map:Map,WeakMap:WeakMap},df=(new af).setAll(uf),pf=Object.keys(uf);pf.push("cuttle","console","toProjectUnits");const ff=["svg","cuttle.svg","pdf","png","dxf","stl","3mf"],mf=e=>"none"===e||"glowforge"===e||"cricut"===e,gf=e=>(e=e.replace(/[^$_a-zA-Z0-9]/g,""),/[0-9]/.test(e[0])&&(e="_"+e),e),vf=(e,t)=>{let n=e;const i=e.lastIndexOf(".");if(i>0){const t=e.slice(i+1);ff.includes(t)&&(n=n.slice(0,i))}return n=n.replace(/\n+/g," ").replace(/[^ ._\-a-zA-Z0-9]/g,""),n=n.replace(/^\./,""),n=n.trim(),n=n.slice(0,255-t.length),n+t},yf=e=>gf(e).replace(/([a-z])([A-Z])/g,"$1 $2").split(/[_\s]+/).filter(e=>e.length>0).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "),bf="cuttleDeviceStorage";const wf=class e{constructor(){this.realSizeCalibrations={},this.scrollBehavior="pan",this.pointerInitShown=!1,this.showAdminFeatures=!1,this.rightSidebarWidth=500,this.rightSidebarSplit=.333,this.projectUnits="in",this.gridSnappingEnabled=!1,this.geometrySnappingEnabled=!0,this.svgPostprocess="none";try{const n=localStorage.getItem(bf);if(null===n)throw new Error("First load or local storage item not found.");const i=JSON.parse(n);if(!Js(i))throw new Error("Device storage parse failed.");let{version:r}=i;if("number"!=typeof r)throw new Error("Device storage is missing version.");0===r&&(r=1);const{rightSidebarWidth:s,rightSidebarSplit:o,realSizeCalibrations:a,scrollBehavior:l,projectUnits:c,hairlineStrokeWidth:h,pointerInitShown:u,showAdminFeatures:d,gridSnappingEnabled:p,geometrySnappingEnabled:f,svgPostprocess:m}=i;Ks(s)&&(this.rightSidebarWidth=s),Ks(o)&&(this.rightSidebarSplit=o),"object"==typeof(t=a)&&null!==t&&Object.entries(t).every(([e,t])=>"string"==typeof e&&"number"==typeof t)&&(this.realSizeCalibrations=a),"string"!=typeof(e=l)||"pan"!==e&&"zoom"!==e||(this.scrollBehavior=l),Yr(c)&&(this.projectUnits=c),Qs(u)&&(this.pointerInitShown=u),Qs(d)&&(this.showAdminFeatures=d),Qs(p)&&(this.gridSnappingEnabled=p),Qs(f)&&(this.geometrySnappingEnabled=f),mf(m)&&(this.svgPostprocess=m)}catch(n){console.warn(n,"Continue with defaults.")}var e,t;document.addEventListener("visibilitychange",()=>{document.hidden&&localStorage.setItem(bf,JSON.stringify(this.toJSON()))})}toJSON(){return{version:e.version,...this}}currentScreenKey(){const{width:e,height:t}=window.screen;return`${e}x${t}@${window.devicePixelRatio||1}`}currentScreenPPI(){return this.realSizeCalibrations[this.currentScreenKey()]}setCurrentScreenPPI(e){this.realSizeCalibrations[this.currentScreenKey()]=e}};wf.version=1;const xf=new wf,Cf=e=>"builtin"===e.type?e.definition.name:e.name,Sf=e=>{const{name:t,unified:n,unicode:i}=e;return{type:"emoji",name:t,emoji:i,unicodeId:n}};var kf=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],Lf=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],Ef="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Pf={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},Tf="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Af={5:Tf,"5module":Tf+" export import",6:Tf+" const class extends export import super"},Mf=/^in(stanceof)?$/,If=new RegExp("["+Ef+"]"),_f=new RegExp("["+Ef+"-----------------------------------------------------------------------------------------------------------------------------------------------------]");function Of(e,t){for(var n=65536,i=0;i<t.length;i+=2){if((n+=t[i])>e)return!1;if((n+=t[i+1])>=e)return!0}return!1}function Nf(e,t){return e<65?36===e:e<91||(e<97?95===e:e<123||(e<=65535?e>=170&&If.test(String.fromCharCode(e)):!1!==t&&Of(e,Lf)))}function Df(e,t){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||(e<=65535?e>=170&&_f.test(String.fromCharCode(e)):!1!==t&&(Of(e,Lf)||Of(e,kf)))))}var Rf=function(e,t){void 0===t&&(t={}),this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop||null,this.updateContext=null};function Ff(e,t){return new Rf(e,{beforeExpr:!0,binop:t})}var Bf={beforeExpr:!0},Vf={startsExpr:!0},jf={};function Hf(e,t){return void 0===t&&(t={}),t.keyword=e,jf[e]=new Rf(e,t)}var Uf={num:new Rf("num",Vf),regexp:new Rf("regexp",Vf),string:new Rf("string",Vf),name:new Rf("name",Vf),privateId:new Rf("privateId",Vf),eof:new Rf("eof"),bracketL:new Rf("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Rf("]"),braceL:new Rf("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Rf("}"),parenL:new Rf("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Rf(")"),comma:new Rf(",",Bf),semi:new Rf(";",Bf),colon:new Rf(":",Bf),dot:new Rf("."),question:new Rf("?",Bf),questionDot:new Rf("?."),arrow:new Rf("=>",Bf),template:new Rf("template"),invalidTemplate:new Rf("invalidTemplate"),ellipsis:new Rf("...",Bf),backQuote:new Rf("`",Vf),dollarBraceL:new Rf("${",{beforeExpr:!0,startsExpr:!0}),eq:new Rf("=",{beforeExpr:!0,isAssign:!0}),assign:new Rf("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Rf("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Rf("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Ff("||",1),logicalAND:Ff("&&",2),bitwiseOR:Ff("|",3),bitwiseXOR:Ff("^",4),bitwiseAND:Ff("&",5),equality:Ff("==/!=/===/!==",6),relational:Ff("</>/<=/>=",7),bitShift:Ff("<</>>/>>>",8),plusMin:new Rf("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Ff("%",10),star:Ff("*",10),slash:Ff("/",10),starstar:new Rf("**",{beforeExpr:!0}),coalesce:Ff("??",1),_break:Hf("break"),_case:Hf("case",Bf),_catch:Hf("catch"),_continue:Hf("continue"),_debugger:Hf("debugger"),_default:Hf("default",Bf),_do:Hf("do",{isLoop:!0,beforeExpr:!0}),_else:Hf("else",Bf),_finally:Hf("finally"),_for:Hf("for",{isLoop:!0}),_function:Hf("function",Vf),_if:Hf("if"),_return:Hf("return",Bf),_switch:Hf("switch"),_throw:Hf("throw",Bf),_try:Hf("try"),_var:Hf("var"),_const:Hf("const"),_while:Hf("while",{isLoop:!0}),_with:Hf("with"),_new:Hf("new",{beforeExpr:!0,startsExpr:!0}),_this:Hf("this",Vf),_super:Hf("super",Vf),_class:Hf("class",Vf),_extends:Hf("extends",Bf),_export:Hf("export"),_import:Hf("import",Vf),_null:Hf("null",Vf),_true:Hf("true",Vf),_false:Hf("false",Vf),_in:Hf("in",{beforeExpr:!0,binop:7}),_instanceof:Hf("instanceof",{beforeExpr:!0,binop:7}),_typeof:Hf("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Hf("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Hf("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},zf=/\r\n?|\n|\u2028|\u2029/,Wf=new RegExp(zf.source,"g");function Gf(e){return 10===e||13===e||8232===e||8233===e}function $f(e,t,n){void 0===n&&(n=e.length);for(var i=t;i<n;i++){var r=e.charCodeAt(i);if(Gf(r))return i<n-1&&13===r&&10===e.charCodeAt(i+1)?i+2:i+1}return-1}var Zf=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,qf=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Kf=Object.prototype,Yf=Kf.hasOwnProperty,Xf=Kf.toString,Jf=Object.hasOwn||function(e,t){return Yf.call(e,t)},Qf=Array.isArray||function(e){return"[object Array]"===Xf.call(e)},em=Object.create(null);function tm(e){return em[e]||(em[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function nm(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}var im=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,rm=function(e,t){this.line=e,this.column=t};rm.prototype.offset=function(e){return new rm(this.line,this.column+e)};var sm=function(e,t,n){this.start=t,this.end=n,null!==e.sourceFile&&(this.source=e.sourceFile)};function om(e,t){for(var n=1,i=0;;){var r=$f(e,i,t);if(r<0)return new rm(n,t-i);++n,i=r}}var am={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},lm=!1;function cm(e){var t={};for(var n in am)t[n]=e&&Jf(e,n)?e[n]:am[n];if("latest"===t.ecmaVersion?t.ecmaVersion=1e8:null==t.ecmaVersion?(!lm&&"object"==typeof console&&console.warn&&(lm=!0,console.warn("Since Acorn 8.0.0, options.ecmaVersion is required.\nDefaulting to 2020, but this will stop working in the future.")),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),null==t.allowReserved&&(t.allowReserved=t.ecmaVersion<5),e&&null!=e.allowHashBang||(t.allowHashBang=t.ecmaVersion>=14),Qf(t.onToken)){var i=t.onToken;t.onToken=function(e){return i.push(e)}}return Qf(t.onComment)&&(t.onComment=function(e,t){return function(n,i,r,s,o,a){var l={type:n?"Block":"Line",value:i,start:r,end:s};e.locations&&(l.loc=new sm(this,o,a)),e.ranges&&(l.range=[r,s]),t.push(l)}}(t,t.onComment)),t}var hm=256,um=259;function dm(e,t){return 2|(e?4:0)|(t?8:0)}var pm=function(e,t,n){this.options=e=cm(e),this.sourceFile=e.sourceFile,this.keywords=tm(Af[e.ecmaVersion>=6?6:"module"===e.sourceType?"5module":5]);var i="";!0!==e.allowReserved&&(i=Pf[e.ecmaVersion>=6?6:5===e.ecmaVersion?5:3],"module"===e.sourceType&&(i+=" await")),this.reservedWords=tm(i);var r=(i?i+" ":"")+Pf.strict;this.reservedWordsStrict=tm(r),this.reservedWordsStrictBind=tm(r+" "+Pf.strictBind),this.input=String(t),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(zf).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=Uf.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===e.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),0===this.pos&&e.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null,this.privateNameStack=[]},fm={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};pm.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)},fm.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},fm.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},fm.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},fm.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e].flags;if(768&t)return!1;if(2&t)return(4&t)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},fm.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0||this.options.allowSuperOutsideMethod},fm.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},fm.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},fm.allowNewDotTarget.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e].flags;if(768&t||2&t&&!(16&t))return!0}return!1},fm.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&hm)>0},pm.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var n=this,i=0;i<e.length;i++)n=e[i](n);return n},pm.parse=function(e,t){return new this(t,e).parse()},pm.parseExpressionAt=function(e,t,n){var i=new this(n,e,t);return i.nextToken(),i.parseExpression()},pm.tokenizer=function(e,t){return new this(t,e)},Object.defineProperties(pm.prototype,fm);var mm=pm.prototype,gm=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;mm.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){qf.lastIndex=e,e+=qf.exec(this.input)[0].length;var t=gm.exec(this.input.slice(e));if(!t)return!1;if("use strict"===(t[1]||t[2])){qf.lastIndex=e+t[0].length;var n=qf.exec(this.input),i=n.index+n[0].length,r=this.input.charAt(i);return";"===r||"}"===r||zf.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||"!"===r&&"="===this.input.charAt(i+1))}e+=t[0].length,qf.lastIndex=e,e+=qf.exec(this.input)[0].length,";"===this.input[e]&&e++}},mm.eat=function(e){return this.type===e&&(this.next(),!0)},mm.isContextual=function(e){return this.type===Uf.name&&this.value===e&&!this.containsEsc},mm.eatContextual=function(e){return!!this.isContextual(e)&&(this.next(),!0)},mm.expectContextual=function(e){this.eatContextual(e)||this.unexpected()},mm.canInsertSemicolon=function(){return this.type===Uf.eof||this.type===Uf.braceR||zf.test(this.input.slice(this.lastTokEnd,this.start))},mm.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},mm.semicolon=function(){this.eat(Uf.semi)||this.insertSemicolon()||this.unexpected()},mm.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0},mm.expect=function(e){this.eat(e)||this.unexpected()},mm.unexpected=function(e){this.raise(null!=e?e:this.start,"Unexpected token")};var vm=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};mm.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var n=t?e.parenthesizedAssign:e.parenthesizedBind;n>-1&&this.raiseRecoverable(n,t?"Assigning to rvalue":"Parenthesized pattern")}},mm.checkExpressionErrors=function(e,t){if(!e)return!1;var n=e.shorthandAssign,i=e.doubleProto;if(!t)return n>=0||i>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")},mm.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},mm.isSimpleAssignTarget=function(e){return"ParenthesizedExpression"===e.type?this.isSimpleAssignTarget(e.expression):"Identifier"===e.type||"MemberExpression"===e.type};var ym=pm.prototype;ym.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==Uf.eof;){var n=this.parseStatement(null,!0,t);e.body.push(n)}if(this.inModule)for(var i=0,r=Object.keys(this.undefinedExports);i<r.length;i+=1){var s=r[i];this.raiseRecoverable(this.undefinedExports[s].start,"Export '"+s+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var bm={kind:"loop"},wm={kind:"switch"};ym.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;qf.lastIndex=this.pos;var t=qf.exec(this.input),n=this.pos+t[0].length,i=this.input.charCodeAt(n);if(91===i||92===i)return!0;if(e)return!1;if(123===i||i>55295&&i<56320)return!0;if(Nf(i,!0)){for(var r=n+1;Df(i=this.input.charCodeAt(r),!0);)++r;if(92===i||i>55295&&i<56320)return!0;var s=this.input.slice(n,r);if(!Mf.test(s))return!0}return!1},ym.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;qf.lastIndex=this.pos;var e,t=qf.exec(this.input),n=this.pos+t[0].length;return!(zf.test(this.input.slice(this.pos,n))||"function"!==this.input.slice(n,n+8)||n+8!==this.input.length&&(Df(e=this.input.charCodeAt(n+8))||e>55295&&e<56320))},ym.isUsingKeyword=function(e,t){if(this.options.ecmaVersion<17||!this.isContextual(e?"await":"using"))return!1;qf.lastIndex=this.pos;var n=qf.exec(this.input),i=this.pos+n[0].length;if(zf.test(this.input.slice(this.pos,i)))return!1;if(e){var r,s=i+5;if("using"!==this.input.slice(i,s)||s===this.input.length||Df(r=this.input.charCodeAt(s))||r>55295&&r<56320)return!1;qf.lastIndex=s;var o=qf.exec(this.input);if(o&&zf.test(this.input.slice(s,s+o[0].length)))return!1}if(t){var a,l=i+2;if(!("of"!==this.input.slice(i,l)||l!==this.input.length&&(Df(a=this.input.charCodeAt(l))||a>55295&&a<56320)))return!1}var c=this.input.charCodeAt(i);return Nf(c,!0)||92===c},ym.isAwaitUsing=function(e){return this.isUsingKeyword(!0,e)},ym.isUsing=function(e){return this.isUsingKeyword(!1,e)},ym.parseStatement=function(e,t,n){var i,r=this.type,s=this.startNode();switch(this.isLet(e)&&(r=Uf._var,i="let"),r){case Uf._break:case Uf._continue:return this.parseBreakContinueStatement(s,r.keyword);case Uf._debugger:return this.parseDebuggerStatement(s);case Uf._do:return this.parseDoStatement(s);case Uf._for:return this.parseForStatement(s);case Uf._function:return e&&(this.strict||"if"!==e&&"label"!==e)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!e);case Uf._class:return e&&this.unexpected(),this.parseClass(s,!0);case Uf._if:return this.parseIfStatement(s);case Uf._return:return this.parseReturnStatement(s);case Uf._switch:return this.parseSwitchStatement(s);case Uf._throw:return this.parseThrowStatement(s);case Uf._try:return this.parseTryStatement(s);case Uf._const:case Uf._var:return i=i||this.value,e&&"var"!==i&&this.unexpected(),this.parseVarStatement(s,i);case Uf._while:return this.parseWhileStatement(s);case Uf._with:return this.parseWithStatement(s);case Uf.braceL:return this.parseBlock(!0,s);case Uf.semi:return this.parseEmptyStatement(s);case Uf._export:case Uf._import:if(this.options.ecmaVersion>10&&r===Uf._import){qf.lastIndex=this.pos;var o=qf.exec(this.input),a=this.pos+o[0].length,l=this.input.charCodeAt(a);if(40===l||46===l)return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),r===Uf._import?this.parseImport(s):this.parseExport(s,n);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!e);var c=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(c)return t&&"script"===this.options.sourceType&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),"await using"===c&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(s,!1,c),this.semicolon(),this.finishNode(s,"VariableDeclaration");var h=this.value,u=this.parseExpression();return r===Uf.name&&"Identifier"===u.type&&this.eat(Uf.colon)?this.parseLabeledStatement(s,h,u,e):this.parseExpressionStatement(s,u)}},ym.parseBreakContinueStatement=function(e,t){var n="break"===t;this.next(),this.eat(Uf.semi)||this.insertSemicolon()?e.label=null:this.type!==Uf.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var r=this.labels[i];if(null==e.label||r.name===e.label.name){if(null!=r.kind&&(n||"loop"===r.kind))break;if(e.label&&n)break}}return i===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,n?"BreakStatement":"ContinueStatement")},ym.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")},ym.parseDoStatement=function(e){return this.next(),this.labels.push(bm),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(Uf._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(Uf.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")},ym.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(bm),this.enterScope(0),this.expect(Uf.parenL),this.type===Uf.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var n=this.isLet();if(this.type===Uf._var||this.type===Uf._const||n){var i=this.startNode(),r=n?"let":this.value;return this.next(),this.parseVar(i,!0,r),this.finishNode(i,"VariableDeclaration"),this.parseForAfterInit(e,i,t)}var s=this.isContextual("let"),o=!1,a=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(a){var l=this.startNode();return this.next(),"await using"===a&&this.next(),this.parseVar(l,!0,a),this.finishNode(l,"VariableDeclaration"),this.parseForAfterInit(e,l,t)}var c=this.containsEsc,h=new vm,u=this.start,d=t>-1?this.parseExprSubscripts(h,"await"):this.parseExpression(!0,h);return this.type===Uf._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===Uf._in&&this.unexpected(t),e.await=!0):o&&this.options.ecmaVersion>=8&&(d.start!==u||c||"Identifier"!==d.type||"async"!==d.name?this.options.ecmaVersion>=9&&(e.await=!1):this.unexpected()),s&&o&&this.raise(d.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(d,!1,h),this.checkLValPattern(d),this.parseForIn(e,d)):(this.checkExpressionErrors(h,!0),t>-1&&this.unexpected(t),this.parseFor(e,d))},ym.parseForAfterInit=function(e,t,n){return(this.type===Uf._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===t.declarations.length?(this.options.ecmaVersion>=9&&(this.type===Uf._in?n>-1&&this.unexpected(n):e.await=n>-1),this.parseForIn(e,t)):(n>-1&&this.unexpected(n),this.parseFor(e,t))},ym.parseFunctionStatement=function(e,t,n){return this.next(),this.parseFunction(e,Cm|(n?0:Sm),!1,t)},ym.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(Uf._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")},ym.parseReturnStatement=function(e){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(Uf.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")},ym.parseSwitchStatement=function(e){var t;this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(Uf.braceL),this.labels.push(wm),this.enterScope(0);for(var n=!1;this.type!==Uf.braceR;)if(this.type===Uf._case||this.type===Uf._default){var i=this.type===Uf._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),i?t.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,t.test=null),this.expect(Uf.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")},ym.parseThrowStatement=function(e){return this.next(),zf.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var xm=[];ym.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t="Identifier"===e.type;return this.enterScope(t?32:0),this.checkLValPattern(e,t?4:2),this.expect(Uf.parenR),e},ym.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===Uf._catch){var t=this.startNode();this.next(),this.eat(Uf.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(Uf._finally)?this.parseBlock():null,e.handler||e.finalizer||this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")},ym.parseVarStatement=function(e,t,n){return this.next(),this.parseVar(e,!1,t,n),this.semicolon(),this.finishNode(e,"VariableDeclaration")},ym.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(bm),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")},ym.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")},ym.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")},ym.parseLabeledStatement=function(e,t,n,i){for(var r=0,s=this.labels;r<s.length;r+=1){s[r].name===t&&this.raise(n.start,"Label '"+t+"' is already declared")}for(var o=this.type.isLoop?"loop":this.type===Uf._switch?"switch":null,a=this.labels.length-1;a>=0;a--){var l=this.labels[a];if(l.statementStart!==e.start)break;l.statementStart=this.start,l.kind=o}return this.labels.push({name:t,kind:o,statementStart:this.start}),e.body=this.parseStatement(i?-1===i.indexOf("label")?i+"label":i:"label"),this.labels.pop(),e.label=n,this.finishNode(e,"LabeledStatement")},ym.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")},ym.parseBlock=function(e,t,n){for(void 0===e&&(e=!0),void 0===t&&(t=this.startNode()),t.body=[],this.expect(Uf.braceL),e&&this.enterScope(0);this.type!==Uf.braceR;){var i=this.parseStatement(null);t.body.push(i)}return n&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")},ym.parseFor=function(e,t){return e.init=t,this.expect(Uf.semi),e.test=this.type===Uf.semi?null:this.parseExpression(),this.expect(Uf.semi),e.update=this.type===Uf.parenR?null:this.parseExpression(),this.expect(Uf.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")},ym.parseForIn=function(e,t){var n=this.type===Uf._in;return this.next(),"VariableDeclaration"===t.type&&null!=t.declarations[0].init&&(!n||this.options.ecmaVersion<8||this.strict||"var"!==t.kind||"Identifier"!==t.declarations[0].id.type)&&this.raise(t.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(Uf.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,n?"ForInStatement":"ForOfStatement")},ym.parseVar=function(e,t,n,i){for(e.declarations=[],e.kind=n;;){var r=this.startNode();if(this.parseVarId(r,n),this.eat(Uf.eq)?r.init=this.parseMaybeAssign(t):i||"const"!==n||this.type===Uf._in||this.options.ecmaVersion>=6&&this.isContextual("of")?i||"using"!==n&&"await using"!==n||!(this.options.ecmaVersion>=17)||this.type===Uf._in||this.isContextual("of")?i||"Identifier"===r.id.type||t&&(this.type===Uf._in||this.isContextual("of"))?r.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.raise(this.lastTokEnd,"Missing initializer in "+n+" declaration"):this.unexpected(),e.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(Uf.comma))break}return e},ym.parseVarId=function(e,t){e.id="using"===t||"await using"===t?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(e.id,"var"===t?1:2,!1)};var Cm=1,Sm=2;function km(e,t){var n=t.key.name,i=e[n],r="true";return"MethodDefinition"!==t.type||"get"!==t.kind&&"set"!==t.kind||(r=(t.static?"s":"i")+t.kind),"iget"===i&&"iset"===r||"iset"===i&&"iget"===r||"sget"===i&&"sset"===r||"sset"===i&&"sget"===r?(e[n]="true",!1):!!i||(e[n]=r,!1)}function Lm(e,t){var n=e.computed,i=e.key;return!n&&("Identifier"===i.type&&i.name===t||"Literal"===i.type&&i.value===t)}ym.parseFunction=function(e,t,n,i,r){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===Uf.star&&t&Sm&&this.unexpected(),e.generator=this.eat(Uf.star)),this.options.ecmaVersion>=8&&(e.async=!!i),t&Cm&&(e.id=4&t&&this.type!==Uf.name?null:this.parseIdent(),!e.id||t&Sm||this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?1:2:3));var s=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(dm(e.async,e.generator)),t&Cm||(e.id=this.type===Uf.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,n,!1,r),this.yieldPos=s,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(e,t&Cm?"FunctionDeclaration":"FunctionExpression")},ym.parseFunctionParams=function(e){this.expect(Uf.parenL),e.params=this.parseBindingList(Uf.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},ym.parseClass=function(e,t){this.next();var n=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var i=this.enterClassBody(),r=this.startNode(),s=!1;for(r.body=[],this.expect(Uf.braceL);this.type!==Uf.braceR;){var o=this.parseClassElement(null!==e.superClass);o&&(r.body.push(o),"MethodDefinition"===o.type&&"constructor"===o.kind?(s&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),s=!0):o.key&&"PrivateIdentifier"===o.key.type&&km(i,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=n,this.next(),e.body=this.finishNode(r,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},ym.parseClassElement=function(e){if(this.eat(Uf.semi))return null;var t=this.options.ecmaVersion,n=this.startNode(),i="",r=!1,s=!1,o="method",a=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(Uf.braceL))return this.parseClassStaticBlock(n),n;this.isClassElementNameStart()||this.type===Uf.star?a=!0:i="static"}if(n.static=a,!i&&t>=8&&this.eatContextual("async")&&(!this.isClassElementNameStart()&&this.type!==Uf.star||this.canInsertSemicolon()?i="async":s=!0),!i&&(t>=9||!s)&&this.eat(Uf.star)&&(r=!0),!i&&!s&&!r){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=l:i=l)}if(i?(n.computed=!1,n.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),n.key.name=i,this.finishNode(n.key,"Identifier")):this.parseClassElementName(n),t<13||this.type===Uf.parenL||"method"!==o||r||s){var c=!n.static&&Lm(n,"constructor"),h=c&&e;c&&"method"!==o&&this.raise(n.key.start,"Constructor can't have get/set modifier"),n.kind=c?"constructor":o,this.parseClassMethod(n,r,s,h)}else this.parseClassField(n);return n},ym.isClassElementNameStart=function(){return this.type===Uf.name||this.type===Uf.privateId||this.type===Uf.num||this.type===Uf.string||this.type===Uf.bracketL||this.type.keyword},ym.parseClassElementName=function(e){this.type===Uf.privateId?("constructor"===this.value&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)},ym.parseClassMethod=function(e,t,n,i){var r=e.key;"constructor"===e.kind?(t&&this.raise(r.start,"Constructor can't be a generator"),n&&this.raise(r.start,"Constructor can't be an async method")):e.static&&Lm(e,"prototype")&&this.raise(r.start,"Classes may not have a static property named prototype");var s=e.value=this.parseMethod(t,n,i);return"get"===e.kind&&0!==s.params.length&&this.raiseRecoverable(s.start,"getter should have no params"),"set"===e.kind&&1!==s.params.length&&this.raiseRecoverable(s.start,"setter should have exactly one param"),"set"===e.kind&&"RestElement"===s.params[0].type&&this.raiseRecoverable(s.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")},ym.parseClassField=function(e){return Lm(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&Lm(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(Uf.eq)?(this.enterScope(576),e.value=this.parseMaybeAssign(),this.exitScope()):e.value=null,this.semicolon(),this.finishNode(e,"PropertyDefinition")},ym.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(320);this.type!==Uf.braceR;){var n=this.parseStatement(null);e.body.push(n)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")},ym.parseClassId=function(e,t){this.type===Uf.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,2,!1)):(!0===t&&this.unexpected(),e.id=null)},ym.parseClassSuper=function(e){e.superClass=this.eat(Uf._extends)?this.parseExprSubscripts(null,!1):null},ym.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared},ym.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,n=e.used;if(this.options.checkPrivateFields)for(var i=this.privateNameStack.length,r=0===i?null:this.privateNameStack[i-1],s=0;s<n.length;++s){var o=n[s];Jf(t,o.name)||(r?r.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}},ym.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==Uf.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")},ym.parseExport=function(e,t){if(this.next(),this.eat(Uf.star))return this.parseExportAllDeclaration(e,t);if(this.eat(Uf._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),"VariableDeclaration"===e.declaration.type?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[]);else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==Uf.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause());else{for(var n=0,i=e.specifiers;n<i.length;n+=1){var r=i[n];this.checkUnreserved(r.local),this.checkLocalExport(r.local),"Literal"===r.local.type&&this.raise(r.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[])}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")},ym.parseExportDeclaration=function(e){return this.parseStatement(null)},ym.parseExportDefaultDeclaration=function(){var e;if(this.type===Uf._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,4|Cm,!1,e)}if(this.type===Uf._class){var n=this.startNode();return this.parseClass(n,"nullableID")}var i=this.parseMaybeAssign();return this.semicolon(),i},ym.checkExport=function(e,t,n){e&&("string"!=typeof t&&(t="Identifier"===t.type?t.name:t.value),Jf(e,t)&&this.raiseRecoverable(n,"Duplicate export '"+t+"'"),e[t]=!0)},ym.checkPatternExport=function(e,t){var n=t.type;if("Identifier"===n)this.checkExport(e,t,t.start);else if("ObjectPattern"===n)for(var i=0,r=t.properties;i<r.length;i+=1){var s=r[i];this.checkPatternExport(e,s)}else if("ArrayPattern"===n)for(var o=0,a=t.elements;o<a.length;o+=1){var l=a[o];l&&this.checkPatternExport(e,l)}else"Property"===n?this.checkPatternExport(e,t.value):"AssignmentPattern"===n?this.checkPatternExport(e,t.left):"RestElement"===n&&this.checkPatternExport(e,t.argument)},ym.checkVariableExport=function(e,t){if(e)for(var n=0,i=t;n<i.length;n+=1){var r=i[n];this.checkPatternExport(e,r.id)}},ym.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},ym.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")},ym.parseExportSpecifiers=function(e){var t=[],n=!0;for(this.expect(Uf.braceL);!this.eat(Uf.braceR);){if(n)n=!1;else if(this.expect(Uf.comma),this.afterTrailingComma(Uf.braceR))break;t.push(this.parseExportSpecifier(e))}return t},ym.parseImport=function(e){return this.next(),this.type===Uf.string?(e.specifiers=xm,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===Uf.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ImportDeclaration")},ym.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,2),this.finishNode(e,"ImportSpecifier")},ym.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,2),this.finishNode(e,"ImportDefaultSpecifier")},ym.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,2),this.finishNode(e,"ImportNamespaceSpecifier")},ym.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===Uf.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(Uf.comma)))return e;if(this.type===Uf.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(Uf.braceL);!this.eat(Uf.braceR);){if(t)t=!1;else if(this.expect(Uf.comma),this.afterTrailingComma(Uf.braceR))break;e.push(this.parseImportSpecifier())}return e},ym.parseWithClause=function(){var e=[];if(!this.eat(Uf._with))return e;this.expect(Uf.braceL);for(var t={},n=!0;!this.eat(Uf.braceR);){if(n)n=!1;else if(this.expect(Uf.comma),this.afterTrailingComma(Uf.braceR))break;var i=this.parseImportAttribute(),r="Identifier"===i.key.type?i.key.name:i.key.value;Jf(t,r)&&this.raiseRecoverable(i.key.start,"Duplicate attribute key '"+r+"'"),t[r]=!0,e.push(i)}return e},ym.parseImportAttribute=function(){var e=this.startNode();return e.key=this.type===Uf.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved),this.expect(Uf.colon),this.type!==Uf.string&&this.unexpected(),e.value=this.parseExprAtom(),this.finishNode(e,"ImportAttribute")},ym.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===Uf.string){var e=this.parseLiteral(this.value);return im.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)},ym.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)},ym.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"string"==typeof e.expression.value&&('"'===this.input[e.start]||"'"===this.input[e.start])};var Em=pm.prototype;Em.toAssignable=function(e,t,n){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&"await"===e.name&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.toAssignable(s,t),"RestElement"!==s.type||"ArrayPattern"!==s.argument.type&&"ObjectPattern"!==s.argument.type||this.raise(s.argument.start,"Unexpected token")}break;case"Property":"init"!==e.kind&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),"AssignmentPattern"===e.argument.type&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==e.operator&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,n);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return e},Em.toAssignableList=function(e,t){for(var n=e.length,i=0;i<n;i++){var r=e[i];r&&this.toAssignable(r,t)}if(n){var s=e[n-1];6===this.options.ecmaVersion&&t&&s&&"RestElement"===s.type&&"Identifier"!==s.argument.type&&this.unexpected(s.argument.start)}return e},Em.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")},Em.parseRestBinding=function(){var e=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==Uf.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")},Em.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case Uf.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(Uf.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case Uf.braceL:return this.parseObj(!0)}return this.parseIdent()},Em.parseBindingList=function(e,t,n,i){for(var r=[],s=!0;!this.eat(e);)if(s?s=!1:this.expect(Uf.comma),t&&this.type===Uf.comma)r.push(null);else{if(n&&this.afterTrailingComma(e))break;if(this.type===Uf.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),r.push(o),this.type===Uf.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}r.push(this.parseAssignableListItem(i))}return r},Em.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t},Em.parseBindingListItem=function(e){return e},Em.parseMaybeDefault=function(e,t,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(Uf.eq))return n;var i=this.startNodeAt(e,t);return i.left=n,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")},Em.checkLValSimple=function(e,t,n){void 0===t&&(t=0);var i=0!==t;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(i?"Binding ":"Assigning to ")+e.name+" in strict mode"),i&&(2===t&&"let"===e.name&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),n&&(Jf(n,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),n[e.name]=!0),5!==t&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":i&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return i&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,n);default:this.raise(e.start,(i?"Binding":"Assigning to")+" rvalue")}},Em.checkLValPattern=function(e,t,n){switch(void 0===t&&(t=0),e.type){case"ObjectPattern":for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,t,n)}break;case"ArrayPattern":for(var o=0,a=e.elements;o<a.length;o+=1){var l=a[o];l&&this.checkLValInnerPattern(l,t,n)}break;default:this.checkLValSimple(e,t,n)}},Em.checkLValInnerPattern=function(e,t,n){switch(void 0===t&&(t=0),e.type){case"Property":this.checkLValInnerPattern(e.value,t,n);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,n);break;case"RestElement":this.checkLValPattern(e.argument,t,n);break;default:this.checkLValPattern(e,t,n)}};var Pm=function(e,t,n,i,r){this.token=e,this.isExpr=!!t,this.preserveSpace=!!n,this.override=i,this.generator=!!r},Tm={b_stat:new Pm("{",!1),b_expr:new Pm("{",!0),b_tmpl:new Pm("${",!1),p_stat:new Pm("(",!1),p_expr:new Pm("(",!0),q_tmpl:new Pm("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new Pm("function",!1),f_expr:new Pm("function",!0),f_expr_gen:new Pm("function",!0,!1,null,!0),f_gen:new Pm("function",!1,!1,null,!0)},Am=pm.prototype;Am.initialContext=function(){return[Tm.b_stat]},Am.curContext=function(){return this.context[this.context.length-1]},Am.braceIsBlock=function(e){var t=this.curContext();return t===Tm.f_expr||t===Tm.f_stat||(e!==Uf.colon||t!==Tm.b_stat&&t!==Tm.b_expr?e===Uf._return||e===Uf.name&&this.exprAllowed?zf.test(this.input.slice(this.lastTokEnd,this.start)):e===Uf._else||e===Uf.semi||e===Uf.eof||e===Uf.parenR||e===Uf.arrow||(e===Uf.braceL?t===Tm.b_stat:e!==Uf._var&&e!==Uf._const&&e!==Uf.name&&!this.exprAllowed):!t.isExpr)},Am.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if("function"===t.token)return t.generator}return!1},Am.updateContext=function(e){var t,n=this.type;n.keyword&&e===Uf.dot?this.exprAllowed=!1:(t=n.updateContext)?t.call(this,e):this.exprAllowed=n.beforeExpr},Am.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)},Uf.parenR.updateContext=Uf.braceR.updateContext=function(){if(1!==this.context.length){var e=this.context.pop();e===Tm.b_stat&&"function"===this.curContext().token&&(e=this.context.pop()),this.exprAllowed=!e.isExpr}else this.exprAllowed=!0},Uf.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?Tm.b_stat:Tm.b_expr),this.exprAllowed=!0},Uf.dollarBraceL.updateContext=function(){this.context.push(Tm.b_tmpl),this.exprAllowed=!0},Uf.parenL.updateContext=function(e){var t=e===Uf._if||e===Uf._for||e===Uf._with||e===Uf._while;this.context.push(t?Tm.p_stat:Tm.p_expr),this.exprAllowed=!0},Uf.incDec.updateContext=function(){},Uf._function.updateContext=Uf._class.updateContext=function(e){!e.beforeExpr||e===Uf._else||e===Uf.semi&&this.curContext()!==Tm.p_stat||e===Uf._return&&zf.test(this.input.slice(this.lastTokEnd,this.start))||(e===Uf.colon||e===Uf.braceL)&&this.curContext()===Tm.b_stat?this.context.push(Tm.f_stat):this.context.push(Tm.f_expr),this.exprAllowed=!1},Uf.colon.updateContext=function(){"function"===this.curContext().token&&this.context.pop(),this.exprAllowed=!0},Uf.backQuote.updateContext=function(){this.curContext()===Tm.q_tmpl?this.context.pop():this.context.push(Tm.q_tmpl),this.exprAllowed=!1},Uf.star.updateContext=function(e){if(e===Uf._function){var t=this.context.length-1;this.context[t]===Tm.f_expr?this.context[t]=Tm.f_expr_gen:this.context[t]=Tm.f_gen}this.exprAllowed=!0},Uf.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==Uf.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var Mm=pm.prototype;function Im(e){return"Identifier"===e.type||"ParenthesizedExpression"===e.type&&Im(e.expression)}function _m(e){return"MemberExpression"===e.type&&"PrivateIdentifier"===e.property.type||"ChainExpression"===e.type&&_m(e.expression)||"ParenthesizedExpression"===e.type&&_m(e.expression)}Mm.checkPropClash=function(e,t,n){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===e.type||this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var i,r=e.key;switch(r.type){case"Identifier":i=r.name;break;case"Literal":i=String(r.value);break;default:return}var s=e.kind;if(this.options.ecmaVersion>=6)"__proto__"===i&&"init"===s&&(t.proto&&(n?n.doubleProto<0&&(n.doubleProto=r.start):this.raiseRecoverable(r.start,"Redefinition of __proto__ property")),t.proto=!0);else{var o=t[i="$"+i];if(o)("init"===s?this.strict&&o.init||o.get||o.set:o.init||o[s])&&this.raiseRecoverable(r.start,"Redefinition of property");else o=t[i]={init:!1,get:!1,set:!1};o[s]=!0}}},Mm.parseExpression=function(e,t){var n=this.start,i=this.startLoc,r=this.parseMaybeAssign(e,t);if(this.type===Uf.comma){var s=this.startNodeAt(n,i);for(s.expressions=[r];this.eat(Uf.comma);)s.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(s,"SequenceExpression")}return r},Mm.parseMaybeAssign=function(e,t,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var i=!1,r=-1,s=-1,o=-1;t?(r=t.parenthesizedAssign,s=t.trailingComma,o=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new vm,i=!0);var a=this.start,l=this.startLoc;this.type!==Uf.parenL&&this.type!==Uf.name||(this.potentialArrowAt=this.start,this.potentialArrowInForAwait="await"===e);var c=this.parseMaybeConditional(e,t);if(n&&(c=n.call(this,c,a,l)),this.type.isAssign){var h=this.startNodeAt(a,l);return h.operator=this.value,this.type===Uf.eq&&(c=this.toAssignable(c,!1,t)),i||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=c.start&&(t.shorthandAssign=-1),this.type===Uf.eq?this.checkLValPattern(c):this.checkLValSimple(c),h.left=c,this.next(),h.right=this.parseMaybeAssign(e),o>-1&&(t.doubleProto=o),this.finishNode(h,"AssignmentExpression")}return i&&this.checkExpressionErrors(t,!0),r>-1&&(t.parenthesizedAssign=r),s>-1&&(t.trailingComma=s),c},Mm.parseMaybeConditional=function(e,t){var n=this.start,i=this.startLoc,r=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return r;if(this.eat(Uf.question)){var s=this.startNodeAt(n,i);return s.test=r,s.consequent=this.parseMaybeAssign(),this.expect(Uf.colon),s.alternate=this.parseMaybeAssign(e),this.finishNode(s,"ConditionalExpression")}return r},Mm.parseExprOps=function(e,t){var n=this.start,i=this.startLoc,r=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||r.start===n&&"ArrowFunctionExpression"===r.type?r:this.parseExprOp(r,n,i,-1,e)},Mm.parseExprOp=function(e,t,n,i,r){var s=this.type.binop;if(null!=s&&(!r||this.type!==Uf._in)&&s>i){var o=this.type===Uf.logicalOR||this.type===Uf.logicalAND,a=this.type===Uf.coalesce;a&&(s=Uf.logicalAND.binop);var l=this.value;this.next();var c=this.start,h=this.startLoc,u=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,r),c,h,s,r),d=this.buildBinary(t,n,e,u,l,o||a);return(o&&this.type===Uf.coalesce||a&&(this.type===Uf.logicalOR||this.type===Uf.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(d,t,n,i,r)}return e},Mm.buildBinary=function(e,t,n,i,r,s){"PrivateIdentifier"===i.type&&this.raise(i.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(e,t);return o.left=n,o.operator=r,o.right=i,this.finishNode(o,s?"LogicalExpression":"BinaryExpression")},Mm.parseMaybeUnary=function(e,t,n,i){var r,s=this.start,o=this.startLoc;if(this.isContextual("await")&&this.canAwait)r=this.parseAwait(i),t=!0;else if(this.type.prefix){var a=this.startNode(),l=this.type===Uf.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0,l,i),this.checkExpressionErrors(e,!0),l?this.checkLValSimple(a.argument):this.strict&&"delete"===a.operator&&Im(a.argument)?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):"delete"===a.operator&&_m(a.argument)?this.raiseRecoverable(a.start,"Private fields can not be deleted"):t=!0,r=this.finishNode(a,l?"UpdateExpression":"UnaryExpression")}else if(t||this.type!==Uf.privateId){if(r=this.parseExprSubscripts(e,i),this.checkExpressionErrors(e))return r;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(s,o);c.operator=this.value,c.prefix=!1,c.argument=r,this.checkLValSimple(r),this.next(),r=this.finishNode(c,"UpdateExpression")}}else(i||0===this.privateNameStack.length)&&this.options.checkPrivateFields&&this.unexpected(),r=this.parsePrivateIdent(),this.type!==Uf._in&&this.unexpected();return n||!this.eat(Uf.starstar)?r:t?void this.unexpected(this.lastTokStart):this.buildBinary(s,o,r,this.parseMaybeUnary(null,!1,!1,i),"**",!1)},Mm.parseExprSubscripts=function(e,t){var n=this.start,i=this.startLoc,r=this.parseExprAtom(e,t);if("ArrowFunctionExpression"===r.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return r;var s=this.parseSubscripts(r,n,i,!1,t);return e&&"MemberExpression"===s.type&&(e.parenthesizedAssign>=s.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=s.start&&(e.parenthesizedBind=-1),e.trailingComma>=s.start&&(e.trailingComma=-1)),s},Mm.parseSubscripts=function(e,t,n,i,r){for(var s=this.options.ecmaVersion>=8&&"Identifier"===e.type&&"async"===e.name&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,o=!1;;){var a=this.parseSubscript(e,t,n,i,s,o,r);if(a.optional&&(o=!0),a===e||"ArrowFunctionExpression"===a.type){if(o){var l=this.startNodeAt(t,n);l.expression=a,a=this.finishNode(l,"ChainExpression")}return a}e=a}},Mm.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(Uf.arrow)},Mm.parseSubscriptAsyncArrow=function(e,t,n,i){return this.parseArrowExpression(this.startNodeAt(e,t),n,!0,i)},Mm.parseSubscript=function(e,t,n,i,r,s,o){var a=this.options.ecmaVersion>=11,l=a&&this.eat(Uf.questionDot);i&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(Uf.bracketL);if(c||l&&this.type!==Uf.parenL&&this.type!==Uf.backQuote||this.eat(Uf.dot)){var h=this.startNodeAt(t,n);h.object=e,c?(h.property=this.parseExpression(),this.expect(Uf.bracketR)):this.type===Uf.privateId&&"Super"!==e.type?h.property=this.parsePrivateIdent():h.property=this.parseIdent("never"!==this.options.allowReserved),h.computed=!!c,a&&(h.optional=l),e=this.finishNode(h,"MemberExpression")}else if(!i&&this.eat(Uf.parenL)){var u=new vm,d=this.yieldPos,p=this.awaitPos,f=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var m=this.parseExprList(Uf.parenR,this.options.ecmaVersion>=8,!1,u);if(r&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(u,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=d,this.awaitPos=p,this.awaitIdentPos=f,this.parseSubscriptAsyncArrow(t,n,m,o);this.checkExpressionErrors(u,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=p||this.awaitPos,this.awaitIdentPos=f||this.awaitIdentPos;var g=this.startNodeAt(t,n);g.callee=e,g.arguments=m,a&&(g.optional=l),e=this.finishNode(g,"CallExpression")}else if(this.type===Uf.backQuote){(l||s)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var v=this.startNodeAt(t,n);v.tag=e,v.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(v,"TaggedTemplateExpression")}return e},Mm.parseExprAtom=function(e,t,n){this.type===Uf.slash&&this.readRegexp();var i,r=this.potentialArrowAt===this.start;switch(this.type){case Uf._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),i=this.startNode(),this.next(),this.type!==Uf.parenL||this.allowDirectSuper||this.raise(i.start,"super() call outside constructor of a subclass"),this.type!==Uf.dot&&this.type!==Uf.bracketL&&this.type!==Uf.parenL&&this.unexpected(),this.finishNode(i,"Super");case Uf._this:return i=this.startNode(),this.next(),this.finishNode(i,"ThisExpression");case Uf.name:var s=this.start,o=this.startLoc,a=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&"async"===l.name&&!this.canInsertSemicolon()&&this.eat(Uf._function))return this.overrideContext(Tm.f_expr),this.parseFunction(this.startNodeAt(s,o),0,!1,!0,t);if(r&&!this.canInsertSemicolon()){if(this.eat(Uf.arrow))return this.parseArrowExpression(this.startNodeAt(s,o),[l],!1,t);if(this.options.ecmaVersion>=8&&"async"===l.name&&this.type===Uf.name&&!a&&(!this.potentialArrowInForAwait||"of"!==this.value||this.containsEsc))return l=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(Uf.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(s,o),[l],!0,t)}return l;case Uf.regexp:var c=this.value;return(i=this.parseLiteral(c.value)).regex={pattern:c.pattern,flags:c.flags},i;case Uf.num:case Uf.string:return this.parseLiteral(this.value);case Uf._null:case Uf._true:case Uf._false:return(i=this.startNode()).value=this.type===Uf._null?null:this.type===Uf._true,i.raw=this.type.keyword,this.next(),this.finishNode(i,"Literal");case Uf.parenL:var h=this.start,u=this.parseParenAndDistinguishExpression(r,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(u)&&(e.parenthesizedAssign=h),e.parenthesizedBind<0&&(e.parenthesizedBind=h)),u;case Uf.bracketL:return i=this.startNode(),this.next(),i.elements=this.parseExprList(Uf.bracketR,!0,!0,e),this.finishNode(i,"ArrayExpression");case Uf.braceL:return this.overrideContext(Tm.b_expr),this.parseObj(!1,e);case Uf._function:return i=this.startNode(),this.next(),this.parseFunction(i,0);case Uf._class:return this.parseClass(this.startNode(),!1);case Uf._new:return this.parseNew();case Uf.backQuote:return this.parseTemplate();case Uf._import:return this.options.ecmaVersion>=11?this.parseExprImport(n):this.unexpected();default:return this.parseExprAtomDefault()}},Mm.parseExprAtomDefault=function(){this.unexpected()},Mm.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===Uf.parenL&&!e)return this.parseDynamicImport(t);if(this.type===Uf.dot){var n=this.startNodeAt(t.start,t.loc&&t.loc.start);return n.name="import",t.meta=this.finishNode(n,"Identifier"),this.parseImportMeta(t)}this.unexpected()},Mm.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(Uf.parenR)?e.options=null:(this.expect(Uf.comma),this.afterTrailingComma(Uf.parenR)?e.options=null:(e.options=this.parseMaybeAssign(),this.eat(Uf.parenR)||(this.expect(Uf.comma),this.afterTrailingComma(Uf.parenR)||this.unexpected())));else if(!this.eat(Uf.parenR)){var t=this.start;this.eat(Uf.comma)&&this.eat(Uf.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")},Mm.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),"meta"!==e.property.name&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),"module"===this.options.sourceType||this.options.allowImportExportEverywhere||this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")},Mm.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),110===t.raw.charCodeAt(t.raw.length-1)&&(t.bigint=null!=t.value?t.value.toString():t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")},Mm.parseParenExpression=function(){this.expect(Uf.parenL);var e=this.parseExpression();return this.expect(Uf.parenR),e},Mm.shouldParseArrow=function(e){return!this.canInsertSemicolon()},Mm.parseParenAndDistinguishExpression=function(e,t){var n,i=this.start,r=this.startLoc,s=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o,a=this.start,l=this.startLoc,c=[],h=!0,u=!1,d=new vm,p=this.yieldPos,f=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==Uf.parenR;){if(h?h=!1:this.expect(Uf.comma),s&&this.afterTrailingComma(Uf.parenR,!0)){u=!0;break}if(this.type===Uf.ellipsis){o=this.start,c.push(this.parseParenItem(this.parseRestBinding())),this.type===Uf.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}c.push(this.parseMaybeAssign(!1,d,this.parseParenItem))}var m=this.lastTokEnd,g=this.lastTokEndLoc;if(this.expect(Uf.parenR),e&&this.shouldParseArrow(c)&&this.eat(Uf.arrow))return this.checkPatternErrors(d,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=p,this.awaitPos=f,this.parseParenArrowList(i,r,c,t);c.length&&!u||this.unexpected(this.lastTokStart),o&&this.unexpected(o),this.checkExpressionErrors(d,!0),this.yieldPos=p||this.yieldPos,this.awaitPos=f||this.awaitPos,c.length>1?((n=this.startNodeAt(a,l)).expressions=c,this.finishNodeAt(n,"SequenceExpression",m,g)):n=c[0]}else n=this.parseParenExpression();if(this.options.preserveParens){var v=this.startNodeAt(i,r);return v.expression=n,this.finishNode(v,"ParenthesizedExpression")}return n},Mm.parseParenItem=function(e){return e},Mm.parseParenArrowList=function(e,t,n,i){return this.parseArrowExpression(this.startNodeAt(e,t),n,!1,i)};var Om=[];Mm.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===Uf.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var n=this.containsEsc;return e.property=this.parseIdent(!0),"target"!==e.property.name&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var i=this.start,r=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),i,r,!0,!1),this.eat(Uf.parenL)?e.arguments=this.parseExprList(Uf.parenR,this.options.ecmaVersion>=8,!1):e.arguments=Om,this.finishNode(e,"NewExpression")},Mm.parseTemplateElement=function(e){var t=e.isTagged,n=this.startNode();return this.type===Uf.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value.replace(/\r\n?/g,"\n"),cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===Uf.backQuote,this.finishNode(n,"TemplateElement")},Mm.parseTemplate=function(e){void 0===e&&(e={});var t=e.isTagged;void 0===t&&(t=!1);var n=this.startNode();this.next(),n.expressions=[];var i=this.parseTemplateElement({isTagged:t});for(n.quasis=[i];!i.tail;)this.type===Uf.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(Uf.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(Uf.braceR),n.quasis.push(i=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(n,"TemplateLiteral")},Mm.isAsyncProp=function(e){return!e.computed&&"Identifier"===e.key.type&&"async"===e.key.name&&(this.type===Uf.name||this.type===Uf.num||this.type===Uf.string||this.type===Uf.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===Uf.star)&&!zf.test(this.input.slice(this.lastTokEnd,this.start))},Mm.parseObj=function(e,t){var n=this.startNode(),i=!0,r={};for(n.properties=[],this.next();!this.eat(Uf.braceR);){if(i)i=!1;else if(this.expect(Uf.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(Uf.braceR))break;var s=this.parseProperty(e,t);e||this.checkPropClash(s,r,t),n.properties.push(s)}return this.finishNode(n,e?"ObjectPattern":"ObjectExpression")},Mm.parseProperty=function(e,t){var n,i,r,s,o=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(Uf.ellipsis))return e?(o.argument=this.parseIdent(!1),this.type===Uf.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(o,"RestElement")):(o.argument=this.parseMaybeAssign(!1,t),this.type===Uf.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(o,"SpreadElement"));this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(e||t)&&(r=this.start,s=this.startLoc),e||(n=this.eat(Uf.star)));var a=this.containsEsc;return this.parsePropertyName(o),!e&&!a&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(o)?(i=!0,n=this.options.ecmaVersion>=9&&this.eat(Uf.star),this.parsePropertyName(o)):i=!1,this.parsePropertyValue(o,e,n,i,r,s,t,a),this.finishNode(o,"Property")},Mm.parseGetterSetter=function(e){var t=e.key.name;this.parsePropertyName(e),e.value=this.parseMethod(!1),e.kind=t;var n="get"===e.kind?0:1;if(e.value.params.length!==n){var i=e.value.start;"get"===e.kind?this.raiseRecoverable(i,"getter should have no params"):this.raiseRecoverable(i,"setter should have exactly one param")}else"set"===e.kind&&"RestElement"===e.value.params[0].type&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")},Mm.parsePropertyValue=function(e,t,n,i,r,s,o,a){(n||i)&&this.type===Uf.colon&&this.unexpected(),this.eat(Uf.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),e.kind="init"):this.options.ecmaVersion>=6&&this.type===Uf.parenL?(t&&this.unexpected(),e.method=!0,e.value=this.parseMethod(n,i),e.kind="init"):t||a||!(this.options.ecmaVersion>=5)||e.computed||"Identifier"!==e.key.type||"get"!==e.key.name&&"set"!==e.key.name||this.type===Uf.comma||this.type===Uf.braceR||this.type===Uf.eq?this.options.ecmaVersion>=6&&!e.computed&&"Identifier"===e.key.type?((n||i)&&this.unexpected(),this.checkUnreserved(e.key),"await"!==e.key.name||this.awaitIdentPos||(this.awaitIdentPos=r),t?e.value=this.parseMaybeDefault(r,s,this.copyNode(e.key)):this.type===Uf.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),e.value=this.parseMaybeDefault(r,s,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.kind="init",e.shorthand=!0):this.unexpected():((n||i)&&this.unexpected(),this.parseGetterSetter(e))},Mm.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(Uf.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(Uf.bracketR),e.key;e.computed=!1}return e.key=this.type===Uf.num||this.type===Uf.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},Mm.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)},Mm.parseMethod=function(e,t,n){var i=this.startNode(),r=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=e),this.options.ecmaVersion>=8&&(i.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|dm(t,i.generator)|(n?128:0)),this.expect(Uf.parenL),i.params=this.parseBindingList(Uf.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0,!1),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(i,"FunctionExpression")},Mm.parseArrowExpression=function(e,t,n,i){var r=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(16|dm(n,!1)),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,i),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(e,"ArrowFunctionExpression")},Mm.parseFunctionBody=function(e,t,n,i){var r=t&&this.type!==Uf.braceL,s=this.strict,o=!1;if(r)e.body=this.parseMaybeAssign(i),e.expression=!0,this.checkParams(e,!1);else{var a=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);s&&!a||(o=this.strictDirective(this.end))&&a&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list");var l=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(e,!s&&!o&&!t&&!n&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,5),e.body=this.parseBlock(!1,void 0,o&&!s),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=l}this.exitScope()},Mm.isSimpleParamList=function(e){for(var t=0,n=e;t<n.length;t+=1){if("Identifier"!==n[t].type)return!1}return!0},Mm.checkParams=function(e,t){for(var n=Object.create(null),i=0,r=e.params;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,1,t?null:n)}},Mm.parseExprList=function(e,t,n,i){for(var r=[],s=!0;!this.eat(e);){if(s)s=!1;else if(this.expect(Uf.comma),t&&this.afterTrailingComma(e))break;var o=void 0;n&&this.type===Uf.comma?o=null:this.type===Uf.ellipsis?(o=this.parseSpread(i),i&&this.type===Uf.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):o=this.parseMaybeAssign(!1,i),r.push(o)}return r},Mm.checkUnreserved=function(e){var t=e.start,n=e.end,i=e.name;(this.inGenerator&&"yield"===i&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===i&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().flags&um||"arguments"!==i||this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),!this.inClassStaticBlock||"arguments"!==i&&"await"!==i||this.raise(t,"Cannot use "+i+" in class static initialization block"),this.keywords.test(i)&&this.raise(t,"Unexpected keyword '"+i+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(t,n).indexOf("\\"))||(this.strict?this.reservedWordsStrict:this.reservedWords).test(i)&&(this.inAsync||"await"!==i||this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+i+"' is reserved"))},Mm.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),"await"!==t.name||this.awaitIdentPos||(this.awaitIdentPos=t.start)),t},Mm.parseIdentNode=function(){var e=this.startNode();return this.type===Uf.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,"class"!==e.name&&"function"!==e.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop(),this.type=Uf.name):this.unexpected(),e},Mm.parsePrivateIdent=function(){var e=this.startNode();return this.type===Uf.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(0===this.privateNameStack.length?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e},Mm.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===Uf.semi||this.canInsertSemicolon()||this.type!==Uf.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(Uf.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")},Mm.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var Nm=pm.prototype;Nm.raise=function(e,t){var n=om(this.input,e);t+=" ("+n.line+":"+n.column+")",this.sourceFile&&(t+=" in "+this.sourceFile);var i=new SyntaxError(t);throw i.pos=e,i.loc=n,i.raisedAt=this.pos,i},Nm.raiseRecoverable=Nm.raise,Nm.curPosition=function(){if(this.options.locations)return new rm(this.curLine,this.pos-this.lineStart)};var Dm=pm.prototype,Rm=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[]};Dm.enterScope=function(e){this.scopeStack.push(new Rm(e))},Dm.exitScope=function(){this.scopeStack.pop()},Dm.treatFunctionsAsVarInScope=function(e){return 2&e.flags||!this.inModule&&1&e.flags},Dm.declareName=function(e,t,n){var i=!1;if(2===t){var r=this.currentScope();i=r.lexical.indexOf(e)>-1||r.functions.indexOf(e)>-1||r.var.indexOf(e)>-1,r.lexical.push(e),this.inModule&&1&r.flags&&delete this.undefinedExports[e]}else if(4===t){this.currentScope().lexical.push(e)}else if(3===t){var s=this.currentScope();i=this.treatFunctionsAsVar?s.lexical.indexOf(e)>-1:s.lexical.indexOf(e)>-1||s.var.indexOf(e)>-1,s.functions.push(e)}else for(var o=this.scopeStack.length-1;o>=0;--o){var a=this.scopeStack[o];if(a.lexical.indexOf(e)>-1&&!(32&a.flags&&a.lexical[0]===e)||!this.treatFunctionsAsVarInScope(a)&&a.functions.indexOf(e)>-1){i=!0;break}if(a.var.push(e),this.inModule&&1&a.flags&&delete this.undefinedExports[e],a.flags&um)break}i&&this.raiseRecoverable(n,"Identifier '"+e+"' has already been declared")},Dm.checkLocalExport=function(e){-1===this.scopeStack[0].lexical.indexOf(e.name)&&-1===this.scopeStack[0].var.indexOf(e.name)&&(this.undefinedExports[e.name]=e)},Dm.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},Dm.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(771&t.flags)return t}},Dm.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(771&t.flags&&!(16&t.flags))return t}};var Fm=function(e,t,n){this.type="",this.start=t,this.end=0,e.options.locations&&(this.loc=new sm(e,n)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[t,0])},Bm=pm.prototype;function Vm(e,t,n,i){return e.type=t,e.end=n,this.options.locations&&(e.loc.end=i),this.options.ranges&&(e.range[1]=n),e}Bm.startNode=function(){return new Fm(this,this.start,this.startLoc)},Bm.startNodeAt=function(e,t){return new Fm(this,e,t)},Bm.finishNode=function(e,t){return Vm.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)},Bm.finishNodeAt=function(e,t,n,i){return Vm.call(this,e,t,n,i)},Bm.copyNode=function(e){var t=new Fm(this,e.start,this.startLoc);for(var n in e)t[n]=e[n];return t};var jm="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Hm=jm+" Extended_Pictographic",Um=Hm+" EBase EComp EMod EPres ExtPict",zm={9:jm,10:Hm,11:Hm,12:Um,13:Um,14:Um},Wm={9:"",10:"",11:"",12:"",13:"",14:"Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji"},Gm="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",$m="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Zm=$m+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",qm=Zm+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Km=qm+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",Ym=Km+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",Xm={9:$m,10:Zm,11:qm,12:Km,13:Ym,14:Ym+" Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz"},Jm={};function Qm(e){var t=Jm[e]={binary:tm(zm[e]+" "+Gm),binaryOfStrings:tm(Wm[e]),nonBinary:{General_Category:tm(Gm),Script:tm(Xm[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var eg=0,tg=[9,10,11,12,13,14];eg<tg.length;eg+=1){Qm(tg[eg])}var ng=pm.prototype,ig=function(e,t){this.parent=e,this.base=t||this};ig.prototype.separatedFrom=function(e){for(var t=this;t;t=t.parent)for(var n=e;n;n=n.parent)if(t.base===n.base&&t!==n)return!0;return!1},ig.prototype.sibling=function(){return new ig(this.parent,this.base)};var rg=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":"")+(e.options.ecmaVersion>=13?"d":"")+(e.options.ecmaVersion>=15?"v":""),this.unicodeProperties=Jm[e.options.ecmaVersion>=14?14:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};function sg(e){return 105===e||109===e||115===e}function og(e){return 36===e||e>=40&&e<=43||46===e||63===e||e>=91&&e<=94||e>=123&&e<=125}function ag(e){return e>=65&&e<=90||e>=97&&e<=122}rg.prototype.reset=function(e,t,n){var i=-1!==n.indexOf("v"),r=-1!==n.indexOf("u");this.start=0|e,this.source=t+"",this.flags=n,i&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=r&&this.parser.options.ecmaVersion>=9)},rg.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)},rg.prototype.at=function(e,t){void 0===t&&(t=!1);var n=this.source,i=n.length;if(e>=i)return-1;var r=n.charCodeAt(e);if(!t&&!this.switchU||r<=55295||r>=57344||e+1>=i)return r;var s=n.charCodeAt(e+1);return s>=56320&&s<=57343?(r<<10)+s-56613888:r},rg.prototype.nextIndex=function(e,t){void 0===t&&(t=!1);var n=this.source,i=n.length;if(e>=i)return i;var r,s=n.charCodeAt(e);return!t&&!this.switchU||s<=55295||s>=57344||e+1>=i||(r=n.charCodeAt(e+1))<56320||r>57343?e+1:e+2},rg.prototype.current=function(e){return void 0===e&&(e=!1),this.at(this.pos,e)},rg.prototype.lookahead=function(e){return void 0===e&&(e=!1),this.at(this.nextIndex(this.pos,e),e)},rg.prototype.advance=function(e){void 0===e&&(e=!1),this.pos=this.nextIndex(this.pos,e)},rg.prototype.eat=function(e,t){return void 0===t&&(t=!1),this.current(t)===e&&(this.advance(t),!0)},rg.prototype.eatChars=function(e,t){void 0===t&&(t=!1);for(var n=this.pos,i=0,r=e;i<r.length;i+=1){var s=r[i],o=this.at(n,t);if(-1===o||o!==s)return!1;n=this.nextIndex(n,t)}return this.pos=n,!0},ng.validateRegExpFlags=function(e){for(var t=e.validFlags,n=e.flags,i=!1,r=!1,s=0;s<n.length;s++){var o=n.charAt(s);-1===t.indexOf(o)&&this.raise(e.start,"Invalid regular expression flag"),n.indexOf(o,s+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),"u"===o&&(i=!0),"v"===o&&(r=!0)}this.options.ecmaVersion>=15&&i&&r&&this.raise(e.start,"Invalid regular expression flag")},ng.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&function(e){for(var t in e)return!0;return!1}(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))},ng.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,n=e.backReferenceNames;t<n.length;t+=1){var i=n[t];e.groupNames[i]||e.raise("Invalid named capture referenced")}},ng.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new ig(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")},ng.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););},ng.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):!!(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))&&(this.regexp_eatQuantifier(e),!0)},ng.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!n,!0}return e.pos=t,!1},ng.regexp_eatQuantifier=function(e,t){return void 0===t&&(t=!1),!!this.regexp_eatQuantifierPrefix(e,t)&&(e.eat(63),!0)},ng.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)},ng.regexp_eatBracedQuantifier=function(e,t){var n=e.pos;if(e.eat(123)){var i=0,r=-1;if(this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(r=e.lastIntValue),e.eat(125)))return-1!==r&&r<i&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=n}return!1},ng.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)},ng.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1},ng.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)){if(this.options.ecmaVersion>=16){var n=this.regexp_eatModifiers(e),i=e.eat(45);if(n||i){for(var r=0;r<n.length;r++){var s=n.charAt(r);n.indexOf(s,r+1)>-1&&e.raise("Duplicate regular expression modifiers")}if(i){var o=this.regexp_eatModifiers(e);n||o||58!==e.current()||e.raise("Invalid regular expression modifiers");for(var a=0;a<o.length;a++){var l=o.charAt(a);(o.indexOf(l,a+1)>-1||n.indexOf(l)>-1)&&e.raise("Duplicate regular expression modifiers")}}}}if(e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}}e.pos=t}return!1},ng.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):63===e.current()&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1},ng.regexp_eatModifiers=function(e){for(var t="",n=0;-1!==(n=e.current())&&sg(n);)t+=nm(n),e.advance();return t},ng.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)},ng.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1},ng.regexp_eatSyntaxCharacter=function(e){var t=e.current();return!!og(t)&&(e.lastIntValue=t,e.advance(),!0)},ng.regexp_eatPatternCharacters=function(e){for(var t=e.pos,n=0;-1!==(n=e.current())&&!og(n);)e.advance();return e.pos!==t},ng.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return!(-1===t||36===t||t>=40&&t<=43||46===t||63===t||91===t||94===t||124===t)&&(e.advance(),!0)},ng.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,n=e.groupNames[e.lastStringValue];if(n)if(t)for(var i=0,r=n;i<r.length;i+=1){r[i].separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(n||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}},ng.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1},ng.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=nm(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=nm(e.lastIntValue);return!0}return!1},ng.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,i=e.current(n);return e.advance(n),92===i&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(i=e.lastIntValue),function(e){return Nf(e,!0)||36===e||95===e}(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)},ng.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,i=e.current(n);return e.advance(n),92===i&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(i=e.lastIntValue),function(e){return Df(e,!0)||36===e||95===e||8204===e||8205===e}(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)},ng.regexp_eatAtomEscape=function(e){return!!(this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e))||(e.switchU&&(99===e.current()&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)},ng.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var n=e.lastIntValue;if(e.switchU)return n>e.maxBackReference&&(e.maxBackReference=n),!0;if(n<=e.numCapturingParens)return!0;e.pos=t}return!1},ng.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1},ng.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)},ng.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1},ng.regexp_eatZero=function(e){return 48===e.current()&&!hg(e.lookahead())&&(e.lastIntValue=0,e.advance(),!0)},ng.regexp_eatControlEscape=function(e){var t=e.current();return 116===t?(e.lastIntValue=9,e.advance(),!0):110===t?(e.lastIntValue=10,e.advance(),!0):118===t?(e.lastIntValue=11,e.advance(),!0):102===t?(e.lastIntValue=12,e.advance(),!0):114===t&&(e.lastIntValue=13,e.advance(),!0)},ng.regexp_eatControlLetter=function(e){var t=e.current();return!!ag(t)&&(e.lastIntValue=t%32,e.advance(),!0)},ng.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){void 0===t&&(t=!1);var n,i=e.pos,r=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var s=e.lastIntValue;if(r&&s>=55296&&s<=56319){var o=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var a=e.lastIntValue;if(a>=56320&&a<=57343)return e.lastIntValue=1024*(s-55296)+(a-56320)+65536,!0}e.pos=o,e.lastIntValue=s}return!0}if(r&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&((n=e.lastIntValue)>=0&&n<=1114111))return!0;r&&e.raise("Invalid unicode escape"),e.pos=i}return!1},ng.regexp_eatIdentityEscape=function(e){if(e.switchU)return!!this.regexp_eatSyntaxCharacter(e)||!!e.eat(47)&&(e.lastIntValue=47,!0);var t=e.current();return!(99===t||e.switchN&&107===t)&&(e.lastIntValue=t,e.advance(),!0)},ng.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do{e.lastIntValue=10*e.lastIntValue+(t-48),e.advance()}while((t=e.current())>=48&&t<=57);return!0}return!1};function lg(e){return ag(e)||95===e}function cg(e){return lg(e)||hg(e)}function hg(e){return e>=48&&e<=57}function ug(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function dg(e){return e>=65&&e<=70?e-65+10:e>=97&&e<=102?e-97+10:e-48}function pg(e){return e>=48&&e<=55}ng.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(function(e){return 100===e||68===e||115===e||83===e||119===e||87===e}(t))return e.lastIntValue=-1,e.advance(),1;var n=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((n=80===t)||112===t)){var i;if(e.lastIntValue=-1,e.advance(),e.eat(123)&&(i=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return n&&2===i&&e.raise("Invalid property name"),i;e.raise("Invalid property name")}return 0},ng.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var n=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,n,i),1}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var r=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,r)}return 0},ng.regexp_validateUnicodePropertyNameAndValue=function(e,t,n){Jf(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(n)||e.raise("Invalid property value")},ng.regexp_validateUnicodePropertyNameOrValue=function(e,t){return e.unicodeProperties.binary.test(t)?1:e.switchV&&e.unicodeProperties.binaryOfStrings.test(t)?2:void e.raise("Invalid property name")},ng.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";lg(t=e.current());)e.lastStringValue+=nm(t),e.advance();return""!==e.lastStringValue},ng.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";cg(t=e.current());)e.lastStringValue+=nm(t),e.advance();return""!==e.lastStringValue},ng.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)},ng.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),n=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&2===n&&e.raise("Negated character class may contain strings"),!0}return!1},ng.regexp_classContents=function(e){return 93===e.current()?1:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),1)},ng.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var n=e.lastIntValue;!e.switchU||-1!==t&&-1!==n||e.raise("Invalid character class"),-1!==t&&-1!==n&&t>n&&e.raise("Range out of order in character class")}}},ng.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var n=e.current();(99===n||pg(n))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var i=e.current();return 93!==i&&(e.lastIntValue=i,e.advance(),!0)},ng.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)},ng.regexp_classSetExpression=function(e){var t,n=1;if(this.regexp_eatClassSetRange(e));else if(t=this.regexp_eatClassSetOperand(e)){2===t&&(n=2);for(var i=e.pos;e.eatChars([38,38]);)38!==e.current()&&(t=this.regexp_eatClassSetOperand(e))?2!==t&&(n=1):e.raise("Invalid character in character class");if(i!==e.pos)return n;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(i!==e.pos)return n}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(!(t=this.regexp_eatClassSetOperand(e)))return n;2===t&&(n=2)}},ng.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var n=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var i=e.lastIntValue;return-1!==n&&-1!==i&&n>i&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1},ng.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?1:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)},ng.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var n=e.eat(94),i=this.regexp_classContents(e);if(e.eat(93))return n&&2===i&&e.raise("Negated character class may contain strings"),i;e.pos=t}if(e.eat(92)){var r=this.regexp_eatCharacterClassEscape(e);if(r)return r;e.pos=t}return null},ng.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var n=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return n}else e.raise("Invalid escape");e.pos=t}return null},ng.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)2===this.regexp_classString(e)&&(t=2);return t},ng.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return 1===t?1:2},ng.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return!(!this.regexp_eatCharacterEscape(e)&&!this.regexp_eatClassSetReservedPunctuator(e))||(e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1));var n=e.current();return!(n<0||n===e.lookahead()&&function(e){return 33===e||e>=35&&e<=38||e>=42&&e<=44||46===e||e>=58&&e<=64||94===e||96===e||126===e}(n))&&(!function(e){return 40===e||41===e||45===e||47===e||e>=91&&e<=93||e>=123&&e<=125}(n)&&(e.advance(),e.lastIntValue=n,!0))},ng.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return!!function(e){return 33===e||35===e||37===e||38===e||44===e||45===e||e>=58&&e<=62||64===e||96===e||126===e}(t)&&(e.lastIntValue=t,e.advance(),!0)},ng.regexp_eatClassControlLetter=function(e){var t=e.current();return!(!hg(t)&&95!==t)&&(e.lastIntValue=t%32,e.advance(),!0)},ng.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1},ng.regexp_eatDecimalDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;hg(n=e.current());)e.lastIntValue=10*e.lastIntValue+(n-48),e.advance();return e.pos!==t},ng.regexp_eatHexDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;ug(n=e.current());)e.lastIntValue=16*e.lastIntValue+dg(n),e.advance();return e.pos!==t},ng.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var n=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=64*t+8*n+e.lastIntValue:e.lastIntValue=8*t+n}else e.lastIntValue=t;return!0}return!1},ng.regexp_eatOctalDigit=function(e){var t=e.current();return pg(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)},ng.regexp_eatFixedHexDigits=function(e,t){var n=e.pos;e.lastIntValue=0;for(var i=0;i<t;++i){var r=e.current();if(!ug(r))return e.pos=n,!1;e.lastIntValue=16*e.lastIntValue+dg(r),e.advance()}return!0};var fg=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new sm(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},mg=pm.prototype;function gg(e){return"function"!=typeof BigInt?null:BigInt(e.replace(/_/g,""))}mg.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new fg(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},mg.getToken=function(){return this.next(),new fg(this)},"undefined"!=typeof Symbol&&(mg[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===Uf.eof,value:t}}}}),mg.nextToken=function(){var e=this.curContext();return e&&e.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(Uf.eof):e.override?e.override(this):void this.readToken(this.fullCharCodeAtPos())},mg.readToken=function(e){return Nf(e,this.options.ecmaVersion>=6)||92===e?this.readWord():this.getTokenFromCode(e)},mg.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888},mg.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(-1===n&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations)for(var i=void 0,r=t;(i=$f(this.input,r,this.pos))>-1;)++this.curLine,r=this.lineStart=i;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,n),t,this.pos,e,this.curPosition())},mg.skipLineComment=function(e){for(var t=this.pos,n=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!Gf(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,n,this.curPosition())},mg.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(!(e>8&&e<14||e>=5760&&Zf.test(String.fromCharCode(e))))break e;++this.pos}}},mg.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=e,this.value=t,this.updateContext(n)},mg.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===e&&46===t?(this.pos+=3,this.finishToken(Uf.ellipsis)):(++this.pos,this.finishToken(Uf.dot))},mg.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===e?this.finishOp(Uf.assign,2):this.finishOp(Uf.slash,1)},mg.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),n=1,i=42===e?Uf.star:Uf.modulo;return this.options.ecmaVersion>=7&&42===e&&42===t&&(++n,i=Uf.starstar,t=this.input.charCodeAt(this.pos+2)),61===t?this.finishOp(Uf.assign,n+1):this.finishOp(i,n)},mg.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12)if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(Uf.assign,3);return this.finishOp(124===e?Uf.logicalOR:Uf.logicalAND,2)}return 61===t?this.finishOp(Uf.assign,2):this.finishOp(124===e?Uf.bitwiseOR:Uf.bitwiseAND,1)},mg.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(Uf.assign,2):this.finishOp(Uf.bitwiseXOR,1)},mg.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?45!==t||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!zf.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(Uf.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===t?this.finishOp(Uf.assign,2):this.finishOp(Uf.plusMin,1)},mg.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),n=1;return t===e?(n=62===e&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(Uf.assign,n+1):this.finishOp(Uf.bitShift,n)):33!==t||60!==e||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===t&&(n=2),this.finishOp(Uf.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},mg.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return 61===t?this.finishOp(Uf.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===e&&62===t&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(Uf.arrow)):this.finishOp(61===e?Uf.eq:Uf.prefix,1)},mg.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(46===t){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(Uf.questionDot,2)}if(63===t){if(e>=12)if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(Uf.assign,3);return this.finishOp(Uf.coalesce,2)}}return this.finishOp(Uf.question,1)},mg.readToken_numberSign=function(){var e=35;if(this.options.ecmaVersion>=13&&(++this.pos,Nf(e=this.fullCharCodeAtPos(),!0)||92===e))return this.finishToken(Uf.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+nm(e)+"'")},mg.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(Uf.parenL);case 41:return++this.pos,this.finishToken(Uf.parenR);case 59:return++this.pos,this.finishToken(Uf.semi);case 44:return++this.pos,this.finishToken(Uf.comma);case 91:return++this.pos,this.finishToken(Uf.bracketL);case 93:return++this.pos,this.finishToken(Uf.bracketR);case 123:return++this.pos,this.finishToken(Uf.braceL);case 125:return++this.pos,this.finishToken(Uf.braceR);case 58:return++this.pos,this.finishToken(Uf.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(Uf.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(120===t||88===t)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===t||79===t)return this.readRadixNumber(8);if(98===t||66===t)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(Uf.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+nm(e)+"'")},mg.finishOp=function(e,t){var n=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,n)},mg.readRegexp=function(){for(var e,t,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(zf.test(i)&&this.raise(n,"Unterminated regular expression"),e)e=!1;else{if("["===i)t=!0;else if("]"===i&&t)t=!1;else if("/"===i&&!t)break;e="\\"===i}++this.pos}var r=this.input.slice(n,this.pos);++this.pos;var s=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(s);var a=this.regexpState||(this.regexpState=new rg(this));a.reset(n,r,o),this.validateRegExpFlags(a),this.validateRegExpPattern(a);var l=null;try{l=new RegExp(r,o)}catch(c){}return this.finishToken(Uf.regexp,{pattern:r,flags:o,value:l})},mg.readInt=function(e,t,n){for(var i=this.options.ecmaVersion>=12&&void 0===t,r=n&&48===this.input.charCodeAt(this.pos),s=this.pos,o=0,a=0,l=0,c=null==t?1/0:t;l<c;++l,++this.pos){var h=this.input.charCodeAt(this.pos),u=void 0;if(i&&95===h)r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===a&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===l&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),a=h;else{if((u=h>=97?h-97+10:h>=65?h-65+10:h>=48&&h<=57?h-48:1/0)>=e)break;a=h,o=o*e+u}}return i&&95===a&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===s||null!=t&&this.pos-s!==t?null:o},mg.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var n=this.readInt(e);return null==n&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(n=gg(this.input.slice(t,this.pos)),++this.pos):Nf(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Uf.num,n)},mg.readNumber=function(e){var t=this.pos;e||null!==this.readInt(10,void 0,!0)||this.raise(t,"Invalid number");var n=this.pos-t>=2&&48===this.input.charCodeAt(t);n&&this.strict&&this.raise(t,"Invalid number");var i=this.input.charCodeAt(this.pos);if(!n&&!e&&this.options.ecmaVersion>=11&&110===i){var r=gg(this.input.slice(t,this.pos));return++this.pos,Nf(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Uf.num,r)}n&&/[89]/.test(this.input.slice(t,this.pos))&&(n=!1),46!==i||n||(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),69!==i&&101!==i||n||(43!==(i=this.input.charCodeAt(++this.pos))&&45!==i||++this.pos,null===this.readInt(10)&&this.raise(t,"Invalid number")),Nf(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var s,o=(s=this.input.slice(t,this.pos),n?parseInt(s,8):parseFloat(s.replace(/_/g,"")));return this.finishToken(Uf.num,o)},mg.readCodePoint=function(){var e;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else e=this.readHexChar(4);return e},mg.readString=function(e){for(var t="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===e)break;92===i?(t+=this.input.slice(n,this.pos),t+=this.readEscapedChar(!1),n=this.pos):8232===i||8233===i?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(Gf(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(n,this.pos++),this.finishToken(Uf.string,t)};var vg={};mg.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e!==vg)throw e;this.readInvalidTemplateToken()}this.inTemplateElement=!1},mg.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw vg;this.raise(e,t)},mg.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(96===n||36===n&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==Uf.template&&this.type!==Uf.invalidTemplate?(e+=this.input.slice(t,this.pos),this.finishToken(Uf.template,e)):36===n?(this.pos+=2,this.finishToken(Uf.dollarBraceL)):(++this.pos,this.finishToken(Uf.backQuote));if(92===n)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(Gf(n)){switch(e+=this.input.slice(t,this.pos),++this.pos,n){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:e+="\n";break;default:e+=String.fromCharCode(n)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}},mg.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(Uf.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":"\n"===this.input[this.pos+1]&&++this.pos;case"\n":case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1}this.raise(this.start,"Unterminated template")},mg.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return nm(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var n=this.pos-1;this.invalidStringToken(n,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var i=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(i,8);return r>255&&(i=i.slice(0,-1),r=parseInt(i,8)),this.pos+=i.length-1,t=this.input.charCodeAt(this.pos),"0"===i&&56!==t&&57!==t||!this.strict&&!e||this.invalidStringToken(this.pos-1-i.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return Gf(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}},mg.readHexChar=function(e){var t=this.pos,n=this.readInt(16,e);return null===n&&this.invalidStringToken(t,"Bad character escape sequence"),n},mg.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,n=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(Df(r,i))this.pos+=r<=65535?1:2;else{if(92!==r)break;this.containsEsc=!0,e+=this.input.slice(n,this.pos);var s=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?Nf:Df)(o,i)||this.invalidStringToken(s,"Invalid Unicode escape"),e+=nm(o),n=this.pos}t=!1}return e+this.input.slice(n,this.pos)},mg.readWord=function(){var e=this.readWord1(),t=Uf.name;return this.keywords.test(e)&&(t=jf[e]),this.finishToken(t,e)};function yg(e,t){return pm.parse(e,t)}pm.acorn={Parser:pm,version:"8.15.0",defaultOptions:am,Position:rm,SourceLocation:sm,getLineInfo:om,Node:Fm,TokenType:Rf,tokTypes:Uf,keywordTypes:jf,TokContext:Pm,tokContexts:Tm,isIdentifierChar:Df,isIdentifierStart:Nf,Token:fg,isNewLine:Gf,lineBreak:zf,lineBreakG:Wf,nonASCIIwhitespace:Zf};var bg={exports:{}},wg={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},xg="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Cg={5:xg,"5module":xg+" export import",6:xg+" const class extends export import super"},Sg=/^in(stanceof)?$/,kg="---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Lg="----------------------------------------------------------------------------------------------------------------------------------------------------",Eg=new RegExp("["+kg+"]"),Pg=new RegExp("["+kg+Lg+"]");kg=Lg=null;var Tg=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],Ag=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function Mg(e,t){for(var n=65536,i=0;i<t.length;i+=2){if((n+=t[i])>e)return!1;if((n+=t[i+1])>=e)return!0}}function Ig(e,t){return e<65?36===e:e<91||(e<97?95===e:e<123||(e<=65535?e>=170&&Eg.test(String.fromCharCode(e)):!1!==t&&Mg(e,Tg)))}function _g(e,t){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||(e<=65535?e>=170&&Pg.test(String.fromCharCode(e)):!1!==t&&(Mg(e,Tg)||Mg(e,Ag)))))}var Og=function(e,t){void 0===t&&(t={}),this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop||null,this.updateContext=null};function Ng(e,t){return new Og(e,{beforeExpr:!0,binop:t})}var Dg={beforeExpr:!0},Rg={startsExpr:!0},Fg={};function Bg(e,t){return void 0===t&&(t={}),t.keyword=e,Fg[e]=new Og(e,t)}var Vg={num:new Og("num",Rg),regexp:new Og("regexp",Rg),string:new Og("string",Rg),name:new Og("name",Rg),eof:new Og("eof"),bracketL:new Og("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Og("]"),braceL:new Og("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Og("}"),parenL:new Og("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Og(")"),comma:new Og(",",Dg),semi:new Og(";",Dg),colon:new Og(":",Dg),dot:new Og("."),question:new Og("?",Dg),questionDot:new Og("?."),arrow:new Og("=>",Dg),template:new Og("template"),invalidTemplate:new Og("invalidTemplate"),ellipsis:new Og("...",Dg),backQuote:new Og("`",Rg),dollarBraceL:new Og("${",{beforeExpr:!0,startsExpr:!0}),eq:new Og("=",{beforeExpr:!0,isAssign:!0}),assign:new Og("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Og("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Og("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Ng("||",1),logicalAND:Ng("&&",2),bitwiseOR:Ng("|",3),bitwiseXOR:Ng("^",4),bitwiseAND:Ng("&",5),equality:Ng("==/!=/===/!==",6),relational:Ng("</>/<=/>=",7),bitShift:Ng("<</>>/>>>",8),plusMin:new Og("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Ng("%",10),star:Ng("*",10),slash:Ng("/",10),starstar:new Og("**",{beforeExpr:!0}),coalesce:Ng("??",1),_break:Bg("break"),_case:Bg("case",Dg),_catch:Bg("catch"),_continue:Bg("continue"),_debugger:Bg("debugger"),_default:Bg("default",Dg),_do:Bg("do",{isLoop:!0,beforeExpr:!0}),_else:Bg("else",Dg),_finally:Bg("finally"),_for:Bg("for",{isLoop:!0}),_function:Bg("function",Rg),_if:Bg("if"),_return:Bg("return",Dg),_switch:Bg("switch"),_throw:Bg("throw",Dg),_try:Bg("try"),_var:Bg("var"),_const:Bg("const"),_while:Bg("while",{isLoop:!0}),_with:Bg("with"),_new:Bg("new",{beforeExpr:!0,startsExpr:!0}),_this:Bg("this",Rg),_super:Bg("super",Rg),_class:Bg("class",Rg),_extends:Bg("extends",Dg),_export:Bg("export"),_import:Bg("import",Rg),_null:Bg("null",Rg),_true:Bg("true",Rg),_false:Bg("false",Rg),_in:Bg("in",{beforeExpr:!0,binop:7}),_instanceof:Bg("instanceof",{beforeExpr:!0,binop:7}),_typeof:Bg("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Bg("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Bg("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},jg=/\r\n?|\n|\u2028|\u2029/,Hg=new RegExp(jg.source,"g");function Ug(e,t){return 10===e||13===e||!t&&(8232===e||8233===e)}var zg=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Wg=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Gg=Object.prototype,$g=Gg.hasOwnProperty,Zg=Gg.toString;function qg(e,t){return $g.call(e,t)}var Kg=Array.isArray||function(e){return"[object Array]"===Zg.call(e)};function Yg(e){return new RegExp("^(?:"+e.replace(/ /g,"|")+")$")}var Xg=function(e,t){this.line=e,this.column=t};Xg.prototype.offset=function(e){return new Xg(this.line,this.column+e)};var Jg=function(e,t,n){this.start=t,this.end=n,null!==e.sourceFile&&(this.source=e.sourceFile)};function Qg(e,t){for(var n=1,i=0;;){Hg.lastIndex=i;var r=Hg.exec(e);if(!(r&&r.index<t))return new Xg(n,t-i);++n,i=r.index+r[0].length}}var ev={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function tv(e){var t={};for(var n in ev)t[n]=e&&qg(e,n)?e[n]:ev[n];if(t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),null==t.allowReserved&&(t.allowReserved=t.ecmaVersion<5),Kg(t.onToken)){var i=t.onToken;t.onToken=function(e){return i.push(e)}}return Kg(t.onComment)&&(t.onComment=function(e,t){return function(n,i,r,s,o,a){var l={type:n?"Block":"Line",value:i,start:r,end:s};e.locations&&(l.loc=new Jg(this,o,a)),e.ranges&&(l.range=[r,s]),t.push(l)}}(t,t.onComment)),t}function nv(e,t){return 2|(e?4:0)|(t?8:0)}var iv=function(e,t,n){this.options=e=tv(e),this.sourceFile=e.sourceFile,this.keywords=Yg(Cg[e.ecmaVersion>=6?6:"module"===e.sourceType?"5module":5]);var i="";if(!0!==e.allowReserved){for(var r=e.ecmaVersion;!(i=wg[r]);r--);"module"===e.sourceType&&(i+=" await")}this.reservedWords=Yg(i);var s=(i?i+" ":"")+wg.strict;this.reservedWordsStrict=Yg(s),this.reservedWordsStrictBind=Yg(s+" "+wg.strictBind),this.input=String(t),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(jg).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=Vg.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===e.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&e.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},rv={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};iv.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)},rv.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},rv.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},rv.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},rv.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},rv.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},rv.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},iv.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},iv.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var n=this,i=0;i<e.length;i++)n=e[i](n);return n},iv.parse=function(e,t){return new this(t,e).parse()},iv.parseExpressionAt=function(e,t,n){var i=new this(n,e,t);return i.nextToken(),i.parseExpression()},iv.tokenizer=function(e,t){return new this(t,e)},Object.defineProperties(iv.prototype,rv);var sv=iv.prototype,ov=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;function av(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}sv.strictDirective=function(e){for(;;){Wg.lastIndex=e,e+=Wg.exec(this.input)[0].length;var t=ov.exec(this.input.slice(e));if(!t)return!1;if("use strict"===(t[1]||t[2])){Wg.lastIndex=e+t[0].length;var n=Wg.exec(this.input),i=n.index+n[0].length,r=this.input.charAt(i);return";"===r||"}"===r||jg.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||"!"===r&&"="===this.input.charAt(i+1))}e+=t[0].length,Wg.lastIndex=e,e+=Wg.exec(this.input)[0].length,";"===this.input[e]&&e++}},sv.eat=function(e){return this.type===e&&(this.next(),!0)},sv.isContextual=function(e){return this.type===Vg.name&&this.value===e&&!this.containsEsc},sv.eatContextual=function(e){return!!this.isContextual(e)&&(this.next(),!0)},sv.expectContextual=function(e){this.eatContextual(e)||this.unexpected()},sv.canInsertSemicolon=function(){return this.type===Vg.eof||this.type===Vg.braceR||jg.test(this.input.slice(this.lastTokEnd,this.start))},sv.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},sv.semicolon=function(){this.eat(Vg.semi)||this.insertSemicolon()||this.unexpected()},sv.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0},sv.expect=function(e){this.eat(e)||this.unexpected()},sv.unexpected=function(e){this.raise(null!=e?e:this.start,"Unexpected token")},sv.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var n=t?e.parenthesizedAssign:e.parenthesizedBind;n>-1&&this.raiseRecoverable(n,"Parenthesized pattern")}},sv.checkExpressionErrors=function(e,t){if(!e)return!1;var n=e.shorthandAssign,i=e.doubleProto;if(!t)return n>=0||i>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")},sv.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},sv.isSimpleAssignTarget=function(e){return"ParenthesizedExpression"===e.type?this.isSimpleAssignTarget(e.expression):"Identifier"===e.type||"MemberExpression"===e.type};var lv=iv.prototype;lv.parseTopLevel=function(e){var t={};for(e.body||(e.body=[]);this.type!==Vg.eof;){var n=this.parseStatement(null,!0,t);e.body.push(n)}if(this.inModule)for(var i=0,r=Object.keys(this.undefinedExports);i<r.length;i+=1){var s=r[i];this.raiseRecoverable(this.undefinedExports[s].start,"Export '"+s+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var cv={kind:"loop"},hv={kind:"switch"};lv.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Wg.lastIndex=this.pos;var t=Wg.exec(this.input),n=this.pos+t[0].length,i=this.input.charCodeAt(n);if(91===i)return!0;if(e)return!1;if(123===i)return!0;if(Ig(i,!0)){for(var r=n+1;_g(this.input.charCodeAt(r),!0);)++r;var s=this.input.slice(n,r);if(!Sg.test(s))return!0}return!1},lv.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Wg.lastIndex=this.pos;var e=Wg.exec(this.input),t=this.pos+e[0].length;return!(jg.test(this.input.slice(this.pos,t))||"function"!==this.input.slice(t,t+8)||t+8!==this.input.length&&_g(this.input.charAt(t+8)))},lv.parseStatement=function(e,t,n){var i,r=this.type,s=this.startNode();switch(this.isLet(e)&&(r=Vg._var,i="let"),r){case Vg._break:case Vg._continue:return this.parseBreakContinueStatement(s,r.keyword);case Vg._debugger:return this.parseDebuggerStatement(s);case Vg._do:return this.parseDoStatement(s);case Vg._for:return this.parseForStatement(s);case Vg._function:return e&&(this.strict||"if"!==e&&"label"!==e)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!e);case Vg._class:return e&&this.unexpected(),this.parseClass(s,!0);case Vg._if:return this.parseIfStatement(s);case Vg._return:return this.parseReturnStatement(s);case Vg._switch:return this.parseSwitchStatement(s);case Vg._throw:return this.parseThrowStatement(s);case Vg._try:return this.parseTryStatement(s);case Vg._const:case Vg._var:return i=i||this.value,e&&"var"!==i&&this.unexpected(),this.parseVarStatement(s,i);case Vg._while:return this.parseWhileStatement(s);case Vg._with:return this.parseWithStatement(s);case Vg.braceL:return this.parseBlock(!0,s);case Vg.semi:return this.parseEmptyStatement(s);case Vg._export:case Vg._import:if(this.options.ecmaVersion>10&&r===Vg._import){Wg.lastIndex=this.pos;var o=Wg.exec(this.input),a=this.pos+o[0].length,l=this.input.charCodeAt(a);if(40===l||46===l)return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),r===Vg._import?this.parseImport(s):this.parseExport(s,n);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!e);var c=this.value,h=this.parseExpression();return r===Vg.name&&"Identifier"===h.type&&this.eat(Vg.colon)?this.parseLabeledStatement(s,c,h,e):this.parseExpressionStatement(s,h)}},lv.parseBreakContinueStatement=function(e,t){var n="break"===t;this.next(),this.eat(Vg.semi)||this.insertSemicolon()?e.label=null:this.type!==Vg.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var r=this.labels[i];if(null==e.label||r.name===e.label.name){if(null!=r.kind&&(n||"loop"===r.kind))break;if(e.label&&n)break}}return i===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,n?"BreakStatement":"ContinueStatement")},lv.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")},lv.parseDoStatement=function(e){return this.next(),this.labels.push(cv),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(Vg._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(Vg.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")},lv.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(cv),this.enterScope(0),this.expect(Vg.parenL),this.type===Vg.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var n=this.isLet();if(this.type===Vg._var||this.type===Vg._const||n){var i=this.startNode(),r=n?"let":this.value;return this.next(),this.parseVar(i,!0,r),this.finishNode(i,"VariableDeclaration"),(this.type===Vg._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===i.declarations.length?(this.options.ecmaVersion>=9&&(this.type===Vg._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,i)):(t>-1&&this.unexpected(t),this.parseFor(e,i))}var s=new av,o=this.parseExpression(!0,s);return this.type===Vg._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===Vg._in?t>-1&&this.unexpected(t):e.await=t>-1),this.toAssignable(o,!1,s),this.checkLVal(o),this.parseForIn(e,o)):(this.checkExpressionErrors(s,!0),t>-1&&this.unexpected(t),this.parseFor(e,o))},lv.parseFunctionStatement=function(e,t,n){return this.next(),this.parseFunction(e,dv|(n?0:pv),!1,t)},lv.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(Vg._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")},lv.parseReturnStatement=function(e){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(Vg.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")},lv.parseSwitchStatement=function(e){var t;this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(Vg.braceL),this.labels.push(hv),this.enterScope(0);for(var n=!1;this.type!==Vg.braceR;)if(this.type===Vg._case||this.type===Vg._default){var i=this.type===Vg._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),i?t.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,t.test=null),this.expect(Vg.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")},lv.parseThrowStatement=function(e){return this.next(),jg.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var uv=[];lv.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===Vg._catch){var t=this.startNode();if(this.next(),this.eat(Vg.parenL)){t.param=this.parseBindingAtom();var n="Identifier"===t.param.type;this.enterScope(n?32:0),this.checkLVal(t.param,n?4:2),this.expect(Vg.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0);t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(Vg._finally)?this.parseBlock():null,e.handler||e.finalizer||this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")},lv.parseVarStatement=function(e,t){return this.next(),this.parseVar(e,!1,t),this.semicolon(),this.finishNode(e,"VariableDeclaration")},lv.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(cv),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")},lv.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")},lv.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")},lv.parseLabeledStatement=function(e,t,n,i){for(var r=0,s=this.labels;r<s.length;r+=1){s[r].name===t&&this.raise(n.start,"Label '"+t+"' is already declared")}for(var o=this.type.isLoop?"loop":this.type===Vg._switch?"switch":null,a=this.labels.length-1;a>=0;a--){var l=this.labels[a];if(l.statementStart!==e.start)break;l.statementStart=this.start,l.kind=o}return this.labels.push({name:t,kind:o,statementStart:this.start}),e.body=this.parseStatement(i?-1===i.indexOf("label")?i+"label":i:"label"),this.labels.pop(),e.label=n,this.finishNode(e,"LabeledStatement")},lv.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")},lv.parseBlock=function(e,t,n){for(void 0===e&&(e=!0),void 0===t&&(t=this.startNode()),t.body=[],this.expect(Vg.braceL),e&&this.enterScope(0);this.type!==Vg.braceR;){var i=this.parseStatement(null);t.body.push(i)}return n&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")},lv.parseFor=function(e,t){return e.init=t,this.expect(Vg.semi),e.test=this.type===Vg.semi?null:this.parseExpression(),this.expect(Vg.semi),e.update=this.type===Vg.parenR?null:this.parseExpression(),this.expect(Vg.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")},lv.parseForIn=function(e,t){var n=this.type===Vg._in;return this.next(),"VariableDeclaration"===t.type&&null!=t.declarations[0].init&&(!n||this.options.ecmaVersion<8||this.strict||"var"!==t.kind||"Identifier"!==t.declarations[0].id.type)?this.raise(t.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===t.type&&this.raise(t.start,"Invalid left-hand side in for-loop"),e.left=t,e.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(Vg.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,n?"ForInStatement":"ForOfStatement")},lv.parseVar=function(e,t,n){for(e.declarations=[],e.kind=n;;){var i=this.startNode();if(this.parseVarId(i,n),this.eat(Vg.eq)?i.init=this.parseMaybeAssign(t):"const"!==n||this.type===Vg._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===i.id.type||t&&(this.type===Vg._in||this.isContextual("of"))?i.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),e.declarations.push(this.finishNode(i,"VariableDeclarator")),!this.eat(Vg.comma))break}return e},lv.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLVal(e.id,"var"===t?1:2,!1)};var dv=1,pv=2;lv.parseFunction=function(e,t,n,i){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===Vg.star&&t&pv&&this.unexpected(),e.generator=this.eat(Vg.star)),this.options.ecmaVersion>=8&&(e.async=!!i),t&dv&&(e.id=4&t&&this.type!==Vg.name?null:this.parseIdent(),!e.id||t&pv||this.checkLVal(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?1:2:3));var r=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(nv(e.async,e.generator)),t&dv||(e.id=this.type===Vg.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,n,!1),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(e,t&dv?"FunctionDeclaration":"FunctionExpression")},lv.parseFunctionParams=function(e){this.expect(Vg.parenL),e.params=this.parseBindingList(Vg.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},lv.parseClass=function(e,t){this.next();var n=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var i=this.startNode(),r=!1;for(i.body=[],this.expect(Vg.braceL);this.type!==Vg.braceR;){var s=this.parseClassElement(null!==e.superClass);s&&(i.body.push(s),"MethodDefinition"===s.type&&"constructor"===s.kind&&(r&&this.raise(s.start,"Duplicate constructor in the same class"),r=!0))}return this.strict=n,this.next(),e.body=this.finishNode(i,"ClassBody"),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},lv.parseClassElement=function(e){var t=this;if(this.eat(Vg.semi))return null;var n=this.startNode(),i=function(e,i){void 0===i&&(i=!1);var r=t.start,s=t.startLoc;return!!t.eatContextual(e)&&(!(t.type===Vg.parenL||i&&t.canInsertSemicolon())||(n.key&&t.unexpected(),n.computed=!1,n.key=t.startNodeAt(r,s),n.key.name=e,t.finishNode(n.key,"Identifier"),!1))};n.kind="method",n.static=i("static");var r=this.eat(Vg.star),s=!1;r||(this.options.ecmaVersion>=8&&i("async",!0)?(s=!0,r=this.options.ecmaVersion>=9&&this.eat(Vg.star)):i("get")?n.kind="get":i("set")&&(n.kind="set")),n.key||this.parsePropertyName(n);var o=n.key,a=!1;return n.computed||n.static||!("Identifier"===o.type&&"constructor"===o.name||"Literal"===o.type&&"constructor"===o.value)?n.static&&"Identifier"===o.type&&"prototype"===o.name&&this.raise(o.start,"Classes may not have a static property named prototype"):("method"!==n.kind&&this.raise(o.start,"Constructor can't have get/set modifier"),r&&this.raise(o.start,"Constructor can't be a generator"),s&&this.raise(o.start,"Constructor can't be an async method"),n.kind="constructor",a=e),this.parseClassMethod(n,r,s,a),"get"===n.kind&&0!==n.value.params.length&&this.raiseRecoverable(n.value.start,"getter should have no params"),"set"===n.kind&&1!==n.value.params.length&&this.raiseRecoverable(n.value.start,"setter should have exactly one param"),"set"===n.kind&&"RestElement"===n.value.params[0].type&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params"),n},lv.parseClassMethod=function(e,t,n,i){return e.value=this.parseMethod(t,n,i),this.finishNode(e,"MethodDefinition")},lv.parseClassId=function(e,t){this.type===Vg.name?(e.id=this.parseIdent(),t&&this.checkLVal(e.id,2,!1)):(!0===t&&this.unexpected(),e.id=null)},lv.parseClassSuper=function(e){e.superClass=this.eat(Vg._extends)?this.parseExprSubscripts():null},lv.parseExport=function(e,t){if(this.next(),this.eat(Vg.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseIdent(!0),this.checkExport(t,e.exported.name,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==Vg.string&&this.unexpected(),e.source=this.parseExprAtom(),this.semicolon(),this.finishNode(e,"ExportAllDeclaration");if(this.eat(Vg._default)){var n;if(this.checkExport(t,"default",this.lastTokStart),this.type===Vg._function||(n=this.isAsyncFunction())){var i=this.startNode();this.next(),n&&this.next(),e.declaration=this.parseFunction(i,4|dv,!1,n)}else if(this.type===Vg._class){var r=this.startNode();e.declaration=this.parseClass(r,"nullableID")}else e.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(e,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())e.declaration=this.parseStatement(null),"VariableDeclaration"===e.declaration.type?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id.name,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==Vg.string&&this.unexpected(),e.source=this.parseExprAtom();else{for(var s=0,o=e.specifiers;s<o.length;s+=1){var a=o[s];this.checkUnreserved(a.local),this.checkLocalExport(a.local)}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")},lv.checkExport=function(e,t,n){e&&(qg(e,t)&&this.raiseRecoverable(n,"Duplicate export '"+t+"'"),e[t]=!0)},lv.checkPatternExport=function(e,t){var n=t.type;if("Identifier"===n)this.checkExport(e,t.name,t.start);else if("ObjectPattern"===n)for(var i=0,r=t.properties;i<r.length;i+=1){var s=r[i];this.checkPatternExport(e,s)}else if("ArrayPattern"===n)for(var o=0,a=t.elements;o<a.length;o+=1){var l=a[o];l&&this.checkPatternExport(e,l)}else"Property"===n?this.checkPatternExport(e,t.value):"AssignmentPattern"===n?this.checkPatternExport(e,t.left):"RestElement"===n?this.checkPatternExport(e,t.argument):"ParenthesizedExpression"===n&&this.checkPatternExport(e,t.expression)},lv.checkVariableExport=function(e,t){if(e)for(var n=0,i=t;n<i.length;n+=1){var r=i[n];this.checkPatternExport(e,r.id)}},lv.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},lv.parseExportSpecifiers=function(e){var t=[],n=!0;for(this.expect(Vg.braceL);!this.eat(Vg.braceR);){if(n)n=!1;else if(this.expect(Vg.comma),this.afterTrailingComma(Vg.braceR))break;var i=this.startNode();i.local=this.parseIdent(!0),i.exported=this.eatContextual("as")?this.parseIdent(!0):i.local,this.checkExport(e,i.exported.name,i.exported.start),t.push(this.finishNode(i,"ExportSpecifier"))}return t},lv.parseImport=function(e){return this.next(),this.type===Vg.string?(e.specifiers=uv,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===Vg.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(e,"ImportDeclaration")},lv.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===Vg.name){var n=this.startNode();if(n.local=this.parseIdent(),this.checkLVal(n.local,2),e.push(this.finishNode(n,"ImportDefaultSpecifier")),!this.eat(Vg.comma))return e}if(this.type===Vg.star){var i=this.startNode();return this.next(),this.expectContextual("as"),i.local=this.parseIdent(),this.checkLVal(i.local,2),e.push(this.finishNode(i,"ImportNamespaceSpecifier")),e}for(this.expect(Vg.braceL);!this.eat(Vg.braceR);){if(t)t=!1;else if(this.expect(Vg.comma),this.afterTrailingComma(Vg.braceR))break;var r=this.startNode();r.imported=this.parseIdent(!0),this.eatContextual("as")?r.local=this.parseIdent():(this.checkUnreserved(r.imported),r.local=r.imported),this.checkLVal(r.local,2),e.push(this.finishNode(r,"ImportSpecifier"))}return e},lv.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)},lv.isDirectiveCandidate=function(e){return"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"string"==typeof e.expression.value&&('"'===this.input[e.start]||"'"===this.input[e.start])};var fv=iv.prototype;fv.toAssignable=function(e,t,n){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&"await"===e.name&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.toAssignable(s,t),"RestElement"!==s.type||"ArrayPattern"!==s.argument.type&&"ObjectPattern"!==s.argument.type||this.raise(s.argument.start,"Unexpected token")}break;case"Property":"init"!==e.kind&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),"AssignmentPattern"===e.argument.type&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==e.operator&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,n);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return e},fv.toAssignableList=function(e,t){for(var n=e.length,i=0;i<n;i++){var r=e[i];r&&this.toAssignable(r,t)}if(n){var s=e[n-1];6===this.options.ecmaVersion&&t&&s&&"RestElement"===s.type&&"Identifier"!==s.argument.type&&this.unexpected(s.argument.start)}return e},fv.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")},fv.parseRestBinding=function(){var e=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==Vg.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")},fv.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case Vg.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(Vg.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case Vg.braceL:return this.parseObj(!0)}return this.parseIdent()},fv.parseBindingList=function(e,t,n){for(var i=[],r=!0;!this.eat(e);)if(r?r=!1:this.expect(Vg.comma),t&&this.type===Vg.comma)i.push(null);else{if(n&&this.afterTrailingComma(e))break;if(this.type===Vg.ellipsis){var s=this.parseRestBinding();this.parseBindingListItem(s),i.push(s),this.type===Vg.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}var o=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(o),i.push(o)}return i},fv.parseBindingListItem=function(e){return e},fv.parseMaybeDefault=function(e,t,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(Vg.eq))return n;var i=this.startNodeAt(e,t);return i.left=n,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")},fv.checkLVal=function(e,t,n){switch(void 0===t&&(t=0),e.type){case"Identifier":2===t&&"let"===e.name&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(t?"Binding ":"Assigning to ")+e.name+" in strict mode"),n&&(qg(n,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),n[e.name]=!0),0!==t&&5!==t&&this.declareName(e.name,t,e.start);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":t&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ObjectPattern":for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.checkLVal(s,t,n)}break;case"Property":this.checkLVal(e.value,t,n);break;case"ArrayPattern":for(var o=0,a=e.elements;o<a.length;o+=1){var l=a[o];l&&this.checkLVal(l,t,n)}break;case"AssignmentPattern":this.checkLVal(e.left,t,n);break;case"RestElement":this.checkLVal(e.argument,t,n);break;case"ParenthesizedExpression":this.checkLVal(e.expression,t,n);break;default:this.raise(e.start,(t?"Binding":"Assigning to")+" rvalue")}};var mv=iv.prototype;mv.checkPropClash=function(e,t,n){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===e.type||this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var i,r=e.key;switch(r.type){case"Identifier":i=r.name;break;case"Literal":i=String(r.value);break;default:return}var s=e.kind;if(this.options.ecmaVersion>=6)"__proto__"===i&&"init"===s&&(t.proto&&(n?n.doubleProto<0&&(n.doubleProto=r.start):this.raiseRecoverable(r.start,"Redefinition of __proto__ property")),t.proto=!0);else{var o=t[i="$"+i];if(o)("init"===s?this.strict&&o.init||o.get||o.set:o.init||o[s])&&this.raiseRecoverable(r.start,"Redefinition of property");else o=t[i]={init:!1,get:!1,set:!1};o[s]=!0}}},mv.parseExpression=function(e,t){var n=this.start,i=this.startLoc,r=this.parseMaybeAssign(e,t);if(this.type===Vg.comma){var s=this.startNodeAt(n,i);for(s.expressions=[r];this.eat(Vg.comma);)s.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(s,"SequenceExpression")}return r},mv.parseMaybeAssign=function(e,t,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var i=!1,r=-1,s=-1;t?(r=t.parenthesizedAssign,s=t.trailingComma,t.parenthesizedAssign=t.trailingComma=-1):(t=new av,i=!0);var o=this.start,a=this.startLoc;this.type!==Vg.parenL&&this.type!==Vg.name||(this.potentialArrowAt=this.start);var l=this.parseMaybeConditional(e,t);if(n&&(l=n.call(this,l,o,a)),this.type.isAssign){var c=this.startNodeAt(o,a);return c.operator=this.value,c.left=this.type===Vg.eq?this.toAssignable(l,!1,t):l,i||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=c.left.start&&(t.shorthandAssign=-1),this.checkLVal(l),this.next(),c.right=this.parseMaybeAssign(e),this.finishNode(c,"AssignmentExpression")}return i&&this.checkExpressionErrors(t,!0),r>-1&&(t.parenthesizedAssign=r),s>-1&&(t.trailingComma=s),l},mv.parseMaybeConditional=function(e,t){var n=this.start,i=this.startLoc,r=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return r;if(this.eat(Vg.question)){var s=this.startNodeAt(n,i);return s.test=r,s.consequent=this.parseMaybeAssign(),this.expect(Vg.colon),s.alternate=this.parseMaybeAssign(e),this.finishNode(s,"ConditionalExpression")}return r},mv.parseExprOps=function(e,t){var n=this.start,i=this.startLoc,r=this.parseMaybeUnary(t,!1);return this.checkExpressionErrors(t)||r.start===n&&"ArrowFunctionExpression"===r.type?r:this.parseExprOp(r,n,i,-1,e)},mv.parseExprOp=function(e,t,n,i,r){var s=this.type.binop;if(null!=s&&(!r||this.type!==Vg._in)&&s>i){var o=this.type===Vg.logicalOR||this.type===Vg.logicalAND,a=this.type===Vg.coalesce;a&&(s=Vg.logicalAND.binop);var l=this.value;this.next();var c=this.start,h=this.startLoc,u=this.parseExprOp(this.parseMaybeUnary(null,!1),c,h,s,r),d=this.buildBinary(t,n,e,u,l,o||a);return(o&&this.type===Vg.coalesce||a&&(this.type===Vg.logicalOR||this.type===Vg.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(d,t,n,i,r)}return e},mv.buildBinary=function(e,t,n,i,r,s){var o=this.startNodeAt(e,t);return o.left=n,o.operator=r,o.right=i,this.finishNode(o,s?"LogicalExpression":"BinaryExpression")},mv.parseMaybeUnary=function(e,t){var n,i=this.start,r=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))n=this.parseAwait(),t=!0;else if(this.type.prefix){var s=this.startNode(),o=this.type===Vg.incDec;s.operator=this.value,s.prefix=!0,this.next(),s.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(e,!0),o?this.checkLVal(s.argument):this.strict&&"delete"===s.operator&&"Identifier"===s.argument.type?this.raiseRecoverable(s.start,"Deleting local variable in strict mode"):t=!0,n=this.finishNode(s,o?"UpdateExpression":"UnaryExpression")}else{if(n=this.parseExprSubscripts(e),this.checkExpressionErrors(e))return n;for(;this.type.postfix&&!this.canInsertSemicolon();){var a=this.startNodeAt(i,r);a.operator=this.value,a.prefix=!1,a.argument=n,this.checkLVal(n),this.next(),n=this.finishNode(a,"UpdateExpression")}}return!t&&this.eat(Vg.starstar)?this.buildBinary(i,r,n,this.parseMaybeUnary(null,!1),"**",!1):n},mv.parseExprSubscripts=function(e){var t=this.start,n=this.startLoc,i=this.parseExprAtom(e);if("ArrowFunctionExpression"===i.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return i;var r=this.parseSubscripts(i,t,n);return e&&"MemberExpression"===r.type&&(e.parenthesizedAssign>=r.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=r.start&&(e.parenthesizedBind=-1)),r},mv.parseSubscripts=function(e,t,n,i){for(var r=this.options.ecmaVersion>=8&&"Identifier"===e.type&&"async"===e.name&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,s=!1;;){var o=this.parseSubscript(e,t,n,i,r,s);if(o.optional&&(s=!0),o===e||"ArrowFunctionExpression"===o.type){if(s){var a=this.startNodeAt(t,n);a.expression=o,o=this.finishNode(a,"ChainExpression")}return o}e=o}},mv.parseSubscript=function(e,t,n,i,r,s){var o=this.options.ecmaVersion>=11,a=o&&this.eat(Vg.questionDot);i&&a&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var l=this.eat(Vg.bracketL);if(l||a&&this.type!==Vg.parenL&&this.type!==Vg.backQuote||this.eat(Vg.dot)){var c=this.startNodeAt(t,n);c.object=e,c.property=l?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),c.computed=!!l,l&&this.expect(Vg.bracketR),o&&(c.optional=a),e=this.finishNode(c,"MemberExpression")}else if(!i&&this.eat(Vg.parenL)){var h=new av,u=this.yieldPos,d=this.awaitPos,p=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var f=this.parseExprList(Vg.parenR,this.options.ecmaVersion>=8,!1,h);if(r&&!a&&!this.canInsertSemicolon()&&this.eat(Vg.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=u,this.awaitPos=d,this.awaitIdentPos=p,this.parseArrowExpression(this.startNodeAt(t,n),f,!0);this.checkExpressionErrors(h,!0),this.yieldPos=u||this.yieldPos,this.awaitPos=d||this.awaitPos,this.awaitIdentPos=p||this.awaitIdentPos;var m=this.startNodeAt(t,n);m.callee=e,m.arguments=f,o&&(m.optional=a),e=this.finishNode(m,"CallExpression")}else if(this.type===Vg.backQuote){(a||s)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var g=this.startNodeAt(t,n);g.tag=e,g.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(g,"TaggedTemplateExpression")}return e},mv.parseExprAtom=function(e){this.type===Vg.slash&&this.readRegexp();var t,n=this.potentialArrowAt===this.start;switch(this.type){case Vg._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),t=this.startNode(),this.next(),this.type!==Vg.parenL||this.allowDirectSuper||this.raise(t.start,"super() call outside constructor of a subclass"),this.type!==Vg.dot&&this.type!==Vg.bracketL&&this.type!==Vg.parenL&&this.unexpected(),this.finishNode(t,"Super");case Vg._this:return t=this.startNode(),this.next(),this.finishNode(t,"ThisExpression");case Vg.name:var i=this.start,r=this.startLoc,s=this.containsEsc,o=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!s&&"async"===o.name&&!this.canInsertSemicolon()&&this.eat(Vg._function))return this.parseFunction(this.startNodeAt(i,r),0,!1,!0);if(n&&!this.canInsertSemicolon()){if(this.eat(Vg.arrow))return this.parseArrowExpression(this.startNodeAt(i,r),[o],!1);if(this.options.ecmaVersion>=8&&"async"===o.name&&this.type===Vg.name&&!s)return o=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(Vg.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(i,r),[o],!0)}return o;case Vg.regexp:var a=this.value;return(t=this.parseLiteral(a.value)).regex={pattern:a.pattern,flags:a.flags},t;case Vg.num:case Vg.string:return this.parseLiteral(this.value);case Vg._null:case Vg._true:case Vg._false:return(t=this.startNode()).value=this.type===Vg._null?null:this.type===Vg._true,t.raw=this.type.keyword,this.next(),this.finishNode(t,"Literal");case Vg.parenL:var l=this.start,c=this.parseParenAndDistinguishExpression(n);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(c)&&(e.parenthesizedAssign=l),e.parenthesizedBind<0&&(e.parenthesizedBind=l)),c;case Vg.bracketL:return t=this.startNode(),this.next(),t.elements=this.parseExprList(Vg.bracketR,!0,!0,e),this.finishNode(t,"ArrayExpression");case Vg.braceL:return this.parseObj(!1,e);case Vg._function:return t=this.startNode(),this.next(),this.parseFunction(t,0);case Vg._class:return this.parseClass(this.startNode(),!1);case Vg._new:return this.parseNew();case Vg.backQuote:return this.parseTemplate();case Vg._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},mv.parseExprImport=function(){var e=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var t=this.parseIdent(!0);switch(this.type){case Vg.parenL:return this.parseDynamicImport(e);case Vg.dot:return e.meta=t,this.parseImportMeta(e);default:this.unexpected()}},mv.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),!this.eat(Vg.parenR)){var t=this.start;this.eat(Vg.comma)&&this.eat(Vg.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")},mv.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),"meta"!==e.property.name&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),"module"!==this.options.sourceType&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")},mv.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),110===t.raw.charCodeAt(t.raw.length-1)&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")},mv.parseParenExpression=function(){this.expect(Vg.parenL);var e=this.parseExpression();return this.expect(Vg.parenR),e},mv.parseParenAndDistinguishExpression=function(e){var t,n=this.start,i=this.startLoc,r=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var s,o=this.start,a=this.startLoc,l=[],c=!0,h=!1,u=new av,d=this.yieldPos,p=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==Vg.parenR;){if(c?c=!1:this.expect(Vg.comma),r&&this.afterTrailingComma(Vg.parenR,!0)){h=!0;break}if(this.type===Vg.ellipsis){s=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===Vg.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}l.push(this.parseMaybeAssign(!1,u,this.parseParenItem))}var f=this.start,m=this.startLoc;if(this.expect(Vg.parenR),e&&!this.canInsertSemicolon()&&this.eat(Vg.arrow))return this.checkPatternErrors(u,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=d,this.awaitPos=p,this.parseParenArrowList(n,i,l);l.length&&!h||this.unexpected(this.lastTokStart),s&&this.unexpected(s),this.checkExpressionErrors(u,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=p||this.awaitPos,l.length>1?((t=this.startNodeAt(o,a)).expressions=l,this.finishNodeAt(t,"SequenceExpression",f,m)):t=l[0]}else t=this.parseParenExpression();if(this.options.preserveParens){var g=this.startNodeAt(n,i);return g.expression=t,this.finishNode(g,"ParenthesizedExpression")}return t},mv.parseParenItem=function(e){return e},mv.parseParenArrowList=function(e,t,n){return this.parseArrowExpression(this.startNodeAt(e,t),n)};var gv=[];mv.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode(),t=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(Vg.dot)){e.meta=t;var n=this.containsEsc;return e.property=this.parseIdent(!0),"target"!==e.property.name&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(e.start,"'new.target' can only be used in functions"),this.finishNode(e,"MetaProperty")}var i=this.start,r=this.startLoc,s=this.type===Vg._import;return e.callee=this.parseSubscripts(this.parseExprAtom(),i,r,!0),s&&"ImportExpression"===e.callee.type&&this.raise(i,"Cannot use new with import()"),this.eat(Vg.parenL)?e.arguments=this.parseExprList(Vg.parenR,this.options.ecmaVersion>=8,!1):e.arguments=gv,this.finishNode(e,"NewExpression")},mv.parseTemplateElement=function(e){var t=e.isTagged,n=this.startNode();return this.type===Vg.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===Vg.backQuote,this.finishNode(n,"TemplateElement")},mv.parseTemplate=function(e){void 0===e&&(e={});var t=e.isTagged;void 0===t&&(t=!1);var n=this.startNode();this.next(),n.expressions=[];var i=this.parseTemplateElement({isTagged:t});for(n.quasis=[i];!i.tail;)this.type===Vg.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(Vg.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(Vg.braceR),n.quasis.push(i=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(n,"TemplateLiteral")},mv.isAsyncProp=function(e){return!e.computed&&"Identifier"===e.key.type&&"async"===e.key.name&&(this.type===Vg.name||this.type===Vg.num||this.type===Vg.string||this.type===Vg.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===Vg.star)&&!jg.test(this.input.slice(this.lastTokEnd,this.start))},mv.parseObj=function(e,t){var n=this.startNode(),i=!0,r={};for(n.properties=[],this.next();!this.eat(Vg.braceR);){if(i)i=!1;else if(this.expect(Vg.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(Vg.braceR))break;var s=this.parseProperty(e,t);e||this.checkPropClash(s,r,t),n.properties.push(s)}return this.finishNode(n,e?"ObjectPattern":"ObjectExpression")},mv.parseProperty=function(e,t){var n,i,r,s,o=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(Vg.ellipsis))return e?(o.argument=this.parseIdent(!1),this.type===Vg.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(o,"RestElement")):(this.type===Vg.parenL&&t&&(t.parenthesizedAssign<0&&(t.parenthesizedAssign=this.start),t.parenthesizedBind<0&&(t.parenthesizedBind=this.start)),o.argument=this.parseMaybeAssign(!1,t),this.type===Vg.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(o,"SpreadElement"));this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(e||t)&&(r=this.start,s=this.startLoc),e||(n=this.eat(Vg.star)));var a=this.containsEsc;return this.parsePropertyName(o),!e&&!a&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(o)?(i=!0,n=this.options.ecmaVersion>=9&&this.eat(Vg.star),this.parsePropertyName(o,t)):i=!1,this.parsePropertyValue(o,e,n,i,r,s,t,a),this.finishNode(o,"Property")},mv.parsePropertyValue=function(e,t,n,i,r,s,o,a){if((n||i)&&this.type===Vg.colon&&this.unexpected(),this.eat(Vg.colon))e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),e.kind="init";else if(this.options.ecmaVersion>=6&&this.type===Vg.parenL)t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(n,i);else if(t||a||!(this.options.ecmaVersion>=5)||e.computed||"Identifier"!==e.key.type||"get"!==e.key.name&&"set"!==e.key.name||this.type===Vg.comma||this.type===Vg.braceR||this.type===Vg.eq)this.options.ecmaVersion>=6&&!e.computed&&"Identifier"===e.key.type?((n||i)&&this.unexpected(),this.checkUnreserved(e.key),"await"!==e.key.name||this.awaitIdentPos||(this.awaitIdentPos=r),e.kind="init",t?e.value=this.parseMaybeDefault(r,s,e.key):this.type===Vg.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),e.value=this.parseMaybeDefault(r,s,e.key)):e.value=e.key,e.shorthand=!0):this.unexpected();else{(n||i)&&this.unexpected(),e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var l="get"===e.kind?0:1;if(e.value.params.length!==l){var c=e.value.start;"get"===e.kind?this.raiseRecoverable(c,"getter should have no params"):this.raiseRecoverable(c,"setter should have exactly one param")}else"set"===e.kind&&"RestElement"===e.value.params[0].type&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")}},mv.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(Vg.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(Vg.bracketR),e.key;e.computed=!1}return e.key=this.type===Vg.num||this.type===Vg.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},mv.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)},mv.parseMethod=function(e,t,n){var i=this.startNode(),r=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=e),this.options.ecmaVersion>=8&&(i.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|nv(t,i.generator)|(n?128:0)),this.expect(Vg.parenL),i.params=this.parseBindingList(Vg.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(i,"FunctionExpression")},mv.parseArrowExpression=function(e,t,n){var i=this.yieldPos,r=this.awaitPos,s=this.awaitIdentPos;return this.enterScope(16|nv(n,!1)),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1),this.yieldPos=i,this.awaitPos=r,this.awaitIdentPos=s,this.finishNode(e,"ArrowFunctionExpression")},mv.parseFunctionBody=function(e,t,n){var i=t&&this.type!==Vg.braceL,r=this.strict,s=!1;if(i)e.body=this.parseMaybeAssign(),e.expression=!0,this.checkParams(e,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);r&&!o||(s=this.strictDirective(this.end))&&o&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list");var a=this.labels;this.labels=[],s&&(this.strict=!0),this.checkParams(e,!r&&!s&&!t&&!n&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLVal(e.id,5),e.body=this.parseBlock(!1,void 0,s&&!r),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=a}this.exitScope()},mv.isSimpleParamList=function(e){for(var t=0,n=e;t<n.length;t+=1){if("Identifier"!==n[t].type)return!1}return!0},mv.checkParams=function(e,t){for(var n={},i=0,r=e.params;i<r.length;i+=1){var s=r[i];this.checkLVal(s,1,t?null:n)}},mv.parseExprList=function(e,t,n,i){for(var r=[],s=!0;!this.eat(e);){if(s)s=!1;else if(this.expect(Vg.comma),t&&this.afterTrailingComma(e))break;var o=void 0;n&&this.type===Vg.comma?o=null:this.type===Vg.ellipsis?(o=this.parseSpread(i),i&&this.type===Vg.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):o=this.parseMaybeAssign(!1,i),r.push(o)}return r},mv.checkUnreserved=function(e){var t=e.start,n=e.end,i=e.name;(this.inGenerator&&"yield"===i&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===i&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(i)&&this.raise(t,"Unexpected keyword '"+i+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(t,n).indexOf("\\"))||(this.strict?this.reservedWordsStrict:this.reservedWords).test(i)&&(this.inAsync||"await"!==i||this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+i+"' is reserved"))},mv.parseIdent=function(e,t){var n=this.startNode();return this.type===Vg.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,"class"!==n.name&&"function"!==n.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop()):this.unexpected(),this.next(!!e),this.finishNode(n,"Identifier"),e||(this.checkUnreserved(n),"await"!==n.name||this.awaitIdentPos||(this.awaitIdentPos=n.start)),n},mv.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===Vg.semi||this.canInsertSemicolon()||this.type!==Vg.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(Vg.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")},mv.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!1),this.finishNode(e,"AwaitExpression")};var vv=iv.prototype;vv.raise=function(e,t){var n=Qg(this.input,e);t+=" ("+n.line+":"+n.column+")";var i=new SyntaxError(t);throw i.pos=e,i.loc=n,i.raisedAt=this.pos,i},vv.raiseRecoverable=vv.raise,vv.curPosition=function(){if(this.options.locations)return new Xg(this.curLine,this.pos-this.lineStart)};var yv=iv.prototype,bv=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[]};yv.enterScope=function(e){this.scopeStack.push(new bv(e))},yv.exitScope=function(){this.scopeStack.pop()},yv.treatFunctionsAsVarInScope=function(e){return 2&e.flags||!this.inModule&&1&e.flags},yv.declareName=function(e,t,n){var i=!1;if(2===t){var r=this.currentScope();i=r.lexical.indexOf(e)>-1||r.functions.indexOf(e)>-1||r.var.indexOf(e)>-1,r.lexical.push(e),this.inModule&&1&r.flags&&delete this.undefinedExports[e]}else if(4===t){this.currentScope().lexical.push(e)}else if(3===t){var s=this.currentScope();i=this.treatFunctionsAsVar?s.lexical.indexOf(e)>-1:s.lexical.indexOf(e)>-1||s.var.indexOf(e)>-1,s.functions.push(e)}else for(var o=this.scopeStack.length-1;o>=0;--o){var a=this.scopeStack[o];if(a.lexical.indexOf(e)>-1&&!(32&a.flags&&a.lexical[0]===e)||!this.treatFunctionsAsVarInScope(a)&&a.functions.indexOf(e)>-1){i=!0;break}if(a.var.push(e),this.inModule&&1&a.flags&&delete this.undefinedExports[e],3&a.flags)break}i&&this.raiseRecoverable(n,"Identifier '"+e+"' has already been declared")},yv.checkLocalExport=function(e){-1===this.scopeStack[0].lexical.indexOf(e.name)&&-1===this.scopeStack[0].var.indexOf(e.name)&&(this.undefinedExports[e.name]=e)},yv.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},yv.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(3&t.flags)return t}},yv.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(3&t.flags&&!(16&t.flags))return t}};var wv=function(e,t,n){this.type="",this.start=t,this.end=0,e.options.locations&&(this.loc=new Jg(e,n)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[t,0])},xv=iv.prototype;function Cv(e,t,n,i){return e.type=t,e.end=n,this.options.locations&&(e.loc.end=i),this.options.ranges&&(e.range[1]=n),e}xv.startNode=function(){return new wv(this,this.start,this.startLoc)},xv.startNodeAt=function(e,t){return new wv(this,e,t)},xv.finishNode=function(e,t){return Cv.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)},xv.finishNodeAt=function(e,t,n,i){return Cv.call(this,e,t,n,i)};var Sv=function(e,t,n,i,r){this.token=e,this.isExpr=!!t,this.preserveSpace=!!n,this.override=i,this.generator=!!r},kv={b_stat:new Sv("{",!1),b_expr:new Sv("{",!0),b_tmpl:new Sv("${",!1),p_stat:new Sv("(",!1),p_expr:new Sv("(",!0),q_tmpl:new Sv("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new Sv("function",!1),f_expr:new Sv("function",!0),f_expr_gen:new Sv("function",!0,!1,null,!0),f_gen:new Sv("function",!1,!1,null,!0)},Lv=iv.prototype;Lv.initialContext=function(){return[kv.b_stat]},Lv.braceIsBlock=function(e){var t=this.curContext();return t===kv.f_expr||t===kv.f_stat||(e!==Vg.colon||t!==kv.b_stat&&t!==kv.b_expr?e===Vg._return||e===Vg.name&&this.exprAllowed?jg.test(this.input.slice(this.lastTokEnd,this.start)):e===Vg._else||e===Vg.semi||e===Vg.eof||e===Vg.parenR||e===Vg.arrow||(e===Vg.braceL?t===kv.b_stat:e!==Vg._var&&e!==Vg._const&&e!==Vg.name&&!this.exprAllowed):!t.isExpr)},Lv.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if("function"===t.token)return t.generator}return!1},Lv.updateContext=function(e){var t,n=this.type;n.keyword&&e===Vg.dot?this.exprAllowed=!1:(t=n.updateContext)?t.call(this,e):this.exprAllowed=n.beforeExpr},Vg.parenR.updateContext=Vg.braceR.updateContext=function(){if(1!==this.context.length){var e=this.context.pop();e===kv.b_stat&&"function"===this.curContext().token&&(e=this.context.pop()),this.exprAllowed=!e.isExpr}else this.exprAllowed=!0},Vg.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?kv.b_stat:kv.b_expr),this.exprAllowed=!0},Vg.dollarBraceL.updateContext=function(){this.context.push(kv.b_tmpl),this.exprAllowed=!0},Vg.parenL.updateContext=function(e){var t=e===Vg._if||e===Vg._for||e===Vg._with||e===Vg._while;this.context.push(t?kv.p_stat:kv.p_expr),this.exprAllowed=!0},Vg.incDec.updateContext=function(){},Vg._function.updateContext=Vg._class.updateContext=function(e){!e.beforeExpr||e===Vg.semi||e===Vg._else||e===Vg._return&&jg.test(this.input.slice(this.lastTokEnd,this.start))||(e===Vg.colon||e===Vg.braceL)&&this.curContext()===kv.b_stat?this.context.push(kv.f_stat):this.context.push(kv.f_expr),this.exprAllowed=!1},Vg.backQuote.updateContext=function(){this.curContext()===kv.q_tmpl?this.context.pop():this.context.push(kv.q_tmpl),this.exprAllowed=!1},Vg.star.updateContext=function(e){if(e===Vg._function){var t=this.context.length-1;this.context[t]===kv.f_expr?this.context[t]=kv.f_expr_gen:this.context[t]=kv.f_gen}this.exprAllowed=!0},Vg.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==Vg.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var Ev="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Pv=Ev+" Extended_Pictographic",Tv={9:Ev,10:Pv,11:Pv},Av="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Mv="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Iv=Mv+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",_v={9:Mv,10:Iv,11:Iv+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},Ov={};function Nv(e){var t=Ov[e]={binary:Yg(Tv[e]+" "+Av),nonBinary:{General_Category:Yg(Av),Script:Yg(_v[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}Nv(9),Nv(10),Nv(11);var Dv=iv.prototype,Rv=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":""),this.unicodeProperties=Ov[e.options.ecmaVersion>=11?11:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function Fv(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function Bv(e){return 36===e||e>=40&&e<=43||46===e||63===e||e>=91&&e<=94||e>=123&&e<=125}function Vv(e){return e>=65&&e<=90||e>=97&&e<=122}function jv(e){return Vv(e)||95===e}function Hv(e){return jv(e)||Uv(e)}function Uv(e){return e>=48&&e<=57}function zv(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function Wv(e){return e>=65&&e<=70?e-65+10:e>=97&&e<=102?e-97+10:e-48}function Gv(e){return e>=48&&e<=55}Rv.prototype.reset=function(e,t,n){var i=-1!==n.indexOf("u");this.start=0|e,this.source=t+"",this.flags=n,this.switchU=i&&this.parser.options.ecmaVersion>=6,this.switchN=i&&this.parser.options.ecmaVersion>=9},Rv.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)},Rv.prototype.at=function(e,t){void 0===t&&(t=!1);var n=this.source,i=n.length;if(e>=i)return-1;var r=n.charCodeAt(e);if(!t&&!this.switchU||r<=55295||r>=57344||e+1>=i)return r;var s=n.charCodeAt(e+1);return s>=56320&&s<=57343?(r<<10)+s-56613888:r},Rv.prototype.nextIndex=function(e,t){void 0===t&&(t=!1);var n=this.source,i=n.length;if(e>=i)return i;var r,s=n.charCodeAt(e);return!t&&!this.switchU||s<=55295||s>=57344||e+1>=i||(r=n.charCodeAt(e+1))<56320||r>57343?e+1:e+2},Rv.prototype.current=function(e){return void 0===e&&(e=!1),this.at(this.pos,e)},Rv.prototype.lookahead=function(e){return void 0===e&&(e=!1),this.at(this.nextIndex(this.pos,e),e)},Rv.prototype.advance=function(e){void 0===e&&(e=!1),this.pos=this.nextIndex(this.pos,e)},Rv.prototype.eat=function(e,t){return void 0===t&&(t=!1),this.current(t)===e&&(this.advance(t),!0)},Dv.validateRegExpFlags=function(e){for(var t=e.validFlags,n=e.flags,i=0;i<n.length;i++){var r=n.charAt(i);-1===t.indexOf(r)&&this.raise(e.start,"Invalid regular expression flag"),n.indexOf(r,i+1)>-1&&this.raise(e.start,"Duplicate regular expression flag")}},Dv.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&e.groupNames.length>0&&(e.switchN=!0,this.regexp_pattern(e))},Dv.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames.length=0,e.backReferenceNames.length=0,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,n=e.backReferenceNames;t<n.length;t+=1){var i=n[t];-1===e.groupNames.indexOf(i)&&e.raise("Invalid named capture referenced")}},Dv.regexp_disjunction=function(e){for(this.regexp_alternative(e);e.eat(124);)this.regexp_alternative(e);this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")},Dv.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););},Dv.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):!!(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))&&(this.regexp_eatQuantifier(e),!0)},Dv.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!n,!0}return e.pos=t,!1},Dv.regexp_eatQuantifier=function(e,t){return void 0===t&&(t=!1),!!this.regexp_eatQuantifierPrefix(e,t)&&(e.eat(63),!0)},Dv.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)},Dv.regexp_eatBracedQuantifier=function(e,t){var n=e.pos;if(e.eat(123)){var i=0,r=-1;if(this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(r=e.lastIntValue),e.eat(125)))return-1!==r&&r<i&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=n}return!1},Dv.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)},Dv.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1},Dv.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)&&e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}e.pos=t}return!1},Dv.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):63===e.current()&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1},Dv.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)},Dv.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1},Dv.regexp_eatSyntaxCharacter=function(e){var t=e.current();return!!Bv(t)&&(e.lastIntValue=t,e.advance(),!0)},Dv.regexp_eatPatternCharacters=function(e){for(var t=e.pos,n=0;-1!==(n=e.current())&&!Bv(n);)e.advance();return e.pos!==t},Dv.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return!(-1===t||36===t||t>=40&&t<=43||46===t||63===t||91===t||94===t||124===t)&&(e.advance(),!0)},Dv.regexp_groupSpecifier=function(e){if(e.eat(63)){if(this.regexp_eatGroupName(e))return-1!==e.groupNames.indexOf(e.lastStringValue)&&e.raise("Duplicate capture group name"),void e.groupNames.push(e.lastStringValue);e.raise("Invalid group")}},Dv.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1},Dv.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=Fv(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=Fv(e.lastIntValue);return!0}return!1},Dv.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,i=e.current(n);return e.advance(n),92===i&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(i=e.lastIntValue),function(e){return Ig(e,!0)||36===e||95===e}(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)},Dv.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,i=e.current(n);return e.advance(n),92===i&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(i=e.lastIntValue),function(e){return _g(e,!0)||36===e||95===e||8204===e||8205===e}(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)},Dv.regexp_eatAtomEscape=function(e){return!!(this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e))||(e.switchU&&(99===e.current()&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)},Dv.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var n=e.lastIntValue;if(e.switchU)return n>e.maxBackReference&&(e.maxBackReference=n),!0;if(n<=e.numCapturingParens)return!0;e.pos=t}return!1},Dv.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1},Dv.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)},Dv.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1},Dv.regexp_eatZero=function(e){return 48===e.current()&&!Uv(e.lookahead())&&(e.lastIntValue=0,e.advance(),!0)},Dv.regexp_eatControlEscape=function(e){var t=e.current();return 116===t?(e.lastIntValue=9,e.advance(),!0):110===t?(e.lastIntValue=10,e.advance(),!0):118===t?(e.lastIntValue=11,e.advance(),!0):102===t?(e.lastIntValue=12,e.advance(),!0):114===t&&(e.lastIntValue=13,e.advance(),!0)},Dv.regexp_eatControlLetter=function(e){var t=e.current();return!!Vv(t)&&(e.lastIntValue=t%32,e.advance(),!0)},Dv.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){void 0===t&&(t=!1);var n,i=e.pos,r=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var s=e.lastIntValue;if(r&&s>=55296&&s<=56319){var o=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var a=e.lastIntValue;if(a>=56320&&a<=57343)return e.lastIntValue=1024*(s-55296)+(a-56320)+65536,!0}e.pos=o,e.lastIntValue=s}return!0}if(r&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&((n=e.lastIntValue)>=0&&n<=1114111))return!0;r&&e.raise("Invalid unicode escape"),e.pos=i}return!1},Dv.regexp_eatIdentityEscape=function(e){if(e.switchU)return!!this.regexp_eatSyntaxCharacter(e)||!!e.eat(47)&&(e.lastIntValue=47,!0);var t=e.current();return!(99===t||e.switchN&&107===t)&&(e.lastIntValue=t,e.advance(),!0)},Dv.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do{e.lastIntValue=10*e.lastIntValue+(t-48),e.advance()}while((t=e.current())>=48&&t<=57);return!0}return!1},Dv.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(function(e){return 100===e||68===e||115===e||83===e||119===e||87===e}(t))return e.lastIntValue=-1,e.advance(),!0;if(e.switchU&&this.options.ecmaVersion>=9&&(80===t||112===t)){if(e.lastIntValue=-1,e.advance(),e.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(e)&&e.eat(125))return!0;e.raise("Invalid property name")}return!1},Dv.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var n=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,n,i),!0}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var r=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,r),!0}return!1},Dv.regexp_validateUnicodePropertyNameAndValue=function(e,t,n){qg(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(n)||e.raise("Invalid property value")},Dv.regexp_validateUnicodePropertyNameOrValue=function(e,t){e.unicodeProperties.binary.test(t)||e.raise("Invalid property name")},Dv.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";jv(t=e.current());)e.lastStringValue+=Fv(t),e.advance();return""!==e.lastStringValue},Dv.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";Hv(t=e.current());)e.lastStringValue+=Fv(t),e.advance();return""!==e.lastStringValue},Dv.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)},Dv.regexp_eatCharacterClass=function(e){if(e.eat(91)){if(e.eat(94),this.regexp_classRanges(e),e.eat(93))return!0;e.raise("Unterminated character class")}return!1},Dv.regexp_classRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var n=e.lastIntValue;!e.switchU||-1!==t&&-1!==n||e.raise("Invalid character class"),-1!==t&&-1!==n&&t>n&&e.raise("Range out of order in character class")}}},Dv.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var n=e.current();(99===n||Gv(n))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var i=e.current();return 93!==i&&(e.lastIntValue=i,e.advance(),!0)},Dv.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)},Dv.regexp_eatClassControlLetter=function(e){var t=e.current();return!(!Uv(t)&&95!==t)&&(e.lastIntValue=t%32,e.advance(),!0)},Dv.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1},Dv.regexp_eatDecimalDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;Uv(n=e.current());)e.lastIntValue=10*e.lastIntValue+(n-48),e.advance();return e.pos!==t},Dv.regexp_eatHexDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;zv(n=e.current());)e.lastIntValue=16*e.lastIntValue+Wv(n),e.advance();return e.pos!==t},Dv.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var n=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=64*t+8*n+e.lastIntValue:e.lastIntValue=8*t+n}else e.lastIntValue=t;return!0}return!1},Dv.regexp_eatOctalDigit=function(e){var t=e.current();return Gv(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)},Dv.regexp_eatFixedHexDigits=function(e,t){var n=e.pos;e.lastIntValue=0;for(var i=0;i<t;++i){var r=e.current();if(!zv(r))return e.pos=n,!1;e.lastIntValue=16*e.lastIntValue+Wv(r),e.advance()}return!0};var $v=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new Jg(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},Zv=iv.prototype;function qv(e){return"function"!=typeof BigInt?null:BigInt(e.replace(/_/g,""))}function Kv(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}Zv.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new $v(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Zv.getToken=function(){return this.next(),new $v(this)},"undefined"!=typeof Symbol&&(Zv[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===Vg.eof,value:t}}}}),Zv.curContext=function(){return this.context[this.context.length-1]},Zv.nextToken=function(){var e=this.curContext();return e&&e.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(Vg.eof):e.override?e.override(this):void this.readToken(this.fullCharCodeAtPos())},Zv.readToken=function(e){return Ig(e,this.options.ecmaVersion>=6)||92===e?this.readWord():this.getTokenFromCode(e)},Zv.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);return e<=55295||e>=57344?e:(e<<10)+this.input.charCodeAt(this.pos+1)-56613888},Zv.skipBlockComment=function(){var e,t=this.options.onComment&&this.curPosition(),n=this.pos,i=this.input.indexOf("*/",this.pos+=2);if(-1===i&&this.raise(this.pos-2,"Unterminated comment"),this.pos=i+2,this.options.locations)for(Hg.lastIndex=n;(e=Hg.exec(this.input))&&e.index<this.pos;)++this.curLine,this.lineStart=e.index+e[0].length;this.options.onComment&&this.options.onComment(!0,this.input.slice(n+2,i),n,this.pos,t,this.curPosition())},Zv.skipLineComment=function(e){for(var t=this.pos,n=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!Ug(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,n,this.curPosition())},Zv.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(!(e>8&&e<14||e>=5760&&zg.test(String.fromCharCode(e))))break e;++this.pos}}},Zv.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=e,this.value=t,this.updateContext(n)},Zv.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===e&&46===t?(this.pos+=3,this.finishToken(Vg.ellipsis)):(++this.pos,this.finishToken(Vg.dot))},Zv.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===e?this.finishOp(Vg.assign,2):this.finishOp(Vg.slash,1)},Zv.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),n=1,i=42===e?Vg.star:Vg.modulo;return this.options.ecmaVersion>=7&&42===e&&42===t&&(++n,i=Vg.starstar,t=this.input.charCodeAt(this.pos+2)),61===t?this.finishOp(Vg.assign,n+1):this.finishOp(i,n)},Zv.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12)if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(Vg.assign,3);return this.finishOp(124===e?Vg.logicalOR:Vg.logicalAND,2)}return 61===t?this.finishOp(Vg.assign,2):this.finishOp(124===e?Vg.bitwiseOR:Vg.bitwiseAND,1)},Zv.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(Vg.assign,2):this.finishOp(Vg.bitwiseXOR,1)},Zv.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?45!==t||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!jg.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(Vg.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===t?this.finishOp(Vg.assign,2):this.finishOp(Vg.plusMin,1)},Zv.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),n=1;return t===e?(n=62===e&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(Vg.assign,n+1):this.finishOp(Vg.bitShift,n)):33!==t||60!==e||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===t&&(n=2),this.finishOp(Vg.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},Zv.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return 61===t?this.finishOp(Vg.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===e&&62===t&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(Vg.arrow)):this.finishOp(61===e?Vg.eq:Vg.prefix,1)},Zv.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(46===t){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(Vg.questionDot,2)}if(63===t){if(e>=12)if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(Vg.assign,3);return this.finishOp(Vg.coalesce,2)}}return this.finishOp(Vg.question,1)},Zv.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(Vg.parenL);case 41:return++this.pos,this.finishToken(Vg.parenR);case 59:return++this.pos,this.finishToken(Vg.semi);case 44:return++this.pos,this.finishToken(Vg.comma);case 91:return++this.pos,this.finishToken(Vg.bracketL);case 93:return++this.pos,this.finishToken(Vg.bracketR);case 123:return++this.pos,this.finishToken(Vg.braceL);case 125:return++this.pos,this.finishToken(Vg.braceR);case 58:return++this.pos,this.finishToken(Vg.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(Vg.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(120===t||88===t)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===t||79===t)return this.readRadixNumber(8);if(98===t||66===t)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(Vg.prefix,1)}this.raise(this.pos,"Unexpected character '"+Kv(e)+"'")},Zv.finishOp=function(e,t){var n=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,n)},Zv.readRegexp=function(){for(var e,t,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(jg.test(i)&&this.raise(n,"Unterminated regular expression"),e)e=!1;else{if("["===i)t=!0;else if("]"===i&&t)t=!1;else if("/"===i&&!t)break;e="\\"===i}++this.pos}var r=this.input.slice(n,this.pos);++this.pos;var s=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(s);var a=this.regexpState||(this.regexpState=new Rv(this));a.reset(n,r,o),this.validateRegExpFlags(a),this.validateRegExpPattern(a);var l=null;try{l=new RegExp(r,o)}catch(c){}return this.finishToken(Vg.regexp,{pattern:r,flags:o,value:l})},Zv.readInt=function(e,t,n){for(var i=this.options.ecmaVersion>=12&&void 0===t,r=n&&48===this.input.charCodeAt(this.pos),s=this.pos,o=0,a=0,l=0,c=null==t?1/0:t;l<c;++l,++this.pos){var h=this.input.charCodeAt(this.pos),u=void 0;if(i&&95===h)r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===a&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===l&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),a=h;else{if((u=h>=97?h-97+10:h>=65?h-65+10:h>=48&&h<=57?h-48:1/0)>=e)break;a=h,o=o*e+u}}return i&&95===a&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===s||null!=t&&this.pos-s!==t?null:o},Zv.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var n=this.readInt(e);return null==n&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(n=qv(this.input.slice(t,this.pos)),++this.pos):Ig(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Vg.num,n)},Zv.readNumber=function(e){var t=this.pos;e||null!==this.readInt(10,void 0,!0)||this.raise(t,"Invalid number");var n=this.pos-t>=2&&48===this.input.charCodeAt(t);n&&this.strict&&this.raise(t,"Invalid number");var i=this.input.charCodeAt(this.pos);if(!n&&!e&&this.options.ecmaVersion>=11&&110===i){var r=qv(this.input.slice(t,this.pos));return++this.pos,Ig(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Vg.num,r)}n&&/[89]/.test(this.input.slice(t,this.pos))&&(n=!1),46!==i||n||(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),69!==i&&101!==i||n||(43!==(i=this.input.charCodeAt(++this.pos))&&45!==i||++this.pos,null===this.readInt(10)&&this.raise(t,"Invalid number")),Ig(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var s,o=(s=this.input.slice(t,this.pos),n?parseInt(s,8):parseFloat(s.replace(/_/g,"")));return this.finishToken(Vg.num,o)},Zv.readCodePoint=function(){var e;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else e=this.readHexChar(4);return e},Zv.readString=function(e){for(var t="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===e)break;92===i?(t+=this.input.slice(n,this.pos),t+=this.readEscapedChar(!1),n=this.pos):(Ug(i,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(n,this.pos++),this.finishToken(Vg.string,t)};var Yv={};Zv.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e!==Yv)throw e;this.readInvalidTemplateToken()}this.inTemplateElement=!1},Zv.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Yv;this.raise(e,t)},Zv.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(96===n||36===n&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==Vg.template&&this.type!==Vg.invalidTemplate?(e+=this.input.slice(t,this.pos),this.finishToken(Vg.template,e)):36===n?(this.pos+=2,this.finishToken(Vg.dollarBraceL)):(++this.pos,this.finishToken(Vg.backQuote));if(92===n)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(Ug(n)){switch(e+=this.input.slice(t,this.pos),++this.pos,n){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:e+="\n";break;default:e+=String.fromCharCode(n)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}},Zv.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(Vg.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Zv.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Kv(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(e){var n=this.pos-1;return this.invalidStringToken(n,"Invalid escape sequence in template string"),null}default:if(t>=48&&t<=55){var i=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(i,8);return r>255&&(i=i.slice(0,-1),r=parseInt(i,8)),this.pos+=i.length-1,t=this.input.charCodeAt(this.pos),"0"===i&&56!==t&&57!==t||!this.strict&&!e||this.invalidStringToken(this.pos-1-i.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return Ug(t)?"":String.fromCharCode(t)}},Zv.readHexChar=function(e){var t=this.pos,n=this.readInt(16,e);return null===n&&this.invalidStringToken(t,"Bad character escape sequence"),n},Zv.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,n=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(_g(r,i))this.pos+=r<=65535?1:2;else{if(92!==r)break;this.containsEsc=!0,e+=this.input.slice(n,this.pos);var s=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?Ig:_g)(o,i)||this.invalidStringToken(s,"Invalid Unicode escape"),e+=Kv(o),n=this.pos}t=!1}return e+this.input.slice(n,this.pos)},Zv.readWord=function(){var e=this.readWord1(),t=Vg.name;return this.keywords.test(e)&&(t=Fg[e]),this.finishToken(t,e)};var Xv="7.4.1";iv.acorn={Parser:iv,version:Xv,defaultOptions:ev,Position:Xg,SourceLocation:Jg,getLineInfo:Qg,Node:wv,TokenType:Og,tokTypes:Vg,keywordTypes:Fg,TokContext:Sv,tokContexts:kv,isIdentifierChar:_g,isIdentifierStart:Ig,Token:$v,isNewLine:Ug,lineBreak:jg,lineBreakG:Hg,nonASCIIwhitespace:zg};const Jv=R(Object.freeze(Object.defineProperty({__proto__:null,Node:wv,Parser:iv,Position:Xg,SourceLocation:Jg,TokContext:Sv,Token:$v,TokenType:Og,defaultOptions:ev,getLineInfo:Qg,isIdentifierChar:_g,isIdentifierStart:Ig,isNewLine:Ug,keywordTypes:Fg,lineBreak:jg,lineBreakG:Hg,nonASCIIwhitespace:zg,parse:function(e,t){return iv.parse(e,t)},parseExpressionAt:function(e,t,n){return iv.parseExpressionAt(e,t,n)},tokContexts:kv,tokTypes:Vg,tokenizer:function(e,t){return iv.tokenizer(e,t)},version:Xv},Symbol.toStringTag,{value:"Module"})));function Qv(e,t,n,i,r){n||(n=oy),function e(i,r,s){var o=s||i.type,a=t[o];n[o](i,r,e),a&&a(i,r)}(e,i,r)}function ey(e){return"string"==typeof e?function(t){return t===e}:e||function(){return!0}}var ty=function(e,t){this.node=e,this.state=t};var ny=Object.create||function(e){function t(){}return t.prototype=e,new t};function iy(e,t){var n=ny(t||oy);for(var i in e)n[i]=e[i];return n}function ry(e,t,n){n(e,t)}function sy(e,t,n){}var oy={};oy.Program=oy.BlockStatement=function(e,t,n){for(var i=0,r=e.body;i<r.length;i+=1){n(r[i],t,"Statement")}},oy.Statement=ry,oy.EmptyStatement=sy,oy.ExpressionStatement=oy.ParenthesizedExpression=oy.ChainExpression=function(e,t,n){return n(e.expression,t,"Expression")},oy.IfStatement=function(e,t,n){n(e.test,t,"Expression"),n(e.consequent,t,"Statement"),e.alternate&&n(e.alternate,t,"Statement")},oy.LabeledStatement=function(e,t,n){return n(e.body,t,"Statement")},oy.BreakStatement=oy.ContinueStatement=sy,oy.WithStatement=function(e,t,n){n(e.object,t,"Expression"),n(e.body,t,"Statement")},oy.SwitchStatement=function(e,t,n){n(e.discriminant,t,"Expression");for(var i=0,r=e.cases;i<r.length;i+=1){var s=r[i];s.test&&n(s.test,t,"Expression");for(var o=0,a=s.consequent;o<a.length;o+=1){n(a[o],t,"Statement")}}},oy.SwitchCase=function(e,t,n){e.test&&n(e.test,t,"Expression");for(var i=0,r=e.consequent;i<r.length;i+=1){n(r[i],t,"Statement")}},oy.ReturnStatement=oy.YieldExpression=oy.AwaitExpression=function(e,t,n){e.argument&&n(e.argument,t,"Expression")},oy.ThrowStatement=oy.SpreadElement=function(e,t,n){return n(e.argument,t,"Expression")},oy.TryStatement=function(e,t,n){n(e.block,t,"Statement"),e.handler&&n(e.handler,t),e.finalizer&&n(e.finalizer,t,"Statement")},oy.CatchClause=function(e,t,n){e.param&&n(e.param,t,"Pattern"),n(e.body,t,"Statement")},oy.WhileStatement=oy.DoWhileStatement=function(e,t,n){n(e.test,t,"Expression"),n(e.body,t,"Statement")},oy.ForStatement=function(e,t,n){e.init&&n(e.init,t,"ForInit"),e.test&&n(e.test,t,"Expression"),e.update&&n(e.update,t,"Expression"),n(e.body,t,"Statement")},oy.ForInStatement=oy.ForOfStatement=function(e,t,n){n(e.left,t,"ForInit"),n(e.right,t,"Expression"),n(e.body,t,"Statement")},oy.ForInit=function(e,t,n){"VariableDeclaration"===e.type?n(e,t):n(e,t,"Expression")},oy.DebuggerStatement=sy,oy.FunctionDeclaration=function(e,t,n){return n(e,t,"Function")},oy.VariableDeclaration=function(e,t,n){for(var i=0,r=e.declarations;i<r.length;i+=1){n(r[i],t)}},oy.VariableDeclarator=function(e,t,n){n(e.id,t,"Pattern"),e.init&&n(e.init,t,"Expression")},oy.Function=function(e,t,n){e.id&&n(e.id,t,"Pattern");for(var i=0,r=e.params;i<r.length;i+=1){n(r[i],t,"Pattern")}n(e.body,t,e.expression?"Expression":"Statement")},oy.Pattern=function(e,t,n){"Identifier"===e.type?n(e,t,"VariablePattern"):"MemberExpression"===e.type?n(e,t,"MemberPattern"):n(e,t)},oy.VariablePattern=sy,oy.MemberPattern=ry,oy.RestElement=function(e,t,n){return n(e.argument,t,"Pattern")},oy.ArrayPattern=function(e,t,n){for(var i=0,r=e.elements;i<r.length;i+=1){var s=r[i];s&&n(s,t,"Pattern")}},oy.ObjectPattern=function(e,t,n){for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];"Property"===s.type?(s.computed&&n(s.key,t,"Expression"),n(s.value,t,"Pattern")):"RestElement"===s.type&&n(s.argument,t,"Pattern")}},oy.Expression=ry,oy.ThisExpression=oy.Super=oy.MetaProperty=sy,oy.ArrayExpression=function(e,t,n){for(var i=0,r=e.elements;i<r.length;i+=1){var s=r[i];s&&n(s,t,"Expression")}},oy.ObjectExpression=function(e,t,n){for(var i=0,r=e.properties;i<r.length;i+=1){n(r[i],t)}},oy.FunctionExpression=oy.ArrowFunctionExpression=oy.FunctionDeclaration,oy.SequenceExpression=function(e,t,n){for(var i=0,r=e.expressions;i<r.length;i+=1){n(r[i],t,"Expression")}},oy.TemplateLiteral=function(e,t,n){for(var i=0,r=e.quasis;i<r.length;i+=1){n(r[i],t)}for(var s=0,o=e.expressions;s<o.length;s+=1){n(o[s],t,"Expression")}},oy.TemplateElement=sy,oy.UnaryExpression=oy.UpdateExpression=function(e,t,n){n(e.argument,t,"Expression")},oy.BinaryExpression=oy.LogicalExpression=function(e,t,n){n(e.left,t,"Expression"),n(e.right,t,"Expression")},oy.AssignmentExpression=oy.AssignmentPattern=function(e,t,n){n(e.left,t,"Pattern"),n(e.right,t,"Expression")},oy.ConditionalExpression=function(e,t,n){n(e.test,t,"Expression"),n(e.consequent,t,"Expression"),n(e.alternate,t,"Expression")},oy.NewExpression=oy.CallExpression=function(e,t,n){if(n(e.callee,t,"Expression"),e.arguments)for(var i=0,r=e.arguments;i<r.length;i+=1){n(r[i],t,"Expression")}},oy.MemberExpression=function(e,t,n){n(e.object,t,"Expression"),e.computed&&n(e.property,t,"Expression")},oy.ExportNamedDeclaration=oy.ExportDefaultDeclaration=function(e,t,n){e.declaration&&n(e.declaration,t,"ExportNamedDeclaration"===e.type||e.declaration.id?"Statement":"Expression"),e.source&&n(e.source,t,"Expression")},oy.ExportAllDeclaration=function(e,t,n){e.exported&&n(e.exported,t),n(e.source,t,"Expression")},oy.ImportDeclaration=function(e,t,n){for(var i=0,r=e.specifiers;i<r.length;i+=1){n(r[i],t)}n(e.source,t,"Expression")},oy.ImportExpression=function(e,t,n){n(e.source,t,"Expression")},oy.ImportSpecifier=oy.ImportDefaultSpecifier=oy.ImportNamespaceSpecifier=oy.Identifier=oy.Literal=sy,oy.TaggedTemplateExpression=function(e,t,n){n(e.tag,t,"Expression"),n(e.quasi,t,"Expression")},oy.ClassDeclaration=oy.ClassExpression=function(e,t,n){return n(e,t,"Class")},oy.Class=function(e,t,n){e.id&&n(e.id,t,"Pattern"),e.superClass&&n(e.superClass,t,"Expression"),n(e.body,t)},oy.ClassBody=function(e,t,n){for(var i=0,r=e.body;i<r.length;i+=1){n(r[i],t)}},oy.MethodDefinition=oy.Property=function(e,t,n){e.computed&&n(e.key,t,"Expression"),n(e.value,t,"Expression")};const ay=R(Object.freeze(Object.defineProperty({__proto__:null,ancestor:function(e,t,n,i,r){var s=[];n||(n=oy),function e(i,r,o){var a=o||i.type,l=t[a],c=i!==s[s.length-1];c&&s.push(i),n[a](i,r,e),l&&l(i,r||s,s),c&&s.pop()}(e,i,r)},base:oy,findNodeAfter:function(e,t,n,i,r){n=ey(n),i||(i=oy);try{!function e(r,s,o){if(!(r.end<t)){var a=o||r.type;if(r.start>=t&&n(a,r))throw new ty(r,s);i[a](r,s,e)}}(e,r)}catch(s){if(s instanceof ty)return s;throw s}},findNodeAround:function(e,t,n,i,r){n=ey(n),i||(i=oy);try{!function e(r,s,o){var a=o||r.type;if(!(r.start>t||r.end<t)&&(i[a](r,s,e),n(a,r)))throw new ty(r,s)}(e,r)}catch(s){if(s instanceof ty)return s;throw s}},findNodeAt:function(e,t,n,i,r,s){r||(r=oy),i=ey(i);try{!function e(s,o,a){var l=a||s.type;if((null==t||s.start<=t)&&(null==n||s.end>=n)&&r[l](s,o,e),(null==t||s.start===t)&&(null==n||s.end===n)&&i(l,s))throw new ty(s,o)}(e,s)}catch(o){if(o instanceof ty)return o;throw o}},findNodeBefore:function(e,t,n,i,r){var s;return n=ey(n),i||(i=oy),function e(r,o,a){if(!(r.start>t)){var l=a||r.type;r.end<=t&&(!s||s.node.end<r.end)&&n(l,r)&&(s=new ty(r,o)),i[l](r,o,e)}}(e,r),s},full:function(e,t,n,i,r){n||(n=oy),function e(i,r,s){var o=s||i.type;n[o](i,r,e),s||t(i,r,o)}(e,i,r)},fullAncestor:function(e,t,n,i){n||(n=oy);var r=[];!function e(i,s,o){var a=o||i.type,l=i!==r[r.length-1];l&&r.push(i),n[a](i,s,e),o||t(i,s||r,r,a),l&&r.pop()}(e,i)},make:iy,recursive:function(e,t,n,i,r){var s=n?iy(n,i||void 0):i;!function e(t,n,i){s[i||t.type](t,n,e)}(e,t,r)},simple:Qv},Symbol.toStringTag,{value:"Module"})));var ly;var cy=function(){if(ly)return bg.exports;ly=1;var e=Jv,t=ay;function n(e){return"FunctionExpression"===e.type||"FunctionDeclaration"===e.type||"ArrowFunctionExpression"===e.type||"Program"===e.type}function i(e){return"BlockStatement"===e.type||n(e)}function r(e){return"FunctionExpression"===e.type||"FunctionDeclaration"===e.type}function s(e){return"FunctionExpression"===e.type||"FunctionDeclaration"===e.type}function o(t,n){var i=Object.assign({},n,{allowReturnOutsideFunction:!0,allowImportExportEverywhere:!0,allowHashBang:!0});return e.parse(t,i)}return bg.exports=function(e,a){a=a||{};var l,c=[];l="string"==typeof e?o(e,a):e;if(!l||"object"!=typeof l||"Program"!==l.type)throw new TypeError("Source must be either a string of JavaScript or an acorn AST");var h=function(e){var t=e;t.locals=t.locals||Object.create(null),e.params.forEach(function(e){d(e,t)}),e.id&&(t.locals[e.id.name]=!0)},u=function(e){e.locals=e.locals||Object.create(null),e.id&&(e.locals[e.id.name]=!0)},d=function(e,t){switch(e.type){case"Identifier":t.locals[e.name]=!0;break;case"ObjectPattern":e.properties.forEach(function(e){d(e.value||e.argument,t)});break;case"ArrayPattern":e.elements.forEach(function(e){e&&d(e,t)});break;case"RestElement":d(e.argument,t);break;case"AssignmentPattern":d(e.left,t);break;default:throw new Error("Unrecognized pattern type: "+e.type)}},p=function(e,t){l.locals=l.locals||Object.create(null),l.locals[e.local.name]=!0};function f(e,t){var n=e.name;if("undefined"!==n){for(var i=0;i<t.length;i++){if("arguments"===n&&r(t[i]))return;if(t[i].locals&&n in t[i].locals)return}e.parents=t.slice(),c.push(e)}}t.ancestor(l,{VariableDeclaration:function(e,t){for(var r=null,s=t.length-1;s>=0&&null===r;s--)("var"===e.kind?n(t[s]):i(t[s]))&&(r=t[s]);r.locals=r.locals||Object.create(null),e.declarations.forEach(function(e){d(e.id,r)})},FunctionDeclaration:function(e,t){for(var i=null,r=t.length-2;r>=0&&null===i;r--)n(t[r])&&(i=t[r]);i.locals=i.locals||Object.create(null),e.id&&(i.locals[e.id.name]=!0),h(e)},Function:h,ClassDeclaration:function(e,t){for(var n=null,r=t.length-2;r>=0&&null===n;r--)i(t[r])&&(n=t[r]);n.locals=n.locals||Object.create(null),e.id&&(n.locals[e.id.name]=!0),u(e)},Class:u,TryStatement:function(e){null!==e.handler&&(e.handler.locals=e.handler.locals||Object.create(null),d(e.handler.param,e.handler))},ImportDefaultSpecifier:p,ImportSpecifier:p,ImportNamespaceSpecifier:p}),t.ancestor(l,{VariablePattern:f,Identifier:f,ThisExpression:function(e,t){for(var n=0;n<t.length;n++)if(s(t[n]))return;e.parents=t.slice(),c.push(e)}});var m=Object.create(null);return c.forEach(function(e){var t="ThisExpression"===e.type?"this":e.name;m[t]=m[t]||[],m[t].push(e)}),Object.keys(m).sort().map(function(e){return{name:e,nodes:m[e]}})},bg.exports.parse=o,bg.exports}();const hy=D(cy),{stringify:uy}=JSON;if(!String.prototype.repeat)throw new Error("String.prototype.repeat is undefined, see https://github.com/davidbonnet/astring#installation");if(!String.prototype.endsWith)throw new Error("String.prototype.endsWith is undefined, see https://github.com/davidbonnet/astring#installation");const dy={"||":3,"&&":4,"|":5,"^":6,"&":7,"==":8,"!=":8,"===":8,"!==":8,"<":9,">":9,"<=":9,">=":9,in:9,instanceof:9,"<<":10,">>":10,">>>":10,"+":11,"-":11,"*":12,"%":12,"/":12,"**":13},py=17,fy={ArrayExpression:20,TaggedTemplateExpression:20,ThisExpression:20,Identifier:20,Literal:18,TemplateLiteral:20,Super:20,SequenceExpression:20,MemberExpression:19,ChainExpression:19,CallExpression:19,NewExpression:19,ArrowFunctionExpression:py,ClassExpression:py,FunctionExpression:py,ObjectExpression:py,UpdateExpression:16,UnaryExpression:15,AwaitExpression:15,BinaryExpression:14,LogicalExpression:13,ConditionalExpression:4,AssignmentExpression:3,YieldExpression:2,RestElement:1};function my(e,t){const{generator:n}=e;if(e.write("("),null!=t&&t.length>0){n[t[0].type](t[0],e);const{length:i}=t;for(let r=1;r<i;r++){const i=t[r];e.write(", "),n[i.type](i,e)}}e.write(")")}function gy(e,t,n,i){const r=e.expressionsPrecedence[t.type];if(r===py)return!0;const s=e.expressionsPrecedence[n.type];return r!==s?!i&&15===r&&14===s&&"**"===n.operator||r<s:(13===r||14===r)&&("**"===t.operator&&"**"===n.operator?!i:i?dy[t.operator]<=dy[n.operator]:dy[t.operator]<dy[n.operator])}function vy(e,t,n,i){const{generator:r}=e;gy(e,t,n,i)?(e.write("("),r[t.type](t,e),e.write(")")):r[t.type](t,e)}function yy(e,t,n,i){const r=t.split("\n"),s=r.length-1;if(e.write(r[0].trim()),s>0){e.write(i);for(let t=1;t<s;t++)e.write(n+r[t].trim()+i);e.write(n+r[s].trim())}}function by(e,t,n,i){const{length:r}=t;for(let s=0;s<r;s++){const r=t[s];e.write(n),"L"===r.type[0]?e.write("// "+r.value.trim()+"\n",r):(e.write("/*"),yy(e,r.value,n,i),e.write("*/"+i))}}function wy(e,t){const{generator:n}=e,{declarations:i}=t;e.write(t.kind+" ");const{length:r}=i;if(r>0){n.VariableDeclarator(i[0],e);for(let t=1;t<r;t++)e.write(", "),n.VariableDeclarator(i[t],e)}}let xy,Cy,Sy,ky,Ly,Ey;const Py={Program(e,t){const n=t.indent.repeat(t.indentLevel),{lineEnd:i,writeComments:r}=t;r&&null!=e.comments&&by(t,e.comments,n,i);const s=e.body,{length:o}=s;for(let a=0;a<o;a++){const e=s[a];r&&null!=e.comments&&by(t,e.comments,n,i),t.write(n),this[e.type](e,t),t.write(i)}r&&null!=e.trailingComments&&by(t,e.trailingComments,n,i)},BlockStatement:Ey=function(e,t){const n=t.indent.repeat(t.indentLevel++),{lineEnd:i,writeComments:r}=t,s=n+t.indent;t.write("{");const o=e.body;if(null!=o&&o.length>0){t.write(i),r&&null!=e.comments&&by(t,e.comments,s,i);const{length:a}=o;for(let e=0;e<a;e++){const n=o[e];r&&null!=n.comments&&by(t,n.comments,s,i),t.write(s),this[n.type](n,t),t.write(i)}t.write(n)}else r&&null!=e.comments&&(t.write(i),by(t,e.comments,s,i),t.write(n));r&&null!=e.trailingComments&&by(t,e.trailingComments,s,i),t.write("}"),t.indentLevel--},ClassBody:Ey,EmptyStatement(e,t){t.write(";")},ExpressionStatement(e,t){const n=t.expressionsPrecedence[e.expression.type];n===py||3===n&&"O"===e.expression.left.type[0]?(t.write("("),this[e.expression.type](e.expression,t),t.write(")")):this[e.expression.type](e.expression,t),t.write(";")},IfStatement(e,t){t.write("if ("),this[e.test.type](e.test,t),t.write(") "),this[e.consequent.type](e.consequent,t),null!=e.alternate&&(t.write(" else "),this[e.alternate.type](e.alternate,t))},LabeledStatement(e,t){this[e.label.type](e.label,t),t.write(": "),this[e.body.type](e.body,t)},BreakStatement(e,t){t.write("break"),null!=e.label&&(t.write(" "),this[e.label.type](e.label,t)),t.write(";")},ContinueStatement(e,t){t.write("continue"),null!=e.label&&(t.write(" "),this[e.label.type](e.label,t)),t.write(";")},WithStatement(e,t){t.write("with ("),this[e.object.type](e.object,t),t.write(") "),this[e.body.type](e.body,t)},SwitchStatement(e,t){const n=t.indent.repeat(t.indentLevel++),{lineEnd:i,writeComments:r}=t;t.indentLevel++;const s=n+t.indent,o=s+t.indent;t.write("switch ("),this[e.discriminant.type](e.discriminant,t),t.write(") {"+i);const{cases:a}=e,{length:l}=a;for(let c=0;c<l;c++){const e=a[c];r&&null!=e.comments&&by(t,e.comments,s,i),e.test?(t.write(s+"case "),this[e.test.type](e.test,t),t.write(":"+i)):t.write(s+"default:"+i);const{consequent:n}=e,{length:l}=n;for(let s=0;s<l;s++){const e=n[s];r&&null!=e.comments&&by(t,e.comments,o,i),t.write(o),this[e.type](e,t),t.write(i)}}t.indentLevel-=2,t.write(n+"}")},ReturnStatement(e,t){t.write("return"),e.argument&&(t.write(" "),this[e.argument.type](e.argument,t)),t.write(";")},ThrowStatement(e,t){t.write("throw "),this[e.argument.type](e.argument,t),t.write(";")},TryStatement(e,t){if(t.write("try "),this[e.block.type](e.block,t),e.handler){const{handler:n}=e;null==n.param?t.write(" catch "):(t.write(" catch ("),this[n.param.type](n.param,t),t.write(") ")),this[n.body.type](n.body,t)}e.finalizer&&(t.write(" finally "),this[e.finalizer.type](e.finalizer,t))},WhileStatement(e,t){t.write("while ("),this[e.test.type](e.test,t),t.write(") "),this[e.body.type](e.body,t)},DoWhileStatement(e,t){t.write("do "),this[e.body.type](e.body,t),t.write(" while ("),this[e.test.type](e.test,t),t.write(");")},ForStatement(e,t){if(t.write("for ("),null!=e.init){const{init:n}=e;"V"===n.type[0]?wy(t,n):this[n.type](n,t)}t.write("; "),e.test&&this[e.test.type](e.test,t),t.write("; "),e.update&&this[e.update.type](e.update,t),t.write(") "),this[e.body.type](e.body,t)},ForInStatement:xy=function(e,t){t.write(`for ${e.await?"await ":""}(`);const{left:n}=e;"V"===n.type[0]?wy(t,n):this[n.type](n,t),t.write("I"===e.type[3]?" in ":" of "),this[e.right.type](e.right,t),t.write(") "),this[e.body.type](e.body,t)},ForOfStatement:xy,DebuggerStatement(e,t){t.write("debugger;",e)},FunctionDeclaration:Cy=function(e,t){t.write((e.async?"async ":"")+(e.generator?"function* ":"function ")+(e.id?e.id.name:""),e),my(t,e.params),t.write(" "),this[e.body.type](e.body,t)},FunctionExpression:Cy,VariableDeclaration(e,t){wy(t,e),t.write(";")},VariableDeclarator(e,t){this[e.id.type](e.id,t),null!=e.init&&(t.write(" = "),this[e.init.type](e.init,t))},ClassDeclaration(e,t){if(t.write("class "+(e.id?`${e.id.name} `:""),e),e.superClass){t.write("extends ");const{superClass:n}=e,{type:i}=n,r=t.expressionsPrecedence[i];"C"===i[0]&&"l"===i[1]&&"E"===i[5]||!(r===py||r<t.expressionsPrecedence.ClassExpression)?this[n.type](n,t):(t.write("("),this[e.superClass.type](n,t),t.write(")")),t.write(" ")}this.ClassBody(e.body,t)},ImportDeclaration(e,t){t.write("import ");const{specifiers:n}=e,{length:i}=n;let r=0;if(i>0){for(;r<i;){r>0&&t.write(", ");const e=n[r],i=e.type[6];if("D"===i)t.write(e.local.name,e),r++;else{if("N"!==i)break;t.write("* as "+e.local.name,e),r++}}if(r<i){for(t.write("{");;){const e=n[r],{name:s}=e.imported;if(t.write(s,e),s!==e.local.name&&t.write(" as "+e.local.name),!(++r<i))break;t.write(", ")}t.write("}")}t.write(" from ")}this.Literal(e.source,t),t.write(";")},ImportExpression(e,t){t.write("import("),this[e.source.type](e.source,t),t.write(")")},ExportDefaultDeclaration(e,t){t.write("export default "),this[e.declaration.type](e.declaration,t),null!=t.expressionsPrecedence[e.declaration.type]&&"F"!==e.declaration.type[0]&&t.write(";")},ExportNamedDeclaration(e,t){if(t.write("export "),e.declaration)this[e.declaration.type](e.declaration,t);else{t.write("{");const{specifiers:n}=e,{length:i}=n;if(i>0)for(let e=0;;){const r=n[e],{name:s}=r.local;if(t.write(s,r),s!==r.exported.name&&t.write(" as "+r.exported.name),!(++e<i))break;t.write(", ")}t.write("}"),e.source&&(t.write(" from "),this.Literal(e.source,t)),t.write(";")}},ExportAllDeclaration(e,t){null!=e.exported?t.write("export * as "+e.exported.name+" from "):t.write("export * from "),this.Literal(e.source,t),t.write(";")},MethodDefinition(e,t){e.static&&t.write("static ");const n=e.kind[0];"g"!==n&&"s"!==n||t.write(e.kind+" "),e.value.async&&t.write("async "),e.value.generator&&t.write("*"),e.computed?(t.write("["),this[e.key.type](e.key,t),t.write("]")):this[e.key.type](e.key,t),my(t,e.value.params),t.write(" "),this[e.value.body.type](e.value.body,t)},ClassExpression(e,t){this.ClassDeclaration(e,t)},ArrowFunctionExpression(e,t){t.write(e.async?"async ":"",e);const{params:n}=e;null!=n&&(1===n.length&&"I"===n[0].type[0]?t.write(n[0].name,n[0]):my(t,e.params)),t.write(" => "),"O"===e.body.type[0]?(t.write("("),this.ObjectExpression(e.body,t),t.write(")")):this[e.body.type](e.body,t)},ThisExpression(e,t){t.write("this",e)},Super(e,t){t.write("super",e)},RestElement:Sy=function(e,t){t.write("..."),this[e.argument.type](e.argument,t)},SpreadElement:Sy,YieldExpression(e,t){t.write(e.delegate?"yield*":"yield"),e.argument&&(t.write(" "),this[e.argument.type](e.argument,t))},AwaitExpression(e,t){t.write("await ",e),vy(t,e.argument,e)},TemplateLiteral(e,t){const{quasis:n,expressions:i}=e;t.write("`");const{length:r}=i;for(let o=0;o<r;o++){const e=i[o],r=n[o];t.write(r.value.raw,r),t.write("${"),this[e.type](e,t),t.write("}")}const s=n[n.length-1];t.write(s.value.raw,s),t.write("`")},TemplateElement(e,t){t.write(e.value.raw,e)},TaggedTemplateExpression(e,t){this[e.tag.type](e.tag,t),this[e.quasi.type](e.quasi,t)},ArrayExpression:Ly=function(e,t){if(t.write("["),e.elements.length>0){const{elements:n}=e,{length:i}=n;for(let e=0;;){const r=n[e];if(null!=r&&this[r.type](r,t),!(++e<i)){null==r&&t.write(", ");break}t.write(", ")}}t.write("]")},ArrayPattern:Ly,ObjectExpression(e,t){const n=t.indent.repeat(t.indentLevel++),{lineEnd:i,writeComments:r}=t,s=n+t.indent;if(t.write("{"),e.properties.length>0){t.write(i),r&&null!=e.comments&&by(t,e.comments,s,i);const o=","+i,{properties:a}=e,{length:l}=a;for(let e=0;;){const n=a[e];if(r&&null!=n.comments&&by(t,n.comments,s,i),t.write(s),this[n.type](n,t),!(++e<l))break;t.write(o)}t.write(i),r&&null!=e.trailingComments&&by(t,e.trailingComments,s,i),t.write(n+"}")}else r?null!=e.comments?(t.write(i),by(t,e.comments,s,i),null!=e.trailingComments&&by(t,e.trailingComments,s,i),t.write(n+"}")):null!=e.trailingComments?(t.write(i),by(t,e.trailingComments,s,i),t.write(n+"}")):t.write("}"):t.write("}");t.indentLevel--},Property(e,t){e.method||"i"!==e.kind[0]?this.MethodDefinition(e,t):(e.shorthand||(e.computed?(t.write("["),this[e.key.type](e.key,t),t.write("]")):this[e.key.type](e.key,t),t.write(": ")),this[e.value.type](e.value,t))},ObjectPattern(e,t){if(t.write("{"),e.properties.length>0){const{properties:n}=e,{length:i}=n;for(let e=0;this[n[e].type](n[e],t),++e<i;)t.write(", ")}t.write("}")},SequenceExpression(e,t){my(t,e.expressions)},UnaryExpression(e,t){if(e.prefix){const{operator:n,argument:i,argument:{type:r}}=e;t.write(n);const s=gy(t,i,e);s||!(n.length>1)&&("U"!==r[0]||"n"!==r[1]&&"p"!==r[1]||!i.prefix||i.operator[0]!==n||"+"!==n&&"-"!==n)||t.write(" "),s?(t.write(n.length>1?" (":"("),this[r](i,t),t.write(")")):this[r](i,t)}else this[e.argument.type](e.argument,t),t.write(e.operator)},UpdateExpression(e,t){e.prefix?(t.write(e.operator),this[e.argument.type](e.argument,t)):(this[e.argument.type](e.argument,t),t.write(e.operator))},AssignmentExpression(e,t){this[e.left.type](e.left,t),t.write(" "+e.operator+" "),this[e.right.type](e.right,t)},AssignmentPattern(e,t){this[e.left.type](e.left,t),t.write(" = "),this[e.right.type](e.right,t)},BinaryExpression:ky=function(e,t){const n="in"===e.operator;n&&t.write("("),vy(t,e.left,e,!1),t.write(" "+e.operator+" "),vy(t,e.right,e,!0),n&&t.write(")")},LogicalExpression:ky,ConditionalExpression(e,t){const{test:n}=e,i=t.expressionsPrecedence[n.type];i===py||i<=t.expressionsPrecedence.ConditionalExpression?(t.write("("),this[n.type](n,t),t.write(")")):this[n.type](n,t),t.write(" ? "),this[e.consequent.type](e.consequent,t),t.write(" : "),this[e.alternate.type](e.alternate,t)},NewExpression(e,t){t.write("new ");const n=t.expressionsPrecedence[e.callee.type];n===py||n<t.expressionsPrecedence.CallExpression||function(e){let t=e;for(;null!=t;){const{type:e}=t;if("C"===e[0]&&"a"===e[1])return!0;if("M"!==e[0]||"e"!==e[1]||"m"!==e[2])return!1;t=t.object}}(e.callee)?(t.write("("),this[e.callee.type](e.callee,t),t.write(")")):this[e.callee.type](e.callee,t),my(t,e.arguments)},CallExpression(e,t){const n=t.expressionsPrecedence[e.callee.type];n===py||n<t.expressionsPrecedence.CallExpression?(t.write("("),this[e.callee.type](e.callee,t),t.write(")")):this[e.callee.type](e.callee,t),e.optional&&t.write("?."),my(t,e.arguments)},ChainExpression(e,t){this[e.expression.type](e.expression,t)},MemberExpression(e,t){const n=t.expressionsPrecedence[e.object.type];n===py||n<t.expressionsPrecedence.MemberExpression?(t.write("("),this[e.object.type](e.object,t),t.write(")")):this[e.object.type](e.object,t),e.computed?(e.optional&&t.write("?."),t.write("["),this[e.property.type](e.property,t),t.write("]")):(e.optional?t.write("?."):t.write("."),this[e.property.type](e.property,t))},MetaProperty(e,t){t.write(e.meta.name+"."+e.property.name,e)},Identifier(e,t){t.write(e.name,e)},Literal(e,t){null!=e.raw?t.write(e.raw,e):null!=e.regex?this.RegExpLiteral(e,t):null!=e.bigint?t.write(e.bigint+"n",e):t.write(uy(e.value),e)},RegExpLiteral(e,t){const{regex:n}=e;t.write(`/${n.pattern}/${n.flags}`,e)}},Ty={};let Ay=class{constructor(e){const t=null==e?Ty:e;this.output="",null!=t.output?(this.output=t.output,this.write=this.writeToStream):this.output="",this.generator=null!=t.generator?t.generator:Py,this.expressionsPrecedence=null!=t.expressionsPrecedence?t.expressionsPrecedence:fy,this.indent=null!=t.indent?t.indent:"  ",this.lineEnd=null!=t.lineEnd?t.lineEnd:"\n",this.indentLevel=null!=t.startingIndentLevel?t.startingIndentLevel:0,this.writeComments=!!t.comments&&t.comments,null!=t.sourceMap&&(this.write=null==t.output?this.writeAndMap:this.writeToStreamAndMap,this.sourceMap=t.sourceMap,this.line=1,this.column=0,this.lineEndSize=this.lineEnd.split("\n").length-1,this.mapping={original:null,generated:this,name:void 0,source:t.sourceMap.file||t.sourceMap._file})}write(e){this.output+=e}writeToStream(e){this.output.write(e)}writeAndMap(e,t){this.output+=e,this.map(e,t)}writeToStreamAndMap(e,t){this.output.write(e),this.map(e,t)}map(e,t){if(null!=t){const{type:n}=t;if("L"===n[0]&&"n"===n[2])return this.column=0,void this.line++;if(null!=t.loc){const{mapping:e}=this;e.original=t.loc.start,e.name=t.name,this.sourceMap.addMapping(e)}if("T"===n[0]&&"E"===n[8]||"L"===n[0]&&"i"===n[1]&&"string"==typeof t.value){const{length:t}=e;let{column:n,line:i}=this;for(let r=0;r<t;r++)"\n"===e[r]?(n=0,i++):n++;return this.column=n,void(this.line=i)}}const{length:n}=e,{lineEnd:i}=this;n>0&&(this.lineEndSize>0&&(1===i.length?e[n-1]===i:e.endsWith(i))?(this.line+=this.lineEndSize,this.column=0):this.column+=n)}toString(){return this.output}};const My={allowReturnOutsideFunction:!0,locations:!0,ecmaVersion:2020},Iy=e=>{const t=yg(e,{ecmaVersion:3});if("Program"!==t.type)throw new Error("unexpected parse output");const n=t.body[0];if(!n||"ExpressionStatement"!==n.type)throw new Error("unexpected parse output");return n},_y=e=>{const t=Iy(e).expression;if(!t||"CallExpression"!==t.type)throw new Error("unexpected parse output");return t},Oy={"-":"_ENV.operatorOverloads.negate()"},Ny={"+":"_ENV.operatorOverloads.add()","-":"_ENV.operatorOverloads.sub()","*":"_ENV.operatorOverloads.mul()","/":"_ENV.operatorOverloads.div()","%":"_ENV.operatorOverloads.mod()","==":"_ENV.operatorOverloads.doubleEquals()","===":"_ENV.operatorOverloads.tripleEquals()","!=":"_ENV.operatorOverloads.doubleNotEquals()","!==":"_ENV.operatorOverloads.tripleNotEquals()"},Dy={"+=":"_ENV.operatorOverloads.add()","-=":"_ENV.operatorOverloads.sub()","*=":"_ENV.operatorOverloads.mul()","/=":"_ENV.operatorOverloads.div()","%=":"_ENV.operatorOverloads.mod()"},Ry=e=>Iy(`_ENV.lineNum(${e});`),Fy=e=>{if(!e)return e;if("UnaryExpression"===e.type){const t=Oy[e.operator];if(t){const n=_y(t);return n.arguments=[e.argument],Fy(n)}}if("BinaryExpression"===e.type){const t=Ny[e.operator];if(t){const n=_y(t);return n.arguments=[e.left,e.right],Fy(n)}}if("AssignmentExpression"===e.type){const t=Dy[e.operator];if(t){const n=_y(t);n.arguments=[e.left,e.right];const i={type:"AssignmentExpression",operator:"=",left:e.left,right:n};return Fy(i)}}if(e.body&&Array.isArray(e.body)&&"ClassBody"!==e.type?e={...e,body:By(e.body)}:e.consequent&&Array.isArray(e.consequent)&&(e={...e,consequent:By(e.consequent)}),Array.isArray(e)){const t=[];for(let n of e)t.push(Fy(n));return t}if(e&&"object"==typeof e){const t={};for(let n of Object.keys(e))"parents"!==n&&(t[n]=Fy(e[n]));return t}return e},By=e=>{const t=[];for(const n of e)n&&(n.loc&&t.push(Ry(n.loc.end.line)),t.push(n));return t},Vy=qs().namedCapture("Undefined").string("undefined").end(),jy=qs().namedCapture("Boolean").anyOf.string("true").string("false").end().end(),Hy=qs().namedCapture("Number").optional.anyOfChars("-+").anyOf.group.oneOrMore.digit.optional.string(".").zeroOrMore.digit.end().group.string(".").oneOrMore.digit.end().end().optional.group.anyOfChars("eE").optional.anyOfChars("-+").oneOrMore.digit.end().end(),Uy=qs().namedCapture("String").string('"').zeroOrMore.anyOf.anythingButChars('"').string('"').end().string('"').end(),zy=qs().namedCapture("Vec").string("Vec(").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"VecX"}).zeroOrMore.whitespaceChar.string(",").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"VecY"}).zeroOrMore.whitespaceChar.string(")").end(),Wy=qs().namedCapture("AffineMatrix").string("AffineMatrix(").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"AffineMatrixA"}).zeroOrMore.whitespaceChar.string(",").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"AffineMatrixB"}).zeroOrMore.whitespaceChar.string(",").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"AffineMatrixC"}).zeroOrMore.whitespaceChar.string(",").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"AffineMatrixD"}).zeroOrMore.whitespaceChar.string(",").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"AffineMatrixTx"}).zeroOrMore.whitespaceChar.string(",").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"AffineMatrixTy"}).zeroOrMore.whitespaceChar.string(")").end(),Gy=qs().namedCapture("Color").string("Color(").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"ColorR"}).zeroOrMore.whitespaceChar.string(",").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"ColorG"}).zeroOrMore.whitespaceChar.string(",").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"ColorB"}).zeroOrMore.whitespaceChar.string(",").zeroOrMore.whitespaceChar.subexpression(Hy,{namespace:"ColorA"}).zeroOrMore.whitespaceChar.string(")").end(),$y=qs().namedCapture("RichText").string("RichText(").zeroOrMore.anyChar.string(")").end(),Zy=qs().namedCapture("Font").string("Font(").zeroOrMore.anyChar.string(")").end(),qy=qs().namedCapture("Unit").anyOf.string("in").string("ft").string("mm").string("cm").string("m").string("px").string("pc").string("pt").end().end(),Ky=qs().startOfInput.zeroOrMore.whitespaceChar.anyOf.subexpression(Vy).subexpression(jy).group.anyOf.subexpression(Hy).subexpression(zy).end().zeroOrMore.whitespaceChar.optional.subexpression(qy).end().subexpression(Uy).subexpression(Wy).subexpression(Gy).subexpression($y).subexpression(Zy).end().zeroOrMore.whitespaceChar.endOfInput.toRegex(),Yy=e=>{const t=Ky.exec(e);if(!t||!t.groups)return;let n;if(n=t.groups.Number){return{type:"Number",value:+n,string:n,unit:t.groups.Unit}}if(n=t.groups.Boolean){return{type:"Boolean",value:"true"===n,string:n}}if(n=t.groups.Undefined)return{type:"Undefined",value:void 0,string:n};if(n=t.groups.String){try{const e=JSON.parse(n);if(ks(e))return{type:"String",value:e,string:n}}catch(i){}console.warn("Couldn't parse string literal",n)}else{if(n=t.groups.Vec){const e=t.groups.VecXNumber,i=+e,r=t.groups.VecYNumber,s=+r,o=new It(i,s),a=t.groups.Unit;return{type:"Vec",value:o,string:n,x:{type:"Number",value:i,string:e,unit:a},y:{type:"Number",value:s,string:r,unit:a},unit:a}}if(n=t.groups.AffineMatrix){const e=t.groups.AffineMatrixANumber,i=+e,r=t.groups.AffineMatrixBNumber,s=+r,o=t.groups.AffineMatrixCNumber,a=+o,l=t.groups.AffineMatrixDNumber,c=+l,h=t.groups.AffineMatrixTxNumber,u=+h,d=t.groups.AffineMatrixTyNumber,p=+d;return{type:"AffineMatrix",value:new Ne(i,s,a,c,u,p),string:n,a:{type:"Number",value:i,string:e},b:{type:"Number",value:s,string:r},c:{type:"Number",value:a,string:o},d:{type:"Number",value:c,string:l},tx:{type:"Number",value:u,string:h},ty:{type:"Number",value:p,string:d}}}if(n=t.groups.Color){const e=t.groups.ColorRNumber,i=+e,r=t.groups.ColorGNumber,s=+r,o=t.groups.ColorBNumber,a=+o,l=t.groups.ColorANumber,c=+l;return{type:"Color",value:new Gn(i,s,a,c),string:n,r:{type:"Number",value:i,string:e},g:{type:"Number",value:s,string:r},b:{type:"Number",value:a,string:o},a:{type:"Number",value:c,string:l}}}if(n=t.groups.RichText){const e=Qy(n);if(e)return{type:"RichText",value:e,string:n}}else if(n=t.groups.Font)return eb(n)}},Xy=e=>"CallExpression"===e.type,Jy=(e,t)=>{if("CallExpression"!==e.type)return!1;const n=e.callee;return"Identifier"===n.type&&n.name===t},Qy=e=>{let t;try{t=yg(e,My)}catch(o){return}if("Program"!==t.type)return;if(1!==t.body.length)return;const n=t.body[0];if("ExpressionStatement"!==n.type)return;const i=n.expression;if(!Jy(i,"RichText"))return;const r=i.arguments,s=[];for(let a of r)if("Literal"===a.type&&"string"==typeof a.value)s.push(a.value);else{if(!Xy(a))return;{const e=a.arguments;if(1!==e.length)return;const t=e[0];if(Jy(a,"RichTextGlyph"))return;if(Jy(a,"RichTextSymbol")){if("Literal"!==t.type||"string"!=typeof t.value)return;s.push(new Nt(t.value))}}}return new Ot(...s)},eb=e=>{let t;try{t=yg(e,{...My,locations:!1,ranges:!0})}catch(h){return}if("Program"!==t.type)return;if(1!==t.body.length)return;const n=t.body[0];if("ExpressionStatement"!==n.type)return;const i=n.expression;if(!Jy(i,"Font"))return;const r=i.arguments;if(2!==r.length)return;const s=r[0];if("Literal"!==s.type||!ks(s.value)||!ks(s.raw)||!s.range)return;const o=s.value,a={type:"Font",value:new Tr(o),string:s.raw,url:{type:"String",value:o,string:s.raw},urlRange:{start:s.range[0],end:s.range[1]},options:{},optionRanges:{}},l=(e,t,n)=>{a.options[e]=t,a.optionRanges[e]={start:n[0],end:n[1]},a.value.renderOptions[e]=t.value},c=r[1];if("ObjectExpression"===c.type){for(let t of c.properties){if("Property"!==t.type)return;let n;if("Identifier"===t.key.type)n=t.key.name;else{if("Literal"!==t.key.type||!ks(t.key.value))return;n=t.key.value}if(!Ir(n))return;const i=tb(t,e);if(!i)return;const r=t.value.range;if(!r)return;l(n,i,r)}return a}},tb=(e,t)=>{if(e.value.range)if("Literal"===e.value.type){if(ks(e.value.value))return{type:"String",value:e.value.value,string:t.slice(e.value.range[0],e.value.range[1])};if(Ss(e.value.value))return{type:"Number",value:e.value.value,string:t.slice(e.value.range[0],e.value.range[1])}}else if("UnaryExpression"===e.value.type&&"-"===e.value.operator){const n=e.value.argument;if("Literal"===n.type&&Ss(n.value))return{type:"Number",value:-n.value,string:t.slice(e.value.range[0],e.value.range[1])}}};function nb(){var e=window.crypto.getRandomValues(new Uint8Array(16));e[6]=15&e[6]|64,e[8]=191&e[8]|128;var t="";return t+=e[0].toString(16),t+=e[1].toString(16),t+=e[2].toString(16),t+=e[3].toString(16),t+="-",t+=e[4].toString(16),t+=e[5].toString(16),t+="-",t+=e[6].toString(16),t+=e[7].toString(16),t+="-",t+=e[8].toString(16),t+=e[9].toString(16),t+="-",t+=e[10].toString(16),t+=e[11].toString(16),t+=e[12].toString(16),t+=e[13].toString(16),t+=e[14].toString(16),t+=e[15].toString(16)}const ib=class e{constructor(){this.id=nb();for(const t of this.materialKeys()){let n;Object.defineProperty(this,t,{configurable:!0,enumerable:!0,get(){return e.triggerEvent("get",this,t,n),n},set(i){(Ls(i)||ob(i))&&(i=ab(i,()=>{e.triggerEvent("set",this,t,i)})),e.triggerEvent("set",this,t,i),n=i}})}}indirectKeys(){return[]}childModelObjects(){const t=this.indirectKeys(),n=[];for(const i of this.materialKeys()){if(t.includes(i))continue;const r=this[i];if(r instanceof e)n.push(r);else if(Ls(r))for(const t of r)t instanceof e&&n.push(t);else if(ob(r))for(const t in r){const i=r[t];i instanceof e&&n.push(i)}}return n}resetReducerCache(){var e;this._reducerCache=void 0,null==(e=this._parentModelObject)||e.resetReducerCache()}static subscribe(e){this.subscribers.add(e)}static unsubscribe(e){this.subscribers.delete(e)}static triggerEvent(e,t,n,i){this.subscribers.forEach(r=>r(e,t,n,i))}};ib.subscribers=new Set;let rb=ib;rb.subscribe((e,t,n,i)=>{if("set"!==e)return;t.resetReducerCache();const r=t.materialKeys(),s=t.indirectKeys();if(r.includes(n)&&!s.includes(n))if(i instanceof rb)i._parentModelObject=t;else if(Ls(i))for(const o of i)o instanceof rb&&(o._parentModelObject=t);else if(ob(i))for(const o in i){const e=i[o];e instanceof rb&&(e._parentModelObject=t)}});const sb=Object.getPrototypeOf({}),ob=e=>Es(e)&&Object.getPrototypeOf(e)===sb,ab=(e,t)=>new Proxy(e,{set:(e,n,i)=>(e[n]=i,t(),!0),deleteProperty:(e,n)=>(delete e[n],t(),!0)});class lb extends rb{constructor(){super(...arguments),this.name="",this.parameters=[],this.parameterFolders=[],this.isPassThrough=!1,this.isShowGuides=!1,this.isImmutable=!1,this.isDefaultUniformScale=!0}materialKeys(){return["name","parameters","parameterFolders","isPassThrough","isShowGuides","isImmutable","isDefaultUniformScale","comment"]}parameterWithName(e){return this.allParameters().find(t=>t.name===e)}hasParameterWithName(e){return this.allParameters().some(t=>t.name===e)}hasParameter(e){return this.parameters.includes(e)||this.parameterFolders.some(t=>t.parameters.includes(e))}firstParameterWithInterface(e){return this.allParameters().find(t=>t.interface instanceof e)}allParameters(){const e=this.parameters.slice();for(let t of this.parameterFolders)e.push(...t.parameters);return e}hasParameters(){return this.parameters.length>0||this.parameterFolders.some(e=>e.parameters.length>0)}removeParameter(e){const t=this.parameters.indexOf(e);if(t>=0)this.parameters.splice(t,1);else for(let n of this.parameterFolders){const t=n.parameters.indexOf(e);if(t>=0){n.parameters.splice(t,1);break}}}}const cb=new WeakMap,hb={},ub=(e,t)=>{Ps(!cb.has(t)),cb.set(t,e),hb[e]=t};ub("Vec",It);const db=new WeakMap,pb={},fb=(e,t)=>{const n=(e,t)=>{db.set(e,t),pb[t]=e};Ps(!db.has(t)),n(t,e);let i=0;const r=t=>{if(Xs(t))t.forEach(r);else if(Js(t)&&!db.has(t)){const s=i++;n(t,e+"/"+s),Object.values(t).forEach(r)}};Object.values(t).forEach(r)},mb=e=>db.has(e),gb=e=>cb.get(e.constructor);class vb extends lb{constructor(e){super(),this.projectId="",this.defaultStyle="stroke",this.isAutoScale=!1,this.isPro=!1,this.element=e,this.defaultExportFormat="svg"}materialKeys(){return[...super.materialKeys(),"projectId","element","defaultExportFormat","isAutoScale"]}hasContent(){return this.element.children.length>0}clone(){const e=new vb(this.element.clone());return e.name=this.name,e.parameters=this.parameters.map(e=>e.clone()),e.parameterFolders=this.parameterFolders.map(e=>e.clone()),e.isPassThrough=this.isPassThrough,e.isShowGuides=this.isShowGuides,e.isImmutable=this.isImmutable,e.isDefaultUniformScale=this.isDefaultUniformScale,e.isAutoScale=this.isAutoScale,e.isPro=this.isPro,e.comment=this.comment,e.defaultStyle=this.defaultStyle,e.defaultExportFormat=this.defaultExportFormat,e}}ub("Component",vb);class yb extends lb{constructor(){super(...arguments),this.projectId="",this.code=new _b,this.defaultStyle="stroke",this.defaultExportFormat="svg",this.isAutoScale=!1,this.isPro=!1}materialKeys(){return[...super.materialKeys(),"projectId","code","defaultExportFormat","isAutoScale"]}hasContent(){return!0}clone(){const e=new yb;return e.code=this.code.clone(),e.name=this.name,e.parameters=this.parameters.map(e=>e.clone()),e.parameterFolders=this.parameterFolders.map(e=>e.clone()),e.isPassThrough=this.isPassThrough,e.isShowGuides=this.isShowGuides,e.isImmutable=this.isImmutable,e.isDefaultUniformScale=this.isDefaultUniformScale,e.isAutoScale=this.isAutoScale,e.isPro=this.isPro,e.comment=this.comment,e.defaultStyle=this.defaultStyle,e.defaultExportFormat=this.defaultExportFormat,e}}ub("CodeComponent",yb);class bb{}class wb extends bb{constructor(e,t){super(),this.base=e,this.definitions=t}childTraces(){return[this.base,...this.definitions]}}class xb extends bb{constructor(e){super(),this._isSuccess=!1,this.source=e,this.children=[],this.base=new Cb(e.base),this.transform=void 0,this.fill=void 0,this.stroke=void 0,this.modifiers=[]}isSuccess(){return this._isSuccess}isAllSuccess(){return this._isSuccess&&this.children.every(e=>e.isAllSuccess())}childTraces(){return[...this.instanceTraces(),...this.children]}childElementTraces(){var e;return this.source.base.definition instanceof vb?(null==(e=this.base.element)?void 0:e.children)??[]:this.children}instanceTraces(){const e=[this.base];return this.transform&&e.push(this.transform),e.push(...this.modifiers),this.fill&&e.push(this.fill),this.stroke&&e.push(this.stroke),e}instanceExpressionTraces(){return this.instanceTraces().flatMap(e=>e.expressionTraces())}traceForInstance(e){return this.instanceTraces().find(t=>t.source===e)}transformMatrix(){var e,t;if(null==(e=this.transform)?void 0:e.isSuccess()){const e=null==(t=this.transform.code)?void 0:t.evaluationResult;if(Ne.isValid(e))return e}return Ne.indentity}}class Cb extends bb{constructor(e){super(),this._isSuccess=!1,this.source=e,this.args={},this.code=void 0,this.element=void 0}isSuccess(){return this._isSuccess}resultForArgName(e){var t;return null==(t=this.args[e])?void 0:t.evaluationResult}childTraces(){const e=this.expressionTraces();return this.element&&e.push(this.element),e}expressionTraces(){const e=Object.values(this.args);return this.code&&e.push(this.code),e}}class Sb extends bb{constructor(e,t=[]){super(),this.evaluationResult=e,this.messages=t,this.isSuccess=t.every(e=>"error"!==e.logLevel)}childTraces(){return[]}traceByAppendingMessages(e){return new Sb(this.evaluationResult,[...this.messages,...e])}}class kb{constructor(e,t,n=[]){this.geometry=e,this.logLevel=t,this.sourcePath=n}clone(){return new kb(this.geometry,this.logLevel,this.sourcePath.slice())}addParentElement(e){this.sourcePath.unshift(e)}}const Lb=e=>{if(e.isSuccess())return e.result.clone();throw new Error(`Error evaluating ${e.source.definition.name}`)},Eb=e=>{if(void 0!==e){if(null===e)return null;if("function"==typeof e.clone)return e.clone();if(Array.isArray(e))return e.map(Eb);if("object"==typeof e){const t={};for(let n in e)t[n]=Eb(e[n]);return t}return e}},Pb=(e,t)=>{const n=new Sb(e,t);return()=>n},Tb=e=>{let t=0;const n=Yy(e);if(n){if("Number"!==n.type&&"Vec"!==n.type||!n.unit)return{runner:Pb(n.value,[]),references:[],parseSuccess:!0,literal:n};e=`convertUnits((${n.string}), "${n.unit}", cuttle.project.units)`,t=14}const i=(e=>{var t;const n="return "+e;try{const e=yg(n,My);if("Program"===e.type&&1===e.body.length&&"ReturnStatement"===e.body[0].type)return{ast:e,prefixLength:7}}catch(i){}try{return{ast:yg(e,My),prefixLength:0}}catch(i){const e=i;return new Rt(null==e?void 0:e.message,"error",null==(t=null==e?void 0:e.loc)?void 0:t.line)}})(e);if(i instanceof Rt)return{runner:Pb(void 0,[i]),references:[],parseSuccess:!1,literal:n};const{ast:r}=i,s=Mb(r);if(s.length>0)return{runner:Pb(void 0,ls(s.map(e=>{var t;const n=null==(t=e.loc)?void 0:t.end.line;if(void 0!==n)return new Rt("Imports are not allowed inside of expressions","error",n)}))),references:[],parseSuccess:!1,literal:n};const o=Ab(r,i.prefixLength-t),a=Ib(r,o);let l;try{l=new Function("_ENV",a)}catch(c){console.warn("Acorn parsed but eval failed.",a);const e=c instanceof Error?`Parse Error: ${c.message}`:"Parse Error";return{runner:Pb(void 0,[new Rt(e,"error",-1)]),references:[],parseSuccess:!1,literal:n}}return{runner:t=>{const n={};for(let l of o){const i=l.name,r=t.get(i);if(void 0===r&&!t.has(i)){const t=om(e,l.ranges[0].start).line;return new Sb(void 0,[new Rt(`Could not find a reference named '${i}'`,"error",t)])}n[i]=Eb(r)}n.operatorOverloads=t.get("operatorOverloads");let i=0;n.lineNum=e=>{i=e};const r=[],s=e=>{r.push(e.withLineNumber(i))};let a;Ft.subscribe(s);try{const e=l(n);a=new Sb(e,r)}catch(c){let t;t=c instanceof Error?c.message:"string"==typeof c?c:"Unknown error",Ft.consoleError(t),a=new Sb(void 0,r)}return Ft.unsubscribe(s),a},references:o,parseSuccess:!0,literal:n}},Ab=(e,t)=>{const n=[];for(let i of hy(e)){const e=i.name;if("this"===e)continue;const r={name:e,ranges:i.nodes.map(e=>{const n=e.start-t,i=e.end-t;return{start:Math.max(0,n),end:Math.max(0,i)}})};n.push(r)}return n},Mb=e=>{const t=[];return Qv(e,{ImportExpression(e){t.push(e)}}),t},Ib=(e,t)=>{const n=function(e,t){const n=new Ay(t);return n.generator[e.type](e,n),n.output}(e=Fy(e));let i="";for(let r of t){const e=r.name;i+=`let ${e} = _ENV["${e}"];`}return"'use strict';"+i+n};class _b extends rb{materialKeys(){return["jsCode","editingJsCode"]}evaluationIndependentKeys(){return["editingJsCode"]}constructor(e="",t){super(),this.jsCode=e,this.editingJsCode=void 0!==t?t:null}runsSameCodeAs(e){return this.jsCode===e.jsCode}compiled(){return this.jsCode===this._compiledJsCode||(this._compiled=Tb(this.jsCode),this._compiledJsCode=this.jsCode),this._compiled}evaluate(e){return this.compiled().runner(e)}isLiteral(){return void 0!==this.literal()}isComputed(){return!this.isLiteral()}isEmpty(){return 0===this.jsCode.length}isCommitted(){return null===this.editingJsCode}literal(){return this.compiled().literal}literalValue(){var e;return null==(e=this.literal())?void 0:e.value}literalUnit(){const e=this.compiled().literal;if(e&&("Number"===e.type||"Vec"===e.type))return e.unit}literalValueInUnit(e){const t=this.compiled().literal;if(t)return"Number"!==t.type&&"Vec"!==t.type||!t.unit?t.value:Qr(t.value,t.unit,e)}replaceReferences(e,t){const n=[];this.compiled().references.forEach(i=>{i.name===e&&i.ranges.forEach(e=>{n.push({range:e,subranges:[],replacement:t})})}),this.jsCode=((e,t)=>{const n=e=>e.range.end-e.range.start;for(t.sort((e,t)=>n(e)-n(t));t.length>0;){const n=t.shift(),{start:i,end:r}=n.range,s=e.substring(0,i),o=e.substring(r),a=n.subranges.map(t=>e.substring(t.start,t.end));let l=n.replacement;a.forEach((e,t)=>{const n=new RegExp("\\$"+t,"g");l=l.replace(n,e)}),e=s+l+o;const c=l.length-(r-i),h=e=>{e.start>i&&(e.start+=c),e.end>i&&(e.end+=c)};t.forEach(e=>{h(e.range),e.subranges.forEach(h)})}return e})(this.jsCode,n)}clone(){return new _b(this.jsCode,this.editingJsCode)}latestCode(){return this.editingJsCode??this.jsCode}tryCompileAndCommit(e){if(null===this.editingJsCode)return!1;const t=Tb(this.editingJsCode);if(!t.parseSuccess)return!1;if(t.references.length>0){const n=e();if(!t.references.every(e=>n.includes(e.name)))return!1}return this.commitEditingCode(),this._compiled=t,!0}commitEditingCode(){null!==this.editingJsCode&&(this.jsCode=this.editingJsCode,this.editingJsCode=null)}revertEditingCode(){this.editingJsCode=null}}ub("Expression",_b);class Ob extends _b{constructor(e){super("// Explicit Value"),this.value=e}evaluate(e){return new Sb(this.value)}}class Nb extends lb{constructor(){super(...arguments),this.projectId="",this.code=new _b,this.isShowGuides=!0,this.isRepeat=!1}materialKeys(){return[...super.materialKeys(),"projectId","code","icon","isRepeat"]}clone(){const e=new Nb;return e.code=this.code.clone(),e.name=this.name,e.parameters=this.parameters.map(e=>e.clone()),e.parameterFolders=this.parameterFolders.map(e=>e.clone()),e.isRepeat=this.isRepeat,e.isPassThrough=this.isPassThrough,e.isShowGuides=this.isShowGuides,e.isImmutable=this.isImmutable,e.isDefaultUniformScale=this.isDefaultUniformScale,e.comment=this.comment,e}}ub("Modifier",Nb);const Db=(e,t)=>Gr(e,t),Rb=e=>`"${br(e)}"`,Fb=(e,t)=>{const n=e=>Db(e,t);return`Vec(${n(e.x)}, ${n(e.y)})`},Bb=e=>`Color(${e.r.toFixed(3)}, ${e.g.toFixed(3)}, ${e.b.toFixed(3)}, ${e.a.toFixed(3)})`,Vb=(e,t)=>"number"==typeof e?Db(e,t):"string"==typeof e?Rb(e):e instanceof It?Fb(e,t):e instanceof Gn?Bb(e):e instanceof Ne?((e,t)=>{const{a:n,b:i,c:r,d:s,tx:o,ty:a}=e,l=e=>Db(e,t);return`AffineMatrix(${l(n)}, ${l(i)}, ${l(r)}, ${l(s)}, ${l(o)}, ${l(a)})`})(e,t):e instanceof Ot?Hb(e):e instanceof Nt?Ub(e):e instanceof Tr?Wb(e):JSON.stringify(e),jb=(e,t,n)=>{const i=Vb(e,n);return t?`${i} ${t}`:i},Hb=e=>0===e.items.length?Rb(""):1===e.items.length&&Ys(e.items[0])?Rb(e.items[0]):`RichText(${e.items.map(e=>Ys(e)?Rb(e):e instanceof Nt?Ub(e):e instanceof Dt?zb(e):void 0).join(", ")})`,Ub=e=>{const{source:t}=e;return Ys(t)?`RichTextSymbol(${Rb(t)})`:`RichTextSymbol(${Gb(t)})`},zb=e=>`RichTextGlyph(${e.index})`,Wb=e=>Ys(e)?Rb(e):`Font(${Rb(e.url)}, ${Gb(e.renderOptions)})`,Gb=e=>`{${Object.entries(e).map(([e,t])=>`${e}: ${Vb(t)}`).join(", ")}}`;class $b{constructor(){this.isPositionTransformable=!1,this.isRotationTransformable=!1,this.isScaleTransformable=!1,this.isSkewTransformable=!1,this.isVisible=!0,this.precisionDigits=2}}class Zb extends $b{clone(){return new Zb}isValidValue(e){return Qs(e)||Xs(e)}invalidValueMessage(){return"Expected a boolean (true or false)"}}ub("PIBoolean",Zb);class qb extends $b{constructor(e="auto"){super(),this.precisionDigits=e}clone(){return new qb(this.precisionDigits)}isValidValue(e){return Ks(e)||Xs(e)}invalidValueMessage(){return"Expected a number"}}ub("PIScalar",qb);class Kb extends $b{constructor(e="auto"){super(),this.precisionDigits=e}clone(){return new Kb}isValidValue(e){return Ks(e)||Xs(e)}invalidValueMessage(){return"Expected a number"}}ub("PIPercentage",Kb);class Yb extends $b{constructor(){super(...arguments),this.precisionDigits="nudge"}clone(){return new Yb}isValidValue(e){return Ks(e)||Xs(e)}invalidValueMessage(){return"Expected a number"}}ub("PIDistance",Yb);class Xb extends $b{constructor(){super(...arguments),this.precisionDigits=0}clone(){return new Xb}isValidValue(e){return Ks(e)||Xs(e)}invalidValueMessage(){return"Expected a number"}}ub("PIAngle",Xb);class Jb extends $b{constructor(){super(...arguments),this.precisionDigits=0}clone(){return new Jb}isValidValue(e){return Ks(e)||Xs(e)}invalidValueMessage(){return"Expected a number"}}ub("PICount",Jb);class Qb extends $b{constructor(){super(...arguments),this.precisionDigits="nudge"}clone(){return new Qb}isValidValue(e){return Ks(e)||It.isValid(e)||Xs(e)}invalidValueMessage(){return"Expected a number or a Vec"}}ub("PISize",Qb);class ew extends $b{constructor(e){super(),this.isRotationTransformable=!0,this.isScaleTransformable=!0,this.isSkewTransformable=!0,this.precisionDigits="nudge",this.originParameterName=e}clone(){return new ew(this.originParameterName)}isValidValue(e){return It.isValid(e)||Xs(e)}invalidValueMessage(){return"Expected a Vec"}}ub("PIVector",ew);class tw extends $b{constructor(){super(...arguments),this.isPositionTransformable=!0,this.isRotationTransformable=!0,this.isScaleTransformable=!0,this.isSkewTransformable=!0,this.precisionDigits="nudge"}clone(){return new tw}isValidValue(e){return It.isValid(e)||Xs(e)}invalidValueMessage(){return"Expected a Vec"}}ub("PIPoint",tw);class nw extends $b{clone(){return new nw}isValidValue(e){return Gn.isValid(e)||"none"===e||Xs(e)}invalidValueMessage(){return'Expected a Color or "none"'}}ub("PIColor",nw);class iw extends $b{constructor(e){super(),this.options=e}static withStringOptions(e){return new iw(e.map(e=>({label:e,value:e})))}clone(){return new iw(this.options.map(e=>({label:e.label,value:e.value})))}isValidValue(e){return Ys(e)&&this.options.some(t=>t.value===e)}invalidValueMessage(){return`Expected one of the options ${this.options.map(e=>`"${e.value}"`).join(", ")}`}}ub("PISelect",iw);class rw extends iw{constructor(){super([{label:"fill",value:"fill"},{label:"fit",value:"fit"}])}clone(){return new rw}isValidValue(e){return super.isValidValue(e)||Ne.isValid(e)}invalidValueMessage(){return'Expected one of the options "fill", "fit" or an AffineMatrix'}}ub("PIImageTransform",rw);const sw=class e extends $b{constructor(e=[]){super(),this.recommendedValues=e}clone(){return new e(this.recommendedValues.slice())}isValidValue(e){return Ys(e)||e instanceof Tr}invalidValueMessage(){return"Expected a string or a Font"}};sw.options=[{name:"thicken",defaultExpressionCode:"0.0",interface:new Kb(3)},{name:"letterSpacing",defaultExpressionCode:"0.0",interface:new Kb(3)},{name:"lineHeight",defaultExpressionCode:"1.0",interface:new Kb},{name:"connect",defaultExpressionCode:'"none"',interface:iw.withStringOptions(["dots and letters","dots","none"])},{name:"capitalize",defaultExpressionCode:'"none"',interface:iw.withStringOptions(["uppercase","lowercase","none"])},{name:"ligatures",defaultExpressionCode:'"none"',interface:iw.withStringOptions(["none","all"])},{name:"startStyle",defaultExpressionCode:'"none"',interface:iw.withStringOptions(["tail","none"])},{name:"endStyle",defaultExpressionCode:'"none"',interface:iw.withStringOptions(["tail","heart","none"])},{name:"betweenStyle",defaultExpressionCode:'"none"',interface:iw.withStringOptions(["auto","heart","none"]),comment:'"auto" matches the left and right tail options.\n"heart" connects words with a heart.\n"none" leaves spaces between words.'}];let ow=sw;ub("PIFontSelect",ow);class aw extends $b{clone(){return new aw}isValidValue(e){return Ys(e)||Ks(e)||Xs(e)||e instanceof Ot}invalidValueMessage(){return"Expected a string, number, or RichText"}}ub("PIText",aw);class lw extends $b{constructor(e=[]){super(),this.recommendedValues=e}clone(){return new lw(this.recommendedValues.slice())}isValidValue(e){return Ys(e)||e instanceof Nt}invalidValueMessage(){return"Expected a string"}}ub("PIEmoji",lw);class cw extends $b{clone(){return new cw}isValidValue(e){return Ys(e)}invalidValueMessage(){return"Expected a string"}}ub("PIImage",cw);class hw extends rb{materialKeys(){return["name","expression","interface","comment","hidden","isDeprecated"]}constructor(e="",t="",n,i,r,s){super(),this.name=e,this.expression=new _b(t),this.interface=n,this.comment=i,this.hidden=r,this.isDeprecated=s}sanitizedName(){return gf(this.name)}clone(){var e;return new hw(this.name,this.expression.jsCode,null==(e=this.interface)?void 0:e.clone(),this.comment,this.hidden,this.isDeprecated)}isPoint(){return this.interface instanceof tw||void 0===this.interface&&this.expression.isLiteral()&&this.expression.literalValue()instanceof It}setComment(e){return this.comment=e,this}setHidden(e=!0){return this.hidden=e,this}setDeprecated(e=!0){return this.isDeprecated=e,this.expression=new _b("undefined"),this}setDefault(){this.defaultExpression=this.expression.clone()}clearDefault(){delete this.defaultExpression}revertToDefault(){this.defaultExpression&&(this.expression.jsCode=this.defaultExpression.jsCode)}isOverridden(){return Boolean(this.defaultExpression&&!this.defaultExpression.runsSameCodeAs(this.expression))}}ub("Parameter",hw);class uw extends rb{constructor(e,t=[]){super(),this.name=e,this.parameters=t}materialKeys(){return["name","parameters"]}clone(){return new uw(this.name,this.parameters.map(e=>e.clone()))}}ub("ParameterFolder",uw);const dw=(e,t,n)=>pw(e,t,n.map(e=>({label:e,value:e}))),pw=(e,t,n)=>new hw(e,Rb(t),new iw(n)),fw=(e,t,n)=>new hw(e,Wb(t),new ow(n)),mw=(e,t)=>new hw(e,t.toString(),new Zb),gw=(e,t,n)=>new hw(e,n?t.toFixed(n):Db(t),new qb(n)),vw=(e,t,n)=>new hw(e,Db(t,n),new Kb),yw=(e,t)=>new hw(e,Db(t),new Yb),bw=(e,t)=>new hw(e,Db(t),new Xb),ww=(e,t)=>new hw(e,Db(t),new Jb),xw=(e,t)=>{const n=t instanceof It?Fb(t):Db(t);return new hw(e,n,new Qb)},Cw=(e,t,n)=>new hw(e,Fb(t),new ew(n)),Sw=(e,t)=>new hw(e,Fb(t),new tw),kw=(e,t)=>new hw(e,Vb(t),new nw),Lw=(e,t)=>new hw(e,`"${t}"`,new aw),Ew=(e,t)=>new hw(e,`"${t}"`,new cw),Pw=new Nb;Pw.isImmutable=!0,Pw.name="Expand (old)",Pw.parameters=[yw("amount",.1),gw("miterLimit",4),dw("join","miter",["miter","round","bevel"])],Pw.code=new _b("if (amount === 0) return input;\nif (amount < 0) return Contractold({ amount: -amount, miterLimit, join }, input);\n\nreturn CompoundPath.booleanUnion([\n  input,\n  CompoundPath.stroke(input, { width: amount, miterLimit, join }),\n]).copyStyle(input);"),Pw.icon="expand",fb("ExpandDefinition",Pw);const Tw=new Nb;Tw.isImmutable=!0,Tw.name="Contract (old)",Tw.parameters=[yw("amount",.1),gw("miterLimit",4),dw("join","miter",["miter","round","bevel"])],Tw.code=new _b("if (amount === 0) return input;\nif (amount < 0) return Expandold({ amount: -amount, miterLimit, join }, input);\n\nreturn CompoundPath.booleanDifference([\n  input,\n  CompoundPath.stroke(input, { width: amount, miterLimit, join }),\n]).copyStyle(input);"),Tw.icon="contract",fb("ContractDefinition",Tw);const Aw=new Nb;Aw.isImmutable=!0,Aw.name="Join Paths (old)",Aw.parameters=[mw("closed",!1)],Aw.code=new _b("Path(input.allAnchors(), closed)"),fb("JoinPathsDefinition",Aw);const Mw=new Nb;Mw.isImmutable=!0,Mw.name="Merge Paths (old)",Mw.parameters=[yw("tolerance",Be)],Mw.code=new _b("const groupByJoiningPaths = (paths, tolerance) => {\n  if (paths.length <= 1) return paths;\n\n  const toleranceSq = tolerance * tolerance;\n\n  // Clone because we're mutating the input paths (e.g. reversing anchors).\n  let inPaths = paths.map((path) => path.clone());\n  let outPaths;\n  while (true) {\n    outPaths = [];\n    for (let inPath of inPaths) {\n      if (inPath.closed) {\n        outPaths.push(inPath);\n        continue;\n      }\n\n      const inStart = inPath.anchors[0];\n      const inEnd = inPath.anchors[inPath.anchors.length - 1];\n\n      let i = 0;\n      for (let n = outPaths.length; i < n; ++i) {\n        const outPath = outPaths[i];\n        if (outPath.closed) continue;\n        const outStart = outPath.anchors[0];\n        const outEnd = outPath.anchors[outPath.anchors.length - 1];\n        if (inStart.position.distanceSquared(outEnd.position) <= toleranceSq) {\n          outEnd.handleOut.copy(inStart.handleOut);\n          outPath.anchors.push(...inPath.anchors.slice(1));\n          break;\n        } else if (inStart.position.distanceSquared(outStart.position) <= toleranceSq) {\n          outStart.handleIn.copy(inStart.handleOut);\n          outPath.anchors.splice(0, 0, ...inPath.reverse().anchors.slice(0, -1));\n          break;\n        } else if (inEnd.position.distanceSquared(outStart.position) <= toleranceSq) {\n          outStart.handleIn.copy(inEnd.handleIn);\n          outPath.anchors.splice(0, 0, ...inPath.anchors.slice(0, -1));\n          break;\n        } else if (inEnd.position.distanceSquared(outEnd.position) <= toleranceSq) {\n          outEnd.handleOut.copy(inEnd.handleIn);\n          outPath.anchors.push(...inPath.reverse().anchors.slice(1));\n          break;\n        }\n      }\n\n      if (i === outPaths.length) {\n        // The path was not merged. Append it to outPaths for the next interation.\n        outPaths.push(inPath);\n      }\n    }\n\n    if (outPaths.length === inPaths.length) break;\n    inPaths = outPaths;\n  }\n\n  // Close any remaining paths that have matching endpoints\n  for (let path of outPaths) {\n    if (path.anchors.length > 1) {\n      const start = path.anchors[0];\n      const end = path.anchors[path.anchors.length - 1];\n      if (start.position.distanceSquared(end.position) <= toleranceSq) {\n        start.handleIn.copy(end.handleIn);\n        path.anchors.splice(-1, 1);\n        path.closed = true;\n      }\n    }\n  }\n\n  return new Group(outPaths);\n}\nreturn groupByJoiningPaths(input.allPaths(), tolerance);"),fb("MergePathsDefinition",Mw);const Iw=new Nb;Iw.isImmutable=!0,Iw.name="Boolean Union",Iw.code=new _b("\nif (!(input instanceof Group) || input.items.length === 0) {\n  return input;\n}\n\nreturn CompoundPath.booleanUnion(input.items).copyStyle(input);\n".trim()),Iw.icon="boolean_union",fb("BooleanUnionDefinition",Iw);const _w=new Nb;_w.isImmutable=!0,_w.name="Boolean Intersect",_w.code=new _b("\nif (!(input instanceof Group) || input.items.length === 0) {\n  return input;\n}\n\nreturn CompoundPath.booleanIntersect(input.items).copyStyle(input);\n".trim()),_w.icon="boolean_intersection",fb("BooleanIntersectDefinition",_w);const Ow=new Nb;Ow.isImmutable=!0,Ow.name="Boolean Difference",Ow.code=new _b("\nif (!(input instanceof Group) || input.items.length === 0) {\n  return input;\n}\n\nreturn CompoundPath.booleanDifference(input.items).copyStyle(input);\n".trim()),Ow.icon="boolean_difference",fb("BooleanDifferenceDefinition",Ow);const Nw=new Nb;Nw.isImmutable=!0,Nw.name="Mask",Nw.icon="mask",Nw.comment="The top-most shape serves as the mask. Everything else is clipped so that only the portions within the mask remain.",Nw.parameters=[mw("invertMask",!1).setComment("When checked, only the contents outside the mask will be kept."),mw("keepMask",!1).setComment("When checked, the masking shape will be kept.")],Nw.code=new _b('if (!(input instanceof Group) || input.items.length < 2) {\n  console.error("Mask must be applied to a Group with at least 2 items.");\n  return input;\n}\n\nconst maskInput = input.items.pop();\nconst maskPath = CompoundPath.booleanUnion([maskInput]);\nconst inputPaths = input.allPathsAndCompoundPaths();\nconst outPaths = [];\n\nconst shouldKeepPoint = (p) => {\n  return maskPath.containsPoint(p) !== invertMask;\n}\n\nfor (const path of inputPaths) {\n  if (path.fill) {\n    const fillPath = invertMask\n      ? CompoundPath.booleanDifference([path, maskPath])\n      : CompoundPath.booleanIntersect([path, maskPath]);\n    fillPath.assignFill(path.fill);\n    path.removeFill();\n    outPaths.push(fillPath);\n  }\n  if (!path.stroke) continue;\n\n  let contours;\n  if (path instanceof CompoundPath) {\n    contours = path.allPaths();\n  }\n  if (path instanceof Path) {\n    contours = [path];\n  }\n  for (const contourPath of contours) {\n    const xs = contourPath.intersectionsWith([maskPath]);\n\n    // If there are no intersections, then all anchors are either in or out\n    if (xs.length === 0) {\n      const firstAnchorPos = contourPath.anchors[0].position;\n      if (shouldKeepPoint(firstAnchorPos)) {\n        outPaths.push(contourPath);\n      }\n      continue;\n    }\n\n    const times = xs.map((x) => x.primitive1.source.time + x.time1);\n    const slices = contourPath.splitAtTimes(times);\n    const maskedSlices = slices.filter((slice) => {\n      const midTime = slice.timeAtDistance(slice.length() / 2);\n      const mid = slice.positionAtTime(midTime);\n      return shouldKeepPoint(mid);\n    });\n\n    if (maskedSlices.length) {\n      if (maskedSlices.length === 1) {\n        outPaths.push(maskedSlices[0].copyStyle(path));\n      } else {\n        outPaths.push(new CompoundPath(maskedSlices).copyStyle(path));\n      }\n    }\n  }\n}\n\nif (keepMask) {\n  outPaths.push(maskInput);\n}\n\nreturn outPaths;'),fb("MaskDefinition",Nw);const Dw=new Nb;Dw.isImmutable=!0,Dw.name="Flatten",Dw.icon="flatten",Dw.parameters=[kw("backgroundColor",new Gn(1,1,1,1)).setComment("Anything filled with this color will be subtracted out of your result."),mw("strokeResult",!1).setComment("Replaces all fills with strokes in the result."),mw("distribute",!1).setComment("Spaces out each colored layer separately.")],Dw.code=new _b('\nconst layered = false;\nconst result = Group.flatten(input, backgroundColor, layered);\nif (strokeResult) {\n  result.items.forEach(shape => {\n    shape.assignStroke(Stroke(shape.fill.color));\n    shape.removeFill();\n  });\n}\nif (distribute) {\n  let left;\n  result.items.forEach(shape => {\n    const box = shape.boundingBox();\n    if (left === undefined) {\n      left = box.max.x;\n    } else {\n      shape.transform({ position: Vec(left - box.min.x, 0) });\n      left += box.width();\n    }\n  });\n}\nif (result.items.length === 0) {\n  console.warn("Flatten only works on shapes with a fill or non-hairline stroke.")\n}\nreturn result;\n'.trim()),fb("FlattenDefinition",Dw);const Rw=new Nb;Rw.isImmutable=!0,Rw.name="Layered Stack",Rw.icon="layered_stack",Rw.parameters=[kw("backgroundColor",new Gn(1,1,1,1)),mw("strokeResult",!1).setComment("Replaces all fills with strokes in the result."),mw("distribute",!1).setComment("Spaces out each colored layer separately.")],Rw.code=new _b('\nconst layered = true;\nconst result = Group.flatten(input, backgroundColor, layered);\nif (strokeResult) {\n  result.items.forEach(shape => {\n    shape.assignStroke(Stroke(shape.fill.color));\n    shape.removeFill();\n  });\n}\nif (distribute) {\n  let left;\n  result.items.forEach(shape => {\n    const box = shape.boundingBox();\n    if (left === undefined) {\n      left = box.max.x;\n    } else {\n      shape.transform({ position: Vec(left - box.min.x, 0) });\n      left += box.width();\n    }\n  });\n}\nif (result.items.length === 0) {\n  console.warn("Layered Stack only works on shapes with a fill or non-hairline stroke.")\n}\nreturn result;\n'.trim()),fb("LayeredStackDefinition",Rw);const Fw=new Nb;Fw.isImmutable=!0,Fw.name="Remove Holes",Fw.icon="remove_holes",Fw.code=new _b("for (let compoundPath of input.allCompoundPaths()) {\n  const union = CompoundPath.booleanUnion(compoundPath.paths);\n  compoundPath.paths = union.paths;\n}\nreturn input;"),fb("RemoveHolesDefinition",Fw);const Bw=new Nb;Bw.isImmutable=!0,Bw.name="Add Hole",Bw.icon="add_hole",Bw.parameters=[bw("holePlacement",-45),new hw("holeSize","0.19 in",new Yb),new hw("holeThickness","0.10 in",new Yb),dw("style","outer",["outer","inner"])],Bw.code=new _b('const box = input.boundingBox();\nif (!box) return input;\n\n// Placement\nconst boxE = box.expandScalar(0.001);\nconst normalizedP = Vec(\n  clamp(cos(holePlacement - 90), -SQRT1_2, SQRT1_2),\n  clamp(sin(holePlacement - 90), -SQRT1_2, SQRT1_2),\n) * SQRT1_2;\nconst boxP = boxE.center() + normalizedP * Vec(boxE.width(), boxE.height())\nconst closestP = input.closestPoint(boxP).position;\nconst dir = (boxP - closestP).normalize();\n\nconsole.geometry(boxE, boxP, closestP);\n\nif (style === "outer") {\n  const holeCenter = closestP + dir * (holeSize * 0.5);\n  const holeInner = Circle().transform({\n    position: holeCenter,\n    scale: holeSize,\n  });\n  const holeOuter = Circle().transform({\n    position: holeCenter,\n    scale: holeSize + holeThickness * 2,\n  });\n\n  return BooleanDifference({}, Group([\n    BooleanUnion({}, Group([\n      input,\n      holeOuter,\n    ])),\n    holeInner,\n  ]));\n} else {\n  const holeCenter = closestP + -dir * (holeSize * 0.5 + holeThickness);\n  const holeInner = Circle().transform({\n    position: holeCenter,\n    scale: holeSize,\n  });\n\n  return BooleanDifference({}, Group([\n    input,\n    holeInner,\n  ]));\n}'),fb("AddHoleDefinition",Bw);const Vw=new Nb;Vw.isImmutable=!0,Vw.name="Outline Stroke",Vw.parameters=[yw("width",.1),dw("alignment","centered",["centered","inner","outer"]),gw("miterLimit",4),dw("join","round",["miter","round","bevel"]),dw("cap","round",["butt","round","square"])],Vw.code=new _b("\nreturn CompoundPath.stroke(input, {width, alignment, miterLimit, join, cap}).copyStyle(input);\n".trim()),Vw.icon="stroke",fb("OutlineStrokeDefinition",Vw);const jw=new Nb;{jw.isImmutable=!0,jw.name="Expand";const e=yw("distance",.1);e.comment="For kerf compensation, set distance to half the kerf width.",jw.parameters=[e,gw("miterLimit",4),dw("join","round",["miter","round","bevel"])],jw.code=new _b("if (distance === 0) return input;\nif (distance < 0) return Contract({ distance: -distance, miterLimit, join }, input);\n\nreturn CompoundPath.booleanUnion([\n  input,\n  CompoundPath.stroke(input, { width: distance * 2, miterLimit, join }),\n]).copyStyle(input);"),jw.icon="expand",fb("ExpandDefinition1",jw)}const Hw=new Nb;Hw.isImmutable=!0,Hw.name="Contract",Hw.parameters=[yw("distance",.1),gw("miterLimit",4),dw("join","round",["miter","round","bevel"])],Hw.code=new _b("if (distance === 0) return input;\nif (distance < 0) return Expand({ distance: -distance, miterLimit, join }, input);\n\nreturn CompoundPath.booleanDifference([\n  input,\n  CompoundPath.stroke(input, { width: distance * 2, miterLimit, join }),\n]).copyStyle(input);"),Hw.icon="contract",fb("ContractDefinition1",Hw);const Uw=new Nb;Uw.isImmutable=!0,Uw.name="Merge Paths";const zw=yw("connectDistance",1);zw.comment="Path endpoints that are closer than this distance will be connected together.",Uw.parameters=[zw],Uw.icon="merge_paths",Uw.code=new _b('\n// Pre-compute some squared distances for faster distance comparisons later.\nconst mergeDistanceSquared = GEOMETRIC_TOLERANCE * GEOMETRIC_TOLERANCE;\nconst connectDistanceSquared = connectDistance * connectDistance;\nconst maxDistanceSquared = Math.max(mergeDistanceSquared, connectDistanceSquared);\n\nconst output = [];\nfor (let paths of input.allPathsByColor()) {\n  const endPoints = [];\n\n  const removeEndPoint = (ep) => {\n    const index = endPoints.indexOf(ep);\n    if (index === -1) throw "EndPoint does not exist";\n    endPoints.splice(index, 1);\n  };\n  const removePath = (path) => {\n    const index = paths.indexOf(path);\n    if (index === -1) throw "Path does not exist";\n    paths.splice(index, 1);\n  };\n\n  for (let path of paths) {\n    if (!path.closed && path.anchors.length > 0) {\n      const startEndPoint = { path, start: true };\n      const endEndPoint = { path, start: false };\n      startEndPoint.other = endEndPoint;\n      endEndPoint.other = startEndPoint;\n      endPoints.push(startEndPoint, endEndPoint);\n    }\n  }\n\n  const reversePathForEndPoint = (ep) => {\n    ep.path.reverse();\n    ep.start = !ep.start;\n    ep.other.start = !ep.other.start;\n  };\n\n  const endPointAnchor = (ep) => {\n    return ep.start ? ep.path.firstAnchor() : ep.path.lastAnchor();\n  };\n\n  const joinEndPoints = (ep1, ep2, isMerge) => {\n    // ep1 and ep2 will no longer exist.\n    removeEndPoint(ep1);\n    removeEndPoint(ep2);\n\n    if (ep1.path === ep2.path) {\n      // Closing a single path.\n      if (isMerge) {\n        console.geometry(ep1.path.firstAnchor().clone());\n        ep1.path.firstAnchor().handleIn.copy(ep1.path.lastAnchor().handleIn);\n        ep1.path.anchors.splice(ep1.path.anchors.length - 1, 1);\n      } else {\n        console.geometry(Path([ep1.path.lastAnchor().clone(), ep2.path.firstAnchor().clone()]));\n      }\n      ep1.path.closed = true;\n    } else {\n      // ep2.path will no longer exist.\n      removePath(ep2.path);\n\n      if (ep1.start) {\n        // We\'ll prepend ep2.path onto ep1.path.\n        if (ep2.start) reversePathForEndPoint(ep2);\n        if (isMerge) {\n          console.geometry(ep1.path.firstAnchor().clone());\n          ep1.path.firstAnchor().handleIn.copy(ep2.path.lastAnchor().handleIn);\n          ep1.path.anchors.splice(0, 0, ...ep2.path.anchors.slice(0, -1));\n        } else {\n          console.geometry(Path([ep2.path.lastAnchor().clone(), ep1.path.firstAnchor().clone()]));\n          ep1.path.anchors.splice(0, 0, ...ep2.path.anchors);\n        }\n      } else {\n        // We\'ll append ep2.path onto ep1.path.\n        if (!ep2.start) reversePathForEndPoint(ep2);\n        if (isMerge) {\n          console.geometry(ep1.path.lastAnchor().clone());\n          ep1.path.lastAnchor().handleOut.copy(ep2.path.firstAnchor().handleOut);\n          ep1.path.anchors.push(...ep2.path.anchors.slice(1));\n        } else {\n          console.geometry(Path([ep1.path.lastAnchor().clone(), ep2.path.firstAnchor().clone()]));\n          ep1.path.anchors.push(...ep2.path.anchors);\n        }\n      }\n\n      // Make others point to each other.\n      const ep1other = ep1.other;\n      const ep2other = ep2.other;\n      ep1other.other = ep2other;\n      ep2other.other = ep1other;\n      ep2other.path = ep1other.path;\n    }\n  };\n\n  // Consider each pair of endpoints, calculate their distance squared, and order them by this metric.\n  const endPointPairs = [];\n  for (let i = 0; i < endPoints.length; i++) {\n    const ep1 = endPoints[i];\n    const anchor1 = endPointAnchor(ep1);\n    for (let j = i + 1; j < endPoints.length; j++) {\n      const ep2 = endPoints[j];\n      const anchor2 = endPointAnchor(ep2);\n      if (anchor1 === anchor2) continue;\n      const distSq = anchor1.position.distanceSquared(anchor2.position);\n      if (distSq <= maxDistanceSquared) {\n        endPointPairs.push({ ep1, ep2, distSq });\n      }\n    }\n  }\n  endPointPairs.sort((a, b) => a.distSq - b.distSq);\n\n  for (let { ep1, ep2, distSq } of endPointPairs) {\n    if (endPoints.indexOf(ep1) !== -1 && endPoints.indexOf(ep2) !== -1) {\n      const isMerge = distSq <= mergeDistanceSquared;\n      joinEndPoints(ep1, ep2, isMerge);\n    }\n  }\n\n  output.push(...paths);\n}\nreturn output;\n'.trim()),fb("MergePathsDefinition1",Uw);const Ww=new Nb;Ww.isRepeat=!0,Ww.isImmutable=!0,Ww.name="Mirror Repeat",Ww.parameters=[Sw("point1",new It(0,0)),Sw("point2",new It(0,1)),mw("reverse",!1),new hw("repetitions","return 2;\npoint1 // hide this parameter")],Ww.code=new _b("const angle = (point2 - point1).angle();\nconst matrix = AffineMatrix.fromTranslation(point1)\n  .mul(AffineMatrix.fromRotation(angle))\n  .mul(AffineMatrix.fromScale(Vec(1, -1)))\n  .mul(AffineMatrix.fromRotation(-angle))\n  .mul(AffineMatrix.fromTranslation(-1 * point1));\n\ninputs[1].affineTransform(matrix);\nif (reverse) {\n  inputs[1].reverse();\n}\n\nconsole.guide(Axis(point1, point2 - point1));\n\nreturn inputs;"),Ww.icon="mirror_repeat",fb("MirrorRepeatDefinition",Ww);const Gw=new Nb;Gw.isRepeat=!0,Gw.isImmutable=!0,Gw.name="Linear Repeat",Gw.parameters=[Cw("displacement",new It(1,0)),ww("repetitions",6)],Gw.code=new _b("repetitions = trunc(repetitions);\n\nif (repetitions > 1000) {\n  throw new Error('Linear Repeat is limited to 1000 repetitions.');\n}\nfor (let i = 0; i < repetitions; i++) {\n  const matrix = AffineMatrix.fromTranslation(displacement * i);\n  inputs[i].affineTransform(matrix);\n}\nreturn inputs;"),Gw.icon="linear_repeat",fb("LinearRepeatDefinition",Gw);const $w=new Nb;$w.isRepeat=!0,$w.isImmutable=!0,$w.name="Rotational Repeat",$w.parameters=[Sw("center",new It),ww("repetitions",6),bw("endAngle",360).setComment("Set this lower than 360 to repeat partially around the center point."),mw("includeEnd",!1).setComment("Turn this on to include a repetition at the endAngle. You usually want this off if endAngle is 360.")],$w.code=new _b('repetitions = trunc(repetitions);\n\nif (repetitions > 1000) {\n  throw new Error("Rotational Repeat is limited to 1000 repetitions.");\n}\n\nconsole.guide(center);\n\nconst angleInterval = endAngle / (includeEnd ? repetitions - 1 : repetitions);\nfor (let i = 0; i < repetitions; i++) {\n  const matrix = AffineMatrix.fromTranslation(center)\n    .mul(AffineMatrix.fromRotation(i * angleInterval))\n    .mul(AffineMatrix.fromTranslation(-center));\n  inputs[i].affineTransform(matrix);\n}\nreturn inputs;'),$w.icon="rotational_repeat",fb("RotationalRepeatDefinition",$w);const Zw=new Nb;Zw.isRepeat=!0,Zw.isImmutable=!0,Zw.name="Tile Repeat",Zw.parameters=[Cw("displacement1",new It(1,0)),Cw("displacement2",new It(0,1)),ww("repetitions1",4),ww("repetitions2",4),mw("zigzag",!1),new hw("repetitions","repetitions1 * repetitions2")],Zw.code=new _b("repetitions1 = trunc(repetitions1);\nrepetitions2 = trunc(repetitions2);\n\nif (repetitions1 > 1000 || repetitions2 > 1000) {\n  throw new Error('Tile Repeat is limited to 1000 repetitions.');\n}\n\nlet getPosition = (i, j) => {\n  return displacement1 * i + displacement2 * j;\n}\n\nif (zigzag) {\n  // Split displacement1 into its parallel and perpendicular components relative to displacement2\n  const d1 = displacement1.isZero() ? new Vec(1, 0) : displacement1;\n  const d1parallel = displacement2.clone().projectOnto(d1);\n  const d1perpendicular = displacement2 - d1parallel;\n  getPosition = (i, j) => {\n    return displacement1 * i + d1perpendicular * j + d1parallel * (j % 2);\n  }\n}\n\nlet index = 0;\nfor (let i = 0; i < repetitions1; i++) {\n  for (let j = 0; j < repetitions2; j++) {\n    const matrix = AffineMatrix.fromTranslation(getPosition(i, j));\n    inputs[index++].affineTransform(matrix);\n  }\n}\nreturn inputs;"),Zw.icon="tile_repeat",fb("TileRepeatDefinition",Zw);const qw=new Nb;qw.isRepeat=!0,qw.isImmutable=!0,qw.name="Transform Repeat",qw.parameters=[ww("repetitions",6),Sw("position",new It(1,0)),bw("rotation",0),xw("scale",new It(1)),bw("skew",0),Sw("origin",new It(0,0)),yw("scaleStroke",1)],qw.icon="transform_repeat",qw.code=new _b("repetitions = trunc(repetitions);\n\nif (repetitions > 1000) {\n  throw new Error('Transform Repeat is limited to 1000 repetitions.');\n}\nconst result = [inputs[0]];\nlet transformMatrix = AffineMatrix();\nlet repeatMatrix = AffineMatrix.fromTransform({ position, rotation, scale, skew, origin });\nlet strokeScale = 1;\nfor (let i = 1; i < repetitions; i++) {\n  transformMatrix.mul(repeatMatrix);\n  strokeScale *= scaleStroke;\n  inputs[i].affineTransform(transformMatrix);\n  inputs[i].scaleStroke(strokeScale);\n}\nreturn inputs;"),fb("TransformRepeatDefinition",qw);const Kw=new Nb;Kw.isImmutable=!0,Kw.name="Visible",Kw.icon="visible",Kw.learnMorePageLink="/learn/visible",Kw.parameters=[mw("visible",!0)],Kw.code=new _b("if (visible) {\n  return input;\n}\nreturn;"),fb("VisibleDefinition",Kw);const Yw=new Nb;Yw.isImmutable=!0,Yw.name="Round Corners",Yw.parameters=[yw("radius",.25)],Yw.code=new _b("for (let path of input.allPaths()) {\n  path.mergeAnchors();\n  path.roundCorners(radius);\n}\nreturn input;"),Yw.icon="round_corners",fb("RoundCornersDefinition",Yw);const Xw=new Nb;Xw.isImmutable=!0,Xw.name="Dashed Lines",Xw.parameters=[yw("dashLength",.1).setComment("Length of dashes and gaps along the path. To make a pattern with different dash and gap lengths use an array expression, for example: [0.2, 0.1]"),yw("offset",0).setComment("Offsets the start of the dash pattern.")],Xw.code=new _b('let dashLengths = dashLength;\n\nif (typeof dashLength === "number") {\n  dashLengths = [dashLength, dashLength];\n}\n\nif (!Array.isArray(dashLengths)) {\n  throw Error("dashLength parameter has to be a number or array, like [2, 1]");\n}\n\n// Double the array if it\'s not even, to make offset easier to work with\nif (dashLengths.length % 2 !== 0) {\n  dashLengths = dashLengths.concat(dashLengths);\n}\n\nconst dashLengthsSum = dashLengths\n  .reduce((dash, sum) => dash + sum, 0);\n\nif (dashLengthsSum <= 0) {\n  throw Error("Dash lengths need to add up to more than 0.");\n};\n\nconst dashLengthsCount = dashLengths.length;\n\nconst out = input.allPaths().map((path) => {\n  const splitPath = [];\n  const pathLength = path.length();\n\n  if (pathLength / dashLengthsSum * dashLengthsCount > 10000) {\n    throw Error("Too many dashes, try a bigger value in dashLength.");\n  }\n\n  let i = 0;\n  let head = 0;\n  // We want to start the dash pattern on or before the start of the path\n  if (offset !== 0) {\n    head = modulo(offset, dashLengthsSum) - dashLengthsSum;\n  }\n  while (head < pathLength) {\n    const dash = dashLengths[i % dashLengthsCount];\n    const space = dashLengths[(i+1) % dashLengthsCount];\n    let dashStart = head;\n    let dashEnd = head + dash;\n    if (dashStart < 0) {\n      dashStart = 0;\n    }\n    if (dashEnd > pathLength) {\n      dashEnd = pathLength;\n    }\n    if (\n      dashStart >= 0 && dashEnd >= 0 &&\n      dashStart < pathLength && dashEnd <= pathLength &&\n      dashStart < dashEnd\n    ) {\n      splitPath.push(\n        path.slice(\n          path.timeAtDistance(dashStart),\n          path.timeAtDistance(dashEnd)\n        )\n      );\n    }\n    head += dash + space;\n    i += 2;\n  };\n  // Merge last and first dash if needed\n  if (path.closed) {\n    const firstDash = splitPath[0];\n    const firstAnchor = firstDash.anchors[0];\n    const lastDash = splitPath[splitPath.length - 1];\n    const lastAnchor = lastDash.anchors[lastDash.anchors.length - 1];\n    if (\n      firstAnchor.position.equals(lastAnchor.position)\n    ) {\n      const combinedDash = lastDash === firstDash\n        ? Path.fromFragments([firstDash])\n        : Path.fromFragments([lastDash, firstDash]);\n      splitPath.pop();\n      splitPath.splice(0, 1, combinedDash);\n    }\n  }\n  const compoundPath = CompoundPath(splitPath);\n  // Ignores fill\n  compoundPath.assignStroke(path.stroke);\n  return compoundPath;\n});\n\nreturn out;'),Xw.icon="dashed_lines",fb("DashedLinesDefinition",Xw);const Jw=new Nb;Jw.isImmutable=!0,Jw.name="Text Along Path",Jw.learnMorePageLink="/learn/text-along-path",Jw.parameters=[Lw("text","Text Along Path"),fw("font","https://fonts.gstatic.com/s/notosans/v39/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A99d41P6zHtY.ttf"),yw("size",1),dw("align","center",["start","center","end"]),dw("verticalAlign","middle",["top","middle","baseline","bottom"]),vw("offset",0,3),vw("verticalOffset",0,3),dw("welding","none",["everything","letters","none"])],Jw.parameterFolders=[new uw("Advanced",[dw("fit","shrink",["none","shrink","scale","lines evenly spaced"]).setComment('- none: Uses the "size" parameter for scaling.\n- shrink: Uses the size parameter, but if the text is too long this will shrink the text to fit on the path.\n- scale: Fits text to the path exactly. Overrides the "size" and "align" parameters.\n- lines evenly spaced: Use this with multiple lines of text. Each line of text will be placed so that there is even space between each one.'),dw("flip","none",["none","all","auto"]).setComment("- none: Default direction along path.\n- all: Reverse direction along path.\n- auto: Flip each text item to be right-side-up, for example at the bottom of a circle."),dw("transform","rigid",["rigid","warped"]).setComment("- rigid: Rotates each individual letter to align with the path direction. Works best with print fonts.\n- warped: Warps the letters to flow along the path. This distorts letters but preserves connections. Works best with connected text, handwriting, and bubbly fonts.")]),new uw("Deprecated",[vw("letterSpacing",0,3).setDeprecated()])],Jw.code=new _b('font = Font(font); // Make sure we have a Font instance.\nif (letterSpacing !== undefined) {\n  font.renderOptions.letterSpacing = letterSpacing;\n}\n\nconst myFont = getFontFromURL(font);\nif (!myFont) return [];\n\nletterSpacing = myFont.renderOptions.letterSpacing;\n\nconst rich = RichText(text);\nconst textLines = rich.split("\\n");\nconst glyphLines = textLines.map((line) => {\n  return myFont.glyphsFromString(line, { letterSpacing });\n});\n\nif (glyphLines.length === 0) return [];\n\nconst allPaths = input.allPaths();\n\nif (fit === "lines evenly spaced") {\n  if (glyphLines.length <= 1) {\n    console.info("Lines of text will be evenly spaced along each path.");\n  }\n} else {\n  if (allPaths.length > glyphLines.length) {\n    console.info("You have more paths than lines of text, so only the first paths will have text.");\n  }\n  if (allPaths.length < glyphLines.length) {\n    console.info(\n      "You have more lines of text than paths, so the last lines of text will not render.",\n    );\n  }\n}\n\n// Vertical Alignment\nif (verticalAlign === "top") {\n  verticalOffset -= myFont.ascenderHeight;\n} else if (verticalAlign === "middle") {\n  verticalOffset -= (myFont.ascenderHeight + myFont.descenderHeight) / 2;\n} else if (verticalAlign === "bottom") {\n  verticalOffset -= myFont.descenderHeight;\n}\n\n// Made edges that might be slightly off from smooth fully smooth. Mutates anchor handles.\nfunction smoothEdge(edge) {\n  for (let i = 0, len = edge.anchors.length; i < len; i++) {\n    const anchor = edge.anchors[i];\n\n    // Skip first and last anchors of open paths\n    if (!edge.closed && (i === 0 || i === edge.anchors.length - 1)) continue;\n    if (anchor.handleIn.isZero() || anchor.handleOut.isZero()) continue;\n\n    // Align handleOut to be opposite of handleIn (make it more tangent)\n    const outLength = anchor.handleOut.length();\n    anchor.handleOut.copy(anchor.handleIn).negate().normalize().mulScalar(outLength);\n  }\n}\n\nclass Printer {\n  constructor(path) {\n    this.cursor = 0;\n    this.output = [];\n    \n    this.path = path;\n    this.pathLength = this.path.length();\n\n    if (transform === "warped") {\n      this.initializePathEdgesForWarp();\n    }\n  }\n\n  initializePathEdgesForWarp() {\n    this.edges = this.path.edgePaths();\n    this.edges.forEach(smoothEdge);\n    this.edgeLengths = this.edges.map((edge) => edge.length());\n    this.edgeStartDistances = [];\n    let cumulative = 0;\n    for (const len of this.edgeLengths) {\n      this.edgeStartDistances.push(cumulative);\n      cumulative += len;\n    }\n    // Note: this.pathLength should equal cumulative for consistency\n  }\n\n  findEdgeForDistance(distance) {\n    // For closed paths, wrap the distance\n    if (this.path.closed) {\n      distance = modulo(distance, this.pathLength);\n    }\n\n    // Find which edge contains this distance\n    for (let i = 0; i < this.edges.length; i++) {\n      const edgeStart = this.edgeStartDistances[i];\n      const edgeEnd = edgeStart + this.edgeLengths[i];\n\n      if (\n        (distance >= edgeStart && distance < edgeEnd) ||\n        (i === this.edges.length - 1 && distance === edgeEnd)\n      ) {\n        return {\n          edge: this.edges[i],\n          edgeIndex: i,\n          edgeStart: edgeStart,\n          localDistance: distance - edgeStart,\n          edgeLength: this.edgeLengths[i],\n        };\n      }\n    }\n\n    // Distance out of bounds.\n    return;\n  }\n\n  print(glyphLines) {\n    let totalTextLength = 0;\n    let lineWidths = [];\n    glyphLines.forEach((glyphs) => {\n      if (glyphs.length === 0) return;\n      const lineWidth = glyphs.reduce((sum, glyph) => sum + glyph.advanceX, 0) * size;\n      lineWidths.push(lineWidth);\n      totalTextLength += lineWidth;\n    });\n\n    let effectiveFit = fit;\n    if (totalTextLength > this.pathLength) {\n      if (effectiveFit === "shrink") {\n        effectiveFit = "scale";\n      }\n    }\n\n    let scale = size;\n    let lineSpacing = 0;\n\n    if (effectiveFit === "scale") {\n      scale = this.pathLength / (totalTextLength / size);\n      lineWidths = lineWidths.map((width) => width * (scale / size));\n      totalTextLength = lineWidths.reduce((sum, width) => sum + width, 0);\n    } else if (effectiveFit === "lines evenly spaced") {\n      const nonEmptyLines = lineWidths.length;\n      if (this.path.closed || nonEmptyLines === 1) {\n        lineSpacing = (this.pathLength - totalTextLength) / nonEmptyLines;\n      } else {\n        // For open paths with multiple lines, don\'t add space at start and end\n        lineSpacing = (this.pathLength - totalTextLength) / (nonEmptyLines - 1);\n      }\n    }\n\n    let startOffset = this.pathLength * offset; // Apply offset\n\n    if (effectiveFit === "lines evenly spaced" && !this.path.closed && lineWidths.length > 1) {\n      // For open paths with multiple lines, adjust alignment to exclude start/end spacing\n      const totalSpacedLength = totalTextLength + lineSpacing * (lineWidths.length - 1);\n      if (align === "center") {\n        startOffset += (this.pathLength - totalSpacedLength) / 2;\n      } else if (this.align === "end") {\n        startOffset += this.pathLength - totalSpacedLength;\n      }\n    } else {\n      // For closed paths or single-line open paths, keep original alignment\n      if (align === "center") {\n        if (effectiveFit === "lines evenly spaced") {\n          // Closed path, evenly spaced, center: center first text item\n          startOffset += (this.pathLength - lineWidths[0]) / 2;\n        } else {\n          startOffset += (this.pathLength - totalTextLength - lineSpacing * (lineWidths.length - 1)) / 2;\n        }\n      } else if (align === "end") {\n        startOffset += this.pathLength - totalTextLength - lineSpacing * (lineWidths.length - 1);\n      }\n    }\n\n    // Ensure startOffset is within the path length only for closed paths\n    if (this.path.closed) {\n      startOffset = modulo(startOffset, this.pathLength);\n    }\n\n    this.cursor = startOffset;\n\n    glyphLines.forEach((glyphs, index) => {\n      if (glyphs.length === 0) return;\n\n      this.printLine(glyphs, scale);\n\n      // Add line spacing after each line except the last\n      if (index < glyphLines.length - 1) {\n        this.cursor += lineSpacing;\n      }\n    });\n\n    // Log a line normal to the path to illustrate the alignments and offsets\n    let logLineDistance = this.pathLength * offset;\n    if (align === "center") {\n      logLineDistance += this.pathLength / 2;\n    }\n    if (align === "end") {\n      logLineDistance += this.pathLength;\n    }\n    if (this.path.closed) {\n      logLineDistance = modulo(logLineDistance, this.pathLength);\n    } else {\n      logLineDistance = clamp(logLineDistance, 0, this.pathLength);\n    }\n    const textOriginTime = this.path.timeAtDistance(logLineDistance);\n    const textOriginPosition = this.path.positionAtTime(textOriginTime);\n    const textOriginNormal = this.path.normalAtTime(textOriginTime);\n    textOriginPosition.add(textOriginNormal.clone().mulScalar(verticalOffset * -1 * scale));\n    console.geometry(\n      LineSegment(\n        textOriginPosition + textOriginNormal.clone().mulScalar(myFont.ascenderHeight * -1 * scale),\n        textOriginPosition + textOriginNormal.clone().mulScalar(myFont.descenderHeight * -1 * scale),\n      ),\n    );\n  }\n\n  printLine(glyphs, scale) {\n    const lineLength = glyphs.reduce((sum, glyph) => sum + glyph.advanceX, 0) * scale;\n\n    let flipBool = false;\n    if (flip === "auto") {\n      let center = this.cursor + lineLength / 2;\n      // When running off the end of an open path, decide the line\'s "flip" by the end of the path;\n      if (!this.path.closed && (center < 0 || center > this.pathLength)) {\n        center = clamp(center, 0, this.pathLength);\n      }\n      const info = this.info(center);\n      if (info) {\n        const { angle } = info;\n        flipBool = angle >= 90 || angle <= -90;\n      }\n    } else if (flip === "all") {\n      flipBool = true;\n    }\n\n    if (flipBool) {\n      for (let i = glyphs.length - 1; i >= 0; i--) {\n        this.printGlyph(glyphs[i], scale, true);\n        this.cursor += glyphs[i].advanceX * scale;\n      }\n    } else {\n      for (const glyph of glyphs) {\n        this.printGlyph(glyph, scale, false);\n        this.cursor += glyph.advanceX * scale;\n      }\n    }\n  }\n\n  printGlyph(glyph, scale, flipBool) {\n    const { advanceX, geometry } = glyph;\n    const advanceWidthScaled = advanceX * scale;\n    const center = this.cursor + advanceWidthScaled * 0.5;\n\n    if (transform === "warped") {\n      this.printGlyphWarped(glyph, scale, flipBool, center);\n    } else {\n      this.printGlyphNormal(glyph, scale, flipBool, center);\n    }\n  }\n\n  printGlyphNormal(glyph, scale, flipBool, center) {\n    const { advanceX, geometry } = glyph;\n    const info = this.info(center);\n    if (!info) {\n      this.warnTextDoesNotFit();\n      return;\n    }\n\n    const { position, angle } = info;\n\n    const out = geometry.clone().transform({\n      origin: Vec(advanceX * 0.5, verticalOffset),\n      scale,\n      position,\n      rotation: angle + (flipBool ? 180 : 0),\n    });\n\n    this.output.push(out);\n  }\n\n  printGlyphWarped(glyph, scale, flipBool, center) {\n    const { advanceX, geometry } = glyph;\n\n    // Warp to the edge that the glyph center is on.\n    const centerEdgeInfo = this.findEdgeForDistance(center);\n    if (!centerEdgeInfo) return;\n\n    const { edge: centerEdge, localDistance: centerLocal, edgeLength } = centerEdgeInfo;\n\n    const warpedGlyph = geometry.clone().transform({\n      origin: Vec(advanceX * 0.5, verticalOffset),\n      scale,\n    });\n\n    const tolerance = 0.001;\n    function warpGraphic(graphic, mapping) {\n      for (const path of graphic.allPaths()) {\n        path.warpCoordinates(mapping, tolerance);\n      }\n    }\n\n    warpGraphic(warpedGlyph, (p) => {\n      const x = flipBool ? -p.x : p.x;\n\n      // Map all points relative to the center edge\n      // Convert x offset to distance along the center edge\n      const localTargetDistance = centerLocal + x;\n\n      // Get position along the edge, with tangent extension if needed\n      let position, normal;\n\n      if (localTargetDistance < 0) {\n        // Extend before edge start using tangent at t=0\n        const t = 0;\n        const edgePos = centerEdge.positionAtTime(t);\n        const tangent = centerEdge.tangentAtTime(t);\n        normal = tangent.clone().rotate90();\n        position = edgePos.add(tangent.mulScalar(localTargetDistance));\n      } else if (localTargetDistance > edgeLength) {\n        // Extend after edge end\n        const t = centerEdge.endTime();\n        const edgePos = centerEdge.positionAtTime(t);\n        const tangent = centerEdge.tangentAtTime(t);\n        normal = tangent.clone().rotate90();\n        const overhang = localTargetDistance - edgeLength;\n        position = edgePos.add(tangent.mulScalar(overhang));\n      } else {\n        // Normal case - within edge bounds\n        const t = centerEdge.timeAtDistance(localTargetDistance);\n        position = centerEdge.positionAtTime(t);\n        normal = centerEdge.normalAtTime(t);\n      }\n\n      // Apply the normal offset (y component)\n      const normalOffset = normal.mulScalar(flipBool ? -p.y : p.y);\n      return position.add(normalOffset);\n    });\n\n    this.output.push(warpedGlyph);\n  }\n\n  info(distance) {\n    if (this.path.closed) {\n      distance = modulo(distance, this.pathLength);\n    }\n    \n    if (distance < 0) return;\n    if (distance > this.pathLength) return;\n\n    if (transform === "warped") {\n      // Use edge-based calculation for warped style\n      const edgeInfo = this.findEdgeForDistance(distance);\n      const { edge, localDistance, edgeLength } = edgeInfo;\n\n      // Off of the edge, unexpected.\n      if (localDistance < 0 || localDistance > edgeLength) {\n        return;\n      }\n\n      // Normal case - within edge\n      const t = edge.timeAtDistance(localDistance);\n      const position = edge.positionAtTime(t);\n      const derivative = edge.derivativeAtTime(t);\n      const angle = derivative.angle();\n      return { position, angle };\n    } else {\n      const t = this.path.timeAtDistance(distance);\n      const position = this.path.positionAtTime(t);\n      const derivative = this.path.derivativeAtTime(t);\n      const angle = derivative.angle();\n      return { position, angle };\n    }\n  }\n  \n  warnTextDoesNotFit() {\n    if (!this.warnedTextDoesNotFit) {\n      console.warn("The text does not fit on the path. To make it fit, try a smaller font size.");\n    }\n    this.warnedTextDoesNotFit = true;\n  }\n}\n\nconst out = allPaths.map((path, i) => {\n  console.geometry(path);\n\n  const printer = new Printer(path);\n\n  if (fit === "lines evenly spaced") {\n    printer.print(glyphLines);\n  } else {\n    const glyphLine = glyphLines[i];\n    if (!glyphLine) return;\n    printer.print([glyphLine]);\n  }\n\n  if (welding === "everything") {\n    return CompoundPath.booleanUnion(printer.output).copyStyle(path);\n  }\n  if (welding === "letters") {\n    const weldedLetters = printer.output.map((item) => CompoundPath.booleanUnion([item]));\n    return Group(weldedLetters).copyStyle(path);\n  }\n  return Group(printer.output).copyStyle(path);\n});\n\nreturn out.filter(Boolean);'),Jw.icon="text_along_path",fb("TextAlongPathDefinition",Jw);const Qw=new Nb;Qw.isImmutable=!0,Qw.name="Text Within Box",Qw.icon="text_within_box",Qw.parameters=[Lw("text","Text"),fw("font","https://fonts.gstatic.com/s/notosans/v39/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A99d41P6zHtY.ttf"),dw("align","center",["left","center","right"]),dw("verticalAlign","middle",["top","middle","bottom"]),dw("scaling","metrics",["shrink","metrics","grow"]).setComment("metrics - will size using the fonts metrics\nshrink - will size using the font's metrics but then shrink if necessary to force text to always lie strictly within the box, even if the font has characters that overhang their boundaries (some script fonts)\ngrow - will ignore font's metrics and grow the text to be as large as possible so that its still fitting within the box."),dw("welding","none",["everything","letters","none"]),vw("letterSpacing",0,3).setDeprecated(),gw("lineHeight",1,3).setDeprecated()],Qw.code=new _b('// === Generate the text ===\n\nfont = Font(font); // Make sure we have a font instance.\nif (letterSpacing !== undefined) {\n  font.renderOptions.letterSpacing = letterSpacing;\n}\nif (lineHeight !== undefined) {\n  font.renderOptions.lineHeight = lineHeight;\n}\n\nconst myFont = getFontFromURL(font);\nif (!myFont) return [];\n\nletterSpacing = myFont.renderOptions.letterSpacing;\nlineHeight = myFont.renderOptions.lineHeight;\n\nconst linesInfo = myFont.render(text);\n\nlet textWidth = 0;\nconst lineGroups = [];\nfor (let i = 0, len = linesInfo.length; i < len; i++) {\n  const line = linesInfo[i];\n  let { geometry, advanceX } = line;\n  textWidth = max(textWidth, advanceX);\n\n  const position = Vec();\n\n  // Horizontal Alignment\n  if (align === "center") position.x -= advanceX / 2;\n  else if (align === "right") position.x -= advanceX;\n\n  position.y = i * lineHeight + myFont.ascenderHeight;\n  geometry.transform({ position });\n  lineGroups.push(geometry);\n}\n\nconst performWelding = (lineGroups, welding) => {\n  if (welding === "everything") {\n    return CompoundPath.booleanUnion(lineGroups);\n  }\n  if (welding === "letters") {\n    for (const group of lineGroups) {\n      group.items = group.items.map((item) =>\n        CompoundPath.booleanUnion([item])\n      );\n    }\n  }\n  return Group(lineGroups);\n};\nconst textGeometry = performWelding(lineGroups, welding);\n\nconst position = Vec();\nif (align === "center") position.x = textWidth / 2;\nelse if (align === "right") position.x = textWidth;\ntextGeometry.transform({ position });\n\nlet textHeight =\n  myFont.ascenderHeight +\n  (lineGroups.length - 1) * lineHeight -\n  myFont.descenderHeight;\n\n// === Alterations for scaling ===\n\nif (scaling === "shrink") {\n  const textGeometryBoundingBox = textGeometry.boundingBox();\n  if (textGeometryBoundingBox) {\n    const overhangMin = max(Vec(0, 0), -textGeometryBoundingBox.min);\n    const overhangMax = max(\n      Vec(0, 0),\n      textGeometryBoundingBox.max - Vec(textWidth, textHeight)\n    );\n    if (align === "center") {\n      overhangMin.x = overhangMax.x = max(overhangMin.x, overhangMax.x);\n    }\n    if (verticalAlign === "middle") {\n      overhangMin.y = overhangMax.y = max(overhangMin.y, overhangMax.y);\n    }\n    textGeometry.transform({ position: overhangMin });\n    textWidth += overhangMin.x + overhangMax.x;\n    textHeight += overhangMin.y + overhangMax.y;\n  }\n} else if (scaling === "grow") {\n  const textGeometryBoundingBox = textGeometry.boundingBox();\n  if (textGeometryBoundingBox) {\n    textGeometry.transform({ position: -textGeometryBoundingBox.min });\n    textWidth = textGeometryBoundingBox.width();\n    textHeight = textGeometryBoundingBox.height();\n  }\n}\n\n// === Put it in the boxes ===\n\nconst allPaths = input.allPaths();\n\nconst warning =\n  "The Text Within Box modifier can only be applied to Rectangles.";\n\nif (allPaths.length === 0) {\n  console.warn(warning);\n  return;\n}\n\nconst result = [];\n\nfor (const path of allPaths) {\n  // Only apply to boxes.\n  if (path.anchors.length !== 4) {\n    console.warn(warning);\n    continue;\n  }\n\n  const p1 = path.anchors[0].position;\n  const p2 = path.anchors[1].position;\n  const p3 = path.anchors[3].position;\n\n  const width = p1.distance(p2);\n  const height = p1.distance(p3);\n\n  const geometry = textGeometry.clone();\n  let scale = min(width / textWidth, height / textHeight);\n  const rotation = (p2 - p1).angle();\n\n  let position = p1;\n  if (align === "center") {\n    position += (p2 - p1).normalize() * (width - textWidth * scale) * 0.5;\n  } else if (align === "right") {\n    position += (p2 - p1).normalize() * (width - textWidth * scale);\n  }\n  if (verticalAlign === "middle") {\n    position += (p3 - p1).normalize() * (height - textHeight * scale) * 0.5;\n  } else if (verticalAlign === "bottom") {\n    position += (p3 - p1).normalize() * (height - textHeight * scale);\n  }\n\n  // Flip it over if the Rectangle is inverted.\n  if ((p2 - p1).isClockwiseFrom(p3 - p1)) {\n    scale *= Vec(1, -1);\n  }\n\n  geometry.transform({ position, rotation, scale });\n  geometry.copyStyle(path);\n\n  // Original Box\n  console.geometry(path);\n  // Text Bounding Box\n  const textBoundingBox = BoundingBox(Vec(0, 0), Vec(textWidth, textHeight));\n  console.geometry(\n    Path.fromBoundingBox(textBoundingBox).transform({\n      position,\n      rotation,\n      scale,\n    })\n  );\n\n  result.push(geometry);\n}\n\nreturn result;'),fb("TextWithinBoxDefinition",Qw);const ex=new Nb;ex.isImmutable=!0,ex.name="Warp Coordinates",ex.icon="warp_coordinates",ex.parameters=[new hw("mapping","// Sinusoid\nconst wavelength = Vec(1.00, 1.00);\nconst amplitude = Vec(0.10, 0.10);\nconst frequency = 360 / wavelength;\nreturn (p) => {\n  const displacement = Vec(\n    sin(p.y * frequency.y),\n    sin(p.x * frequency.x)\n  );\n  return p + amplitude * displacement;\n};\n\n// Try out these other examples:\n\n// Cartesian to Polar\n// const startAngle = 90;\n// const degreesPerUnit = -180;\n// return (p) => {\n//   const angle = startAngle + p.x * degreesPerUnit;\n//   return Vec.fromAngle(angle) * p.y;\n// }\n\n// Lens\n// const pinch = 0.50;\n// const scale = 1.00;\n// return (p) => {\n//   const r = p.length() / scale;\n//   return p * (pinch * r*r + (1 - pinch));\n// }"),gw("tolerance",.001)],ex.code=new _b("for (let path of input.allPaths()) {\n  path.warpCoordinates(mapping, tolerance);\n}\nreturn input;"),fb("WarpCoordinatesDefinition",ex);const tx=new Nb;tx.isImmutable=!0,tx.name="Remove Overlaps",tx.icon="remove_overlaps",tx.parameters=[gw("tolerance",.001).setComment("Overlaps that are within this distance will be removed."),kw("overlapColor","none").setComment("Optionally re-color all overlapping segments with this color. Choose none if you dont want to use this feature."),mw("mergePaths",!0)],tx.code=new _b('const spansUnion = (path, spans) => {\n  // Sort the overlaps so we only need to iterate over them once.\n  spans = spans.slice().sort((a, b) => a.time1 - b.time1);\n  const endTime = path.endTime();\n  const mergedSpans = [];\n  for (const span1 of spans) {\n    let merged = false;\n    for (const span2 of mergedSpans) {\n      // Merge the span into the existing merged span if they overlap.\n      if (spansOverlapInTime(span1, span2)) {\n        span2.time1 = Math.min(span1.time1, span2.time1);\n        span2.time2 = Math.max(span1.time2, span2.time2);\n        // If the span is already larger than the max time, clamp to the\n        // canonical start and end times.\n        if (spanLength(span2) >= endTime) {\n          // A merged span already covers the whole path, so just return the\n          // canonical full span.\n          return [{ time1: 0, time2: endTime }];\n        }\n        merged = true;\n      }\n    }\n    if (!merged) {\n      mergedSpans.push({ time1: span1.time1, time2: span1.time2 });\n    }\n  }\n  // Merge loop-connected span.\n  if (path.closed) {\n    if (mergedSpans.length >= 2) {\n      const firstSpan = mergedSpans[0];\n      const lastSpan = mergedSpans[mergedSpans.length - 1];\n      if (lastSpan.time2 - endTime === firstSpan.time1) {\n        lastSpan.time2 = firstSpan.time2 + endTime;\n        mergedSpans.shift();\n      }\n    }\n  }\n  return mergedSpans;\n};\n\nconst spansDifference = (path, spans, spansToSubtract) => {\n  // Union spans before working with them so there are no overlaps. This also\n  // sorts them by time.\n  spans = spansUnion(path, spans);\n  spansToSubtract = spansUnion(path, spansToSubtract);\n\n  // Indentity\n  if (spansToSubtract.length < 1) {\n    return spans;\n  }\n  // Subtract everything\n  const endTime = path.endTime();\n  if (\n    spansToSubtract.length === 1 &&\n    spanLength(spansToSubtract[0]) >= endTime\n  ) {\n    return [];\n  }\n\n  const outputSpans = [];\n  for (const span of spans) {\n    let { time1, time2 } = span;\n    if (path.closed) {\n      // If there is a wrapping span to remove it will be the last one. Bump up\n      // time1 to subtract the wrapping span.\n      const lastSpanToSubtract = spansToSubtract[spansToSubtract.length - 1];\n      if (\n        lastSpanToSubtract.time1 < time2 &&\n        lastSpanToSubtract.time2 > endTime &&\n        lastSpanToSubtract.time2 > time1\n      ) {\n        time1 = path.normalizedTime(lastSpanToSubtract.time2);\n      }\n    }\n    for (const spanToSubtract of spansToSubtract) {\n      // Skip spans that don\'t overlap.\n      if (!spansOverlapInTime(span, spanToSubtract)) continue;\n      // Check if there is a new uncovered span.\n      if (spanToSubtract.time1 > time1) {\n        // The front is uncovered. Add it to the output.\n        outputSpans.push({ time1, time2: spanToSubtract.time1 });\n      }\n      // Set the start of the next uncovered span.\n      time1 = spanToSubtract.time2;\n    }\n    if (time1 < time2) {\n      outputSpans.push({ time1, time2 });\n    }\n  }\n\n  return spansUnion(path, outputSpans);\n};\n\nconst spansInverse = (path, spans) => {\n  const fullSpan = { time1: 0, time2: path.endTime() };\n  return spansDifference(path, [fullSpan], spans);\n};\n\nconst pathSlices = (path, spans) => {\n  return spans.map((span) => path.slice(span.time1, span.time2));\n};\n\n// Remove Overlaps is designed to work with stroked paths, so we break apart any\n// compound paths, copying their styles to their component paths.\nconst paths = input.allPathsAndCompoundPaths().flatMap((path) => {\n  if (path instanceof CompoundPath) {\n    return path.paths.map((p) => p.copyStyle(path));\n  }\n  return path;\n});\n\nconst spansOverlapInTime = (span1, span2) => {\n  return span1.time2 >= span2.time1 && span1.time1 <= span2.time2;\n};\nconst spanIncludesTime = (span, time) => {\n  return time >= span.time1 && time <= span.time2;\n};\nconst spanLength = (span) => {\n  return span.time2 - span.time1;\n};\n\n// Find overlaps with paths above each path and remove them.\nconst outputOverlapPaths = [];\nconst outputPaths = [];\nconst spansToRemove = new Map();\nconst ensureSpansToRemove = (path) => {\n  let spans = spansToRemove.get(path);\n  if (!spans) {\n    spans = [];\n    spansToRemove.set(path, spans);\n  }\n  return spans;\n};\nfor (let i = 0; i < paths.length; ++i) {\n  const path1 = paths[i]; // Current path\n  const existingSpansToRemove = ensureSpansToRemove(path1);\n  const newSpansToRemove = [];\n\n  const areaOfInterest = path1.looseBoundingBox();\n  areaOfInterest.expandScalar(tolerance);\n\n  // Vist all paths above the current path.\n  for (let j = i + 1; j < paths.length; ++j) {\n    const path2 = paths[j]; // Path above\n    const overlaps = path1.overlapsWith([path2], areaOfInterest, tolerance);\n\n    const spans1 = spansUnion(\n      path1,\n      overlaps.map((o) => o.span1)\n    );\n    newSpansToRemove.push(...spans1);\n\n    const spans2 = overlaps.map((o) => o.span2);\n    const spansToRemove2 = ensureSpansToRemove(path2);\n    spansToRemove2.push(...spans2);\n  }\n\n  if (overlapColor === "none") {\n    const spansToKeep = spansInverse(path1, newSpansToRemove);\n    const slices1 = pathSlices(path1, spansToKeep);\n    outputPaths.push(...slices1);\n  } else {\n    const allSpansToRemove = spansUnion(path1, [\n      ...existingSpansToRemove,\n      ...newSpansToRemove,\n    ]);\n    const allSpansToKeep = spansInverse(path1, allSpansToRemove);\n    const slices1 = pathSlices(path1, allSpansToKeep);\n    outputPaths.push(...slices1);\n\n    const overlapSpans = spansDifference(\n      path1,\n      newSpansToRemove,\n      existingSpansToRemove\n    );\n    const overlapPaths = pathSlices(path1, overlapSpans);\n    outputOverlapPaths.push(...overlapPaths);\n  }\n}\n\n// Color the overlap paths.\nfor (const path of outputOverlapPaths) {\n  if (path.stroke) {\n    path.stroke.color = overlapColor;\n  }\n}\n\nlet output = Group([...outputPaths, ...outputOverlapPaths]);\n\n// Optionally merge paths of the same style together.\nif (mergePaths) {\n  output = MergePaths({ connectDistance: 0 }, output);\n}\n\nreturn output;'),fb("RemoveOverlapsDefinition",tx);const nx=new Nb;nx.isImmutable=!0,nx.name="Weld And Score",nx.icon="weld_and_score",nx.learnMorePageLink="/learn/weld-and-score",nx.parameters=[kw("scoreColor",new Gn(0,0,1,1)),kw("engraveColor",new Gn(0,0,0,1))],nx.code=new _b("let inputPaths = input.allPathsAndCompoundPaths();\nif (inputPaths.length < 1) return;\n\nconst isScore = (path) => {\n  return path.stroke instanceof Stroke && path.stroke.color.equals(scoreColor);\n};\nconst isEngrave = (path) => {\n  return path.fill instanceof Fill && path.fill.color.equals(engraveColor);\n};\n\n// Transform paths so that they only have either a stroke or fill.\ninputPaths = inputPaths.flatMap((path) => {\n  if (path.fill && path.stroke) {\n    // Split up stroked engrave paths.\n    if (isEngrave(path)) {\n      const engravePath = path.clone().removeStroke();\n      return [engravePath, path.removeFill()];\n    }\n    path.removeFill();\n  }\n  return path;\n});\n\nlet originalStroke = inputPaths[0].stroke;\nif (!originalStroke) {\n  originalStroke = Stroke();\n  if (inputPaths[0].fill) {\n    originalStroke.color = inputPaths[0].fill.color;\n  }\n}\n\nlet cutShape = CompoundPath();\nlet cutPaths = [];\nconst scorePaths = [];\nconst engravePaths = [];\nconst pathCount = inputPaths.length;\n// Iterate top to bottom so that the cut compound path we build up also\n// functions as a mask for scores below it.\nfor (let i = pathCount; --i >= 0; ) {\n  const path = inputPaths[i];\n\n  // Subtract shapes above this shape.\n  const masked = Mask({ invertMask: true }, Group([path, cutShape]));\n  if (isEngrave(path)) {\n    engravePaths.push(masked);\n  } else {\n    scorePaths.push(masked);\n  }\n\n  // Paths that were not already in the score color add to the cut shape.\n  if (!isScore(path)) {\n    cutPaths.push(path);\n    cutShape = BooleanUnion({}, Group(cutPaths));\n  }\n}\n\n// Ensure that scores have a uniform hairline stroke.\nfor (const path of scorePaths) {\n  path.removeFill();\n  path.assignStroke(Stroke(scoreColor));\n}\n\nlet output = Group([...scorePaths, cutShape]);\noutput = RemoveOverlaps(\n  {\n    mergePaths: false,\n    tolerance: 0.001,\n  },\n  output.clone()\n);\n\ncutPaths = [];\noutput.items = output.items.filter((item) => {\n  if (isScore(item)) return true;\n  cutPaths.push(...item.allPaths());\n});\n\n// We can create a compound path without boolean-unioning since we've already removed overlaps.\nconst cutPath = CompoundPath(cutPaths)\n  .removeFill()\n  .assignStroke(originalStroke);\noutput.items.push(cutPath);\noutput.items.reverse();\n\nconst weldedEngrave = BooleanUnion({}, Group(engravePaths));\noutput.items.push(weldedEngrave);\n\nreturn output;"),fb("WeldAndScoreDefinition",nx);const ix=new Nb;ix.isImmutable=!0,ix.name="Warped Text",ix.icon="warped_text",ix.learnMorePageLink="/learn/warped-text",ix.parameters=[Lw("text","Warp"),fw("font","https://fonts.gstatic.com/s/notosans/v39/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A99d41P6zHtY.ttf"),dw("align","center",["left","center","right","stretch left","stretch center","stretch right"]),dw("verticalAlign","middle",["top","middle","bottom","stretch"]),dw("welding","none",["everything","letters","none"])],ix.parameterFolders=[new uw("Advanced",[dw("scaling","grow",["grow","metrics"]).setComment("grow - Will make the text as large as possible to fit within the warped box.\nmetrics - Will size the text using the fonts metrics (allows the use of spaces)."),dw("orientation","upright",["upright","fixed"]).setComment("upright - Will automatically orient your text so its always right side up.\nfixed - Will use the ordering of your anchor points to orient the text. This lets you rotate or flip the warp envelope and your text will follow."),dw("parameterization","distance",["distance","time"]).setComment("distance - Uses distance along edges and results in a more uniform scaling. Usually looks best.\ntime - Uses time along edges. Results in variable scaling."),gw("tolerance",.001).setHidden()]),new uw("Deprecated",[vw("letterSpacing",0,3).setDeprecated(),vw("lineHeight",1,3).setDeprecated()])],ix.code=new _b('// === Generate the text ===\n\n// Make sure we have a Font instance.\nfont = Font(font);\n\n// Support deprecated parameters.\nif (letterSpacing !== undefined) {\n  font.renderOptions.letterSpacing = letterSpacing;\n}\nif (lineHeight !== undefined) {\n  font.renderOptions.lineHeight = lineHeight;\n}\n\nconst myFont = getFontFromURL(font);\nif (!myFont) return [];\n\nletterSpacing = myFont.renderOptions.letterSpacing;\nlineHeight = myFont.renderOptions.lineHeight;\n\nconst linesInfo = myFont.render(text);\n\nlet textWidth = 0;\nconst lineGroups = [];\nfor (let i = 0, len = linesInfo.length; i < len; i++) {\n  const line = linesInfo[i];\n  let { geometry, advanceX } = line;\n  textWidth = max(textWidth, advanceX);\n\n  const position = Vec();\n\n  // Horizontal Alignment\n  if (align === "center" || align === "stretch center") {\n    position.x -= advanceX / 2;\n  } else if (align === "right" || align === "stretch right") {\n    position.x -= advanceX;\n  }\n\n  position.y = i * lineHeight + myFont.ascenderHeight;\n  geometry.transform({ position });\n  lineGroups.push(geometry);\n}\n\nconst performWelding = (lineGroups, welding) => {\n  if (welding === "everything") {\n    return CompoundPath.booleanUnion(lineGroups);\n  }\n  if (welding === "letters") {\n    for (const group of lineGroups) {\n      group.items = group.items.map((item) =>\n        CompoundPath.booleanUnion([item])\n      );\n    }\n  }\n  return Group(lineGroups);\n};\nconst textGeometry = performWelding(lineGroups, welding);\n\nconst position = Vec();\nif (align === "center" || align === "stretch center") {\n  position.x = textWidth / 2;\n} else if (align === "right" || align === "stretch right") {\n  position.x = textWidth;\n}\ntextGeometry.transform({ position });\n\nlet textHeight =\n  myFont.ascenderHeight +\n  (lineGroups.length - 1) * lineHeight -\n  myFont.descenderHeight;\n\n// === Alterations for scaling ===\n\nif (scaling === "grow") {\n  const textGeometryBoundingBox = textGeometry.boundingBox();\n  if (textGeometryBoundingBox) {\n    textGeometry.transform({ position: -textGeometryBoundingBox.min });\n    textWidth = textGeometryBoundingBox.width();\n    textHeight = textGeometryBoundingBox.height();\n  }\n}\n\n// === Warping utilities ===\n\nconst positionAtDistanceAlongPath = (s) => {\n  const len = s.length();\n  return (t) => s.positionAtTime(s.timeAtDistance(t * len));\n};\nconst positionAtTimeAlongPath = (s) => {\n  const end = s.endTime();\n  return (t) => s.positionAtTime(t * end);\n};\n\nconst mapUV = (s1, s2, s3, s4, positionAlongPathFn) => {\n  const s1f = positionAlongPathFn(s1);\n  const s2f = positionAlongPathFn(s2);\n  const s3f = positionAlongPathFn(s3);\n  const s4f = positionAlongPathFn(s4);\n\n  const topLeft = s1f(0);\n  const topRight = s1f(1);\n  const bottomLeft = s3f(1);\n  const bottomRight = s3f(0);\n\n  return (uv) => {\n    const u = saturate(uv.x);\n    const v = saturate(uv.y);\n    const iu = 1 - u;\n    const iv = 1 - v;\n    return (\n      iv * s1f(u) +\n      v * s3f(iu) +\n      iu * s4f(iv) +\n      u * s2f(v) -\n      (iu * iv * topLeft +\n        u * iv * topRight +\n        iu * v * bottomLeft +\n        u * v * bottomRight)\n    );\n  };\n};\n\n// === Path utilities ===\n\nconst splitPathAt4SharpestCorners = (path) => {\n  const end = path.endTime();\n  const corners = [];\n  for (let index = 0; index < end; ++index) {\n    const anchor = path.anchorAtTime(index);\n    const dIn = anchor.handleIn.isZero()\n      ? anchor.position.clone().sub(path.anchorAtTime(index - 1).position)\n      : anchor.handleIn.clone().negate();\n    const dOut = anchor.handleOut.isZero()\n      ? path.anchorAtTime(index + 1).position.clone().sub(anchor.position)\n      : anchor.handleOut.clone();\n    const sharpness = dIn.normalize().dot(dOut.normalize());\n    corners.push({ index, anchor, sharpness });\n  }\n  const best4 = corners.sort((a, b) => a.sharpness - b.sharpness).slice(0, 4);\n  const best4Indices = best4.map((x) => x.index);\n  const edges = path.splitAtTimes(best4Indices);\n  \n  // Rotate the array so the first edge is the one after the first index.\n  edges.push(edges.shift());\n\n  return edges;\n};\n\n// === Put it in the boxes ===\n\nconst allPaths = input.allPaths();\n\nconst warning =\n  "The Text Within Box modifier can only be applied to Rectangles.";\n\nif (allPaths.length === 0) {\n  console.warn(warning);\n  return;\n}\n\nconst result = [];\n\nfor (const rectPath of allPaths) {\n  if (!rectPath.closed) {\n    console.warn(warning);\n    return;\n  }\n\n  if (orientation === "upright") {\n    if (rectPath.signedArea() < 0) {\n      rectPath.reverse();\n    }\n  }\n\n  const rectEdges = splitPathAt4SharpestCorners(rectPath);\n  if (rectEdges.length !== 4) {\n    console.warn(warning);\n    return;\n  }\n\n  if (orientation === "upright") {\n    // Re-orient the edges array: top, right, bottom, left.\n    let ulSum = Infinity;\n    let ulIndex = 0;\n    for (let i = 0; i < 4; ++i) {\n      const p = rectEdges[i].anchors[0].position;\n      const sum = p.x + p.y;\n      if (sum < ulSum) {\n        ulIndex = i;\n        ulSum = sum;\n      }\n    }\n    if (ulIndex > 0) {\n      rectEdges.push(...rectEdges.splice(0, ulIndex));\n    }\n  }\n\n  const [p1, p2, p3, p4] = rectEdges.map((e) => e.anchors[0].position);\n\n  const width = Math.max(p1.distance(p2), p3.distance(p4));\n  const height = Math.max(p1.distance(p4), p2.distance(p3));\n\n  const scale = Vec(width / textWidth, height / textHeight);\n  const minScale = Math.min(scale.x, scale.y);\n  if (!align.startsWith("stretch")) scale.x = minScale;\n  if (verticalAlign !== "stretch") scale.y = minScale;\n\n  let position = Vec();\n  if (align === "center" || align === "stretch center") {\n    position.x += (width - textWidth * scale.x) * 0.5;\n  } else if (align === "right" || align === "stretch right") {\n    position.x += width - textWidth * scale.x;\n  }\n  if (verticalAlign === "middle") {\n    position.y += (height - textHeight * scale.y) * 0.5;\n  } else if (verticalAlign === "bottom") {\n    position.y += height - textHeight * scale.y;\n  }\n\n  const textToUV = AffineMatrix.fromTransform({\n    scale: Vec(scale.x / width, scale.y / height),\n    position: Vec(position.x / width, position.y / height),\n  });\n\n  const [e1, e2, e3, e4] = rectEdges;\n  const positionAlongPathFn = parameterization === "distance"\n    ? positionAtDistanceAlongPath\n    : positionAtTimeAlongPath;\n  const mapUVFn = mapUV(e1, e2, e3, e4, positionAlongPathFn);\n  const warpGraphic = (graphic) => {\n    for (const path of graphic.allPaths()) {\n      path.affineTransform(textToUV).warpCoordinates(mapUVFn, tolerance);\n    }\n    return graphic;\n  };\n\n  const warped = warpGraphic(textGeometry.clone()).copyStyle(rectPath);\n\n  result.push(warped);\n\n  if (textWidth > 0) {\n    const textBox = BoundingBox(Vec(0, 0), Vec(textWidth, textHeight));\n    const warpedTextBox = warpGraphic(Path.fromBoundingBox(textBox));\n    console.geometry(warpedTextBox);\n  }\n}\n\nreturn result;'),fb("WarpedTextDefinition",ix);const rx=new Nb;rx.isImmutable=!0,rx.name="Fit Within",rx.icon="fit_within",rx.parameters=[Sw("position",new It),vw("scale",1,3),mw("keepContainer",!0)],rx.code=new _b('if (!(input instanceof Group && input.items.length > 1)) {\n  console.error("Fit Within must be applied to a group with at least 2 items.");\n  return input;\n}\n\nconst angularResolution = 3.6;\nconst showDebug = false;\nconst gap = 0.001;\n\nconst isEffectivelyFinite = (x) => {\n  return isFinite(x) && Math.abs(x) < 1e10;\n};\n\nconst largestScaleFromCenter = (\n  container,\n  contained,\n  center,\n  angle = 0,\n  spread = 360,\n  allowShrink = true\n) => {\n  const count = Math.max(1, Math.round(spread / angularResolution));\n  const angleIncr = spread / count;\n  const halfSpread = spread / 2;\n  const rays = range(\n    angle - halfSpread + angleIncr / 2,\n    angle + halfSpread,\n    angleIncr\n  ).map((a) => Ray(center, Vec.fromAngle(a)));\n\n  const innerXs = rays.map((ray) => {\n    const xs = ray.intersectionsWith([contained]);\n    if (xs.length < 1) return undefined;\n    xs.sort((a, b) => b.time1 - a.time1);\n    return xs[0];\n  });\n\n  const outerXs = rays.map((ray) => {\n    const xs = ray.intersectionsWith([container]);\n    if (xs.length < 1) return undefined;\n    xs.sort((a, b) => a.time1 - b.time1);\n    return xs[0];\n  });\n\n  let minRatio = Infinity;\n  let minIndex = -1;\n  for (let i = 0; i < count; ++i) {\n    const innerX = innerXs[i];\n    const outerX = outerXs[i];\n    if (innerX && outerX) {\n      if (showDebug) {\n        console.geometry(LineSegment(outerX.position, innerX.position));\n      }\n      const ratio = outerX.time1 / innerX.time1;\n      if (\n        isEffectivelyFinite(ratio) &&\n        ratio < minRatio &&\n        (allowShrink || ratio >= 1)\n      ) {\n        minRatio = ratio;\n        minIndex = i;\n      }\n    }\n  }\n\n  if (minIndex < 0) return undefined;\n\n  const minRay = rays[minIndex];\n  const minOuterX = outerXs[minIndex];\n  const minInnerX = innerXs[minIndex];\n\n  const p1 = minInnerX.position;\n  const p2 = minOuterX.position;\n  const nextCenter = minRay.positionAtTime(minOuterX.time1 - gap * 0.5);\n  const scale = minRatio;\n\n  if (showDebug) {\n    console.guide(\n      LineSegment(p1, p2),\n      nextCenter,\n      minInnerX.primitive2.clone()\n    );\n  }\n\n  return { p1, p2, nextCenter, scale };\n};\n\nconst container = input.items[0];\nconst contained = Group(input.items.slice(1));\n\nconst containedBox = contained.boundingBox();\nif (!containedBox) {\n  console.warn(\n    "Could not compute a bounding box for the inner (first) shape. It may not contain any geometry."\n  );\n  return keepContainer ? input : null;\n}\n\nconst containedCenter = containedBox.center();\n\nconst result = largestScaleFromCenter(container, contained, containedCenter);\nif (!result) return input;\nconst matrix = AffineMatrix.fromTransform({\n  scale: result.scale,\n  position: containedCenter,\n  origin: containedCenter,\n});\ncontained.affineTransform(matrix);\ncontainedCenter.affineTransform(matrix);\n\nlet angle2 = result.p1.clone().sub(result.p2).angle();\nif (result.scale < 1) {\n  angle2 += 180;\n}\nconst result2 = largestScaleFromCenter(\n  container,\n  contained,\n  result.nextCenter,\n  angle2,\n  120,\n  false\n);\nif (!result2) return input;\nconst matrix2 = AffineMatrix.fromTransform({\n  scale: result2.scale,\n  position: result.nextCenter,\n  origin: result.nextCenter,\n});\ncontained.affineTransform(matrix2);\ncontainedCenter.affineTransform(matrix2);\n\n// Apply post-process position and scale tweaks.\ncontained.transform({\n  scale: scale,\n  position: containedCenter + position,\n  origin: containedCenter,\n});\n\nif (keepContainer) {\n  return input;\n} else {\n  console.geometry(container);\n  return contained;\n}'),fb("FitWithinDefinition",rx);const sx=new Nb;sx.isImmutable=!0,sx.name="Attach",sx.icon="attach",sx.parameters=[dw("direction","closest",["closest","horizontal","vertical"]),yw("extraDistance",.05).setComment("Shapes will be moved until just touching, and then by this amount extra"),mw("keepBase",!0)],sx.code=new _b('const getDirection = (target, tool, direction) => {\n  if (direction === "horizontal") {\n    const targetBox = target.boundingBox();\n    const toolBox = tool.boundingBox();\n    if (targetBox && toolBox) {\n      const dLeft = targetBox.min.x - toolBox.min.x;\n      const dRight = toolBox.max.x - targetBox.max.x;\n      if (dLeft > dRight) return Vec(1, 0);\n      return Vec(-1, 0);\n    }\n  } else if (direction === "vertical") {\n    const targetBox = target.boundingBox();\n    const toolBox = tool.boundingBox();\n    if (targetBox && toolBox) {\n      const dTop = targetBox.min.y - toolBox.min.y;\n      const dBottom = toolBox.max.y - targetBox.max.y;\n      if (dTop > dBottom) return Vec(0, 1);\n      return Vec(0, -1);\n    }\n  } else if (direction === "closest") {\n    const toolBox = tool.boundingBox();\n    if (toolBox) {\n      const toolCenter = toolBox.center();\n      // Find the closest point on the target.\n      const res1 = target.closestPoint(toolCenter);\n      if (res1) {\n        // Bounce once, finding the closest point on the tool. This step helps\n        // account for tool centers that may lie outside of the tool shape.\n        const res2 = tool.closestPoint(res1.position);\n        if (res2) {\n          return res1.position.clone().sub(res2.position).normalize();\n        }\n      }\n    }\n  }\n};\nconst getTranslation = (target, tool, direction) => {\n  const dir = getDirection(target, tool, direction);\n  if (!dir) return;\n  const d = tool.distanceToIntersect(target, dir, { minOverlap: 0 });\n  if (d !== undefined) {\n    return dir.clone().mulScalar(d + extraDistance);\n  }\n};\n\nconst output = Group();\n\nfor (const shape of input.items) {\n  if (output.items.length > 0) {\n    let translation = getTranslation(output, shape, direction);\n    if (!translation && direction !== "closest") {\n      // Fall back to "closest" direction if the shapes don\'t intersect.\n      translation = getTranslation(output, shape, "closest");\n    }\n    if (translation) {\n      shape.transform({ position: translation });\n    }\n  }\n  // First item is the base shape that does not move\n  output.items.push(shape);\n}\n\nif (!keepBase && output.items.length > 0) {\n  output.items = output.items.slice(1);\n}\n\nreturn output;'),fb("AttachDefinition",sx);const ox=new Nb;ox.isImmutable=!0,ox.name="Split Text",ox.icon="split_text",ox.parameters=[Lw("text","SPLIT"),new hw("font",'Font("https://fonts.gstatic.com/s/literata/v39/or3PQ6P12-iJxAIgLa78DkrbXsDgk0oVDaDPYLanFLHpPf2TbBG_F_bcTWCWp8g.ttf", {capitalize: "uppercase", connect: "dots"})',new ow),dw("align","center",["left","center","right"]),dw("welding","everything and remove extra",["none","everything","everything and remove extra"])],ox.parameterFolders=[new uw("Bars",[dw("bars","both",["underline","overline","both"]),dw("barWidth","box",["box","text"]),new hw("barHeight","0.15 in",new Yb),new hw("overlap","0.02",new Kb)])],ox.code=new _b('font = Font(font);\nfont = getFontFromURL(font);\nif (!font) return;\n\noverlap = max(overlap, 0);\nbarHeight = max(barHeight, 0);\n\nconst capBox = font.glyphsFromString("I")[0].geometry.boundingBox();\nconst capMin = capBox.min.y;\nconst capMax = capBox.max.y;\nconst capHeight = capMax - capMin;\n\nconst safety = capHeight * 0.08;\n\nconst hasUnderline = (bars === "underline" || bars === "both");\nconst hasOverline = (bars === "overline" || bars === "both");\n\n// Modify font to resize outlying letters (J, Q, etc) and normalize to Cap height\nconst modifyFont = (font) => {\n  const newFont = Object.create(font);\n  newFont.glyphsFromString = (text, options) => {\n    const glyphs = font.glyphsFromString(text, options);\n    for (const glyph of glyphs) {\n      const gBox = glyph.geometry.boundingBox();\n      if (!gBox) continue;\n\n      // Original\n      const gMin = gBox.min.y;\n      const gMax = gBox.max.y;\n\n      // Normalize to be within cap height safety region\n\n      // Top\n      let gMin2 = gMin;\n      if (hasOverline) {\n        // Ensure legibility of ascenders with the overline\n        gMin2 = max(gMin2, capMin - safety);\n      }\n      if (!hasUnderline) {\n        // No underline, so ensure it\'s touching the overline\n        gMin2 = min(gMin2, capMin);\n      }\n\n      // Bottom\n      let gMax2 = gMax;\n      if (hasUnderline) {\n        // Ensure legibility of descenders with the overline\n        gMax2 = min(gMax2, capMax + safety);\n      }\n      if (!hasOverline) {\n        // No overline, so ensure it\'s touching the underline\n        gMax2 = max(gMax2, capMax);\n      }\n\n      const scale = (gMax2 - gMin2) / (gMax - gMin);\n      glyph.geometry.transform({\n        position: Vec(0, (gMax2 + gMin2) * 0.5),\n        scale: scale,\n        origin: Vec(0, (gMax + gMin) * 0.5),\n      });\n\n      // Adjust advanceX and advanceWidth\n      glyph.advanceX *= scale;\n      glyph.advanceWidth *= scale;\n    }\n\n    // Normalize so cap height is exactly 1 (+ overlaps)\n    for (const glyph of glyphs) {\n      const yMin = hasOverline ? -1 - overlap : -1;\n      const yMax = hasUnderline ? overlap : 0;\n      const scale = (yMax - yMin) / capHeight;\n      glyph.geometry.transform({\n        position: Vec(0, (yMax + yMin) * 0.5),\n        scale: scale,\n        origin: Vec(0, (capMax + capMin) * 0.5),\n      });\n      glyph.advanceX *= scale;\n      glyph.advanceWidth *= scale;\n    }\n\n    // Fix up x values based on new advanceXs\n    let x = 0;\n    for (const glyph of glyphs) {\n      glyph.x = x;\n      x += glyph.advanceX;\n    }\n\n    return glyphs;\n  };\n  return newFont;\n};\n\n// Put in boxes\n// fn should be: (width, height) => Geometry\nconst putInBoxes = (input, fn) => {\n  const allPaths = input.allPaths();\n\n  const warning = "The Text Within Box modifier can only be applied to Rectangles.";\n\n  if (allPaths.length === 0) {\n    console.warn(warning);\n    return;\n  }\n\n  const result = [];\n\n  for (const path of allPaths) {\n    // Only apply to boxes.\n    if (path.anchors.length !== 4) {\n      console.warn(warning);\n      continue;\n    }\n\n    const p1 = path.anchors[0].position;\n    const p2 = path.anchors[1].position;\n    const p3 = path.anchors[3].position;\n\n    const width = p1.distance(p2);\n    const height = p1.distance(p3);\n\n    const geometry = fn(width, height);\n    const rotation = (p2 - p1).angle();\n\n    let position = p1;\n\n    // Flip it over if the Rectangle is inverted.\n    let scale = Vec(1, 1);\n    if ((p2 - p1).isClockwiseFrom(p3 - p1)) {\n      scale *= Vec(1, -1);\n    }\n\n    geometry.transform({ position, rotation, scale });\n    geometry.copyStyle(path);\n\n    // Original Box\n    console.geometry(path);\n\n    result.push(geometry);\n  }\n\n  return Group(result);\n}\n\n\nfont = modifyFont(font);\n\nconst linesInfo = font.render(text);\nconst lineInfo = linesInfo[0];\n\nconst fn = (width, height) => {\n  const textWidth = lineInfo.advanceX;\n\n  const overlapScale = max(1, 1 + overlap);\n\n  const scale = Vec(\n    min(height, width / textWidth),\n    height\n  );\n\n  const p = {\n    left: 0,\n    center: 0.5,\n    right: 1,\n  }[align];\n\n  let geom = lineInfo.geometry.clone().transform({\n    origin: Vec(textWidth * p, -0.5),\n    position: Vec(width * p, height * 0.5),\n    scale,\n  });\n\n  // Weld\n  geom = BooleanUnion({}, geom);\n\n  // Add bars\n  const barW = (barWidth === "box") ? width : min(width, textWidth);\n  const union = [];\n  if (barHeight > 0 && hasOverline) {\n    union.push(Rectangle().transform({\n      scale: Vec(barW, barHeight),\n      origin: Vec(p - 0.5, 0.5),\n      position: Vec(width * p, 0),\n    }));\n  }\n  if (barHeight > 0 && hasUnderline) {\n    union.push(Rectangle().transform({\n      scale: Vec(barW, barHeight),\n      origin: Vec(p - 0.5, -0.5),\n      position: Vec(width * p, height),\n    }));\n  }\n  union.push(geom);\n\n  if (welding === "none") {\n    return Group(union);\n  } else if (welding === "everything") {\n    return BooleanUnion({}, Group(union));\n  } else if (welding === "everything and remove extra") {\n    const extra = max(barHeight, height * overlap);\n    const sub = [BooleanUnion({}, Group(union))];\n    if (hasOverline) {\n      sub.push(Rectangle().transform({\n        scale: Vec(width*3, height*3),\n        origin: Vec(-0.5, 0.5),\n        position: Vec(0, -extra),\n      }));\n    }\n    if (hasUnderline) {\n      sub.push(Rectangle().transform({\n        scale: Vec(width*3, height*3),\n        origin: Vec(-0.5, -0.5),\n        position: Vec(0, height + extra),\n      }));\n    }\n    return BooleanDifference({}, Group(sub));\n\n  }\n};\nreturn putInBoxes(input, fn);'),fb("SplitTextDefinition",ox);const ax=Object.freeze(Object.defineProperty({__proto__:null,AddHoleDefinition:Bw,AttachDefinition:sx,BooleanDifferenceDefinition:Ow,BooleanIntersectDefinition:_w,BooleanUnionDefinition:Iw,ContractDefinition:Hw,DashedLinesDefinition:Xw,ExpandDefinition:jw,FitWithinDefinition:rx,FlattenDefinition:Dw,LayeredStackDefinition:Rw,LinearRepeatDefinition:Gw,MaskDefinition:Nw,MergePathsDefinition:Uw,MirrorRepeatDefinition:Ww,OldContractDefinition:Tw,OldExpandDefinition:Pw,OutlineStrokeDefinition:Vw,RemoveHolesDefinition:Fw,RemoveOverlapsDefinition:tx,RotationalRepeatDefinition:$w,RoundCornersDefinition:Yw,SplitTextDefinition:ox,TextAlongPathDefinition:Jw,TextWithinBoxDefinition:Qw,TileRepeatDefinition:Zw,TransformRepeatDefinition:qw,VisibleDefinition:Kw,WarpCoordinatesDefinition:ex,WarpedTextDefinition:ix,WeldAndScoreDefinition:nx},Symbol.toStringTag,{value:"Module"})),lx=new Nb;lx.isImmutable=!0,lx.name="Transform",lx.parameters=[Sw("position",new It),bw("rotation",0),xw("scale",1),bw("skew",0),Sw("origin",new It)],lx.code=new _b("if (modulo(skew, 180) === 90) {\n  return undefined;\n}\nreturn AffineMatrix.fromTransform({position, rotation, scale, skew, origin});\n"),lx.icon="outline_transform",fb("TransformDefinition",lx);const cx=new Nb;var hx,ux;cx.isImmutable=!0,cx.name="Fill",cx.parameters=[dw("type","color",["color","image"]),kw("color",new Gn(.5,.5,.5,1)),Ew("image",""),vw("opacity",1,0),(hx="transform",ux="fill",new hw(hx,Rb(ux),new rw))],cx.code=new _b('if (type === "color") {\n  if (!Color.isValid(color)) return input.removeFill();\n  return input.assignFill(Fill(color));\n} else if (type === "image") {\n  const img = getImageFromURL(image);\n  if (!img) return input.removeFill();\n\n  const box = input.boundingBox();\n  if (!box) return input.removeFill();\n  const center = box.center();\n\n  let matrix;\n  if (transform === "fill" || transform === "fit") {\n    const translation = center - 0.5 * Vec(img.width, img.height);\n    matrix = AffineMatrix.fromTranslation(translation);\n    if (transform === "fill") {\n      const ratio = Math.max(box.width() / img.width, box.height() / img.height);\n      matrix.preMul(AffineMatrix.fromCenterScale(center, ratio));\n    } else if (transform === "fit") {\n      const ratio = Math.min(box.width() / img.width, box.height() / img.height);\n      matrix.preMul(AffineMatrix.fromCenterScale(center, ratio));\n    }\n  } else if (AffineMatrix.isValid(transform)) {\n    matrix = transform;\n  }\n\n  if (!matrix) return input;\n\n  return input.assignFill(ImageFill(image, opacity, matrix));\n}\n'),cx.icon="outline_fill",fb("FillDefinition",cx);const dx=new Nb;dx.isImmutable=!0,dx.name="Stroke",dx.parameters=[kw("color",new Gn(0,0,0,1)),mw("hairline",!0),yw("width",.1),dw("alignment","centered",["centered","inner","outer"]),dw("cap","round",["butt","round","square"]),dw("join","round",["miter","round","bevel"]),gw("miterLimit",4)],dx.code=new _b("if (Color.isValid(color)) {\n  return input.assignStroke(Stroke(color, hairline, width, alignment, cap, join, miterLimit));\n} else {\n  return input.removeStroke();\n}\n"),dx.icon="outline_stroke",fb("StrokeDefinition",dx);const px=new Nb;px.isImmutable=!0,px.name="Group",px.code=new _b("input"),fb("GroupDefinition",px);const fx=new Nb;fx.isImmutable=!0,fx.name="Compound Path",fx.code=new _b("CompoundPath(input.allPaths())"),fb("CompoundPathDefinition",fx);const mx=new Nb;mx.isImmutable=!0,mx.name="Path",mx.parameters=[mw("closed",!1)],mx.code=new _b("Path(input.allAnchors(), closed)"),fb("PathDefinition",mx);const gx=new Nb;gx.isImmutable=!0,gx.isPassThrough=!0,gx.isShowGuides=!0,gx.name="Anchor";const vx=Sw("position",new It);vx.interface.isVisible=!1,gx.parameters=[vx,Cw("handleIn",new It,"position"),Cw("handleOut",new It,"position"),dw("handleConstraint","free",["free","tangent","mirror"])],gx.code=new _b("Anchor(position, handleIn, handleOut)"),fb("AnchorDefinition",gx);const yx=Object.freeze(Object.defineProperty({__proto__:null,AnchorDefinition:gx,CompoundPathDefinition:fx,FillDefinition:cx,GroupDefinition:px,PathDefinition:mx,StrokeDefinition:dx,TransformDefinition:lx},Symbol.toStringTag,{value:"Module"}));let bx=class e extends rb{constructor(e){super(),this.name="",this.transform=null,this.modifiers=[],this.fill=null,this.stroke=null,this.children=[],this.isLocked=!1,this.isVisible=!0,this.guidesDisplay="show",this.base=e}materialKeys(){return["name","base","transform","modifiers","fill","stroke","children","isLocked","isVisible","guidesDisplay"]}clone(){const e=this.cloneWithoutChildren();return e.children=this.children.map(e=>e.clone()),e}cloneWithoutChildren(){const t=new e(this.base.clone());return t.name=this.name,this.transform&&(t.transform=this.transform.clone()),t.modifiers=this.modifiers.map(e=>e.clone()),this.fill&&(t.fill=this.fill.clone()),this.stroke&&(t.stroke=this.stroke.clone()),t.isLocked=this.isLocked,t.isVisible=this.isVisible,t.guidesDisplay=this.guidesDisplay,t}hasInstance(e){return e===this.base||e===this.transform||e===this.fill||e===this.stroke||this.modifiers.includes(e)}allInstances(){const e=this.standardInstances();return e.push(...this.modifiers),e}standardInstances(){const e=[this.base];return this.transform&&e.push(this.transform),this.fill&&e.push(this.fill),this.stroke&&e.push(this.stroke),e}allExpressions(){return this.allInstances().flatMap(e=>e.allExpressions())}allDescendants(){const e=[],t=n=>{e.push(n),n.children.forEach(t)};return t(this),e}removeModifier(e){const t=this.modifiers.indexOf(e);t>=0?this.modifiers.splice(t,1):e.isEnabled&&(e.isEnabled=!1)}hasEnabledModifier(){return this.modifiers.some(e=>e.isEnabled)}pasteModifier(e){e.definition===dx?this.stroke=e:e.definition===cx?this.fill=e:e.definition===lx?this.transform=e:this.modifiers.push(e)}isPassThrough(){return this.base.definition.isPassThrough}isPositionLocked(){var e,t,n;const{transform:i}=this,{definition:r,args:s}=this.base;if(r.isPassThrough){for(let o of r.allParameters())if((null==(e=o.interface)?void 0:e.isPositionTransformable)&&(null==(t=s[o.name])?void 0:t.isComputed()))return!0}else if(null==(n=null==i?void 0:i.args.position)?void 0:n.isComputed())return!0;return!1}isRotationLocked(){var e,t,n;const{transform:i}=this,{definition:r,args:s}=this.base;if(r.isPassThrough){for(let o of r.allParameters())if((null==(e=o.interface)?void 0:e.isRotationTransformable)&&(null==(t=s[o.name])?void 0:t.isComputed()))return!0}else if(null==(n=null==i?void 0:i.args.rotation)?void 0:n.isComputed())return!0;return!1}isScaleLocked(){var e,t,n;const{transform:i}=this,{definition:r,args:s}=this.base;if(r.isPassThrough){for(let o of r.allParameters())if((null==(e=o.interface)?void 0:e.isScaleTransformable)&&(null==(t=s[o.name])?void 0:t.isComputed()))return!0}else if(null==(n=null==i?void 0:i.args.scale)?void 0:n.isComputed())return!0;return!1}isSkewLocked(){var e,t,n;const{transform:i}=this,{definition:r,args:s}=this.base;if(r.isPassThrough){for(let o of r.allParameters())if((null==(e=o.interface)?void 0:e.isSkewTransformable)&&(null==(t=s[o.name])?void 0:t.isComputed()))return!0}else if(null==(n=null==i?void 0:i.args.skew)?void 0:n.isComputed())return!0;return!1}isAnyTransformLocked(){return this.isPositionLocked()||this.isRotationLocked()||this.isScaleLocked()||this.isSkewLocked()}isUniformScale(){var e;const t=null==(e=this.transform)?void 0:e.args.scale;return!t||Ks(t.literalValue())}};ub("Element",bx);class wx extends rb{constructor(e){super(),this.args={},this.isEnabled=!0,this.repeatIndexVariableName=null,this.definition=e}materialKeys(){return["definition","args","isEnabled","repeatIndexVariableName"]}indirectKeys(){return["definition"]}clone(){const e=new wx(this.definition);e.isEnabled=this.isEnabled,e.repeatIndexVariableName=this.repeatIndexVariableName;for(let t in this.args)e.args[t]=this.args[t].clone();return e}hasArgumentWithName(e){return this.args.hasOwnProperty(e)&&!this.args[e].isEmpty()}expressionForParameterWithName(e){var t;return this.hasArgumentWithName(e)?this.args[e]:null==(t=this.definition.parameterWithName(e))?void 0:t.expression}allExpressions(){return Object.values(this.args)}isRepeatModifier(){return this.definition instanceof Nb&&Boolean(this.definition.isRepeat)}parametersInEvaluationOrder(){const e=[],t=[],n=[],i=new Set,r=s=>{if(i.add(s.name),!this.hasArgumentWithName(s.name)){t.push(s.name);for(const{name:e}of s.expression.compiled().references){if(e===s.name)continue;if(i.has(e)){t.includes(e)&&n.push(t.slice());continue}const o=this.definition.parameterWithName(e);o&&r(o)}t.pop()}e.push(s)};for(const s of this.definition.allParameters())i.has(s.name)||r(s);return{parameters:e,circularPaths:n}}replaceDefinition(e){const{args:t}=this;for(const n in t)e.hasParameterWithName(n)||delete t[n];for(const n of this.definition.allParameters()){if(void 0!==t[n.name])continue;const i=e.parameterWithName(n.name);i&&(n.expression.jsCode!==i.expression.jsCode&&(t[n.name]=n.expression.clone()))}if(null!==this.repeatIndexVariableName){e instanceof Nb&&e.isRepeat||(this.repeatIndexVariableName=null)}this.definition=e}}ub("Instance",wx);const xx=new yb;xx.isImmutable=!0,xx.isPassThrough=!0,xx.isShowGuides=!0,xx.name="Point Guide",xx.parameters=[Sw("position",new It(0,0))],xx.code=new _b("console.guide(position);"),xx.defaultStyle="none",fb("PointGuideDefinition",xx);const Cx=new yb;let Sx;Cx.isImmutable=!0,Cx.isPassThrough=!0,Cx.isShowGuides=!0,Cx.name="Line Guide",Cx.parameters=[Sw("origin",new It(0,0)),bw("angle",0)],Cx.code=new _b("console.guide(Axis(origin, Vec.fromAngle(angle)));"),Cx.defaultStyle="none",fb("LineGuideDefinition",Cx);{const e=new bx(new wx(gx));e.name="Anchor 1",e.base.args.position=new _b("Vec(0.5, 0)"),e.base.args.handleIn=new _b("Vec(0, -0.275957512247)"),e.base.args.handleOut=new _b("Vec(0, 0.275957512247)"),e.base.args.handleConstraint=new _b('"tangent"');const t=new wx($w);t.args.repetitions=new _b("4"),e.modifiers=[t];const n=new bx(new wx(mx));n.name="Path 1",n.children=[e],n.base.args.closed=new _b("true"),Sx=new vb(new bx(new wx(px))),Sx.isImmutable=!0,Sx.isAutoScale=!0,Sx.isShowGuides=!0,Sx.name="Circle",Sx.element.children=[n],fb("CircleDefinition1",Sx)}const kx=new yb;kx.isImmutable=!0,kx.isPassThrough=!0,kx.isShowGuides=!0,kx.isAutoScale=!0,kx.name="Circle From Center And Point",kx.parameters=[Sw("center",new It(0,0)),Sw("point",new It(.5,0))],kx.code=new _b("console.guide(center);\nreturn Circle().transform({\n  position: center,\n  scale: center.distance(point) * 2,\n  rotation: (point - center).angle(),\n});"),fb("CircleFromCenterAndPointDefinition",kx);const Lx=new yb;Lx.isImmutable=!0,Lx.isPassThrough=!0,Lx.isShowGuides=!0,Lx.isAutoScale=!0,Lx.name="Circle From Two Points",Lx.parameters=[Sw("point1",new It(-.5,0)),Sw("point2",new It(.5,0))],Lx.code=new _b("const center = mix(point1, point2, 0.5);\nconsole.guide(center);\nreturn Circle().transform({\n  position: center,\n  scale: point1.distance(point2),\n  rotation: (point2 - point1).angle(),\n});"),fb("CircleFromTwoPointsDefinition",Lx);const Ex=new yb;let Px,Tx,Ax;Ex.isImmutable=!0,Ex.isPassThrough=!0,Ex.isShowGuides=!0,Ex.isAutoScale=!0,Ex.name="Circle From Three Points",Ex.parameters=[Sw("point1",new It(-.5,0)),Sw("point2",new It(0,-.5)),Sw("point3",new It(.5,0))],Ex.code=new _b('const lineLineIntersection = (p1, p2, p3, p4) => {\n  const denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  return ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n};\n\nconst mid1 = mix(point1, point2, 0.5);\nconst mid2 = mix(point2, point3, 0.5);\nconst bisector1 = (point2 - point1).rotateNeg90();\nconst bisector2 = (point3 - point2).rotateNeg90();\nconst d = lineLineIntersection(mid1, bisector1 + mid1, mid2, bisector2 + mid2);\nif (!Number.isFinite(d)) {\n  console.geometry(Axis(point1, point3 - point1));\n  throw new Error("The three point parameters are in a line, so we can\'t make a circle from them.");\n}\nconst center = bisector1 * d + mid1;\nconsole.guide(center);\n\nreturn Circle().transform({\n  position: center,\n  scale: point1.distance(center) * 2,\n});'),fb("CircleFromThreePointsDefinition",Ex);{const e=new bx(new wx(gx));e.name="Anchor 1",e.base.args.position=new _b("Vec(-0.5, -0.5)");const t=new bx(new wx(gx));t.name="Anchor 2",t.base.args.position=new _b("Vec(0.5, -0.5)");const n=new bx(new wx(gx));n.name="Anchor 3",n.base.args.position=new _b("Vec(0.5, 0.5)");const i=new bx(new wx(gx));i.name="Anchor 4",i.base.args.position=new _b("Vec(-0.5, 0.5)");const r=new bx(new wx(mx));r.name="Path 1",r.children=[e,t,n,i],r.base.args.closed=new _b("true");const s=new bx(new wx(xx));s.name="Point Guide 1",s.base.args.position=new _b("Vec(0.0, 0.0)"),Px=new vb(new bx(new wx(px))),Px.isImmutable=!0,Px.isDefaultUniformScale=!1,Px.isAutoScale=!0,Px.isShowGuides=!0,Px.name="Rectangle",Px.element.children=[r,s],fb("RectangleDefinition2",Px)}{const e=new bx(new wx(gx));e.name="Anchor 1",e.base.args.position=new _b("Vec(0, -0.5)");const t=new wx($w);t.args.repetitions=new _b("sides"),e.modifiers=[t];const n=new bx(new wx(mx));n.name="Path 1",n.base.args.closed=new _b("true"),n.children=[e],Tx=new vb(new bx(new wx(px))),Tx.isImmutable=!0,Tx.isAutoScale=!0,Tx.isShowGuides=!0,Tx.name="Polygon",Tx.parameters=[ww("sides",5)],Tx.element.children=[n],fb("PolygonDefinition1",Tx)}{const e=new bx(new wx(gx));e.name="Anchor 1",e.base.args.position=new _b("Vec(0, -0.5)");const t=new bx(new wx(gx));t.name="Anchor 2",t.base.args.position=new _b("Vec(0, -0.5 * innerRadius).rotate(360 / points / 2)");const n=new bx(new wx(px));n.name="Group 1",n.children=[e,t];const i=new wx($w);i.args.repetitions=new _b("points"),n.modifiers=[i];const r=new bx(new wx(mx));r.name="Path 1",r.base.args.closed=new _b("true"),r.children=[n],Ax=new vb(new bx(new wx(px))),Ax.isImmutable=!0,Ax.isAutoScale=!0,Ax.isShowGuides=!0,Ax.name="Star",Ax.parameters=[ww("points",5),vw("innerRadius",.5,2)],Ax.element.children=[r],fb("StarDefinition",Ax)}const Mx=new yb;Mx.isImmutable=!0,Mx.isPassThrough=!0,Mx.isShowGuides=!0,Mx.isAutoScale=!0,Mx.name="Polygon From Side",Mx.parameters=[Sw("point1",new It(0,0)),Sw("point2",new It(1,0)),ww("sides",5)],Mx.code=new _b("if (sides > 1000) {\n  throw new Error('Polygon is limited to 1000 sides.');\n}\n\nconst polygon = Polygon({ sides }).items[0];\nconst halfAngle = 180 / sides;\n\nconst matrix = AffineMatrix.fromTranslation(point1);\nmatrix.rotate((point2 - point1).angle() - halfAngle);\nmatrix.scaleScalar(point1.distance(point2) / sin(halfAngle));\nmatrix.translate(Vec(0, 0.5));\n\nconsole.guide(Vec(matrix.tx, matrix.ty));\n\nreturn polygon.affineTransform(matrix);"),fb("PolygonFromSideDefinition",Mx);const Ix=new yb;Ix.isImmutable=!0,Ix.isPassThrough=!0,Ix.isShowGuides=!0,Ix.isDefaultUniformScale=!1,Ix.isAutoScale=!0,Ix.name="Line",Ix.parameters=[Sw("point1",new It),Sw("point2",new It(1))],Ix.code=new _b("Path.fromPoints([point1, point2]);"),fb("LineDefinition",Ix);const _x=new yb;_x.isImmutable=!0,_x.isPassThrough=!0,_x.isShowGuides=!0,_x.isAutoScale=!0,_x.name="Arc From Center And Angles",_x.parameters=[Sw("center",new It),yw("radius",1),bw("startAngle",0),bw("endAngle",90)],_x.code=new _b("console.guide(center);\nreturn Path.fromArc(center, radius, startAngle, endAngle);"),fb("ArcDefinition",_x);const Ox=new yb;Ox.isImmutable=!0,Ox.isPassThrough=!0,Ox.isShowGuides=!0,Ox.isAutoScale=!0,Ox.name="Arc From Center And Points",Ox.parameters=[Sw("center",new It),Sw("point1",new It(1,0)),Sw("point2",new It(0,1)),mw("clockwise",!0)],Ox.code=new _b("console.geometry(LineSegment(center, point1));\nconsole.geometry(LineSegment(center, point2));\nconsole.guide(center);\n\nconst startDir = point1 - center;\nconst endDir = point2 - center;\nlet startAngle = startDir.angle();\nlet endAngle = endDir.angle();\n\n// Swap angles if we're not going clockwise.\nif (!clockwise) {\n  let tempAngle = startAngle;\n  startAngle = endAngle;\n  endAngle = tempAngle;\n}\n\n// Make sure the endAngle is greater than startAngle.\nif (endAngle < startAngle) endAngle += 360;\n\nconst radius = startDir.length();\nreturn Path.fromArc(center, radius, startAngle, endAngle);"),fb("ArcFromCenterAndPointsDefinition",Ox);const Nx=new yb;Nx.isImmutable=!0,Nx.isPassThrough=!0,Nx.isShowGuides=!0,Nx.isAutoScale=!0,Nx.name="Arc From Three Points",Nx.parameters=[Sw("point1",new It(-1,0)),Sw("point2",new It(0,-1)),Sw("point3",new It(1,0))],Nx.code=new _b("const lineLineIntersection = (p1, p2, p3, p4) => {\n  const denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  return ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n};\n\nconst mid1 = mix(point1, point2, 0.5);\nconst mid2 = mix(point2, point3, 0.5);\nconst bisector1 = (point2 - point1).rotateNeg90();\nconst bisector2 = (point3 - point2).rotateNeg90();\nconst d = lineLineIntersection(mid1, bisector1 + mid1, mid2, bisector2 + mid2);\n\n// Replace very large circles with straight lines.\n// Without this, numerical imprecision would give an ugly result.\nif (abs(d) > 1000000000000) {\n  return Path.fromPoints([point1, point3]);\n}\n\nconst center = bisector1 * d + mid1;\nconsole.guide(center);\n\nconst radius = point1.distance(center);\nlet angle1 = (point1 - center).angle() + 360;\nlet angle2 = (point2 - center).angle() + 360;\nlet angle3 = (point3 - center).angle() + 360;\n\nconst ab = point1 - point2;\nconst cd = point3 - point2;\nconst determinant = ab.x * cd.y - ab.y * cd.x;\n\nif (angle1 < angle3) {\n  if (angle2 > angle3) {\n    angle3 -= 360;\n  } else if (angle2 < angle1) {\n    angle1 += 360;\n  }\n} else {\n  if (determinant < 0) {\n    angle3 += 360;\n  }\n}\n\nreturn Path.fromArc(center, radius, angle1, angle3);"),fb("ArcFromThreePointsDefinition",Nx);const Dx=new yb;Dx.isImmutable=!0,Dx.isShowGuides=!0,Dx.isAutoScale=!0,Dx.name="Text",Dx.parameters=[Lw("text","Aa"),fw("font","https://fonts.gstatic.com/s/notosans/v39/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A99d41P6zHtY.ttf"),yw("size",1),dw("align","center",["left","center","right"]),dw("verticalAlign","middle",["top","middle","baseline","bottom"]),dw("welding","none",["everything","letters","none"]),vw("letterSpacing",0,3).setDeprecated(),gw("lineHeight",1,3).setDeprecated()],Dx.code=new _b('const options = {};\n// Support deprecated parameters.\nif (letterSpacing !== undefined) {\n  options.letterSpacing = letterSpacing;\n}\nif (lineHeight !== undefined) {\n  options.lineHeight = lineHeight;\n}\nfont = Font(font, options);\n\nconst myFont = getFontFromURL(font);\nif (!myFont) return [];\n\nlineHeight = myFont.renderOptions.lineHeight;\nletterSpacing = myFont.renderOptions.letterSpacing;\n\nconst linesInfo = myFont.render(text);\n\nconst lineGroups = linesInfo.map((line, i) => {\n  const { geometry, advanceX } = line;\n  const position = new Vec();\n\n  // Horizontal Alignment\n  if (align === "center") {\n    position.x -= advanceX / 2;\n  } else if (align === "right") {\n    position.x -= advanceX;\n  }\n\n  // Multiline\n  position.y += i * lineHeight;\n\n  // Vertical Alignment\n  if (verticalAlign === "top") {\n    position.y += myFont.ascenderHeight;\n  } else if (verticalAlign === "middle") {\n    position.y -= ((linesInfo.length - 1) * lineHeight) / 2;\n    position.y += (myFont.ascenderHeight + myFont.descenderHeight) / 2;\n  } else if (verticalAlign === "bottom") {\n    position.y -= (linesInfo.length - 1) * lineHeight;\n    position.y += myFont.descenderHeight;\n  }\n\n  position.mulScalar(size);\n  return geometry.transform({ position, scale: size });\n});\n\nif (welding === "everything") {\n  return CompoundPath.booleanUnion(lineGroups);\n}\nif (welding === "letters") {\n  for (const group of lineGroups) {\n    group.items = group.items.map(item => CompoundPath.booleanUnion([item]));\n  }\n}\nreturn new Group(lineGroups);'),fb("TextDefinition",Dx);const Rx=new yb;Rx.name="Connected Text",Rx.isImmutable=!0,Rx.parameters=[Lw("text","Connected"),fw("font",new Tr("https://fonts.gstatic.com/s/pacifico/v22/FwZY7-Qmy14u9lezJ96A4sijpFu_.ttf",{connect:"dots and letters",lineHeight:.8,thicken:0})),new hw("size","72 pt",new qb),dw("align","center",["left","center","right"]),dw("verticalAlign","middle",["top","middle","baseline","bottom"]),dw("welding","everything",["everything","letters","none"]),vw("lineHeight",.8,3).setDeprecated(),vw("thicken",0,3).setComment('Adds an "Expand" to your font, to help prevent delicate fonts from breaking apart.').setDeprecated()],Rx.code=new _b('font = Font(font);\n\n// Support deprecated parameter defaults.\nif (font.renderOptions.lineHeight === undefined) {\n  font.renderOptions.lineHeight = 0.8;\n}\nif (font.renderOptions.connect === undefined) {\n  font.renderOptions.connect = "dots and letters";\n}\n\n// Support deprecated parameters.\nif (lineHeight !== undefined) {\n  font.renderOptions.lineHeight = lineHeight;\n}\nif (thicken !== undefined) {\n  font.renderOptions.thicken = thicken;\n}\n\n// Support old welding values.\nif (welding === "Weld everything (default)") {\n  welding = "everything";\n}\nif (welding === "Weld individual letters") {\n  welding = "letters";\n}\nif (welding === "Weld nothing") {\n  welding = "none";\n}\n\nreturn Text({ text, font, size, align, verticalAlign, welding });'),fb("ConnectedTextDefinition",Rx);const Fx=new yb;let Bx;Fx.name="Connected Text With Tails",Fx.isImmutable=!0,Fx.isPro=!0,Fx.parameters=[Lw("text","love"),fw("font",new Tr("https://assets.cuttle.xyz/fonts/pro/Hilda-Boby-Script.otf.json",{connect:"dots and letters",startStyle:"tail",betweenStyle:"heart",endStyle:"tail",lineHeight:.8,thicken:0}),["https://assets.cuttle.xyz/fonts/pro/Angela-Lovely.otf.json","https://assets.cuttle.xyz/fonts/pro/Emily-Bonza-Script.otf.json","https://assets.cuttle.xyz/fonts/pro/Gloding-Sophia-Script.otf.json","https://assets.cuttle.xyz/fonts/pro/Goldie-Rainbow.otf.json","https://assets.cuttle.xyz/fonts/pro/Hello-Hana-Script.otf.json","https://assets.cuttle.xyz/fonts/pro/Hello-Yastina-Script.otf.json","https://assets.cuttle.xyz/fonts/pro/Hilda-Boby-Script.otf.json","https://assets.cuttle.xyz/fonts/pro/Jasmie-Martin-Script.otf.json","https://assets.cuttle.xyz/fonts/pro/Misha-Script.otf.json","https://assets.cuttle.xyz/fonts/pro/Penthouse.otf.json","https://assets.cuttle.xyz/fonts/pro/Selina-Script.otf.json","https://assets.cuttle.xyz/fonts/pro/Smith-family-Script.otf.json"]),new hw("size","72 pt",new qb),dw("align","center",["left","center","right"]),dw("verticalAlign","middle",["top","middle","baseline","bottom"]),dw("welding","everything",["everything","letters","none"]),dw("startStyle","tail",["none","tail"]).setDeprecated(),dw("betweenStyle","heart",["auto","heart","none"]).setComment('"auto" matches the left and right tail options.\n"heart" connects words with a heart.\n"none" leaves spaces between words.').setDeprecated(),dw("endStyle","tail",["none","tail","heart"]).setDeprecated(),vw("lineHeight",.8,3).setDeprecated(),vw("thicken",0,3).setComment('Adds an "Expand" to your font, to help prevent delicate fonts from breaking apart.').setDeprecated()],Fx.code=new _b('font = Font(font);\n// Support deprecated parameter defaults.\nif (font.renderOptions.connect === undefined) {\n  font.renderOptions.connect = "dots and letters";\n}\nif (font.renderOptions.startStyle === undefined) {\n  font.renderOptions.startStyle = "tail";\n}\nif (font.renderOptions.betweenStyle === undefined) {\n  font.renderOptions.betweenStyle = "heart";\n}\nif (font.renderOptions.endStyle === undefined) {\n  font.renderOptions.endStyle = "tail";\n}\nif (font.renderOptions.lineHeight === undefined) {\n  font.renderOptions.lineHeight = 0.8;\n}\n\n// Support deprecated parameters.\nif (startStyle !== undefined) {\n  font.renderOptions.startStyle = startStyle;\n}\nif (betweenStyle !== undefined) {\n  font.renderOptions.betweenStyle = betweenStyle;\n}\nif (endStyle !== undefined) {\n  font.renderOptions.endStyle = endStyle;\n}\nif (lineHeight !== undefined) {\n  font.renderOptions.lineHeight = lineHeight;\n}\nif (thicken !== undefined) {\n  font.renderOptions.thicken = thicken;\n}\n\n// Support old welding values.\nif (welding === "Weld everything (default)") {\n  welding = "everything";\n}\nif (welding === "Weld individual letters") {\n  welding = "letters";\n}\nif (welding === "Weld nothing") {\n  welding = "none";\n}\n\nreturn Text({ text, font, size, align, verticalAlign, welding });'),fb("ConnectedTextWithTailsDefinition",Fx);{const e=new bx(new wx(Px));e.name="Rectangle 1",e.transform=new wx(lx),e.transform.args.scale=new _b("const img = getImageFromURL(image);\nif (img) {\n  return Vec(img.width, img.height);\n}\nreturn Vec(1, 1);"),e.fill=new wx(cx),e.fill.args.type=new _b('"image"'),e.fill.args.image=new _b("image"),e.fill.args.opacity=new _b("opacity"),Bx=new vb(new bx(new wx(px))),Bx.isImmutable=!0,Bx.name="Image Frame",Bx.parameters=[Ew("image",""),vw("opacity",1,0)],Bx.element.children=[e],fb("ImageFrameDefinition",Bx)}const Vx=new yb;Vx.isImmutable=!0,Vx.isShowGuides=!0,Vx.isAutoScale=!0,Vx.name="Emoji",Vx.parameters=[((e,t,n)=>new hw(e,Rb(t),new lw(n)))("emoji",`${ur}/noto-emoji-600/1f642.svg`)],Vx.code=new _b("const emojiShape = getEmojiSVGFromURL(emoji);\nif (!emojiShape) return [];\nreturn emojiShape;"),Vx.defaultStyle="fill",Vx.icon="builtin_shape_emoji",fb("EmojiDefinition",Vx);const jx=new yb;let Hx,Ux;jx.isImmutable=!0,jx.isShowGuides=!0,jx.isAutoScale=!0,jx.name="Function Plot",jx.parameters=[new hw("func","(t) => Vec(t / 90, sin(t))"),gw("domainStart",-180),gw("domainEnd",180),gw("tolerance",.001)],jx.code=new _b("return Path.fromSmoothFunction(func, domainStart, domainEnd, tolerance);"),fb("SmoothFunctionPlotDefinition",jx);{const e=new bx(new wx(jx));e.name="Function Plot 1",e.base.args.func=new _b("(t) => t / rotation * Vec.fromAngle(rotation - t)"),e.base.args.domainStart=new _b("rotation"),e.base.args.domainEnd=new _b("0.0"),e.base.args.tolerance=new _b("0.0001"),Hx=new vb(new bx(new wx(px))),Hx.isImmutable=!0,Hx.isShowGuides=!0,Hx.isAutoScale=!0,Hx.name="Archimedean Spiral",Hx.parameters=[gw("revolutions",3),new hw("rotation","360 * revolutions")],Hx.element.children=[e],fb("ArchimedeanSpiralDefinition",Hx)}{const e=new bx(new wx(jx));e.name="Function Plot 1",e.base.args.func=new _b("(t) => Math.pow(360, tan(pitch) * t / -360) * Vec.fromAngle(t)"),e.base.args.domainStart=new _b("rotation"),e.base.args.domainEnd=new _b("0.0"),e.base.args.tolerance=new _b("0.00001"),Ux=new vb(new bx(new wx(px))),Ux.isImmutable=!0,Ux.isShowGuides=!0,Ux.isAutoScale=!0,Ux.name="Logarithmic Spiral",Ux.parameters=[gw("revolutions",3),new hw("rotation","360 * revolutions"),bw("pitch",12)],Ux.element.children=[e],fb("LogarithmicSpiralDefinition",Ux)}const zx=new yb;zx.isImmutable=!0,zx.isShowGuides=!0,zx.isAutoScale=!1,zx.name="Auto Layout",zx.icon="builtin_shape_autolayout",zx.learnMorePageLink="/learn/auto-layout",zx.defaultStyle="none",zx.parameters=[new hw("pieces","[\n  [Circle, Rectangle],\n  [Polygon, Star],\n]"),new hw("spacing","0.05 in")],zx.code=new _b('function layout(pieces, horizontal) {\n  const cursor = Vec(0, 0);\n  const group = Group();\n  for (let piece of pieces) {\n    if (!piece) {\n      // Ignore undefined or null\n      continue;\n    } else if (Array.isArray(piece)) {\n      // Recurse\n      piece = layout(piece, !horizontal);\n    } else if (typeof piece === "function") {\n      // Allow components (which are functions) or geometry\n      piece = piece();\n    }\n    group.items.push(piece);\n    const box = piece.boundingBox();\n    if (!box) continue;\n    piece.transform({ position: cursor - box.min });\n\n    // Add default stroke if piece has no style\n    if (!piece.hasStyle()) {\n      piece.assignStroke(Stroke());\n    }\n\n    if (horizontal) {\n      cursor.x += box.width() + spacing;\n    } else {\n      cursor.y += box.height() + spacing;\n    }\n  }\n  return group;\n}\n\nreturn layout(pieces, false);'),fb("AutoLayoutDefinition",zx);const Wx=new yb;let Gx,$x,Zx,qx;Wx.isImmutable=!0,Wx.isShowGuides=!0,Wx.isAutoScale=!1,Wx.name="Switcher",Wx.icon="builtin_shape_switcher",Wx.learnMorePageLink="/learn/switcher",Wx.defaultStyle="none",Wx.parameters=[new hw("shape","Star")],Wx.code=new _b('const geom = typeof shape === "function" ? shape() : shape;\nif (!geom.hasStyle()) {\n  geom.assignStroke(Stroke());\n}\nreturn geom;'),fb("SwitcherDefinition",Wx);{const e=new bx(new wx(gx));e.name="Anchor 1",e.base.args.position=new _b("Vec(radius, 0)"),e.base.args.handleIn=new _b("Vec(0, -c)"),e.base.args.handleOut=new _b("Vec(0, c)"),e.base.args.handleConstraint=new _b('"tangent"');const t=new bx(new wx(gx));t.name="Anchor 2",t.base.args.position=new _b("Vec(0, radius)"),t.base.args.handleIn=new _b("Vec(c, 0)"),t.base.args.handleOut=new _b("Vec(-c, 0)"),t.base.args.handleConstraint=new _b('"tangent"');const n=new bx(new wx(gx));n.name="Anchor 3",n.base.args.position=new _b("Vec(-radius, 0)"),n.base.args.handleIn=new _b("Vec(0, c)"),n.base.args.handleOut=new _b("Vec(0, -c)"),n.base.args.handleConstraint=new _b('"tangent"');const i=new bx(new wx(gx));i.name="Anchor 4",i.base.args.position=new _b("Vec(0, -radius)"),i.base.args.handleIn=new _b("Vec(-c, 0)"),i.base.args.handleOut=new _b("Vec(c, 0)"),i.base.args.handleConstraint=new _b('"tangent"');const r=new bx(new wx(mx));r.name="Path 1",r.children=[e,t,n,i],r.base.args.closed=new _b("true"),Gx=new vb(new bx(new wx(px))),Gx.isImmutable=!0,Gx.name="Circle (old)",Gx.isDefaultUniformScale=!0,Gx.parameters=[yw("radius",1),new hw("c","radius * 0.551915024494")],Gx.element.children=[r],fb("CircleDefinition",Gx)}{const e=new bx(new wx(gx));e.name="Anchor 1",e.base.args.position=new _b("Vec(0.0, 0.0)");const t=new bx(new wx(gx));t.name="Anchor 2",t.base.args.position=new _b("Vec(1.0, 0.0)");const n=new bx(new wx(gx));n.name="Anchor 3",n.base.args.position=new _b("Vec(1.0, 1.0)");const i=new bx(new wx(gx));i.name="Anchor 4",i.base.args.position=new _b("Vec(0.0, 1.0)");const r=new bx(new wx(mx));r.name="Path 1",r.children=[e,t,n,i],r.base.args.closed=new _b("true");const s=new bx(new wx(xx));s.name="Point Guide 1",s.base.args.position=new _b("Vec(0.5, 0.5)"),$x=new vb(new bx(new wx(px))),$x.isImmutable=!0,$x.isDefaultUniformScale=!1,$x.name="Rectangle (old)",$x.element.children=[r,s],fb("RectangleDefinition1",$x)}{const e=new bx(new wx(gx));e.name="Anchor 1",e.base.args.position=new _b("Vec(0, 0)");const t=new bx(new wx(gx));t.name="Anchor 2",t.base.args.position=new _b("Vec(size.x, 0)");const n=new bx(new wx(gx));n.name="Anchor 3",n.base.args.position=new _b("Vec(size.x, size.y)");const i=new bx(new wx(gx));i.name="Anchor 4",i.base.args.position=new _b("Vec(0, size.y)");const r=new bx(new wx(mx));r.name="Path 1",r.children=[e,t,n,i],r.base.args.closed=new _b("true"),r.transform=new wx(lx),r.transform.args.position=new _b("centered ? size * -0.5 : Vec(0, 0)");const s=new wx(Yw);s.args.radius=new _b("min(abs(size.x)/2-.01, abs(size.y)/2-.01, cornerRadius)"),r.modifiers.push(s),Zx=new vb(new bx(new wx(px))),Zx.isImmutable=!0,Zx.name="Rectangle (old)",Zx.parameters=[xw("size",new It(1)),mw("centered",!1),yw("cornerRadius",0)],Zx.element.children=[r],fb("RectangleDefinition",Zx)}{const e=new bx(new wx(gx));e.name="Anchor 1",e.base.args.position=new _b("Vec(0, -radius)");const t=new wx($w);t.args.repetitions=new _b("sides"),e.modifiers.push(t);const n=new bx(new wx(mx));n.name="Path 1",n.base.args.closed=new _b("true"),n.children=[e],qx=new vb(new bx(new wx(px))),qx.isImmutable=!0,qx.isDefaultUniformScale=!0,qx.name="Polygon (old)",qx.parameters=[ww("sides",5),yw("radius",1)],qx.element.children=[n],fb("PolygonDefinition",qx)}const Kx=Object.freeze(Object.defineProperty({__proto__:null,ArcFromCenterAndAnglesDefinition:_x,ArcFromCenterAndPointsDefinition:Ox,ArcFromThreePointsDefinition:Nx,get ArchimedeanSpiralDefinition(){return Hx},AutoLayoutDefinition:zx,get CircleDefinition(){return Sx},CircleFromCenterAndPointDefinition:kx,CircleFromThreePointsDefinition:Ex,CircleFromTwoPointsDefinition:Lx,ConnectedTextDefinition:Rx,ConnectedTextWithTailsDefinition:Fx,EmojiDefinition:Vx,get ImageFrameDefinition(){return Bx},LineDefinition:Ix,LineGuideDefinition:Cx,get LogarithmicSpiralDefinition(){return Ux},get OldCircleDefinition(){return Gx},get OldPolygonDefinition(){return qx},get OldRectangleDefinition(){return Zx},get OldRectangleDefinition1(){return $x},PointGuideDefinition:xx,get PolygonDefinition(){return Tx},PolygonFromSideDefinition:Mx,get RectangleDefinition(){return Px},SmoothFunctionPlotDefinition:jx,get StarDefinition(){return Ax},SwitcherDefinition:Wx,TextDefinition:Dx},Symbol.toStringTag,{value:"Module"})),Yx={category:"Basic Shapes",display:"one-up-compact",featuredShapes:[],shapes:[{type:"builtin",definition:Dx},{type:"builtin",definition:Sx},{type:"builtin",definition:Px},{type:"builtin",definition:Tx},{type:"builtin",definition:Ax},{type:"builtin",definition:Ix},{type:"builtin",definition:Vx}]},Xx=[{name:"Heart Symbol",keywords:["love","holiday"],path:"/symbols/cuttle-heart",type:"cuttle-symbol"},{name:"Wing Left",keywords:["angel","bird"],path:"/symbols/cuttle-wing-left",type:"cuttle-symbol"},{name:"Wing Right",keywords:["angel","bird"],path:"/symbols/cuttle-wing-right",type:"cuttle-symbol"},{name:"Star Symbol",keywords:["holiday","christmas"],path:"/symbols/cuttle-star",type:"cuttle-symbol"},{name:"Music Note",path:"/symbols/cuttle-music",type:"cuttle-symbol"},{name:"Paw",keywords:["pet","cat","dog"],path:"/symbols/cuttle-paw",type:"cuttle-symbol"},{name:"Paw With Claws",keywords:["pet","cat","dog"],path:"/symbols/cuttle-paw-claws",type:"cuttle-symbol"},{name:"Paw Outline",keywords:["pet","cat","dog"],path:"/symbols/cuttle-paw-negative",type:"cuttle-symbol"},{name:"Paw Outline With Claws",keywords:["pet","cat","dog"],path:"/symbols/cuttle-paw-claws-negative",type:"cuttle-symbol"},{name:"Snowflake",keywords:["snow","winter","christmas","holiday"],path:"/symbols/cuttle-snowflake",type:"cuttle-symbol"},{name:"Angel",keywords:["holiday","christmas"],path:"/symbols/cuttle-angel",type:"cuttle-symbol"},{name:"Dreidel",keywords:["hanukkah","holiday"],path:"/symbols/cuttle-dreidel",type:"cuttle-symbol"}],Jx=[{category:"Basic Shapes",display:"four-up",displayMore:"one-up",featuredShapes:["Circle","Rectangle","Polygon","Star","Pill","Triangle","Heart","Award Seal"],shapes:[{type:"builtin",definition:Sx},{type:"builtin",definition:kx},{type:"builtin",definition:Ex},{type:"builtin",definition:Lx},{type:"builtin",definition:Px,keywords:["square"]},{type:"builtin",definition:Tx,keywords:["pentagon","hexagon","heptagon","septagon","octagon"]},{type:"builtin",definition:Mx,keywords:["pentagon","hexagon","heptagon","septagon","octagon"]},{type:"builtin",definition:Ax},{type:"guts",name:"Triangle",project:"Creation-Panel-Basic-18DXskOcFMRw",isAutoScale:!0},{type:"guts",name:"Pill",project:"Creation-Panel-Basic-18DXskOcFMRw",isAutoScale:!0},{type:"guts",name:"Award Seal",project:"Creation-Panel-Basic-18DXskOcFMRw",isAutoScale:!0},{type:"component",name:"Heart",project:"Creation-Panel-Basic-18DXskOcFMRw",isAutoScale:!0},{type:"guts",name:"Semicircle",project:"Creation-Panel-Basic-18DXskOcFMRw",isAutoScale:!0,keywords:["hemicircle","hemi","semi","half"]},{type:"component",name:"Pie Slice",project:"Pie-Slice-aa4ykLEI7BNn",isAutoScale:!0,keywords:["circle","arc"]},{type:"component",name:"Moon Phase",project:"Moon-Phase-qsU7wJ07Kl0B",isAutoScale:!0,keywords:["circle","full","half","quarter","crescent"]},{type:"component",name:"Flexed Rectangle",project:"Warped-Text-MGWZ6wZxoMWe",isAutoScale:!0},{type:"component",name:"Wavy Rectangle",project:"Warped-Text-MGWZ6wZxoMWe",isAutoScale:!0},{type:"component",name:"Banner Rectangle",project:"Warped-Text-MGWZ6wZxoMWe",isAutoScale:!0},{type:"component",name:"Trapezoid",project:"Warped-Text-MGWZ6wZxoMWe",isAutoScale:!0},{type:"guts",name:"Right Triangle (Top Left)",project:"Creation-Panel-Right-Triangles-nsRda25noCPa",isAutoScale:!0},{type:"guts",name:"Right Triangle (Top Right)",project:"Creation-Panel-Right-Triangles-nsRda25noCPa",isAutoScale:!0},{type:"guts",name:"Right Triangle (Bottom Right)",project:"Creation-Panel-Right-Triangles-nsRda25noCPa",isAutoScale:!0},{type:"guts",name:"Right Triangle (Bottom Left)",project:"Creation-Panel-Right-Triangles-nsRda25noCPa",isAutoScale:!0}]},{category:"Lines & Curves",display:"four-up",displayMore:"one-up",featuredShapes:["Line","Arc From Center And Points","Archimedean Spiral","Logarithmic Spiral","Straight Arrow","Curved Arrow"],shapes:[{type:"builtin",definition:Ix},{type:"builtin",definition:Ox},{type:"builtin",definition:_x},{type:"builtin",definition:Nx},{type:"builtin",definition:Hx},{type:"builtin",definition:Ux},{type:"builtin",definition:jx},{type:"component",name:"Straight Arrow",project:"Creation-Panel-Basic-18DXskOcFMRw",thumbnail:"Straight Arrow Thumbnail",isAutoScale:!0},{type:"component",name:"Curved Arrow",project:"Creation-Panel-Basic-18DXskOcFMRw",thumbnail:"Curved Arrow Thumbnail",isAutoScale:!0}]},{category:"Text",display:"two-up",featuredShapes:["Basic Text","Single Line Text","Stencil Text","Fit Text","Text Along Path","Text Spaced Around Circle","Split Text","Connected Text"],shapes:[{type:"guts",name:"Basic Text",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Basic Text Thumbnail"},{type:"guts",name:"Single Line Text",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Single Line Text Thumbnail"},{type:"guts",name:"Stencil Text",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Stencil Text Thumbnail"},{type:"guts",name:"Fit Text",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Fit Text Thumbnail"},{type:"guts",name:"Text On Top And Bottom",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Text On Top And Bottom Thumbnail"},{type:"guts",name:"Text Spaced Around Circle",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Text Spaced Around Circle Thumbnail"},{type:"guts",name:"Text Around Circle (Top)",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Text Around Circle (Top) Thumbnail"},{type:"guts",name:"Text Around Circle (Bottom)",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Text Around Circle (Bottom) Thumbnail"},{type:"guts",name:"Text Around Circle (Left)",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Text Around Circle (Left) Thumbnail"},{type:"guts",name:"Text Around Circle (Right)",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Text Around Circle (Right) Thumbnail"},{type:"guts",name:"Text Along Path",componentName:"Text Along Path A",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Text Along Path Thumbnail"},{type:"guts",name:"Spiral Text",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Spiral Text Thumbnail"},{type:"guts",name:"Split Text",componentName:"Split Text A",project:"Creation-Panel-Split-Text-lDjjEGQh33HC",thumbnail:"Split Text Thumb"},{type:"guts",name:"Connected Text",componentName:"Connected Text A",project:"Creation-Panel-Text-oIE1LQku0C1n",thumbnail:"Connected Text Thumbnail"},{type:"builtin",definition:Fx,keywords:["tail","heart","connector","swash","pua"]}]},{category:"Warped Text",display:"two-up",featuredShapes:["Banner Text (Slope Down)","Arched Text (Up)","Pinched Text","Stretched Text","Leaned Text (Grow)","Custom Warped Text"],shapes:[{name:"Banner Text (Slope Down)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Banner Text (Slope Up)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Banner Text (Shrink)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Banner Text (Grow)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Leaned Text (Grow)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Leaned Text (Shrink)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Pinched Text",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Pinched Text (Horizontal)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Pinched Text (Vertical)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Stretched Text",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Stretched Text (Horizontal)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Stretched Text (Vertical)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Arched Text (Up)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Arched Text (Down)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Arched Text (Bottom Up)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Arched Text (Top Down)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Waved Text (Up)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Waved Text (Down)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Waved Text (Mirrored Up)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Waved Text (Mirrored Down)",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"},{name:"Custom Warped Text",project:"Warped-Text-MGWZ6wZxoMWe",type:"guts"}]},{category:"Cuttle Symbols",display:"four-up",featuredShapes:["Heart Symbol","Wing Left","Wing Right","Star Symbol","Music Note","Paw","Paw Outline","Snowflake"],shapes:Xx},{category:"Emoji",display:"four-up",featuredShapes:["Slightly Smiling Face","Face With Tears Of Joy","Dog Face","Cat Face","Avocado","Cherries","Thumbs Up Sign","Crescent Moon"],shapes:[]},{category:"Advanced",display:"four-up",displayMore:"one-up",featuredShapes:["Auto Layout","Switcher"],shapes:[{type:"builtin",definition:zx},{type:"builtin",definition:Wx}]}],Qx=(e,t)=>{const n=Jx.find(({category:t})=>t===e);n&&"Emoji"===e&&(n.shapes=t.map(Sf))},eC={Emoji:`${pr}/emoji-17-0.json`};const tC=new class{constructor(){this.data=new Map,this.load()}async load(){for(const[e,t]of Object.entries(eC))try{const n=await Is(t),i=await n.json();this.data.set(e,i),"Emoji"===e&&Qx(e,i)}catch{}}search(e){if(""===e)return this.data.get("Emoji")||[];const t=e.toLowerCase().split(/[\s|,]+/).map(e=>e.replace(/[\-]/g," ").trim()).filter((e,t,n)=>e&&n.indexOf(e)==t),n=[],i={};for(const[r,s]of this.data)for(const e of s)for(const r of t){const{unified:t,keywords:s}=e,o=s.indexOf(r);if(o>=0){const r=i[t],a=o/s.length;void 0!==r?i[t]=Math.max(r,a):(n.push(e),i[t]=a)}}return n.length<2||n.sort((e,t)=>i[e.unified]-i[t.unified]),n}},nC=()=>{let e="";return{view(t){const{query:n}=t.attrs,i=n===e;return Oe(".query-results-none",[Oe("p","We didn't find any shapes for the search ",Oe("strong",`${n}`)),Oe("p","Suggest this shape for future inclusion?"),Oe("button.query-results-none-send-suggestion",{disabled:i,onclick:()=>{e=n,Ao("creation panel suggestion",{query:n})}},i?"Sent! Thanks.":"Send Suggestion")])}}};const iC=new class{constructor(){this.query="",this.index=0,this.results=[]}goTo(e){this.index=e}goBack(){this.index>0&&this.index--,0===this.index&&this.setQuery("")}async setQuery(e){this.query=e,""!==e?(this.results=[],this.goTo(1),await this.queryAndSetResults(e),Oe.redraw()):this.results=[]}setCategory(e){this.category=e,e?this.goTo(2):this.goTo(1)}async queryAndSetResults(e){if(""===e)return[];const t=e.split(" ").filter(e=>e.length>0),n=tC.search(e).map(Sf),i=await Oj.ensureExamplesData(),r=Jx.map(e=>{if("Emoji"===e.category)return{category:e,results:n};const r=[];for(const n of e.shapes){const e=Cf(n),s=i.exampleDataWithName(e);(null==s?void 0:s.keywords.some(e=>t.some(t=>e.includes(t))))&&r.push(n)}return{category:e,results:r}});this.results=r.filter(({results:e})=>e.length>0)}};function rC(e){if(e instanceof _b)return Object.defineProperty(e,"jsCode",{value:e.jsCode}),e;Object.freeze(e);for(let t of Object.getOwnPropertyNames(e)){const n=e[t];"object"!=typeof n&&"function"!=typeof n||null===n||Object.isFrozen(n)||rC(n)}return e}const sC=Object.values(yx),oC=Object.values(Kx),aC=Object.values(ax),lC=[...sC,...oC,...aC];lC.forEach(e=>{rC(e)});const cC=lC.map(e=>gf(e.name));class hC{constructor(e,t=!1,n=!1,i=!1){this.worldPosition=e,this.isPreciseH=t,this.isPreciseV=n,this.isSpecific=i}clone(){return new hC(this.worldPosition.clone(),this.isPreciseH,this.isPreciseV,this.isSpecific)}copy(e){this.worldPosition.copy(e.worldPosition),this.isPreciseH=e.isPreciseH,this.isPreciseV=e.isPreciseV,this.isSpecific=e.isSpecific}affineTransform(e){return this.worldPosition.affineTransform(e),this}isPrecise(){return this.isPreciseH||this.isPreciseV}}ub("CanvasPoint",hC);class uC{constructor(e){this.existingNames=e}preview(e){if(!this.existingNames[e]&&!this.existingNames[gf(e)])return e;let[t,n]=this.decompose(e);for(;;){n+=1;const e=this.compose(t,n);if(!this.existingNames[e])return e}}generate(e){const t=this.preview(e);return this.existingNames[t]=!0,t}}class dC extends uC{compose(e,t){return e+" "+t}decompose(e){const t=e.replace(/ *\d+$/,"");let n=0;return t!==e&&(n=+e.substring(t.length+1)),[t,n]}renameElement(e,t){if(0===(t=t.trim()).length)return;e.name!==t&&(t=this.generate(t),e.name=t)}}class pC extends uC{numberToAlpha(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";let n="";for(;;){let i=e%26;if(0===i&&(i=26),n=t[i-1]+n,(e=(e-i)/26)<=0)return n}}alphaToNumber(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";let n=0;for(;e.length>0;){const i=e[0];e=e.substring(1),n*=26,n+=t.indexOf(i)+1}return n}compose(e,t){return e+" "+this.numberToAlpha(t)}decompose(e){const t=e.replace(/ [A-Z]+$/,"");let n=0;if(t!==e){const i=e.substring(t.length+1);n=this.alphaToNumber(i)}return[t,n]}}class fC extends uC{compose(e,t){return e+t}decompose(e){const t=e.replace(/\d+$/,"");let n=0;return t!==e&&(n=+e.substring(t.length)),[t,n]}}class mC{constructor(e){this.source=e,this.parent=null,this.env={},this.children=[],this.dependencies=new Set,this.dependents=new Set}addChild(e){this.children.push(e),e.parent=this}addDependency(e){this.dependencies.has(e)||(this.dependencies.add(e),e.dependents.add(this))}namedParentPath(){const e=[],t=({source:n,parent:i})=>{(n instanceof vb||n instanceof yb||n instanceof Nb||n instanceof hw)&&e.unshift(n.name),i&&t(i)};return t(this),e}}class gC{constructor(e){this.project=e,this.nodesBySource=new Map;const t=Object.create(null),n=this.ensureNodeForSource(e),i=e.allParameters();for(let r of e.components)this.addDefinitionToEnv(t,r);for(let r of e.modifiers)this.addDefinitionToEnv(t,r);for(const r of i)this.addDefinitionToEnv(t,r);for(const r of i)this.addParameter(t,r,n);for(let r of e.components)this.addDefinition(t,r,n);for(let r of e.modifiers)this.addDefinition(t,r,n)}nodeForSource(e){return this.nodesBySource.get(e)}assertNodeForSource(e){const t=this.nodeForSource(e);return Ps(t,"Dependency Graph: Node expected for source, but not found."),t}ensureNodeForSource(e){let t=this.nodeForSource(e);return void 0===t&&(t=new mC(e),this.nodesBySource.set(e,t)),t}addDefinitionToEnv(e,t){const n=this.ensureNodeForSource(t);e[gf(t.name)]=n}addRepeatIndexVariableToEnv(e,t,n){if(t.isRepeatModifier()&&t.repeatIndexVariableName){const i=this.ensureNodeForSource(t);null==n||n.addChild(i),e[t.repeatIndexVariableName]=i}}addDefinition(e,t,n){const i=this.ensureNodeForSource(t);null==n||n.addChild(i);const r=i.env=Object.create(e),s=t.allParameters();for(const o of s){const e=Object.create(r);for(const t of s)o!==t&&this.addDefinitionToEnv(e,t);this.addParameter(e,o,i)}for(const o of s)this.addDefinitionToEnv(r,o);(t instanceof yb||t instanceof Nb)&&this.addExpression(r,t.code,i),t instanceof vb&&this.addElement(r,t.element,i)}addElement(e,t,n){const i=this.ensureNodeForSource(t);i.env=e,n.addChild(i);let r=e;for(const s of t.allInstances().reverse())this.addInstance(r,s,i),s.isRepeatModifier()&&s.repeatIndexVariableName&&(r=Object.create(r),this.addRepeatIndexVariableToEnv(r,s,i));for(const s of t.children)this.addElement(r,s,i)}addInstance(e,t,n){const i=this.ensureNodeForSource(t);i.env=e,n.addChild(i);for(const r in t.args){const i=t.args[r];this.addExpression(e,i,n)}if(!mb(t.definition)&&(t.definition instanceof vb||t.definition instanceof yb||t.definition instanceof Nb)){const e=this.nodeForSource(t.definition);Ps(void 0!==e),i.addDependency(e)}}addParameter(e,t,n){const i=this.ensureNodeForSource(t);i.env=e,n.addChild(i),this.addExpression(e,t.expression,i)}addExpression(e,t,n){const i=this.ensureNodeForSource(t);i.env=e,n.addChild(i);for(const r of t.compiled().references){const t=e[gf(r.name)];void 0!==t&&i.addDependency(t)}}renameParameter(e,t,n,i){if(t=gf((e=>e.replace(/[_\s]+/g,"_"))(t)),0===t.length)return;const r=gf(e.name);if(!i&&r===t)return;t=n.generate(t),e.name=t;const s=this.nodeForSource(e);if(s)for(const{source:o}of s.dependents)o instanceof _b&&o.replaceReferences(r,t),o instanceof wx&&(o.args[t]=o.args[r],delete o.args[r])}renameDefinition(e,t,n,i,r){if(0===(t=t.trim()).length)return;const s=e.name;if(!r&&s===t)return;t=n.generate(t),e.name=t;const o=gf(s),a=gf(t),l=this.nodeForSource(e);if(l){for(const e of l.dependents)e.source instanceof _b&&e.source.replaceReferences(o,a);for(const e of this.nodesBySource.values())if(e.source instanceof bx){if(e.source.name.replace(/ \d+$/,"")===s){let n=e.source.name.replace(s,t);i.renameElement(e.source,n)}}}}renameConflictingDefinitionsBeforeImportToProject(e){const t=e.makeDefinitionNameGenerator(),n=e.makeElementNameGenerator();for(const i of this.project.components)if(this.project.components.some(e=>e.name===i.name)){const[e,r]=t.decompose(i.name);this.renameDefinition(i,t.compose(e,r+1),t,n)}}renameRepeatIndexVariable(e,t){if(0===(t=gf(t)).length)return;const n=e.repeatIndexVariableName;if(n===t)return;const i=this.nodeForSource(e);if(i){if(i.parent&&i.parent.source instanceof bx){const e=this.nodeForSource(i.parent.source.base);if(e){const n={};for(const t in e.env)n[t]=!0;t=new fC(n).generate(t)}}if(e.repeatIndexVariableName=t,null!==n)for(const e of i.dependents)e.source instanceof _b&&e.source.replaceReferences(n,t)}}removeUnusedImmutableComponents(){this.project.components=this.project.components.filter(e=>{if(!e.isImmutable)return!0;return this.assertNodeForSource(e).dependents.size>0})}portableProjectDataForNodes(e,t){const n=new Set,i=new Set,r=e=>{if(!n.has(e)){n.add(e);for(const t of e.dependencies){t.source instanceof wx||(i.add(t),r(t))}for(const t of e.children)r(t)}};for(const o of e)i.add(o),r(o);const s=new LS;for(const{source:o,parent:a}of i)o instanceof bx?s.elements.push(o):o instanceof wx?s.instances.push(o):o instanceof vb||o instanceof yb?s.components.push(o):o instanceof Nb?s.modifiers.push(o):o instanceof hw&&null!==a&&(a.source instanceof gS?s.projectParameters.push(o):t&&a.source===t&&s.componentParameters.push(o));return s.projectParameters.sort(vC(this.project.allParameters())),t&&s.componentParameters.sort(vC(t.allParameters())),s.components.sort(vC(this.project.components)),s.modifiers.sort(vC(this.project.modifiers)),s}portableProjectDataForSelection(e){const t=[...e.allNodes().sortInDocumentOrder().items.map(e=>this.assertNodeForSource(e.node.source)),...e.allInstances().sortInDocumentOrder().items.map(e=>this.assertNodeForSource(e.instance))];return this.portableProjectDataForNodes(t,this.project.exportComponent())}portableProjectDataForComponent(e){const t=this.assertNodeForSource(e);return this.portableProjectDataForNodes([t],null)}unusedModifiers(){return this.project.modifiers.filter(e=>0===this.assertNodeForSource(e).dependents.size)}dependentPathsForSource(e){const t=this.nodeForSource(e);if(!t)return[];const n=[];for(const i of t.dependents)n.push(i.namedParentPath());return n}categorizedNamesInExpressionScope(e){const t=[],n=[],i=[],r=[],s=this.nodeForSource(e);if(s)for(const o in s.env){const e=s.env[o];e.source instanceof vb||e.source instanceof yb?t.push(o):e.source instanceof Nb?n.push(o):e.source instanceof wx?r.push(o):e.source instanceof hw&&i.push(o)}return{components:t,modifiers:n,parameters:i,repeats:r}}}const vC=e=>(t,n)=>e.indexOf(t)-e.indexOf(n),yC=["cuttleComponent","cuttleImage","videoPlayer"];class bC extends rb{constructor(e,t){super(),this.name=e,this.doc=t}materialKeys(){return["name","doc"]}firstImageWithUserId(e){if(this.doc.content)for(const t of this.doc.content){if("cuttleImage"!==t.type)continue;if(!t.attrs||!t.attrs.path)continue;const n=t.attrs.path;if(!Ys(n))continue;const i=Number(n.split("/")[0]);if(Ks(i)&&i===e)return n}}firstImage(){if(this.doc.content)for(const e of this.doc.content){if("cuttleImage"!==e.type)continue;if(!e.attrs||!e.attrs.path)continue;const t=e.attrs.path;if(Ys(t))return t}}hasContent(){var e;return Boolean(null==(e=this.doc.content)?void 0:e.some(e=>(null==e?void 0:e.type)&&yC.includes(e.type)||e.content&&e.content.length>0))}previewComponentEmbedId(){const e=this.firstComponentEmbedIds();if(e&&0!==e.length)return e[0]}exportComponentEmbedId(){const e=this.firstComponentEmbedIds();if(e&&0!==e.length)return e[e.length-1]}firstComponentEmbedIds(){var e,t;const n=null==(e=this.doc.content)?void 0:e.find(e=>"cuttleComponent"===(null==e?void 0:e.type));if(!n)return;const i=null==(t=null==n?void 0:n.attrs)?void 0:t.componentid;return Xs(i)?(Ps(i.every(Ys)),i):(Ps(Ys(i)),[i])}hasEmbeddedComponent(){return void 0!==this.previewComponentEmbedId()}firstParagraphText(){var e;let t="";if(!(null==(e=this.doc.content)?void 0:e.find(e=>{if(!e.type)return!1;if("paragraph"===e.type||"blockquote"===e.type){const n=wC(e);if(n&&n.length>0)return t=n,!0}return!1})))return;if(!t)return;if(t.length<=280)return t;const n=t.split(" ");let i=0,r=0;for(;r<n.length&&(i+=n[r].length,!(i>280));r++)i+=1;return n.slice(0,r).join(" ")+""}}function wC(e){return e.content?e.content.map(wC).join("").trim():e.text?e.text:void 0}ub("Documentation",bC);class xC{constructor(e,t=[]){this.expression=e,this.selections=t}}ub("ExpressionFocus",xC);class CC{constructor(e,t){this.component=e,this.node=t}}ub("ComponentFocus",CC);class SC{constructor(e){this.component=e}}ub("CodeComponentFocus",SC);class kC{constructor(e){this.documentation=e}}ub("DocumentationFocus",kC);class LC{constructor(e){this.settings=e}}ub("SettingsFocus",LC);const EC=(e,t)=>n=>{if(void 0!==n._reducerCache){if(n._reducerCache.hasOwnProperty(e)){return n._reducerCache[e]}}else n._reducerCache={};const i=t(n);return n._reducerCache[e]=i,i},PC=EC("usesProFont",e=>{return e instanceof _b?(t=e.literalValue(),ks(t)&&t.startsWith("https://assets.cuttle.xyz/fonts")&&t.endsWith(".json")):e instanceof wx&&e.definition===Fx||e.childModelObjects().some(PC);var t}),TC=e=>ks(e)&&e.startsWith("cuttle-font://"),AC=EC("usesCustomFont",e=>{if(e instanceof _b){const t=e.literalValue(),n=t instanceof Tr?t.url:t;return TC(n)}return e.childModelObjects().some(AC)}),MC=EC("allCustomFonts",e=>{const t=[],n=e=>t.includes(e);if(e instanceof _b){const i=e.literalValue(),r=i instanceof Tr?i.url:i;TC(r)&&!n(r)&&t.push(r)}const i=e.childModelObjects().flatMap(MC);for(const r of i)n(r)||t.push(r);return t}),IC=EC("allColors",e=>{const t=[],n=e=>t.some(t=>t.equals(e));if(e instanceof _b){const i=e.literalValue();i instanceof Gn&&(n(i)||t.push(i))}const i=e.childModelObjects().flatMap(IC);for(const r of i)n(r)||t.push(r);return t}),_C=(e,t,n)=>{if(Es(e)){const t=(i=e,db.get(i));if(t)return{"@builtin":t}}var i;if(e instanceof rb)return t?{"@ref":e.id}:n?OC(e):NC(e);if(Ls(e))return e.map(e=>_C(e,t));if(Es(e)){const n={},i=gb(e);i&&(n["@class"]=i);for(const r of Object.keys(e))n[r]=_C(e[r],t);return n}return e},OC=(e,t)=>{const n={};n["@id"]=e.id;const i=gb(e);Ps(void 0!==i,"ModelObject does not have a registered class!"),n["@class"]=i;const r=e.indirectKeys();for(const s of e.materialKeys()){const i=e[s],o=null==r?void 0:r.includes(s);n[s]=_C(i,o,t)}return Object.freeze(n)},NC=EC("encoded",OC);let DC=class e{constructor(e,t){this.parent=e,this.source=t}static fromSourcePath(t,n=null){if(t.length<1)return null;let i=n;for(const r of t)i=new e(i,r);return i}hash(){if(this._hash)return this._hash;let e=this.source.id+"/";return this.parent&&(e=this.parent.hash()+e),this._hash=e}copy(e){this.parent=e.parent,this.source=e.source,this._hash=e._hash}equalsNode(e){return this.hash()===e.hash()}isAncestorOfNode(e){const t=e.hash(),n=this.hash();return t!==n&&t.startsWith(n)}isAncestorOfNodes(e){return e.every(e=>this.isAncestorOfNode(e))}hasParentNode(){return null!==this.parent}hasParentEqualToNode(e){return!!this.parent&&this.parent.equalsNode(e)}sourceChildren(){const{base:e}=this.source;return e.definition instanceof vb?e.definition.element.children:this.source.children}hasChildNodes(){return this.childCount()>0}childCount(){return this.sourceChildren().length}childNodes(){return this.sourceChildren().map(t=>new e(this,t))}childNodeAtIndex(t){return new e(this,this.sourceChildren()[t])}canAddChildren(){return this.hasDefinition(px)||this.hasDefinition(mx)||this.hasDefinition(fx)||this.source.base.definition instanceof vb&&!this.source.base.definition.isImmutable}indexInParent(){return null===this.parent?-1:this.parent.indexOfChildNode(this)}indexOfChildNode(e){return this.sourceChildren().indexOf(e.source)}indexPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.indexInParent()),t=t.parent;return e}sourcePath(){const e=[];let t=this;for(;t;)e.unshift(t.source),t=t.parent;return e}isVisible(){return null===this.parent||this.source.isVisible&&this.parent.isVisible()}isLocked(){return this.source.isLocked}isImmutableChildren(){if(null===this.parent)return!1;const{base:e}=this.source;return e.definition instanceof vb&&e.definition.isImmutable}isImmutable(){return null!==this.parent&&(this.parent.isImmutableChildren()||this.parent.isImmutable())}createsNewContext(){return this.source.base.definition instanceof vb}hasDefinition(e){return this.source.base.definition===e}isAnchor(){return this.hasDefinition(gx)}isPath(){return this.hasDefinition(mx)}};ub("Node",DC);const RC=(e,t,n,i)=>{if("mirror"===n)return new _b(Fb(t.clone().negate(),i));if("tangent"===n){const n=e.length();return new _b(Fb(t.clone().negate().normalize().mulScalar(n),i))}return new _b(Fb(e,i))};class FC{constructor(e){this.transformers=[];const t=e.allTransformable();for(let n of t.items)if(n instanceof rS)this.transformers.push(new BC(n.node));else if(n instanceof oS){let e;if(n.node.isAnchor()){const i="handleIn"===n.parameter.name?"handleOut":"handleIn",r=oS.fromName(n.node,n.instance,i);t.contains(r)&&(e="free")}this.transformers.push(new VC(n,e))}else n instanceof aS&&this.transformers.push(new jC(n))}transformWorld(e,t){for(let n of this.transformers)n.transformWorld(e,t)}transformContext(e,t){for(let n of this.transformers)n.transformContext(e,t)}revert(){for(let e of this.transformers)e.revert()}}class BC{constructor(e){var t,n,i;if(this.node=e,this.parameterTransformers=[],this.isPassThrough=e.source.isPassThrough(),this.isPassThrough)for(const o of e.source.base.definition.allParameters()){const t=new oS(e,e.source.base,o),n=new VC(t,"free");this.parameterTransformers.push(n)}else this.initialTransform=null==(t=e.source.transform)?void 0:t.clone();if(e.source.fill){const t=oS.fromName(e,e.source.fill,"transform"),n=new VC(t);this.parameterTransformers.push(n)}this.initialTransformMatrix=zC(e),this.initialContextMatrix=$C(e),this.transformOrigin=KC(e),this.initialRotation=0;const r=Oj.traceForNode(e),s=null==(i=null==(n=null==r?void 0:r.transform)?void 0:n.args.rotation)?void 0:i.evaluationResult;Ks(s)&&(this.initialRotation=s)}transformWorld(e,t){const n=e.clone().changeBasis(this.initialContextMatrix);this.transformContext(n,t)}transformContext(e,t){if(this.parameterTransformers)for(let n of this.parameterTransformers)n.transformContext(e,t,!0);if(!this.isPassThrough){const n=this.initialTransformMatrix.clone().preMul(e);n.isNaN()?this.assignTransform(this.initialTransformMatrix,t):this.assignTransform(n,t)}}assignTransform(e,t){var n,i,r,s,o;Ps(!this.isPassThrough);const a=this.node.source,l=HC(t);if(!(null==(n=a.transform)?void 0:n.isEnabled)){if(e.isIdentity())return;const t=Oj.project.transformCenter();a.transform=new wx(lx),a.base.definition.isDefaultUniformScale||(a.transform.args.scale=new _b(Fb(new It(1,1),l))),t&&(this.transformOrigin=t.worldPosition.clone().affineTransform(this.initialContextMatrix.clone().invert())),this.transformOrigin.isZero()||(a.transform.args.origin=new _b(Fb(this.transformOrigin,l)))}const c=e.toTransformWithOrigin(this.transformOrigin);if(null==t?void 0:t.preserveRotation){const e=Tt(c.rotation,this.initialRotation),t=(c.rotation+180)%360;Tt(t,this.initialRotation)<e&&(c.rotation=t,c.scale.negate())}const{args:h}=a.transform;((null==(i=h.position)?void 0:i.isLiteral())||!h.position&&!c.position.isZero())&&(h.position=new _b(Fb(c.position,l))),(null==t?void 0:t.preserveScale)||!(null==(r=h.scale)?void 0:r.isLiteral())&&(void 0!==h.scale||c.scale._almostEquals(new It(1)))||(a.isUniformScale()&&fs(c.scale.x,c.scale.y)?h.scale=new _b(Db(c.scale.x,l)):h.scale=new _b(Fb(c.scale,l))),((null==(s=h.rotation)?void 0:s.isLiteral())||void 0===h.rotation&&0!==c.rotation)&&(h.rotation=new _b(Db(c.rotation,0))),((null==(o=h.skew)?void 0:o.isLiteral())||void 0===h.skew&&0!==c.skew)&&(h.skew=new _b(Db(c.skew,0))),delete h.matrix}revert(){if(this.initialTransform?this.node.source.transform=this.initialTransform:this.node.source.transform=null,this.parameterTransformers)for(let e of this.parameterTransformers)e.revert()}}class VC{constructor(e,t){var n;this.selectable=e;const{node:i,instance:r,parameter:s}=e,o=r.args[s.name];this.initialArg=o,this.overrideAnchorHandleConstraint=t;const a=Oj.traceForNode(i);if(a){this.initialContextMatrix=ZC(i,r);const t=iS(e);t&&(this.initialContextMatrix=this.initialContextMatrix.clone().translate(t));const o=a.traceForInstance(r);if(o&&(this.initialValue=o.resultForArgName(s.name),i.isAnchor())){const e=null==(n=o.args.handleConstraint)?void 0:n.evaluationResult;"string"==typeof e&&(this.initialAnchorConstraint=e),this.initialAnchorConstraintArg=o.source.args.handleConstraint}}else{const t=e.expression();if(t&&t.isLiteral()){const e=Oj.project.settings.units;this.initialValue=t.literalValueInUnit(e)}}}transformWorld(e,t){if(!this.initialContextMatrix)return;const n=e.clone().changeBasis(this.initialContextMatrix);this.transformContext(n,t)}transformContext(e,t,n=!1){if(this.selectable.isTransformable())if(this.initialValue instanceof It){let i;i=n&&this.selectable.parameter.interface instanceof ew?this.initialValue.clone().affineTransformWithoutTranslation(e):this.initialValue.clone().affineTransform(e),this.assignValue(i,t)}else if(Ks(this.initialValue)){const n=this.selectable.parameter.interface;if(n instanceof Xb){const n=e.toTransform(),i=this.initialValue+n.rotation;this.assignValue(i,{...t,minimumFractionDigits:0})}else if(n instanceof Yb){const n=e.toTransform(),i=this.initialValue*n.scale.x;this.assignValue(i,{...t,minimumFractionDigits:0})}}else if(this.initialValue instanceof Ne&&!(null==t?void 0:t.preserveImageTransforms)&&this.selectable.parameter.interface instanceof rw){const n=this.initialValue.clone().preMul(e);this.assignValue(n,t)}}revert(){this.initialArg?this.selectable.instance.args[this.selectable.parameter.name]=this.initialArg:this.selectable.revertToDefault(),this.selectable.node.isAnchor()&&(this.initialAnchorConstraintArg?this.selectable.instance.args.handleConstraint=this.initialAnchorConstraintArg:delete this.selectable.instance.args.handleConstraint)}assignValue(e,t){var n,i;const r=HC(t),{args:s}=this.selectable.instance,{name:o}=this.selectable.parameter;if(s[o]=new _b(Vb(e,r)),this.selectable.node.isAnchor()&&this.selectable.instance===this.selectable.node.source.base&&e instanceof It){const o=Oj.traceForNode(this.selectable.node);if(null==o?void 0:o.isSuccess()){const a=this.overrideAnchorHandleConstraint??(null==t?void 0:t.overrideAnchorHandleConstraint)??this.initialAnchorConstraint;if("string"==typeof a){const t="handleIn"===this.selectable.parameter.name,s=t?e:null==(n=o.base.args.handleIn)?void 0:n.evaluationResult,l=t?null==(i=o.base.args.handleOut)?void 0:i.evaluationResult:e;s instanceof It&&l instanceof It&&((e,t,n,i,r,s,o)=>{if("free"!==t){const{args:a}=e.base;s&&!n.isZero()?a.handleOut=RC(r,n,t,o):i&&!r.isZero()&&(a.handleIn=RC(n,r,t,o))}})(this.selectable.node.source,a,s,!t,l,t,r)}{let e=this.initialAnchorConstraintArg;const n=null==t?void 0:t.assignAnchorHandleConstraint;n&&(e=new _b(`"${n}"`)),e?s.handleConstraint=e:delete s.handleConstraint}}}}}class jC{constructor(e){this.selectable=e,this.initialExpression=e.expression();const t=e.expressionTrace();if(t)this.initialValue=t.evaluationResult;else if(this.initialExpression.isLiteral()){const e=Oj.project.settings.units;this.initialValue=this.initialExpression.literalValueInUnit(e)}}transformWorld(e,t){this.transformContext(e,t)}transformContext(e,t,n=!1){if(this.selectable.isTransformable()&&this.initialValue instanceof It){let i;i=n&&this.selectable.parameter.interface instanceof ew?this.initialValue.clone().affineTransformWithoutTranslation(e):this.initialValue.clone().affineTransform(e),this.assignValue(i,t)}}revert(){this.selectable.parameter.expression=this.initialExpression}assignValue(e,t){const n=HC(t),{parameter:i}=this.selectable;i.expression=new _b(e instanceof It?Fb(e,n):Db(e,n))}}const HC=e=>{if(null==e?void 0:e.minimumFractionDigits)return e.minimumFractionDigits;const t=Oj.project.focusedComponent();return t?Oj.viewportManager.viewportForComponent(t).precisionInfo().fractionDigits:void 0},UC=Object.freeze(new It),zC=e=>{const t=Oj.traceForNode(e);if(t)return t.transformMatrix();const{transform:n}=e.source;if(n){const e=WC(n);if(e)return e}return Ne.indentity},WC=e=>{const{args:t}=e,n={},i=Oj.project.settings.units;if(t.position){const e=t.position.compiled().literal;if(!e)return;if("Vec"!==e.type)return;let r=e.value;e.unit&&(r=Qr(r,e.unit,i)),n.position=r}if(t.rotation){const e=t.rotation.compiled().literal;if(!e)return;if("Number"!==e.type)return;n.rotation=e.value}if(t.scale){const e=t.scale.compiled().literal;if(!e)return;if("Vec"!==e.type&&"Number"!==e.type)return;let r=e.value;e.unit&&(r=Qr(r,e.unit,i)),n.scale=r}if(t.skew){const e=t.skew.compiled().literal;if(!e)return;if("Number"!==e.type)return;n.skew=e.value}if(t.origin){const e=t.origin.compiled().literal;if(!e)return;if("Vec"!==e.type)return;let r=e.value;e.unit&&(r=Qr(r,e.unit,i)),n.origin=r}return Ne.fromTransform(n)},GC=e=>{const t=zC(e).clone();let{parent:n}=e;for(;n;){const e=zC(n);t.preMul(e),n=n.parent}return t},$C=e=>e.parent?GC(e.parent):Ne.indentity,ZC=(e,t)=>t===e.source.base?GC(e):$C(e),qC=e=>{const t=Oj.traceForNode(e);if(null==t?void 0:t.isSuccess()){const n=$C(e);return t.result.clone().affineTransform(n)}},KC=e=>{var t,n;const{transform:i}=e.source;if(null==i?void 0:i.isEnabled){const r=null==(t=i.expressionForParameterWithName("origin"))?void 0:t.literal();if(r&&"Vec"===r.type)return r.value;{const t=Oj.traceForNode(e),i=null==(n=null==t?void 0:t.transform)?void 0:n.resultForArgName("origin");if(It.isValid(i))return i}}const r=Oj.traceForNode(e);if(null==r?void 0:r.base.isSuccess()){const e=r.base.result.boundingBox();if(e)return e.center()}return UC},YC=e=>{const t=e.allTransformable();if(1===t.items.length&&t.items[0]instanceof rS){const{node:e}=t.items[0];return{boundingBox:XC(e),boundingBoxTransform:GC(e)}}return{boundingBox:e.worldBoundingBox(),boundingBoxTransform:Ne.indentity}},XC=(e,t)=>{const n=Oj.traceForNode(e);if(!(null==n?void 0:n.base.isSuccess()))return;return n.base.result.boundingBox()},JC=e=>{const{parameter:t}=e,n=t.interface;if(n&&!n.isVisible)return;const i=e.instanceTrace();if(!i)return;const r=i.resultForArgName(t.name);if(!It.isValid(r))return;if(n instanceof ew&&r.isZero())return;let s,o=r;if(e instanceof oS){const{node:t,instance:r}=e;let a=ZC(t,r);if(n instanceof ew){const e=KC(t).clone().affineTransform(zC(t)),{originParameterName:r}=n;if(r){const e=i.resultForArgName(r);It.isValid(e)&&(s=e.clone().affineTransform(a))}else a=a.clone().translate(e),s=(new It).affineTransform(a);o=o.clone().affineTransformWithoutTranslation(a),s&&o.add(s)}else o=o.clone().affineTransform(a)}return{handlePosition:o,originPosition:s}},QC=(e,t)=>{const n=Oj.project.transformCenter();if(!n)return;const i=n.worldPosition,r=i.clone().sub(t),s=i.clone().add(t),o=Ne.fromCenterAndReferencePoints(i,r,s,{allowScale:!0});for(let a of e){new BC(a).transformWorld(o)}},eS=(e,t)=>"left"===t?new It(e.min.x,0):"center"===t?new It(.5*(e.min.x+e.max.x),0):"right"===t?new It(e.max.x,0):new It(0,"top"===t?e.min.y:"middle"===t?.5*(e.min.y+e.max.y):e.max.y),tS=(e,t)=>{const n=e.filter(e=>e.isLocked()),i=e.filter(e=>!e.isLocked()),r=n.length>0?n:e,s=new De(new It(1/0),new It(-1/0));for(let l of r){const e=Oj.traceForNode(l);if(null==e?void 0:e.base.isSuccess()){const t=GC(l),n=e.base.result.clone().affineTransform(t).boundingBox();n&&s.expandToIncludeBoundingBox(n)}}if(!s.isFinite())return;const o=eS(s,t),a=[];for(let l of i){const e=Oj.traceForNode(l);if(null==e?void 0:e.base.isSuccess()){const n=GC(l),i=e.base.result.clone().affineTransform(n).boundingBox();if(i){const e=eS(i,t);a.push({node:l,point:e})}}}for(let{node:l,point:c}of a){const e=Ne.fromTranslation(o.clone().sub(c));new BC(l).transformWorld(e)}},nS=(e,t,n,i)=>{const r=Oj.project.transformCenter(),s=n.clone().invert();let o;o=r?r.worldPosition.clone().affineTransform(s):t.center();const a=Ne.fromCenterScale(o,i);a.changeBasis(s,n),a.ensureMinimumBasisLength(Oj.project.settings.tolerance);const l=e.isSingle();new FC(e).transformWorld(a,{preserveRotation:l})},iS=e=>{const t=e.parameter.interface;if(t instanceof ew){const{originParameterName:n}=t;if(e instanceof oS){const{node:t,instance:i}=e,r=Oj.traceForNode(t);if(r){if(void 0!==n){const e=null==r?void 0:r.traceForInstance(i);if(e){const t=e.resultForArgName(n);if(It.isValid(t))return t}}const e=KC(t),s=zC(t);return e.clone().affineTransform(s)}}else{if(void 0===n)return new It;{const t=e.expressionTrace(),n=null==t?void 0:t.evaluationResult;if(It.isValid(n))return n}}}};class rS{constructor(e){this.node=e}isValid(){return!0}isImmutable(){return this.node.isImmutable()}equals(e){return e instanceof rS&&this.node.equalsNode(e.node)}isPositionLocked(){return this.node.source.isPositionLocked()}isRotationLocked(){return this.node.source.isRotationLocked()}isScaleLocked(){return this.node.source.isScaleLocked()}isSkewLocked(){return this.node.source.isSkewLocked()}nodes(){return[this.node]}allNodes(){return[this]}allInstances(){return[]}worldBoundingBox(){var e;return null==(e=qC(this.node))?void 0:e.boundingBox()}}ub("SelectableNode",rS);class sS{constructor(e,t){this.node=e,this.instance=t}isValid(){return this.node.source.hasInstance(this.instance)}isImmutable(){return this.node.isImmutable()}isBase(){return this.node.source.base===this.instance}isComponent(){const{definition:e}=this.instance;return e instanceof vb||e instanceof yb}isModifier(){return this.instance.definition instanceof Nb}equals(e){return e instanceof sS&&this.node.equalsNode(e.node)&&this.instance===e.instance}isPositionLocked(){return this.node.source.isPositionLocked()}isRotationLocked(){return this.node.source.isRotationLocked()}isScaleLocked(){return this.node.source.isScaleLocked()}isSkewLocked(){return this.node.source.isSkewLocked()}nodes(){return[this.node]}allNodes(){return[new rS(this.node)]}allInstances(){return[this]}definition(){return this.instance.definition}worldBoundingBox(){const e=this.instanceTrace();if(!(null==e?void 0:e.isSuccess()))return;const t=$C(this.node);return e.result.clone().affineTransform(t).boundingBox()}instanceTrace(){const e=Oj.traceForNode(this.node);return null==e?void 0:e.traceForInstance(this.instance)}contextMatrix(){return ZC(this.node,this.instance)}}ub("SelectableInstance",sS);class oS{constructor(e,t,n){this.node=e,this.instance=t,this.parameter=n}static fromName(e,t,n){const i=t.definition.parameterWithName(n);return Ps(void 0!==i),new oS(e,t,i)}isValid(){return this.node.source.hasInstance(this.instance)&&this.instance.definition.hasParameter(this.parameter)}isImmutable(){return this.node.isImmutable()}equals(e){return e instanceof oS&&this.node.equalsNode(e.node)&&this.instance===e.instance&&this.parameter===e.parameter}nodes(){return[this.node]}allNodes(){return[new rS(this.node)]}allInstances(){return[new sS(this.node,this.instance)]}worldBoundingBox(){const e=JC(this);if(e)return new De(e.handlePosition.clone(),e.handlePosition.clone())}expression(){return this.instance.args[this.parameter.name]??this.parameter.expression}ensureEditableExpression(e=!1){const{name:t}=this.parameter,{args:n}=this.instance;if(!n.hasOwnProperty(t)){const i=this.parameter.expression;if(e&&!this.instance.definition.isImmutable)return i;n[t]=i.clone()}return n[t]}instanceTrace(){const e=Oj.traceForNode(this.node);return null==e?void 0:e.traceForInstance(this.instance)}expressionTrace(){const e=this.instanceTrace();return null==e?void 0:e.args[this.parameter.name]}definition(){return this.instance.definition}isTransformable(){return this.expression().isLiteral()}isPositionLocked(){return!this.isTransformable()}isRotationLocked(){return!this.isTransformable()}isScaleLocked(){return!this.isTransformable()}isSkewLocked(){return!this.isTransformable()}isOverridden(){return this.instance.args.hasOwnProperty(this.parameter.name)}setAsDefault(){const{name:e}=this.parameter,t=this.instance.args[e];Ps(t,`Arg ${e} does not exist. Can't set as default`),this.parameter.expression.jsCode=t.jsCode}revertToDefault(){delete this.instance.args[this.parameter.name]}contextMatrix(){return ZC(this.node,this.instance)}}ub("SelectableParameter",oS);class aS{constructor(e,t){this.component=e,this.parameter=t}isValid(){return this.component.hasParameter(this.parameter)}isImmutable(){return this.component.isImmutable}equals(e){return e instanceof aS&&this.component===e.component&&this.parameter===e.parameter}nodes(){return[]}allNodes(){return[]}allInstances(){return[]}worldBoundingBox(){const e=JC(this);if(e)return new De(e.handlePosition.clone(),e.handlePosition.clone())}expression(){return this.parameter.expression}ensureEditableExpression(){return this.expression()}instanceTrace(){var e;return this.component instanceof gS?null==(e=Oj.projectTrace)?void 0:e.base:Oj.traceForComponent(this.component)}expressionTrace(){var e;return null==(e=this.instanceTrace())?void 0:e.args[this.parameter.name]}definition(){return this.component}isTransformable(){return this.expression().isLiteral()}isPositionLocked(){return!this.isTransformable()}isRotationLocked(){return!this.isTransformable()}isScaleLocked(){return!this.isTransformable()}isSkewLocked(){return!this.isTransformable()}isOverridden(){return this.parameter.isOverridden()}revertToDefault(){this.parameter.revertToDefault()}contextMatrix(){return new Ne}}ub("SelectableComponentParameter",aS);class lS{constructor(e,t){this.node=e,this.nextNode=t}isValid(){return null!==this.node.parent&&null!==this.nextNode.parent&&this.node.parent.equalsNode(this.nextNode.parent)}isImmutable(){return this.node.isImmutable()||this.nextNode.isImmutable()}equals(e){return e instanceof lS&&this.node.equalsNode(e.node)&&this.nextNode.equalsNode(e.nextNode)}isPositionLocked(){return this.node.source.isPositionLocked()||this.nextNode.source.isPositionLocked()}isRotationLocked(){return this.node.source.isRotationLocked()||this.nextNode.source.isRotationLocked()}isScaleLocked(){return this.node.source.isScaleLocked()||this.nextNode.source.isScaleLocked()}isSkewLocked(){return this.node.source.isSkewLocked()||this.nextNode.source.isSkewLocked()}nodes(){return[this.node,this.nextNode]}allNodes(){return[new rS(this.node),new rS(this.nextNode)]}allInstances(){return[]}worldBoundingBox(){const e=qC(this.node),t=qC(this.node);if(e instanceof Wn&&t instanceof Wn)return new Ri([e,t]).boundingBox()}isBendLocked(){return cS(this.node,"handleOut")||cS(this.nextNode,"handleIn")}isMoveLocked(){return this.nodes().some(e=>e.source.isPositionLocked())}}ub("SelectableSegment",lS);const cS=(e,t)=>{var n,i;if(null==(n=e.source.base.args[t])?void 0:n.isComputed())return!0;const r=Oj.traceForNode(e);if(!(null==r?void 0:r.base.isSuccess()))return!0;const s=r.base.resultForArgName("handleConstraint"),o="handleIn"===t?"handleOut":"handleIn";return!("mirror"!==s&&"tangent"!==s||!(null==(i=e.source.base.args[o])?void 0:i.isComputed()))};let hS=class e{constructor(e=[]){this.items=e}clone(){return new e(this.items.slice())}add(...e){return this.items.push(...e),this}addUnique(...e){for(let t of e)this.items.some(e=>t.equals(e))||this.items.push(t);return this}toggle(e,t){const n=this.items.findIndex(t=>e.equals(t));return-1!==n||void 0!==t&&!t?t||this.items.splice(n,1):this.add(e),this}clear(){return this.items=[],this}sortInDocumentOrder(){return this.items.sort(dS),this}reverse(){return this.items.reverse(),this}isEmpty(){return 0===this.items.length}isSingle(){return 1===this.items.length}isMultiple(){return this.items.length>1}contains(...e){return e.every(e=>this.items.some(t=>e.equals(t)))}isNodeDirectlySelected(e){return this.items.some(t=>t instanceof rS&&e.equalsNode(t.node))}isNodeIndirectlySelected(e){return this.items.some(t=>t.allNodes().some(t=>e.equalsNode(t.node)))}isInstanceIndirectlySelected(e){return this.items.some(t=>(t instanceof sS||t instanceof oS)&&t.instance===e)}isImmutable(){return this.items.some(e=>e.isImmutable())}isPositionLocked(){return this.items.some(e=>e.isPositionLocked())}isRotationLocked(){return this.items.some(e=>e.isRotationLocked())}isScaleLocked(){return this.items.some(e=>e.isScaleLocked())}isSkewLocked(){return this.items.some(e=>e.isSkewLocked())}isUniformScale(){return this.items.some(e=>e.nodes().some(e=>e.source.isUniformScale()))}hasAnchor(){return this.items.some(e=>e.nodes().some(e=>e.isAnchor()))}isAllAnchors(){return!this.isEmpty()&&this.items.every(e=>e.nodes().every(e=>e.isAnchor()))}isAllAnchorHandles(){return!this.isEmpty()&&this.items.every(e=>e instanceof oS&&e.node.isAnchor())}isPassThrough(){return this.items.some(e=>e instanceof rS&&e.node.source.isPassThrough())}hasOnly(e){return this.items.every(t=>t instanceof e)}hasAny(e){return this.items.some(t=>t instanceof e)}filter(t){return new e(this.items.filter(t))}filterByType(t){const n=new e;for(let e of this.items)e instanceof t&&n.items.push(e);return n}directlySelectedNodes(){return this.filterByType(rS)}directlySelectedInstances(){return this.filterByType(sS)}mutables(){return this.filter(e=>e.allNodes().every(e=>!e.node.isImmutable()))}topNodes(){const e=this.directlySelectedNodes();return e.filter(t=>e.items.every(e=>!e.node.isAncestorOfNode(t.node)))}allTransformable(){const t=new e;for(let e of this.items)e instanceof rS?t.addUnique(e):e instanceof sS||e instanceof lS?t.addUnique(...e.allNodes()):e instanceof aS&&e.isTransformable()&&t.addUnique(e);for(let e of this.items)if(e instanceof oS){const n=e.instance===e.node.source.base,i=t.isNodeDirectlySelected(e.node);n?i||t.addUnique(e):i&&!e.parameter.isPoint()||t.addUnique(e)}return t}allParametersToShow(){const t=[];for(let e of this.items)if(e instanceof rS||e instanceof oS){pS(t,e.node,e.node.source.base);for(let n of e.node.source.modifiers)pS(t,e.node,n);e.node.isAnchor()&&fS(t,e.node)}else if(e instanceof sS){if(e.instance===e.node.source.transform)continue;pS(t,e.node,e.instance)}else if(e instanceof lS)pS(t,e.node,e.node.source.base),pS(t,e.nextNode,e.nextNode.source.base);else if(e instanceof aS)for(let n of e.component.allParameters())t.push(new aS(e.component,n));return new e(uS(t)).sortInDocumentOrder()}allNodesAndInstancesToShow(){const e=this.directlySelectedNodes();for(let t of this.items)for(let n of t.allInstances())n.instance.definition!==gx&&e.addUnique(n);return e.sortInDocumentOrder()}allNodes(){const t=uS(this.items.flatMap(e=>e.allNodes()));return new e(t)}allNodesAndAncestorNodes(){const e=this.allNodes(),t=n=>{if(n.parent){const i=new rS(n.parent);e.contains(i)||(e.add(i),t(n.parent))}};for(let n of e.items)t(n.node);return e}allInstances(){const t=uS(this.items.flatMap(e=>e.allInstances()));return new e(t)}toNodes(){return this.items.flatMap(e=>e.nodes())}commonAncestorNode(){const e=this.allNodes();if(e.isEmpty())return;let t=e.items[0].node.parent;for(;t;){if(e.items.every(e=>t.isAncestorOfNode(e.node)))break;t=t.parent}return t??void 0}worldBoundingBox(){let e;for(let t of this.items){const n=t.worldBoundingBox();n&&(e?e.expandToIncludeBoundingBox(n):e=n)}return e}};ub("Selection",hS);const uS=e=>{const t=[];for(let n of e)t.some(e=>n.equals(e))||t.push(n);return t},dS=(e,t)=>{if(e instanceof aS&&t instanceof aS){const n=e.component.allParameters(),i=t.component.allParameters();return n.findIndex(t=>t===e.parameter)-i.findIndex(e=>e===t.parameter)}if(e instanceof aS)return-1;if(t instanceof aS)return 1;const n=e.nodes();if(0===n.length)return 0;const i=t.nodes();if(0===i.length)return 0;if(n[0].equalsNode(i[0])&&(e instanceof sS||e instanceof oS)&&(t instanceof sS||t instanceof oS)){if(e.instance===t.instance&&e instanceof oS&&t instanceof oS){const n=e.definition().allParameters(),i=t.definition().allParameters();return n.findIndex(t=>t.name===e.parameter.name)-i.findIndex(e=>e.name===t.parameter.name)}const i=n[0].source.allInstances();return i.indexOf(e.instance)-i.indexOf(t.instance)}const r=n[0].indexPath(),s=i[0].indexPath();for(let o=0,a=r.length;o<a;o++){if(o>=s.length)return 1;if(r[o]<s[o])return-1;if(r[o]>s[o])return 1}return-1},pS=(e,t,n)=>{for(const i of n.definition.allParameters())e.push(new oS(t,n,i))},fS=(e,t)=>{const n=t.parent;if(!n)return;let i=!1;if(n.isPath()){const e=Oj.traceForNode(n),t=null==e?void 0:e.base.args.closed;(null==t?void 0:t.isSuccess)&&"boolean"==typeof t.evaluationResult&&(i=t.evaluationResult)}const r=t.indexInParent(),s=n.childCount();let o,a;i?(o=n.childNodeAtIndex(Et(r-1,s)),a=n.childNodeAtIndex(Et(r+1,s))):(r>0&&(o=n.childNodeAtIndex(r-1)),r<s-1&&(a=n.childNodeAtIndex(r+1))),o&&o.isAnchor()&&e.push(oS.fromName(o,o.source.base,"handleOut")),a&&a.isAnchor()&&e.push(oS.fromName(a,a.source.base,"handleIn"))};class mS extends rb{constructor(){super(...arguments),this.units="in",this.gridDivisions="decimal",this.hairlineStrokeWidth=.01,this.tolerance=Be,this.precision=6,this.rasterizeExportedImages=!0,this.rasterizeExportedImagesPixelsPerInch=300}materialKeys(){return["units","gridDivisions","hairlineStrokeWidth","tolerance","precision","rasterizeExportedImages","rasterizeExportedImagesPixelsPerInch"]}}ub("ProjectSettings",mS);class gS extends lb{constructor(){super(),this.projectId="",this.settings=new mS,this.modifiers=[],this.expressionFocus=null,this.selection=new hS,this.hoveredItem=null,this.expandedNodes=[],this.instancesEditingCode=[],this._transformCenter=null,this.isTransformBoxEnabled=!0,this.isGridEnabled=!0,this.isGuidesEnabled=!0,this.settings.units=xf.projectUnits;const e=new vb(new bx(new wx(px)));e.name="Component A",this.components=[e],this.focus=new CC(e,new DC(null,e.element)),this.documentation=new bC("Read Me",{type:"doc",content:[{type:"paragraph"}]})}materialKeys(){return["name","parameters","parameterFolders","components","modifiers","documentation","settings"]}immaterialKeys(){return["focus","selection","expressionFocus","expandedNodes","instancesEditingCode","_transformCenter","isTransformBoxEnabled","isGridEnabled","isGuidesEnabled"]}topNode(){if(this.focus instanceof CC)return new DC(null,this.focus.component.element)}isGlobalProject(){return this===Oj.project}focusItem(e){this.isGlobalProject()&&Oj.activateTool("Select"),e instanceof bC?this.focus=new kC(e):e instanceof yb?this.focus=new SC(e):e instanceof vb?this.focus=new CC(e,new DC(null,e.element)):e instanceof mS&&(this.focus=new LC(e)),this.blurExpression(),this.clearSelection(),this.hoveredItem=null}ensureValidFocusedComponent(){(this.focus instanceof CC||this.focus instanceof SC)&&this.components.includes(this.focus.component)||this.focusItem(this.previewComponent())}hasFocusedComponent(){return this.focus instanceof CC||this.focus instanceof SC}focusedComponent(){if(this.focus instanceof CC||this.focus instanceof SC)return this.focus.component}exportComponent(){const e=this.focusedComponent();if(e)return e;const t=this.documentation.exportComponentEmbedId();if(t){const e=this.components.find(e=>e.id===t);if(e)return e}return this.ensureFirstMutableComponent()}previewComponent(){const e=this.documentation.previewComponentEmbedId();if(e){const t=this.components.find(t=>t.id===e);if(t)return t}return this.ensureFirstMutableComponent()}ensureFirstMutableComponent(){const e=this.components.find(e=>!e.isImmutable);return e||(console.warn("No mutable components found, creating a new one."),this.createComponent())}componentById(e){return this.components.find(t=>t.id===e)}componentByName(e){return this.components.find(t=>t.name===e)}modifierByName(e){return this.modifiers.find(t=>t.name===e)}focusedDocumentation(){if(this.focus instanceof kC)return this.focus.documentation}createComponent(e,t){const n=new vb(new bx(new wx(px)));return n.projectId=this.projectId,n.name=e??"Component A",this.insertComponent(n,t),n}insertComponent(e,t){const n=this.makeDefinitionNameGenerator();e.name=n.generate(e.name),void 0!==t?this.components.splice(t,0,e):this.components.push(e)}removeComponent(e){let t=this.components.indexOf(e);this.components.splice(t,1),0===this.components.length&&this.createComponent();const n=e=>{let t;for(let n=e;n<this.components.length;++n)if(t=this.components[n],!t.isImmutable)return t;for(let n=e-1;n>=0;--n)if(t=this.components[n],!t.isImmutable)return t};if(this.focusedComponent()===e){const e=n(t);e?this.focusItem(e):this.focusItem(this.createComponent())}new gC(this).removeUnusedImmutableComponents(),this.ensureProjectDataExists()}duplicateComponent(e){const t=e.clone(),n=this.components.indexOf(e)+1;return this.insertComponent(t,n),t}createVariationOfInstance(e){let{definition:t}=e;t instanceof Nb?t=this.duplicateModifier(t):(t instanceof vb||t instanceof yb)&&(t=this.duplicateComponent(t)),t.isImmutable=!1,e.definition=t,(t instanceof yb||t instanceof Nb)&&this.setEditingCode(e,!0),iC.goTo(0),Oj.autoSelectForRename=t,this.ensureProjectDataExists()}setDefinitionIsPassThrough(e,t){e.isPassThrough=t,t&&this.allElements().forEach(t=>{t.base.definition===e&&(t.transform=null)})}createModifier(e){void 0===e&&(e="Modifier A"),e=this.makeDefinitionNameGenerator().generate(e);const t=new Nb;return t.projectId=this.id,t.name=e,t.code.jsCode="console.log(input);\nreturn input;",this.modifiers.push(t),t}duplicateModifier(e){const t=e.clone(),n=this.makeDefinitionNameGenerator();return t.name=n.generate(e.name),this.modifiers.push(t),t}removeModifier(e){const t=this.modifiers.indexOf(e);Ps(t>=0,"Modifier not found."),this.modifiers.splice(t,1),this.ensureProjectDataExists()}createCodeComponent(e,t){void 0===e&&(e="Code Component A"),e=this.makeDefinitionNameGenerator().generate(e);const n=new yb;return n.projectId=this.id,n.name=e,n.code.jsCode="const c = Path([\n  Anchor(\n    Vec(0.35, -0.35), // position\n    Vec(0.0, 0.0),    // handleIn\n    Vec(-1.1, -0.6)   // handleOut\n  ),\n  Anchor(Vec(0.35, 0.35), Vec(-1.1, 0.6), Vec(0.0, 0.0)),\n]);\n\nconst o = Circle().transform({\n  position: Vec(-0.07, 0.0),\n});\n\nconst d = Polygon({ sides: 3 }).transform({\n  position: Vec(-0.15, 0.0),\n  rotation: 90,\n  scale: 1.1\n});\n\nconst e = Path.fromPoints([\n  Vec(0.0, 0.5),\n  Vec(-0.5, 0.0),\n  Vec(0.0, -0.5),\n  Vec(0.5, 0.0),\n  Vec(-0.5, -0.0),\n]);\n\nconst code = [c, o, d, e];\n\ncode.forEach((geom, i) => {\n  // Spread the letters out\n  const x = mix(-1.8, 1.8, i / 3);\n  geom.transform({ position: Vec(x, 0) });\n  \n  // Assign a colored stroke\n  const hue = i / 8 + 0.25;\n  const color = Color.fromHSVA(hue, 0.6, 1.0, 1.0);\n  geom.assignStroke(Stroke(\n    color,\n    false, // hairline\n    0.10   // width\n  ));\n});\n\nreturn code;",void 0!==t?this.components.splice(t,0,n):this.components.push(n),n}updateExpandedNodes(){Ps(this.focus instanceof CC),this.expandUpToNode(this.focus.node),this.focus.node.isPath()||this.expandNode(this.focus.node);const e=this.selection.allNodes();for(let t of e.items)this.expandUpToNode(t.node)}focusNode(e){this.focus instanceof CC&&(this.focus.node=e,this.blurExpression()),this.updateExpandedNodes(),this.hoveredItem=null}isExpressionFocused(e){return Boolean(this.expressionFocus&&this.expressionFocus.expression===e)}focusExpression(e,t){this.expressionFocus=new xC(e,t)}blurExpressionIfFocused(e){this.isExpressionFocused(e)&&this.blurExpression()}blurExpression(){this.expressionFocus=null}updateFocusedNodeFromSelection(){const e=this.selection.allNodes().commonAncestorNode();e&&this.focusNode(e)}selectItems(e){this.selection=new hS(e),this.updateSelection()}selectItem(e){this.selectItems([e])}toggleSelectItems(e,t){for(let n of e)this.selection.toggle(n,t);this.updateSelection()}toggleSelectItem(e,t){this.selection.toggle(e,t),this.updateSelection()}clearSelection(){this.selection.clear(),this.updateSelection()}updateSelection(){var e;this.updateFocusedNodeFromSelection(),this.clearOverrideTransformCenter(),null==(e=window.getSelection())||e.removeAllRanges()}selectNode(e){this.selectItem(new rS(e))}selectNodes(e){this.selectItems(e.map(e=>new rS(e)))}toggleSelectNode(e,t){this.toggleSelectItem(new rS(e),t)}isItemHovered(e){return null!==this.hoveredItem&&this.hoveredItem.equals(e)}isNodeHovered(e){return this.hoveredItem instanceof rS&&e.equalsNode(this.hoveredItem.node)}isNodeFocused(e){return this.focus instanceof CC&&this.focus.node.equalsNode(e)}isNodeVisibleForEditing(e){return null===e.parent||(!!(this.isNodeFocused(e)||this.isNodeHovered(e)||this.selection.isNodeDirectlySelected(e))||e.source.isVisible&&this.isNodeVisibleForEditing(e.parent))}isNodeSelectable(e){return this.focus instanceof CC&&e.hasParentEqualToNode(this.focus.node)}isElementHovered(e){return this.hoveredItem instanceof rS&&this.hoveredItem.node.source===e}insertionPoint(e){let t,n;if(this.focus instanceof CC){const i=this.selection.allNodes().topNodes().mutables().sortInDocumentOrder();if(i.isEmpty())for(t=this.focus.node;t.isImmutable()||t.isImmutableChildren();)t=t.parent;else{const e=i.items[i.items.length-1].node;t=e.parent,n=e.indexInParent()+1}e&&t.isPath()&&(e.forbidParentPath||e.forbidCollapsedParentPath&&!this.isNodeExpanded(t))&&(t=t.parent,n=t.indexInParent()+1)}return{insertionParent:t,insertionIndex:n}}interactableNodesToShow(){const e=this.selection.directlySelectedNodes();if(this.focus instanceof CC){const t=!this.focus.node.isVisible();for(let n of this.focus.node.childNodes())(t||n.isVisible())&&e.addUnique(new rS(n))}return e.sortInDocumentOrder()}isNodeExpanded(e){return null===e.parent||this.expandedNodes.some(t=>t.equalsNode(e))}isNodeReachable(e){return null===e.parent||!!this.isNodeExpanded(e.parent)&&this.isNodeReachable(e.parent)}toggleExpandedNode(e){this.isNodeExpanded(e)?this.collapseNode(e):this.expandNode(e)}expandNode(e){if(null===e.parent)return;-1===this.expandedNodes.findIndex(t=>t.equalsNode(e))&&this.expandedNodes.push(e)}collapseNode(e){if(Ps(this.focus instanceof CC),null===e.parent)return;const t=this.expandedNodes.findIndex(t=>t.equalsNode(e));if(-1===t)return;this.expandedNodes.splice(t,1);let n=this.focus.node;for(;n.parent&&!this.isNodeReachable(n);)n=n.parent;n!==this.focus.node&&this.focusNode(n)}expandUpToNode(e){null!==e.parent&&(e.isAnchor()&&e.parent.isPath()||this.expandNode(e.parent),this.expandUpToNode(e.parent))}transferExpandedState(e,t){const n=[];this.expandedNodes.forEach(i=>{if(e.equalsNode(i))n.push(t);else if(e.isAncestorOfNode(i)){const r=e.sourcePath(),s=t.sourcePath(),o=i.sourcePath();o.splice(0,r.length,...s);const a=DC.fromSourcePath(o);null!==a&&n.push(a)}});for(let i of n)this.expandNode(i)}isEditingCode(e){return this.instancesEditingCode.includes(e)}setEditingCode(e,t){const n=this.instancesEditingCode.indexOf(e);t&&-1===n?this.instancesEditingCode.push(e):t||-1===n||this.instancesEditingCode.splice(n,1)}setOverrideTransformCenter(e){this._transformCenter=e}clearOverrideTransformCenter(){this._transformCenter=null}hasOverrideTransformCenter(){return null!==this._transformCenter}transformCenter(){var e;if(null!==this._transformCenter)return this._transformCenter;const t=this.selection.allNodes();if(t.isSingle()){const n=t.items[0].node;if((null==(e=n.source.transform)?void 0:e.isEnabled)&&!n.source.base.definition.isPassThrough){const e=GC(n),t=KC(n).clone().affineTransform(e);return new hC(t)}}const{boundingBox:n,boundingBoxTransform:i}=YC(this.selection);return(null==n?void 0:n.isFinite())?new hC(n.center().affineTransform(i)):void 0}focusedComponentParametersToShow(){const e=this.focusedComponent();return Ps(e),new hS(e.allParameters().map(t=>new aS(e,t)))}selectionParametersToShow(){return this.selection.allParametersToShow()}isParameterDerived(e,t){return t.expression.compiled().references.some(t=>e.hasParameterWithName(t.name))}isParameterVisible(e,t){return!t.hidden&&!t.isDeprecated&&!this.isParameterDerived(e,t)}definitionHasVisibleParameter(e){return e.allParameters().some(t=>this.isParameterVisible(e,t))}makeElementNameGenerator(){const e={};for(let t of this.allElements())e[t.name]=!0;return new dC(e)}makeDefinitionNameGenerator(){const e=this.makeGlobalNamesHash();for(const t of lC)e[t.name]=!0,e[gf(t.name)]=!0;for(const t of this.components)e[t.name]=!0,e[gf(t.name)]=!0;for(const t of this.modifiers)e[t.name]=!0,e[gf(t.name)]=!0;for(const t of this.parameters)e[t.name]=!0,e[gf(t.name)]=!0;return this.documentation&&(e[this.documentation.name]=!0),new pC(e)}makeParameterNameGenerator(e){const t=this.makeGlobalNamesHash();for(const n of this.components)t[n.name]=!0,t[gf(n.name)]=!0;for(const n of this.modifiers)t[n.name]=!0,t[gf(n.name)]=!0;for(let n of e)t[n.name]=!0;return new fC(t)}makeGlobalNamesHash(){const e={};for(let t of pf)e[t]=!0;for(let t of cC)e[t]=!0;return e}allElements(){const e=[],t=n=>{e.push(n),n.children.forEach(t)};for(let n of this.components)n instanceof vb&&t(n.element);return e}allInstances(){return this.allElements().flatMap(e=>e.allInstances())}usesProFont(){return PC(this)}usesCustomFont(){return AC(this)}allCustomFonts(){return MC(this)}allColors(){return IC(this)}renameElement(e,t,n=this.makeElementNameGenerator()){n.renameElement(e,t)}renameDefinition(e,t,n){const i=this.makeDefinitionNameGenerator(),r=this.makeElementNameGenerator();new gC(this).renameDefinition(e,t,i,r,n)}ensureUniqueNames(e,t=this.makeElementNameGenerator()){const n=t.preview(e.name);t.renameElement(e,n);for(let i of e.children)this.ensureUniqueNames(i,t)}createParameter(e,t,n="p1"){let i=e.allParameters();e!==this&&(i=i.concat(this.allParameters()));const r=this.makeParameterNameGenerator(i).generate(n),s=new hw(r,t);return e.parameters.push(s),s}moveComponentParameterToProject(e){if(!Oj.project.focusedComponent())return;const{component:t,parameter:n}=e;Ps(t instanceof vb||t instanceof yb);let i=n.name;if(this.hasParameterWithName(n.name)){i=this.makeParameterNameGenerator(this.allParameters()).generate(n.name),this.renameDefinitionParameter(t,n,i),i=n.name}this.removeDefinitionParameter(t,n);const r=this.createParameter(this,n.expression.jsCode,i);n.interface&&(r.interface=n.interface.clone()),Oj.isProjectParameterInspectorOpen=!0,Oj.autoSelectForRename=r}removeDefinitionParameter(e,t){e.removeParameter(t);const{name:n}=t;for(let i of this.allInstances())i.definition===e&&i.args.hasOwnProperty(n)&&delete i.args[n];this.ensureProjectDataExists()}removeDefinitionParameterFolder(e,t){for(let i of t.parameters)this.removeDefinitionParameter(e,i);const n=e.parameterFolders.indexOf(t);e.parameterFolders.splice(n,1)}renameDefinitionParameter(e,t,n,i){const r=this.makeParameterNameGenerator(e.allParameters());new gC(this).renameParameter(t,n,r,i),t.name.startsWith("_")&&(t.hidden=!0),this.ensureProjectDataExists()}createRepeatIndexVariable(e){this.renameRepeatIndexVariable(e,"rep")}renameRepeatIndexVariable(e,t){new gC(this).renameRepeatIndexVariable(e.instance,t)}contextComponentForNode(e){for(;e.parent;){const t=(e=e.parent).source.base.definition;if(t instanceof vb)return t}return this.focusedComponent()}extractAsComponent(e){if(0===e.length)return;const t=this.createComponent(),n=this.contextComponentForNode(e[0]);if(!n)return;if(e.some(e=>n!==this.contextComponentForNode(e)))return void console.warn("Cannot extract as component. Nodes all need to be in the same context.");const i=n.allParameters(),r=[],s=e=>{e.compiled().references.forEach(e=>{const t=e.name;if(!r.some(e=>e.sanitizedName()===t))for(const n of i)n.sanitizedName()===t&&(r.push(n),s(n.expression))})},o=e=>{e.allExpressions().forEach(s),e.children.forEach(o)};for(let h of e)o(h.source);r.sort((e,t)=>i.indexOf(e)-i.indexOf(t)),t.parameters=r.map(e=>e.clone()),t.element=new bx(new wx(px)),t.element.children=e.map(e=>e.source);const a=this.createElementWithDefinition(t);r.forEach(e=>{if(e.expression.isLiteral()){const t=e.name,n=e.sanitizedName();a.base.args[t]=new _b(n)}});const{insertionParent:l,insertionIndex:c}=this.insertionPoint();this.spliceNodes(e,[a],l,c)}createElementWithDefinition(e,t){t||(t=this.makeElementNameGenerator());const n=new bx(new wx(e)),i=t.generate(e.name+" 1");return n.name=i,n}bakeGeometry(e,t){const n=e=>new _b(Vb(e)),i=(e,t)=>{e.fill instanceof ji?(t.fill=new wx(cx),t.fill.args.color=n(e.fill.color)):e.fill instanceof Hi&&(t.fill=new wx(cx),t.fill.args.type=new _b('"image"'),t.fill.args.image=n(e.fill.image),t.fill.args.transform=n(e.fill.transform)),e.stroke&&(t.stroke=new wx(dx),t.stroke.args.color=n(e.stroke.color),t.stroke.args.hairline=n(e.stroke.hairline),t.stroke.args.width=n(e.stroke.width),t.stroke.args.alignment=n(e.stroke.alignment),t.stroke.args.cap=n(e.stroke.cap),t.stroke.args.join=n(e.stroke.join),t.stroke.args.miterLimit=n(e.stroke.miterLimit))};if(t||(t=this.makeElementNameGenerator()),e instanceof Wn){const i=this.createElementWithDefinition(gx,t);return i.base.args.position=n(e.position),e.handleIn.isZero()||(i.base.args.handleIn=n(e.handleIn)),e.handleOut.isZero()||(i.base.args.handleOut=n(e.handleOut)),e.hasTangentHandles()?i.base.args.handleConstraint=n("tangent"):i.base.args.handleConstraint=n("free"),i}if(e instanceof Ri){const r=this.createElementWithDefinition(mx,t);r.children=[];for(let n of e.anchors){const e=this.bakeGeometry(n,t);e&&r.children.push(e)}return r.base.args.closed=n(e.closed),i(e,r),r}if(e instanceof wi){const n=this.createElementWithDefinition(fx,t);n.children=[];for(let i of e.paths){const e=this.bakeGeometry(i,t);e&&(e.fill=null,e.stroke=null,n.children.push(e))}return i(e,n),n}if(e instanceof xi){const n=this.createElementWithDefinition(px,t);n.children=[];for(let i of e.items){const e=this.bakeGeometry(i,t);e&&n.children.push(e)}return n}}selectionElements(){const e=this.selection.sortInDocumentOrder();return e.hasAny(lS)?vS(e):e.allNodes().items.map(e=>e.node.source)}selectionPortableProjectData(){return new gC(this).portableProjectDataForSelection(this.selection)}componentPortableProjectData(e){return new gC(this).portableProjectDataForComponent(e)}duplicateElement(e,t=this.makeElementNameGenerator()){const n=e.clone();return this.ensureUniqueNames(n,t),n}duplicateElementWithoutChildren(e,t=this.makeElementNameGenerator()){const n=e.cloneWithoutChildren();return this.ensureUniqueNames(n,t),n}duplicateSelection(){const e=this.selection.mutables().sortInDocumentOrder();if(e.isEmpty())return;const t=this.makeElementNameGenerator();if(e.hasAny(lS)){const n=vS(e);for(let e of n)this.ensureUniqueNames(e,t);const{insertionParent:i,insertionIndex:r}=this.insertionPoint({forbidParentPath:!0}),s=this.spliceNodes([],n,i,r);this.selectNodes(s)}else{const n=e.allNodes().items.map(e=>this.duplicateElement(e.node.source,t)),{insertionParent:i,insertionIndex:r}=this.insertionPoint(),s=this.spliceNodes([],n,i,r);this.selectNodes(s)}}deleteSelection(){var e,t,n;const i=e=>{(null==e?void 0:e.isPath())&&0===e.childCount()&&this.spliceNodes([e])},r=this.selection.mutables().sortInDocumentOrder();if(r.isSingle()){const t=r.items[0];if(t instanceof rS){const n=t.node;if(null==(e=n.parent)?void 0:e.isPath()){const e=n.parent.childCount();if(e>1){const t=n.indexInParent();0===t?this.selectNode(n.parent.childNodeAtIndex(t+1)):t===e-1&&this.selectNode(n.parent.childNodeAtIndex(e-2))}}}}if(r.hasAny(lS)){for(let e=0;e<r.items.length;++e){const s=r.items[e];if(this.selectableExistsAndIsValid(s)&&s instanceof lS){const o=(t,n,i,s)=>{const o=this.spliceNodes(t,n,i,s);if(n)for(let a=e+1;a<r.items.length;++a)for(let e of r.items[a].nodes()){const t=o.find(t=>t.source===e.source);t&&e.copy(t)}},a=s.node.parent,l=a.childCount(),c=a.childNodeAtIndex(0),h=s.node.equalsNode(c),u=a.childNodeAtIndex(l-1),d=s.nextNode.equalsNode(u),p=a.source.base.args,f=[];let m,g,v=!1;if(null==(t=p.closed)?void 0:t.isLiteral())v=Boolean(p.closed.literalValue());else{const e=Oj.traceForNode(a);(null==e?void 0:e.isSuccess())&&(v=Boolean(null==(n=e.base.args.closed)?void 0:n.evaluationResult))}if(p.closed=new _b("false"),v)as(a.sourceChildren(),s.nextNode.indexInParent());else{if(h&&f.push(c),d&&f.push(u),!h&&!d){const e=a.source.cloneWithoutChildren();this.ensureUniqueNames(e);const[t]=this.spliceNodes([],[e],a.parent,a.indexInParent()+1),n=s.nextNode.indexInParent();m=a.source.children.splice(n),g=t}o(f,m,g),i(a)}}}this.selection=this.selection.filter(e=>!(e instanceof lS))}else for(let s of r.items)s instanceof rS?(this.spliceNodes([s.node]),i(s.node.parent)):s instanceof oS?s.revertToDefault():s instanceof sS&&s.node.source.removeModifier(s.instance);new gC(this).removeUnusedImmutableComponents(),this.ensureProjectDataExists()}spliceNodes(e,t,n,i){if(!t||!n){for(let t of e){const e=t.parent,n=e.childNodes().findIndex(e=>e.equalsNode(t));e.sourceChildren().splice(n,1)}return this.ensureProjectDataExists(),[]}const r=n.sourceChildren();void 0===i&&(i=r.length);for(let a of e){const e=a.parent,t=e.childNodes().findIndex(e=>e.equalsNode(a));e.equalsNode(n)&&t<i&&i--;e.sourceChildren().splice(t,1)}r.splice(i,0,...t);const s=t.map(e=>new DC(n,e)),o=s.slice();for(let a of s)o.push(...a.childNodes());for(let a of o)for(let t of e)if(t.source===a.source){this.transferExpandedState(t,a);break}return this.ensureProjectDataExists(),s}reparentNodes(e,t,n){if(e.every(e=>0===e.source.modifiers.length&&!e.source.isAnyTransformLocked()))for(let r of e){const e=$C(r),n=GC(t).clone().invert().mul(e);new BC(r).transformContext(n)}const i=e.map(e=>e.source);return Oj.project.spliceNodes(e,i,t,n)}customizedRepeatModifiersInInstanceScope(e){const t=[],n=(e,n)=>{const{modifiers:i}=e.source;for(;n<i.length;++n){const r=i[n];r.isRepeatModifier()&&r.repeatIndexVariableName&&t.push(new sS(e,r))}};let{node:i}=e;const r=i.source.modifiers.indexOf(e.instance);for(n(i,r+1);i.parent&&!i.parent.createsNewContext();)i=i.parent,n(i,0);return t}categorizedNamesInExpressionScope(e){const t=new gC(this).categorizedNamesInExpressionScope(e);return{repeats:t.repeats,parameters:t.parameters,components:t.components,modifiers:t.modifiers,builtins:lC.filter(({name:e})=>!e.endsWith("(old)")).map(({name:e})=>gf(e)),units:Zr,globals:[...pf,"cuttle","toProjectUnits"]}}allNamesInExpressionScope(e){const t=this.categorizedNamesInExpressionScope(e);return[...t.repeats,...t.parameters,...t.components,...t.modifiers,...t.builtins,...t.units,...t.globals]}ensureProjectDataExists(){if(this.expandedNodes=this.expandedNodes.filter(e=>this.nodeExists(e)&&e.hasChildNodes()),this.selection.items=this.selection.items.filter(e=>this.selectableExistsAndIsValid(e)),this.focus instanceof CC){let e=this.focus.node;for(;e.parent&&!this.nodeExists(e);)e=e.parent;e!==this.focus.node&&this.focusNode(e)}this.hoveredItem&&!this.selectableExistsAndIsValid(this.hoveredItem)&&(this.hoveredItem=null)}ensureProjectNamesDontConflictWithGlobals(){const e=this.makeGlobalNamesHash();for(const n of this.parameters)(e[n.name]||e[gf(n.name)])&&this.renameDefinitionParameter(this,n,n.name,!0);const t=[...this.components,...this.modifiers];for(const n of t){for(const t of n.parameters)(e[t.name]||e[gf(t.name)])&&this.renameDefinitionParameter(this,t,t.name,!0);(e[n.name]||e[gf(n.name)])&&this.renameDefinition(n,n.name,!0)}}assertIsValid(){for(let e of this.expandedNodes)console.assert(this.nodeExists(e),"Node does not exist",e);for(let e of this.selection.items)console.assert(this.selectableExistsAndIsValid(e),"Selected item does not exist",e);this.focus instanceof CC&&console.assert(this.nodeExists(this.focus.node),"Node does not exist",this.focus.node),this.hoveredItem&&console.assert(this.selectableExistsAndIsValid(this.hoveredItem),"Hovered item does not exist",this.hoveredItem),this.focus instanceof kC?console.assert(this.documentation===this.focus.documentation,"Focused Documentation is not Project documentation (only one for now)",this.focus.documentation):(this.focus instanceof CC||this.focus instanceof SC)&&console.assert(this.components.includes(this.focus.component),"Focused Component is not in Project components",this.focus.component)}nodeExists(e){return e instanceof DC&&(null===e.parent?this.components.some(t=>t instanceof vb&&t.element===e.source):this.nodeExists(e.parent)&&e.parent.sourceChildren().includes(e.source))}selectableExistsAndIsValid(e){return e.isValid()&&e.nodes().every(e=>this.nodeExists(e))}assertIdsAreUnique(){const e=new Set,t=n=>{Ps(!e.has(n.id)),e.add(n.id),n.childModelObjects().forEach(t)};t(this)}setParameterDefaults(){for(let e of this.allParameters())e.setDefault();for(let e of this.components)for(let t of e.allParameters())t.setDefault()}revertParametersToDefault(){for(let e of this.allParameters())e.revertToDefault(),e.clearDefault();for(let e of this.components)for(let t of e.allParameters())t.revertToDefault(),t.clearDefault()}}ub("Project",gS);const vS=e=>{const t=[];for(let n of e.items)if(n instanceof lS){const e=n.node,i=t.find(t=>{const n=t[t.length-1].nextNode;return e.equalsNode(n)});i?i.push(n):t.push([n])}return t.map(e=>{const t=e[0].node,n=e[e.length-1].nextNode,i=t.parent.source.cloneWithoutChildren();for(let r of e){const e=r.node.source.clone();i.children.push(e)}if(!t.equalsNode(n)){let e=n.source.clone();i.children.push(e),delete i.base.args.closed}return i})},yS=(e,t)=>{if(Ls(e))for(let n=0;n<e.length;++n)yS(e[n],t);else if(Es(e)){t(e);for(let n in e)yS(e[n],t)}},bS=(e,t)=>{t(e),Array.isArray(e)?e.forEach(e=>bS(e,t)):e&&"object"==typeof e&&Object.values(e).forEach(e=>bS(e,t))},wS=45,xS=(e,t)=>{if(!(e=>!!(Js(e)&&"Cuttle"===e.app&&Ys(e.type)&&Ks(e.version)&&Js(e.payload)))(e))return null;if(e.version===wS)return e;if((()=>{const{hostname:e}=window.location;return"staging.cuttle.xyz"===e||"staging.cuttlexyz.com"===e})()&&Oj.storage.hasWritePermission()){window.confirm(`You are on staging. Do you really want to upgrade from version ${e.version} to 45?`)||Cr("Close this window to prevent overwriting the project.")}return((e,t)=>{if(1===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&("Component"!==e["@class"]&&"Modifier"!==e["@class"]||e.parameters.forEach(e=>{e["@class"]="Parameter"}))}),e.version=2),2===e.version){const t={"PolygonDefinition/5":"PathDefinition","PolygonDefinition/19":"AnchorDefinition","PolygonDefinition/10":"RotationalRepeatDefinition","RectangleDefinition/7":"RoundCornersDefinition"};bS(e.payload,e=>{e&&"object"==typeof e&&t.hasOwnProperty(e["@builtin"])&&(e["@builtin"]=t[e["@builtin"]])}),e.version=3}if(3===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"StrokeDefinition"===e["@builtin"]&&(e["@builtin"]="OutlineStrokeDefinition")}),e.version=4),4===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Element"===e["@class"]&&(e.transformArgs.position&&(e.args.__transform_position=e.transformArgs.position),e.transformArgs.rotation&&(e.args.__transform_rotation=e.transformArgs.rotation),e.transformArgs.scale&&(e.args.__transform_scale=e.transformArgs.scale),delete e.transformArgs)}),e.version=5),5===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Element"===e["@class"]&&void 0===e.hasTransform&&(e.hasTransform=!!(e.args.__transform_position||e.args.__transform_rotation||e.args.__transform_scale||e.args.__transform_matrix))}),e.version=6),6===e.version&&(bS(e.payload,e=>{if(e&&"object"==typeof e&&"Project"===e["@class"]){if("string"==typeof e.units){const t=es(e.units);null!==t&&(e.units=t)}void 0!==e.transformCenter&&(e._transformCenter=e.transformCenter,delete e.transformCenter)}}),e.version=7),7===e.version){const t=new Set,n=new Set;bS(e.payload,e=>{e&&"object"==typeof e&&("Modifier"===e["@class"]?t.add(e["@id"]):"Component"===e["@class"]&&n.add(e["@id"]))}),bS(e.payload,e=>{e&&"object"==typeof e&&"JoinPathsDefinition"===e["@builtin"]&&(e["@builtin"]="MergePathsDefinition")}),bS(e.payload,e=>{e&&"object"==typeof e&&"Element"===e["@class"]&&(e.hasTransform&&(e.transform={"@class":"Instance",args:{},definition:{"@builtin":"TransformDefinition"}},void 0!==e.args.__transform_position&&(e.transform.args.position=e.args.__transform_position,delete e.args.__transform_position),void 0!==e.args.__transform_rotation&&(e.transform.args.rotation=e.args.__transform_rotation,delete e.args.__transform_rotation),void 0!==e.args.__transform_scale&&(e.transform.args.scale=e.args.__transform_scale,delete e.args.__transform_scale),void 0!==e.args.__transform_matrix&&(e.transform.args.matrix=e.args.__transform_matrix,delete e.args.__transform_matrix)),e.hasFill&&(e.fill={"@class":"Instance",args:{},definition:{"@builtin":"FillDefinition"}},void 0!==e.args.__fill_color&&(e.fill.args.color=e.args.__fill_color,delete e.args.__fill_color)),e.hasStroke&&(e.stroke={"@class":"Instance",args:{},definition:{"@builtin":"StrokeDefinition"}},void 0!==e.args.__stroke_color&&(e.stroke.args.color=e.args.__stroke_color,delete e.args.__stroke_color),void 0!==e.args.__stroke_hairline&&(e.stroke.args.hairline=e.args.__stroke_hairline,delete e.args.__stroke_hairline),void 0!==e.args.__stroke_width&&(e.stroke.args.width=e.args.__stroke_width,delete e.args.__stroke_width),void 0!==e.args.__stroke_alignment&&(e.stroke.args.alignment=e.args.__stroke_alignment,delete e.args.__stroke_alignment),void 0!==e.args.__stroke_cap&&(e.stroke.args.cap=e.args.__stroke_cap,delete e.args.__stroke_cap),void 0!==e.args.__stroke_join&&(e.stroke.args.join=e.args.__stroke_join,delete e.args.__stroke_join),void 0!==e.args.__stroke_miterLimit&&(e.stroke.args.miterlimit=e.args.__stroke_miterLimit,delete e.args.__stroke_miterLimit)),delete e.hasTransform,delete e.hasFill,delete e.hasStroke,e.base={"@class":"Instance",args:e.args,definition:e.definition},delete e.definition,delete e.args)}),bS(e.payload,e=>{e&&"object"==typeof e&&"Component"===e["@class"]&&(e.element={"@class":"Element","@id":e["@id"]+"/element",base:{"@class":"Instance",definition:{"@builtin":"GroupDefinition"}}},Array.isArray(e.children)&&(e.element.children=e.children),delete e.children)}),bS(e.payload,e=>{e&&"object"==typeof e&&"Project"===e["@class"]&&(e.focusedNode={"@class":"Node",parent:null,source:{"@ref":e.focusedComponent["@ref"]+"/element"}},delete e.selectedNodes,delete e.expandedNodes)});const i=e=>{if(e&&"object"==typeof e&&"Element"===e["@class"]){let n=e.base.definition;const i=e.base.definition["@builtin"];if(i&&"GroupDefinition"!==i&&"ShapeDefinition"!==i&&"PathDefinition"!==i&&"AnchorDefinition"!==i&&"TextDefinition"!==i&&"RectangleDefinition"!==i&&"CircleDefinition"!==i&&"PolygonDefinition"!==i)return!0;if("Modifier"===n["@class"])return!0;if(void 0!==n["@ref"]&&t.has(n["@ref"].toString()))return!0}return!1};bS(e.payload,e=>{i(e)&&(e.transform?(e.children=[{"@class":"Element",name:e.name,base:{"@class":"Instance",definition:{"@builtin":"GroupDefinition"}},modifiers:[e.base],children:e.children}],e.name+=" Transform",e.base={"@class":"Instance",definition:{"@builtin":"GroupDefinition"}}):(e.modifiers=[e.base],e.base={"@class":"Instance",definition:{"@builtin":"GroupDefinition"}}))}),e.version=8}if(8===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Project"===e["@class"]&&(delete e.selectedNodes,delete e.hoveredNode,delete e.hoveredParamName)}),e.version=9),9===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Project"===e["@class"]&&delete e.selection}),e.version=10),10===e.version&&(bS(e.payload,e=>{var t;e&&"object"==typeof e&&"Element"===e["@class"]&&"AnchorDefinition"===e.base.definition["@builtin"]&&(null==(t=e.transform)?void 0:t.args.position)&&(e.base.args.position=e.transform.args.position,delete e.transform)}),e.version=11),11===e.version&&(bS(e.payload,e=>{if(e&&"object"==typeof e&&"Instance"===e["@class"]&&"TransformDefinition"===e.definition["@builtin"]&&e.args.matrix){const t=Yy(e.args.matrix.jsCode);if(t&&"AffineMatrix"===t.type){const n=t.value.toTransform();e.args.position={"@class":"Expression",jsCode:Fb(n.position)},e.args.rotation={"@class":"Expression",jsCode:Db(n.rotation)},e.args.scale={"@class":"Expression",jsCode:Fb(n.scale)},e.args.skew={"@class":"Expression",jsCode:Db(n.skew)}}delete e.args.matrix}}),e.version=12),12===e.version&&(bS(e.payload,e=>{if(e&&"object"==typeof e&&"Element"===e["@class"]){const t=e.base.definition["@builtin"];"string"==typeof t&&"AnchorDefinition"!==t&&"GroupDefinition"!==t&&(e.fill||e.stroke||(e.stroke={"@class":"Instance",definition:{"@builtin":"StrokeDefinition"}}))}}),e.version=13),13===e.version&&("ElementsAndDependencies"===e.type&&(e.payload.dependencies={componentsAndModifiers:e.payload.dependencies,componentParameters:[],projectParameters:[]}),e.version=14),14===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&("ShapeDefinition"===e["@builtin"]?e["@builtin"]="CompoundPathDefinition":"Expression"===e["@class"]&&"string"==typeof e.jsCode&&(e.jsCode=e.jsCode.replace(/(\W+)(Shape)\s*\(/g,"$1CompoundPath("),e.jsCode=e.jsCode.replace(/.allShapes\s*\(/g,".allCompoundPaths("),e.jsCode=e.jsCode.replace(/.allShapesAndOrphanedPaths\s*\(/g,".allCompoundPathsAndOrphanedPaths(")))}),e.version=15),15===e.version&&(bS(e.payload,e=>{var t;e&&"object"==typeof e&&"Element"===e["@class"]&&"AnchorDefinition"===e.base.definition["@builtin"]&&'"point"'===(null==(t=e.base.args.handleConstraint)?void 0:t.jsCode)&&(e.base.args.handleConstraint.jsCode='"free"')}),e.version=16),16===e.version&&(bS(e.payload,e=>{var t;if(e&&"object"==typeof e&&"Element"===e["@class"]&&"AnchorDefinition"===e.base.definition["@builtin"]&&(null==(t=e.transform)?void 0:t.args.position)){const t=Yy(e.transform.args.position.jsCode);if(t&&"Vec"===t.type){if(e.base.args.position){const n=Yy(e.base.args.position.jsCode);n&&"Vec"===n.type&&t.value.add(n.value)}e.base.args.position={"@class":"Expression",jsCode:Fb(t.value)}}delete e.transform}}),e.version=17),17===e.version){if(bS(e.payload,t=>{if(t&&"object"==typeof t&&"Element"===t["@class"]){const n=t.base.definition;if(void 0===n["@builtin"]&&"Modifier"===n["@class"]&&(n["@class"]="CodeComponent","Project"===e.type)){const t=n["@id"];e.payload.components.push({"@ref":t}),e.payload.modifiers=e.payload.modifiers.filter(e=>e["@ref"]!==t)}}}),"Project"===e.type){const t=e.payload;t.focus={"@class":"ComponentFocus",component:t.focusedComponent,node:t.focusedNode},delete t.focusedComponent,delete t.focusedNode}e.version=18}if(18===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Expression"===e["@class"]&&(e.jsCode=e.jsCode.replace(/\.tightBoundingBox\s*\(/g,".boundingBox("),e.jsCode=e.jsCode.replace(/\.segments\s*\(/g,".segmentPaths("),e.jsCode=e.jsCode.replace(/\.edges\s*\(/g,".edgePaths("))}),e.version=19),19===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Project"===e["@class"]&&(e.definitionsEditingCode=e.editingModifiers)}),e.version=20),20===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Parameter"===e["@class"]&&delete e.interface}),e.version=21),21===e.version){let n=(null==t?void 0:t.defaultProjectId)??"";bS(e.payload,e=>{!e||"object"!=typeof e||"Component"!==e["@class"]&&"Modifier"!==e["@class"]&&"CodeComponent"!==e["@class"]||e.projectId||(e.projectId=n)}),e.version=22}if(22===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Element"===e["@class"]&&"RectangleDefinition1"===e.base.definition["@builtin"]&&e.transform&&!e.transform.args.scale&&(e.transform.args.scale={"@class":"Expression",jsCode:"Vec(1.00, 1.00)"})}),e.version=23),23===e.version&&(bS(e.payload,e=>{if(e&&"object"==typeof e){if("Element"===e["@class"]&&"RectangleDefinition1"===e.base.definition["@builtin"]){e.transform&&e.transform.isEnabled||(e.transform={"@class":"Instance",args:{},definition:{"@builtin":"TransformDefinition"},isEnabled:!0});const t=e.transform.args;if(t.origin){const n=Yy(t.origin.jsCode);if(n&&"Vec"===n.type){n.value.subScalar(.5);const i=Fb(n.value);t.origin={"@class":"Expression",jsCode:i},e.base.definition["@builtin"]="RectangleDefinition2"}}else t.origin={"@class":"Expression",jsCode:"Vec(-0.5, -0.5)"},e.base.definition["@builtin"]="RectangleDefinition2"}"Expression"===e["@class"]&&"string"==typeof e.jsCode&&(e.jsCode=e.jsCode.replaceAll("Rectangle()","Rectangle().transform({ position: Vec(0.5, 0.5) })")),"Instance"===e["@class"]&&"FillDefinition"===e.definition["@builtin"]&&(e.args.color||(e.args.color={"@class":"Expression",jsCode:"Color(0.000, 0.000, 0.000, 1.000)"}))}}),e.version=24),24===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Instance"===e["@class"]&&"MirrorRepeatDefinition"===e.definition["@builtin"]&&(e.args.reverse||(e.args.reverse={"@class":"Expression",jsCode:"true"}))}),e.version=25),25===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Instance"===e["@class"]&&("HorizontalGuideDefinition"===e.definition["@builtin"]&&(e.definition["@builtin"]="LineGuideDefinition"),"VerticalGuideDefinition"===e.definition["@builtin"]&&(e.definition["@builtin"]="LineGuideDefinition",e.args.angle={"@class":"Expression",jsCode:"90"}))}),e.version=26),26===e.version&&(bS(e.payload,e=>{if(e&&"object"==typeof e&&"Instance"===e["@class"]&&"RotationalRepeatDefinition"===e.definition["@builtin"]&&e.args.clockwise){const t=Yy(e.args.clockwise.jsCode);t&&"Boolean"===t.type&&!1===t.value&&(e.args.endAngle={"@class":"Expression",jsCode:"-360"}),delete e.args.clockwise}}),e.version=27),27===e.version){if("ElementsAndDependencies"===e.type){const t=new Set,n=new Set;bS(e.payload,e=>{e&&"object"==typeof e&&("Modifier"===e["@class"]?t.add(e["@id"]):"Component"!==e["@class"]&&"CodeComponent"!==e["@class"]||n.add(e["@id"]))}),e.type="PortableProjectData",e.payload.components=e.payload.dependencies.componentsAndModifiers.filter(e=>e.hasOwnProperty("@ref")&&n.has(e["@ref"])),e.payload.modifiers=e.payload.dependencies.componentsAndModifiers.filter(e=>e.hasOwnProperty("@ref")&&t.has(e["@ref"])),e.payload.componentParameters=e.payload.dependencies.componentParameters,e.payload.projectParameters=e.payload.dependencies.projectParameters,delete e.payload.dependencies}e.version=28}if(28===e.version){if("Project"===e.type){const t=e.payload;t.settings={units:t.units,hairlineStrokeWidth:t.hairlineStrokeWidth,tolerance:t.tolerance,"@class":"ProjectSettings"}}e.version=29}29===e.version&&(bS(e.payload,e=>{if(e&&"object"==typeof e&&"PISelect"===e["@class"]&&Array.isArray(e.options))for(let t of e.options){if("string"!=typeof t.value)continue;const e=Yy(t.value);e&&"String"===e.type&&(t.value=e.value)}}),e.version=30),30===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"ImageDefinition"===e["@builtin"]&&(e["@builtin"]="ImageFrameDefinition")}),e.version=31),31===e.version&&(bS(e.payload,e=>{if(e&&"object"==typeof e&&"Instance"===e["@class"]&&"TextWithinBoxDefinition"===e.definition["@builtin"]){let t=!0;if(e.args.preventOverhangs){const n=Yy(e.args.preventOverhangs.jsCode);n&&"Boolean"===n.type&&(t=n.value),delete e.args.preventOverhangs}t&&(e.args.scaling={"@class":"Expression",jsCode:'"shrink"'});let n="middle";if(e.args.verticalAlign){const t=Yy(e.args.verticalAlign.jsCode);t&&"String"===t.type&&(n=t.value)}"baseline"===n&&(e.args.verticalAlign={"@class":"Expression",jsCode:'"top"'})}}),e.version=32),32===e.version&&(bS(e.payload,e=>{e&&"object"==typeof e&&"Project"===e["@class"]&&"object"==typeof e.selection&&(e.selection.items=[])}),e.version=33),33===e.version&&(bS(e.payload,e=>{!e||"object"!=typeof e||"Component"!==e["@class"]&&"CodeComponent"!==e["@class"]||"cricut.svg"===e.defaultExportFormat&&(e.defaultExportFormat="svg")}),e.version=34)})(e,t),(e=>{if(34===e.version){let t;if(yS(e.payload,e=>{void 0===t&&"CodeComponent"===e["@class"]&&e.isImmutable&&"Connected Text"===e.name&&(t=e["@id"])}),void 0!==t){const n=e=>{if(Es(e)){if(e["@ref"]===t)return!0;if(e["@id"]===t)return!0}return!1};yS(e.payload,e=>{if(("Project"===e["@class"]||"PortableProjectData"===e["@class"])&&Ls(e.components)){const t=e.components.findIndex(n);t>=0&&e.components.splice(t,1)}}),yS(e.payload,e=>{"Instance"===e["@class"]&&n(e.definition)&&(Es(e.args)&&void 0===e.args.welding&&Es(e.args.union)&&("false"===e.args.union.jsCode&&(e.args.welding={"@class":"Expression",jsCode:'"Weld nothing"'}),delete e.args.union),e.definition={"@builtin":"ConnectedTextDefinition"})}),Pr()&&yS(e.payload,e=>{n(e)&&Cr("Found a Connected Text!")})}e.version=35}if(35===e.version){let t;if(yS(e.payload,e=>{void 0===t&&"Modifier"===e["@class"]&&e.isImmutable&&"Warped Text"===e.name&&(t=e["@id"])}),void 0!==t){const n=e=>{if(Es(e)){if(e["@ref"]===t)return!0;if(e["@id"]===t)return!0}return!1};yS(e.payload,e=>{if(("Project"===e["@class"]||"PortableProjectData"===e["@class"])&&Ls(e.modifiers)){const t=e.modifiers.findIndex(n);t>=0&&e.modifiers.splice(t,1)}}),yS(e.payload,e=>{"Instance"===e["@class"]&&n(e.definition)&&(e.definition={"@builtin":"WarpedTextDefinition"})}),Pr()&&yS(e.payload,e=>{n(e)&&Cr("Found a Warped Text!")})}e.version=36}if(36===e.version){const t=new Map,n=(e,n,i)=>{let r=t.get(i);void 0===r&&(r=[],t.set(i,r)),r.push({object:e,key:n})},i=["@id","@ref"];yS(e.payload,e=>{if(Es(e))for(const t of i){const i=e[t];ks(i)&&isFinite(+i)&&n(e,t,i)}});for(const[e,r]of t){const e=r.find(e=>"@id"===e.key),t=(null==e?void 0:e.object.id)??nb();for(const n of r)n.object[n.key]=t}e.version=37}if(37===e.version&&(yS(e.payload,e=>{if("Instance"===e["@class"]&&Es(e.definition)&&Es(e.args)){const t=e.definition["@builtin"];"ExpandDefinition1"!==t&&"ContractDefinition1"!==t||void 0===e.args.join&&(e.args.join={"@class":"Expression",jsCode:'"miter"'}),("StrokeDefinition"===t||"OutlineStrokeDefinition"===t)&&("StrokeDefinition"===t&&(!Es(e.args.hairline)||"true"===e.args.hairline.jsCode)||(void 0===e.args.join&&(e.args.join={"@class":"Expression",jsCode:'"miter"'}),void 0===e.args.cap&&(e.args.cap={"@class":"Expression",jsCode:'"butt"'})))}}),e.version=38),38===e.version){const t=[["Modifier","Split Text",7682],["Modifier","Text For Split",3079],["CodeComponent","Text With Emoji",4216]];yS(e.payload,e=>{for(const[n,i,r]of t)e["@class"]===n&&e.name===i&&Es(e.code)&&ks(e.code.jsCode)&&e.code.jsCode.length===r&&(e.code.jsCode=e.code.jsCode.replace(/advanceWidth/g,"advanceX"))}),e.version=39}if(39===e.version&&(yS(e.payload,e=>{if("Instance"===e["@class"]&&Es(e.definition)&&Es(e.args)){const t=e.definition["@builtin"];"TextDefinition"!==t&&"ConnectedTextDefinition"!==t&&"ConnectedTextWithTailsDefinition"!==t||(void 0===e.args.align&&(e.args.align={"@class":"Expression",jsCode:'"left"'}),void 0===e.args.verticalAlign&&(e.args.verticalAlign={"@class":"Expression",jsCode:'"baseline"'}))}}),e.version=40),40===e.version&&(yS(e.payload,e=>{if("Instance"===e["@class"]&&Es(e.definition)&&Es(e.args)&&"TextAlongPathDefinition"===e.definition["@builtin"]){if(Es(e.args.scaleToFit)){const t=e.args.scaleToFit.jsCode;let n;n="true"===t?'"scale"':"false"===t?'"none"':`Boolean(${t}) ? "scale" : "none"`,e.args.fit={"@class":"Expression",jsCode:n},delete e.args.scaleToFit}if(Es(e.args.flip)){const t=e.args.flip.jsCode;let n;n="true"===t?'"all"':"false"===t?'"none"':`Boolean(${t}) ? "all" : "none"`,e.args.flip={"@class":"Expression",jsCode:n}}}}),e.version=41),41===e.version&&(yS(e.payload,e=>{if("Instance"===e["@class"]&&Es(e.definition)&&Es(e.args)&&"WarpedTextDefinition"===e.definition["@builtin"]){if(Es(e.args.align)){const t=e.args.align.jsCode;'"left"'===t?e.args.align={"@class":"Expression",jsCode:'"stretch left"'}:'"center"'===t?e.args.align={"@class":"Expression",jsCode:'"stretch center"'}:'"right"'===t&&(e.args.align={"@class":"Expression",jsCode:'"stretch right"'})}else e.args.align={"@class":"Expression",jsCode:'"stretch center"'};e.args.verticalAlign={"@class":"Expression",jsCode:'"stretch"'},e.args.orientation={"@class":"Expression",jsCode:'"fixed"'},e.args.parameterization={"@class":"Expression",jsCode:'"time"'}}}),e.version=42),42===e.version&&(yS(e.payload,e=>{"Instance"===e["@class"]&&Es(e.definition)&&Es(e.args)&&"TextAlongPathDefinition"===e.definition["@builtin"]&&void 0===e.args.fit&&(e.args.fit={"@class":"Expression",jsCode:'"none"'})}),e.version=43),43===e.version){const t='"https://cuttle-uploads.imgix.net/';yS(e.payload,e=>{if("Expression"===e["@class"]&&ks(e.jsCode)&&e.jsCode.startsWith(t)){const t=Yy(e.jsCode);if(t&&"String"===t.type)try{const n=new URL(t.value).pathname.slice(1);e.jsCode=`"cuttle-image://${n}"`}catch(n){}}}),e.version=44}44===e.version&&(yS(e.payload,e=>{if("Expression"===e["@class"]&&ks(e.jsCode)){const t=Yy(e.jsCode);if(t&&"Font"===t.type){const{renderOptions:n}=t.value;"dots and letters"===n.connect&&n.letterSpacing&&(delete n.letterSpacing,e.jsCode=Wb(t.value))}}}),e.version=45)})(e),e.version!==wS&&Cr(`You might be pasting from a newer version of Cuttle. Refresh this page to upgrade to the latest version and try again. (Unable to upgrade snapshot from version ${e.version} to 45.)`),e},CS=(e,t)=>_C(e,null==t?void 0:t.indirectlyReferenceModelObjects,null==t?void 0:t.bypassReducerCache),SS=(e,t)=>{const n=Boolean(null==t?void 0:t.assignNewIds),i={},r=e=>{if(Xs(e))e.forEach(r);else if(Js(e)){if(e["@ref"]||e["@builtin"])return;const t=e["@id"];if(Ys(t)){const r=e["@class"];if(Ys(r)){const e=new(0,hb[r]);if(e instanceof rb){e.id=n?nb():t}i[t]=e}else i[t]={}}Object.values(e).forEach(r)}};r(e);const s=e=>{if(Xs(e))return e.map(s);if(Js(e)){const t=e["@builtin"];if(Ys(t)){if(!pb.hasOwnProperty(t))throw"Unregistered builtin: "+t;return pb[t]}const n=e["@ref"];if(Ys(n))return i[n];const r=e["@id"];let o={};if(Ys(r))o=i[r];else{const t=e["@class"];if(Ys(t)){o=new(0,hb[t])}}for(let i of Object.keys(e)){if(i.startsWith("@"))continue;const t=e[i];o[i]=s(t)}return o}return e};return s(e)};class kS{constructor(e,t={}){this.encodedMaterialProject=e,this.encodedImmaterialProperties=t}difference(e){if(!Lr(this.encodedMaterialProject,e.encodedMaterialProject))return"material";return!Lr(this.encodedImmaterialProperties,e.encodedImmaterialProperties)?"immaterial":"none"}toJSON(){return{app:"Cuttle",type:"Project",version:wS,payload:this.encodedMaterialProject}}toString(){return JSON.stringify(this.toJSON())}toProject(){const e=SS({...this.encodedMaterialProject,...this.encodedImmaterialProperties});return Ps(e instanceof gS),e.ensureValidFocusedComponent(),e}static fromProject(e,t){const n=null==t?void 0:t.bypassReducerCache,i=CS(e,{bypassReducerCache:n});Ps(Es(i),"Expected the encoded project to be an object.");const r={indirectlyReferenceModelObjects:!0},s={};for(const o of e.immaterialKeys()){const t=e[o];s[o]=CS(t,r)}return new kS(i,s)}static fromJSON(e,t){const n=xS(e,t);if("Project"===(null==n?void 0:n.type)){const e=n.payload;return new kS(e)}}static fromString(e,t){try{const n=JSON.parse(e);return kS.fromJSON(n,t)}catch(n){console.warn(n)}console.warn("Failed to parse Project snapshot",e)}}class LS{constructor(){this.elements=[],this.instances=[],this.components=[],this.modifiers=[],this.componentParameters=[],this.projectParameters=[]}componentWithName(e){var t;return null==(t=this.components)?void 0:t.find(t=>t.name===e)}}ub("PortableProjectData",LS);class ES{constructor(e){this.encoded=e}toString(){return JSON.stringify({app:"Cuttle",type:"PortableProjectData",version:wS,payload:this.encoded})}toPortableProjectData(){const e=SS(this.encoded,{assignNewIds:!0});if(e instanceof LS)return e}static fromPortableProjectData(e){const t=CS(e);return new ES(t)}static fromJSON(e,t){const n=xS(e,t);if("PortableProjectData"!==(null==n?void 0:n.type))throw new Error('Expected "type" to be "PortableProjectData"');const i=n.payload;return new ES(i)}static fromString(e,t){try{let n=JSON.parse(e);if(n=xS(n,t),"PortableProjectData"===(null==n?void 0:n.type)){const e=n.payload;return new ES(e)}}catch(n){console.warn(n)}return console.warn("Failed to parse PortableProjectData snapshot",e),null}static fromSVGString(e,t){const n=/<!--([^-]*)-->/.exec(e);if(n){const e=n[1],i=vr(e);return ES.fromString(i,t)}}}const PS=1/0;class TS{constructor(e){const t=kS.fromProject(e);this.currentState=new AS(t),this.undoStack=[],this.redoStack=[]}checkpoint(e){const t=kS.fromProject(e),n=this.currentState.end.difference(t);if(Pr()){const i=kS.fromProject(e,{bypassReducerCache:!0});Ps(t.encodedMaterialProject!==i.encodedMaterialProject);Ps(n===this.currentState.end.difference(i),"Cached and non-cached snapshots are different!")}return"material"===n?this.commit(t):"immaterial"===n&&this.amend(t),n}amend(e){this.currentState.amend(e)}commit(e){this.redoStack.length,this.redoStack=[],this.undoStack.push(this.currentState),this.currentState=new AS(e),this.undoStack.length>PS&&this.undoStack.shift()}hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}undo(){if(!this.hasUndo())throw"Nothing to undo";return this.redoStack.unshift(this.currentState),this.currentState=this.undoStack.pop(),this.currentState.end.toProject()}redo(){if(!this.hasRedo())throw"Nothing to redo";return this.undoStack.push(this.currentState),this.currentState=this.redoStack.shift(),this.currentState.begin.toProject()}currentSnapshot(){return this.currentState.end}}class AS{constructor(e){this.begin=e,this.end=e}amend(e){this.end=e}}class MS{constructor(e){this.examplesDataByName=e}exampleDataWithName(e){return this.examplesDataByName[e]}}class IS{constructor(){this.entries=new Set,this.lookupEntriesByElement=new WeakMap,this.lookupEntriesByLookedAt=new WeakMap,this.entriesUsed=new Set,this.childEntriesStack=[],this.entriesJustComputed=new Set,this.entriesComputedLastFrame=new Set,rb.subscribe(this.modelObjectSubscriber.bind(this))}evaluateElement(e,t,n,i){e:for(let p of this.entriesByElement(e)){for(let[e,n]of p.argsGets)if(!_S(n,t.peek(e)))continue e;for(let[e,t]of p.globalGets){if(this.globalEnvKeyIsNeverEqual(e))continue e;if(!_S(t,n.peek(e)))continue e}for(let[e]of p.argsGets)t.get(e);for(let[e]of p.globalGets)n.get(e);for(let e of p.lookedAt)rb.triggerEvent("get",e,"SYNTHETIC",void 0);return this.childEntriesStack.length>0&&this.childEntriesStack[this.childEntriesStack.length-1].add(p),this.markEntryWasUsed(p),p.result}const{subscriber:r,gets:s}=OS();t.subscribe(r);const{subscriber:o,gets:a}=OS();n.subscribe(o);const{subscriber:l,gets:c}=NS();rb.subscribe(l);const h=new Set;this.childEntriesStack.push(h);const u=i.evaluateElementInner(e,t,n);t.unsubscribe(r),n.unsubscribe(o),rb.unsubscribe(l),this.childEntriesStack.pop();const d={element:e,argsGets:s,globalGets:a,lookedAt:c,childEntries:h,result:u};return this.addEntry(d),this.childEntriesStack.length>0&&this.childEntriesStack[this.childEntriesStack.length-1].add(d),this.markEntryWasUsed(d),this.entriesJustComputed.add(d),u}markEntryWasUsed(e){this.entriesUsed.add(e);for(let t of e.childEntries)this.markEntryWasUsed(t)}clean(){for(let e of Array.from(this.entries))this.entriesUsed.has(e)||this.deleteEntry(e);this.entriesUsed.clear(),this.entriesComputedLastFrame=this.entriesJustComputed,this.entriesJustComputed=new Set}findEntryForTrace(e){for(let t of this.entriesByElement(e.source))if(t.result===e)return t}entriesByElement(e){let t=this.lookupEntriesByElement.get(e);return t||(t=new Set,this.lookupEntriesByElement.set(e,t)),t}entriesByLookedAt(e){let t=this.lookupEntriesByLookedAt.get(e);return t||(t=new Set,this.lookupEntriesByLookedAt.set(e,t)),t}addEntry(e){this.entries.add(e),this.entriesByElement(e.element).add(e),e.lookedAt.forEach(t=>{this.entriesByLookedAt(t).add(e)})}deleteEntry(e){this.entries.delete(e),this.entriesByElement(e.element).delete(e),e.lookedAt.forEach(t=>{this.entriesByLookedAt(t).delete(e)})}modelObjectSubscriber(e,t,n){if("set"===e){if(t.evaluationIndependentKeys&&t.evaluationIndependentKeys().includes(n))return;for(let e of Array.from(this.entriesByLookedAt(t)))this.deleteEntry(e)}}globalChanged(e){for(let t of Array.from(this.entries))t.globalGets.has(e)&&this.deleteEntry(t)}globalEnvKeyIsNeverEqual(e){return"random"===e||"randomInt"===e||"randomDirection"===e||"randomPointInDisk"===e}}const _S=(e,t)=>e===t||(!!(e instanceof It&&t instanceof It&&e.equals(t))||(!!(e instanceof Ot&&t instanceof Ot&&e.equals(t))||(!!(e instanceof Tr&&t instanceof Tr&&e.equals(t))||(!!(Ls(e)&&Ls(t)&&e.length===t.length&&e.every((e,n)=>_S(e,t[n])))||!!(e&&t&&e._memoizeEqualityId&&e._memoizeEqualityId===t._memoizeEqualityId))))),OS=()=>{const e=new Map,t=new Set;return{subscriber:(n,i,r)=>{"get"===n?e.has(i)||t.has(i)||e.set(i,r):"set"===n&&t.add(i)},gets:e}},NS=()=>{const e=new Set;return{subscriber:(t,n,i,r)=>{"get"===t&&e.add(n)},gets:e}};const DS=new class{constructor(){this.preloaded={}}async preload(e){if(e=kr(e),!this.preloaded[e]&&null!==this.preloaded[e]){this.preloaded[e]=null;try{const t=await Is(e),n=await t.blob();this.preloaded[e]=URL.createObjectURL(n)}catch(t){console.warn(t,"Failed to preload URL.",e)}}}get(e){const t=this.preloaded[e];return t||e}},RS=[{title:"Placing shapes on the canvas",transcript:"Cuttle has a set of built-in shapes\n      that you can see on the left hand side\n      and in order to place them on the canvas, you can click\n      and drag them to your desired location.",prompt:"Try dragging some built-in shapes onto the canvas.",videoUrl:ur+"/getting-started-videos/onboarding1.mp4",captionsUrl:ur+"/getting-started-videos/onboarding1.vtt",videoThumbUrl:ur+"/getting-started-videos/onboarding1_thumb.mp4",snapshotString:'{"app":"Cuttle","type":"Project","version":26,"payload":{"name":"","units":"in","hairlineStrokeWidth":0.01,"tolerance":0.001,"components":[{"name":"My First Component","parameters":[],"isPassThrough":false,"isImmutable":false,"isDefaultUniformScale":true,"id":"15c8451-24a5-49dd-b147-6ef45fc59b39","projectId":"","element":{"name":"","base":{"definition":{"@builtin":"GroupDefinition"},"args":{"@id":"0"},"isEnabled":true,"@class":"Instance","@id":"1"},"transform":null,"modifiers":[],"fill":null,"stroke":null,"children":[],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"2"},"viewport":{"pixelsPerUnit":140,"center":{"x":0,"y":0,"@class":"Vec","@id":"3"},"@class":"Viewport","@id":"4"},"@class":"Component","@id":"5"}],"modifiers":[],"parameters":[],"documentation":{"isImmutable":false,"name":"Read Me","doc":{"type":"doc","content":[{"type":"paragraph","@id":"6"}],"@id":"7"},"@class":"Documentation","@id":"8"},"focus":{"component":{"@ref":"5"},"node":{"parent":null,"source":{"@ref":"2"},"@class":"Node","@id":"9"},"expression":null,"expressionSelections":[],"@class":"ComponentFocus","@id":"10"},"selection":{"items":[],"@class":"Selection","@id":"11"},"expandedNodes":[],"instancesEditingCode":[],"_transformCenter":null,"isTransformBoxEnabled":true,"isGridEnabled":true,"isGridSnappingEnabled":false,"isGeometrySnappingEnabled":true,"@class":"Project","@id":"12"}}'},{title:"Resizing shapes",transcript:"You can change the size of any shape in Cuttle by selecting it\n      then clicking on the dimension\n      and then typing the size that you want.\n      You can also use the handles.\n      The corner handle will resize it proportionally.\n      And if you want to stretch your shape\n      you can use the side handles.",prompt:"Try resizing the shape on the canvas.",videoUrl:ur+"/getting-started-videos/onboarding2.mp4",captionsUrl:ur+"/getting-started-videos/onboarding2.vtt",videoThumbUrl:ur+"/getting-started-videos/onboarding2_thumb.mp4",snapshotString:'{"app":"Cuttle","type":"Project","version":26,"payload":{"name":"","units":"in","hairlineStrokeWidth":0.01,"tolerance":0.001,"components":[{"name":"My First Component","parameters":[],"isPassThrough":false,"isImmutable":false,"isDefaultUniformScale":true,"id":"15c8451-24a5-49dd-b147-6ef45fc59b39","projectId":"","element":{"name":"","base":{"definition":{"@builtin":"GroupDefinition"},"args":{"@id":"0"},"isEnabled":true,"@class":"Instance","@id":"1"},"transform":null,"modifiers":[],"fill":null,"stroke":null,"children":[{"name":"Circle 1","base":{"definition":{"@builtin":"CircleDefinition1"},"args":{"@id":"2"},"isEnabled":true,"@class":"Instance","@id":"3"},"transform":{"definition":{"@builtin":"TransformDefinition"},"args":{"position":{"jsCode":"Vec(0.00, -1.50)","editingJsCode":null,"@class":"Expression","@id":"4"},"@id":"5"},"isEnabled":true,"@class":"Instance","@id":"6"},"modifiers":[],"fill":null,"stroke":{"definition":{"@builtin":"StrokeDefinition"},"args":{"@id":"7"},"isEnabled":true,"@class":"Instance","@id":"8"},"children":[],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"9"}],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"10"},"viewport":{"pixelsPerUnit":140,"center":{"x":0,"y":0,"@class":"Vec","@id":"11"},"@class":"Viewport","@id":"12"},"@class":"Component","@id":"13"}],"modifiers":[],"parameters":[],"documentation":{"isImmutable":false,"name":"Read Me","doc":{"type":"doc","content":[{"type":"paragraph","@id":"14"}],"@id":"15"},"@class":"Documentation","@id":"16"},"focus":{"component":{"@ref":"13"},"node":{"parent":null,"source":{"@ref":"10"},"@class":"Node","@id":"17"},"expression":null,"expressionSelections":[],"@class":"ComponentFocus","@id":"18"},"selection":{"items":[{"node":{"parent":{"@ref":"17"},"source":{"@ref":"9"},"@class":"Node","@id":"19"},"@class":"SelectableNode","@id":"20"}],"@class":"Selection","@id":"21"},"expandedNodes":[],"instancesEditingCode":[],"_transformCenter":null,"isTransformBoxEnabled":true,"isGridEnabled":true,"isGridSnappingEnabled":false,"isGeometrySnappingEnabled":true,"@class":"Project","@id":"22"}}'},{title:"Rotating shapes",transcript:"To rotate any shape select it first\n      then bring your mouse pointer near the corner handle\n      until it turns into a curved arrow,\n      then you can click and drag it to the desired location.",prompt:"Try rotating the shape on the canvas by dragging just outside the corner handle.",videoUrl:ur+"/getting-started-videos/onboarding3.mp4",captionsUrl:ur+"/getting-started-videos/onboarding3.vtt",videoThumbUrl:ur+"/getting-started-videos/onboarding3_thumb.mp4",snapshotString:'{"app":"Cuttle","type":"Project","version":26,"payload":{"name":"","units":"in","hairlineStrokeWidth":0.01,"tolerance":0.001,"components":[{"name":"My First Component","parameters":[],"isPassThrough":false,"isImmutable":false,"isDefaultUniformScale":true,"id":"15c8451-24a5-49dd-b147-6ef45fc59b39","projectId":"","element":{"name":"","base":{"definition":{"@builtin":"GroupDefinition"},"args":{"@id":"0"},"isEnabled":true,"@class":"Instance","@id":"1"},"transform":null,"modifiers":[],"fill":null,"stroke":null,"children":[{"name":"Rectangle 1","base":{"definition":{"@builtin":"RectangleDefinition2"},"args":{"@id":"2"},"isEnabled":true,"@class":"Instance","@id":"3"},"transform":{"definition":{"@builtin":"TransformDefinition"},"args":{"scale":{"jsCode":"Vec(1.00, 1.00)","editingJsCode":null,"@class":"Expression","@id":"4"},"position":{"jsCode":"Vec(0.00, -1.5)","editingJsCode":null,"@class":"Expression","@id":"5"},"@id":"6"},"isEnabled":true,"@class":"Instance","@id":"7"},"modifiers":[],"fill":null,"stroke":{"definition":{"@builtin":"StrokeDefinition"},"args":{"@id":"8"},"isEnabled":true,"@class":"Instance","@id":"9"},"children":[],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"10"}],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"11"},"viewport":{"pixelsPerUnit":149,"center":{"x":0,"y":0,"@class":"Vec","@id":"12"},"@class":"Viewport","@id":"13"},"@class":"Component","@id":"14"}],"modifiers":[],"parameters":[],"documentation":{"isImmutable":false,"name":"Read Me","doc":{"type":"doc","content":[{"type":"paragraph","@id":"15"}],"@id":"16"},"@class":"Documentation","@id":"17"},"focus":{"component":{"@ref":"14"},"node":{"parent":null,"source":{"@ref":"11"},"@class":"Node","@id":"18"},"expression":null,"expressionSelections":[],"@class":"ComponentFocus","@id":"19"},"selection":{"items":[{"node":{"parent":{"@ref":"18"},"source":{"@ref":"10"},"@class":"Node","@id":"20"},"@class":"SelectableNode","@id":"21"}],"@class":"Selection","@id":"22"},"expandedNodes":[],"instancesEditingCode":[],"_transformCenter":null,"isTransformBoxEnabled":true,"isGridEnabled":true,"isGridSnappingEnabled":false,"isGeometrySnappingEnabled":true,"@class":"Project","@id":"23"}}'},{title:"Apply your first modifier",transcript:"You can apply modifiers\n      to create interesting designs in Cuttle.\n      Select your shape then go to the Modify menu\n      and let's try the Rotational Repeat modifier.\n      This one creates evenly spaced copies around a center\n      and then we can change the number of repetitions.",prompt:"From the menu bar, choose Modify > Rotational Repeat. Try changing the number of repetitions in the right side panel.",videoUrl:ur+"/getting-started-videos/onboarding4.mp4",captionsUrl:ur+"/getting-started-videos/onboarding4.vtt",videoThumbUrl:ur+"/getting-started-videos/onboarding4_thumb.mp4",snapshotString:'{"app":"Cuttle","type":"Project","version":26,"payload":{"name":"","units":"in","hairlineStrokeWidth":0.01,"tolerance":0.001,"components":[{"name":"My First Component","parameters":[],"isPassThrough":false,"isImmutable":false,"isDefaultUniformScale":true,"id":"15c8451-24a5-49dd-b147-6ef45fc59b39","projectId":"","element":{"name":"","base":{"definition":{"@builtin":"GroupDefinition"},"args":{"@id":"0"},"isEnabled":true,"@class":"Instance","@id":"1"},"transform":null,"modifiers":[],"fill":null,"stroke":null,"children":[{"name":"Circle 1","base":{"definition":{"@builtin":"CircleDefinition1"},"args":{"@id":"2"},"isEnabled":true,"@class":"Instance","@id":"3"},"transform":{"definition":{"@builtin":"TransformDefinition"},"args":{"position":{"jsCode":"Vec(0.00, -1.75)","editingJsCode":null,"@class":"Expression","@id":"4"},"scale":{"jsCode":"2.0","editingJsCode":null,"@class":"Expression","@id":"5"},"@id":"6"},"isEnabled":true,"@class":"Instance","@id":"7"},"modifiers":[],"fill":null,"stroke":{"definition":{"@builtin":"StrokeDefinition"},"args":{"@id":"8"},"isEnabled":true,"@class":"Instance","@id":"9"},"children":[],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"10"}],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"11"},"viewport":{"pixelsPerUnit":107.87406993471818,"center":{"x":2.220446049250313e-16,"y":0,"@class":"Vec","@id":"12"},"@class":"Viewport","@id":"13"},"@class":"Component","@id":"14"}],"modifiers":[],"parameters":[],"documentation":{"isImmutable":false,"name":"Read Me","doc":{"type":"doc","content":[{"type":"paragraph","@id":"15"}],"@id":"16"},"@class":"Documentation","@id":"17"},"focus":{"component":{"@ref":"14"},"node":{"parent":null,"source":{"@ref":"11"},"@class":"Node","@id":"18"},"expression":null,"expressionSelections":[],"@class":"ComponentFocus","@id":"19"},"selection":{"items":[{"node":{"parent":{"@ref":"18"},"source":{"@ref":"10"},"@class":"Node","@id":"20"},"@class":"SelectableNode","@id":"21"}],"@class":"Selection","@id":"22"},"expandedNodes":[],"instancesEditingCode":[],"_transformCenter":null,"isTransformBoxEnabled":true,"isGridEnabled":true,"isGridSnappingEnabled":false,"isGeometrySnappingEnabled":true,"@class":"Project","@id":"23"}}'},{title:"Making changes to the original shape",transcript:"Even after applying a modifier we can make changes\n      to the original shape.\n      If you click on the design,\n      that shape will be highlighted in blue\n      and we can transform it\n      and those transformations will apply\n      to all of the copies.",prompt:"Select the original shape on the canvas (with the blue outline) and change its size and rotation.",videoUrl:ur+"/getting-started-videos/onboarding5.mp4",captionsUrl:ur+"/getting-started-videos/onboarding5.vtt",videoThumbUrl:ur+"/getting-started-videos/onboarding5_thumb.mp4",snapshotString:'{"app":"Cuttle","type":"Project","version":26,"payload":{"name":"","units":"in","hairlineStrokeWidth":0.01,"tolerance":0.001,"components":[{"name":"My First Component","parameters":[],"isPassThrough":false,"isImmutable":false,"isDefaultUniformScale":true,"id":"15c8451-24a5-49dd-b147-6ef45fc59b39","projectId":"","element":{"name":"","base":{"definition":{"@builtin":"GroupDefinition"},"args":{"@id":"0"},"isEnabled":true,"@class":"Instance","@id":"1"},"transform":null,"modifiers":[],"fill":null,"stroke":null,"children":[{"name":"Circle 1","base":{"definition":{"@builtin":"CircleDefinition1"},"args":{"@id":"2"},"isEnabled":true,"@class":"Instance","@id":"3"},"transform":{"definition":{"@builtin":"TransformDefinition"},"args":{"position":{"jsCode":"Vec(0.00, -1.750)","editingJsCode":null,"@class":"Expression","@id":"4"},"scale":{"jsCode":"2","editingJsCode":null,"@class":"Expression","@id":"5"},"@id":"6"},"isEnabled":true,"@class":"Instance","@id":"7"},"modifiers":[{"definition":{"@builtin":"RotationalRepeatDefinition"},"args":{"repetitions":{"jsCode":"12","editingJsCode":null,"@class":"Expression","@id":"8"},"@id":"9"},"isEnabled":true,"@class":"Instance","@id":"10"}],"fill":null,"stroke":{"definition":{"@builtin":"StrokeDefinition"},"args":{"@id":"11"},"isEnabled":true,"@class":"Instance","@id":"12"},"children":[],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"13"}],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"14"},"viewport":{"pixelsPerUnit":98.6776859504132,"center":{"x":0,"y":0,"@class":"Vec","@id":"15"},"@class":"Viewport","@id":"16"},"@class":"Component","@id":"17"}],"modifiers":[],"parameters":[],"documentation":{"isImmutable":false,"name":"Read Me","doc":{"type":"doc","content":[{"type":"paragraph","@id":"18"}],"@id":"19"},"@class":"Documentation","@id":"20"},"focus":{"component":{"@ref":"17"},"node":{"parent":null,"source":{"@ref":"14"},"@class":"Node","@id":"21"},"expression":null,"expressionSelections":[],"@class":"ComponentFocus","@id":"22"},"selection":{"items":[{"node":{"parent":{"@ref":"21"},"source":{"@ref":"13"},"@class":"Node","@id":"23"},"@class":"SelectableNode","@id":"24"}],"@class":"Selection","@id":"25"},"expandedNodes":[],"instancesEditingCode":[],"_transformCenter":null,"isTransformBoxEnabled":true,"isGridEnabled":true,"isGridSnappingEnabled":false,"isGeometrySnappingEnabled":true,"@class":"Project","@id":"26"}}'},{title:"Adding a second modifier",transcript:"Let's try adding a second modifier\n      to our design.\n      Select the shape, then go to the modify menu.\n      and select Outline Stroke.\n      This one makes the stroke wider\n      and joins the paths so we have a single shape\n      that is ready to be cut.",prompt:"Select the shape on the canvas then do Modify > Outline Stroke.",videoUrl:ur+"/getting-started-videos/onboarding6.mp4",captionsUrl:ur+"/getting-started-videos/onboarding6.vtt",videoThumbUrl:ur+"/getting-started-videos/onboarding6_thumb.mp4",snapshotString:'{"app":"Cuttle","type":"Project","version":26,"payload":{"name":"","units":"in","hairlineStrokeWidth":0.01,"tolerance":0.001,"components":[{"name":"My First Component","parameters":[],"isPassThrough":false,"isImmutable":false,"isDefaultUniformScale":true,"id":"15c8451-24a5-49dd-b147-6ef45fc59b39","projectId":"","element":{"name":"","base":{"definition":{"@builtin":"GroupDefinition"},"args":{"@id":"0"},"isEnabled":true,"@class":"Instance","@id":"1"},"transform":null,"modifiers":[],"fill":null,"stroke":null,"children":[{"name":"Circle 1","base":{"definition":{"@builtin":"CircleDefinition1"},"args":{"@id":"2"},"isEnabled":true,"@class":"Instance","@id":"3"},"transform":{"definition":{"@builtin":"TransformDefinition"},"args":{"position":{"jsCode":"Vec(0.00, -1.50)","editingJsCode":null,"@class":"Expression","@id":"4"},"scale":{"jsCode":"2","editingJsCode":null,"@class":"Expression","@id":"5"},"@id":"6"},"isEnabled":true,"@class":"Instance","@id":"7"},"modifiers":[{"definition":{"@builtin":"RotationalRepeatDefinition"},"args":{"repetitions":{"jsCode":"6","editingJsCode":null,"@class":"Expression","@id":"8"},"@id":"9"},"isEnabled":true,"@class":"Instance","@id":"10"}],"fill":null,"stroke":{"definition":{"@builtin":"StrokeDefinition"},"args":{"@id":"11"},"isEnabled":true,"@class":"Instance","@id":"12"},"children":[],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"13"}],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"14"},"viewport":{"pixelsPerUnit":118.03278319882801,"center":{"x":4.440892098500626e-16,"y":0,"@class":"Vec","@id":"15"},"@class":"Viewport","@id":"16"},"@class":"Component","@id":"17"}],"modifiers":[],"parameters":[],"documentation":{"isImmutable":false,"name":"Read Me","doc":{"type":"doc","content":[{"type":"paragraph","@id":"18"}],"@id":"19"},"@class":"Documentation","@id":"20"},"focus":{"component":{"@ref":"17"},"node":{"parent":null,"source":{"@ref":"14"},"@class":"Node","@id":"21"},"expression":null,"expressionSelections":[],"@class":"ComponentFocus","@id":"22"},"selection":{"items":[{"node":{"parent":{"@ref":"21"},"source":{"@ref":"13"},"@class":"Node","@id":"23"},"@class":"SelectableNode","@id":"24"}],"@class":"Selection","@id":"25"},"expandedNodes":[],"instancesEditingCode":[],"_transformCenter":null,"isTransformBoxEnabled":true,"isGridEnabled":true,"isGridSnappingEnabled":false,"isGeometrySnappingEnabled":true,"@class":"Project","@id":"26"}}'},{title:"Changing modifier parameters",transcript:"All the modifiers we've used\n      will appear on the Outline,\n      And if we need to make individual changes\n      we can select them and change their parameters.\n      In this case I can change the number of repetitions\n      for the Rotational Repeat\n      And if I need to change the thickness of the outline\n      I can click on it and change the width.",prompt:"Try changing the parameters for both the Rotational Repeat and Outline Stroke modifiers.",videoUrl:ur+"/getting-started-videos/onboarding7.mp4",captionsUrl:ur+"/getting-started-videos/onboarding7.vtt",videoThumbUrl:ur+"/getting-started-videos/onboarding7_thumb.mp4",snapshotString:'{"app":"Cuttle","type":"Project","version":26,"payload":{"name":"","units":"in","hairlineStrokeWidth":0.01,"tolerance":0.001,"components":[{"name":"My First Component","parameters":[],"isPassThrough":false,"isImmutable":false,"isDefaultUniformScale":true,"id":"15c8451-24a5-49dd-b147-6ef45fc59b39","projectId":"","element":{"name":"","base":{"definition":{"@builtin":"GroupDefinition"},"args":{"@id":"0"},"isEnabled":true,"@class":"Instance","@id":"1"},"transform":null,"modifiers":[],"fill":null,"stroke":null,"children":[{"name":"Circle 1","base":{"definition":{"@builtin":"CircleDefinition1"},"args":{"@id":"2"},"isEnabled":true,"@class":"Instance","@id":"3"},"transform":{"definition":{"@builtin":"TransformDefinition"},"args":{"position":{"jsCode":"Vec(0.00, -1.50)","editingJsCode":null,"@class":"Expression","@id":"4"},"scale":{"jsCode":"2","editingJsCode":null,"@class":"Expression","@id":"5"},"@id":"6"},"isEnabled":true,"@class":"Instance","@id":"7"},"modifiers":[{"definition":{"@builtin":"RotationalRepeatDefinition"},"args":{"repetitions":{"jsCode":"6","editingJsCode":null,"@class":"Expression","@id":"8"},"@id":"9"},"isEnabled":true,"@class":"Instance","@id":"10"},{"definition":{"@builtin":"OutlineStrokeDefinition"},"args":{"width":{"jsCode":"0.20","editingJsCode":null,"@class":"Expression","@id":"11"},"@id":"12"},"isEnabled":true,"@class":"Instance","@id":"13"}],"fill":null,"stroke":{"definition":{"@builtin":"StrokeDefinition"},"args":{"@id":"14"},"isEnabled":true,"@class":"Instance","@id":"15"},"children":[],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"16"}],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"17"},"viewport":{"pixelsPerUnit":118.03278319882801,"center":{"x":4.440892098500626e-16,"y":0,"@class":"Vec","@id":"18"},"@class":"Viewport","@id":"19"},"@class":"Component","@id":"20"}],"modifiers":[],"parameters":[],"documentation":{"isImmutable":false,"name":"Read Me","doc":{"type":"doc","content":[{"type":"paragraph","@id":"21"}],"@id":"22"},"@class":"Documentation","@id":"23"},"focus":{"component":{"@ref":"20"},"node":{"parent":null,"source":{"@ref":"17"},"@class":"Node","@id":"24"},"expression":null,"expressionSelections":[],"@class":"ComponentFocus","@id":"25"},"selection":{"items":[{"node":{"parent":{"@ref":"24"},"source":{"@ref":"16"},"@class":"Node","@id":"26"},"instance":{"@ref":"10"},"@class":"SelectableInstance","@id":"27"}],"@class":"Selection","@id":"28"},"expandedNodes":[],"instancesEditingCode":[],"_transformCenter":null,"isTransformBoxEnabled":true,"isGridEnabled":true,"isGridSnappingEnabled":false,"isGeometrySnappingEnabled":true,"@class":"Project","@id":"29"}}'},{title:"Exploring the possibilities",transcript:"At this point we are free to explore\n      the possibilities of the design we've created.\n      We can change the parameters on the modifiers,\n      like the number of repetitions on the Rotational Repeat,\n      or the thickness of the outline.\n      And we can make transformations\n      to the original shape.\n      We can scale it,\n      or rotate it,\n      or change its location.\n      And we have the flexibility to go back and forth\n      between these, until we find something\n      that we like.\n      And when you are ready to cut your design\n      you can go to File and then\n      Export SVG to download it.",prompt:"Change the look of the design and export an SVG file when you find something you like.",videoUrl:ur+"/getting-started-videos/onboarding8.mp4",captionsUrl:ur+"/getting-started-videos/onboarding8.vtt",videoThumbUrl:ur+"/getting-started-videos/onboarding8_thumb.mp4",snapshotString:'{"app":"Cuttle","type":"Project","version":26,"payload":{"name":"","units":"in","hairlineStrokeWidth":0.01,"tolerance":0.001,"components":[{"name":"My First Component","parameters":[],"isPassThrough":false,"isImmutable":false,"isDefaultUniformScale":true,"id":"15c8451-24a5-49dd-b147-6ef45fc59b39","projectId":"","element":{"name":"","base":{"definition":{"@builtin":"GroupDefinition"},"args":{"@id":"0"},"isEnabled":true,"@class":"Instance","@id":"1"},"transform":null,"modifiers":[],"fill":null,"stroke":null,"children":[{"name":"Circle 1","base":{"definition":{"@builtin":"CircleDefinition1"},"args":{"@id":"2"},"isEnabled":true,"@class":"Instance","@id":"3"},"transform":{"definition":{"@builtin":"TransformDefinition"},"args":{"position":{"jsCode":"Vec(0.00, -1.50)","editingJsCode":null,"@class":"Expression","@id":"4"},"scale":{"jsCode":"2","editingJsCode":null,"@class":"Expression","@id":"5"},"@id":"6"},"isEnabled":true,"@class":"Instance","@id":"7"},"modifiers":[{"definition":{"@builtin":"RotationalRepeatDefinition"},"args":{"repetitions":{"jsCode":"6","editingJsCode":null,"@class":"Expression","@id":"8"},"@id":"9"},"isEnabled":true,"@class":"Instance","@id":"10"},{"definition":{"@builtin":"OutlineStrokeDefinition"},"args":{"width":{"jsCode":"0.20","editingJsCode":null,"@class":"Expression","@id":"11"},"@id":"12"},"isEnabled":true,"@class":"Instance","@id":"13"}],"fill":null,"stroke":{"definition":{"@builtin":"StrokeDefinition"},"args":{"@id":"14"},"isEnabled":true,"@class":"Instance","@id":"15"},"children":[],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"16"}],"isLocked":false,"isVisible":true,"guidesDisplay":"show","@class":"Element","@id":"17"},"viewport":{"pixelsPerUnit":118.03278319882801,"center":{"x":4.440892098500626e-16,"y":0,"@class":"Vec","@id":"18"},"@class":"Viewport","@id":"19"},"@class":"Component","@id":"20"}],"modifiers":[],"parameters":[],"documentation":{"isImmutable":false,"name":"Read Me","doc":{"type":"doc","content":[{"type":"paragraph","@id":"21"}],"@id":"22"},"@class":"Documentation","@id":"23"},"focus":{"component":{"@ref":"20"},"node":{"parent":null,"source":{"@ref":"17"},"@class":"Node","@id":"24"},"expression":null,"expressionSelections":[],"@class":"ComponentFocus","@id":"25"},"selection":{"items":[{"node":{"parent":{"@ref":"24"},"source":{"@ref":"16"},"@class":"Node","@id":"26"},"instance":{"@ref":"10"},"@class":"SelectableInstance","@id":"27"}],"@class":"Selection","@id":"28"},"expandedNodes":[],"instancesEditingCode":[],"_transformCenter":null,"isTransformBoxEnabled":true,"isGridEnabled":true,"isGridSnappingEnabled":false,"isGeometrySnappingEnabled":true,"@class":"Project","@id":"29"}}'}];class FS{constructor(){this.steps=RS,this.stepIndex=0,this.mode="watch"}currentStep(){return this.steps[this.stepIndex]}isFirstStep(){return 0===this.stepIndex}isLastStep(){return this.stepIndex===this.steps.length-1}goto(e,t){if(this.stepIndex=e,this.mode=t,"watch"===t){const e=this.currentStep().snapshotString,t=kS.fromString(e);if(!t)throw new Error("Getting started project state did not load");Oj.project=t.toProject()}if("watch"===t&&DS.preload(this.currentStep().videoThumbUrl),"try"===t&&!this.isLastStep()){const e=this.steps[this.stepIndex+1];DS.preload(e.videoUrl),DS.preload(e.captionsUrl)}}}const BS=window.cuttleConfig={showMemoizationInOutline:!1,freezeTraces:!1,checkMemoizationResults:!1},VS=e=>e?Array.isArray(e)?new xi(e.flat(1/0)):e:new xi,jS=e=>{if(e instanceof xi){const{items:t}=e;if(0===t.length)return;const n=[];for(let e of t){const t=jS(e);t&&n.push(t)}if(0===n.length)return;if(1===n.length)return n[0];e.items=n}else if(e instanceof wi){const{paths:t}=e;if(0===t.length)return;if(1===t.length)return t[0].copyStyle(e)}return e},HS=EC("allMessages",e=>{const t=[];if(e instanceof Sb)t.push(...e.messages);else for(const n of e.childTraces()){const e=HS(n);t.push(...e)}return t}),US=EC("uniqueMessages",e=>{const t=[],n={};return HS(e).forEach(e=>{const i=e.toString();let r=n[e.logLevel];r||(r=new Set,n[e.logLevel]=r),r.has(i)||(r.add(i),t.push(e))}),t}),zS=EC("loggedGeometry",e=>{const t=e instanceof xb;if(t&&"hide"===e.source.guidesDisplay)return[];const n=[];if(e instanceof Sb){const t=(e,t)=>{Dn.isValid(e)||It.isValid(e)?n.push(new kb(e,t)):De.isValid(e)&&n.push(new kb(Ri.fromBoundingBox(e),t))};for(const{message:n,logLevel:i}of e.messages)if("geometry"===i||"guide"===i)if(Array.isArray(n))for(let e of n)t(e,i);else t(n,i)}for(const i of e.childTraces()){t&&i instanceof xb&&"show-all-as-guides"===i.source.guidesDisplay&&i.result&&n.push(new kb(i.result,"guide",[e.source,i.source]));let r=zS(i);t&&(r=r.map(t=>{const n=t.clone();return e.source.base.definition instanceof vb&&n.sourcePath.shift(),n.addParentElement(e.source),n})),n.push(...r)}return n}),WS=(e,t)=>{const n=new af(df);for(let i of e.components)GS(i,n,t);for(let i of e.modifiers)ZS(i,n,t);{const t=(t,n)=>Rl(t,n,e.settings.units);t._memoizeEqualityId="to-project-units/"+e.settings.units,n.set("toProjectUnits",t)}{const t={project:{get units(){return e.settings.units}}};t._memoizeEqualityId="cuttle-context/"+e.settings.units,n.set("cuttle",t)}for(let i of lC)if((i instanceof vb||i instanceof yb)&&GS(i,n,t),i instanceof Nb){["Anchor","Path","Compound Path","Group","Fill","Stroke"].includes(i.name)||ZS(i,n,t)}{const e={log:(...e)=>Ft.console("log",...e),info:(...e)=>Ft.console("info",...e),warn:(...e)=>Ft.console("warn",...e),error:(...e)=>Ft.console("error",...e),geometry:(...e)=>Ft.console("geometry",...e),guide:(...e)=>Ft.console("guide",...e),_memoizeEqualityId:"cuttle-console"};n.set("console",e)}return n},GS=(e,t,n)=>{const i=gf(e.name),r={[i]:(i={})=>{const r=n.evaluateComponentFunction(e,i,t);return $S(r,["warn","warn-global","error"]),Lb(r)}},s=qS.create(r[i]);s._memoizeEqualityId="first-class-definition/"+e.id,t.set(i,s)},$S=(e,t)=>{for(const n of HS(e))t.includes(n.logLevel)&&Ft.consoleMessage(n)},ZS=(e,t,n)=>{const i=gf(e.name),r={[i]:(i={},r)=>{r=VS(r);const s=n.evaluateModifierFunction(e,i,r,t);return $S(s,["warn","warn-global","error"]),Lb(s)}},s=KS.create(r[i]);s._memoizeEqualityId="first-class-definition/"+e.id,t.set(i,s)};class qS extends Function{withDefaults(e){const t={[this.name]:(t={})=>this({...e,...t})};return qS.create(t[this.name])}static create(e){return Object.setPrototypeOf(e,qS.prototype),e}}class KS extends Function{withDefaults(e){const t={[this.name]:(t={},n)=>this({...e,...t},n)};return KS.create(t[this.name])}static create(e){return Object.setPrototypeOf(e,KS.prototype),e}}class YS{constructor(e){this.evaluateElementMemoizer=e}evaluateProject(e){var t;const n=WS(e,this),i=new wx(e),r=this.evaluateInstance(i,new af,n,n),s=oC.concat(e.components).map(e=>{bt(e.id);const t=new wx(e),i=new af(n),r=this.evaluateInstance(t,new af,i,n);if(BS.checkMemoizationResults){const t=this.evaluateElementMemoizer;this.evaluateElementMemoizer=void 0,bt(e.id);const i=new wx(e),s=new af(n),o=this.evaluateInstance(i,new af,s,n);this.evaluateElementMemoizer=t,Ps(JSON.stringify(r.result)===JSON.stringify(o.result),"Memoized result not equal to non-memoized result")}return r});return null==(t=this.evaluateElementMemoizer)||t.clean(),new wb(r,s)}evaluateElement(e,t,n){return this.evaluateElementMemoizer?this.evaluateElementMemoizer.evaluateElement(e,t,n,this):this.evaluateElementInner(e,t,n)}evaluateElementInner(e,t,n){const i=e.modifiers.length-1,r=this.evaluateElementUpToModifierIndex(e,t,n,i);return BS.freezeTraces&&XS(r.result),r}evaluateElementUpToModifierIndex(e,t,n,i){if(i<0)return this.evaluateElementBaseTransformStyle(e,t,n);const r=e.modifiers[i];if(r.isEnabled&&r.isRepeatModifier())return this.evaluateElementUpToRepeatModifierAtIndex(e,t,n,i);const s=this.evaluateElementUpToModifierIndex(e,t,n,i-1);if(!s._isSuccess)return s;if(r.isEnabled){const e=s.result;Ps(e instanceof Hn);const i=new af(n);i.set("input",e);const o=this.evaluateInstance(r,t,i,n);s.modifiers.push(o),s.result=o.result,s._isSuccess=o._isSuccess}return s}evaluateElementUpToRepeatModifierAtIndex(e,t,n,i){const r=e.modifiers[i],s=new Cb(r),o=new af(n),a=r.repeatIndexVariableName,l=()=>{let r=t;a&&(r=new af(t),r.set(a,0));const o=this.evaluateElementUpToModifierIndex(e,r,n,i-1);return o.modifiers.push(s),o.result=new xi,o};let c=this.evaluateInstanceParameters(s,r,t,o);if(!c)return s._isSuccess=c,l();const h=s.resultForArgName("repetitions");if(!JS(h))return l();const u=Math.trunc(h);if(u<1)return s._isSuccess=c,l();const d=new Array(u);let p,f;if(a){const r=new Array(u);for(let s=0;s<u;s++){const o=new af(t);o.set(a,s);const l=this.evaluateElementUpToModifierIndex(e,o,n,i-1);if(!l._isSuccess){p=l;break}r[s]=l,Ps(l.result instanceof Hn),d[s]=l.result}f=p??r[0]}else{const r=this.evaluateElementUpToModifierIndex(e,t,n,i-1);if(r._isSuccess){f=r,Ps(r.result instanceof Hn),d[0]=r.result;for(let e=1;e<u;++e)d[e]=d[0].clone()}else p=r,f=r}return void 0===p&&(o.set("inputs",d),this.evaluateInstanceResult(s,r,o,n)),f.modifiers.push(s),f.result=s.result,f._isSuccess=s._isSuccess,f}evaluateElementBaseTransformStyle(e,t,n){var i,r,s;const o=new xb(e),a=new af(n);{const{base:i}=e;if(i.definition instanceof Nb){const i=[];for(let r of e.children){const e=this.evaluateElement(r,t,n);o.children.push(e),e.isSuccess()&&r.isVisible&&"show-all-as-guides"!==r.guidesDisplay&&i.push(e.result)}a.set("input",new xi(i))}if(o.base=this.evaluateInstance(e.base,t,a,n),!o.base.isSuccess())return o}let l=o.base.result;if(null==(i=e.transform)?void 0:i.isEnabled){const i=new af(n);if(i.set("input",l),o.transform=this.evaluateInstance(e.transform,t,i,n),!o.transform.isSuccess())return o;l=o.transform.result}if(null==(r=e.fill)?void 0:r.isEnabled){const i=new af(n);if(i.set("input",l),o.fill=this.evaluateInstance(e.fill,t,i,n),!o.fill.isSuccess())return o;l=o.fill.result}if(null==(s=e.stroke)?void 0:s.isEnabled){const i=new af(n);if(i.set("input",l),o.stroke=this.evaluateInstance(e.stroke,t,i,n),!o.stroke.isSuccess())return o;l=o.stroke.result}return o.result=l,o._isSuccess=!0,o}evaluateInstance(e,t,n,i){const r=new Cb(e);let s=this.evaluateInstanceParameters(r,e,t,n);return s&&(s=this.evaluateInstanceResult(r,e,n,i)),r}evaluateComponentFunction(e,t,n){const i=new wx(e);for(let o in t)i.args[o]=new Ob(t[o]);const r=new af,s=new af(n);return this.evaluateInstance(i,r,s,n)}evaluateModifierFunction(e,t,n,i){const r=new wx(e);for(let c in t)r.args[c]=new Ob(t[c]);const s=new af,o=new af(i),a=new Cb(r);let l=this.evaluateInstanceParameters(a,r,s,o);if(!l)return a;if(e.isRepeat){const e=a.resultForArgName("repetitions");if(!JS(e))return a;if(e<1)return a.result=new xi,a._isSuccess=l,a;o.set("inputs",new Array(e).fill(n))}else o.set("input",n);return l=this.evaluateInstanceResult(a,r,o,i),a}evaluateInstanceParameters(e,t,n,i){const{parameters:r,circularPaths:s}=t.parametersInEvaluationOrder();let o=!0;for(let a of r){let r;if(r=t.hasArgumentWithName(a.name)?t.args[a.name].evaluate(n):a.expression.evaluate(i),s.length>0){const e=s.filter(e=>e[e.length-1]===a.name);if(e.length>0){const t=e.map(e=>new Rt(`Circular reference found (${e.join("  ")})\n  One of the parameters referenced in this expression also references this parameter!`,"error",-2));r=r.traceByAppendingMessages(t)}}r.isSuccess&&a.interface instanceof $b&&(a.isDeprecated&&void 0===r.evaluationResult||a.interface.isValidValue(r.evaluationResult)||(r=r.traceByAppendingMessages([new Rt(a.interface.invalidValueMessage(),"warn",-1)]))),e.args[a.name]=r;const l=a.sanitizedName();i.set(l,r.evaluationResult),o&&(o=r.isSuccess)}return o}evaluateInstanceResult(e,t,n,i){const{definition:r}=t;if(r instanceof Nb||r instanceof yb){if(e.code=r.code.evaluate(n),!e.code.isSuccess)return!1;const{evaluationResult:t}=e.code;if(t instanceof Ne){if(!t.isValid())return!1;const i=n.get("input");if(!Hn.isValid(i))return!1;e.result=i.clone().affineTransform(t)}else{const n=VS(t);if(!Hn.isValid(n))return!1;e.result=n}}else if(r instanceof vb){if(e.element=this.evaluateElement(r.element,n,i),!e.element._isSuccess)return!1;e.result=e.element.result}return e._isSuccess=!0,BS.freezeTraces&&XS(e.result),!0}evaluateElementsWithinFocusedComponent(e,t){const n=e.focusedComponent();Ps(n,"Should only be used when a component is focused");const i=WS(e,this),r=new wx(e);this.evaluateInstance(r,new af,i,i);const s=new wx(n),o=new af(i);return this.evaluateInstance(s,new af,o,i),t.map(e=>this.evaluateElement(e,o,i))}}const XS=e=>{if(e&&"object"==typeof e){if(Object.isFrozen(e))return;Object.freeze(e);for(let t of Object.getOwnPropertyNames(e))XS(e[t])}},JS=e=>Ks(e)&&isFinite(e),QS=1e-6,ek=1e6,tk=class e{constructor(){this.pixelsPerUnit=e.defaultPixelsPerUnit,this.center=new It(0)}viewMatrixWithCanvasDimensions(e){const t=e.usableArea.center(),n=this.center.clone().mulScalar(this.pixelsPerUnit);return Ne.fromTransform({position:t.clone().sub(n),scale:this.pixelsPerUnit})}viewMatrixWithBounds(e){return Ne.fromTransform({position:e.center().sub(this.center.clone().mulScalar(this.pixelsPerUnit)),scale:this.pixelsPerUnit})}clone(){const t=new e;return t.pixelsPerUnit=this.pixelsPerUnit,t.center=this.center.clone(),t}scale(t,n){const i=this.pixelsPerUnit/e.defaultPixelsPerUnit;let r;if(n){if(t<1){const e=1/t;r=Math.pow(e,Math.floor(Math.log(i)/Math.log(e)))}else r=Math.pow(t,Math.ceil(Math.log(i)/Math.log(t)));fs(i,r)&&(r=Math.pow(t,Math.round(Math.log(i*t)/Math.log(t))))}else r=t*i;const s=r*e.defaultPixelsPerUnit;this.pixelsPerUnit=Ct(s,QS,ek)}scaleFromCenter(e,t,n){const i=this.pixelsPerUnit;this.scale(e,n);const r=i/this.pixelsPerUnit;this.center.sub(t).mulScalar(r).add(t)}scaleToFitBoundingBox(t,n){if(!t.isFinite())return;this.center=t.center();const i=t.size().mulScalar(1.1);if(i.isZero())this.pixelsPerUnit=e.defaultPixelsPerUnit;else{const e=n.usableArea.size(),t=Math.min(e.x/i.x,e.y/i.y);this.pixelsPerUnit=Ct(t,QS,ek)}}worldBoundingBox(e){const t=this.viewMatrixWithCanvasDimensions(e).invert();return new De(new It(0,0).affineTransform(t),e.size.clone().affineTransform(t))}precisionInfo(){const e=1/this.pixelsPerUnit,t=Math.round(Math.log10(e)),n=Math.pow(10,t);return{exponent:t,fractionDigits:Math.max(0,-Math.floor(Math.log10(n))),increment:n}}};tk.defaultPixelsPerUnit=110;let nk=tk;ub("Viewport",nk);class ik{constructor(e=new It,t){this.size=e,this.usableArea=t??new De(new It(0,0),e)}}var rk,sk={};function ok(){return rk||(rk=1,function(e){var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var r in i)n(i,r)&&(e[r]=i[r])}}return e},e.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var s=0;s<i;s++)e[r+s]=t[n+s]},flattenChunks:function(e){var t,n,i,r,s,o;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(o=new Uint8Array(i),r=0,t=0,n=e.length;t<n;t++)s=e[t],o.set(s,r),r+=s.length;return o}},r={arraySet:function(e,t,n,i,r){for(var s=0;s<i;s++)e[r+s]=t[n+s]},flattenChunks:function(e){return[].concat.apply([],e)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,i)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,r))},e.setTyped(t)}(sk)),sk}var ak,lk,ck,hk,uk,dk,pk,fk,mk={},gk={},vk={};function yk(){if(ak)return vk;ak=1;var e=ok();function t(e){for(var t=e.length;--t>=0;)e[t]=0}var n=256,i=286,r=30,s=15,o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],a=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],c=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],h=new Array(576);t(h);var u=new Array(60);t(u);var d=new Array(512);t(d);var p=new Array(256);t(p);var f=new Array(29);t(f);var m,g,v,y=new Array(r);function b(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function w(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function x(e){return e<256?d[e]:d[256+(e>>>7)]}function C(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function S(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,C(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function k(e,t,n){S(e,n[2*t],n[2*t+1])}function L(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function E(e,t,n){var i,r,o=new Array(16),a=0;for(i=1;i<=s;i++)o[i]=a=a+n[i-1]<<1;for(r=0;r<=t;r++){var l=e[2*r+1];0!==l&&(e[2*r]=L(o[l]++,l))}}function P(e){var t;for(t=0;t<i;t++)e.dyn_ltree[2*t]=0;for(t=0;t<r;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function T(e){e.bi_valid>8?C(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function A(e,t,n,i){var r=2*t,s=2*n;return e[r]<e[s]||e[r]===e[s]&&i[t]<=i[n]}function M(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&A(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!A(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function I(e,t,i){var r,s,l,c,h=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*h]<<8|e.pending_buf[e.d_buf+2*h+1],s=e.pending_buf[e.l_buf+h],h++,0===r?k(e,s,t):(k(e,(l=p[s])+n+1,t),0!==(c=o[l])&&S(e,s-=f[l],c),k(e,l=x(--r),i),0!==(c=a[l])&&S(e,r-=y[l],c))}while(h<e.last_lit);k(e,256,t)}function _(e,t){var n,i,r,o=t.dyn_tree,a=t.stat_desc.static_tree,l=t.stat_desc.has_stree,c=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<c;n++)0!==o[2*n]?(e.heap[++e.heap_len]=h=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(r=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[r]=0,e.opt_len--,l&&(e.static_len-=a[2*r+1]);for(t.max_code=h,n=e.heap_len>>1;n>=1;n--)M(e,o,n);r=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],M(e,o,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,o[2*r]=o[2*n]+o[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,o[2*n+1]=o[2*i+1]=r,e.heap[1]=r++,M(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,o,a,l,c=t.dyn_tree,h=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(o=0;o<=s;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(o=c[2*c[2*(i=e.heap[n])+1]+1]+1)>m&&(o=m,g++),c[2*i+1]=o,i>h||(e.bl_count[o]++,a=0,i>=f&&(a=p[i-f]),l=c[2*i],e.opt_len+=l*(o+a),d&&(e.static_len+=l*(u[2*i+1]+a)));if(0!==g){do{for(o=m-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[m]--,g-=2}while(g>0);for(o=m;0!==o;o--)for(i=e.bl_count[o];0!==i;)(r=e.heap[--n])>h||(c[2*r+1]!==o&&(e.opt_len+=(o-c[2*r+1])*c[2*r],c[2*r+1]=o),i--)}}(e,t),E(o,h,e.bl_count)}function O(e,t,n){var i,r,s=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=t[2*(i+1)+1],++a<l&&r===o||(a<c?e.bl_tree[2*r]+=a:0!==r?(r!==s&&e.bl_tree[2*r]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,s=r,0===o?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))}function N(e,t,n){var i,r,s=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),i=0;i<=n;i++)if(r=o,o=t[2*(i+1)+1],!(++a<l&&r===o)){if(a<c)do{k(e,r,e.bl_tree)}while(0!==--a);else 0!==r?(r!==s&&(k(e,r,e.bl_tree),a--),k(e,16,e.bl_tree),S(e,a-3,2)):a<=10?(k(e,17,e.bl_tree),S(e,a-3,3)):(k(e,18,e.bl_tree),S(e,a-11,7));a=0,s=r,0===o?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4)}}t(y);var D=!1;function R(t,n,i,r){S(t,0+(r?1:0),3),function(t,n,i){T(t),C(t,i),C(t,~i),e.arraySet(t.pending_buf,t.window,n,i,t.pending),t.pending+=i}(t,n,i)}return vk._tr_init=function(e){D||(!function(){var e,t,n,c,w,x=new Array(16);for(n=0,c=0;c<28;c++)for(f[c]=n,e=0;e<1<<o[c];e++)p[n++]=c;for(p[n-1]=c,w=0,c=0;c<16;c++)for(y[c]=w,e=0;e<1<<a[c];e++)d[w++]=c;for(w>>=7;c<r;c++)for(y[c]=w<<7,e=0;e<1<<a[c]-7;e++)d[256+w++]=c;for(t=0;t<=s;t++)x[t]=0;for(e=0;e<=143;)h[2*e+1]=8,e++,x[8]++;for(;e<=255;)h[2*e+1]=9,e++,x[9]++;for(;e<=279;)h[2*e+1]=7,e++,x[7]++;for(;e<=287;)h[2*e+1]=8,e++,x[8]++;for(E(h,287,x),e=0;e<r;e++)u[2*e+1]=5,u[2*e]=L(e,5);m=new b(h,o,257,i,s),g=new b(u,a,0,r,s),v=new b(new Array(0),l,0,19,7)}(),D=!0),e.l_desc=new w(e.dyn_ltree,m),e.d_desc=new w(e.dyn_dtree,g),e.bl_desc=new w(e.bl_tree,v),e.bi_buf=0,e.bi_valid=0,P(e)},vk._tr_stored_block=R,vk._tr_flush_block=function(e,t,i,r){var s,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<n;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),_(e,e.l_desc),_(e,e.d_desc),a=function(e){var t;for(O(e,e.dyn_ltree,e.l_desc.max_code),O(e,e.dyn_dtree,e.d_desc.max_code),_(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*c[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),s=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=s&&(s=o)):s=o=i+5,i+4<=s&&-1!==t?R(e,t,i,r):4===e.strategy||o===s?(S(e,2+(r?1:0),3),I(e,h,u)):(S(e,4+(r?1:0),3),function(e,t,n,i){var r;for(S(e,t-257,5),S(e,n-1,5),S(e,i-4,4),r=0;r<i;r++)S(e,e.bl_tree[2*c[r]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),I(e,e.dyn_ltree,e.dyn_dtree)),P(e),r&&T(e)},vk._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(p[i]+n+1)]++,e.dyn_dtree[2*x(t)]++),e.last_lit===e.lit_bufsize-1},vk._tr_align=function(e){S(e,2,3),k(e,256,h),function(e){16===e.bi_valid?(C(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)},vk}function bk(){if(ck)return lk;return ck=1,lk=function(e,t,n,i){for(var r=65535&e,s=e>>>16&65535,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{s=s+(r=r+t[i++]|0)|0}while(--o);r%=65521,s%=65521}return r|s<<16}}function wk(){if(uk)return hk;uk=1;var e=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();return hk=function(t,n,i,r){var s=e,o=r+i;t^=-1;for(var a=r;a<o;a++)t=t>>>8^s[255&(t^n[a])];return-1^t},hk}function xk(){return pk?dk:(pk=1,dk={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"})}function Ck(){if(fk)return gk;fk=1;var e,t=ok(),n=yk(),i=bk(),r=wk(),s=xk(),o=-2,a=258,l=262,c=103,h=113,u=666;function d(e,t){return e.msg=s[t],t}function p(e){return(e<<1)-(e>4?9:0)}function f(e){for(var t=e.length;--t>=0;)e[t]=0}function m(e){var n=e.state,i=n.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(t.arraySet(e.output,n.pending_buf,n.pending_out,i,e.next_out),e.next_out+=i,n.pending_out+=i,e.total_out+=i,e.avail_out-=i,n.pending-=i,0===n.pending&&(n.pending_out=0))}function g(e,t){n._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,m(e.strm)}function v(e,t){e.pending_buf[e.pending++]=t}function y(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function b(e,n,s,o){var a=e.avail_in;return a>o&&(a=o),0===a?0:(e.avail_in-=a,t.arraySet(n,e.input,e.next_in,a,s),1===e.state.wrap?e.adler=i(e.adler,n,a,s):2===e.state.wrap&&(e.adler=r(e.adler,n,a,s)),e.next_in+=a,e.total_in+=a,a)}function w(e,t){var n,i,r=e.max_chain_length,s=e.strstart,o=e.prev_length,c=e.nice_match,h=e.strstart>e.w_size-l?e.strstart-(e.w_size-l):0,u=e.window,d=e.w_mask,p=e.prev,f=e.strstart+a,m=u[s+o-1],g=u[s+o];e.prev_length>=e.good_match&&(r>>=2),c>e.lookahead&&(c=e.lookahead);do{if(u[(n=t)+o]===g&&u[n+o-1]===m&&u[n]===u[s]&&u[++n]===u[s+1]){s+=2,n++;do{}while(u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&s<f);if(i=a-(f-s),s=f-a,i>o){if(e.match_start=t,o=i,i>=c)break;m=u[s+o-1],g=u[s+o]}}}while((t=p[t&d])>h&&0!==--r);return o<=e.lookahead?o:e.lookahead}function x(e){var n,i,r,s,o,a=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-l)){t.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,n=i=e.hash_size;do{r=e.head[--n],e.head[n]=r>=a?r-a:0}while(--i);n=i=a;do{r=e.prev[--n],e.prev[n]=r>=a?r-a:0}while(--i);s+=a}if(0===e.strm.avail_in)break;if(i=b(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=i,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+3-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<l&&0!==e.strm.avail_in)}function C(e,t){for(var i,r;;){if(e.lookahead<l){if(x(e),e.lookahead<l&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-l&&(e.match_length=w(e,i)),e.match_length>=3)if(r=n._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function S(e,t){for(var i,r,s;;){if(e.lookahead<l){if(x(e),e.lookahead<l&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-l&&(e.match_length=w(e,i),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,r=n._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(g(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=n._tr_tally(e,0,e.window[e.strstart-1]))&&g(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=n._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function k(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function L(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new t.Buf16(1146),this.dyn_dtree=new t.Buf16(122),this.bl_tree=new t.Buf16(78),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new t.Buf16(16),this.heap=new t.Buf16(573),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new t.Buf16(573),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function E(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:h,e.adler=2===t.wrap?0:1,t.last_flush=0,n._tr_init(t),0):d(e,o)}function P(t){var n,i=E(t);return 0===i&&((n=t.state).window_size=2*n.w_size,f(n.head),n.max_lazy_match=e[n.level].max_lazy,n.good_match=e[n.level].good_length,n.nice_match=e[n.level].nice_length,n.max_chain_length=e[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),i}function T(e,n,i,r,s,a){if(!e)return o;var l=1;if(-1===n&&(n=6),r<0?(l=0,r=-r):r>15&&(l=2,r-=16),s<1||s>9||8!==i||r<8||r>15||n<0||n>9||a<0||a>4)return d(e,o);8===r&&(r=9);var c=new L;return e.state=c,c.strm=e,c.wrap=l,c.gzhead=null,c.w_bits=r,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=s+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new t.Buf8(2*c.w_size),c.head=new t.Buf16(c.hash_size),c.prev=new t.Buf16(c.w_size),c.lit_bufsize=1<<s+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new t.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=n,c.strategy=a,c.method=i,P(e)}return e=[new k(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(x(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,g(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-l&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(g(e,!1),e.strm.avail_out),1)}),new k(4,4,8,4,C),new k(4,5,16,8,C),new k(4,6,32,32,C),new k(4,4,16,16,S),new k(8,16,32,32,S),new k(8,16,128,128,S),new k(8,32,128,256,S),new k(32,128,258,1024,S),new k(32,258,258,4096,S)],gk.deflateInit=function(e,t){return T(e,t,8,15,8,0)},gk.deflateInit2=T,gk.deflateReset=P,gk.deflateResetKeep=E,gk.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?o:(e.state.gzhead=t,0):o},gk.deflate=function(t,i){var s,l,b,w;if(!t||!t.state||i>5||i<0)return t?d(t,o):o;if(l=t.state,!t.output||!t.input&&0!==t.avail_in||l.status===u&&4!==i)return d(t,0===t.avail_out?-5:o);if(l.strm=t,s=l.last_flush,l.last_flush=i,42===l.status)if(2===l.wrap)t.adler=0,v(l,31),v(l,139),v(l,8),l.gzhead?(v(l,(l.gzhead.text?1:0)+(l.gzhead.hcrc?2:0)+(l.gzhead.extra?4:0)+(l.gzhead.name?8:0)+(l.gzhead.comment?16:0)),v(l,255&l.gzhead.time),v(l,l.gzhead.time>>8&255),v(l,l.gzhead.time>>16&255),v(l,l.gzhead.time>>24&255),v(l,9===l.level?2:l.strategy>=2||l.level<2?4:0),v(l,255&l.gzhead.os),l.gzhead.extra&&l.gzhead.extra.length&&(v(l,255&l.gzhead.extra.length),v(l,l.gzhead.extra.length>>8&255)),l.gzhead.hcrc&&(t.adler=r(t.adler,l.pending_buf,l.pending,0)),l.gzindex=0,l.status=69):(v(l,0),v(l,0),v(l,0),v(l,0),v(l,0),v(l,9===l.level?2:l.strategy>=2||l.level<2?4:0),v(l,3),l.status=h);else{var C=8+(l.w_bits-8<<4)<<8;C|=(l.strategy>=2||l.level<2?0:l.level<6?1:6===l.level?2:3)<<6,0!==l.strstart&&(C|=32),C+=31-C%31,l.status=h,y(l,C),0!==l.strstart&&(y(l,t.adler>>>16),y(l,65535&t.adler)),t.adler=1}if(69===l.status)if(l.gzhead.extra){for(b=l.pending;l.gzindex<(65535&l.gzhead.extra.length)&&(l.pending!==l.pending_buf_size||(l.gzhead.hcrc&&l.pending>b&&(t.adler=r(t.adler,l.pending_buf,l.pending-b,b)),m(t),b=l.pending,l.pending!==l.pending_buf_size));)v(l,255&l.gzhead.extra[l.gzindex]),l.gzindex++;l.gzhead.hcrc&&l.pending>b&&(t.adler=r(t.adler,l.pending_buf,l.pending-b,b)),l.gzindex===l.gzhead.extra.length&&(l.gzindex=0,l.status=73)}else l.status=73;if(73===l.status)if(l.gzhead.name){b=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>b&&(t.adler=r(t.adler,l.pending_buf,l.pending-b,b)),m(t),b=l.pending,l.pending===l.pending_buf_size)){w=1;break}w=l.gzindex<l.gzhead.name.length?255&l.gzhead.name.charCodeAt(l.gzindex++):0,v(l,w)}while(0!==w);l.gzhead.hcrc&&l.pending>b&&(t.adler=r(t.adler,l.pending_buf,l.pending-b,b)),0===w&&(l.gzindex=0,l.status=91)}else l.status=91;if(91===l.status)if(l.gzhead.comment){b=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>b&&(t.adler=r(t.adler,l.pending_buf,l.pending-b,b)),m(t),b=l.pending,l.pending===l.pending_buf_size)){w=1;break}w=l.gzindex<l.gzhead.comment.length?255&l.gzhead.comment.charCodeAt(l.gzindex++):0,v(l,w)}while(0!==w);l.gzhead.hcrc&&l.pending>b&&(t.adler=r(t.adler,l.pending_buf,l.pending-b,b)),0===w&&(l.status=c)}else l.status=c;if(l.status===c&&(l.gzhead.hcrc?(l.pending+2>l.pending_buf_size&&m(t),l.pending+2<=l.pending_buf_size&&(v(l,255&t.adler),v(l,t.adler>>8&255),t.adler=0,l.status=h)):l.status=h),0!==l.pending){if(m(t),0===t.avail_out)return l.last_flush=-1,0}else if(0===t.avail_in&&p(i)<=p(s)&&4!==i)return d(t,-5);if(l.status===u&&0!==t.avail_in)return d(t,-5);if(0!==t.avail_in||0!==l.lookahead||0!==i&&l.status!==u){var S=2===l.strategy?function(e,t){for(var i;;){if(0===e.lookahead&&(x(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,i=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(l,i):3===l.strategy?function(e,t){for(var i,r,s,o,l=e.window;;){if(e.lookahead<=a){if(x(e),e.lookahead<=a&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=l[s=e.strstart-1])===l[++s]&&r===l[++s]&&r===l[++s]){o=e.strstart+a;do{}while(r===l[++s]&&r===l[++s]&&r===l[++s]&&r===l[++s]&&r===l[++s]&&r===l[++s]&&r===l[++s]&&r===l[++s]&&s<o);e.match_length=a-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=n._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(l,i):e[l.level].func(l,i);if(3!==S&&4!==S||(l.status=u),1===S||3===S)return 0===t.avail_out&&(l.last_flush=-1),0;if(2===S&&(1===i?n._tr_align(l):5!==i&&(n._tr_stored_block(l,0,0,!1),3===i&&(f(l.head),0===l.lookahead&&(l.strstart=0,l.block_start=0,l.insert=0))),m(t),0===t.avail_out))return l.last_flush=-1,0}return 4!==i?0:l.wrap<=0?1:(2===l.wrap?(v(l,255&t.adler),v(l,t.adler>>8&255),v(l,t.adler>>16&255),v(l,t.adler>>24&255),v(l,255&t.total_in),v(l,t.total_in>>8&255),v(l,t.total_in>>16&255),v(l,t.total_in>>24&255)):(y(l,t.adler>>>16),y(l,65535&t.adler)),m(t),l.wrap>0&&(l.wrap=-l.wrap),0!==l.pending?0:1)},gk.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==c&&t!==h&&t!==u?d(e,o):(e.state=null,t===h?d(e,-3):0):o},gk.deflateSetDictionary=function(e,n){var r,s,a,l,c,h,u,d,p=n.length;if(!e||!e.state)return o;if(2===(l=(r=e.state).wrap)||1===l&&42!==r.status||r.lookahead)return o;for(1===l&&(e.adler=i(e.adler,n,p,0)),r.wrap=0,p>=r.w_size&&(0===l&&(f(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new t.Buf8(r.w_size),t.arraySet(d,n,p-r.w_size,r.w_size,0),n=d,p=r.w_size),c=e.avail_in,h=e.next_in,u=e.input,e.avail_in=p,e.next_in=0,e.input=n,x(r);r.lookahead>=3;){s=r.strstart,a=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[s+3-1])&r.hash_mask,r.prev[s&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=s,s++}while(--a);r.strstart=s,r.lookahead=2,x(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=h,e.input=u,e.avail_in=c,r.wrap=l,0},gk.deflateInfo="pako deflate (from Nodeca project)",gk}var Sk,kk,Lk,Ek,Pk={};function Tk(){if(Sk)return Pk;Sk=1;var e=ok(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch(o){t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(o){n=!1}for(var i=new e.Buf8(256),r=0;r<256;r++)i[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;function s(i,r){if(r<65534&&(i.subarray&&n||!i.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(i,r));for(var s="",o=0;o<r;o++)s+=String.fromCharCode(i[o]);return s}return i[254]=i[254]=1,Pk.string2buf=function(t){var n,i,r,s,o,a=t.length,l=0;for(s=0;s<a;s++)55296==(64512&(i=t.charCodeAt(s)))&&s+1<a&&56320==(64512&(r=t.charCodeAt(s+1)))&&(i=65536+(i-55296<<10)+(r-56320),s++),l+=i<128?1:i<2048?2:i<65536?3:4;for(n=new e.Buf8(l),o=0,s=0;o<l;s++)55296==(64512&(i=t.charCodeAt(s)))&&s+1<a&&56320==(64512&(r=t.charCodeAt(s+1)))&&(i=65536+(i-55296<<10)+(r-56320),s++),i<128?n[o++]=i:i<2048?(n[o++]=192|i>>>6,n[o++]=128|63&i):i<65536?(n[o++]=224|i>>>12,n[o++]=128|i>>>6&63,n[o++]=128|63&i):(n[o++]=240|i>>>18,n[o++]=128|i>>>12&63,n[o++]=128|i>>>6&63,n[o++]=128|63&i);return n},Pk.buf2binstring=function(e){return s(e,e.length)},Pk.binstring2buf=function(t){for(var n=new e.Buf8(t.length),i=0,r=n.length;i<r;i++)n[i]=t.charCodeAt(i);return n},Pk.buf2string=function(e,t){var n,r,o,a,l=t||e.length,c=new Array(2*l);for(r=0,n=0;n<l;)if((o=e[n++])<128)c[r++]=o;else if((a=i[o])>4)c[r++]=65533,n+=a-1;else{for(o&=2===a?31:3===a?15:7;a>1&&n<l;)o=o<<6|63&e[n++],a--;a>1?c[r++]=65533:o<65536?c[r++]=o:(o-=65536,c[r++]=55296|o>>10&1023,c[r++]=56320|1023&o)}return s(c,r)},Pk.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+i[e[n]]>t?n:t},Pk}function Ak(){if(Lk)return kk;return Lk=1,kk=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}var Mk,Ik,_k,Ok,Nk,Dk,Rk,Fk,Bk,Vk,jk,Hk,Uk={},zk={};function Wk(){if(Nk)return zk;Nk=1;var e=ok(),t=bk(),n=wk(),i=Ik?Mk:(Ik=1,Mk=function(e,t){var n,i,r,s,o,a,l,c,h,u,d,p,f,m,g,v,y,b,w,x,C,S,k,L,E;n=e.state,i=e.next_in,L=e.input,r=i+(e.avail_in-5),s=e.next_out,E=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=n.dmax,c=n.wsize,h=n.whave,u=n.wnext,d=n.window,p=n.hold,f=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{f<15&&(p+=L[i++]<<f,f+=8,p+=L[i++]<<f,f+=8),b=m[p&v];t:for(;;){if(p>>>=w=b>>>24,f-=w,0==(w=b>>>16&255))E[s++]=65535&b;else{if(!(16&w)){if(64&w){if(32&w){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}b=m[(65535&b)+(p&(1<<w)-1)];continue t}for(x=65535&b,(w&=15)&&(f<w&&(p+=L[i++]<<f,f+=8),x+=p&(1<<w)-1,p>>>=w,f-=w),f<15&&(p+=L[i++]<<f,f+=8,p+=L[i++]<<f,f+=8),b=g[p&y];;){if(p>>>=w=b>>>24,f-=w,16&(w=b>>>16&255)){if(C=65535&b,f<(w&=15)&&(p+=L[i++]<<f,(f+=8)<w&&(p+=L[i++]<<f,f+=8)),(C+=p&(1<<w)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=w,f-=w,C>(w=s-o)){if((w=C-w)>h&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(S=0,k=d,0===u){if(S+=c-w,w<x){x-=w;do{E[s++]=d[S++]}while(--w);S=s-C,k=E}}else if(u<w){if(S+=c+u-w,(w-=u)<x){x-=w;do{E[s++]=d[S++]}while(--w);if(S=0,u<x){x-=w=u;do{E[s++]=d[S++]}while(--w);S=s-C,k=E}}}else if(S+=u-w,w<x){x-=w;do{E[s++]=d[S++]}while(--w);S=s-C,k=E}for(;x>2;)E[s++]=k[S++],E[s++]=k[S++],E[s++]=k[S++],x-=3;x&&(E[s++]=k[S++],x>1&&(E[s++]=k[S++]))}else{S=s-C;do{E[s++]=E[S++],E[s++]=E[S++],E[s++]=E[S++],x-=3}while(x>2);x&&(E[s++]=E[S++],x>1&&(E[s++]=E[S++]))}break}if(64&w){e.msg="invalid distance code",n.mode=30;break e}b=g[(65535&b)+(p&(1<<w)-1)]}}break}}while(i<r&&s<a);i-=x=f>>3,p&=(1<<(f-=x<<3))-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=s<a?a-s+257:257-(s-a),n.hold=p,n.bits=f}),r=function(){if(Ok)return _k;Ok=1;var e=ok(),t=15,n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return _k=function(o,a,l,c,h,u,d,p){var f,m,g,v,y,b,w,x,C,S=p.bits,k=0,L=0,E=0,P=0,T=0,A=0,M=0,I=0,_=0,O=0,N=null,D=0,R=new e.Buf16(16),F=new e.Buf16(16),B=null,V=0;for(k=0;k<=t;k++)R[k]=0;for(L=0;L<c;L++)R[a[l+L]]++;for(T=S,P=t;P>=1&&0===R[P];P--);if(T>P&&(T=P),0===P)return h[u++]=20971520,h[u++]=20971520,p.bits=1,0;for(E=1;E<P&&0===R[E];E++);for(T<E&&(T=E),I=1,k=1;k<=t;k++)if(I<<=1,(I-=R[k])<0)return-1;if(I>0&&(0===o||1!==P))return-1;for(F[1]=0,k=1;k<t;k++)F[k+1]=F[k]+R[k];for(L=0;L<c;L++)0!==a[l+L]&&(d[F[a[l+L]]++]=L);if(0===o?(N=B=d,b=19):1===o?(N=n,D-=257,B=i,V-=257,b=256):(N=r,B=s,b=-1),O=0,L=0,k=E,y=u,A=T,M=0,g=-1,v=(_=1<<T)-1,1===o&&_>852||2===o&&_>592)return 1;for(;;){w=k-M,d[L]<b?(x=0,C=d[L]):d[L]>b?(x=B[V+d[L]],C=N[D+d[L]]):(x=96,C=0),f=1<<k-M,E=m=1<<A;do{h[y+(O>>M)+(m-=f)]=w<<24|x<<16|C}while(0!==m);for(f=1<<k-1;O&f;)f>>=1;if(0!==f?(O&=f-1,O+=f):O=0,L++,0===--R[k]){if(k===P)break;k=a[l+d[L]]}if(k>T&&(O&v)!==g){for(0===M&&(M=T),y+=E,I=1<<(A=k-M);A+M<P&&!((I-=R[A+M])<=0);)A++,I<<=1;if(_+=1<<A,1===o&&_>852||2===o&&_>592)return 1;h[g=O&v]=T<<24|A<<16|y-u}}return 0!==O&&(h[y+O]=k-M<<24|64<<16),p.bits=T,0}}(),s=-2,o=12,a=30;function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(t){var n;return t&&t.state?(n=t.state,t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=1,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new e.Buf32(852),n.distcode=n.distdyn=new e.Buf32(592),n.sane=1,n.back=-1,0):s}function u(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,h(e)):s}function d(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?s:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,u(e))):s}function p(e,t){var n,i;return e?(i=new c,e.state=i,i.window=null,0!==(n=d(e,t))&&(e.state=null),n):s}var f,m,g=!0;function v(t){if(g){var n;for(f=new e.Buf32(512),m=new e.Buf32(32),n=0;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(r(1,t.lens,0,288,f,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;r(2,t.lens,0,32,m,0,t.work,{bits:5}),g=!1}t.lencode=f,t.lenbits=9,t.distcode=m,t.distbits=5}function y(t,n,i,r){var s,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new e.Buf8(o.wsize)),r>=o.wsize?(e.arraySet(o.window,n,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((s=o.wsize-o.wnext)>r&&(s=r),e.arraySet(o.window,n,i-r,s,o.wnext),(r-=s)?(e.arraySet(o.window,n,i-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0}return zk.inflateReset=u,zk.inflateReset2=d,zk.inflateResetKeep=h,zk.inflateInit=function(e){return p(e,15)},zk.inflateInit2=p,zk.inflate=function(c,h){var u,d,p,f,m,g,b,w,x,C,S,k,L,E,P,T,A,M,I,_,O,N,D,R,F=0,B=new e.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!c||!c.state||!c.output||!c.input&&0!==c.avail_in)return s;(u=c.state).mode===o&&(u.mode=13),m=c.next_out,p=c.output,b=c.avail_out,f=c.next_in,d=c.input,g=c.avail_in,w=u.hold,x=u.bits,C=g,S=b,N=0;e:for(;;)switch(u.mode){case 1:if(0===u.wrap){u.mode=13;break}for(;x<16;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}if(2&u.wrap&&35615===w){u.check=0,B[0]=255&w,B[1]=w>>>8&255,u.check=n(u.check,B,2,0),w=0,x=0,u.mode=2;break}if(u.flags=0,u.head&&(u.head.done=!1),!(1&u.wrap)||(((255&w)<<8)+(w>>8))%31){c.msg="incorrect header check",u.mode=a;break}if(8!=(15&w)){c.msg="unknown compression method",u.mode=a;break}if(x-=4,O=8+(15&(w>>>=4)),0===u.wbits)u.wbits=O;else if(O>u.wbits){c.msg="invalid window size",u.mode=a;break}u.dmax=1<<O,c.adler=u.check=1,u.mode=512&w?10:o,w=0,x=0;break;case 2:for(;x<16;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}if(u.flags=w,8!=(255&u.flags)){c.msg="unknown compression method",u.mode=a;break}if(57344&u.flags){c.msg="unknown header flags set",u.mode=a;break}u.head&&(u.head.text=w>>8&1),512&u.flags&&(B[0]=255&w,B[1]=w>>>8&255,u.check=n(u.check,B,2,0)),w=0,x=0,u.mode=3;case 3:for(;x<32;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}u.head&&(u.head.time=w),512&u.flags&&(B[0]=255&w,B[1]=w>>>8&255,B[2]=w>>>16&255,B[3]=w>>>24&255,u.check=n(u.check,B,4,0)),w=0,x=0,u.mode=4;case 4:for(;x<16;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}u.head&&(u.head.xflags=255&w,u.head.os=w>>8),512&u.flags&&(B[0]=255&w,B[1]=w>>>8&255,u.check=n(u.check,B,2,0)),w=0,x=0,u.mode=5;case 5:if(1024&u.flags){for(;x<16;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}u.length=w,u.head&&(u.head.extra_len=w),512&u.flags&&(B[0]=255&w,B[1]=w>>>8&255,u.check=n(u.check,B,2,0)),w=0,x=0}else u.head&&(u.head.extra=null);u.mode=6;case 6:if(1024&u.flags&&((k=u.length)>g&&(k=g),k&&(u.head&&(O=u.head.extra_len-u.length,u.head.extra||(u.head.extra=new Array(u.head.extra_len)),e.arraySet(u.head.extra,d,f,k,O)),512&u.flags&&(u.check=n(u.check,d,k,f)),g-=k,f+=k,u.length-=k),u.length))break e;u.length=0,u.mode=7;case 7:if(2048&u.flags){if(0===g)break e;k=0;do{O=d[f+k++],u.head&&O&&u.length<65536&&(u.head.name+=String.fromCharCode(O))}while(O&&k<g);if(512&u.flags&&(u.check=n(u.check,d,k,f)),g-=k,f+=k,O)break e}else u.head&&(u.head.name=null);u.length=0,u.mode=8;case 8:if(4096&u.flags){if(0===g)break e;k=0;do{O=d[f+k++],u.head&&O&&u.length<65536&&(u.head.comment+=String.fromCharCode(O))}while(O&&k<g);if(512&u.flags&&(u.check=n(u.check,d,k,f)),g-=k,f+=k,O)break e}else u.head&&(u.head.comment=null);u.mode=9;case 9:if(512&u.flags){for(;x<16;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}if(w!==(65535&u.check)){c.msg="header crc mismatch",u.mode=a;break}w=0,x=0}u.head&&(u.head.hcrc=u.flags>>9&1,u.head.done=!0),c.adler=u.check=0,u.mode=o;break;case 10:for(;x<32;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}c.adler=u.check=l(w),w=0,x=0,u.mode=11;case 11:if(0===u.havedict)return c.next_out=m,c.avail_out=b,c.next_in=f,c.avail_in=g,u.hold=w,u.bits=x,2;c.adler=u.check=1,u.mode=o;case o:if(5===h||6===h)break e;case 13:if(u.last){w>>>=7&x,x-=7&x,u.mode=27;break}for(;x<3;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}switch(u.last=1&w,x-=1,3&(w>>>=1)){case 0:u.mode=14;break;case 1:if(v(u),u.mode=20,6===h){w>>>=2,x-=2;break e}break;case 2:u.mode=17;break;case 3:c.msg="invalid block type",u.mode=a}w>>>=2,x-=2;break;case 14:for(w>>>=7&x,x-=7&x;x<32;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}if((65535&w)!=(w>>>16^65535)){c.msg="invalid stored block lengths",u.mode=a;break}if(u.length=65535&w,w=0,x=0,u.mode=15,6===h)break e;case 15:u.mode=16;case 16:if(k=u.length){if(k>g&&(k=g),k>b&&(k=b),0===k)break e;e.arraySet(p,d,f,k,m),g-=k,f+=k,b-=k,m+=k,u.length-=k;break}u.mode=o;break;case 17:for(;x<14;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}if(u.nlen=257+(31&w),w>>>=5,x-=5,u.ndist=1+(31&w),w>>>=5,x-=5,u.ncode=4+(15&w),w>>>=4,x-=4,u.nlen>286||u.ndist>30){c.msg="too many length or distance symbols",u.mode=a;break}u.have=0,u.mode=18;case 18:for(;u.have<u.ncode;){for(;x<3;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}u.lens[V[u.have++]]=7&w,w>>>=3,x-=3}for(;u.have<19;)u.lens[V[u.have++]]=0;if(u.lencode=u.lendyn,u.lenbits=7,D={bits:u.lenbits},N=r(0,u.lens,0,19,u.lencode,0,u.work,D),u.lenbits=D.bits,N){c.msg="invalid code lengths set",u.mode=a;break}u.have=0,u.mode=19;case 19:for(;u.have<u.nlen+u.ndist;){for(;T=(F=u.lencode[w&(1<<u.lenbits)-1])>>>16&255,A=65535&F,!((P=F>>>24)<=x);){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}if(A<16)w>>>=P,x-=P,u.lens[u.have++]=A;else{if(16===A){for(R=P+2;x<R;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}if(w>>>=P,x-=P,0===u.have){c.msg="invalid bit length repeat",u.mode=a;break}O=u.lens[u.have-1],k=3+(3&w),w>>>=2,x-=2}else if(17===A){for(R=P+3;x<R;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}x-=P,O=0,k=3+(7&(w>>>=P)),w>>>=3,x-=3}else{for(R=P+7;x<R;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}x-=P,O=0,k=11+(127&(w>>>=P)),w>>>=7,x-=7}if(u.have+k>u.nlen+u.ndist){c.msg="invalid bit length repeat",u.mode=a;break}for(;k--;)u.lens[u.have++]=O}}if(u.mode===a)break;if(0===u.lens[256]){c.msg="invalid code -- missing end-of-block",u.mode=a;break}if(u.lenbits=9,D={bits:u.lenbits},N=r(1,u.lens,0,u.nlen,u.lencode,0,u.work,D),u.lenbits=D.bits,N){c.msg="invalid literal/lengths set",u.mode=a;break}if(u.distbits=6,u.distcode=u.distdyn,D={bits:u.distbits},N=r(2,u.lens,u.nlen,u.ndist,u.distcode,0,u.work,D),u.distbits=D.bits,N){c.msg="invalid distances set",u.mode=a;break}if(u.mode=20,6===h)break e;case 20:u.mode=21;case 21:if(g>=6&&b>=258){c.next_out=m,c.avail_out=b,c.next_in=f,c.avail_in=g,u.hold=w,u.bits=x,i(c,S),m=c.next_out,p=c.output,b=c.avail_out,f=c.next_in,d=c.input,g=c.avail_in,w=u.hold,x=u.bits,u.mode===o&&(u.back=-1);break}for(u.back=0;T=(F=u.lencode[w&(1<<u.lenbits)-1])>>>16&255,A=65535&F,!((P=F>>>24)<=x);){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}if(T&&!(240&T)){for(M=P,I=T,_=A;T=(F=u.lencode[_+((w&(1<<M+I)-1)>>M)])>>>16&255,A=65535&F,!(M+(P=F>>>24)<=x);){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}w>>>=M,x-=M,u.back+=M}if(w>>>=P,x-=P,u.back+=P,u.length=A,0===T){u.mode=26;break}if(32&T){u.back=-1,u.mode=o;break}if(64&T){c.msg="invalid literal/length code",u.mode=a;break}u.extra=15&T,u.mode=22;case 22:if(u.extra){for(R=u.extra;x<R;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}u.length+=w&(1<<u.extra)-1,w>>>=u.extra,x-=u.extra,u.back+=u.extra}u.was=u.length,u.mode=23;case 23:for(;T=(F=u.distcode[w&(1<<u.distbits)-1])>>>16&255,A=65535&F,!((P=F>>>24)<=x);){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}if(!(240&T)){for(M=P,I=T,_=A;T=(F=u.distcode[_+((w&(1<<M+I)-1)>>M)])>>>16&255,A=65535&F,!(M+(P=F>>>24)<=x);){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}w>>>=M,x-=M,u.back+=M}if(w>>>=P,x-=P,u.back+=P,64&T){c.msg="invalid distance code",u.mode=a;break}u.offset=A,u.extra=15&T,u.mode=24;case 24:if(u.extra){for(R=u.extra;x<R;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}u.offset+=w&(1<<u.extra)-1,w>>>=u.extra,x-=u.extra,u.back+=u.extra}if(u.offset>u.dmax){c.msg="invalid distance too far back",u.mode=a;break}u.mode=25;case 25:if(0===b)break e;if(k=S-b,u.offset>k){if((k=u.offset-k)>u.whave&&u.sane){c.msg="invalid distance too far back",u.mode=a;break}k>u.wnext?(k-=u.wnext,L=u.wsize-k):L=u.wnext-k,k>u.length&&(k=u.length),E=u.window}else E=p,L=m-u.offset,k=u.length;k>b&&(k=b),b-=k,u.length-=k;do{p[m++]=E[L++]}while(--k);0===u.length&&(u.mode=21);break;case 26:if(0===b)break e;p[m++]=u.length,b--,u.mode=21;break;case 27:if(u.wrap){for(;x<32;){if(0===g)break e;g--,w|=d[f++]<<x,x+=8}if(S-=b,c.total_out+=S,u.total+=S,S&&(c.adler=u.check=u.flags?n(u.check,p,S,m-S):t(u.check,p,S,m-S)),S=b,(u.flags?w:l(w))!==u.check){c.msg="incorrect data check",u.mode=a;break}w=0,x=0}u.mode=28;case 28:if(u.wrap&&u.flags){for(;x<32;){if(0===g)break e;g--,w+=d[f++]<<x,x+=8}if(w!==(4294967295&u.total)){c.msg="incorrect length check",u.mode=a;break}w=0,x=0}u.mode=29;case 29:N=1;break e;case a:N=-3;break e;case 31:return-4;default:return s}return c.next_out=m,c.avail_out=b,c.next_in=f,c.avail_in=g,u.hold=w,u.bits=x,(u.wsize||S!==c.avail_out&&u.mode<a&&(u.mode<27||4!==h))&&y(c,c.output,c.next_out,S-c.avail_out),C-=c.avail_in,S-=c.avail_out,c.total_in+=C,c.total_out+=S,u.total+=S,u.wrap&&S&&(c.adler=u.check=u.flags?n(u.check,p,S,c.next_out-S):t(u.check,p,S,c.next_out-S)),c.data_type=u.bits+(u.last?64:0)+(u.mode===o?128:0)+(20===u.mode||15===u.mode?256:0),(0===C&&0===S||4===h)&&0===N&&(N=-5),N},zk.inflateEnd=function(e){if(!e||!e.state)return s;var t=e.state;return t.window&&(t.window=null),e.state=null,0},zk.inflateGetHeader=function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?(n.head=t,t.done=!1,0):s},zk.inflateSetDictionary=function(e,n){var i,r=n.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?s:11===i.mode&&t(1,n,r,0)!==i.check?-3:y(e,n,r,r)?(i.mode=31,-4):(i.havedict=1,0):s},zk.inflateInfo="pako inflate (from Nodeca project)",zk}function Gk(){return Rk?Dk:(Rk=1,Dk={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8})}function $k(){if(Vk)return Uk;Vk=1;var e=Wk(),t=ok(),n=Tk(),i=Gk(),r=xk(),s=Ak(),o=Bk?Fk:(Bk=1,Fk=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}),a=Object.prototype.toString;function l(c){if(!(this instanceof l))return new l(c);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},c||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,0===h.windowBits&&(h.windowBits=-15)),!(h.windowBits>=0&&h.windowBits<16)||c&&c.windowBits||(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&(15&h.windowBits||(h.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var u=e.inflateInit2(this.strm,h.windowBits);if(u!==i.Z_OK)throw new Error(r[u]);if(this.header=new o,e.inflateGetHeader(this.strm,this.header),h.dictionary&&("string"==typeof h.dictionary?h.dictionary=n.string2buf(h.dictionary):"[object ArrayBuffer]"===a.call(h.dictionary)&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(u=e.inflateSetDictionary(this.strm,h.dictionary))!==i.Z_OK))throw new Error(r[u])}function c(e,t){var n=new l(t);if(n.push(e,!0),n.err)throw n.msg||r[n.err];return n.result}return l.prototype.push=function(r,s){var o,l,c,h,u,d=this.strm,p=this.options.chunkSize,f=this.options.dictionary,m=!1;if(this.ended)return!1;l=s===~~s?s:!0===s?i.Z_FINISH:i.Z_NO_FLUSH,"string"==typeof r?d.input=n.binstring2buf(r):"[object ArrayBuffer]"===a.call(r)?d.input=new Uint8Array(r):d.input=r,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new t.Buf8(p),d.next_out=0,d.avail_out=p),(o=e.inflate(d,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&f&&(o=e.inflateSetDictionary(this.strm,f)),o===i.Z_BUF_ERROR&&!0===m&&(o=i.Z_OK,m=!1),o!==i.Z_STREAM_END&&o!==i.Z_OK)return this.onEnd(o),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&o!==i.Z_STREAM_END&&(0!==d.avail_in||l!==i.Z_FINISH&&l!==i.Z_SYNC_FLUSH)||("string"===this.options.to?(c=n.utf8border(d.output,d.next_out),h=d.next_out-c,u=n.buf2string(d.output,c),d.next_out=h,d.avail_out=p-h,h&&t.arraySet(d.output,d.output,c,h,0),this.onData(u)):this.onData(t.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&o!==i.Z_STREAM_END);return o===i.Z_STREAM_END&&(l=i.Z_FINISH),l===i.Z_FINISH?(o=e.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===i.Z_OK):l!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),d.avail_out=0,!0)},l.prototype.onData=function(e){this.chunks.push(e)},l.prototype.onEnd=function(e){e===i.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},Uk.Inflate=l,Uk.inflate=c,Uk.inflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},Uk.ungzip=c,Uk}const Zk=D(function(){if(Hk)return jk;Hk=1;var e={};return(0,ok().assign)(e,function(){if(Ek)return mk;Ek=1;var e=Ck(),t=ok(),n=Tk(),i=xk(),r=Ak(),s=Object.prototype.toString;function o(a){if(!(this instanceof o))return new o(a);this.options=t.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},a||{});var l=this.options;l.raw&&l.windowBits>0?l.windowBits=-l.windowBits:l.gzip&&l.windowBits>0&&l.windowBits<16&&(l.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;var c=e.deflateInit2(this.strm,l.level,l.method,l.windowBits,l.memLevel,l.strategy);if(0!==c)throw new Error(i[c]);if(l.header&&e.deflateSetHeader(this.strm,l.header),l.dictionary){var h;if(h="string"==typeof l.dictionary?n.string2buf(l.dictionary):"[object ArrayBuffer]"===s.call(l.dictionary)?new Uint8Array(l.dictionary):l.dictionary,0!==(c=e.deflateSetDictionary(this.strm,h)))throw new Error(i[c]);this._dict_set=!0}}function a(e,t){var n=new o(t);if(n.push(e,!0),n.err)throw n.msg||i[n.err];return n.result}return o.prototype.push=function(i,r){var o,a,l=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=r===~~r?r:!0===r?4:0,"string"==typeof i?l.input=n.string2buf(i):"[object ArrayBuffer]"===s.call(i)?l.input=new Uint8Array(i):l.input=i,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new t.Buf8(c),l.next_out=0,l.avail_out=c),1!==(o=e.deflate(l,a))&&0!==o)return this.onEnd(o),this.ended=!0,!1;0!==l.avail_out&&(0!==l.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(n.buf2binstring(t.shrinkBuf(l.output,l.next_out))):this.onData(t.shrinkBuf(l.output,l.next_out)))}while((l.avail_in>0||0===l.avail_out)&&1!==o);return 4===a?(o=e.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,0===o):2!==a||(this.onEnd(0),l.avail_out=0,!0)},o.prototype.onData=function(e){this.chunks.push(e)},o.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},mk.Deflate=o,mk.deflate=a,mk.deflateRaw=function(e,t){return(t=t||{}).raw=!0,a(e,t)},mk.gzip=function(e,t){return(t=t||{}).gzip=!0,a(e,t)},mk}(),$k(),Gk()),jk=e}()),qk=async(e,t,n)=>{const{url:i}=await Os("generatePreviewPutUrl",{projectId:e,snapshotId:t},{skipRedraw:!0});await Is(i,{method:"PUT",body:n})},Kk=async(e,t,n)=>{const{url:i}=await Os("generateProjectJSONPutUrl",{projectId:e,snapshotId:t},{skipRedraw:!0}),r=Zk.gzip(JSON.stringify(n));await Is(i,{method:"PUT",headers:{"Content-Encoding":"gzip"},body:new Blob([r],{type:"application/json"})})};class Yk extends Error{constructor(){super("Project is private")}}class Xk extends Error{constructor(){super("Project does not exist")}}const Jk=async e=>{const{getProjectOptions:t,apiRequestOptions:n,upgradeSnapshotOptions:i}=e,r=await _s("getProject",t,n);if(!r.success)throw"This project is private"===r.message?new Yk:new Xk;const s=r.projectJSONUrl;let o,a;return s&&(o=await(async e=>{try{const t=await Is(e),n=await t.json();if(Js(n))return n}catch(t){}throw new Error("Could not load project")})(s),o&&(a=kS.fromJSON(o,i))),{response:r,snapshot:a}};const Qk=new class{constructor(){this.uploadedIcons=[],this.subscribers=new Set}async refreshIcons(){if(!va.loggedInUser)return this.uploadedIcons=[],void this.notifySubscribers();const e=await Os("getIconsForLoggedInUser",{});this.uploadedIcons=e.icons||[],this.notifySubscribers()}getIcons(){return this.uploadedIcons}async importCustomIcon(e){if(!va.loggedInUser)return Promise.reject();const t=e.name.substring(0,e.name.lastIndexOf(".")),n=await cc(e),i=new Blob([n],{type:"image/svg+xml"}),r=await i.arrayBuffer(),s=await To(r),o=await Os("addIconForLoggedInUser",{hash:s,name:t},{skipRedraw:!0});return o.url&&await Is(o.url,{method:"PUT",body:i}),await this.refreshIcons(),this.notifySubscribers(),`${rc}${va.loggedInUser.userId}/${s}.svg`}async renameCustomIcon(e,t){if(!va.loggedInUser)return Promise.reject();const n=this.uploadedIcons.findIndex(t=>t.hash===e);-1!==n&&(this.uploadedIcons[n].name=t),this.notifySubscribers();try{await Os("renameIcon",{hash:e,name:t},{skipRedraw:!0})}catch(i){throw await this.refreshIcons(),i}}async removeCustomIcon(e){if(!va.loggedInUser)return Promise.reject();const t=this.uploadedIcons.findIndex(t=>t.hash===e);-1!==t&&this.uploadedIcons.splice(t,1),this.notifySubscribers();try{await Os("deleteIcon",{hash:e},{skipRedraw:!0})}catch(n){throw await this.refreshIcons(),n}}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}notifySubscribers(){for(let e of this.subscribers)e()}};let eL;const tL="All",nL="My Fonts",iL="world",rL="single line pro",sL=[tL,nL,"pro","sans-serif","serif","display","handwriting","stencil",iL,"monospace",rL,"single line script","single line sans","single line serif"],oL=e=>e.complexity>7;const aL=new class{constructor(){this.categories=[],this.sortedAll=[],this.categoriesSet=new Set(sL),this.familiesByCategory=new Map,this.familyByName=new Map,this.variantByURL=new Map,this.builtinFamilies=new Set,this.subscribers=new Set}processList(e){var t,n;e=e.slice().sort((e,t)=>e.pro&&!t.pro?-1:!e.pro&&t.pro?1:e.family.localeCompare(t.family)),this.sortedAll=e,this.categories=sL.slice(),this.categoriesSet=new Set(sL),this.familiesByCategory=new Map;const i=new Set;this.familiesByCategory.set(tL,i),this.familyByName=new Map,this.variantByURL=new Map;for(let r of sL)this.categoriesSet.add(r),this.familiesByCategory.has(r)||this.familiesByCategory.set(r,new Set);for(let r of e){const{category:e,family:s,variants:o}=r;if(this.familyByName.set(s,r),!oL(r)){let t=this.familiesByCategory.get(e);t||(this.categories.push(e),this.categoriesSet.add(e),t=new Set,this.familiesByCategory.set(e,t)),t.add(r),e!==iL&&i.add(r)}r.pro&&(r.category.includes("single line")?null==(t=this.familiesByCategory.get(rL))||t.add(r):null==(n=this.familiesByCategory.get("pro"))||n.add(r));const a=[];for(let t of o){const{variant:e,value:n,valueArchive:i}=t,o={fontFamily:r,fontVariant:t};this.variantByURL.set(n,o);for(let t of i)this.variantByURL.set(t,o);if(a.includes(e)){const n={};for(let e of a)n[e]=!0;const i=new dC(n).generate(e);t.variant=i,t.label=`${s} (${i})`,a.push(i)}else a.push(e)}}}isFontInfoLoaded(){return void 0!==this.builtinFontFamilies&&this.builtinFontFamilies.length>0}async ensureBuiltInFontsLoaded(){if(!this.builtinFontFamilies){this.builtinFontFamilies=[],this.builtinFontFamilies=await async function(){if(eL)return eL;const[{allGoogleFonts:e},{allStrokeFonts:t},{allProFonts:n}]=await Promise.all([Ms(()=>import("./builtin-fonts-google-BRQtSpxd.js"),[]),Ms(()=>import("./builtin-fonts-stroke-CvqPVHSA.js"),[]),Ms(()=>import("./builtin-fonts-pro-DW6NkQr3.js"),[])]);return eL=[...e,...t,...n],eL}();for(let t of this.builtinFontFamilies)this.builtinFamilies.add(t.family);const e=[...this.customFontFamilies||[],...this.builtinFontFamilies];this.processList(e),this.notifySubscribers()}return this.builtinFontFamilies}async refreshCustomFonts(){await Oj.storage.refreshCustomFonts();const e=Oj.storage.getCustomFonts();if(!e)return;if(!e.length)return;await this.ensureBuiltInFontsLoaded();const t=[];e.forEach(e=>{let{family:n,variant:i,hash:r}=e;this.builtinFamilies.has(n)&&(n+=" (My Font)");let s=t.find(e=>e.family===n);s||(s={family:n,category:nL,search:n.toLowerCase()+" custom",variants:[],complexity:-1},t.push(s)),s.variants.push({variant:i,label:`${n} (${i})`,value:`${Xp}${r}`,valueArchive:[]})}),this.customFontFamilies=t;const n=[...this.customFontFamilies,...this.builtinFontFamilies||[]];this.processList(n),this.notifySubscribers()}familyAndVariantByNames(e,t){const n=this.familyByName.get(e);if(n){const e=t.toLocaleLowerCase(),i=n.variants.find(t=>t.variant.toLocaleLowerCase()===e);return{fontFamily:n,fontVariant:i}}}familyAndVariantByValue(e){const t=e instanceof Tr?e.url:e;return this.variantByURL.get(t)}familyDefaultVariant(e){const t=this.familyByName.get(e);if(t){for(let e of t.variants){const t=e.variant;if("regular"===t||"Regular"===t)return e}return t.variants[0]}}filteredFontFamilyNames(e,t,n){const i=this.familiesByCategory.get(e);if(!i)return[];let r=Array.from(i);if(""!==t){e===tL&&(r=this.sortedAll);const n=t.toLowerCase();r=r.filter(({search:e})=>e.includes(n))}const s=r.map(e=>({label:e.family,value:e.family,pro:e.pro}));return e===tL&&n&&!s.some(e=>e.value===n)&&(s.push({label:n,value:n,pro:!1}),s.sort((e,t)=>e.label.localeCompare(t.label))),s}filteredFontFamilies(e,t){const n=this.familiesByCategory.get(e);if(!n)return[];let i=Array.from(n);if(""!==t){e===tL&&(i=this.sortedAll);const n=t.toLowerCase();i=i.filter(({search:e})=>e.includes(n))}return i}variantsByFamilyName(e){const t=this.familyByName.get(e);if(t)return t.variants.map(e=>e.variant)}nextCustomFontValue(e){var t;const n=this.familyAndVariantByValue(e);if(!n)return;const{fontFamily:i,fontVariant:r}=n,{variants:s}=i;if(s.length>1){const e=s.indexOf(r);return s[(e+1)%s.length].value}const o=this.familiesByCategory.get(nL);if(o&&o.size>1){const e=Array.from(o),t=e.indexOf(i),n=e[(t+1)%e.length],r=this.familyDefaultVariant(n.family);if(r)return r.value}return null==(t=this.familyDefaultVariant("Noto Sans"))?void 0:t.value}isFontInArrayOrArchive(e,t){var n;const i="string"==typeof e?e:e.url;if(t.includes(i))return!0;const r=null==(n=this.familyAndVariantByValue(e))?void 0:n.fontVariant.value;return!!r&&t.some(e=>{var t;const n=null==(t=this.familyAndVariantByValue(e))?void 0:t.fontVariant.value;return!!n&&n===r})}async removeCustomFont(e){const t=Jp(e);if(!t)return;const n=this.familyAndVariantByValue(e);if(!n)return;const i=this.sortedAll.indexOf(n.fontFamily);if(-1===i)return;const r=n.fontFamily.variants.indexOf(n.fontVariant);-1!==r&&(n.fontFamily.variants.splice(r,1),0===n.fontFamily.variants.length&&this.sortedAll.splice(i,1),this.processList(this.sortedAll),await Oj.storage.removeFontForLoggedInUser(t),await aL.refreshCustomFonts())}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}notifySubscribers(){for(let e of this.subscribers)e()}};class lL{constructor(e){this.lastPreviewPngSize=-1,this.maxSaveInterval=5e3,this.lastSaveTime=0,this.saveAttemptId=0,this.onSuccessCallbacks=[],this.projectId=e}isSynchronized(){return void 0===this.queuedPayload&&void 0===this.enroutePayload}queueSave(e){const t=new Promise((e,t)=>{this.onSuccessCallbacks.push(e)});return this.queuedPayload=e,this.poll(),t}async forceSave(){if(this.isSynchronized())return;const e=new Promise((e,t)=>{this.onSuccessCallbacks.push(e)});return this.poll(!0),e}poll(e=!1){this.isSynchronized()?this.resolveCallbacks():void 0===this.enroutePayload&&void 0!==this.queuedPayload&&(!e&&Date.now()-this.lastSaveTime<this.maxSaveInterval?setTimeout(()=>this.poll(),500):(this.enroutePayload=this.queuedPayload,this.queuedPayload=void 0,this.sendEnroutePayloadToServer()))}resolveCallbacks(){if(!this.activeSnapshotId)throw"Auto-save finished but activeSnapshotId is not defined";for(let e of this.onSuccessCallbacks)e(this.activeSnapshotId);this.onSuccessCallbacks=[]}async sendEnroutePayloadToServer(){if(!this.enroutePayload)throw"enroutePayload is not defined";this.lastSaveTime=Date.now(),this.saveAttemptId++;try{let{project:e,previewPNG:t,coverPhoto:n}=this.enroutePayload;this.activeSnapshotId=(await Os("saveProject",{projectId:this.projectId,snapshotId:this.activeSnapshotId,coverPhoto:n},{skipRedraw:!0})).snapshotId,await Kk(this.projectId,this.activeSnapshotId,e),await Os("updateProjectCurrentSnapshot",{projectId:this.projectId,currentSnapshotId:this.activeSnapshotId},{skipRedraw:!0}),t||(t=So),t.size!==this.lastPreviewPngSize&&(this.lastPreviewPngSize=t.size,await qk(this.projectId,this.activeSnapshotId,t)),this.enroutePayload=void 0,this.poll()}catch(e){console.warn(`[Auto-save] ${this.saveAttemptId} failed`,e),setTimeout(()=>this.sendEnroutePayloadToServer(),500)}}}const cL=class{constructor(){this.type="backend",this._projectId="",this._projectName="Untitled Project",this._projectOwner="Unknown",this._projectOwnerDisplayName=null,this._projectOwnerAvatar="",this._projectCreationDate=null,this._projectFirstMadePublicDate=null,this._projectPublishedDate=null,this._hasWritePermission=!1,this._shareStatus="private",this._projectLicense=null,this._uploadedFonts=[]}async init(e){await va.refreshLoggedInUser(),e&&(this._saveManager=new lL(e));const t=await this.initProject(e);return aL.refreshCustomFonts(),Qk.refreshIcons(),va.featureFlags.hasAdminFeatures&&this.initAllTags(),t}async initProject(e){if(void 0===e||"editor.cuttle.xyz"===window.location.host)return console.error("This version should not be loaded in the iframe."),void(this._accessError="refresh-to-update");if(this._projectId=e,this._saveManager=new lL(e),"_intro"===e)return this.initIntroSequence();try{const{response:t,snapshot:n}=await Jk({getProjectOptions:{projectId:e},upgradeSnapshotOptions:{defaultProjectId:e}});this._projectName=t.name,this._hasWritePermission=t.hasWritePermission,this._shareStatus=t.shareStatus,this._sequenceToLoad=void 0,this._projectOwner=t.owner,this._projectOwnerDisplayName=t.ownerDisplayName,this._projectOwnerAvatar=t.ownerAvatar,this._projectFirstMadePublicDate=t.firstMadePublicDate,this._projectPublishedDate=t.publishedDate,this._projectCreationDate=t.creationDate,this._projectForkedFrom=t.forkedFrom,this._projectTags=t.tags,this._projectLicense=t.license,this._creditId=t.creditId,this.refreshProjectUrl();if(this.refreshMinisiteSubdomain())return;return document.title=t.name,this.refreshSnapshots(),n||void 0}catch(t){return void(t instanceof Yk?(document.title="Project is private.",this._accessError="private"):(document.title="Page not found.",this._accessError="not-found"))}}initIntroSequence(){this._projectName="Learn the Basics",this._projectOwner="@cuttle",this._hasWritePermission=!1,this._shareStatus="unlisted",this._sequenceToLoad="intro"}refreshProjectUrl(){history.replaceState({},"",this.getLocalProjectUrl())}refreshMinisiteSubdomain(){if(this.hasWritePermission())return!1;const e=this.getProjectLicense(),t=Ma(window.location.hostname);if("minisite paid"===e){const e=this.getProjectOwner();if(t!==e)return window.location.href=Oa(e),!0}else if(t)return window.location.href=Oa(void 0),!0;return!1}async checkpoint(e){var t;if(!this._saveManager||!this.hasWritePermission())return;const{projectSnapshot:n,previewPNG:i,coverPhoto:r}=e,s=n.toJSON();this._currentSnapshotId=await this._saveManager.queueSave({project:s,previewPNG:i,coverPhoto:r});const o=null==(t=this._snapshots)?void 0:t.find(e=>e.snapshotId===this._currentSnapshotId);o?(o.lastModified=(new Date).toJSON(),o.previewImage=uL(o.previewImage),Oe.redraw()):this.refreshSnapshots()}async saveCopy(e){if(await this.forceSave(),!va.loggedInUser){if(!(await va.openAccountModalPromise("signup")))return!1}Ps(va.loggedInUser,"Should be logged in to save a copy.");const{projectSnapshot:t,previewPNG:n,coverPhoto:i}=e,r=t.toJSON();let s=this._projectId;"_intro"===s&&(s=void 0);const{projectId:o}=await Os("createProject",{forkedFrom:s},{skipRedraw:!0});await Os("renameProject",{projectId:o,name:this._projectName},{skipRedraw:!0});const{snapshotId:a}=await Os("createAutosaveSnapshot",{projectId:o,coverPhoto:i},{skipRedraw:!0});await Kk(o,a,r),await Os("updateProjectCurrentSnapshot",{projectId:o,currentSnapshotId:a},{skipRedraw:!0}),n&&await qk(o,a,n);return!!(await this.initProject(o))}isSynchronized(){return!this._saveManager||this._saveManager.isSynchronized()}async forceSave(){this._saveManager&&await this._saveManager.forceSave()}async saveVersion(e){const{projectSnapshot:t,previewPNG:n,coverPhoto:i}=e,r=t.toJSON(),{snapshotId:s}=await Os("createVersionSnapshot",{projectId:this._projectId,coverPhoto:i},{skipRedraw:!0});return await Kk(this._projectId,s,r),n&&await qk(this._projectId,s,n),await Os("updateProjectCurrentSnapshot",{projectId:this._projectId,currentSnapshotId:s},{skipRedraw:!0}),await this.refreshSnapshots(),s}async uploadFile(e){const t=await e.arrayBuffer(),n=await To(t),i=e.type,{filePath:r,url:s}=await Os("generateUploadPutUrl",{mimeType:i,hash:n},{skipRedraw:!0});return s&&await Is(s,{method:"PUT",body:e}),r}async addFontForLoggedInUser(e){const{file:t,hash:n,family:i,variant:r,fileExtension:s}=e,o=Gl(t);if(!o||!(e=>{const t=Gl(e);return!!t&&jl.includes(t)})(t))throw new Error("Unknown font type");const a={hash:n,family:i,variant:r,fileExtension:s,mimeType:o},l=await Os("addFontForLoggedInUser",a,{skipRedraw:!0}),c=new Blob([t],{type:o});l.url&&(await Is(l.url,{method:"PUT",body:c}),Ao("upload font",{family:i,variant:r}))}async refreshCustomFonts(){if(!va.loggedInUser)return void(this._uploadedFonts=[]);const e=await _s("getFontsForLoggedInUser",{});e.success?this._uploadedFonts=e.fonts:this._uploadedFonts=[]}getCustomFonts(){if(va.loggedInUser)return this._uploadedFonts}async getFontByHash(e){const t=await Os("getFontByHash",{hash:e});if(t.success){const{url:e,family:n,variant:i}=t;return{url:e,family:n,variant:i}}return null}async removeFontForLoggedInUser(e){await Os("removeFontForLoggedInUser",{hash:e})}getSnapshots(){return this._snapshots}getCurrentSnapshotId(){return this._currentSnapshotId}getPublishedSnapshotId(){return this._publishedSnapshotId}async refreshSnapshots(){if(this.hasWritePermission()){const e=await Os("getSnapshots",{projectId:this._projectId});this._snapshots=e.snapshots,this._currentSnapshotId=e.currentSnapshotId,this._publishedSnapshotId=e.publishedSnapshotId}else this._snapshots=[];return this._snapshots}async restoreSnapshot(e){const{snapshot:t}=await Jk({getProjectOptions:{projectId:this._projectId,snapshotId:e},apiRequestOptions:{skipRedraw:!0},upgradeSnapshotOptions:{defaultProjectId:this._projectId}});return await Os("updateProjectCurrentSnapshot",{projectId:this._projectId,currentSnapshotId:e}),this._currentSnapshotId=e,t}async deleteSnapshot(e){await Os("deleteSnapshot",{projectId:this._projectId,snapshotId:e},{skipRedraw:!0}),this.refreshSnapshots()}async setPublishedSnapshot(e,t){await Os("updateProjectPublishedSnapshot",{projectId:this._projectId,publishedSnapshotId:e,publishedDescription:t}),this._publishedSnapshotId=e??null}async updateSnapshotDescription(e,t){var n;const i=null==(n=this._snapshots)?void 0:n.find(t=>t.snapshotId===e);i&&(i.description=t),await Os("updateSnapshotDescription",{projectId:this._projectId,snapshotId:e,description:t})}getLocalProjectUrl(){return wo(this._projectOwner,this._projectName,this._projectId)}getProjectUrl(){return hr+this.getLocalProjectUrl()}getProjectId(){return this._projectId}getProjectName(){return this._projectName}async setProjectName(e){va.loggedInUser&&(await Os("renameProject",{projectId:this._projectId,name:e}),document.title=e,this._projectName=e,this.refreshProjectUrl())}hasWritePermission(){return Boolean(va.loggedInUser)&&this._hasWritePermission}getShareStatus(){return this._shareStatus}async setShareStatus(e){this._shareStatus=e,await Os("updateShareStatus",{projectId:this._projectId,shareStatus:e})}getProjectOwner(){return this._projectOwner}getProjectOwnerDisplayName(){return this._projectOwnerDisplayName??void 0}getProjectOwnerAvatar(){return this._projectOwnerAvatar}getProjectCreationDate(){return this._projectCreationDate??void 0}getProjectFirstMadePublicDate(){return this._projectFirstMadePublicDate??void 0}getProjectPublishedDate(){return this._projectPublishedDate??void 0}getProjectForkedFrom(){return this._projectForkedFrom}getProjectTags(){return this._projectTags}async setProjectTags(e){this._projectTags=e;const t=e.map(e=>e.tagId);await Os("updateProjectTags",{projectId:this._projectId,tagIds:t})}getProjectLicense(){return this._projectLicense}async setProjectLicense(e){const t=this._projectLicense;this._projectLicense=e;try{await Os("updateProjectLicense",{projectId:this._projectId,license:e})}catch(n){this._projectLicense=t,Oe.redraw()}}getCreditId(){var e;return this._creditId??(null==(e=this.getProjectForkedFrom())?void 0:e.projectId)??this.getProjectId()}sequenceToLoad(){return this._sequenceToLoad}getAccessError(){return this._accessError}isOfficialCuttleTemplate(){return"cuttle"===this._projectOwner}isProTemplate(){return"pro"===this._projectLicense}async initAllTags(){const e=await Os("getTags",{});e.success&&(this._allTags=e.tags)}getAllTags(){return this._allTags}};cL.version=6;let hL=cL;const uL=e=>{const t=/&refresh=\d+$/,n=`&refresh=${Date.now()}`;return t.test(e)?e.replace(t,n):e+n},dL=[{family:"Custom Font",variant:"unavailable",hash:"0000"}],pL=new Map;const fL=["cuttle.xyz","cuttlexyz.com","localhost.cuttle.xyz:8001","localhost.cuttlexyz.com:8001","staging.cuttle.xyz","staging.cuttlexyz.com"].some(e=>e===window.location.host||window.location.host.endsWith("."+e))?new hL:new class{constructor(){this.type="local",this._projectName="Local Project",this._projectTags=[{tagId:1,tagName:"Tag 1",slug:"tag-1"}],this._projectLicense=null}async init(){const e=window.localStorage.getItem("cuttle");if(e){const t=kS.fromString(e,{defaultProjectId:"LOCAL-"+nb()});if(t)return t}}async checkpoint(e){const{projectSnapshot:t}=e;window.localStorage.setItem("cuttle",t.toString())}async saveCopy(e){return console.warn("saveCopy, running locally"),!0}isSynchronized(){return!0}async forceSave(){console.warn("forceSave, running locally")}async saveVersion(e){return console.warn("Could not complete action, running locally"),0}async uploadFile(e){console.warn("Locally simulating an upload and resolving a data url of the file.");const t=new FileReader;return new Promise((n,i)=>{t.onload=()=>n(t.result),t.onerror=()=>i(t.error),setTimeout(()=>t.readAsDataURL(e),5e3)})}async addFontForLoggedInUser(e){console.warn("Locally simulating a font upload.");const{file:t,hash:n,family:i,variant:r}=e;if(pL.has(n))return;const s=await this.uploadFile(t);dL.push({family:i,variant:r,hash:n}),pL.set(n,s)}async refreshCustomFonts(){console.warn("Locally simulating refreshing fonts.")}getCustomFonts(){return dL}async getFontByHash(e){const t=pL.get(e),n=dL.find(t=>t.hash===e);return t?{family:(null==n?void 0:n.family)||"",variant:(null==n?void 0:n.variant)||"",url:t}:null}async removeFontForLoggedInUser(e){console.warn("Locally simulating a font removal."),dL.splice(dL.findIndex(t=>t.hash===e),1),pL.delete(e)}getSnapshots(){}getCurrentSnapshotId(){}getPublishedSnapshotId(){}async refreshSnapshots(){return[]}async restoreSnapshot(){console.warn("Could not complete action, running locally")}async deleteSnapshot(){console.warn("Could not complete action, running locally")}async setPublishedSnapshot(){console.warn("Could not complete action, running locally")}async updateSnapshotDescription(){console.warn("Could not complete action, running locally")}getProjectUrl(){return"https://localhost.cuttle.xyz:8000/@dev/name-id"}getProjectId(){return"LOCAL"}getProjectName(){return this._projectName}setProjectName(e){this._projectName=e}hasWritePermission(){return!0}getShareStatus(){return"private"}setShareStatus(e){console.warn("Could not complete action, running locally")}getProjectOwner(){return"Local"}getProjectOwnerDisplayName(){}getProjectOwnerAvatar(){return""}getProjectCreationDate(){}getProjectFirstMadePublicDate(){}getProjectPublishedDate(){}getProjectForkedFrom(){}getProjectTags(){return this._projectTags}async setProjectTags(e){this._projectTags=e}getProjectLicense(){return this._projectLicense}async setProjectLicense(e){this._projectLicense=e}getCreditId(){return this.getProjectId()}sequenceToLoad(){}getAccessError(){}isOfficialCuttleTemplate(){return!0}isProTemplate(){return!1}getAllTags(){return[{tagId:1,tagName:"Tag 1",slug:"tag-1"},{tagId:2,tagName:"Tag 2",slug:"tag-2"},{tagId:3,tagName:"Tag 3",slug:"tag-3"}]}};window.addEventListener("beforeunload",e=>{fL.isSynchronized()||(fL.forceSave(),e.preventDefault(),e.returnValue="Auto-save in progress...")});const mL={view({attrs:{title:e,actions:t,onClose:n,widthAuto:i},children:r}){const s=()=>{null==n||n(),ia.close()},o=t.map(({label:e,action:t})=>Oe("button",{onclick:()=>{t(),s()}},e));return o.unshift(Oe("button.secondary",{onclick:s},"Cancel")),[Oe(".editor-modal-box",{className:eo({"width-auto":i})},[e&&Oe(".editor-modal-title",Oe("h1",e)),Oe(".editor-modal-contents",r),Oe(".editor-modal-actions",o)])]}},gL={view:({attrs:{primaryAction:e,cancelAction:t,onConfirm:n},children:i})=>[Oe(".simple-modal-box",[Oe(".simple-modal-contents",i),Oe(".simple-modal-actions",[Oe(vL,{primaryAction:e,cancelAction:t,onConfirm:n})])])]},vL=e=>{const t=()=>{const{primaryAction:t,onConfirm:n}=e.attrs;t.action(),null==n||n(),ia.close()},n=()=>{const{cancelAction:t}=e.attrs;null==t||t.action(),ia.dismiss()},i=e=>{so(e)||"Enter"===e.key&&(e.stopPropagation(),t())};return{oncreate(){document.addEventListener("keydown",i)},onremove(){document.removeEventListener("keydown",i)},view:({attrs:{primaryAction:e,cancelAction:i}})=>[Oe("button.secondary",{onclick:n},i?i.label:"Cancel"),Oe("button",{onclick:t,disabled:e.disabled},e.label)]}},yL=()=>{let e,t;return{oncreate(n){t=new ResizeObserver(t=>{e=t[0].contentRect,Oe.redraw()});const i=uo(n);t.observe(i)},onremove(e){t.disconnect()},view:({attrs:{view:t,className:n}})=>void 0===e?(Oe.redraw(),Oe("div",{class:n})):Oe("div",{class:n},t(e))}},bL=new It(3.37,2.125),wL={min:64,max:210,step:1},xL=()=>{const e=window.devicePixelRatio||1,t=Oj.project.settings.units;let n=Oj.deviceStorage.currentScreenPPI()||(e>1?140:110),i=n.toString();const r=e=>{e.currentTarget instanceof HTMLInputElement&&(i=e.currentTarget.value,n=parseFloat(i))},s=()=>{Oj.deviceStorage.setCurrentScreenPPI(n),Oj.zoomViewportToPixelsPerInch(n)};return{view:({attrs:{onClose:e}})=>Oe(mL,{title:"Calibrate This Screen",actions:[{label:"Calibrate Screen",action:s}],onClose:e},[Oe(".calibrate-real-size",[Oe("p",["Adjust the slider until the image matches a standard credit card."]),Oe(".calibrate-real-size-controls",[Oe("input.input-range",{type:"range",...wL,value:i,oninput:r}),Oe("br"),Oe("input.input-number",{type:"number",...wL,value:i,oninput:r})," Pixels Per Inch"])]),Oe(CL,{ppi:n,currentProjectUnits:t})])}},CL={view:({attrs:{ppi:e,currentProjectUnits:t}})=>Oe(yL,{className:"calibrate-real-size-preview",view(n){const i=new It(n.width,n.height).mulScalar(.5),r=bL.clone().mulScalar(e),s=i.clone().sub(r.clone().mulScalar(.5)),o=(a=t,Xr.includes(a));var a;const l=Jr(o?"cm":"in","in"),c=o?1*e*l:.5*e*l,h=c/2,u=c+h;return[Oe(SL,{size:r,position:s}),Oe("svg",{width:n.width,height:n.height},[Oe(LL,{rect:n,size:r,position:s,ppi:e,rulerWidth:c,rulerSpacing:h,isMetric:o}),Oe(kL,{size:r,position:s,tickMarkPx:u})])]}})},SL={view:({attrs:{size:e,position:t}})=>Oe("img",{src:"/editor/images/screen-calibration-credit-card.svg",width:e.x,height:e.y,style:{position:"absolute",top:t.y+"px",left:t.x+"px"}})},kL={view({attrs:{size:e,position:t,tickMarkPx:n}}){const i=t.clone().add(e);return Oe("g.tick-marks",[Oe("line",{x1:t.x-n,y1:t.y,x2:i.x+n,y2:t.y}),Oe("line",{x1:t.x-n,y1:i.y,x2:i.x+n,y2:i.y}),Oe("line",{x1:t.x,y1:t.y-n,x2:t.x,y2:i.y+n}),Oe("line",{x1:i.x,y1:t.y-n,x2:i.x,y2:i.y+n})])}},LL={view:({attrs:{rect:e,size:t,position:n,ppi:i,isMetric:r,rulerWidth:s,rulerSpacing:o}})=>Oe("g.rulers-xy",[Oe(PL,{key:"y",size:new It(e.height,s),originX:n.y,ppi:i,isMetric:r,isVertical:!0,transform:`translate(${n.x-s-o} ${e.height}) rotate(-90)`}),Oe(PL,{key:"x",size:new It(e.width,s),originX:n.x,ppi:i,isMetric:r,isVertical:!1,transform:`translate(0 ${n.y+t.y+o})`})])},EL=(e,t)=>e?t?5:2:t?8:3,PL={view:({attrs:{key:e,size:t,originX:n,ppi:i,isMetric:r,isVertical:s,transform:o}})=>Oe("g.ruler",{transform:o},[Oe("rect.ruler-bg",{key:"bg",width:t.x,height:t.y,x:0,y:0}),Oe(TL,{key:`${e}-${r?"cm":"in"}`,size:t,originX:n,ppi:i,isMetric:r,isSecondary:!1,labelMax:EL(s,r)}),Oe(TL,{key:`${e}-${r?"in":"cm"}`,size:t,originX:n,ppi:i,isMetric:!r,isSecondary:!0,labelMax:EL(s,!r)})])},TL={view({attrs:{key:e,size:t,originX:n,ppi:i,isMetric:r,isSecondary:s,labelMax:o}}){const a=r?"cm":"in",l=i*Jr(a,"in"),c=r?l/10:l/8,h=t.y/4,u=[];for(let d=0;d<=o;d++)u.push(Oe("text",{x:l*d,y:0,"font-size":h+"px"},0===d?a:d));return Oe("g.ruler-marks",[Oe("defs",[Oe("pattern",{id:"calibrate-ruler-pattern-minor-"+e,x:0,y:0,width:c,height:t.y,patternUnits:"userSpaceOnUse"},[Oe("line.minor",s?{x1:0,y1:t.y*(7/8),x2:0,y2:t.y}:{x1:0,y1:0,x2:0,y2:t.y/8})]),Oe("pattern",{id:"calibrate-ruler-pattern-"+e,x:n,y:0,width:l,height:t.y,patternUnits:"userSpaceOnUse"},[Oe("rect",{x:0,y:0,width:l,height:t.y,fill:`url(#calibrate-ruler-pattern-minor-${e})`}),Oe("line.major",s?{x1:0,y1:t.y*(3/4),x2:0,y2:t.y}:{x1:0,y1:0,x2:0,y2:t.y/4})])]),Oe("rect.ruler.pattern",{width:t.x,height:t.y,x:0,y:0,fill:`url(#calibrate-ruler-pattern-${e})`}),Oe("g.labels",{transform:`translate(${n+3} ${s?.8*t.y:.4*t.y})`},u)])}};let AL=0;const ML=new Set,IL=["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","columns","counter-increment","counter-reset","flex","flex-grow","flex-positive","flex-shrink","flex-negative","flex-order","font-weight","grid-area","grid-column","grid-column-end","grid-column-span","grid-column-start","grid-row","grid-row-end","grid-row-span","grid-row-start","line-clamp","line-height","opacity","order","orphans","tab-size","widows","z-index","zoom","fill-opacity","flood-opacity","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width"];for(const os of IL)for(const e of["-webkit-","-ms-","-moz-","-o-",""])ML.add(e+os);function _L(e,t){return e.replace(/&/g,t)}function OL(e){return e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`).replace(/^ms-/,"-ms-")}function NL(e){let t=5381,n=e.length;for(;n--;)t=33*t^e.charCodeAt(n);return(t>>>0).toString(36)}function DL([e,t]){return"number"==typeof t&&t&&!ML.has(e)?`${e}:${t}px`:`${e}:${String(t)}`}function RL(e,t,n,i,r){const s=[],o=[];for(const[f,m]of Object.entries(i))if(36!==f.charCodeAt(0)&&null!=m)if(Array.isArray(m)){const e=OL(f);for(let t=0;t<m.length;t++){const n=m[t];null!=n&&s.push([e,n])}}else"object"==typeof m?o.push([f,m]):s.push([OL(f),m]);const a=!!i.$unique,l=i.$global?"":r,c=s.map(DL).join(";");let h=c,u=l,d=e,p=t;64===n.charCodeAt(0)?(d=[],p=[],l&&c&&p.push({selector:u,style:c,isUnique:a}),e.push({selector:n,style:l?"":c,rules:d,styles:p})):(u=l?n?function(e,t){return-1===e.indexOf("&")?`${t} ${e}`:_L(e,t)}(n,l):l:n,c&&t.push({selector:u,style:c,isUnique:a}));for(const[f,m]of o)h+=`|${f}#${RL(d,p,f,m,u)}`;return h}function FL(e,t,n,i,r){for(const{selector:s,style:o,isUnique:a}of n){const t=_L(s,r),n=new HL(o,a?String(++AL):i);n.add(new jL(t)),e.add(n)}for(const{selector:s,style:o,rules:a,styles:l}of t){const t=_L(s,r),n=new UL(t,o,i);FL(n,a,l,i,r),e.add(n)}}function BL(e){let t="";for(let n=0;n<e.length;n++)t+=e[n];return t}class VL{constructor(e){this.changes=e,this.changeId=0,this.sheet=[],this.children=[],this.counters=new Map}add(e){const t=e.cid(),n=this.counters.get(t)??0;if(this.counters.set(t,n+1),0===n){const t=e.clone(),n=this.children.push(t);this.sheet.push(t.getStyles()),this.changeId++,this.changes&&this.changes.add(t,n)}else if(e instanceof VL){const n=this.children.findIndex(e=>e.cid()===t),i=this.children[n],r=i.changeId;i.merge(e),i.changeId!==r&&(this.sheet[n]=i.getStyles(),this.changeId++,this.changes&&this.changes.change(i,n))}}remove(e){const t=e.cid(),n=this.counters.get(t);if(n){const i=this.children.findIndex(e=>e.cid()===t);if(1===n){const e=this.children[i];this.counters.delete(t),this.children.splice(i,1),this.sheet.splice(i,1),this.changeId++,this.changes&&this.changes.remove(e,i)}else if(e instanceof VL){const r=this.children[i],s=r.changeId;this.counters.set(t,n-1),r.unmerge(e),r.changeId!==s&&(this.sheet[i]=r.getStyles(),this.changeId++,this.changes&&this.changes.change(r,i))}}}merge(e){for(const t of e.children)this.add(t);return this}unmerge(e){for(const t of e.children)this.remove(t);return this}}class jL{constructor(e){this.selector=e}cid(){return this.selector}getStyles(){return this.selector}clone(){return this}}class HL extends VL{constructor(e,t){super(),this.style=e,this.id=t}cid(){return`${this.id}|${this.style}`}getStyles(){return`${this.sheet.join(",")}{${this.style}}`}clone(){return new HL(this.style,this.id).merge(this)}}class UL extends VL{constructor(e,t,n){super(),this.rule=e,this.style=t,this.id=n}cid(){return`${this.id}|${this.rule}|${this.style}`}getStyles(){return`${this.rule}{${this.style}${BL(this.sheet)}}`}clone(){return new UL(this.rule,this.style,this.id).merge(this)}}class zL extends VL{constructor(e,t){super(t),this.prefix=e}register(e){const t=`${this.prefix}${e.id}`;return FL(this,e.rules,e.styles,e.id,t),t}registerStyle(e){return this.register(function(e){const t=[],n=[],i=RL(t,n,"",e,".&");return{id:NL(i),rules:t,styles:n,displayName:e.$displayName}}(e))}getStyles(){return BL(this.sheet)}}const WL={black:"hsl(0, 0%, 0%)",white:"hsl(0, 0%, 100%)",gray96:"hsl(0, 0%, 96%)",gray94:"hsl(0, 0%, 94%)",gray91:"hsl(0, 0%, 91%)",gray80:"hsl(0, 0%, 80%)",gray70:"hsl(0, 0%, 70%)",gray50:"hsl(0, 0%, 50%)",gray24:"hsl(0, 0%, 24%)",whiteAlpha65:"rgba(255, 255, 255, 0.65)",whiteAlpha85:"rgba(255, 255, 255, 0.85)",whiteAlpha95:"rgba(255, 255, 255, 0.95)",blackAlpha03:"rgba(0, 0, 0, 0.03)",blackAlpha05:"rgba(0, 0, 0, 0.05)",blackAlpha10:"rgba(0, 0, 0, 0.1)",blackAlpha20:"rgba(0, 0, 0, 0.2)",blackAlpha42:"rgba(0, 0, 0, 0.42)",blackAlpha50:"rgba(0, 0, 0, 0.5)",blackAlpha60:"rgba(0, 0, 0, 0.6)",blackAlpha85:"rgba(0, 0, 0, 0.85)",red47:"hsl(12, 68%, 47%)",red47Alpha20:"hsla(12, 68%, 47%, 0.2)",red47Alpha40:"hsla(12, 68%, 47%, 0.4)",red47Alpha60:"hsla(12, 68%, 47%, 0.6)",red85:"hsl(0, 55%, 85%)",yellow88:"hsl(42, 100%, 88%)",blue83:"hsl(200, 100%, 83%)",blue63:"hsl(200, 100%, 63%)",blue63Alpha10:"hsla(200, 100%, 63%, 0.1)",blue63Alpha20:"hsla(200, 100%, 63%, 0.2)",blue63Alpha80:"hsla(200, 100%, 63%, 0.8)",blue53:"hsl(200, 100%, 53%)",blue53Alpha20:"hsl(200, 100%, 53%, 0.2)",blue43:"hsl(200, 100%, 43%)",green85:"hsl(150, 61%, 85%)",green75:"hsl(150, 72%, 75%)",green60:"hsl(150, 73%, 60%)",green45:"hsl(150, 72%, 45%)"},GL={parameterNameWidth:120,scrollbarsSize:10},$L="-apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol",ZL={defaultFont12:`400 12px/16px ${$L}`,defaultFont14:`400 14px/20px ${$L}`,defaultFont16:`400 16px/24px ${$L}`,monospaceFont14:'400 14px/18px "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace'};const qL=new class{constructor(){this.element=document.createElement("style"),this.color=WL,this.font=ZL,this.dimension=GL,this.sheet=new zL("_")}updateStyleElement(){this.element.textContent=this.sheet.getStyles()}classes(e){const t={};for(const n in e){if(e[n]){const i=this.sheet.registerStyle({$unique:!0,$displayName:n,...e[n]});t[n]="."+i}}return this.updateStyleElement(),t}addRule(e,t){const n=this.sheet.registerStyle({$unique:!0,$global:!0,[e]:t});return this.updateStyleElement(),n}},KL=(e,t,n,i,r)=>{const s=e.clone().invert(),o=new It(0,0).affineTransform(s),a=n.clone().affineTransform(s),{interval:l,subdivisions:c}=YL(t,i),h=o.clone().divScalar(l).floor().mulScalar(l),u=a.clone().divScalar(l).ceil().mulScalar(l),d=(t,n)=>{const i=t.clone().affineTransform(e),s=n.clone().affineTransform(e);r.moveTo(i.x,i.y),r.lineTo(s.x,s.y)};r.lineCap="butt",r.lineWidth=1.5,r.beginPath();for(let p=h.x;p<u.x;p+=l)for(let e=1;e<c;e++){const t=p+e*l/c;d(new It(t,h.y),new It(t,u.y))}for(let p=h.y;p<u.y;p+=l)for(let e=1;e<c;e++){const t=p+e*l/c;d(new It(h.x,t),new It(u.x,t))}r.strokeStyle=qL.color.gray96,r.stroke(),r.beginPath();for(let p=h.x;p<u.x;p+=l)if(0!==p){d(new It(p,h.y),new It(p,u.y))}for(let p=h.y;p<u.y;p+=l)if(0!==p){d(new It(h.x,p),new It(u.x,p))}r.strokeStyle=qL.color.gray91,r.stroke(),r.beginPath(),d(new It(h.x,0),new It(u.x,0)),d(new It(0,h.y),new It(0,u.y)),r.strokeStyle=qL.color.gray70,r.stroke()},YL=(e,t)=>{const n=90/e.pixelsPerUnit;return"fractional"===t&&n<1?JL(n):XL(n)},XL=e=>{let t=Math.pow(10,Math.ceil(Math.log(e)/Math.log(10)));return t/2>1.75*e&&(t/=2),{interval:t,subdivisions:10}},JL=e=>({interval:Math.pow(4,Math.ceil(Math.log(e)/Math.log(4))),subdivisions:8});var QL,eE={exports:{}};var tE,nE=(QL||(QL=1,tE=eE,function(){function e(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function t(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){o(i.response,t,n)},i.onerror=function(){console.error("could not download file")},i.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof N&&N.global===N?N:void 0,s=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,s,o){var a=r.URL||r.webkitURL,l=document.createElement("a");s=s||e.name||"download",l.download=s,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):n(l.href)?t(e,s,o):i(l,l.target="_blank")):(l.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(l.href)},4e4),setTimeout(function(){i(l)},0))}:"msSaveOrOpenBlob"in navigator?function(r,s,o){if(s=s||r.name||"download","string"!=typeof r)navigator.msSaveOrOpenBlob(e(r,o),s);else if(n(r))t(r,s,o);else{var a=document.createElement("a");a.href=r,a.target="_blank",setTimeout(function(){i(a)})}}:function(e,n,i,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,i);var a="application/octet-stream"===e.type,l=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||a&&l||s)&&"undefined"!=typeof FileReader){var h=new FileReader;h.onloadend=function(){var e=h.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},h.readAsDataURL(e)}else{var u=r.URL||r.webkitURL,d=u.createObjectURL(e);o?o.location=d:location.href=d,o=null,setTimeout(function(){u.revokeObjectURL(d)},4e4)}});r.saveAs=o.saveAs=o,tE.exports=o}()),eE.exports);const iE=D(nE);function rE(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sE,oE={exports:{}};
/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var aE=(sE||(sE=1,oE.exports=function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){if(!a&&rE)return rE(o);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){return r(t[o][1][e]||e)},c,c.exports,e,t,n,i)}return n[o].exports}for(var s=rE,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){var i=e("./utils"),r=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,r,o,a,l,c,h=[],u=0,d=e.length,p=d,f="string"!==i.getTypeOf(e);u<e.length;)p=d-u,r=f?(t=e[u++],n=u<d?e[u++]:0,u<d?e[u++]:0):(t=e.charCodeAt(u++),n=u<d?e.charCodeAt(u++):0,u<d?e.charCodeAt(u++):0),o=t>>2,a=(3&t)<<4|n>>4,l=1<p?(15&n)<<2|r>>6:64,c=2<p?63&r:64,h.push(s.charAt(o)+s.charAt(a)+s.charAt(l)+s.charAt(c));return h.join("")},n.decode=function(e){var t,n,i,o,a,l,c=0,h=0,u="data:";if(e.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var d,p=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===s.charAt(64)&&p--,e.charAt(e.length-2)===s.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=r.uint8array?new Uint8Array(0|p):new Array(0|p);c<e.length;)t=s.indexOf(e.charAt(c++))<<2|(o=s.indexOf(e.charAt(c++)))>>4,n=(15&o)<<4|(a=s.indexOf(e.charAt(c++)))>>2,i=(3&a)<<6|(l=s.indexOf(e.charAt(c++))),d[h++]=t,64!==a&&(d[h++]=n),64!==l&&(d[h++]=i);return d}},{"./support":30,"./utils":32}],2:[function(e,t,n){var i=e("./external"),r=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function a(e,t,n,i,r){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=i,this.compressedContent=r}a.prototype={getContentWorker:function(){var e=new r(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new r(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(e,t,n){return e.pipe(new s).pipe(new o("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){var i=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){var i=e("./utils"),r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==i.getTypeOf(e)?function(e,t,n,i){var s=r,o=i+n;e^=-1;for(var a=i;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}(0|t,e,e.length,0):function(e,t,n,i){var s=r,o=i+n;e^=-1;for(var a=i;a<o;a++)e=e>>>8^s[255&(e^t.charCodeAt(a))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){var i=null;i="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:i}},{lie:37}],7:[function(e,t,n){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=e("pako"),s=e("./utils"),o=e("./stream/GenericWorker"),a=i?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",s.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(a,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){function i(e,t){var n,i="";for(n=0;n<t;n++)i+=String.fromCharCode(255&e),e>>>=8;return i}function r(e,t,n,r,o,h){var u,d,p=e.file,f=e.compression,m=h!==a.utf8encode,g=s.transformTo("string",h(p.name)),v=s.transformTo("string",a.utf8encode(p.name)),y=p.comment,b=s.transformTo("string",h(y)),w=s.transformTo("string",a.utf8encode(y)),x=v.length!==p.name.length,C=w.length!==y.length,S="",k="",L="",E=p.dir,P=p.date,T={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(T.crc32=e.crc32,T.compressedSize=e.compressedSize,T.uncompressedSize=e.uncompressedSize);var A=0;t&&(A|=8),m||!x&&!C||(A|=2048);var M,I,_,O=0,N=0;E&&(O|=16),"UNIX"===o?(N=798,O|=(M=p.unixPermissions,I=E,_=M,M||(_=I?16893:33204),(65535&_)<<16)):(N=20,O|=function(e){return 63&(e||0)}(p.dosPermissions)),u=P.getUTCHours(),u<<=6,u|=P.getUTCMinutes(),u<<=5,u|=P.getUTCSeconds()/2,d=P.getUTCFullYear()-1980,d<<=4,d|=P.getUTCMonth()+1,d<<=5,d|=P.getUTCDate(),x&&(k=i(1,1)+i(l(g),4)+v,S+="up"+i(k.length,2)+k),C&&(L=i(1,1)+i(l(b),4)+w,S+="uc"+i(L.length,2)+L);var D="";return D+="\n\0",D+=i(A,2),D+=f.magic,D+=i(u,2),D+=i(d,2),D+=i(T.crc32,4),D+=i(T.compressedSize,4),D+=i(T.uncompressedSize,4),D+=i(g.length,2),D+=i(S.length,2),{fileRecord:c.LOCAL_FILE_HEADER+D+g+S,dirRecord:c.CENTRAL_FILE_HEADER+i(N,2)+D+i(b.length,2)+"\0\0\0\0"+i(O,4)+i(r,4)+g+S+b}}var s=e("../utils"),o=e("../stream/GenericWorker"),a=e("../utf8"),l=e("../crc32"),c=e("../signature");function h(e,t,n,i){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(h,o),h.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-i-1))/n:100}}))},h.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=r(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(e){this.accumulate=!1;var t,n=this.streamFiles&&!e.file.dir,s=r(e,n,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(s.dirRecord),n)this.push({data:(t=e,c.DATA_DESCRIPTOR+i(t.crc32,4)+i(t.compressedSize,4)+i(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:s.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n,r,o,a,l,h,u=this.bytesWritten-e,d=(n=this.dirRecords.length,r=u,o=e,a=this.zipComment,l=this.encodeFileName,h=s.transformTo("string",l(a)),c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(n,2)+i(n,2)+i(r,4)+i(o,4)+i(h.length,2)+h);this.push({data:d,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},h.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(i){}return!0},h.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){var i=e("../compressions"),r=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var s=new r(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var r=function(e,t){var n=e||t,r=i[n];if(!r)throw new Error(n+" is not a valid compression method !");return r}(n.options.compression,t.compression),a=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(r,a).withStreamInfo("file",{name:e,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(s)}),s.entriesCount=o}catch(a){s.error(a)}return s}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(e,t){return(new i).loadAsync(e,t)},i.external=e("./external"),t.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){var i=e("./utils"),r=e("./external"),s=e("./utf8"),o=e("./zipEntries"),a=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new r.Promise(function(t,n){var i=e.decompressed.getContentWorker().pipe(new a);i.on("error",function(e){n(e)}).on("end",function(){i.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=i.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(e)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new o(t);return n.load(e),n}).then(function(e){var n=[r.Promise.resolve(e)],i=e.files;if(t.checkCRC32)for(var s=0;s<i.length;s++)n.push(c(i[s]));return r.Promise.all(n)}).then(function(e){for(var r=e.shift(),s=r.files,o=0;o<s.length;o++){var a=s[o],l=a.fileNameStr,c=i.resolve(a.fileNameStr);n.file(c,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders}),a.dir||(n.file(c).unsafeOriginalName=l)}return r.zipComment.length&&(n.comment=r.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){var i=e("../utils"),r=e("../stream/GenericWorker");function s(e,t){r.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}i.inherits(s,r),s.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},s.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){var i=e("readable-stream").Readable;function r(e,t,n){i.call(this,t),this._helper=e;var r=this;e.on("data",function(e,t){r.push(e)||r._helper.pause(),n&&n(t)}).on("error",function(e){r.emit("error",e)}).on("end",function(){r.push(null)})}e("../utils").inherits(r,i),r.prototype._read=function(){this._helper.resume()},t.exports=r},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){function i(e,t,n){var i,r=s.getTypeOf(t),a=s.extend(n||{},l);a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),"string"==typeof a.unixPermissions&&(a.unixPermissions=parseInt(a.unixPermissions,8)),a.unixPermissions&&16384&a.unixPermissions&&(a.dir=!0),a.dosPermissions&&16&a.dosPermissions&&(a.dir=!0),a.dir&&(e=m(e)),a.createFolders&&(i=f(e))&&g.call(this,i,!0);var u="string"===r&&!1===a.binary&&!1===a.base64;n&&void 0!==n.binary||(a.binary=!u),(t instanceof c&&0===t.uncompressedSize||a.dir||!t||0===t.length)&&(a.base64=!1,a.binary=!0,t="",a.compression="STORE",r="string");var v=null;v=t instanceof c||t instanceof o?t:d.isNode&&d.isStream(t)?new p(e,t):s.prepareContent(e,t,a.binary,a.optimizedBinaryString,a.base64);var y=new h(e,v,a);this.files[e]=y}var r=e("./utf8"),s=e("./utils"),o=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),h=e("./zipObject"),u=e("./generate"),d=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),f=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||i.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,i;for(t in this.files)i=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,i)},filter:function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(i)}),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,i.call(this,e,t,n),this;if(v(e)){var r=e;return this.filter(function(e,t){return!t.dir&&r.test(e)})}var s=this.files[this.root+e];return s&&!s.dir?s:null},folder:function(e){if(!e)return this;if(v(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=g.call(this,t),i=this.clone();return i.root=n.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=s.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");s.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var i=n.comment||this.comment||"";t=u.generateWorker(this,n,i)}catch(l){(t=new o("error")).error(l)}return new a(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){var i=e("./DataReader");function r(e){i.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(r,i),r.prototype.byteAt=function(e){return this.data[this.zero+e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===t&&this.data[s+1]===n&&this.data[s+2]===i&&this.data[s+3]===r)return s-this.zero;return-1},r.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&n===s[1]&&i===s[2]&&r===s[3]},r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){var i=e("../utils");function r(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=r},{"../utils":32}],19:[function(e,t,n){var i=e("./Uint8ArrayReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){var i=e("./DataReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},r.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){var i=e("./ArrayReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){var i=e("../utils"),r=e("../support"),s=e("./ArrayReader"),o=e("./StringReader"),a=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=i.getTypeOf(e);return i.checkSupport(t),"string"!==t||r.uint8array?"nodebuffer"===t?new a(e):r.uint8array?new l(i.transformTo("uint8array",e)):new s(i.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){var i=e("./GenericWorker"),r=e("../utils");function s(e){i.call(this,"ConvertWorker to "+e),this.destType=e}r.inherits(s,i),s.prototype.processChunk=function(e){this.push({data:r.transformTo(this.destType,e.data),meta:e.meta})},t.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){var i=e("./GenericWorker"),r=e("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,i),s.prototype.processChunk=function(e){this.streamInfo.crc32=r(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){var i=e("../utils"),r=e("./GenericWorker");function s(e){r.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}i.inherits(s,r),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}r.prototype.processChunk.call(this,e)},t.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){var i=e("../utils"),r=e("./GenericWorker");function s(e){r.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=i.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}i.inherits(s,r),s.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){function i(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=i},{}],29:[function(e,t,n){var i=e("../utils"),r=e("./ConvertWorker"),s=e("./GenericWorker"),o=e("../base64"),a=e("../support"),l=e("../external"),c=null;if(a.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(d){}function h(e,t){return new l.Promise(function(n,r){var s=[],a=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",function(e,n){s.push(e),t&&t(n)}).on("error",function(e){s=[],r(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return i.newBlob(i.transformTo("arraybuffer",t),n);case"base64":return o.encode(t);default:return i.transformTo(e,t)}}(l,function(e,t){var n,i=0,r=null,s=0;for(n=0;n<t.length;n++)s+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(r=new Uint8Array(s),n=0;n<t.length;n++)r.set(t[n],i),i+=t[n].length;return r;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(a,s),c);n(e)}catch(t){r(t)}s=[]}).resume()})}function u(e,t,n){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=n,i.checkSupport(o),this._worker=e.pipe(new r(o)),e.lock()}catch(a){this._worker=new s("error"),this._worker.error(a)}}u.prototype={accumulate:function(e){return h(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){i.delay(t,arguments,n)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var i=new ArrayBuffer(0);try{n.blob=0===new Blob([i],{type:"application/zip"}).size}catch(s){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),n.blob=0===r.getBlob("application/zip").size}catch(o){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(s){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){for(var i=e("./utils"),r=e("./support"),s=e("./nodejsUtils"),o=e("./stream/GenericWorker"),a=new Array(256),l=0;l<256;l++)a[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){o.call(this,"utf-8 decode"),this.leftOver=null}function h(){o.call(this,"utf-8 encode")}a[254]=a[254]=1,n.utf8encode=function(e){return r.nodebuffer?s.newBufferFrom(e,"utf-8"):function(e){var t,n,i,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=r.uint8array?new Uint8Array(l):new Array(l),s=o=0;o<l;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t}(e)},n.utf8decode=function(e){return r.nodebuffer?i.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,r,s,o=e.length,l=new Array(2*o);for(t=n=0;t<o;)if((r=e[t++])<128)l[n++]=r;else if(4<(s=a[r]))l[n++]=65533,t+=s-1;else{for(r&=2===s?31:3===s?15:7;1<s&&t<o;)r=r<<6|63&e[t++],s--;1<s?l[n++]=65533:r<65536?l[n++]=r:(r-=65536,l[n++]=55296|r>>10&1023,l[n++]=56320|1023&r)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),i.applyFromCharCode(l)}(e=i.transformTo(r.uint8array?"uint8array":"array",e))},i.inherits(c,o),c.prototype.processChunk=function(e){var t=i.transformTo(r.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var s=t;(t=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),t.set(s,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}(t),l=t;o!==t.length&&(r.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,i.inherits(h,o),h.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){var i=e("./support"),r=e("./base64"),s=e("./nodejsUtils"),o=e("./external");function a(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(r){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(e),i.getBlob(t)}catch(s){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,n){var i=[],r=0,s=e.length;if(s<=n)return String.fromCharCode.apply(null,e);for(;r<s;)"array"===t||"nodebuffer"===t?i.push(String.fromCharCode.apply(null,e.slice(r,Math.min(r+n,s)))):i.push(String.fromCharCode.apply(null,e.subarray(r,Math.min(r+n,s)))),r+=n;return i.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(e){return!1}}()}};function h(e){var t=65536,i=n.getTypeOf(e),r=!0;if("uint8array"===i?r=c.applyCanBeUsed.uint8array:"nodebuffer"===i&&(r=c.applyCanBeUsed.nodebuffer),r)for(;1<t;)try{return c.stringifyByChunk(e,i,t)}catch(s){t=Math.floor(t/2)}return c.stringifyByChar(e)}function u(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=h;var d={};d.string={string:a,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return d.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,s.allocBuffer(e.length))}},d.array={string:h,array:a,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(e)}},d.arraybuffer={string:function(e){return h(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:a,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(new Uint8Array(e))}},d.uint8array={string:h,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:a,nodebuffer:function(e){return s.newBufferFrom(e)}},d.nodebuffer={string:h,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return d.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:a},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var i=n.getTypeOf(t);return d[i][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],i=0;i<t.length;i++){var r=t[i];"."===r||""===r&&0!==i&&i!==t.length-1||(".."===r?n.pop():n.push(r))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":i.nodebuffer&&s.isBuffer(e)?"nodebuffer":i.uint8array&&e instanceof Uint8Array?"uint8array":i.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!i[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,i="";for(n=0;n<(e||"").length;n++)i+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return i},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,s,a,c){return o.Promise.resolve(t).then(function(e){return i.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise(function(t,n){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){n(e.target.error)},i.readAsArrayBuffer(e)}):e}).then(function(t){var h,u=n.getTypeOf(t);return u?("arraybuffer"===u?t=n.transformTo("uint8array",t):"string"===u&&(c?t=r.decode(t):s&&!0!==a&&(t=l(h=t,i.uint8array?new Uint8Array(h.length):new Array(h.length)))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){var i=e("./reader/readerFor"),r=e("./utils"),s=e("./signature"),o=e("./zipEntry"),a=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(t)+", expected "+r.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4)===t;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=a.uint8array?"uint8array":"array",n=r.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=t-n;if(0<i)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=i(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){var i=e("./reader/readerFor"),r=e("./utils"),s=e("./compressedObject"),o=e("./crc32"),a=e("./utf8"),l=e("./compressions"),c=e("./support");function h(e,t){this.options=e,this.loadOptions=t}h.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,i,r=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<r;)t=e.readInt(2),n=e.readInt(2),i=e.readData(n),this.extraFields[t]={id:t,length:n,value:i};e.setIndex(r)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=r.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var s=r.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=i(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=i(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null}},t.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){function i(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var r=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),o=e("./utf8"),a=e("./compressedObject"),l=e("./stream/GenericWorker");i.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var i="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var s=!this._dataBinary;s&&!i&&(t=t.pipe(new o.Utf8EncodeWorker)),!s&&i&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(a){(t=new l("error")).error(a)}return new r(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof l?this._data:new s(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)i.prototype[c[u]]=h;t.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){var n,i,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var s=0,o=new r(h),a=e.document.createTextNode("");o.observe(a,{characterData:!0}),n=function(){a.data=s=++s%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){h(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(h,0)};else{var l=new e.MessageChannel;l.port1.onmessage=h,n=function(){l.port2.postMessage(0)}}var c=[];function h(){var e,t;i=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}i=!1}t.exports=function(e){1!==c.push(e)||i||n()}}).call(this,void 0!==N?N:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){var i=e("immediate");function r(){}var s={},o=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==r&&p(this,e)}function h(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(e,t,n){i(function(){var i;try{i=t(n)}catch(r){return s.reject(e,r)}i===e?s.reject(e,new TypeError("Cannot resolve promise with itself")):s.resolve(e,i)})}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function i(t){n||(n=!0,s.reject(e,t))}function r(t){n||(n=!0,s.resolve(e,t))}var o=f(function(){t(r,i)});"error"===o.status&&i(o.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(i){n.status="error",n.value=i}return n}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(r);return this.state!==l?u(n,this.state===a?e:t,this.outcome):this.queue.push(new h(n,e,t)),n},h.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},h.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},h.prototype.callRejected=function(e){s.reject(this.promise,e)},h.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},s.resolve=function(e,t){var n=f(d,t);if("error"===n.status)return s.reject(e,n.value);var i=n.value;if(i)p(e,i);else{e.state=a,e.outcome=t;for(var r=-1,o=e.queue.length;++r<o;)e.queue[r].callFulfilled(t)}return e},s.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:s.resolve(new this(r),e)},c.reject=function(e){var t=new this(r);return s.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var o=new Array(n),a=0,l=-1,c=new this(r);++l<n;)h(e[l],l);return c;function h(e,r){t.resolve(e).then(function(e){o[r]=e,++a!==n||i||(i=!0,s.resolve(c,o))},function(e){i||(i=!0,s.reject(c,e))})}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var o,a=-1,l=new this(r);++a<n;)o=e[a],t.resolve(o).then(function(e){i||(i=!0,s.resolve(l,e))},function(e){i||(i=!0,s.reject(l,e))});return l}},{immediate:36}],38:[function(e,t,n){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){var i=e("./zlib/deflate"),r=e("./utils/common"),s=e("./utils/strings"),o=e("./zlib/messages"),a=e("./zlib/zstream"),l=Object.prototype.toString,c=0,h=-1,u=0,d=8;function p(e){if(!(this instanceof p))return new p(e);this.options=r.assign({level:h,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==c)throw new Error(o[n]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var f;if(f="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=i.deflateSetDictionary(this.strm,f))!==c)throw new Error(o[n]);this._dict_set=!0}}function f(e,t){var n=new p(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}p.prototype.push=function(e,t){var n,o,a=this.strm,h=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new r.Buf8(h),a.next_out=0,a.avail_out=h),1!==(n=i.deflate(a,o))&&n!==c)return this.onEnd(n),!(this.ended=!0);0!==a.avail_out&&(0!==a.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(s.buf2binstring(r.shrinkBuf(a.output,a.next_out))):this.onData(r.shrinkBuf(a.output,a.next_out)))}while((0<a.avail_in||0===a.avail_out)&&1!==n);return 4===o?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c):2!==o||(this.onEnd(c),!(a.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=p,n.deflate=f,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,f(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){var i=e("./zlib/inflate"),r=e("./utils/common"),s=e("./utils/strings"),o=e("./zlib/constants"),a=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),h=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw new Error(a[n]);this.header=new c,i.inflateGetHeader(this.strm,this.header)}function d(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}u.prototype.push=function(e,t){var n,a,l,c,u,d,p=this.strm,f=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?p.input=s.binstring2buf(e):"[object ArrayBuffer]"===h.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new r.Buf8(f),p.next_out=0,p.avail_out=f),(n=i.inflate(p,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(d="string"==typeof m?s.string2buf(m):"[object ArrayBuffer]"===h.call(m)?new Uint8Array(m):m,n=i.inflateSetDictionary(this.strm,d)),n===o.Z_BUF_ERROR&&!0===g&&(n=o.Z_OK,g=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),!(this.ended=!0);p.next_out&&(0!==p.avail_out&&n!==o.Z_STREAM_END&&(0!==p.avail_in||a!==o.Z_FINISH&&a!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=s.utf8border(p.output,p.next_out),c=p.next_out-l,u=s.buf2string(p.output,l),p.next_out=c,p.avail_out=f-c,c&&r.arraySet(p.output,p.output,l,c,0),this.onData(u)):this.onData(r.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(g=!0)}while((0<p.avail_in||0===p.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(a=o.Z_FINISH),a===o.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):a!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(p.avail_out=0))},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=u,n.inflate=d,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},n.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var s=0;s<i;s++)e[r+s]=t[n+s]},flattenChunks:function(e){var t,n,i,r,s,o;for(t=i=0,n=e.length;t<n;t++)i+=e[t].length;for(o=new Uint8Array(i),t=r=0,n=e.length;t<n;t++)s=e[t],o.set(s,r),r+=s.length;return o}},s={arraySet:function(e,t,n,i,r){for(var s=0;s<i;s++)e[r+s]=t[n+s]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,s))},n.setTyped(i)},{}],42:[function(e,t,n){var i=e("./common"),r=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(c){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){s=!1}for(var o=new i.Buf8(256),a=0;a<256;a++)o[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function l(e,t){if(t<65537&&(e.subarray&&s||!e.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,n.string2buf=function(e){var t,n,r,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(l),s=o=0;o<l;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,i,r,s,a=t||e.length,c=new Array(2*a);for(n=i=0;n<a;)if((r=e[n++])<128)c[i++]=r;else if(4<(s=o[r]))c[i++]=65533,n+=s-1;else{for(r&=2===s?31:3===s?15:7;1<s&&n<a;)r=r<<6|63&e[n++],s--;1<s?c[i++]=65533:r<65536?c[i++]=r:(r-=65536,c[i++]=55296|r>>10&1023,c[i++]=56320|1023&r)}return l(c,i)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+o[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){t.exports=function(e,t,n,i){for(var r=65535&e,s=e>>>16&65535,o=0;0!==n;){for(n-=o=2e3<n?2e3:n;s=s+(r=r+t[i++]|0)|0,--o;);r%=65521,s%=65521}return r|s<<16}},{}],44:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,r){var s=i,o=r+n;e^=-1;for(var a=r;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}},{}],46:[function(e,t,n){var i,r=e("../utils/common"),s=e("./trees"),o=e("./adler32"),a=e("./crc32"),l=e("./messages"),c=0,h=4,u=0,d=-2,p=-1,f=4,m=2,g=8,v=9,y=286,b=30,w=19,x=2*y+1,C=15,S=3,k=258,L=k+S+1,E=42,P=113,T=1,A=2,M=3,I=4;function _(e,t){return e.msg=l[t],t}function O(e){return(e<<1)-(4<e?9:0)}function N(e){for(var t=e.length;0<=--t;)e[t]=0}function D(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function R(e,t){s._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,D(e.strm)}function F(e,t){e.pending_buf[e.pending++]=t}function B(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function V(e,t){var n,i,r=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-L?e.strstart-(e.w_size-L):0,c=e.window,h=e.w_mask,u=e.prev,d=e.strstart+k,p=c[s+o-1],f=c[s+o];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do{if(c[(n=t)+o]===f&&c[n+o-1]===p&&c[n]===c[s]&&c[++n]===c[s+1]){s+=2,n++;do{}while(c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&s<d);if(i=k-(d-s),s=d-k,o<i){if(e.match_start=t,a<=(o=i))break;p=c[s+o-1],f=c[s+o]}}}while((t=u[t&h])>l&&0!=--r);return o<=e.lookahead?o:e.lookahead}function j(e){var t,n,i,s,l,c,h,u,d,p,f=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-L)){for(r.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=n=e.hash_size;i=e.head[--t],e.head[t]=f<=i?i-f:0,--n;);for(t=n=f;i=e.prev[--t],e.prev[t]=f<=i?i-f:0,--n;);s+=f}if(0===e.strm.avail_in)break;if(c=e.strm,h=e.window,u=e.strstart+e.lookahead,p=void 0,(d=s)<(p=c.avail_in)&&(p=d),n=0===p?0:(c.avail_in-=p,r.arraySet(h,c.input,c.next_in,p,u),1===c.state.wrap?c.adler=o(c.adler,h,p,u):2===c.state.wrap&&(c.adler=a(c.adler,h,p,u)),c.next_in+=p,c.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=S)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+S-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<S)););}while(e.lookahead<L&&0!==e.strm.avail_in)}function H(e,t){for(var n,i;;){if(e.lookahead<L){if(j(e),e.lookahead<L&&t===c)return T;if(0===e.lookahead)break}if(n=0,e.lookahead>=S&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-L&&(e.match_length=V(e,n)),e.match_length>=S)if(i=s._tr_tally(e,e.strstart-e.match_start,e.match_length-S),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=S){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(R(e,!1),0===e.strm.avail_out))return T}return e.insert=e.strstart<S-1?e.strstart:S-1,t===h?(R(e,!0),0===e.strm.avail_out?M:I):e.last_lit&&(R(e,!1),0===e.strm.avail_out)?T:A}function U(e,t){for(var n,i,r;;){if(e.lookahead<L){if(j(e),e.lookahead<L&&t===c)return T;if(0===e.lookahead)break}if(n=0,e.lookahead>=S&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=S-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-L&&(e.match_length=V(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===S&&4096<e.strstart-e.match_start)&&(e.match_length=S-1)),e.prev_length>=S&&e.match_length<=e.prev_length){for(r=e.strstart+e.lookahead-S,i=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-S),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=S-1,e.strstart++,i&&(R(e,!1),0===e.strm.avail_out))return T}else if(e.match_available){if((i=s._tr_tally(e,0,e.window[e.strstart-1]))&&R(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return T}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<S-1?e.strstart:S-1,t===h?(R(e,!0),0===e.strm.avail_out?M:I):e.last_lit&&(R(e,!1),0===e.strm.avail_out)?T:A}function z(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function W(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*x),this.dyn_dtree=new r.Buf16(2*(2*b+1)),this.bl_tree=new r.Buf16(2*(2*w+1)),N(this.dyn_ltree),N(this.dyn_dtree),N(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(C+1),this.heap=new r.Buf16(2*y+1),N(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*y+1),N(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function G(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=m,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?E:P,e.adler=2===t.wrap?0:1,t.last_flush=c,s._tr_init(t),u):_(e,d)}function $(e){var t,n=G(e);return n===u&&((t=e.state).window_size=2*t.w_size,N(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=S-1,t.match_available=0,t.ins_h=0),n}function Z(e,t,n,i,s,o){if(!e)return d;var a=1;if(t===p&&(t=6),i<0?(a=0,i=-i):15<i&&(a=2,i-=16),s<1||v<s||n!==g||i<8||15<i||t<0||9<t||o<0||f<o)return _(e,d);8===i&&(i=9);var l=new W;return(e.state=l).strm=e,l.wrap=a,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+S-1)/S),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,$(e)}i=[new z(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(j(e),0===e.lookahead&&t===c)return T;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,R(e,!1),0===e.strm.avail_out))return T;if(e.strstart-e.block_start>=e.w_size-L&&(R(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===h?(R(e,!0),0===e.strm.avail_out?M:I):(e.strstart>e.block_start&&(R(e,!1),e.strm.avail_out),T)}),new z(4,4,8,4,H),new z(4,5,16,8,H),new z(4,6,32,32,H),new z(4,4,16,16,U),new z(8,16,32,32,U),new z(8,16,128,128,U),new z(8,32,128,256,U),new z(32,128,258,1024,U),new z(32,258,258,4096,U)],n.deflateInit=function(e,t){return Z(e,t,g,15,8,0)},n.deflateInit2=Z,n.deflateReset=$,n.deflateResetKeep=G,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?d:(e.state.gzhead=t,u):d},n.deflate=function(e,t){var n,r,o,l;if(!e||!e.state||5<t||t<0)return e?_(e,d):d;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||666===r.status&&t!==h)return _(e,0===e.avail_out?-5:d);if(r.strm=e,n=r.last_flush,r.last_flush=t,r.status===E)if(2===r.wrap)e.adler=0,F(r,31),F(r,139),F(r,8),r.gzhead?(F(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),F(r,255&r.gzhead.time),F(r,r.gzhead.time>>8&255),F(r,r.gzhead.time>>16&255),F(r,r.gzhead.time>>24&255),F(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),F(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(F(r,255&r.gzhead.extra.length),F(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=a(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(F(r,0),F(r,0),F(r,0),F(r,0),F(r,0),F(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),F(r,3),r.status=P);else{var p=g+(r.w_bits-8<<4)<<8;p|=(2<=r.strategy||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(p|=32),p+=31-p%31,r.status=P,B(r,p),0!==r.strstart&&(B(r,e.adler>>>16),B(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(o=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),D(e),o=r.pending,r.pending!==r.pending_buf_size));)F(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),D(e),o=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,F(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),D(e),o=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,F(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),0===l&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&D(e),r.pending+2<=r.pending_buf_size&&(F(r,255&e.adler),F(r,e.adler>>8&255),e.adler=0,r.status=P)):r.status=P),0!==r.pending){if(D(e),0===e.avail_out)return r.last_flush=-1,u}else if(0===e.avail_in&&O(t)<=O(n)&&t!==h)return _(e,-5);if(666===r.status&&0!==e.avail_in)return _(e,-5);if(0!==e.avail_in||0!==r.lookahead||t!==c&&666!==r.status){var f=2===r.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(j(e),0===e.lookahead)){if(t===c)return T;break}if(e.match_length=0,n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(R(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===h?(R(e,!0),0===e.strm.avail_out?M:I):e.last_lit&&(R(e,!1),0===e.strm.avail_out)?T:A}(r,t):3===r.strategy?function(e,t){for(var n,i,r,o,a=e.window;;){if(e.lookahead<=k){if(j(e),e.lookahead<=k&&t===c)return T;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=S&&0<e.strstart&&(i=a[r=e.strstart-1])===a[++r]&&i===a[++r]&&i===a[++r]){o=e.strstart+k;do{}while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<o);e.match_length=k-(o-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=S?(n=s._tr_tally(e,1,e.match_length-S),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(R(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===h?(R(e,!0),0===e.strm.avail_out?M:I):e.last_lit&&(R(e,!1),0===e.strm.avail_out)?T:A}(r,t):i[r.level].func(r,t);if(f!==M&&f!==I||(r.status=666),f===T||f===M)return 0===e.avail_out&&(r.last_flush=-1),u;if(f===A&&(1===t?s._tr_align(r):5!==t&&(s._tr_stored_block(r,0,0,!1),3===t&&(N(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),D(e),0===e.avail_out))return r.last_flush=-1,u}return t!==h?u:r.wrap<=0?1:(2===r.wrap?(F(r,255&e.adler),F(r,e.adler>>8&255),F(r,e.adler>>16&255),F(r,e.adler>>24&255),F(r,255&e.total_in),F(r,e.total_in>>8&255),F(r,e.total_in>>16&255),F(r,e.total_in>>24&255)):(B(r,e.adler>>>16),B(r,65535&e.adler)),D(e),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending?u:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==E&&69!==t&&73!==t&&91!==t&&103!==t&&t!==P&&666!==t?_(e,d):(e.state=null,t===P?_(e,-3):u):d},n.deflateSetDictionary=function(e,t){var n,i,s,a,l,c,h,p,f=t.length;if(!e||!e.state)return d;if(2===(a=(n=e.state).wrap)||1===a&&n.status!==E||n.lookahead)return d;for(1===a&&(e.adler=o(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===a&&(N(n.head),n.strstart=0,n.block_start=0,n.insert=0),p=new r.Buf8(n.w_size),r.arraySet(p,t,f-n.w_size,n.w_size,0),t=p,f=n.w_size),l=e.avail_in,c=e.next_in,h=e.input,e.avail_in=f,e.next_in=0,e.input=t,j(n);n.lookahead>=S;){for(i=n.strstart,s=n.lookahead-(S-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+S-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++,--s;);n.strstart=i,n.lookahead=S-1,j(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=S-1,n.match_available=0,e.next_in=c,e.input=h,e.avail_in=l,n.wrap=a,u},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){t.exports=function(e,t){var n,i,r,s,o,a,l,c,h,u,d,p,f,m,g,v,y,b,w,x,C,S,k,L,E;n=e.state,i=e.next_in,L=e.input,r=i+(e.avail_in-5),s=e.next_out,E=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=n.dmax,c=n.wsize,h=n.whave,u=n.wnext,d=n.window,p=n.hold,f=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{f<15&&(p+=L[i++]<<f,f+=8,p+=L[i++]<<f,f+=8),b=m[p&v];t:for(;;){if(p>>>=w=b>>>24,f-=w,0==(w=b>>>16&255))E[s++]=65535&b;else{if(!(16&w)){if(!(64&w)){b=m[(65535&b)+(p&(1<<w)-1)];continue t}if(32&w){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}x=65535&b,(w&=15)&&(f<w&&(p+=L[i++]<<f,f+=8),x+=p&(1<<w)-1,p>>>=w,f-=w),f<15&&(p+=L[i++]<<f,f+=8,p+=L[i++]<<f,f+=8),b=g[p&y];n:for(;;){if(p>>>=w=b>>>24,f-=w,!(16&(w=b>>>16&255))){if(!(64&w)){b=g[(65535&b)+(p&(1<<w)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(C=65535&b,f<(w&=15)&&(p+=L[i++]<<f,(f+=8)<w&&(p+=L[i++]<<f,f+=8)),l<(C+=p&(1<<w)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=w,f-=w,(w=s-o)<C){if(h<(w=C-w)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(k=d,(S=0)===u){if(S+=c-w,w<x){for(x-=w;E[s++]=d[S++],--w;);S=s-C,k=E}}else if(u<w){if(S+=c+u-w,(w-=u)<x){for(x-=w;E[s++]=d[S++],--w;);if(S=0,u<x){for(x-=w=u;E[s++]=d[S++],--w;);S=s-C,k=E}}}else if(S+=u-w,w<x){for(x-=w;E[s++]=d[S++],--w;);S=s-C,k=E}for(;2<x;)E[s++]=k[S++],E[s++]=k[S++],E[s++]=k[S++],x-=3;x&&(E[s++]=k[S++],1<x&&(E[s++]=k[S++]))}else{for(S=s-C;E[s++]=E[S++],E[s++]=E[S++],E[s++]=E[S++],2<(x-=3););x&&(E[s++]=E[S++],1<x&&(E[s++]=E[S++]))}break}}break}}while(i<r&&s<a);i-=x=f>>3,p&=(1<<(f-=x<<3))-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=s<a?a-s+257:257-(s-a),n.hold=p,n.bits=f}},{}],49:[function(e,t,n){var i=e("../utils/common"),r=e("./adler32"),s=e("./crc32"),o=e("./inffast"),a=e("./inftrees"),l=1,c=2,h=0,u=-2,d=1,p=852,f=592;function m(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=d,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(p),t.distcode=t.distdyn=new i.Buf32(f),t.sane=1,t.back=-1,h):u}function y(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,v(e)):u}function b(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?u:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,y(e))):u}function w(e,t){var n,i;return e?(i=new g,(e.state=i).window=null,(n=b(e,t))!==h&&(e.state=null),n):u}var x,C,S=!0;function k(e){if(S){var t;for(x=new i.Buf32(512),C=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(l,e.lens,0,288,x,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(c,e.lens,0,32,C,0,e.work,{bits:5}),S=!1}e.lencode=x,e.lenbits=9,e.distcode=C,e.distbits=5}function L(e,t,n,r){var s,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new i.Buf8(o.wsize)),r>=o.wsize?(i.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(r<(s=o.wsize-o.wnext)&&(s=r),i.arraySet(o.window,t,n-r,s,o.wnext),(r-=s)?(i.arraySet(o.window,t,n-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0}n.inflateReset=y,n.inflateReset2=b,n.inflateResetKeep=v,n.inflateInit=function(e){return w(e,15)},n.inflateInit2=w,n.inflate=function(e,t){var n,p,f,g,v,y,b,w,x,C,S,E,P,T,A,M,I,_,O,N,D,R,F,B,V=0,j=new i.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return u;12===(n=e.state).mode&&(n.mode=13),v=e.next_out,f=e.output,b=e.avail_out,g=e.next_in,p=e.input,y=e.avail_in,w=n.hold,x=n.bits,C=y,S=b,R=h;e:for(;;)switch(n.mode){case d:if(0===n.wrap){n.mode=13;break}for(;x<16;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}if(2&n.wrap&&35615===w){j[n.check=0]=255&w,j[1]=w>>>8&255,n.check=s(n.check,j,2,0),x=w=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&w)<<8)+(w>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&w)){e.msg="unknown compression method",n.mode=30;break}if(x-=4,D=8+(15&(w>>>=4)),0===n.wbits)n.wbits=D;else if(D>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<D,e.adler=n.check=1,n.mode=512&w?10:12,x=w=0;break;case 2:for(;x<16;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}if(n.flags=w,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=w>>8&1),512&n.flags&&(j[0]=255&w,j[1]=w>>>8&255,n.check=s(n.check,j,2,0)),x=w=0,n.mode=3;case 3:for(;x<32;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}n.head&&(n.head.time=w),512&n.flags&&(j[0]=255&w,j[1]=w>>>8&255,j[2]=w>>>16&255,j[3]=w>>>24&255,n.check=s(n.check,j,4,0)),x=w=0,n.mode=4;case 4:for(;x<16;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}n.head&&(n.head.xflags=255&w,n.head.os=w>>8),512&n.flags&&(j[0]=255&w,j[1]=w>>>8&255,n.check=s(n.check,j,2,0)),x=w=0,n.mode=5;case 5:if(1024&n.flags){for(;x<16;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}n.length=w,n.head&&(n.head.extra_len=w),512&n.flags&&(j[0]=255&w,j[1]=w>>>8&255,n.check=s(n.check,j,2,0)),x=w=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(y<(E=n.length)&&(E=y),E&&(n.head&&(D=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,p,g,E,D)),512&n.flags&&(n.check=s(n.check,p,E,g)),y-=E,g+=E,n.length-=E),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===y)break e;for(E=0;D=p[g+E++],n.head&&D&&n.length<65536&&(n.head.name+=String.fromCharCode(D)),D&&E<y;);if(512&n.flags&&(n.check=s(n.check,p,E,g)),y-=E,g+=E,D)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===y)break e;for(E=0;D=p[g+E++],n.head&&D&&n.length<65536&&(n.head.comment+=String.fromCharCode(D)),D&&E<y;);if(512&n.flags&&(n.check=s(n.check,p,E,g)),y-=E,g+=E,D)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;x<16;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}if(w!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}x=w=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;x<32;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}e.adler=n.check=m(w),x=w=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=v,e.avail_out=b,e.next_in=g,e.avail_in=y,n.hold=w,n.bits=x,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){w>>>=7&x,x-=7&x,n.mode=27;break}for(;x<3;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}switch(n.last=1&w,x-=1,3&(w>>>=1)){case 0:n.mode=14;break;case 1:if(k(n),n.mode=20,6!==t)break;w>>>=2,x-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}w>>>=2,x-=2;break;case 14:for(w>>>=7&x,x-=7&x;x<32;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}if((65535&w)!=(w>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&w,x=w=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(E=n.length){if(y<E&&(E=y),b<E&&(E=b),0===E)break e;i.arraySet(f,p,g,E,v),y-=E,g+=E,b-=E,v+=E,n.length-=E;break}n.mode=12;break;case 17:for(;x<14;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}if(n.nlen=257+(31&w),w>>>=5,x-=5,n.ndist=1+(31&w),w>>>=5,x-=5,n.ncode=4+(15&w),w>>>=4,x-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;x<3;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}n.lens[H[n.have++]]=7&w,w>>>=3,x-=3}for(;n.have<19;)n.lens[H[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,F={bits:n.lenbits},R=a(0,n.lens,0,19,n.lencode,0,n.work,F),n.lenbits=F.bits,R){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;M=(V=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,I=65535&V,!((A=V>>>24)<=x);){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}if(I<16)w>>>=A,x-=A,n.lens[n.have++]=I;else{if(16===I){for(B=A+2;x<B;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}if(w>>>=A,x-=A,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}D=n.lens[n.have-1],E=3+(3&w),w>>>=2,x-=2}else if(17===I){for(B=A+3;x<B;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}x-=A,D=0,E=3+(7&(w>>>=A)),w>>>=3,x-=3}else{for(B=A+7;x<B;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}x-=A,D=0,E=11+(127&(w>>>=A)),w>>>=7,x-=7}if(n.have+E>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;E--;)n.lens[n.have++]=D}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,F={bits:n.lenbits},R=a(l,n.lens,0,n.nlen,n.lencode,0,n.work,F),n.lenbits=F.bits,R){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,F={bits:n.distbits},R=a(c,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,F),n.distbits=F.bits,R){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=y&&258<=b){e.next_out=v,e.avail_out=b,e.next_in=g,e.avail_in=y,n.hold=w,n.bits=x,o(e,S),v=e.next_out,f=e.output,b=e.avail_out,g=e.next_in,p=e.input,y=e.avail_in,w=n.hold,x=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;M=(V=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,I=65535&V,!((A=V>>>24)<=x);){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}if(M&&!(240&M)){for(_=A,O=M,N=I;M=(V=n.lencode[N+((w&(1<<_+O)-1)>>_)])>>>16&255,I=65535&V,!(_+(A=V>>>24)<=x);){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}w>>>=_,x-=_,n.back+=_}if(w>>>=A,x-=A,n.back+=A,n.length=I,0===M){n.mode=26;break}if(32&M){n.back=-1,n.mode=12;break}if(64&M){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&M,n.mode=22;case 22:if(n.extra){for(B=n.extra;x<B;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}n.length+=w&(1<<n.extra)-1,w>>>=n.extra,x-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;M=(V=n.distcode[w&(1<<n.distbits)-1])>>>16&255,I=65535&V,!((A=V>>>24)<=x);){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}if(!(240&M)){for(_=A,O=M,N=I;M=(V=n.distcode[N+((w&(1<<_+O)-1)>>_)])>>>16&255,I=65535&V,!(_+(A=V>>>24)<=x);){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}w>>>=_,x-=_,n.back+=_}if(w>>>=A,x-=A,n.back+=A,64&M){e.msg="invalid distance code",n.mode=30;break}n.offset=I,n.extra=15&M,n.mode=24;case 24:if(n.extra){for(B=n.extra;x<B;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}n.offset+=w&(1<<n.extra)-1,w>>>=n.extra,x-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===b)break e;if(E=S-b,n.offset>E){if((E=n.offset-E)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}P=E>n.wnext?(E-=n.wnext,n.wsize-E):n.wnext-E,E>n.length&&(E=n.length),T=n.window}else T=f,P=v-n.offset,E=n.length;for(b<E&&(E=b),b-=E,n.length-=E;f[v++]=T[P++],--E;);0===n.length&&(n.mode=21);break;case 26:if(0===b)break e;f[v++]=n.length,b--,n.mode=21;break;case 27:if(n.wrap){for(;x<32;){if(0===y)break e;y--,w|=p[g++]<<x,x+=8}if(S-=b,e.total_out+=S,n.total+=S,S&&(e.adler=n.check=n.flags?s(n.check,f,S,v-S):r(n.check,f,S,v-S)),S=b,(n.flags?w:m(w))!==n.check){e.msg="incorrect data check",n.mode=30;break}x=w=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;x<32;){if(0===y)break e;y--,w+=p[g++]<<x,x+=8}if(w!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}x=w=0}n.mode=29;case 29:R=1;break e;case 30:R=-3;break e;case 31:return-4;default:return u}return e.next_out=v,e.avail_out=b,e.next_in=g,e.avail_in=y,n.hold=w,n.bits=x,(n.wsize||S!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&L(e,e.output,e.next_out,S-e.avail_out)?(n.mode=31,-4):(C-=e.avail_in,S-=e.avail_out,e.total_in+=C,e.total_out+=S,n.total+=S,n.wrap&&S&&(e.adler=n.check=n.flags?s(n.check,f,S,e.next_out-S):r(n.check,f,S,e.next_out-S)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==C&&0===S||4===t)&&R===h&&(R=-5),R)},n.inflateEnd=function(e){if(!e||!e.state)return u;var t=e.state;return t.window&&(t.window=null),e.state=null,h},n.inflateGetHeader=function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?((n.head=t).done=!1,h):u},n.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?u:11===n.mode&&r(1,t,i,0)!==n.check?-3:L(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,h):u},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){var i=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,c,h,u,d){var p,f,m,g,v,y,b,w,x,C=d.bits,S=0,k=0,L=0,E=0,P=0,T=0,A=0,M=0,I=0,_=0,O=null,N=0,D=new i.Buf16(16),R=new i.Buf16(16),F=null,B=0;for(S=0;S<=15;S++)D[S]=0;for(k=0;k<l;k++)D[t[n+k]]++;for(P=C,E=15;1<=E&&0===D[E];E--);if(E<P&&(P=E),0===E)return c[h++]=20971520,c[h++]=20971520,d.bits=1,0;for(L=1;L<E&&0===D[L];L++);for(P<L&&(P=L),S=M=1;S<=15;S++)if(M<<=1,(M-=D[S])<0)return-1;if(0<M&&(0===e||1!==E))return-1;for(R[1]=0,S=1;S<15;S++)R[S+1]=R[S]+D[S];for(k=0;k<l;k++)0!==t[n+k]&&(u[R[t[n+k]]++]=k);if(y=0===e?(O=F=u,19):1===e?(O=r,N-=257,F=s,B-=257,256):(O=o,F=a,-1),S=L,v=h,A=k=_=0,m=-1,g=(I=1<<(T=P))-1,1===e&&852<I||2===e&&592<I)return 1;for(;;){for(b=S-A,x=u[k]<y?(w=0,u[k]):u[k]>y?(w=F[B+u[k]],O[N+u[k]]):(w=96,0),p=1<<S-A,L=f=1<<T;c[v+(_>>A)+(f-=p)]=b<<24|w<<16|x,0!==f;);for(p=1<<S-1;_&p;)p>>=1;if(0!==p?(_&=p-1,_+=p):_=0,k++,0==--D[S]){if(S===E)break;S=t[n+u[k]]}if(P<S&&(_&g)!==m){for(0===A&&(A=P),v+=L,M=1<<(T=S-A);T+A<E&&!((M-=D[T+A])<=0);)T++,M<<=1;if(I+=1<<T,1===e&&852<I||2===e&&592<I)return 1;c[m=_&g]=P<<24|T<<16|v-h}}return 0!==_&&(c[v+_]=S-A<<24|64<<16),d.bits=P,0}},{"../utils/common":41}],51:[function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){var i=e("../utils/common"),r=0,s=1;function o(e){for(var t=e.length;0<=--t;)e[t]=0}var a=0,l=29,c=256,h=c+1+l,u=30,d=19,p=2*h+1,f=15,m=16,g=7,v=256,y=16,b=17,w=18,x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=new Array(2*(h+2));o(L);var E=new Array(2*u);o(E);var P=new Array(512);o(P);var T=new Array(256);o(T);var A=new Array(l);o(A);var M,I,_,O=new Array(u);function N(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function D(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function R(e){return e<256?P[e]:P[256+(e>>>7)]}function F(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function B(e,t,n){e.bi_valid>m-n?(e.bi_buf|=t<<e.bi_valid&65535,F(e,e.bi_buf),e.bi_buf=t>>m-e.bi_valid,e.bi_valid+=n-m):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function V(e,t,n){B(e,n[2*t],n[2*t+1])}function j(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function H(e,t,n){var i,r,s=new Array(f+1),o=0;for(i=1;i<=f;i++)s[i]=o=o+n[i-1]<<1;for(r=0;r<=t;r++){var a=e[2*r+1];0!==a&&(e[2*r]=j(s[a]++,a))}}function U(e){var t;for(t=0;t<h;t++)e.dyn_ltree[2*t]=0;for(t=0;t<u;t++)e.dyn_dtree[2*t]=0;for(t=0;t<d;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*v]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function z(e){8<e.bi_valid?F(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function W(e,t,n,i){var r=2*t,s=2*n;return e[r]<e[s]||e[r]===e[s]&&i[t]<=i[n]}function G(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&W(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!W(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function $(e,t,n){var i,r,s,o,a=0;if(0!==e.last_lit)for(;i=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],r=e.pending_buf[e.l_buf+a],a++,0===i?V(e,r,t):(V(e,(s=T[r])+c+1,t),0!==(o=x[s])&&B(e,r-=A[s],o),V(e,s=R(--i),n),0!==(o=C[s])&&B(e,i-=O[s],o)),a<e.last_lit;);V(e,v,t)}function Z(e,t){var n,i,r,s=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=p,n=0;n<l;n++)0!==s[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):s[2*n+1]=0;for(;e.heap_len<2;)s[2*(r=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[r]=0,e.opt_len--,a&&(e.static_len-=o[2*r+1]);for(t.max_code=c,n=e.heap_len>>1;1<=n;n--)G(e,s,n);for(r=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],G(e,s,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,s[2*r]=s[2*n]+s[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,s[2*n+1]=s[2*i+1]=r,e.heap[1]=r++,G(e,s,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,s,o,a,l=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,u=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,g=t.stat_desc.max_length,v=0;for(s=0;s<=f;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<p;n++)g<(s=l[2*l[2*(i=e.heap[n])+1]+1]+1)&&(s=g,v++),l[2*i+1]=s,c<i||(e.bl_count[s]++,o=0,m<=i&&(o=d[i-m]),a=l[2*i],e.opt_len+=a*(s+o),u&&(e.static_len+=a*(h[2*i+1]+o)));if(0!==v){do{for(s=g-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[g]--,v-=2}while(0<v);for(s=g;0!==s;s--)for(i=e.bl_count[s];0!==i;)c<(r=e.heap[--n])||(l[2*r+1]!==s&&(e.opt_len+=(s-l[2*r+1])*l[2*r],l[2*r+1]=s),i--)}}(e,t),H(s,c,e.bl_count)}function q(e,t,n){var i,r,s=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=t[2*(i+1)+1],++a<l&&r===o||(a<c?e.bl_tree[2*r]+=a:0!==r?(r!==s&&e.bl_tree[2*r]++,e.bl_tree[2*y]++):a<=10?e.bl_tree[2*b]++:e.bl_tree[2*w]++,s=r,c=(a=0)===o?(l=138,3):r===o?(l=6,3):(l=7,4))}function K(e,t,n){var i,r,s=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),i=0;i<=n;i++)if(r=o,o=t[2*(i+1)+1],!(++a<l&&r===o)){if(a<c)for(;V(e,r,e.bl_tree),0!=--a;);else 0!==r?(r!==s&&(V(e,r,e.bl_tree),a--),V(e,y,e.bl_tree),B(e,a-3,2)):a<=10?(V(e,b,e.bl_tree),B(e,a-3,3)):(V(e,w,e.bl_tree),B(e,a-11,7));s=r,c=(a=0)===o?(l=138,3):r===o?(l=6,3):(l=7,4)}}o(O);var Y=!1;function X(e,t,n,r){var s,o,l;B(e,(a<<1)+(r?1:0),3),o=t,l=n,z(s=e),F(s,l),F(s,~l),i.arraySet(s.pending_buf,s.window,o,l,s.pending),s.pending+=l}n._tr_init=function(e){Y||(function(){var e,t,n,i,r,s=new Array(f+1);for(i=n=0;i<l-1;i++)for(A[i]=n,e=0;e<1<<x[i];e++)T[n++]=i;for(T[n-1]=i,i=r=0;i<16;i++)for(O[i]=r,e=0;e<1<<C[i];e++)P[r++]=i;for(r>>=7;i<u;i++)for(O[i]=r<<7,e=0;e<1<<C[i]-7;e++)P[256+r++]=i;for(t=0;t<=f;t++)s[t]=0;for(e=0;e<=143;)L[2*e+1]=8,e++,s[8]++;for(;e<=255;)L[2*e+1]=9,e++,s[9]++;for(;e<=279;)L[2*e+1]=7,e++,s[7]++;for(;e<=287;)L[2*e+1]=8,e++,s[8]++;for(H(L,h+1,s),e=0;e<u;e++)E[2*e+1]=5,E[2*e]=j(e,5);M=new N(L,x,c+1,h,f),I=new N(E,C,0,u,f),_=new N(new Array(0),S,0,d,g)}(),Y=!0),e.l_desc=new D(e.dyn_ltree,M),e.d_desc=new D(e.dyn_dtree,I),e.bl_desc=new D(e.bl_tree,_),e.bi_buf=0,e.bi_valid=0,U(e)},n._tr_stored_block=X,n._tr_flush_block=function(e,t,n,i){var o,a,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return r;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return s;for(t=32;t<c;t++)if(0!==e.dyn_ltree[2*t])return s;return r}(e)),Z(e,e.l_desc),Z(e,e.d_desc),l=function(e){var t;for(q(e,e.dyn_ltree,e.l_desc.max_code),q(e,e.dyn_dtree,e.d_desc.max_code),Z(e,e.bl_desc),t=d-1;3<=t&&0===e.bl_tree[2*k[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=o&&(o=a)):o=a=n+5,n+4<=o&&-1!==t?X(e,t,n,i):4===e.strategy||a===o?(B(e,2+(i?1:0),3),$(e,L,E)):(B(e,4+(i?1:0),3),function(e,t,n,i){var r;for(B(e,t-257,5),B(e,n-1,5),B(e,i-4,4),r=0;r<i;r++)B(e,e.bl_tree[2*k[r]+1],3);K(e,e.dyn_ltree,t-1),K(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),$(e,e.dyn_ltree,e.dyn_dtree)),U(e),i&&z(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(T[n]+c+1)]++,e.dyn_dtree[2*R(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){var t;B(e,2,3),V(e,v,L),16===(t=e).bi_valid?(F(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,n){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){(function(e){!function(e,t){if(!e.setImmediate){var n,i,r,s,o=1,a={},l=!1,c=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,n="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){d(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(s="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",p,!1):e.attachEvent("onmessage",p),function(t){e.postMessage(s+t,"*")}):e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){d(e.data)},function(e){r.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(i=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):function(e){setTimeout(d,0,e)},h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];var r={callback:e,args:t};return a[o]=r,n(o),o++},h.clearImmediate=u}function u(e){delete a[e]}function d(e){if(l)setTimeout(d,0,e);else{var n=a[e];if(n){l=!0;try{!function(e){var n=e.callback,i=e.args;switch(i.length){case 0:n();break;case 1:n(i[0]);break;case 2:n(i[0],i[1]);break;case 3:n(i[0],i[1],i[2]);break;default:n.apply(t,i)}}(n)}finally{u(e),l=!1}}}}function p(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&d(+t.data.slice(s.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==N?N:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)),oE.exports);const lE=D(aE);var cE,hE,uE,dE,pE,fE,mE,gE,vE,yE,bE,wE,xE,CE,SE,kE,LE,EE,PE,TE,AE,ME,IE,_E,OE,NE,DE,RE,FE,BE,VE,jE,HE,UE,zE,WE,GE,$E,ZE,qE,KE,YE,XE,JE,QE,eP,tP,nP,iP,rP,sP,oP,aP,lP,cP,hP;function uP(){if(hE)return cE;hE=1;const e=class e{static next(){return(++e.seed).toString(16).toUpperCase()}static peek(){return(e.seed+1).toString(16).toUpperCase()}};return x(e,"seed",0),cE=e}function dP(){if(dE)return uE;dE=1;const e=uP();return uE=class{constructor(t=null){this.handle=e.next(),this.ownerObjectHandle="0",this.subclassMarkers=[],t&&(Array.isArray(t)?this.subclassMarkers.push(...t):this.subclassMarkers.push(t))}tags(e){e.push(5,this.handle),e.push(330,this.ownerObjectHandle);for(const t of this.subclassMarkers)e.push(100,t)}}}function pP(){if(yE)return vE;yE=1;const e=dP();return vE=class extends e{constructor(e){super("AcDbSymbolTable"),this.name=e,this.elements=[]}add(e){e.ownerObjectHandle=this.handle,this.elements.push(e)}tags(e){e.push(0,"TABLE"),e.push(2,this.name),super.tags(e),e.push(70,this.elements.length),this.elements.forEach(t=>{t.tags(e)}),e.push(0,"ENDTAB")}},vE}function fP(){if(YE)return KE;YE=1;const e=dP(),t=uP(),n=function(){if(qE)return ZE;qE=1;const e=dP();return ZE=class extends e{constructor(e,t,n){super(["AcDbEntity","AcDbVertex","AcDb3dPolylineVertex"]),this.x=e,this.y=t,this.z=n}tags(e){e.push(0,"VERTEX"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y,this.z),e.push(70,32)}}}();return KE=class extends e{constructor(e){super(["AcDbEntity","AcDb3dPolyline"]),this.verticies=e.map(e=>{const[t,i,r]=e,s=new n(t,i,r);return s.ownerObjectHandle=this.handle,s}),this.seqendHandle=t.next()}tags(e){e.push(0,"POLYLINE"),super.tags(e),e.push(8,this.layer.name),e.push(66,1),e.push(70,0),e.point(0,0),this.verticies.forEach(t=>{t.layer=this.layer,t.tags(e)}),e.push(0,"SEQEND"),e.push(5,this.seqendHandle),e.push(100,"AcDbEntity"),e.push(8,this.layer.name)}}}function mP(){if(lP)return aP;lP=1;const e=function(){if(fE)return pE;fE=1;const e=dP();return pE=class extends e{constructor(e,t,n){super(["AcDbSymbolTableRecord","AcDbLinetypeTableRecord"]),this.name=e,this.description=t,this.elements=n}tags(e){e.push(0,"LTYPE"),super.tags(e),e.push(2,this.name),e.push(3,this.description),e.push(70,0),e.push(72,65),e.push(73,this.elements.length),e.push(40,this.getElementsSum()),this.elements.forEach(t=>{e.push(49,t),e.push(74,0)})}getElementsSum(){return this.elements.reduce((e,t)=>e+Math.abs(t),0)}},pE}(),t=function(){if(gE)return mE;gE=1;const e=dP();return mE=class extends e{constructor(e,t,n=null){super(["AcDbSymbolTableRecord","AcDbLayerTableRecord"]),this.name=e,this.colorNumber=t,this.lineTypeName=n,this.shapes=[],this.trueColor=-1}tags(e){e.push(0,"LAYER"),super.tags(e),e.push(2,this.name),-1!==this.trueColor?e.push(420,this.trueColor):e.push(62,this.colorNumber),e.push(70,0),this.lineTypeName&&e.push(6,this.lineTypeName),e.push(390,1)}setTrueColor(e){this.trueColor=e}addShape(e){this.shapes.push(e),e.layer=this}getShapes(){return this.shapes}shapesTags(e,t){for(const n of this.shapes)n.ownerObjectHandle=e.handle,n.tags(t)}},mE}(),n=pP(),i=function(){if(wE)return bE;wE=1;const e=dP(),t=pP();return bE=class extends t{constructor(e){super(e),this.subclassMarkers.push("AcDbDimStyleTable")}tags(t){t.push(0,"TABLE"),t.push(2,this.name),e.prototype.tags.call(this,t),t.push(70,this.elements.length),t.push(71,1);for(const e of this.elements)e.tags(t);t.push(0,"ENDTAB")}},bE}(),r=function(){if(CE)return xE;CE=1;const e=dP();return xE=class extends e{constructor(e){super(["AcDbSymbolTableRecord","AcDbTextStyleTableRecord"]),x(this,"fontFileName","txt"),this.name=e}tags(e){e.push(0,"STYLE"),super.tags(e),e.push(2,this.name),e.push(70,0),e.push(40,0),e.push(41,1),e.push(50,0),e.push(71,0),e.push(42,1),e.push(3,this.fontFileName),e.push(4,"")}},xE}(),s=function(){if(kE)return SE;kE=1;const e=dP();return SE=class extends e{constructor(e,t){super(["AcDbSymbolTableRecord","AcDbViewportTableRecord"]),this.name=e,this.height=t}tags(e){e.push(0,"VPORT"),super.tags(e),e.push(2,this.name),e.push(40,this.height),e.push(70,0)}},SE}(),o=function(){if(EE)return LE;EE=1;const e=dP();return LE=class extends e{constructor(e){super(["AcDbSymbolTableRecord","AcDbRegAppTableRecord"]),this.name=e}tags(e){e.push(0,"APPID"),super.tags(e),e.push(2,this.name),e.push(70,0)}},LE}(),a=function(){if(TE)return PE;TE=1;const e=dP();return PE=class extends e{constructor(t){super(["AcDbEntity","AcDbBlockBegin"]),this.name=t,this.end=new e(["AcDbEntity","AcDbBlockEnd"]),this.recordHandle=null}tags(e){e.push(0,"BLOCK"),super.tags(e),e.push(2,this.name),e.push(70,0),e.point(0,0),e.push(3,this.name),e.push(1,""),e.push(0,"ENDBLK"),this.end.tags(e)}},PE}(),l=function(){if(ME)return AE;ME=1;const e=dP();return AE=class extends e{constructor(e){super(["AcDbSymbolTableRecord","AcDbBlockTableRecord"]),this.name=e}tags(e){e.push(0,"BLOCK_RECORD"),super.tags(e),e.push(2,this.name),e.push(70,0),e.push(280,0),e.push(281,1)}},AE}(),c=function(){if(_E)return IE;_E=1;const e=dP();return IE=class extends e{constructor(){super("AcDbDictionary"),this.children={}}addChildDictionary(e,t){t.ownerObjectHandle=this.handle,this.children[e]=t}tags(e){e.push(0,"DICTIONARY"),super.tags(e),e.push(281,1);const t=Object.entries(this.children);for(const i of t){const[t,n]=i;e.push(3,t),e.push(350,n.handle)}const n=Object.values(this.children);for(const i of n)i.tags(e)}},IE}(),h=function(){if(NE)return OE;NE=1;const e=dP();return OE=class extends e{constructor(e,t,n,i){super(["AcDbEntity","AcDbLine"]),this.x1=e,this.y1=t,this.x2=n,this.y2=i}tags(e){e.push(0,"LINE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x1,this.y1),e.push(11,this.x2),e.push(21,this.y2),e.push(31,0)}}}(),u=function(){if(RE)return DE;RE=1;const e=dP();return DE=class extends e{constructor(e,t,n,i,r,s){super(["AcDbEntity","AcDbLine"]),this.x1=e,this.y1=t,this.z1=n,this.x2=i,this.y2=r,this.z2=s}tags(e){e.push(0,"LINE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x1,this.y1,this.z1),e.push(11,this.x2),e.push(21,this.y2),e.push(31,this.z2)}}}(),d=function(){if(BE)return FE;BE=1;const e=dP();return FE=class extends e{constructor(e,t,n,i,r){super(["AcDbEntity","AcDbCircle"]),this.x=e,this.y=t,this.r=n,this.startAngle=i,this.endAngle=r}tags(e){e.push(0,"ARC"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y),e.push(40,this.r),e.push(100,"AcDbArc"),e.push(50,this.startAngle),e.push(51,this.endAngle)}}}(),p=function(){if(jE)return VE;jE=1;const e=dP();return VE=class extends e{constructor(e,t,n){super(["AcDbEntity","AcDbCircle"]),this.x=e,this.y=t,this.r=n}tags(e){e.push(0,"CIRCLE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y),e.push(40,this.r)}}}(),f=function(){if(UE)return HE;UE=1;const e=dP();return HE=class extends e{constructor(e,t,n,i,r,s,o,a){super(["AcDbEntity","AcDbCircle"]),this.x=e,this.y=t,this.z=n,this.r=i,this.thickness=r,this.extrusionDirectionX=s,this.extrusionDirectionY=o,this.extrusionDirectionZ=a}tags(e){e.push(0,"CIRCLE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y,this.z),e.push(40,this.r),e.push(39,this.thickness),e.push(210,this.extrusionDirectionX),e.push(220,this.extrusionDirectionY),e.push(230,this.extrusionDirectionZ)}}}(),m=function(){if(WE)return zE;WE=1;const e=dP(),t=["left","center","right"],n=["baseline","bottom","middle","top"];return zE=class extends e{constructor(e,t,n,i,r,s="left",o="baseline"){super(["AcDbEntity","AcDbText"]),this.x=e,this.y=t,this.height=n,this.rotation=i,this.value=r,this.hAlign=s,this.vAlign=o}tags(e){e.push(0,"TEXT"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y),e.push(40,this.height),e.push(1,this.value),e.push(50,this.rotation),t.includes(this.hAlign,1)||n.includes(this.vAlign,1)?(e.push(72,Math.max(t.indexOf(this.hAlign),0)),e.push(11,this.x),e.push(21,this.y),e.push(31,0),e.push(100,"AcDbText"),e.push(73,Math.max(n.indexOf(this.vAlign),0))):e.push(100,"AcDbText")}}}(),g=function(){if($E)return GE;$E=1;const e=dP();return GE=class extends e{constructor(e,t=!1,n=0,i=0){super(["AcDbEntity","AcDbPolyline"]),this.points=e,this.closed=t,this.startWidth=n,this.endWidth=i}tags(e){e.push(0,"LWPOLYLINE"),super.tags(e),e.push(8,this.layer.name),e.push(6,"ByLayer"),e.push(62,256),e.push(370,-1),e.push(90,this.points.length),e.push(70,this.closed?1:0),this.points.forEach(t=>{const[n,i,r]=t;e.push(10,n),e.push(20,i),0===this.startWidth&&0===this.endWidth||(e.push(40,this.startWidth),e.push(41,this.endWidth)),void 0!==r&&e.push(42,r)})}}}(),v=fP(),y=function(){if(JE)return XE;JE=1;const e=dP();return XE=class extends e{constructor(e,t,n,i,r,s,o,a,l,c,h,u){super(["AcDbEntity","AcDbFace"]),this.x1=e,this.y1=t,this.z1=n,this.x2=i,this.y2=r,this.z2=s,this.x3=o,this.y3=a,this.z3=l,this.x4=c,this.y4=h,this.z4=u}tags(e){e.push(0,"3DFACE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x1,this.y1,this.z1),e.push(11,this.x2),e.push(21,this.y2),e.push(31,this.z2),e.push(12,this.x3),e.push(22,this.y3),e.push(32,this.z3),e.push(13,this.x4),e.push(23,this.y4),e.push(33,this.z4)}}}(),b=function(){if(eP)return QE;eP=1;const e=dP();return QE=class extends e{constructor(e,t){super(["AcDbEntity","AcDbPoint"]),this.x=e,this.y=t}tags(e){e.push(0,"POINT"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y)}}}(),w=function(){if(nP)return tP;nP=1;const e=dP();return tP=class extends e{constructor(e,t=3,n=null,i=null,r=[]){if(super(["AcDbEntity","AcDbSpline"]),e.length<t+1)throw new Error(`For degree ${t} spline, expected at least ${t+1} control points, but received only ${e.length}`);if(null==n){n=[];for(let e=0;e<t+1;e++)n.push(0);for(let i=1;i<e.length-t;i++)n.push(i);for(let i=0;i<t+1;i++)n.push(e.length-t)}if(n.length!==e.length+t+1)throw new Error(`Invalid knot vector length. Expected ${e.length+t+1} but received ${n.length}.`);this.controlPoints=e,this.knots=n,this.fitPoints=r,this.degree=t,this.weights=i;const s=this.weights?1:0;this.type=0+4*s+8+0}tags(e){e.push(0,"SPLINE"),super.tags(e),e.push(8,this.layer.name),e.push(210,0),e.push(220,0),e.push(230,1),e.push(70,this.type),e.push(71,this.degree),e.push(72,this.knots.length),e.push(73,this.controlPoints.length),e.push(74,this.fitPoints.length),e.push(42,1e-7),e.push(43,1e-7),e.push(44,1e-10),this.knots.forEach(t=>{e.push(40,t)}),this.weights&&this.weights.forEach(t=>{e.push(41,t)}),this.controlPoints.forEach(t=>{e.point(t[0],t[1])})}},tP}(),C=function(){if(rP)return iP;rP=1;const e=dP();return iP=class extends e{constructor(e,t,n,i,r,s,o){super(["AcDbEntity","AcDbEllipse"]),this.x=e,this.y=t,this.majorAxisX=n,this.majorAxisY=i,this.axisRatio=r,this.startAngle=s,this.endAngle=o}tags(e){e.push(0,"ELLIPSE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y),e.push(11,this.majorAxisX),e.push(21,this.majorAxisY),e.push(31,0),e.push(40,this.axisRatio),e.push(41,this.startAngle),e.push(42,this.endAngle)}}}(),S=(oP||(oP=1,sP=class{constructor(){this.lines=[]}point(e,t,n=0){this.push(10,e),this.push(20,t),this.push(30,n)}start(e){this.push(0,"SECTION"),this.push(2,e)}end(){this.push(0,"ENDSEC")}addHeaderVariable(e,t){this.push(9,`$${e}`),t.forEach(e=>{this.push(e[0],e[1])})}push(e,t){this.lines.push(e,t)}toDxfString(){return this.lines.join("\n")}}),sP),k=uP();class L{constructor(){this.layers={},this.activeLayer=null,this.lineTypes={},this.headers={},this.tables={},this.blocks={},this.dictionary=new c,this.setUnits("Unitless");for(const e of L.LINE_TYPES)this.addLineType(e.name,e.description,e.elements);for(const e of L.LAYERS)this.addLayer(e.name,e.colorNumber,e.lineTypeName);this.setActiveLayer("0"),this.generateAutocadExtras()}addLineType(t,n,i){return this.lineTypes[t]=new e(t,n,i),this}addLayer(e,n,i){return this.layers[e]=new t(e,n,i),this}setActiveLayer(e){return this.activeLayer=this.layers[e],this}addTable(e){const t=new n(e);return this.tables[e]=t,t}addBlock(e){const t=new a(e);return this.blocks[e]=t,t}drawLine(e,t,n,i){return this.activeLayer.addShape(new h(e,t,n,i)),this}drawLine3d(e,t,n,i,r,s){return this.activeLayer.addShape(new u(e,t,n,i,r,s)),this}drawPoint(e,t){return this.activeLayer.addShape(new b(e,t)),this}drawRect(e,t,n,i,r,s){const o=n-e,a=i-t;s=s||0;let l=null;return l=new g(r?[[e+o-r,t,s],[e+o,t+r],[e+o,t+a-r,s],[e+o-r,t+a],[e+r,t+a,s],[e,t+a-r],[e,t+r,s],[e+r,t]]:[[e,t],[e,t+a],[e+o,t+a],[e+o,t]],!0),this.activeLayer.addShape(l),this}drawPolygon(e,t,n,i,r=0,s=!1){const o=2*Math.PI/n,a=[];let l=i;const c=r*Math.PI/180;s&&(l=i/Math.cos(Math.PI/n));for(let h=0;h<n;h++)a.push([e+l*Math.sin(c+h*o),t+l*Math.cos(c+h*o)]);return this.activeLayer.addShape(new g(a,!0)),this}drawArc(e,t,n,i,r){return this.activeLayer.addShape(new d(e,t,n,i,r)),this}drawCircle(e,t,n){return this.activeLayer.addShape(new p(e,t,n)),this}drawCylinder(e,t,n,i,r,s,o,a){return this.activeLayer.addShape(new f(e,t,n,i,r,s,o,a)),this}drawText(e,t,n,i,r,s="left",o="baseline"){return this.activeLayer.addShape(new m(e,t,n,i,r,s,o)),this}drawPolyline(e,t=!1,n=0,i=0){return this.activeLayer.addShape(new g(e,t,n,i)),this}drawPolyline3d(e){return e.forEach(e=>{if(3!==e.length)throw"Require 3D coordinates"}),this.activeLayer.addShape(new v(e)),this}setTrueColor(e){return this.activeLayer.setTrueColor(e),this}drawSpline(e,t=3,n=null,i=null,r=[]){return this.activeLayer.addShape(new w(e,t,n,i,r)),this}drawEllipse(e,t,n,i,r,s=0,o=2*Math.PI){return this.activeLayer.addShape(new C(e,t,n,i,r,s,o)),this}drawFace(e,t,n,i,r,s,o,a,l,c,h,u){return this.activeLayer.addShape(new y(e,t,n,i,r,s,o,a,l,c,h,u)),this}_ltypeTable(){const e=new n("LTYPE"),t=Object.values(this.lineTypes);for(const n of t)e.add(n);return e}_layerTable(e){const t=new n("LAYER"),i=Object.values(this.layers);for(const n of i)t.add(n);return t}header(e,t){return this.headers[e]=t,this}setUnits(e){return void 0!==L.UNITS[e]?L.UNITS[e]:L.UNITS.Unitless,this.header("INSUNITS",[[70,L.UNITS[e]]]),this}generateAutocadExtras(){this.headers.ACADVER||this.header("ACADVER",[[1,"AC1021"]]),this.lineTypes.ByBlock||this.addLineType("ByBlock","",[]),this.lineTypes.ByLayer||this.addLineType("ByLayer","",[]);let e=this.tables.VPORT;e||(e=this.addTable("VPORT"));let t=this.tables.STYLE;t||(t=this.addTable("STYLE")),this.tables.VIEW||this.addTable("VIEW"),this.tables.UCS||this.addTable("UCS");let n=this.tables.APPID;if(n||(n=this.addTable("APPID")),!this.tables.DIMSTYLE){const e=new i("DIMSTYLE");this.tables.DIMSTYLE=e}e.add(new s("*ACTIVE",1e3)),t.add(new r("standard")),n.add(new o("ACAD")),this.modelSpace=this.addBlock("*Model_Space"),this.addBlock("*Paper_Space");const a=new c;this.dictionary.addChildDictionary("ACAD_GROUP",a)}_tagsManager(){const e=new S,t=new n("BLOCK_RECORD"),i=Object.values(this.blocks);for(const n of i){const e=new l(n.name);t.add(e)}const r=this._ltypeTable(),s=this._layerTable();e.start("HEADER"),e.addHeaderVariable("HANDSEED",[[5,k.peek()]]);const o=Object.entries(this.headers);for(const n of o){const[t,i]=n;e.addHeaderVariable(t,i)}e.end(),e.start("CLASSES"),e.end(),e.start("TABLES"),r.tags(e),s.tags(e);const a=Object.values(this.tables);for(const n of a)n.tags(e);t.tags(e),e.end(),e.start("BLOCKS");for(const n of i)n.tags(e);e.end(),e.start("ENTITIES");const c=Object.values(this.layers);for(const n of c)n.shapesTags(this.modelSpace,e);return e.end(),e.start("OBJECTS"),this.dictionary.tags(e),e.end(),e.push(0,"EOF"),e}toDxfString(){return this._tagsManager().toDxfString()}}return L.ACI={LAYER:0,RED:1,YELLOW:2,GREEN:3,CYAN:4,BLUE:5,MAGENTA:6,WHITE:7},L.LINE_TYPES=[{name:"CONTINUOUS",description:"______",elements:[]},{name:"DASHED",description:"_ _ _ ",elements:[5,-5]},{name:"DOTTED",description:". . . ",elements:[0,-5]}],L.LAYERS=[{name:"0",colorNumber:L.ACI.WHITE,lineTypeName:"CONTINUOUS"}],L.UNITS={Unitless:0,Inches:1,Feet:2,Miles:3,Millimeters:4,Centimeters:5,Meters:6,Kilometers:7,Microinches:8,Mils:9,Yards:10,Angstroms:11,Nanometers:12,Microns:13,Decimeters:14,Decameters:15,Hectometers:16,Gigameters:17,"Astronomical units":18,"Light years":19,Parsecs:20},aP=L}const gP=D(hP?cP:(hP=1,cP=mP())),vP=[{aci:0,hex:"#000000",rgb:[0,0,0]},{aci:1,hex:"#FF0000",rgb:[255,0,0]},{aci:2,hex:"#FFFF00",rgb:[255,255,0]},{aci:3,hex:"#00FF00",rgb:[0,255,0]},{aci:4,hex:"#00FFFF",rgb:[0,255,255]},{aci:5,hex:"#0000FF",rgb:[0,0,255]},{aci:6,hex:"#FF00FF",rgb:[255,0,255]},{aci:7,hex:"#FFFFFF",rgb:[255,255,255]},{aci:8,hex:"#414141",rgb:[65,65,65]},{aci:9,hex:"#808080",rgb:[128,128,128]},{aci:10,hex:"#FF0000",rgb:[255,0,0]},{aci:11,hex:"#FFAAAA",rgb:[255,170,170]},{aci:12,hex:"#BD0000",rgb:[189,0,0]},{aci:13,hex:"#BD7E7E",rgb:[189,126,126]},{aci:14,hex:"#810000",rgb:[129,0,0]},{aci:15,hex:"#815656",rgb:[129,86,86]},{aci:16,hex:"#680000",rgb:[104,0,0]},{aci:17,hex:"#684545",rgb:[104,69,69]},{aci:18,hex:"#4F0000",rgb:[79,0,0]},{aci:19,hex:"#4F3535",rgb:[79,53,53]},{aci:20,hex:"#FF3F00",rgb:[255,63,0]},{aci:21,hex:"#FFBFAA",rgb:[255,191,170]},{aci:22,hex:"#BD2E00",rgb:[189,46,0]},{aci:23,hex:"#BD8D7E",rgb:[189,141,126]},{aci:24,hex:"#811F00",rgb:[129,31,0]},{aci:25,hex:"#816056",rgb:[129,96,86]},{aci:26,hex:"#681900",rgb:[104,25,0]},{aci:27,hex:"#684E45",rgb:[104,78,69]},{aci:28,hex:"#4F1300",rgb:[79,19,0]},{aci:29,hex:"#4F3B35",rgb:[79,59,53]},{aci:30,hex:"#FF7F00",rgb:[255,127,0]},{aci:31,hex:"#FFD4AA",rgb:[255,212,170]},{aci:32,hex:"#BD5E00",rgb:[189,94,0]},{aci:33,hex:"#BD9D7E",rgb:[189,157,126]},{aci:34,hex:"#814000",rgb:[129,64,0]},{aci:35,hex:"#816B56",rgb:[129,107,86]},{aci:36,hex:"#683400",rgb:[104,52,0]},{aci:37,hex:"#685645",rgb:[104,86,69]},{aci:38,hex:"#4F2700",rgb:[79,39,0]},{aci:39,hex:"#4F4235",rgb:[79,66,53]},{aci:40,hex:"#FFBF00",rgb:[255,191,0]},{aci:41,hex:"#FFEAAA",rgb:[255,234,170]},{aci:42,hex:"#BD8D00",rgb:[189,141,0]},{aci:43,hex:"#BDAD7E",rgb:[189,173,126]},{aci:44,hex:"#816000",rgb:[129,96,0]},{aci:45,hex:"#817656",rgb:[129,118,86]},{aci:46,hex:"#684E00",rgb:[104,78,0]},{aci:47,hex:"#685F45",rgb:[104,95,69]},{aci:48,hex:"#4F3B00",rgb:[79,59,0]},{aci:49,hex:"#4F4935",rgb:[79,73,53]},{aci:50,hex:"#FFFF00",rgb:[255,255,0]},{aci:51,hex:"#FFFFAA",rgb:[255,255,170]},{aci:52,hex:"#BDBD00",rgb:[189,189,0]},{aci:53,hex:"#BDBD7E",rgb:[189,189,126]},{aci:54,hex:"#818100",rgb:[129,129,0]},{aci:55,hex:"#818156",rgb:[129,129,86]},{aci:56,hex:"#686800",rgb:[104,104,0]},{aci:57,hex:"#686845",rgb:[104,104,69]},{aci:58,hex:"#4F4F00",rgb:[79,79,0]},{aci:59,hex:"#4F4F35",rgb:[79,79,53]},{aci:60,hex:"#BFFF00",rgb:[191,255,0]},{aci:61,hex:"#EAFFAA",rgb:[234,255,170]},{aci:62,hex:"#8DBD00",rgb:[141,189,0]},{aci:63,hex:"#ADBD7E",rgb:[173,189,126]},{aci:64,hex:"#608100",rgb:[96,129,0]},{aci:65,hex:"#768156",rgb:[118,129,86]},{aci:66,hex:"#4E6800",rgb:[78,104,0]},{aci:67,hex:"#5F6845",rgb:[95,104,69]},{aci:68,hex:"#3B4F00",rgb:[59,79,0]},{aci:69,hex:"#494F35",rgb:[73,79,53]},{aci:70,hex:"#7FFF00",rgb:[127,255,0]},{aci:71,hex:"#D4FFAA",rgb:[212,255,170]},{aci:72,hex:"#5EBD00",rgb:[94,189,0]},{aci:73,hex:"#9DBD7E",rgb:[157,189,126]},{aci:74,hex:"#408100",rgb:[64,129,0]},{aci:75,hex:"#6B8156",rgb:[107,129,86]},{aci:76,hex:"#346800",rgb:[52,104,0]},{aci:77,hex:"#566845",rgb:[86,104,69]},{aci:78,hex:"#274F00",rgb:[39,79,0]},{aci:79,hex:"#424F35",rgb:[66,79,53]},{aci:80,hex:"#3FFF00",rgb:[63,255,0]},{aci:81,hex:"#BFFFAA",rgb:[191,255,170]},{aci:82,hex:"#2EBD00",rgb:[46,189,0]},{aci:83,hex:"#8DBD7E",rgb:[141,189,126]},{aci:84,hex:"#1F8100",rgb:[31,129,0]},{aci:85,hex:"#608156",rgb:[96,129,86]},{aci:86,hex:"#196800",rgb:[25,104,0]},{aci:87,hex:"#4E6845",rgb:[78,104,69]},{aci:88,hex:"#134F00",rgb:[19,79,0]},{aci:89,hex:"#3B4F35",rgb:[59,79,53]},{aci:90,hex:"#00FF00",rgb:[0,255,0]},{aci:91,hex:"#AAFFAA",rgb:[170,255,170]},{aci:92,hex:"#00BD00",rgb:[0,189,0]},{aci:93,hex:"#7EBD7E",rgb:[126,189,126]},{aci:94,hex:"#008100",rgb:[0,129,0]},{aci:95,hex:"#568156",rgb:[86,129,86]},{aci:96,hex:"#006800",rgb:[0,104,0]},{aci:97,hex:"#456845",rgb:[69,104,69]},{aci:98,hex:"#004F00",rgb:[0,79,0]},{aci:99,hex:"#354F35",rgb:[53,79,53]},{aci:100,hex:"#00FF3F",rgb:[0,255,63]},{aci:101,hex:"#AAFFBF",rgb:[170,255,191]},{aci:102,hex:"#00BD2E",rgb:[0,189,46]},{aci:103,hex:"#7EBD8D",rgb:[126,189,141]},{aci:104,hex:"#00811F",rgb:[0,129,31]},{aci:105,hex:"#568160",rgb:[86,129,96]},{aci:106,hex:"#006819",rgb:[0,104,25]},{aci:107,hex:"#45684E",rgb:[69,104,78]},{aci:108,hex:"#004F13",rgb:[0,79,19]},{aci:109,hex:"#354F3B",rgb:[53,79,59]},{aci:110,hex:"#00FF7F",rgb:[0,255,127]},{aci:111,hex:"#AAFFD4",rgb:[170,255,212]},{aci:112,hex:"#00BD5E",rgb:[0,189,94]},{aci:113,hex:"#7EBD9D",rgb:[126,189,157]},{aci:114,hex:"#008140",rgb:[0,129,64]},{aci:115,hex:"#56816B",rgb:[86,129,107]},{aci:116,hex:"#006834",rgb:[0,104,52]},{aci:117,hex:"#456856",rgb:[69,104,86]},{aci:118,hex:"#004F27",rgb:[0,79,39]},{aci:119,hex:"#354F42",rgb:[53,79,66]},{aci:120,hex:"#00FFBF",rgb:[0,255,191]},{aci:121,hex:"#AAFFEA",rgb:[170,255,234]},{aci:122,hex:"#00BD8D",rgb:[0,189,141]},{aci:123,hex:"#7EBDAD",rgb:[126,189,173]},{aci:124,hex:"#008160",rgb:[0,129,96]},{aci:125,hex:"#568176",rgb:[86,129,118]},{aci:126,hex:"#00684E",rgb:[0,104,78]},{aci:127,hex:"#45685F",rgb:[69,104,95]},{aci:128,hex:"#004F3B",rgb:[0,79,59]},{aci:129,hex:"#354F49",rgb:[53,79,73]},{aci:130,hex:"#00FFFF",rgb:[0,255,255]},{aci:131,hex:"#AAFFFF",rgb:[170,255,255]},{aci:132,hex:"#00BDBD",rgb:[0,189,189]},{aci:133,hex:"#7EBDBD",rgb:[126,189,189]},{aci:134,hex:"#008181",rgb:[0,129,129]},{aci:135,hex:"#568181",rgb:[86,129,129]},{aci:136,hex:"#006868",rgb:[0,104,104]},{aci:137,hex:"#456868",rgb:[69,104,104]},{aci:138,hex:"#004F4F",rgb:[0,79,79]},{aci:139,hex:"#354F4F",rgb:[53,79,79]},{aci:140,hex:"#00BFFF",rgb:[0,191,255]},{aci:141,hex:"#AAEAFF",rgb:[170,234,255]},{aci:142,hex:"#008DBD",rgb:[0,141,189]},{aci:143,hex:"#7EADBD",rgb:[126,173,189]},{aci:144,hex:"#006081",rgb:[0,96,129]},{aci:145,hex:"#567681",rgb:[86,118,129]},{aci:146,hex:"#004E68",rgb:[0,78,104]},{aci:147,hex:"#455F68",rgb:[69,95,104]},{aci:148,hex:"#003B4F",rgb:[0,59,79]},{aci:149,hex:"#35494F",rgb:[53,73,79]},{aci:150,hex:"#007FFF",rgb:[0,127,255]},{aci:151,hex:"#AAD4FF",rgb:[170,212,255]},{aci:152,hex:"#005EBD",rgb:[0,94,189]},{aci:153,hex:"#7E9DBD",rgb:[126,157,189]},{aci:154,hex:"#004081",rgb:[0,64,129]},{aci:155,hex:"#566B81",rgb:[86,107,129]},{aci:156,hex:"#003468",rgb:[0,52,104]},{aci:157,hex:"#455668",rgb:[69,86,104]},{aci:158,hex:"#00274F",rgb:[0,39,79]},{aci:159,hex:"#35424F",rgb:[53,66,79]},{aci:160,hex:"#003FFF",rgb:[0,63,255]},{aci:161,hex:"#AABFFF",rgb:[170,191,255]},{aci:162,hex:"#002EBD",rgb:[0,46,189]},{aci:163,hex:"#7E8DBD",rgb:[126,141,189]},{aci:164,hex:"#001F81",rgb:[0,31,129]},{aci:165,hex:"#566081",rgb:[86,96,129]},{aci:166,hex:"#001968",rgb:[0,25,104]},{aci:167,hex:"#454E68",rgb:[69,78,104]},{aci:168,hex:"#00134F",rgb:[0,19,79]},{aci:169,hex:"#353B4F",rgb:[53,59,79]},{aci:170,hex:"#0000FF",rgb:[0,0,255]},{aci:171,hex:"#AAAAFF",rgb:[170,170,255]},{aci:172,hex:"#0000BD",rgb:[0,0,189]},{aci:173,hex:"#7E7EBD",rgb:[126,126,189]},{aci:174,hex:"#000081",rgb:[0,0,129]},{aci:175,hex:"#565681",rgb:[86,86,129]},{aci:176,hex:"#000068",rgb:[0,0,104]},{aci:177,hex:"#454568",rgb:[69,69,104]},{aci:178,hex:"#00004F",rgb:[0,0,79]},{aci:179,hex:"#35354F",rgb:[53,53,79]},{aci:180,hex:"#3F00FF",rgb:[63,0,255]},{aci:181,hex:"#BFAAFF",rgb:[191,170,255]},{aci:182,hex:"#2E00BD",rgb:[46,0,189]},{aci:183,hex:"#8D7EBD",rgb:[141,126,189]},{aci:184,hex:"#1F0081",rgb:[31,0,129]},{aci:185,hex:"#605681",rgb:[96,86,129]},{aci:186,hex:"#190068",rgb:[25,0,104]},{aci:187,hex:"#4E4568",rgb:[78,69,104]},{aci:188,hex:"#13004F",rgb:[19,0,79]},{aci:189,hex:"#3B354F",rgb:[59,53,79]},{aci:190,hex:"#7F00FF",rgb:[127,0,255]},{aci:191,hex:"#D4AAFF",rgb:[212,170,255]},{aci:192,hex:"#5E00BD",rgb:[94,0,189]},{aci:193,hex:"#9D7EBD",rgb:[157,126,189]},{aci:194,hex:"#400081",rgb:[64,0,129]},{aci:195,hex:"#6B5681",rgb:[107,86,129]},{aci:196,hex:"#340068",rgb:[52,0,104]},{aci:197,hex:"#564568",rgb:[86,69,104]},{aci:198,hex:"#27004F",rgb:[39,0,79]},{aci:199,hex:"#42354F",rgb:[66,53,79]},{aci:200,hex:"#BF00FF",rgb:[191,0,255]},{aci:201,hex:"#EAAAFF",rgb:[234,170,255]},{aci:202,hex:"#8D00BD",rgb:[141,0,189]},{aci:203,hex:"#AD7EBD",rgb:[173,126,189]},{aci:204,hex:"#600081",rgb:[96,0,129]},{aci:205,hex:"#765681",rgb:[118,86,129]},{aci:206,hex:"#4E0068",rgb:[78,0,104]},{aci:207,hex:"#5F4568",rgb:[95,69,104]},{aci:208,hex:"#3B004F",rgb:[59,0,79]},{aci:209,hex:"#49354F",rgb:[73,53,79]},{aci:210,hex:"#FF00FF",rgb:[255,0,255]},{aci:211,hex:"#FFAAFF",rgb:[255,170,255]},{aci:212,hex:"#BD00BD",rgb:[189,0,189]},{aci:213,hex:"#BD7EBD",rgb:[189,126,189]},{aci:214,hex:"#810081",rgb:[129,0,129]},{aci:215,hex:"#815681",rgb:[129,86,129]},{aci:216,hex:"#680068",rgb:[104,0,104]},{aci:217,hex:"#684568",rgb:[104,69,104]},{aci:218,hex:"#4F004F",rgb:[79,0,79]},{aci:219,hex:"#4F354F",rgb:[79,53,79]},{aci:220,hex:"#FF00BF",rgb:[255,0,191]},{aci:221,hex:"#FFAAEA",rgb:[255,170,234]},{aci:222,hex:"#BD008D",rgb:[189,0,141]},{aci:223,hex:"#BD7EAD",rgb:[189,126,173]},{aci:224,hex:"#810060",rgb:[129,0,96]},{aci:225,hex:"#815676",rgb:[129,86,118]},{aci:226,hex:"#68004E",rgb:[104,0,78]},{aci:227,hex:"#68455F",rgb:[104,69,95]},{aci:228,hex:"#4F003B",rgb:[79,0,59]},{aci:229,hex:"#4F3549",rgb:[79,53,73]},{aci:230,hex:"#FF007F",rgb:[255,0,127]},{aci:231,hex:"#FFAAD4",rgb:[255,170,212]},{aci:232,hex:"#BD005E",rgb:[189,0,94]},{aci:233,hex:"#BD7E9D",rgb:[189,126,157]},{aci:234,hex:"#810040",rgb:[129,0,64]},{aci:235,hex:"#81566B",rgb:[129,86,107]},{aci:236,hex:"#680034",rgb:[104,0,52]},{aci:237,hex:"#684556",rgb:[104,69,86]},{aci:238,hex:"#4F0027",rgb:[79,0,39]},{aci:239,hex:"#4F3542",rgb:[79,53,66]},{aci:240,hex:"#FF003F",rgb:[255,0,63]},{aci:241,hex:"#FFAABF",rgb:[255,170,191]},{aci:242,hex:"#BD002E",rgb:[189,0,46]},{aci:243,hex:"#BD7E8D",rgb:[189,126,141]},{aci:244,hex:"#81001F",rgb:[129,0,31]},{aci:245,hex:"#815660",rgb:[129,86,96]},{aci:246,hex:"#680019",rgb:[104,0,25]},{aci:247,hex:"#68454E",rgb:[104,69,78]},{aci:248,hex:"#4F0013",rgb:[79,0,19]},{aci:249,hex:"#4F353B",rgb:[79,53,59]},{aci:250,hex:"#333333",rgb:[51,51,51]},{aci:251,hex:"#505050",rgb:[80,80,80]},{aci:252,hex:"#696969",rgb:[105,105,105]},{aci:253,hex:"#828282",rgb:[130,130,130]},{aci:254,hex:"#BEBEBE",rgb:[190,190,190]},{aci:255,hex:"#FFFFFF",rgb:[255,255,255]}],yP={in:"Inches",ft:"Feet",mm:"Millimeters",cm:"Centimeters",m:"Meters",px:"Unitless",pc:"Unitless",pt:"Unitless"};function bP(e){const{s:t,cs:n,ce:i,e:r}=e;return[[t.x,0-t.y],[n.x,0-n.y],[i.x,0-i.y],[r.x,0-r.y]]}function wP(e){const t=Math.round(255*e.r),n=Math.round(255*e.g),i=Math.round(255*e.b);let r=1/0,s=-1;for(let o=0,a=vP.length;o<a;o++){const[e,a,l]=vP[o].rgb;if(e===t&&a===n&&l===i)return o;const c=Math.pow(e-t,2)+Math.pow(a-n,2)+Math.pow(l-i,2);c<r&&(r=c,s=o)}return s}const xP=(e,t)=>{const n=[];for(const i of e){const e=CP(i,t);e&&n.push(e)}return n},CP=(e,t,n)=>{const i=t??e.defaultExportFormat;if("none"===i)return;return{component:e,format:i,filename:SP(e,i,n)}},SP=(e,t,n)=>{var i;const r="."+t;if(n)return vf(n,r);const s=kP(Oj.traceForComponent(e))??kP(null==(i=Oj.projectTrace)?void 0:i.base);if(s){const e=vf(s,r);if(e!==r)return e}const o=LP(e);if(o){const e=vf(`${Oj.storage.getProjectName()} - ${o}`,r);if(e!==r)return e}return vf(`${Oj.storage.getProjectName()} - ${e.name}`,r)},kP=e=>{if(null==e?void 0:e.isSuccess()){const t=e.resultForArgName("_filename");if(ks(t))return t}},LP=e=>{var t;function n(e,t){if(null==e?void 0:e.isSuccess()){const n=e.resultForArgName(t);if(ks(n))return n;if(n instanceof Ot)return n.toString()}}const i=e.parameters.find(e=>e.interface instanceof aw);if(i){const t=n(Oj.traceForComponent(e),i.name);if(t)return t}const r=Oj.project.parameters.find(e=>e.interface instanceof aw);if(r){const e=n(null==(t=Oj.projectTrace)?void 0:t.base,r.name);if(e)return e}},EP=e=>{const t=Jr("in","pt"),n=Jr(Oj.project.settings.units,"pt");return{hairlineStrokeWidth:e.hairlineStrokeWidth*n,rasterizeImages:e.rasterizeExportedImages,rasterizeImagesPixelsPerUnit:e.rasterizeExportedImagesPixelsPerInch/t,maximumFractionDigits:6}};const PP=(e,t)=>new Promise((n,i)=>{(async function(){try{return await Ms(()=>import("./pdf-dependencies-Dg1fx6DK.js"),[])}catch(e){throw new Error("Failed to load PDF dependencies: "+e)}})().then(({PDFDocument:r,blobStream:s,SVGtoPDF:o})=>{const a=new r({autoFirstPage:!1});a.addPage({size:[t.x,t.y]}),o(a,e,0,0,{assumePt:!0});const l=a.pipe(s());l.on("finish",()=>{const e=l.toBlob("application/pdf");n(e)});const c=e=>{console.error("Caught an error in PDF export:",e),i(e)};a.on("error",c),l.on("error",c),a.end()})}),TP=(()=>{const e=/Gecko\/\d/.test(navigator.userAgent),t=/Safari\/\d/.test(navigator.userAgent);let n;return i=>{var r;const s=URL.createObjectURL(i);n&&(null==(r=n.parentNode)||r.removeChild(n)),n=document.createElement("iframe"),n.style.cssText="width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0",n.src=s,n.addEventListener("load",()=>{const i=()=>{try{if(n.focus(),null===n.contentWindow)throw"No browsing context";try{n.contentWindow.document.execCommand("print",!1)}catch(e){n.contentWindow.print()}}catch(t){console.error("Print failed: "+t,t)}finally{n.style.visibility="hidden",n.style.left="-1px",URL.revokeObjectURL(s)}};e||t?window.setTimeout(i,1e3):i()}),document.body.appendChild(n)}})(),AP=16777216,MP=document.createElement("canvas"),IP=MP.getContext("2d"),_P=(e,t)=>(Ps("px"===e.units,"Framed graphics must be converted to points"),new Promise((n,i)=>{if(!IP)return i("Failed to create PNG: No canvas context");let r=t.hairlineStrokeWidthPixels;if(r){r*=Jr(e.units,"px")}let s=e.graphic;const o=e.artboard.size().round().maxScalar(1),a=o.x*o.y;if(a>AP){const e=AP/a;o.mulScalar(e).floor(),s=s.clone().transform({scale:e}).scaleStroke(e),r&&(r*=e)}MP.width=o.x,MP.height=o.y,t.backgroundColor&&(IP.fillStyle=t.backgroundColor,IP.fillRect(0,0,o.x,o.y)),sr(s,IP,o,{hairlineStrokeWidth:r}),MP.toBlob(e=>{e?n(e):i("Failed to create PNG: Couldn't create a blob from the canvas")},"image/png")}));class OP{constructor(e){this.patternDefs=[],this.imageDefs=[],this.imagesById={},this.result=[],this._imageRetriever=e}appendGraphic(e,t){if(e instanceof xi){this.result.push("<g>");for(let n of e.items)this.appendGraphic(n,t);this.result.push("</g>")}else(e instanceof Ri||e instanceof wi)&&this.appendPath(e,t)}appendPath(e,t){const{stroke:n,fill:i}=e,r=null==t?void 0:t.maximumFractionDigits;let s="";if(i instanceof ji)s+=`fill="${i.color.toCSSHexString()}" fill-rule="evenodd" `,i.color.a<1&&(s+=`fill-opacity="${$r(i.color.a,r)}" `);else if(i instanceof Hi){const n=(null==t?void 0:t.rasterizeImagesPixelsPerUnit)??0;if((null==t?void 0:t.rasterizeImages)&&n>0){const t=nr(e,{pixelsPerUnit:n,ignoreStroke:!0});if(t){const e=t.boundingBox.size(),n=`transform="translate(${t.boundingBox.min.x}, ${t.boundingBox.min.y})"`,i=`<image width="${e.x}" height="${e.y}" ${n} xlink:href="${t.fill.image}"/>`;this.result.push(i)}s+='fill="none" '}else{s+=`fill="url(#${this.appendPatternDefsForImageFill(i)})" `}}else s+='fill="none" ';if(n instanceof Vi){if(s+=`stroke="${n.color.toCSSHexString()}" `,n.color.a<1&&(s+=`stroke-opacity="${$r(n.color.a,r)}" `),n.hairline){const e=(null==t?void 0:t.hairlineStrokeWidth)??1;s+=`stroke-width="${$r(e,r)}" `}else s+=`stroke-width="${$r(n.width,r)}" `;let i="";n&&("butt"!==n.cap&&(i+=`stroke-linecap="${n.cap}" `),"miter"!==n.join&&(i+=`stroke-linejoin="${n.join}" `),4!==n.miterLimit&&(i+=`stroke-miterlimit="${n.miterLimit}" `));if(e.hasStrokeWithNonStandardAlignment()){const t=wi.stroke(e,{width:n.width,join:n.join,miterLimit:n.miterLimit});"outer"===n.alignment?e=wi.booleanUnion([e,t]):"inner"===n.alignment&&(e=wi.booleanDifference([e,t]))}s+=i}else s+='stroke="none" ';const o=e.toSVGPathString(null==t?void 0:t.maximumFractionDigits);/^\s*$/.test(o)||this.result.push(`<path d="${o}" ${s}/>`)}appendPatternDefsForImageFill(e){const t="image"+NP(e.image);let n=this.imagesById[t];if(!n){if(n=this._imageRetriever(e.image),!n)return;const i=`<image id="${t}" width="${n.width}" height="${n.height}" xlink:href="${n.url}"/>`;this.imageDefs.push(i),this.imagesById[t]=n}const i="pattern"+this.patternDefs.length,r=`<pattern id="${i}" width="100%" height="100%" patternUnits="userSpaceOnUse">\n<use xlink:href="#${t}" transform="${DP(e.transform)}"/>\n</pattern>`;return this.patternDefs.push(r),i}concatenatedResult(){const e=[...this.result],t=[...this.patternDefs,...this.imageDefs];return t.length>0&&e.push("<defs>",...t,"</defs>"),e.join("\n")}}const NP=e=>{let t=5381;const n=e.length;for(let i=0;i<n;i++)t=33*t^e.charCodeAt(i);return t>>>0},DP=e=>`matrix(${String(e.a)}, ${String(e.b)}, ${String(e.c)}, ${String(e.d)}, ${String(e.tx)}, ${String(e.ty)})`,RP=(e,t)=>{Ps("pt"===e.units||"px"===e.units,"Framed graphics must be converted to points");const n=new OP(e=>ql.getImageFromURL(e));return n.appendGraphic(e.graphic,t),n.concatenatedResult()},FP=(e,t)=>{const{maximumFractionDigits:n}=t,i=RP(e,t),r=e.artboard.size(),s=$r(r.x,n),o=$r(r.y,n);return['<?xml version="1.0" encoding="UTF-8" standalone="no"?>',`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="${s+e.units}" height="${o+e.units}" viewBox="${`0 0 ${s} ${o}`}">`,t.title&&`<title>${a=t.title,String(a).replace(/([&"<>'])/g,function(e,t){return yr[t]})}</title>`,i,"</svg>",t.comment&&["\x3c!--",gr(t.comment),"--\x3e"]].flat(1/0).filter(e=>void 0!==e).join("\n").trim();var a};class BP{constructor(e,t,n){this.graphic=e,this.artboard=t,this.units=n}clone(){return new BP(this.graphic.clone(),this.artboard.clone(),this.units)}}const VP=(e,t)=>{const n=e.boundingBox(),i=(null==n?void 0:n.center())??new It,r=((null==n?void 0:n.size())??new It).clone().mulScalar(.5),s=UP(i,r);return new BP(e,s,t)},jP=(e,t)=>{const n=e.boundingBox(),i=Jr("in",t);let r=new It(8.5,11).mulScalar(i);if(n){const e=n.size();(e.x>r.x||e.y>r.y)&&(r=e)}const s=(null==n?void 0:n.center())??new It,o=r.clone().mulScalar(.5),a=UP(s,o);return new BP(e,a,t)},HP=(e,t,n)=>{const i=e.boundingBox();if(i){const n=t.clone().mulScalar(.5),r=i.center(),s=i.size();let o=Math.min(t.x/s.x,t.y/s.y);Number.isFinite(o)||(o=1),e=e.clone().transform({origin:r,position:n,scale:o}).scaleStroke(o)}return new BP(e,new De(new It(0,0),t),n)},UP=(e,t)=>new De(e.clone().sub(t),e.clone().add(t)),zP=(e,t)=>{const n=Jr(e.units,t),i=(jS(e.graphic.clone())??new xi).transform({origin:e.artboard.min,scale:n}).scaleStroke(n),r=new De(new It(0,0),e.artboard.size().mulScalar(n));return new BP(i,r,t)},WP=async e=>{let t=[];for(const s of e){const{component:e,format:n,filename:i}=s;let r;if("svg"===n||"cuttle.svg"===n){const t=Oj.deviceStorage.svgPostprocess;r=GP(e,n,i,t)}else"pdf"===n?r=await $P(e,i):"png"===n?r=await ZP(e,i):"dxf"===n&&(r=qP(e,i));r&&t.push(r)}if(0===t.length)return;if(1===t.length)return void iE.saveAs(t[0]);const n=new lE;for(const s of t)n.file(s.name,s);const i=await n.generateAsync({type:"blob"}),r=Oj.storage.getProjectName()+".zip";iE.saveAs(i,r),Ao("project downloaded zip",{license:Oj.storage.getProjectLicense(),creditId:Oj.storage.getCreditId()})},GP=(e,t,n,i)=>{const r=KP(e);if(!r)return;"cricut"===i?r.graphic=(e=>{var t;const n=e.allPathsByColor().map(e=>new wi(e).copyStyle(e[0])),i=new Gn(0,0,0,1),r=new Gn(.5,.5,.5,1);for(let s of n)s.fill instanceof ji&&s.fill.color.equals(i)&&(s.fill.color=r),(null==(t=s.stroke)?void 0:t.color.equals(i))&&(s.stroke.color=r);return new xi(n)})(r.graphic):"glowforge"===i&&(r.graphic=(e=>{const t=[],n=e.allPathsAndCompoundPaths().filter(e=>!e.fill||(t.push(e),!1)).flatMap(e=>e instanceof wi?e.paths.map(t=>t.copyStyle(e)):e);let i=-1;const r=(e,n,s)=>{let o=n+s;o=Math.min(o,16777215);const a=new Vi(Gn.fromRGB8Number(o));for(const{path:i,contained:l}of e)i.removeFill(),i.assignStroke(a),t.push(i),l.length>0&&r(l,n,s-1);i=o},s=Array.from(ss(n,e=>e.stroke?e.stroke.color.toRGB8Number():-1));s.sort((e,t)=>e[0]-t[0]);for(let[o,a]of s)if(-1===o)t.push(...a);else{const e=Ui.fromPaths(a),t=e.maximumDepth();o<=i&&(o=i+1),r(e.contained,o,t-1)}return new xi(t)})(r.graphic));const s=EP(Oj.project.settings);if(s.title=`${Oj.storage.getProjectName()} - ${e.name}`,"cuttle.svg"===t)s.comment=Oj.getProjectSnapshot().toString();else if(s.comment="Generator: Cuttle.xyz","public"===Oj.storage.getShareStatus()){const e=Oj.storage.getProjectUrl().replace(/-/g,"%2D").replace(/_/g,"%5F");s.comment+="\nProject: "+e}const o=zP(r,"pt"),a=FP(o,s),l=new Blob([a],{type:"image/svg+xml"});n=vf(n,"."+t);return new File([l],n,{type:"image/svg+xml"})},$P=async(e,t)=>{const n=Oj.traceForComponent(e);if(!(null==n?void 0:n.isSuccess()))return;const{settings:i}=Oj.project,r=jP(n.result,i.units);if(!r)return;const s=zP(r,"pt"),o=EP(i);o.rasterizeImages=!0;const a=RP(s,o),l=await PP(a,s.artboard.size());t=vf(t,".pdf");return new File([l],t,{type:"application/pdf"})},ZP=async(e,t)=>{const n=KP(e);if(!n)return;const i=Jr(n.units,"px"),r={hairlineStrokeWidthPixels:Oj.project.settings.hairlineStrokeWidth*i},s=zP(n,"px"),o=await _P(s,r);t=vf(t,".png");return new File([o],t,{type:"image/png"})},qP=(e,t)=>{const n=KP(e);if(!n)return;const i=(e=>{var t;let n=new gP;const i=yP[e.units];n.setUnits(i);let r=0;for(let s of e.graphic.allPathsByColor()){const e=null==(t=s[0].stroke)?void 0:t.color;let i;const o=s[0].fill;o instanceof ji&&(i=o.color);let a=gP.ACI.LAYER,l=0;e?(a=wP(e),l=e.toRGB8Number()):i&&(a=wP(i),l=i.toRGB8Number());const c=`Layer_${r}`;n.addLayer(c,a,"CONTINUOUS"),n.setActiveLayer(c),n.setTrueColor(l);for(let t of s){const e=t.segments();for(let t of e)if(t instanceof Fn)n.drawSpline(bP(t),3);else if(t instanceof Bn){const{s:e,e:i}=t;n.drawLine(e.x,0-e.y,i.x,0-i.y)}}r++}return n.toDxfString()})(n),r=new Blob([i],{type:"image/x-dxf"});t=vf(t,".dxf");return new File([r],t,{type:"image/x-dxf"})},KP=e=>{const t=Oj.traceForComponent(e);if(!(null==t?void 0:t.isSuccess()))return;const{units:n}=Oj.project.settings;return VP(t.result,n)},YP=2400,XP=21600,JP=(e,t=!0)=>(t?"US ":"")+(e/100).toLocaleString("en-US",{style:"currency",currency:"USD"}).replace(/\.00$/,""),QP={view:()=>(()=>{var e,t;const n="cd619bd7-6561-432f-a2af-19a51cdbc81f"===(null==(t=null==(e=window.Rewardful)?void 0:e.affiliate)?void 0:t.id);return n&&localStorage.setItem("CCSPromo","referral"),n})()?Oe("div",{style:{display:"flex",gap:"16px",alignItems:"center",justifyContent:"center","margin-top":"24px"}},[Oe("img",{src:"/images/ccs-promo.png",alt:"Creative Cut Supplies Maker Pack",style:{"mix-blend-mode":"darken",height:"100px"}}),Oe("div",[Oe("p",{style:{fontSize:"14px",lineHeight:"20px"}},["Limited time offer with ",Oe("a",{href:"https://creativecutsupplies.com/",target:"_blank"},"Creative Cut Supplies"),"!"]),Oe("p",{style:{fontSize:"14px",lineHeight:"20px"}},["Subscribe to ",Oe("strong","Cuttle Pro Yearly"),", get a free ",Oe("strong","$50 Maker Pack")]),Oe("p",{style:{fontSize:"14px",lineHeight:"20px"}},["Subscribe to ",Oe("strong","Cuttle Pro Monthly"),", get a free ",Oe("strong","$10 Gift Card")])])]):null},eT={view({attrs:{onClick:e,feature:t,hasAccess:n,className:i,disabled:r,enableProCheck:s},children:o}){let a=e;return(s=void 0===s||s)&&(a=i=>{n?e(i):fT(t,!0)}),Oe("button",{className:i,disabled:r,onclick:a},[o,Oe(tT,{hasAccess:n})])}},tT={view:({attrs:{hasAccess:e}})=>Oe(".feature-tag.pro-feature-tag",{className:eo({"already-pro":e})},"PRO")},nT={view:()=>Oe("span.cuttle-pro",[Oe("strong","Cuttle "),Oe(tT,{hasAccess:!1})])},iT={view:()=>Oe(".pricing-features",[Oe(rT,"Unlimited projects"),Oe(rT,"Unlimited downloads"),Oe(rT,"Access premium templates"),Oe(rT,"Upload JPG and PNG images"),Oe(rT,"Upload your own fonts"),Oe(rT,"Organize projects in folders"),Oe(rT,"Early access to beta features"),Oe(rT,"Personal or commercial use")])},rT={view:({children:e})=>Oe(".pricing-feature",[Oe(Jo,{icon:"check_bullet"}),Oe(".pricing-feature-description",e)])},sT=()=>{const e={paymentPeriod:"monthly"};return{view:({attrs:{feature:t,openInNewWindow:n}})=>[!va.featureFlags.hasProFeatures&&Oe(oT,{info:e,feature:t,openInNewWindow:n}),Oe(lT,{info:e,feature:t,openInNewWindow:n}),Oe(QP)]}},oT={view({attrs:{info:e}}){const t=No();return Oe(".upgrade-plan-selector",[Oe(".upgrade-plans",[Oe(".upgrade-plan",{className:eo({selected:"monthly"===e.paymentPeriod}),onclick:()=>e.paymentPeriod="monthly"},[Oe(aT,{checked:"monthly"===e.paymentPeriod}),t?[Oe("h3","Monthly Membership"),Oe("h3.right",[Oe("s",JP(YP))," ",JP(2160,!1)]),Oe("span.left",""),Oe("span.right","Renews at "+JP(YP)+" / month")]:[Oe("h3","Monthly Membership"),Oe("h3.right",JP(YP)),Oe("span.left",""),Oe("span.right","per month")]]),Oe(".upgrade-plan",{className:eo({selected:"yearly"===e.paymentPeriod}),onclick:()=>e.paymentPeriod="yearly"},[Oe(aT,{checked:"yearly"===e.paymentPeriod}),t?[Oe("h3","Yearly Membership"),Oe("h3.right",[Oe("s",JP(XP))," ",JP(19440,!1)]),Oe("span.left","Save "+JP(7200,!1)+"!"),Oe("span.right","Renews at "+JP(XP)+" / year")]:[Oe("h3","Yearly Membership"),Oe("h3.right",JP(XP)),Oe("span.left","Save "+JP(7200,!1)+"!"),Oe("span.right","per year")]]),t?Oe(".discount","Discount applied: "+(n=.1,(100*n).toFixed(0)+"% off your first month or year")):null])]);var n}},aT={view:({attrs:{checked:e}})=>Oe(".upgrade-plan-checkbox",[Oe(Jo,{icon:e?"plan_checked":"plan_unchecked"})])},lT={view:({attrs:{info:{paymentPeriod:e},feature:t,openInNewWindow:n}})=>va.loggedInUser?va.isSubscriptionFree()?Oe(Oe.route.Link,{role:"button",href:hT(e),target:n?"CuttlePricingWindow":"_top",className:"pricing-upgrade-button",onclick:()=>{Ao("checkout",{plan:"pro",paymentPeriod:e})}},"Upgrade to Pro"):Oe(cT):Oe("button.pricing-upgrade-button",{onclick:async()=>{await va.openAccountModalPromise("signup")&&va.isSubscriptionFree()&&(Ao("checkout",{plan:"pro",paymentPeriod:e}),n?fT(t,n):window.location.href=hT(e))}},"Upgrade to Pro")},cT={view(){var e;const t=null==(e=null==va?void 0:va.loggedInUser)?void 0:e.subscription.plan;return"Pro"===t?Oe("button.secondary",{onclick:uT},"Manage Your Subscription"):"K-12 Education"===t?Oe(".pricing-current-plan",[Oe("div",[Oe("span","Youre on the K-12 Education plan. "),Oe("br"),Oe("span","Contact "),Oe("a",{href:"mailto: support@cuttle.xyz"},"support@cuttle.xyz"),Oe("span"," to make changes to your plan.")])]):void 0}},hT=e=>{const t=No();let n=`${dr}/checkout/pro/${e}`;return t&&(n+=`?referral=${t}`),n},uT=async()=>{const{customerPortalSessionUrl:e}=await Os("createCustomerPortalSession",{});window.location.href=e},dT={projects:["Create unlimited projects with ",Oe(nT)],images:["Upload photos and images with ",Oe(nT)],fonts:["Use your own uploaded fonts with ",Oe(nT)],folders:["Organize projects in folders with ",Oe(nT)],beta:["Access pre-release (beta) features with ",Oe(nT)],downloads:["Download unlimited designs with ",Oe(nT)],templates:["Access premium templates with ",Oe(nT)],"pro-fonts":["Access premium fonts with ",Oe(nT)],"noun-project":["Access 1,000,000+ more icons with ",Oe(nT)]},pT={view({attrs:e}){const{feature:t="templates",openInNewWindow:n}=e,i=dT[t];return Oe(".modal-box.upgrade-modal",[Oe(sa),Oe(".upgrade-modal-top",[Oe("h1.tagline",i)]),Oe(".upgrade-modal-left",[Oe(iT),Oe(".upgrade-modal-learn-more",[Oe(Oe.route.Link,{href:"/pricing",target:n?"CuttlePricingWindow":"_top",onclick:()=>{Ao("upgrade modal: learn more",{feature:t})}},"Learn more about Cuttle Pro")])]),Oe(".upgrade-modal-right",Oe(sT,{feature:t,openInNewWindow:n}))])}},fT=async(e,t)=>{va.isSubscriptionEducationFree()&&(Ao("k-12 upgrade modal",{feature:e}),!(await gT()))||(Ao("upgrade modal",{feature:e}),Do("ViewContent",{content_name:`Upgrade Modal - ${e}`,content_type:"product",content_category:"subscription"}),ia.open({modalView:()=>Oe(pT,{feature:e,openInNewWindow:t})}))},mT={view:({attrs:{onClose:e,onContinue:t}})=>Oe(".modal-box.upgrade-modal-edu",[Oe("p","Youre currently on the free ",Oe("a",{href:"https://cuttle.xyz/cuttle-for-k-12-education",target:"_blank"},"Cuttle for K-12 Education Plan"),"."),Oe("p","This plan provides free access to the Cuttle Editor but does not include Pro content. To access Pro content, you can upgrade to Cuttle Pro."),Oe(".actions",[Oe("button.secondary",{onclick:e},"Cancel"),Oe("button",{onclick:t},"Upgrade to Cuttle Pro")])])},gT=async()=>new Promise(e=>{ia.open({modalView:()=>Oe(mT,{onClose:()=>ia.dismiss(),onContinue:()=>e(!0)}),onDismiss:()=>e(!1)})}),vT={view:({attrs:{onSuccess:e,onDismiss:t}})=>Oe(".modal-box.account-modal.create-account-to-download-modal",[Oe(sa),Oe("p.create-account-to-download-message","Create a free account",Oe("br"),"to download this project"),Oe("button",{onclick:()=>va.openAccountModal("signup",e,t)},"Create Account"),Oe("p.account-error"),Oe("p",["Have an account? ",Oe("span[role=link]",{onclick:()=>va.openAccountModal("login",e,t)},"Log in")])])},yT={view(){const e=va.downloadsRemaining();return Oe(".modal-box.download-count-modal",[Oe("h1","Youre making a lot of cool stuff!"),Oe("h3","Join ",Oe("a[href=/pricing][target=CuttlePricingWindow]","Cuttle Pro")," for unlimited downloads."),Oe("p.downloads-remaining","You have ",e>0?Oe("strong",e):"no more"," free ",1===e?"download":"downloads"," remaining this month."),Oe(".editor-modal-actions",[Oe("button",{onclick:()=>fT("downloads",!0)},"Join Cuttle Pro"),Oe("button.secondary",{onclick:()=>ia.close()},"No thanks")])])}},bT=async()=>{const e=Oj.business.canDownload();if(!1===e.hasAccess){if("no-minisite"===e.reason)return Na.openDownloadPaywall(),!1;if("no-pro"===e.reason)return fT(e.feature,!0),!1;if("no-auth"===e.reason){return!!(await new Promise(e=>{const t=()=>e(!0),n=()=>e(!1);ia.open({modalView:()=>Oe(vT,{onSuccess:t,onDismiss:n}),onDismiss:n})}))&&await bT()}return!1}return!0===e.hasAccess},wT=()=>{if(!va.loggedInUser)return;const e=Oj.business.canDownload();if(!e.hasAccess)return;if(!e.shouldCountTowardsDownloadLimit)return;const t=(va.downloadsThisMonth()||0)+1;va.incrementDownloadsThisMonth(),t>=7&&(()=>{if(va.featureFlags.canDownloadUnlimitedFree)return;const e=va.downloadsThisMonth()??0;Ao("download count modal",{downloadsThisMonth:e}),ia.open({modalView:()=>Oe(yT)})})()},xT={view({attrs:{checked:e,disabled:t,mixed:n,onclick:i}}){const r=Oe("input[type=checkbox]",{disabled:t,checked:e,"aria-checked":n?"mixed":e?"true":"false",onclick:i}),s=Oe(Jo,{icon:n?"checkbox_mixed":e?"checkbox_checked":"checkbox_unchecked"});return Oe(".checkbox",[s,r])}},CT={view:()=>{var e;const t=Boolean(null==(e=va.storage)?void 0:e.hasHiddenScoreHint),n=Oe("label"+ST.DontShowAgain,[Oe(xT,{checked:t,onclick:()=>{va.storageUpdate({hasHiddenScoreHint:!t})}}),"Dont show this again"]);return Oe(".simple-modal-box"+ST.ScoreHintModal,[Oe("img"+ST.Image,{src:"/editor/images/score-vs-cut.jpg",alt:"Scoring draws thin lines on the surface of the material but does not cut through.",width:"700",height:"264"}),Oe(".simple-modal-contents",[Oe.trust("<p>This design uses <strong>scoring</strong>. Make sure to set the blue lines to <strong>score</strong> in your laser cutter software. We have video tutorials for Glowforge, xTool, Lightburn, and more if youre new to scoring.</p>")]),Oe(".simple-modal-actions",[n,Oe(vL,{primaryAction:{label:"Learn how to score",action:()=>{window.open("https://cuttle.xyz/learn/how-to-score-on-a-laser-cutter","_blank")}},cancelAction:{label:"I already know how to score",action:()=>{}}})])])}},ST=qL.classes({ScoreHintModal:{width:650},Image:{maxWidth:"100%",height:"auto"},DontShowAgain:{display:"flex",flexDirection:"row",gap:4,flexGrow:1}});class kT{constructor(e,t){this.gesturePrevX=0,this.gesturePrevY=0,this.gesturePrevScale=0,this.element=e;let n=Oj.deviceStorage.pointerInitShown;this.onWheelEvent=e=>{if(e.preventDefault(),!n)return n=!0,void Oj.openPointerInitModal();const i=(e=>{let{deltaX:t,deltaY:n,deltaMode:i}=e;if(1===i){const e=100/3;t*=e,n*=e}else if(2===i){const e=800;t*=e,n*=e}return{deltaX:t,deltaY:n}})(e);let r=0,s=0,o=1;const a=e.ctrlKey&&!Oj.isControlDown&&!Oj.isMetaDown,l="zoom"===Oj.deviceStorage.scrollBehavior,c=e.ctrlKey||e.metaKey;a||(!l&&c||l&&!c)?o=Math.pow(a?1.01:1.001,-i.deltaY):(r=i.deltaX,s=i.deltaY),t({deltaX:r,deltaY:s,deltaScale:o}),Oe.redraw()},this.onGestureStart=e=>{const t=e;t.preventDefault(),this.gesturePrevX=t.clientX,this.gesturePrevY=t.clientY,this.gesturePrevScale=1},this.onGestureChange=e=>{const n=e;n.preventDefault();let i=n.clientX-this.gesturePrevX,r=n.clientY-this.gesturePrevY,s=n.scale-this.gesturePrevScale+1;this.gesturePrevX=n.clientX,this.gesturePrevY=n.clientY,this.gesturePrevScale=n.scale,t({deltaX:i,deltaY:r,deltaScale:s}),Oe.redraw()},this.onGestureEnd=e=>{e.preventDefault()},this.element.addEventListener("wheel",this.onWheelEvent),this.element.addEventListener("gesturestart",this.onGestureStart),this.element.addEventListener("gesturechange",this.onGestureChange),this.element.addEventListener("gestureend",this.onGestureEnd)}dispose(){this.element.removeEventListener("wheel",this.onWheelEvent),this.element.removeEventListener("gesturestart",this.onGestureStart),this.element.removeEventListener("gesturechange",this.onGestureChange),this.element.removeEventListener("gestureend",this.onGestureEnd)}}const LT=e=>{const t=Oj.project.focusedComponent();Ps(t,"A focused component is required for precision info.");const n=1/Oj.viewportManager.viewportForComponent(t).pixelsPerUnit,i=Math.round(Math.log10(n)),r=Math.pow(10,i),{a:s,b:o,c:a,d:l}=e,c=Math.abs(s),h=Math.abs(o),u=Math.abs(a),d=Math.abs(l);let p=1/0;c>0&&c<p&&(p=c),h>0&&h<p&&(p=h),u>0&&u<p&&(p=u),d>0&&d<p&&(p=d);return{fractionDigits:p===1/0?1:Math.max(0,-Math.floor(Math.log10(p*r))),increment:r,exponent:i}},ET=e=>{const t=Oj.project.focusedComponent();Ps(t,"A focused component is required for precision info");const n=e.startPoint.worldPosition.clone(),i=e.currentPoint.worldPosition.clone(),r=Oj.viewportManager.viewportForComponent(t),{fractionDigits:s}=r.precisionInfo();return e.isPreciseH()||(n.x=ps(n.x,s),i.x=ps(i.x,s)),e.isPreciseV()||(n.y=ps(n.y,s),i.y=ps(i.y,s)),{startPosition:n,currentPosition:i}},PT=(e,t)=>{const n=e.worldPosition.clone().affineTransform(t),{fractionDigits:i}=LT(t);return e.isPreciseH||(n.x=ps(n.x,i)),e.isPreciseV||(n.y=ps(n.y,i)),{contextPosition:n,fractionDigits:i}},TT=e=>{const t=Oj.gridIncrement();return e.roundToMultiple(t)},AT=(e,{enableGridSnapping:t=Oj.deviceStorage.gridSnappingEnabled,enableGeometrySnapping:n=Oj.deviceStorage.geometrySnappingEnabled}={})=>{n&&Oj.snapping.currentPoint?e.copy(Oj.snapping.currentPoint):t&&(TT(e.worldPosition),e.isPreciseH=!0,e.isPreciseV=!0,e.isSpecific=!1)},MT=e=>{const{canvasRectPixels:t}=Oj;return new It(e.clientX-t.x,e.clientY-t.y)},IT=e=>e.floor().addScalar(.5),_T=e=>{const t=Oj.project.focusedComponent();Ps(t,"A focused component is required to convert from pixel position");const n=Oj.viewportManager.viewportForComponent(t).viewMatrixWithCanvasDimensions(Oj.canvasDimensions).invert();return e.clone().affineTransform(n)},OT=e=>{const t=MT(e);return _T(t)};new It(1,0),new It(0,1),new It(1,1).normalize(),new It(1,-1).normalize();const NT=e=>new Promise(t=>{const n=document.createElement("input");n.setAttribute("type","file"),n.setAttribute("accept",e.accept),e.multiple&&n.setAttribute("multiple","true"),n.style.position="fixed",n.style.top="-1080px",document.body.appendChild(n),n.addEventListener("change",e=>{const n=e.target.files;n?t(n):t(),i()}),n.click();const i=()=>{var e;null==(e=n.parentElement)||e.removeChild(n),window.removeEventListener("click",r)},r=()=>{t(),i()};setTimeout(()=>{window.addEventListener("click",r)})}),DT=()=>window.devicePixelRatio||1;const RT=()=>va.featureFlags.hasAdminFeatures||"local"===Oj.storage.type,FT=()=>RT()&&(Oj.isAltDown||Oj.deviceStorage.showAdminFeatures),BT=e=>{const t=Oj.business.hasProFeature(e);return t||fT(e,!0),t},VT=e=>0===e.length?[]:e.reduce((e,t,n)=>(n>0&&e.push(", "),e.push(Oe("strong",t)),e),[]);const jT=new class{show(e){this.toast=e,!1!==e.autoHide&&this.setTimeout(),Oe.redraw()}showBasic(e){this.show({view:()=>Oe(zT,e)})}clearTimeout(){this.timeout&&(window.clearTimeout(this.timeout),this.timeout=void 0)}setTimeout(){this.clearTimeout(),this.timeout=window.setTimeout(()=>this.dismiss(),7e3)}dismiss(){this.clearTimeout(),this.toast=void 0,Oe.redraw()}},HT=e=>{e.stopPropagation()},UT={view(){var e;return Oe(".toast-container",{onpointerover:()=>jT.clearTimeout(),onpointerout:()=>jT.setTimeout(),onclick:HT},[null==(e=jT.toast)?void 0:e.view(),Oe(KT)])}},zT={view(e){const{type:t,message:n,nextStep:i}=e.attrs;return Oe(".toast-message",{className:t},[Oe(".message",n),i&&Oe(".next-step",Oe("span.next-step-icon",""),i)])}},WT={view(e){const{message:t,copiedOrPasted:n}=e.attrs;return Oe(".toast-message.clipboard",[Oe(".message",GT(t,n))])}},GT=(e,t)=>{const n=[e];if(t instanceof hS){const e=t.directlySelectedNodes().sortInDocumentOrder().items.map(e=>e.node.source),i=t.allInstances().sortInDocumentOrder().items.map(e=>e.instance);if(i.length){n.push(" ");const e=i.map(e=>e.definition.name);n.push($T(e))}else if(e.length){n.push(" ");const t=e.map(e=>e.name);n.push($T(t))}}else n.push(" ",Oe("strong",t.name));return n.push("."),n};function $T(e){const t=[];return e.length<=3?t.push(VT(e)):(t.push(VT(e.slice(0,2))),t.push(` and ${e.length-2} more`)),t}let ZT=!1;const qT=()=>{ZT||(ZT=!0,(()=>{const e=navigator.maxTouchPoints>0,t=window.matchMedia("(any-pointer:fine)").matches;return e&&!t})()&&jT.showBasic({type:"warning",message:"Cuttle does not currently support touch screen input.",nextStep:"Try viewing this project on a computer with a mouse or trackpad."}))},KT={view:()=>{if(Oj.storage.hasWritePermission())return;if(Oj.storage.sequenceToLoad())return;if(!Oj.isEditingMode())return;const e=Oj.storage.getProjectOwner();return Oe(".toast-message.info.copy-project-toast",[Oe(".message","This project is owned by ",Oe("a",{href:"/@"+e,target:"_blank"},`@${e}`),". Make a copy to save your changes."),Oe(".toast-actions",Oe(YT))])}},YT=()=>{let e=!1;const t=async()=>{if(e)return;e=!0;const t=await Oj.snapshotPayload(),n=await Oj.storage.saveCopy(t);e=!1,n?jT.showBasic({type:"info",message:"You made a copy. Your changes will now save to your account."}):Oe.redraw()};return{view:()=>Oe("button",{onclick:t,disabled:e},e?"Copying...":"Copy This Project")}};window.addEventListener("beforeprint",()=>{Oj.isEditingMode()&&jT.show({view:()=>Oe(".toast-message",["Want to print your design? Select File > Print from ",Oe("em","Cuttles")," menu (not the browsers menu) or ",Oe('span[role="link"]',{onclick:e=>{e.preventDefault(),tA(),jT.dismiss()}},"click here"),"."]),autoHide:!1})});const XT=()=>{jT.showBasic({type:"error",message:"A path with an image fill was too large to be rasterized.",nextStep:"Try disabling Rasterize Images in settings, or set Rasterizing Resolution to a lower number."})},JT=(e,t)=>{t instanceof hS&&(t=t.clone()),jT.show({view:()=>Oe(WT,{message:e,copiedOrPasted:t})})},QT=async e=>{try{await WP(e),e.length>0&&(eA(e[0].component.name,e[0].format),wT(),rA(e))}catch(t){t instanceof rr&&XT()}},eA=(e,t)=>{Ao("project downloaded",{component:e,format:t,license:Oj.storage.getProjectLicense(),creditId:Oj.storage.getCreditId()})},tA=()=>{const e=Oj.project.focusedComponent();e&&nA(e)},nA=async e=>{if(!(await bT()))return;const t=Oj.traceForComponent(e);if(!(null==t?void 0:t.isSuccess()))return;const{settings:n}=Oj.project,i=jP(t.result,n.units);if(!i)return;const r=zP(i,"pt");try{const t=EP(n),i=RP(r,t),s=await PP(i,r.artboard.size());TP(s),Ao("project printed",{component:e.name}),wT()}catch(s){s instanceof rr&&XT()}},iA=e=>{const t=[];if(Oj.project.focusedComponent()){const e=Oj.evaluator.evaluateElementsWithinFocusedComponent(Oj.project,Oj.project.selectionElements().filter(e=>e.isVisible&&"show-all-as-guides"!==e.guidesDisplay));for(let n of e)n.isSuccess()&&t.push(n.result)}const n=new xi(t),{settings:i}=Oj.project,r=VP(n,i.units),s=EP(i);s.comment=ES.fromPortableProjectData(e).toString();const o=zP(r,"pt");return FP(o,s)},rA=e=>{var t;if(!(Oj.storage.isOfficialCuttleTemplate()||Oj.storage.isProTemplate()))return;if(null==(t=va.storage)?void 0:t.hasHiddenScoreHint)return;e.some(e=>{return("svg"===(t=e.format)||"cuttle.svg"===t||"pdf"===t||"dxf"===t)&&sA(e.component);var t})&&ia.open({modalView:()=>Oe(CT)})},sA=e=>{const t=Oj.traceForComponent(e);if(!(null==t?void 0:t.isSuccess()))return;const n=new Gn(0,0,1,1);return t.result.allPaths().some(e=>e.stroke&&e.stroke.hairline&&e.stroke.color.equals(n))};function oA(e,t){const{elements:n,instances:i,components:r,modifiers:s,projectParameters:o,componentParameters:a}=t,l=aA(t);if(n.length>0&&!(e.focus instanceof CC))return void jT.showBasic({type:"error",message:"Can't paste that here.",nextStep:"Focus a component to paste that."});for(let d of o)e.hasParameterWithName(d.name)||e.parameters.push(d);if(e.focus instanceof CC)for(let d of a)e.focus.component.hasParameterWithName(d.name)||e.focus.component.parameters.push(d);const c=new Map;for(let d of r){if(mb(d)){console.warn("Paste contained a built-in component!",d);continue}const t=e.componentByName(d.name);if(t){if(n.length>0&&e.focus instanceof CC&&t===e.focus.component)return void jT.showBasic({type:"error",message:`Can't paste an instance of ${d.name} into itself.`,nextStep:"You can duplicate this component and paste there."});if(l&&(t.name===l.name||t.id===l.id))return void jT.showBasic({type:"error",message:`${t.name} already exists.`,nextStep:"If you want another version, you can choose Duplicate Component in the component menu."});c.set(d,t)}else d.isImmutable?e.insertComponent(d,0):e.insertComponent(d),c.set(d,d)}for(let d of s){if(mb(d)){console.warn("Paste contained a built-in modifier!",d);continue}const t=e.modifierByName(d.name);t?c.set(d,t):(e.modifiers.push(d),c.set(d,d))}const h=e=>{if(!mb(e))if(e instanceof wx){if(mb(e.definition))return;e.definition=c.get(e.definition),Ps(e.definition,"item.definition not found while relinking during paste or import.")}else e instanceof bx?(e.allInstances().forEach(h),e.children.forEach(h)):e instanceof vb&&h(e.element)};if(n.forEach(h),r.forEach(h),s.forEach(h),l)return l;const u=e.selection.allNodes();if(i.length&&u.items.length){const t=[];for(let e of u.items){const n=e.node.source;for(let r of i){const i=r.clone();n.pasteModifier(i),t.push(new sS(e.node,i))}}e.selectItems(t)}else if(n.length>0){const{insertionParent:t,insertionIndex:i}=e.insertionPoint({forbidCollapsedParentPath:!0}),r=e.spliceNodes([],n,t,i);e.selectNodes(r);const s=e.makeElementNameGenerator();for(const o of n)e.ensureUniqueNames(o,s)}else e.selection.clear();return e.selection}const aA=e=>{if(0===e.elements.length&&0===e.instances.length&&e.components.length>0)return e.components[0]},lA={view:()=>{const e=e=>()=>{Oj.deviceStorage.scrollBehavior=e,t(),ia.close()},t=()=>{const e=document.querySelector('[data-automation-id="top-menu-item-view"]');e&&Vo({spawnFrom:e,placement:"top-start",offset:4,className:"tooltip arrow-top-start",overlay:"closeOnOutsidePointerDown",view:()=>Oe("div",["You can change trackpad or mouse scroll",Oe("br"),"behavior here in the ",Oe("strong","View")," menu."])})};return Oe(mL,{title:"What are you using now?",actions:[],onClose:t,widthAuto:!0},Oe(".pointer-init-modal-contents",[Oe(".buttons",[Oe("button.secondary",{onclick:e("pan")},[Oe("img",{alt:"",src:"/editor/images/trackpad.svg",width:100,height:100}),"Trackpad"]),Oe("button.secondary",{onclick:e("zoom")},[Oe("img",{alt:"Mouse",src:"/editor/images/mouse.svg",width:100,height:100}),"Mouse"])]),"We'll set up Cuttle's zoom and pan controls to match your choice."]))}},cA={Path:0,Axis:1,Point:100,Intersection:110,Midpoint:120,Anchor:130,Corner:140,Endpoint:150,Box:200,Handle:210,Origin:220};class hA extends hC{constructor(e,t,n,i){let r=!0,s=!0;if(i){r=!1,s=!1;for(let{geometry:e}of i){if(!(e instanceof Rn||e instanceof Bn)){r=!0,s=!0;break}r||(r=!e.isHorizontal()),s||(s=!e.isVertical())}}super(e,r,s,"Path"!==n&&"Axis"!==n),this.name=t,this.category=n,this.sources=i}clone(){var e;return new hA(this.worldPosition.clone(),this.name,this.category,null==(e=this.sources)?void 0:e.slice())}message(){return this.name||this.category}}class uA{constructor(e,t){this.name=e,Array.isArray(t)||(t=[t]),this.geometry=gA(t)}}class dA{constructor(){this.points=[],this.geometry=[],this.referencePoints=[],this.referenceGeometry=[],this.clear()}cacheSnappingDataForInterface(e,{isSource:t=!1,skipReferencePoints:n=!1,skipReferenceGeometry:i=!1}={}){this.points=vA(e,t),this.geometry=mA(e,t),n||(this.referencePoints=yA(e,t)),i||(this.referenceGeometry=this.referencePoints.flatMap(e=>wA(this.geometry,e))),this.intersectionGeometry=void 0}cacheSnappingDataForHoveredInterface(){const{hoveredInterfaceElement:e}=Oj;e&&(this.cacheSnappingDataForInterface([e],{isSource:!0}),this.intersectionGeometry=xA(mA(Oj.interfaceElements.filter(t=>t!==e),!1)))}addReferencePoint(e,t){this.referencePoints.push(e),t||(t=wA(this.geometry,e)),this.referenceGeometry.push(...t)}updateSnappingPointNearWorldPosition(e,{isSource:t=!1}={}){const n=Oj.snappingDistanceWorld(),i=Oj.deviceStorage.gridSnappingEnabled?Oj.gridIncrement():0;let r;if(Oj.deviceStorage.gridSnappingEnabled){const n=TT(e.clone());r=pA(n,je,je,t,i,this.points,this.geometry,this.intersectionGeometry)}const s=pA(e,n,n,t,i,this.points,this.geometry,this.intersectionGeometry);if(r&&s){const e=cA[r.category],t=cA[s.category];this.currentPoint=t>e?s:r}else this.currentPoint=r||s}updateReferenceSnappingPointNearWorldPosition(e,{isSource:t=!1}={}){const n=Oj.snappingDistanceWorld(),i=Oj.deviceStorage.gridSnappingEnabled?Oj.gridIncrement():0;this.currentPoint=pA(e,1/0,n,t,i,[],this.referenceGeometry,xA(this.geometry))}clear(){this.points=[],this.referencePoints=[],this.geometry=[],this.referenceGeometry=[],this.currentPoint=void 0,this.intersectionGeometry=void 0}clearCurrentPoint(){this.currentPoint=void 0}clearReference(){this.referencePoints=[],this.referenceGeometry=[]}}const pA=(e,t,n,i,r,s,o,a)=>{const l=bA(o,t,e,r);if(s=s.concat(l),a){const n=new De(e.clone().subScalar(t),e.clone().addScalar(t)),i=Dn.intersectionsBetweenSets(xA(o),a,n);for(let e of i)s.push(CA(e))}return i&&(s=s.filter(e=>e.isSpecific)),fA(e,t,n,s)},fA=(e,t,n,i)=>{if(0===i.length)return;const r=t*t,s=n*n;let o,a=1/0,l=-1;for(let c of i){let t=e.distanceSquared(c.worldPosition);if("Box"===c.category&&(t=0),t>r)continue;const n=cA[c.category];n<l||(t<a||n>l&&t<s)&&(o=c,l=n,a=t)}return o},mA=(e,t)=>{const n=[];for(let i of e)if(i.snappingGeometry){const e=i.snappingGeometry(t);Array.isArray(e)?n.push(...e):void 0!==e&&n.push(e)}return n},gA=e=>{const t=[],n=e=>{if(e instanceof xi)for(let t of e.items)n(t);else if(e instanceof wi)for(let t of e.paths)n(t);else t.push(e)};for(let i of e)n(i);return t},vA=(e,t)=>{const n=[];for(let i of e)if(i.snappingPoints){const e=i.snappingPoints(t);e instanceof hA?n.push(e):void 0!==e&&n.push(...e)}return n},yA=(e,t)=>{const n=[];for(let i of e)if(i.snappingReferencePoints){const e=i.snappingReferencePoints(t);e instanceof It?n.push(e):void 0!==e&&n.push(...e)}return n},bA=(e,t,n,i)=>{const r=t*t,s=new De(n.clone().subScalar(t),n.clone().addScalar(t)),o=[];for(let{name:l,geometry:c}of e)for(let e of c)if(e instanceof It){e.distanceSquared(n)<=r&&o.push(new hA(e,l,"Point"))}else if(e instanceof Wn){const{position:t}=e;t.distanceSquared(n)<=r&&o.push(new hA(t,l,"Anchor"))}else if(e instanceof Rn||e instanceof jn){const t=e.closestPoint(n,s);if(t){const s=At(t.time,i),a=e.positionAtTime(s);n.distanceSquared(a)<=r&&o.push(new hA(a,l,"Axis",[{geometry:e,time:s}]))}}else if(e instanceof Ri){const{anchors:t,closed:i}=e;for(let s=0,a=t.length;s<a;++s){const l=t[s];if(l.position.distanceSquared(n)<=r){let t="Anchor";i||s>0&&s<a-1?l.hasTangentHandles()||(t="Corner"):t="Endpoint";const n=new hA(l.position,t,"Anchor",[{geometry:e.anchorAtTime(s)}]);o.push(n)}}if(t.length>=2){const t=e.closestPoint(n,s);if(t){if(n.distanceSquared(t.position)<=r){const n=e.segmentAtTime(t.time);o.push(new hA(t.position,"Path","Path",[{geometry:n,time:Lt(t.time)}]))}}const i=e.segments();for(let e of i)if(e instanceof Bn){const t=e.positionAtTime(.5);n.distanceSquared(t)<=r&&o.push(new hA(t,"Midpoint","Midpoint",[{geometry:e,time:.5}]))}}}else if(e instanceof Bn||e instanceof Fn){const t=e.closestPoint(n,s);if(t){n.distanceSquared(t.position)<=r&&o.push(new hA(t.position,"Path","Path",[{geometry:e,time:t.time}]))}if(e instanceof Bn){const t=e.positionAtTime(.5);n.distanceSquared(t)<=r&&o.push(new hA(t,"Midpoint","Midpoint",[{geometry:e,time:.5}]))}}const a=Dn.intersectionsBetweenAll(xA(e),s);for(let l of a)o.push(CA(l));return o},wA=(e,t)=>{const n=[],i=je,r=new De(t.clone().subScalar(i),t.clone().addScalar(i)),s=(e,i)=>{const r=e.tangentAtTime(i),s=new Rn(t,r),o=r.clone().rotate90(),a=new Rn(t,o);n.push(new uA("Normal",a),new uA("Tangent",s))};for(let{geometry:o}of e)for(let e of o)if(e instanceof Wn){if(r.containsPoint(e.position)){if(!e.handleIn.isZero()&&!e.hasTangentHandles()){const t=new Rn(e.position,e.handleIn),i=new Rn(e.position,e.handleIn.clone().rotate90());n.push(new uA("Normal",i),new uA("Tangent",t))}if(!e.handleOut.isZero()){const t=new Rn(e.position,e.handleOut),i=new Rn(e.position,e.handleOut.clone().rotate90());n.push(new uA("Normal",i),new uA("Tangent",t))}}}else if(e instanceof Ri){if(e.anchors.length>=2){const n=e.closestPoint(t,r);if(n){const{time:t}=n;if(Number.isInteger(t)){if(e.closed||t>0){s(e.segmentAtTime(t-1),1)}if(e.closed||t<e.anchors.length-1){s(e.segmentAtTime(t),0)}}else s(e,t)}}}else if(e instanceof Bn||e instanceof Fn){const n=e.closestPoint(t,r);n&&s(e,n.time)}else if(e instanceof Rn){if(e.closestPoint(t,r)){const i=new Rn(t,e.direction.clone().rotate90());n.push(new uA("Perpendicular",i))}}return n.push(new uA("Horizontal",new Rn(t,new It(1,0))),new uA("Vertical",new Rn(t,new It(0,1)))),n},xA=e=>e.flatMap(e=>e.geometry.filter(e=>e instanceof Dn)),CA=e=>new hA(e.position,"","Intersection",[{geometry:e.primitive1,time:e.time1},{geometry:e.primitive2,time:e.time2}]),SA=(e,t,n)=>{const i=[];i.push(new uA("Horizontal",new Rn(e,new It(1,0))),new uA("Vertical",new Rn(e,new It(0,1))));for(let r=n-180;r<=180;r+=n){const n=t+r;if(n%90==0)continue;const s=`${r>0?"+":""}${Db(r)}`;i.push(new uA(s,new jn(e,It.fromAngle(n))))}return i},kA=(e,t,n)=>{const i=Oj.traceForNode(e);if(!i)return;const r=(i.stroke??i.fill??i.transform??i.base).result;if(!r)return;const s=Oj.project.selection.isNodeDirectlySelected(e),o=Oj.project.isNodeHovered(e),a=s&&!e.source.hasEnabledModifier();let l=qL.color.black,c=1;s?(l=qL.color.blue63,c=2):o&&(l=qL.color.blue53,c=2);const h=$C(e),u=t.clone().mul(h);PA(r,l,c,s,a,u,n)},LA=(e,t,n,i)=>{const r=Oj.traceForNode(e),s=null==r?void 0:r.traceForInstance(t);if(null==s?void 0:s.isSuccess()){const r=ZC(e,t),o=n.clone().mul(r);PA(s.result,qL.color.green60,2,!1,!0,o,i)}},EA=(e,t,n,i,r)=>{const s=t.a,o=e.clone().affineTransform(t).scaleStroke(s);r&&!o.hasStyle()&&o.assignStroke(new Vi),sr(o,n,i)},PA=(e,t,n,i,r,s,o)=>{if(e instanceof xi)for(let a of e.items)PA(a,t,n,i,r,s,o);else if(e instanceof Wn){const n=e.clone().affineTransform(s);TA(n,t,i,o)}else if(e instanceof Ri&&1===e.anchors.length){const n=e.anchors[0].clone().affineTransform(s);TA(n,t,i,o)}else if(e instanceof Ri||e instanceof wi){o.lineCap="round",o.lineJoin="round",o.lineWidth=n,o.strokeStyle=t,o.beginPath();const i=e.clone().affineTransform(s);lr(i,o),r&&(r&&(r=void 0===e.fill),e instanceof wi?r&&(r=e.paths.every(e=>e.closed)):r&&(r=e.closed),r&&(o.fillStyle=t,o.globalAlpha=.06,o.fill("evenodd"),o.globalAlpha=1)),o.stroke()}else if(e instanceof It){const n=e.clone().affineTransform(s);AA(n,2.15,t,o)}else if(e instanceof Rn){const i=e.clone().affineTransform(s);if(i.direction.isZero())return;const r=new De(new It,new It(o.canvas.width,o.canvas.height)),a=MA(i,r);if(2===a.length){const[e,i]=a;o.strokeStyle=t,o.lineCap="square",o.lineWidth=n,o.beginPath(),o.moveTo(e.x,e.y),o.lineTo(i.x,i.y),o.stroke()}}else if(e instanceof jn){const i=e.clone().affineTransform(s),{origin:r,direction:a}=i;if(a.isZero())return;const l=1e5/a.length(),c=a.x*l,h=a.y*l;o.strokeStyle=t,o.lineCap="butt",o.lineWidth=n,o.beginPath(),o.moveTo(r.x,r.y),o.lineTo(r.x+c,r.y+h),o.stroke()}else if(e instanceof Bn){const i=e.clone().affineTransform(s);o.lineCap="round",o.lineJoin="round",o.lineWidth=n,o.strokeStyle=t,o.beginPath(),o.moveTo(i.s.x,i.s.y),o.lineTo(i.e.x,i.e.y),o.stroke()}else if(e instanceof Fn){const i=e.clone().affineTransform(s);o.lineCap="round",o.lineJoin="round",o.lineWidth=n,o.strokeStyle=t,o.beginPath();const{s:r,cs:a,ce:l,e:c}=i;o.moveTo(r.x,r.y),o.bezierCurveTo(a.x,a.y,l.x,l.y,c.x,c.y),o.stroke()}},TA=(e,t,n,i)=>{const r=Math.floor(e.position.x)+.5,s=Math.floor(e.position.y)+.5,o=n?4:3;i.fillStyle=t,i.strokeStyle=qL.color.white,i.lineWidth=1,i.beginPath(),e.hasTangentHandles()?i.ellipse(r,s,o,o,0,0,ze):i.rect(r-o,s-o,2*o,2*o),i.fill(),i.stroke()},AA=(e,t,n,i)=>{const r=Math.floor(e.x)+.5,s=Math.floor(e.y)+.5;i.fillStyle=n,i.strokeStyle=qL.color.white,i.lineWidth=1,i.beginPath(),i.ellipse(r,s,t,t,0,0,ze),i.fill(),i.stroke()},MA=(e,t)=>Ri.fromBoundingBox(t).intersectionsWith([e]).map(e=>e.position);let IA=!1;const _A=(e,{onConsummate:t,onCancel:n,onMove:i,onUp:r,isValid:s,cursor:o})=>{const a=new It(e.clientX,e.clientY),l=e.timeStamp,c="mousedown"===e.type;let h=!1;const u=e=>e instanceof PointerEvent,d=t=>{u(e)&&t.pointerId===e.pointerId&&f(t)},p=e=>{f(e)},f=e=>{if(void 0!==s&&!s())return w(),void(null==n||n(e));if(h)null==i||i(e),Oe.redraw();else{const n=new It((r=e).clientX,r.clientY);(e.timeStamp-l>=200||n.distance(a)>=4)&&(h=!0,null==t||t(e),Oe.redraw())}var r;y()},m=t=>{u(e)&&t.pointerId===e.pointerId&&v(t)},g=e=>{v(e)},v=e=>{w(),Oe.redraw(),(void 0===s||s())&&h?null==r||r(e):null==n||n(e)},y=()=>{o&&window.document.body.setAttribute("data-css-cursor",o())},b=e=>{e.preventDefault(),e.stopPropagation(),y()},w=()=>{IA=!1,c?(window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",g)):(window.removeEventListener("pointermove",d),window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",m)),window.removeEventListener("keydown",b),window.removeEventListener("keyup",b),o&&window.document.body.removeAttribute("data-css-cursor"),Oj.stopGesture(x)};c?(window.addEventListener("mousemove",p),window.addEventListener("mouseup",g)):(window.addEventListener("pointermove",d),window.addEventListener("pointerup",m),window.addEventListener("pointercancel",m)),window.addEventListener("keydown",b),window.addEventListener("keyup",b),IA=!0;const x=Oj.startGesture("startDrag")},OA=(e,{stringValue:t,fractionDigits:n,onChange:i,onUp:r,onCancel:s})=>{let o=+t,a=e;_A(e,{cursor:()=>"ew-resize",onConsummate(e){a=e},onMove(e){const t=(e.clientX-a.clientX)/3,r=e.shiftKey?-1:e.altKey?1:0,s=n+r;o+=t*Math.pow(10,-s);const l=Math.max(0,s);let c=o.toFixed(l);0===+c&&(c=(0).toFixed(l)),i(c),a=e},onUp:r,onCancel:s})},NA=(e,{enableGridSnapping:t,enableGeometrySnapping:n=Oj.deviceStorage.geometrySnappingEnabled,disableDisplay:i,disableGhost:r,disableSnappingCache:s,rotationTransformCenter:o,rotationReferenceStartAngle:a,startWorldPosition:l,onConsummate:c,onMove:h,onUp:u,onCancel:d,isValid:p,cursor:f})=>{const m=OT(e),g=new It;l?g.copy(l).sub(m):n&&Oj.snapping.currentPoint?(l=Oj.snapping.currentPoint.worldPosition,g.copy(l).sub(m)):l=m;const v=new Aj(new hC(l));i||(Oj.canvasDrag=v),AT(v.startPoint,{enableGridSnapping:t,enableGeometrySnapping:n});const y=()=>{Oj.clearGhostGeometry(),Oj.snapping.cacheSnappingDataForHoveredInterface(),Oj.snapping.updateSnappingPointNearWorldPosition(v.currentPoint.worldPosition),Oj.canvasDrag=void 0},b=2*Oj.snappingDistanceWorld();let w=!1;_A(e,{isValid:p,cursor:f,onConsummate(e){if(r||Oj.updateGhostGeometry(),!s&&Oj.deviceStorage.geometrySnappingEnabled){o&&(Oj.snapping.referencePoints=[o],Oj.snapping.referenceGeometry=SA(o,a??0,15));const e=Boolean(o);Oj.snapping.cacheSnappingDataForInterface(Oj.interfaceElements,{skipReferencePoints:e,skipReferenceGeometry:e})}null==c||c(e,v)},onMove(e){const i=OT(e).add(g);v.currentPoint=new hC(i),w||(w=v.distance()>b),w?(e.shiftKey?Oj.snapping.updateReferenceSnappingPointNearWorldPosition(i):v.startPoint.isSpecific?Oj.snapping.updateSnappingPointNearWorldPosition(i):Oj.snapping.clearCurrentPoint(),AT(v.currentPoint,{enableGridSnapping:t,enableGeometrySnapping:n})):Oj.snapping.clearCurrentPoint(),null==h||h(e,v)},onUp(e){y(),null==u||u(e)},onCancel(){y(),null==d||d()}})},DA=(e,t,n,i)=>{let r;NA(e,{disableDisplay:!0,disableGhost:!0,disableSnappingCache:null==i?void 0:i.disableSnappingCache,isValid:()=>Oj.project.nodeExists(t),onConsummate(e,i){const s=oS.fromName(t,t.source.base,n);r=new VC(s)},onMove(e,n){const s=Oj.traceForNode(t);if(!(null==s?void 0:s.base.isSuccess()))return;const o=s.base.args.position.evaluationResult,{currentPosition:a}=ET(n),l=$C(t).clone().invert(),c=a.clone().affineTransform(l).sub(o);(null==i?void 0:i.flip)&&c.negate();const h=(null==i?void 0:i.allowBreaking)&&e.altKey?"free":null==i?void 0:i.overrideAnchorHandleConstraint,u="free"===h?"free":null==i?void 0:i.assignAnchorHandleConstraint;r.assignValue(c,{overrideAnchorHandleConstraint:h,assignAnchorHandleConstraint:u})}})},RA=e=>"ArrowLeft"===e.key?(FA(new It(-1,0),e.shiftKey),!0):"ArrowRight"===e.key?(FA(new It(1,0),e.shiftKey),!0):"ArrowUp"===e.key?(FA(new It(0,-1),e.shiftKey),!0):"ArrowDown"===e.key&&(FA(new It(0,1),e.shiftKey),!0),FA=(e,t)=>{const{project:n}=Oj;if(n.selection.isImmutable())return;const i=n.focusedComponent();if(!i)return;let r;if(Oj.deviceStorage.gridSnappingEnabled)r=Oj.gridIncrement();else{const e=Oj.viewportManager.viewportForComponent(i);({increment:r}=e.precisionInfo())}t&&(r*=10);const s=Ne.fromTranslation(e.clone().mulScalar(r));new FC(n.selection).transformWorld(s)};function BA(e){this.content=e}function VA(e,t,n){for(let i=0;;i++){if(i==e.childCount||i==t.childCount)return e.childCount==t.childCount?null:n;let r=e.child(i),s=t.child(i);if(r!=s){if(!r.sameMarkup(s))return n;if(r.isText&&r.text!=s.text){for(let e=0;r.text[e]==s.text[e];e++)n++;return n}if(r.content.size||s.content.size){let e=VA(r.content,s.content,n+1);if(null!=e)return e}n+=r.nodeSize}else n+=r.nodeSize}}function jA(e,t,n,i){for(let r=e.childCount,s=t.childCount;;){if(0==r||0==s)return r==s?null:{a:n,b:i};let o=e.child(--r),a=t.child(--s),l=o.nodeSize;if(o!=a){if(!o.sameMarkup(a))return{a:n,b:i};if(o.isText&&o.text!=a.text){let e=0,t=Math.min(o.text.length,a.text.length);for(;e<t&&o.text[o.text.length-e-1]==a.text[a.text.length-e-1];)e++,n--,i--;return{a:n,b:i}}if(o.content.size||a.content.size){let e=jA(o.content,a.content,n-1,i-1);if(e)return e}n-=l,i-=l}else n-=l,i-=l}}BA.prototype={constructor:BA,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var i=n&&n!=e?this.remove(n):this,r=i.find(e),s=i.content.slice();return-1==r?s.push(n||e,t):(s[r+1]=t,n&&(s[r]=n)),new BA(s)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new BA(n)},addToStart:function(e,t){return new BA([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new BA(n)},addBefore:function(e,t,n){var i=this.remove(t),r=i.content.slice(),s=i.find(e);return r.splice(-1==s?r.length:s,0,t,n),new BA(r)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=BA.from(e)).size?new BA(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=BA.from(e)).size?new BA(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=BA.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},BA.from=function(e){if(e instanceof BA)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new BA(t)};class HA{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,i=0,r){for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;if(l>e&&!1!==n(a,i+o,r||null,s)&&a.content.size){let r=o+1;a.nodesBetween(Math.max(0,e-r),Math.min(a.content.size,t-r),n,i+r)}o=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,i){let r="",s=!0;return this.nodesBetween(e,t,(o,a)=>{let l=o.isText?o.text.slice(Math.max(e,a)-a,t-a):o.isLeaf?i?"function"==typeof i?i(o):i:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&l||o.isTextblock)&&n&&(s?s=!1:r+=n),r+=l},0),r}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,i=this.content.slice(),r=0;for(t.isText&&t.sameMarkup(n)&&(i[i.length-1]=t.withText(t.text+n.text),r=1);r<e.content.length;r++)i.push(e.content[r]);return new HA(i,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let n=[],i=0;if(t>e)for(let r=0,s=0;s<t;r++){let o=this.content[r],a=s+o.nodeSize;a>e&&((s<e||a>t)&&(o=o.isText?o.cut(Math.max(0,e-s),Math.min(o.text.length,t-s)):o.cut(Math.max(0,e-s-1),Math.min(o.content.size,t-s-1))),n.push(o),i+=o.nodeSize),s=a}return new HA(n,i)}cutByIndex(e,t){return e==t?HA.empty:0==e&&t==this.content.length?this:new HA(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let i=this.content.slice(),r=this.size+t.nodeSize-n.nodeSize;return i[e]=t,new HA(i,r)}addToStart(e){return new HA([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new HA(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let i=this.content[t];e(i,n,t),n+=i.nodeSize}}findDiffStart(e,t=0){return VA(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return jA(this,e,t,n)}findIndex(e,t=-1){if(0==e)return zA(0,e);if(e==this.size)return zA(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,i=0;;n++){let r=i+this.child(n).nodeSize;if(r>=e)return r==e||t>0?zA(n+1,r):zA(n,i);i=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return HA.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new HA(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return HA.empty;let t,n=0;for(let i=0;i<e.length;i++){let r=e[i];n+=r.nodeSize,i&&r.isText&&e[i-1].sameMarkup(r)?(t||(t=e.slice(0,i)),t[t.length-1]=r.withText(t[t.length-1].text+r.text)):t&&t.push(r)}return new HA(t||e,n)}static from(e){if(!e)return HA.empty;if(e instanceof HA)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new HA([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}HA.empty=new HA([],0);const UA={index:0,offset:0};function zA(e,t){return UA.index=e,UA.offset=t,UA}function WA(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!WA(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!WA(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}let GA=class e{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let i=0;i<e.length;i++){let r=e[i];if(this.eq(r))return e;if(this.type.excludes(r.type))t||(t=e.slice(0,i));else{if(r.type.excludes(this.type))return e;!n&&r.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),n=!0),t&&t.push(r)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&WA(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=n.create(t.attrs);return n.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&0==t.length)return e.none;if(t instanceof e)return[t];let n=t.slice();return n.sort((e,t)=>e.type.rank-t.type.rank),n}};GA.none=[];class $A extends Error{}class ZA{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=KA(this.content,e+this.openStart,t);return n&&new ZA(n,this.openStart,this.openEnd)}removeBetween(e,t){return new ZA(qA(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return ZA.empty;let n=t.openStart||0,i=t.openEnd||0;if("number"!=typeof n||"number"!=typeof i)throw new RangeError("Invalid input for Slice.fromJSON");return new ZA(HA.fromJSON(e,t.content),n,i)}static maxOpen(e,t=!0){let n=0,i=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)n++;for(let r=e.lastChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.lastChild)i++;return new ZA(e,n,i)}}function qA(e,t,n){let{index:i,offset:r}=e.findIndex(t),s=e.maybeChild(i),{index:o,offset:a}=e.findIndex(n);if(r==t||s.isText){if(a!=n&&!e.child(o).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(i!=o)throw new RangeError("Removing non-flat range");return e.replaceChild(i,s.copy(qA(s.content,t-r-1,n-r-1)))}function KA(e,t,n,i){let{index:r,offset:s}=e.findIndex(t),o=e.maybeChild(r);if(s==t||o.isText)return e.cut(0,t).append(n).append(e.cut(t));let a=KA(o.content,t-s-1,n);return a&&e.replaceChild(r,o.copy(a))}function YA(e,t,n){if(n.openStart>e.depth)throw new $A("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new $A("Inconsistent open depths");return XA(e,t,n,0)}function XA(e,t,n,i){let r=e.index(i),s=e.node(i);if(r==t.index(i)&&i<e.depth-n.openStart){let o=XA(e,t,n,i+1);return s.copy(s.content.replaceChild(r,o))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=i||t.depth!=i){let{start:r,end:o}=function(e,t){let n=t.depth-e.openStart,i=t.node(n).copy(e.content);for(let r=n-1;r>=0;r--)i=t.node(r).copy(HA.from(i));return{start:i.resolveNoCache(e.openStart+n),end:i.resolveNoCache(i.content.size-e.openEnd-n)}}(n,e);return nM(s,iM(e,r,o,t,i))}{let i=e.parent,r=i.content;return nM(i,r.cut(0,e.parentOffset).append(n.content).append(r.cut(t.parentOffset)))}}return nM(s,rM(e,t,i))}function JA(e,t){if(!t.type.compatibleContent(e.type))throw new $A("Cannot join "+t.type.name+" onto "+e.type.name)}function QA(e,t,n){let i=e.node(n);return JA(i,t.node(n)),i}function eM(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function tM(e,t,n,i){let r=(t||e).node(n),s=0,o=t?t.index(n):r.childCount;e&&(s=e.index(n),e.depth>n?s++:e.textOffset&&(eM(e.nodeAfter,i),s++));for(let a=s;a<o;a++)eM(r.child(a),i);t&&t.depth==n&&t.textOffset&&eM(t.nodeBefore,i)}function nM(e,t){return e.type.checkContent(t),e.copy(t)}function iM(e,t,n,i,r){let s=e.depth>r&&QA(e,t,r+1),o=i.depth>r&&QA(n,i,r+1),a=[];return tM(null,e,r,a),s&&o&&t.index(r)==n.index(r)?(JA(s,o),eM(nM(s,iM(e,t,n,i,r+1)),a)):(s&&eM(nM(s,rM(e,t,r+1)),a),tM(t,n,r,a),o&&eM(nM(o,rM(n,i,r+1)),a)),tM(i,null,r,a),new HA(a)}function rM(e,t,n){let i=[];if(tM(null,e,n,i),e.depth>n){eM(nM(QA(e,t,n+1),rM(e,t,n+1)),i)}return tM(t,null,n,i),new HA(i)}ZA.empty=new ZA(HA.empty,0,0);class sM{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(t);return n?e.child(t).cut(n):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],i=0==t?0:this.path[3*t-1]+1;for(let r=0;r<e;r++)i+=n.child(r).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return GA.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),i=e.maybeChild(t);if(!n){let e=n;n=i,i=e}let r=n.marks;for(var s=0;s<r.length;s++)!1!==r[s].type.spec.inclusive||i&&r[s].isInSet(i.marks)||(r=r[s--].removeFromSet(r));return r}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,i=e.parent.maybeChild(e.index());for(var r=0;r<n.length;r++)!1!==n[r].type.spec.inclusive||i&&n[r].isInSet(i.marks)||(n=n[r--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new cM(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],i=0,r=t;for(let s=e;;){let{index:e,offset:t}=s.content.findIndex(r),o=r-t;if(n.push(s,e,i+t),!o)break;if(s=s.child(e),s.isText)break;r=o-1,i+=t+1}return new sM(t,n,r)}static resolveCached(e,t){let n=lM.get(e);if(n)for(let r=0;r<n.elts.length;r++){let e=n.elts[r];if(e.pos==t)return e}else lM.set(e,n=new oM);let i=n.elts[n.i]=sM.resolve(e,t);return n.i=(n.i+1)%aM,i}}class oM{constructor(){this.elts=[],this.i=0}}const aM=12,lM=new WeakMap;class cM{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const hM=Object.create(null);let uM=class e{constructor(e,t,n,i=GA.none){this.type=e,this.attrs=t,this.marks=i,this.content=n||HA.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,i=0){this.content.nodesBetween(e,t,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,i){return this.content.textBetween(e,t,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&WA(this.attrs,t||e.defaultAttrs||hM)&&GA.sameSet(this.marks,n||GA.none)}copy(t=null){return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return ZA.empty;let i=this.resolve(e),r=this.resolve(t),s=n?0:i.sharedDepth(t),o=i.start(s),a=i.node(s).content.cut(i.pos-o,r.pos-o);return new ZA(a,i.depth-s,r.depth-s)}replace(e,t,n){return YA(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let i=this.content.child(t-1);return{node:i,index:t-1,offset:n-i.nodeSize}}resolve(e){return sM.resolveCached(this,e)}resolveNoCache(e){return sM.resolve(this,e)}rangeHasMark(e,t,n){let i=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),pM(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=HA.empty,i=0,r=n.childCount){let s=this.contentMatchAt(e).matchFragment(n,i,r),o=s&&s.matchFragment(this.content,t);if(!o||!o.validEnd)return!1;for(let a=i;a<r;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0}canReplaceWith(e,t,n,i){if(i&&!this.type.allowsMarks(i))return!1;let r=this.contentMatchAt(e).matchType(n),s=r&&r.matchFragment(this.content,t);return!!s&&s.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=GA.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!GA.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let i=HA.fromJSON(e,t.content),r=e.nodeType(t.type).create(t.attrs,i,n);return r.type.checkAttrs(r.attrs),r}};uM.prototype.text=void 0;class dM extends uM{constructor(e,t,n,i){if(super(e,t,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):pM(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new dM(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new dM(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function pM(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class fM{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new mM(e,t);if(null==n.next)return fM.empty;let i=gM(n);n.next&&n.err("Unexpected trailing text");let r=function(e){let t=Object.create(null);return n(CM(e,0));function n(i){let r=[];i.forEach(t=>{e[t].forEach(({term:t,to:n})=>{if(!t)return;let i;for(let e=0;e<r.length;e++)r[e][0]==t&&(i=r[e][1]);CM(e,n).forEach(e=>{i||r.push([t,i=[]]),-1==i.indexOf(e)&&i.push(e)})})});let s=t[i.join(",")]=new fM(i.indexOf(e.length-1)>-1);for(let e=0;e<r.length;e++){let i=r[e][1].sort(xM);s.next.push({type:r[e][0],next:t[i.join(",")]||n(i)})}return s}}(function(e){let t=[[]];return r(s(e,0),n()),t;function n(){return t.push([])-1}function i(e,n,i){let r={term:i,to:n};return t[e].push(r),r}function r(e,t){e.forEach(e=>e.to=t)}function s(e,t){if("choice"==e.type)return e.exprs.reduce((e,n)=>e.concat(s(n,t)),[]);if("seq"!=e.type){if("star"==e.type){let o=n();return i(t,o),r(s(e.expr,o),o),[i(o)]}if("plus"==e.type){let o=n();return r(s(e.expr,t),o),r(s(e.expr,o),o),[i(o)]}if("opt"==e.type)return[i(t)].concat(s(e.expr,t));if("range"==e.type){let o=t;for(let t=0;t<e.min;t++){let t=n();r(s(e.expr,o),t),o=t}if(-1==e.max)r(s(e.expr,o),o);else for(let t=e.min;t<e.max;t++){let t=n();i(o,t),r(s(e.expr,o),t),o=t}return[i(o)]}if("name"==e.type)return[i(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let i=0;;i++){let o=s(e.exprs[i],t);if(i==e.exprs.length-1)return o;r(o,t=n())}}}(i));return function(e,t){for(let n=0,i=[e];n<i.length;n++){let e=i[n],r=!e.validEnd,s=[];for(let t=0;t<e.next.length;t++){let{type:n,next:o}=e.next[t];s.push(n.name),!r||n.isText||n.hasRequiredAttrs()||(r=!1),-1==i.indexOf(o)&&i.push(o)}r&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(r,n),r}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let i=this;for(let r=t;i&&r<n;r++)i=i.matchType(e.child(r).type);return i}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let i=[this];return function r(s,o){let a=s.matchFragment(e,n);if(a&&(!t||a.validEnd))return HA.from(o.map(e=>e.createAndFill()));for(let e=0;e<s.next.length;e++){let{type:t,next:n}=s.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==i.indexOf(n)){i.push(n);let e=r(n,o.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),r=i.match;if(r.matchType(e)){let e=[];for(let t=i;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<r.next.length;e++){let{type:s,next:o}=r.next[e];s.isLeaf||s.hasRequiredAttrs()||s.name in t||i.type&&!o.validEnd||(n.push({match:s.contentMatch,type:s,via:i}),t[s.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function t(n){e.push(n);for(let i=0;i<n.next.length;i++)-1==e.indexOf(n.next[i].next)&&t(n.next[i].next)}(this),e.map((t,n)=>{let i=n+(t.validEnd?"*":" ")+" ";for(let r=0;r<t.next.length;r++)i+=(r?", ":"")+t.next[r].type.name+"->"+e.indexOf(t.next[r].next);return i}).join("\n")}}fM.empty=new fM(!0);class mM{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function gM(e){let t=[];do{t.push(vM(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function vM(e){let t=[];do{t.push(yM(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function yM(e){let t=function(e){if(e.eat("(")){let t=gM(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let n=e.nodeTypes,i=n[t];if(i)return[i];let r=[];for(let s in n){let e=n[s];e.groups.indexOf(t)>-1&&r.push(e)}0==r.length&&e.err("No node type or group '"+t+"' found");return r}(e,e.next).map(t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=wM(e,t)}return t}function bM(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function wM(e,t){let n=bM(e),i=n;return e.eat(",")&&(i="}"!=e.next?bM(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:i,expr:t}}function xM(e,t){return t-e}function CM(e,t){let n=[];return function t(i){let r=e[i];if(1==r.length&&!r[0].term)return t(r[0].to);n.push(i);for(let e=0;e<r.length;e++){let{term:i,to:s}=r[e];i||-1!=n.indexOf(s)||t(s)}}(t),n.sort(xM)}function SM(e){let t=Object.create(null);for(let n in e){let i=e[n];if(!i.hasDefault)return null;t[n]=i.default}return t}function kM(e,t){let n=Object.create(null);for(let i in e){let r=t&&t[i];if(void 0===r){let t=e[i];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+i);r=t.default}n[i]=r}return n}function LM(e,t,n,i){for(let r in t)if(!(r in e))throw new RangeError(`Unsupported attribute ${r} for ${n} of type ${r}`);for(let r in e){let n=e[r];n.validate&&n.validate(t[r])}}function EM(e,t){let n=Object.create(null);if(t)for(let i in t)n[i]=new TM(e,i,t[i]);return n}let PM=class e{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=EM(e,n.attrs),this.defaultAttrs=SM(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==fM.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:kM(this.attrs,e)}create(e=null,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new uM(this,this.computeAttrs(e),HA.from(t),GA.setFrom(n))}createChecked(e=null,t,n){return t=HA.from(t),this.checkContent(t),new uM(this,this.computeAttrs(e),t,GA.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),(t=HA.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let i=this.contentMatch.matchFragment(t),r=i&&i.fillBefore(HA.empty,!0);return r?new uM(this,e,t.append(r),GA.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){LM(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:GA.none:e}static compile(t,n){let i=Object.create(null);t.forEach((t,r)=>i[t]=new e(t,n,r));let r=n.spec.topNode||"doc";if(!i[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!i.text)throw new RangeError("Every schema needs a 'text' type");for(let e in i.text.attrs)throw new RangeError("The text node type should not have attributes");return i}};class TM{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let i=n.split("|");return n=>{let r=null===n?"null":typeof n;if(i.indexOf(r)<0)throw new RangeError(`Expected value of type ${i} for attribute ${t} on type ${e}, got ${r}`)}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class AM{constructor(e,t,n,i){this.name=e,this.rank=t,this.schema=n,this.spec=i,this.attrs=EM(e,i.attrs),this.excluded=null;let r=SM(this.attrs);this.instance=r?new GA(this,r):null}create(e=null){return!e&&this.instance?this.instance:new GA(this,kM(this.attrs,e))}static compile(e,t){let n=Object.create(null),i=0;return e.forEach((e,r)=>n[e]=new AM(e,i++,t,r)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){LM(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class MM{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=BA.from(e.nodes),t.marks=BA.from(e.marks||{}),this.nodes=PM.compile(this.spec.nodes,this),this.marks=AM.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let e=this.nodes[i],t=e.spec.content||"",r=e.spec.marks;if(e.contentMatch=n[t]||(n[t]=fM.parse(t,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==r?null:r?IM(this,r.split(" ")):""!=r&&e.inlineContent?null:[]}for(let i in this.marks){let e=this.marks[i],t=e.spec.excludes;e.excluded=null==t?[e]:""==t?[]:IM(this,t.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,i){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof PM))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,i)}text(e,t){let n=this.nodes.text;return new dM(n,n.defaultAttrs,e,GA.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return uM.fromJSON(this,e)}markFromJSON(e){return GA.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function IM(e,t){let n=[];for(let i=0;i<t.length;i++){let r=t[i],s=e.marks[r],o=s;if(s)n.push(s);else for(let t in e.marks){let i=e.marks[t];("_"==r||i.spec.group&&i.spec.group.split(" ").indexOf(r)>-1)&&n.push(o=i)}if(!o)throw new SyntaxError("Unknown mark type: '"+t[i]+"'")}return n}let _M=class e{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(function(e){return null!=e.tag}(e))this.tags.push(e);else if(function(e){return null!=e.style}(e)){let t=/[^=]*/.exec(e.style)[0];n.indexOf(t)<0&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e,t={}){let n=new BM(this,t,!1);return n.addAll(e,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new BM(this,t,!0);return n.addAll(e,t.from,t.to),ZA.maxOpen(n.finish())}matchTag(e,t,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let n=this.tags[i];if(VM(e,n.tag)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,i){for(let r=i?this.styles.indexOf(i)+1:0;r<this.styles.length;r++){let i=this.styles[r],s=i.style;if(!(0!=s.indexOf(e)||i.context&&!n.matchesContext(i.context)||s.length>e.length&&(61!=s.charCodeAt(e.length)||s.slice(e.length+1)!=t))){if(i.getAttrs){let e=i.getAttrs(t);if(!1===e)continue;i.attrs=e||void 0}return i}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,i=0;for(;i<t.length;i++){let e=t[i];if((null==e.priority?50:e.priority)<n)break}t.splice(i,0,e)}for(let i in e.marks){let t=e.marks[i].spec.parseDOM;t&&t.forEach(e=>{n(e=jM(e)),e.mark||e.ignore||e.clearMark||(e.mark=i)})}for(let i in e.nodes){let t=e.nodes[i].spec.parseDOM;t&&t.forEach(e=>{n(e=jM(e)),e.node||e.ignore||e.mark||(e.node=i)})}return t}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new e(t,e.schemaRules(t)))}};const OM={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},NM={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},DM={ol:!0,ul:!0};function RM(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}class FM{constructor(e,t,n,i,r,s,o){this.type=e,this.attrs=t,this.marks=n,this.pendingMarks=i,this.solid=r,this.options=o,this.content=[],this.activeMarks=GA.none,this.stashMarks=[],this.match=s||(4&o?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(HA.from(e));if(!t){let t,n=this.type.contentMatch;return(t=n.findWrapping(e.type))?(this.match=n,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let n=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length))}}let t=HA.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(HA.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,n=this.pendingMarks;t<n.length;t++){let i=n[t];(this.type?this.type.allowsMarkType(i.type):HM(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!OM.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class BM{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0;let i,r=t.topNode,s=RM(null,t.preserveWhitespace,0)|(n?4:0);i=r?new FM(r.type,r.attrs,GA.none,GA.none,!0,t.topMatch||r.type.contentMatch,s):new FM(n?null:e.schema.topNodeType,null,GA.none,GA.none,!0,null,s),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){3==e.nodeType?this.addTextNode(e):1==e.nodeType&&this.addElement(e)}withStyleRules(e,t){let n=e.style;if(!n||!n.length)return t();let i=this.readStyles(e.style);if(!i)return;let[r,s]=i,o=this.top;for(let a=0;a<s.length;a++)this.removePendingMark(s[a],o);for(let a=0;a<r.length;a++)this.addPendingMark(r[a]);t();for(let a=0;a<r.length;a++)this.removePendingMark(r[a],o);for(let a=0;a<s.length;a++)this.addPendingMark(s[a])}addTextNode(e){let t=e.nodeValue,n=this.top;if(2&n.options||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(1&n.options)t=2&n.options?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=n.content[n.content.length-1],r=e.previousSibling;(!i||r&&"BR"==r.nodeName||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let n,i=e.nodeName.toLowerCase();DM.hasOwnProperty(i)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&DM.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let r=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(n=this.parser.matchTag(e,this,t));if(r?r.ignore:NM.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e);else if(!r||r.skip||r.closeParent){r&&r.closeParent?this.open=Math.max(0,this.open-1):r&&r.skip.nodeType&&(e=r.skip);let t,n=this.top,s=this.needsBlock;if(OM.hasOwnProperty(i))n.content.length&&n.content[0].isInline&&this.open&&(this.open--,n=this.top),t=!0,n.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);r&&r.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),t&&this.sync(n),this.needsBlock=s}else this.withStyleRules(e,()=>{this.addElementByRule(e,r,!1===r.consuming?n:void 0)})}leafFallback(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))}ignoreFallback(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=GA.none,n=GA.none;if(e.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let r=this.parser.matchedStyles[i],s=e.getPropertyValue(r);if(s)for(let e;;){let i=this.parser.matchStyle(r,s,this,e);if(!i)break;if(i.ignore)return null;if(i.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(e=>{i.clearMark(e)&&(n=e.addToSet(n))}):t=this.parser.schema.marks[i.mark].create(i.attrs).addToSet(t),!1!==i.consuming)break;e=i}}return[t,n]}addElementByRule(e,t,n){let i,r,s;if(t.node)r=this.parser.schema.nodes[t.node],r.isLeaf?this.insertNode(r.create(t.attrs))||this.leafFallback(e):i=this.enter(r,t.attrs||null,t.preserveWhitespace);else{s=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(s)}let o=this.top;if(r&&r.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e));else{let n=e;"string"==typeof t.contentElement?n=e.querySelector(t.contentElement):"function"==typeof t.contentElement?n=t.contentElement(e):t.contentElement&&(n=t.contentElement),this.findAround(e,n,!0),this.addAll(n)}i&&this.sync(o)&&this.open--,s&&this.removePendingMark(s,o)}addAll(e,t,n){let i=t||0;for(let r=t?e.childNodes[t]:e.firstChild,s=null==n?null:e.childNodes[n];r!=s;r=r.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(r);this.findAtPoint(e,i)}findPlace(e){let t,n;for(let i=this.open;i>=0;i--){let r=this.nodes[i],s=r.findWrapping(e);if(s&&(!t||t.length>s.length)&&(t=s,n=r,!s.length))break;if(r.solid)break}if(!t)return!1;this.sync(n);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let n=t.activeMarks;for(let i=0;i<e.marks.length;i++)t.type&&!t.type.allowsMarkType(e.marks[i].type)||(n=e.marks[i].addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,n),i}enterInner(e,t=null,n=!1,i){this.closeExtra();let r=this.top;r.applyPending(e),r.match=r.match&&r.match.matchType(e);let s=RM(e,i,r.options);4&r.options&&0==r.content.length&&(s|=4),this.nodes.push(new FM(e,t,r.activeMarks,r.pendingMarks,n,null,s)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)if(null==this.find[i].pos&&1==e.nodeType&&e.contains(this.find[i].node)){t.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,i=!(this.isOpen||n&&n.parent.type!=this.nodes[0].type),r=-(n?n.depth+1:0)+(i?0:1),s=(e,o)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;o>=r;o--)if(s(e-1,o))return!0;return!1}{let e=o>0||0==o&&i?this.nodes[o].type:n&&o>=r?n.node(o-r).type:null;if(!e||e.name!=a&&-1==e.groups.indexOf(a))return!1;o--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}addPendingMark(e){let t=function(e,t){for(let n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let n=this.open;n>=0;n--){let i=this.nodes[n];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let t=i.popFromStashMark(e);t&&i.type&&i.type.allowsMarkType(t.type)&&(i.activeMarks=t.addToSet(i.activeMarks))}if(i==t)break}}}function VM(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function jM(e){let t={};for(let n in e)t[n]=e[n];return t}function HM(e,t){let n=t.schema.nodes;for(let i in n){let r=n[i];if(!r.allowsMarkType(e))continue;let s=[],o=e=>{s.push(e);for(let n=0;n<e.edgeCount;n++){let{type:i,next:r}=e.edge(n);if(i==t)return!0;if(s.indexOf(r)<0&&o(r))return!0}};if(o(r.contentMatch))return!0}}class UM{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=WM(t).createDocumentFragment());let i=n,r=[];return e.forEach(e=>{if(r.length||e.marks.length){let n=0,s=0;for(;n<r.length&&s<e.marks.length;){let t=e.marks[s];if(this.marks[t.type.name]){if(!t.eq(r[n][0])||!1===t.type.spec.spanning)break;n++,s++}else s++}for(;n<r.length;)i=r.pop()[1];for(;s<e.marks.length;){let n=e.marks[s++],o=this.serializeMark(n,e.isInline,t);o&&(r.push([n,i]),i.appendChild(o.dom),i=o.contentDOM||o.dom)}}i.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:i}=ZM(WM(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let r=this.serializeMark(e.marks[i],e.isInline,t);r&&((r.contentDOM||r.dom).appendChild(n),n=r.dom)}return n}serializeMark(e,t,n={}){let i=this.marks[e.type.name];return i&&ZM(WM(n),i(e,t),null,e.attrs)}static renderSpec(e,t,n=null,i){return ZM(e,t,n,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new UM(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=zM(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return zM(e.marks)}}function zM(e){let t={};for(let n in e){let i=e[n].spec.toDOM;i&&(t[n]=i)}return t}function WM(e){return e.document||window.document}const GM=new WeakMap;function $M(e){let t=GM.get(e);return void 0===t&&GM.set(e,t=function(e){let t=null;function n(e){if(e&&"object"==typeof e)if(Array.isArray(e))if("string"==typeof e[0])t||(t=[]),t.push(e);else for(let t=0;t<e.length;t++)n(e[t]);else for(let t in e)n(e[t])}return n(e),t}(e)),t}function ZM(e,t,n,i){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let r,s=t[0];if("string"!=typeof s)throw new RangeError("Invalid array passed to renderSpec");if(i&&(r=$M(i))&&r.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o,a=s.indexOf(" ");a>0&&(n=s.slice(0,a),s=s.slice(a+1));let l=n?e.createElementNS(n,s):e.createElement(s),c=t[1],h=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){h=2;for(let e in c)if(null!=c[e]){let t=e.indexOf(" ");t>0?l.setAttributeNS(e.slice(0,t),e.slice(t+1),c[e]):l.setAttribute(e,c[e])}}for(let u=h;u<t.length;u++){let r=t[u];if(0===r){if(u<t.length-1||u>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:t,contentDOM:s}=ZM(e,r,n,i);if(l.appendChild(t),s){if(o)throw new RangeError("Multiple content holes");o=s}}}return{dom:l,contentDOM:o}}const qM=Math.pow(2,16);function KM(e,t){return e+t*qM}function YM(e){return 65535&e}class XM{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class JM{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&JM.empty)return JM.empty}recover(e){let t=0,n=YM(e);if(!this.inverted)for(let i=0;i<n;i++)t+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/qM}(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let i=0,r=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let a=this.ranges[o]-(this.inverted?i:0);if(a>e)break;let l=this.ranges[o+r],c=this.ranges[o+s],h=a+l;if(e<=h){let r=a+i+((l?e==a?-1:e==h?1:t:t)<0?0:c);if(n)return r;let s=e==(t<0?a:h)?null:KM(o/3,e-a),u=e==a?2:e==h?1:4;return(t<0?e!=a:e!=h)&&(u|=8),new XM(r,u,s)}i+=c-l}return n?e+i:new XM(e+i,0,null)}touches(e,t){let n=0,i=YM(t),r=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let t=this.ranges[o]-(this.inverted?n:0);if(t>e)break;let a=this.ranges[o+r];if(e<=t+a&&o==3*i)return!0;n+=this.ranges[o+s]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,r=0;i<this.ranges.length;i+=3){let s=this.ranges[i],o=s-(this.inverted?r:0),a=s+(this.inverted?0:r),l=this.ranges[i+t],c=this.ranges[i+n];e(o,o+l,a,a+c),r+=c-l}}invert(){return new JM(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?JM.empty:new JM(e<0?[0,-e,0]:[0,0,e])}}JM.empty=new JM([]);class QM{constructor(e=[],t,n=0,i=e.length){this.maps=e,this.mirror=t,this.from=n,this.to=i}slice(e=0,t=this.maps.length){return new QM(this.maps,this.mirror,e,t)}copy(){return new QM(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,n=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],null!=i&&i<t?n+i:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=i&&i>t?n-i-1:void 0)}}invert(){let e=new QM;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let i=0;for(let r=this.from;r<this.to;r++){let n=this.maps[r].mapResult(e,t);if(null!=n.recover){let t=this.getMirror(r);if(null!=t&&t>r&&t<this.to){r=t,e=this.maps[t].recover(n.recover);continue}}i|=n.delInfo,e=n.pos}return n?e:new XM(e,i,null)}}const eI=Object.create(null);class tI{getMap(){return JM.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=eI[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in eI)throw new RangeError("Duplicate use of step JSON ID "+e);return eI[e]=t,t.prototype.jsonID=e,t}}class nI{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new nI(e,null)}static fail(e){return new nI(null,e)}static fromReplace(e,t,n,i){try{return nI.ok(e.replace(t,n,i))}catch(r){if(r instanceof $A)return nI.fail(r.message);throw r}}}function iI(e,t,n){let i=[];for(let r=0;r<e.childCount;r++){let s=e.child(r);s.content.size&&(s=s.copy(iI(s.content,t,s))),s.isInline&&(s=t(s,n,r)),i.push(s)}return HA.fromArray(i)}class rI extends tI{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),r=new ZA(iI(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,i),t.openStart,t.openEnd);return nI.fromReplace(e,this.from,this.to,r)}invert(){return new sI(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new rI(t.pos,n.pos,this.mark)}merge(e){return e instanceof rI&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new rI(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new rI(t.from,t.to,e.markFromJSON(t.mark))}}tI.jsonID("addMark",rI);class sI extends tI{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new ZA(iI(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return nI.fromReplace(e,this.from,this.to,n)}invert(){return new rI(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new sI(t.pos,n.pos,this.mark)}merge(e){return e instanceof sI&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new sI(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new sI(t.from,t.to,e.markFromJSON(t.mark))}}tI.jsonID("removeMark",sI);class oI extends tI{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return nI.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return nI.fromReplace(e,this.pos,this.pos+1,new ZA(HA.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new oI(this.pos,t.marks[n]);return new oI(this.pos,this.mark)}}return new aI(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new oI(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new oI(t.pos,e.markFromJSON(t.mark))}}tI.jsonID("addNodeMark",oI);class aI extends tI{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return nI.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return nI.fromReplace(e,this.pos,this.pos+1,new ZA(HA.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new oI(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new aI(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new aI(t.pos,e.markFromJSON(t.mark))}}tI.jsonID("removeNodeMark",aI);class lI extends tI{constructor(e,t,n,i=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=i}apply(e){return this.structure&&hI(e,this.from,this.to)?nI.fail("Structure replace would overwrite content"):nI.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new JM([this.from,this.to-this.from,this.slice.size])}invert(e){return new lI(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new lI(t.pos,Math.max(t.pos,n.pos),this.slice)}merge(e){if(!(e instanceof lI)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?ZA.empty:new ZA(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new lI(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?ZA.empty:new ZA(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new lI(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new lI(t.from,t.to,ZA.fromJSON(e,t.slice),!!t.structure)}}tI.jsonID("replace",lI);class cI extends tI{constructor(e,t,n,i,r,s,o=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=i,this.slice=r,this.insert=s,this.structure=o}apply(e){if(this.structure&&(hI(e,this.from,this.gapFrom)||hI(e,this.gapTo,this.to)))return nI.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return nI.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?nI.fromReplace(e,this.from,this.to,n):nI.fail("Content does not fit in gap")}getMap(){return new JM([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new cI(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),r=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||i<t.pos||r>n.pos?null:new cI(t.pos,n.pos,i,r,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new cI(t.from,t.to,t.gapFrom,t.gapTo,ZA.fromJSON(e,t.slice),t.insert,!!t.structure)}}function hI(e,t,n){let i=e.resolve(t),r=n-t,s=i.depth;for(;r>0&&s>0&&i.indexAfter(s)==i.node(s).childCount;)s--,r--;if(r>0){let e=i.node(s).maybeChild(i.indexAfter(s));for(;r>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,r--}}return!1}function uI(e,t,n,i=n.contentMatch,r=!0){let s=e.doc.nodeAt(t),o=[],a=t+1;for(let l=0;l<s.childCount;l++){let t=s.child(l),c=a+t.nodeSize,h=i.matchType(t.type);if(h){i=h;for(let i=0;i<t.marks.length;i++)n.allowsMarkType(t.marks[i].type)||e.step(new sI(a,c,t.marks[i]));if(r&&t.isText&&"pre"!=n.whitespace){let e,i,r=/\r?\n|\r/g;for(;e=r.exec(t.text);)i||(i=new ZA(HA.from(n.schema.text(" ",n.allowedMarks(t.marks))),0,0)),o.push(new lI(a+e.index,a+e.index+e[0].length,i))}}else o.push(new lI(a,c,ZA.empty));a=c}if(!i.validEnd){let t=i.fillBefore(HA.empty,!0);e.replace(a,a,new ZA(t,0,0))}for(let l=o.length-1;l>=0;l--)e.step(o[l])}function dI(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function pI(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth;;--n){let i=e.$from.node(n),r=e.$from.index(n),s=e.$to.indexAfter(n);if(n<e.depth&&i.canReplace(r,s,t))return n;if(0==n||i.type.spec.isolating||!dI(i,r,s))break}return null}function fI(e,t,n=null,i=e){let r=function(e,t){let{parent:n,startIndex:i,endIndex:r}=e,s=n.contentMatchAt(i).findWrapping(t);if(!s)return null;let o=s.length?s[0]:t;return n.canReplaceWith(i,r,o)?s:null}(e,t),s=r&&function(e,t){let{parent:n,startIndex:i,endIndex:r}=e,s=n.child(i),o=t.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:t).contentMatch;for(let l=i;a&&l<r;l++)a=a.matchType(n.child(l).type);return a&&a.validEnd?o:null}(i,t);return s?r.map(mI).concat({type:t,attrs:n}).concat(s.map(mI)):null}function mI(e){return{type:e,attrs:null}}function gI(e,t,n=1,i){let r=e.resolve(t),s=r.depth-n,o=i&&i[i.length-1]||r.parent;if(s<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!o.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let c=r.depth-1,h=n-2;c>s;c--,h--){let e=r.node(c),t=r.index(c);if(e.type.spec.isolating)return!1;let n=e.content.cutByIndex(t,e.childCount),s=i&&i[h+1];s&&(n=n.replaceChild(0,s.type.create(s.attrs)));let o=i&&i[h]||e;if(!e.canReplace(t+1,e.childCount)||!o.type.validContent(n))return!1}let a=r.indexAfter(s),l=i&&i[0];return r.node(s).canReplaceWith(a,a,l?l.type:r.node(s+1).type)}function vI(e,t){let n=e.resolve(t),i=n.index();return yI(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(i,i+1)}function yI(e,t){return!(!e||!t||e.isLeaf||!e.canAppend(t))}function bI(e,t,n=-1){let i=e.resolve(t);for(let r=i.depth;;r--){let e,s,o=i.index(r);if(r==i.depth?(e=i.nodeBefore,s=i.nodeAfter):n>0?(e=i.node(r+1),o++,s=i.node(r).maybeChild(o)):(e=i.node(r).maybeChild(o-1),s=i.node(r+1)),e&&!e.isTextblock&&yI(e,s)&&i.node(r).canReplace(o,o+1))return t;if(0==r)break;t=n<0?i.before(r):i.after(r)}}function wI(e,t,n){let i=e.resolve(t);if(!n.content.size)return t;let r=n.content;for(let s=0;s<n.openStart;s++)r=r.firstChild.content;for(let s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(let e=i.depth;e>=0;e--){let t=e==i.depth?0:i.pos<=(i.start(e+1)+i.end(e+1))/2?-1:1,n=i.index(e)+(t>0?1:0),o=i.node(e),a=!1;if(1==s)a=o.canReplace(n,n,r);else{let e=o.contentMatchAt(n).findWrapping(r.firstChild.type);a=e&&o.canReplaceWith(n,n,e[0])}if(a)return 0==t?i.pos:t<0?i.before(e+1):i.after(e+1)}return null}function xI(e,t,n=t,i=ZA.empty){if(t==n&&!i.size)return null;let r=e.resolve(t),s=e.resolve(n);return CI(r,s,i)?new lI(t,n,i):new SI(r,s,i).fit()}function CI(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}tI.jsonID("replaceAround",cI);class SI{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=HA.empty;for(let i=0;i<=e.depth;i++){let t=e.node(i);this.frontier.push({type:t.type,match:t.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=HA.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let r=this.placed,s=n.depth,o=i.depth;for(;s&&o&&1==r.childCount;)r=r.firstChild.content,s--,o--;let a=new ZA(r,s,o);return e>-1?new cI(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new lI(n.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let r=t.firstChild;if(t.childCount>1&&(i=0),r.type.spec.isolating&&i<=n){e=n;break}t=r.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,i=null;n?(i=EI(this.unplaced.content,n-1).firstChild,e=i.content):e=this.unplaced.content;let r=e.firstChild;for(let s=this.depth;s>=0;s--){let e,{type:o,match:a}=this.frontier[s],l=null;if(1==t&&(r?a.matchType(r.type)||(l=a.fillBefore(HA.from(r),!1)):i&&o.compatibleContent(i.type)))return{sliceDepth:n,frontierDepth:s,parent:i,inject:l};if(2==t&&r&&(e=a.findWrapping(r.type)))return{sliceDepth:n,frontierDepth:s,parent:i,wrap:e};if(i&&a.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=EI(e,t);return!(!i.childCount||i.firstChild.isLeaf)&&(this.unplaced=new ZA(e,t+1,Math.max(n,i.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=EI(e,t);if(i.childCount<=1&&t>0){let r=e.size-t<=t+i.size;this.unplaced=new ZA(kI(e,t-1,1),t-1,r?t-1:n)}else this.unplaced=new ZA(kI(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:i,wrap:r}){for(;this.depth>t;)this.closeFrontierNode();if(r)for(let f=0;f<r.length;f++)this.openFrontierNode(r[f]);let s=this.unplaced,o=n?n.content:s.content,a=s.openStart-e,l=0,c=[],{match:h,type:u}=this.frontier[t];if(i){for(let e=0;e<i.childCount;e++)c.push(i.child(e));h=h.matchFragment(i)}let d=o.size+e-(s.content.size-s.openEnd);for(;l<o.childCount;){let e=o.child(l),t=h.matchType(e.type);if(!t)break;l++,(l>1||0==a||e.content.size)&&(h=t,c.push(PI(e.mark(u.allowedMarks(e.marks)),1==l?a:0,l==o.childCount?d:-1)))}let p=l==o.childCount;p||(d=-1),this.placed=LI(this.placed,t,HA.from(c)),this.frontier[t].match=h,p&&d<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let f=0,m=o;f<d;f++){let e=m.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),m=e.content}this.unplaced=p?0==e?ZA.empty:new ZA(kI(s.content,e-1,1),e-1,d<0?s.openEnd:e-1):new ZA(kI(s.content,e,l),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!TI(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:i}=this.frontier[t],r=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=TI(e,t,i,n,r);if(s){for(let n=t-1;n>=0;n--){let{match:t,type:i}=this.frontier[n],r=TI(e,n,i,t,!0);if(!r||r.childCount)continue e}return{depth:t,fit:s,move:r?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=LI(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),i=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,i)}return e}openFrontierNode(e,t=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=LI(this.placed,this.depth,HA.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(HA.empty,!0);e.childCount&&(this.placed=LI(this.placed,this.frontier.length,e))}}function kI(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(kI(e.firstChild.content,t-1,n)))}function LI(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(LI(e.lastChild.content,t-1,n)))}function EI(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function PI(e,t,n){if(t<=0)return e;let i=e.content;return t>1&&(i=i.replaceChild(0,PI(i.firstChild,t-1,1==i.childCount?n-1:0))),t>0&&(i=e.type.contentMatch.fillBefore(i).append(i),n<=0&&(i=i.append(e.type.contentMatch.matchFragment(i).fillBefore(HA.empty,!0)))),e.copy(i)}function TI(e,t,n,i,r){let s=e.node(t),o=r?e.indexAfter(t):e.index(t);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let a=i.fillBefore(s.content,!0,o);return a&&!function(e,t,n){for(let i=n;i<t.childCount;i++)if(!e.allowsMarks(t.child(i).marks))return!0;return!1}(n,s.content,o)?a:null}function AI(e){return e.spec.defining||e.spec.definingForContent}function MI(e,t,n,i,r){if(t<n){let r=e.firstChild;e=e.replaceChild(0,r.copy(MI(r.content,t+1,n,i,r)))}if(t>i){let t=r.contentMatchAt(0),n=t.fillBefore(e).append(e);e=n.append(t.matchFragment(n).fillBefore(HA.empty,!0))}return e}function II(e,t){let n=[];for(let i=Math.min(e.depth,t.depth);i>=0;i--){let r=e.start(i);if(r<e.pos-(e.depth-i)||t.end(i)>t.pos+(t.depth-i)||e.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(r==t.start(i)||i==e.depth&&i==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==r-1)&&n.push(i)}return n}class _I extends tI{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return nI.fail("No node at attribute step's position");let n=Object.create(null);for(let r in t.attrs)n[r]=t.attrs[r];n[this.attr]=this.value;let i=t.type.create(n,null,t.marks);return nI.fromReplace(e,this.pos,this.pos+1,new ZA(HA.from(i),0,t.isLeaf?0:1))}getMap(){return JM.empty}invert(e){return new _I(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new _I(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new _I(t.pos,t.attr,t.value)}}tI.jsonID("attr",_I);class OI extends tI{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return nI.ok(n)}getMap(){return JM.empty}invert(e){return new OI(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new OI(t.attr,t.value)}}tI.jsonID("docAttr",OI);let NI=class extends Error{};NI=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n},(NI.prototype=Object.create(Error.prototype)).constructor=NI,NI.prototype.name="TransformError";class DI{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new QM}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new NI(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=ZA.empty){let i=xI(this.doc,e,t,n);return i&&this.step(i),this}replaceWith(e,t,n){return this.replace(e,t,new ZA(HA.from(n),0,0))}delete(e,t){return this.replace(e,t,ZA.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return function(e,t,n,i){if(!i.size)return e.deleteRange(t,n);let r=e.doc.resolve(t),s=e.doc.resolve(n);if(CI(r,s,i))return e.step(new lI(t,n,i));let o=II(r,e.doc.resolve(n));0==o[o.length-1]&&o.pop();let a=-(r.depth+1);o.unshift(a);for(let d=r.depth,p=r.pos-1;d>0;d--,p--){let e=r.node(d).type.spec;if(e.defining||e.definingAsContext||e.isolating)break;o.indexOf(d)>-1?a=d:r.before(d)==p&&o.splice(1,0,-d)}let l=o.indexOf(a),c=[],h=i.openStart;for(let d=i.content,p=0;;p++){let e=d.firstChild;if(c.push(e),p==i.openStart)break;d=e.content}for(let d=h-1;d>=0;d--){let e=c[d],t=AI(e.type);if(t&&!e.sameMarkup(r.node(Math.abs(a)-1)))h=d;else if(t||!e.type.isTextblock)break}for(let d=i.openStart;d>=0;d--){let t=(d+h+1)%(i.openStart+1),a=c[t];if(a)for(let c=0;c<o.length;c++){let h=o[(c+l)%o.length],u=!0;h<0&&(u=!1,h=-h);let d=r.node(h-1),p=r.index(h-1);if(d.canReplaceWith(p,p,a.type,a.marks))return e.replace(r.before(h),u?s.after(h):n,new ZA(MI(i.content,0,i.openStart,t),t,i.openEnd))}}let u=e.steps.length;for(let d=o.length-1;d>=0&&(e.replace(t,n,i),!(e.steps.length>u));d--){let e=o[d];e<0||(t=r.before(e),n=s.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return function(e,t,n,i){if(!i.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let r=function(e,t,n){let i=e.resolve(t);if(i.parent.canReplaceWith(i.index(),i.index(),n))return t;if(0==i.parentOffset)for(let r=i.depth-1;r>=0;r--){let e=i.index(r);if(i.node(r).canReplaceWith(e,e,n))return i.before(r+1);if(e>0)return null}if(i.parentOffset==i.parent.content.size)for(let r=i.depth-1;r>=0;r--){let e=i.indexAfter(r);if(i.node(r).canReplaceWith(e,e,n))return i.after(r+1);if(e<i.node(r).childCount)return null}return null}(e.doc,t,i.type);null!=r&&(t=n=r)}e.replaceRange(t,n,new ZA(HA.from(i),0,0))}(this,e,t,n),this}deleteRange(e,t){return function(e,t,n){let i=e.doc.resolve(t),r=e.doc.resolve(n),s=II(i,r);for(let o=0;o<s.length;o++){let t=s[o],n=o==s.length-1;if(n&&0==t||i.node(t).type.contentMatch.validEnd)return e.delete(i.start(t),r.end(t));if(t>0&&(n||i.node(t-1).canReplace(i.index(t-1),r.indexAfter(t-1))))return e.delete(i.before(t),r.after(t))}for(let o=1;o<=i.depth&&o<=r.depth;o++)if(t-i.start(o)==i.depth-o&&n>i.end(o)&&r.end(o)-n!=r.depth-o)return e.delete(i.before(o),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return function(e,t,n){let{$from:i,$to:r,depth:s}=t,o=i.before(s+1),a=r.after(s+1),l=o,c=a,h=HA.empty,u=0;for(let f=s,m=!1;f>n;f--)m||i.index(f)>0?(m=!0,h=HA.from(i.node(f).copy(h)),u++):l--;let d=HA.empty,p=0;for(let f=s,m=!1;f>n;f--)m||r.after(f+1)<r.end(f)?(m=!0,d=HA.from(r.node(f).copy(d)),p++):c++;e.step(new cI(l,c,o,a,new ZA(h.append(d),u,p),h.size-u,!0))}(this,e,t),this}join(e,t=1){return function(e,t,n){let i=new lI(t-n,t+n,ZA.empty,!0);e.step(i)}(this,e,t),this}wrap(e,t){return function(e,t,n){let i=HA.empty;for(let o=n.length-1;o>=0;o--){if(i.size){let e=n[o].type.contentMatch.matchFragment(i);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=HA.from(n[o].type.create(n[o].attrs,i))}let r=t.start,s=t.end;e.step(new cI(r,s,r,s,new ZA(i,0,0),n.length,!0))}(this,e,t),this}setBlockType(e,t=e,n,i=null){return function(e,t,n,i,r){if(!i.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=e.steps.length;e.doc.nodesBetween(t,n,(t,n)=>{if(t.isTextblock&&!t.hasMarkup(i,r)&&function(e,t,n){let i=e.resolve(t),r=i.index();return i.parent.canReplaceWith(r,r+1,n)}(e.doc,e.mapping.slice(s).map(n),i)){let o=null;if(i.schema.linebreakReplacement){let e="pre"==i.whitespace,t=!!i.contentMatch.matchType(i.schema.linebreakReplacement);e&&!t?o=!1:!e&&t&&(o=!0)}!1===o&&function(e,t,n,i){t.forEach((r,s)=>{if(r.type==r.type.schema.linebreakReplacement){let r=e.mapping.slice(i).map(n+1+s);e.replaceWith(r,r+1,t.type.schema.text("\n"))}})}(e,t,n,s),uI(e,e.mapping.slice(s).map(n,1),i,void 0,null===o);let a=e.mapping.slice(s),l=a.map(n,1),c=a.map(n+t.nodeSize,1);return e.step(new cI(l,c,l+1,c-1,new ZA(HA.from(i.create(r,null,t.marks)),0,0),1,!0)),!0===o&&function(e,t,n,i){t.forEach((r,s)=>{if(r.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(r.text);){let r=e.mapping.slice(i).map(n+1+s+o.index);e.replaceWith(r,r+1,t.type.schema.linebreakReplacement.create())}}})}(e,t,n,s),!1}})}(this,e,t,n,i),this}setNodeMarkup(e,t,n=null,i){return function(e,t,n,i,r){let s=e.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(i,null,r||s.marks);if(s.isLeaf)return e.replaceWith(t,t+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new cI(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new ZA(HA.from(o),0,0),1,!0))}(this,e,t,n,i),this}setNodeAttribute(e,t,n){return this.step(new _I(e,t,n)),this}setDocAttribute(e,t){return this.step(new OI(e,t)),this}addNodeMark(e,t){return this.step(new oI(e,t)),this}removeNodeMark(e,t){if(!(t instanceof GA)){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(!(t=t.isInSet(n.marks)))return this}return this.step(new aI(e,t)),this}split(e,t=1,n){return function(e,t,n=1,i){let r=e.doc.resolve(t),s=HA.empty,o=HA.empty;for(let a=r.depth,l=r.depth-n,c=n-1;a>l;a--,c--){s=HA.from(r.node(a).copy(s));let e=i&&i[c];o=HA.from(e?e.type.create(e.attrs,o):r.node(a).copy(o))}e.step(new lI(t,t,new ZA(s.append(o),n,n),!0))}(this,e,t,n),this}addMark(e,t,n){return function(e,t,n,i){let r,s,o=[],a=[];e.doc.nodesBetween(t,n,(e,l,c)=>{if(!e.isInline)return;let h=e.marks;if(!i.isInSet(h)&&c.type.allowsMarkType(i.type)){let c=Math.max(l,t),u=Math.min(l+e.nodeSize,n),d=i.addToSet(h);for(let e=0;e<h.length;e++)h[e].isInSet(d)||(r&&r.to==c&&r.mark.eq(h[e])?r.to=u:o.push(r=new sI(c,u,h[e])));s&&s.to==c?s.to=u:a.push(s=new rI(c,u,i))}}),o.forEach(t=>e.step(t)),a.forEach(t=>e.step(t))}(this,e,t,n),this}removeMark(e,t,n){return function(e,t,n,i){let r=[],s=0;e.doc.nodesBetween(t,n,(e,o)=>{if(!e.isInline)return;s++;let a=null;if(i instanceof AM){let t,n=e.marks;for(;t=i.isInSet(n);)(a||(a=[])).push(t),n=t.removeFromSet(n)}else i?i.isInSet(e.marks)&&(a=[i]):a=e.marks;if(a&&a.length){let i=Math.min(o+e.nodeSize,n);for(let e=0;e<a.length;e++){let n,l=a[e];for(let e=0;e<r.length;e++){let t=r[e];t.step==s-1&&l.eq(r[e].style)&&(n=t)}n?(n.to=i,n.step=s):r.push({style:l,from:Math.max(o,t),to:i,step:s})}}}),r.forEach(t=>e.step(new sI(t.from,t.to,t.style)))}(this,e,t,n),this}clearIncompatible(e,t,n){return uI(this,e,t,n),this}}const RI=Object.create(null);class FI{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new BI(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=ZA.empty){let n=t.content.lastChild,i=null;for(let o=0;o<t.openEnd;o++)i=n,n=n.lastChild;let r=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:a,$to:l}=s[o],c=e.mapping.slice(r);e.replaceRange(c.map(a.pos),c.map(l.pos),o?ZA.empty:t),0==o&&qI(e,r,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,i=this.ranges;for(let r=0;r<i.length;r++){let{$from:s,$to:o}=i[r],a=e.mapping.slice(n),l=a.map(s.pos),c=a.map(o.pos);r?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),qI(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let i=e.parent.inlineContent?new HI(e):ZI(e.node(0),e.parent,e.pos,e.index(),t,n);if(i)return i;for(let r=e.depth-1;r>=0;r--){let i=t<0?ZI(e.node(0),e.node(r),e.before(r+1),e.index(r),t,n):ZI(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,n);if(i)return i}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new GI(e.node(0))}static atStart(e){return ZI(e,e,0,0,1)||new GI(e)}static atEnd(e){return ZI(e,e,e.content.size,e.childCount,-1)||new GI(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=RI[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in RI)throw new RangeError("Duplicate use of selection JSON ID "+e);return RI[e]=t,t.prototype.jsonID=e,t}getBookmark(){return HI.between(this.$anchor,this.$head).getBookmark()}}FI.prototype.visible=!0;class BI{constructor(e,t){this.$from=e,this.$to=t}}let VI=!1;function jI(e){VI||e.parent.inlineContent||(VI=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class HI extends FI{constructor(e,t=e){jI(e),jI(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return FI.near(n);let i=e.resolve(t.map(this.anchor));return new HI(i.parent.inlineContent?i:n,n)}replace(e,t=ZA.empty){if(super.replace(e,t),t==ZA.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof HI&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new UI(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new HI(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let i=e.resolve(t);return new this(i,n==t?i:e.resolve(n))}static between(e,t,n){let i=e.pos-t.pos;if(n&&!i||(n=i>=0?1:-1),!t.parent.inlineContent){let e=FI.findFrom(t,n,!0)||FI.findFrom(t,-n,!0);if(!e)return FI.near(t,n);t=e.$head}return e.parent.inlineContent||(0==i||(e=(FI.findFrom(e,-n,!0)||FI.findFrom(e,n,!0)).$anchor).pos<t.pos!=i<0)&&(e=t),new HI(e,t)}}FI.jsonID("text",HI);class UI{constructor(e,t){this.anchor=e,this.head=t}map(e){return new UI(e.map(this.anchor),e.map(this.head))}resolve(e){return HI.between(e.resolve(this.anchor),e.resolve(this.head))}}class zI extends FI{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:i}=t.mapResult(this.anchor),r=e.resolve(i);return n?FI.near(r):new zI(r)}content(){return new ZA(HA.from(this.node),0,0)}eq(e){return e instanceof zI&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new WI(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new zI(e.resolve(t.anchor))}static create(e,t){return new zI(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}zI.prototype.visible=!1,FI.jsonID("node",zI);class WI{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new UI(n,n):new WI(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&zI.isSelectable(n)?new zI(t):FI.near(t)}}class GI extends FI{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=ZA.empty){if(t==ZA.empty){e.delete(0,e.doc.content.size);let t=FI.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new GI(e)}map(e){return new GI(e)}eq(e){return e instanceof GI}getBookmark(){return $I}}FI.jsonID("all",GI);const $I={map(){return this},resolve:e=>new GI(e)};function ZI(e,t,n,i,r,s=!1){if(t.inlineContent)return HI.create(e,n);for(let o=i-(r>0?0:1);r>0?o<t.childCount:o>=0;o+=r){let i=t.child(o);if(i.isAtom){if(!s&&zI.isSelectable(i))return zI.create(e,n-(r<0?i.nodeSize:0))}else{let t=ZI(e,i,n+r,r<0?i.childCount:0,r,s);if(t)return t}n+=i.nodeSize*r}return null}function qI(e,t,n){let i=e.steps.length-1;if(i<t)return;let r,s=e.steps[i];(s instanceof lI||s instanceof cI)&&(e.mapping.maps[i].forEach((e,t,n,i)=>{null==r&&(r=i)}),e.setSelection(FI.near(e.doc.resolve(r),n)))}class KI extends DI{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return GA.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||GA.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let i=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),n=null==n?t:n,!e)return this.deleteRange(t,n);let r=this.storedMarks;if(!r){let e=this.doc.resolve(t);r=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,i.text(e,r)),this.selection.empty||this.setSelection(FI.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function YI(e,t){return t&&e?e.bind(t):e}class XI{constructor(e,t,n){this.name=e,this.init=YI(t.init,n),this.apply=YI(t.apply,n)}}const JI=[new XI("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new XI("selection",{init:(e,t)=>e.selection||FI.atStart(t.doc),apply:e=>e.selection}),new XI("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,i)=>i.selection.$cursor?e.storedMarks:null}),new XI("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class QI{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=JI.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new XI(e.key,e.spec.state,e))})}}class e_{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),i=null;for(;;){let r=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let a=i?i[s].n:0,l=i?i[s].state:this,c=a<t.length&&o.spec.appendTransaction.call(o,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let e=0;e<this.config.plugins.length;e++)i.push(e<s?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),r=!0}i&&(i[s]={state:n,n:t.length})}}if(!r)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new e_(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let r=n[i];t[r.name]=r.apply(e,this[r.name],this,t)}return t}get tr(){return new KI(this)}static create(e){let t=new QI(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new e_(t);for(let i=0;i<t.fields.length;i++)n[t.fields[i].name]=t.fields[i].init(e,n);return n}reconfigure(e){let t=new QI(this.schema,e.plugins),n=t.fields,i=new e_(t);for(let r=0;r<n.length;r++){let t=n[r].name;i[t]=this.hasOwnProperty(t)?this[t]:n[r].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[n],r=i.spec.state;r&&r.toJSON&&(t[n]=r.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new QI(e.schema,e.plugins),r=new e_(i);return i.fields.forEach(i=>{if("doc"==i.name)r.doc=uM.fromJSON(e.schema,t.doc);else if("selection"==i.name)r.selection=FI.fromJSON(r.doc,t.selection);else if("storedMarks"==i.name)t.storedMarks&&(r.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let s in n){let o=n[s],a=o.spec.state;if(o.key==i.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,s))return void(r[i.name]=a.fromJSON.call(o,e,t[s],r))}r[i.name]=i.init(e,r)}}),r}}function t_(e,t,n){for(let i in e){let r=e[i];r instanceof Function?r=r.bind(t):"handleDOMEvents"==i&&(r=t_(r,t,{})),n[i]=r}return n}class n_{constructor(e){this.spec=e,this.props={},e.props&&t_(e.props,this,this.props),this.key=e.key?e.key.key:r_("plugin")}getState(e){return e[this.key]}}const i_=Object.create(null);function r_(e){return e in i_?e+"$"+ ++i_[e]:(i_[e]=0,e+"$")}class s_{constructor(e="key"){this.key=r_(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const o_=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},a_=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let l_=null;const c_=function(e,t,n){let i=l_||(l_=document.createRange());return i.setEnd(e,null==n?e.nodeValue.length:n),i.setStart(e,t||0),i},h_=function(e,t,n,i){return n&&(d_(e,t,n,i,-1)||d_(e,t,n,i,1))},u_=/^(img|br|input|textarea|hr)$/i;function d_(e,t,n,i,r){for(;;){if(e==n&&t==i)return!0;if(t==(r<0?0:p_(e))){let n=e.parentNode;if(!n||1!=n.nodeType||f_(e)||u_.test(e.nodeName)||"false"==e.contentEditable)return!1;t=o_(e)+(r<0?0:1),e=n}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(r<0?-1:0)]).contentEditable)return!1;t=r<0?p_(e):0}}}function p_(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function f_(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const m_=function(e){return e.focusNode&&h_(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function g_(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const v_="undefined"!=typeof navigator?navigator:null,y_="undefined"!=typeof document?document:null,b_=v_&&v_.userAgent||"",w_=/Edge\/(\d+)/.exec(b_),x_=/MSIE \d/.exec(b_),C_=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(b_),S_=!!(x_||C_||w_),k_=x_?document.documentMode:C_?+C_[1]:w_?+w_[1]:0,L_=!S_&&/gecko\/(\d+)/i.test(b_);L_&&(/Firefox\/(\d+)/.exec(b_)||[0,0])[1];const E_=!S_&&/Chrome\/(\d+)/.exec(b_),P_=!!E_,T_=E_?+E_[1]:0,A_=!S_&&!!v_&&/Apple Computer/.test(v_.vendor),M_=A_&&(/Mobile\/\w+/.test(b_)||!!v_&&v_.maxTouchPoints>2),I_=M_||!!v_&&/Mac/.test(v_.platform),__=!!v_&&/Win/.test(v_.platform),O_=/Android \d/.test(b_),N_=!!y_&&"webkitFontSmoothing"in y_.documentElement.style,D_=N_?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function R_(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function F_(e,t){return"number"==typeof e?e:e[t]}function B_(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,i=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*i}}function V_(e,t,n){let i=e.someProp("scrollThreshold")||0,r=e.someProp("scrollMargin")||5,s=e.dom.ownerDocument;for(let o=n||e.dom;o;o=a_(o)){if(1!=o.nodeType)continue;let e=o,n=e==s.body,a=n?R_(s):B_(e),l=0,c=0;if(t.top<a.top+F_(i,"top")?c=-(a.top-t.top+F_(r,"top")):t.bottom>a.bottom-F_(i,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+F_(r,"top")-a.top:t.bottom-a.bottom+F_(r,"bottom")),t.left<a.left+F_(i,"left")?l=-(a.left-t.left+F_(r,"left")):t.right>a.right-F_(i,"right")&&(l=t.right-a.right+F_(r,"right")),l||c)if(n)s.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,i=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let r=e.scrollLeft-n,s=e.scrollTop-i;t={left:t.left-r,top:t.top-s,right:t.right-r,bottom:t.bottom-s}}if(n||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function j_(e){let t=[],n=e.ownerDocument;for(let i=e;i&&(t.push({dom:i,top:i.scrollTop,left:i.scrollLeft}),e!=n);i=a_(i));return t}function H_(e,t){for(let n=0;n<e.length;n++){let{dom:i,top:r,left:s}=e[n];i.scrollTop!=r+t&&(i.scrollTop=r+t),i.scrollLeft!=s&&(i.scrollLeft=s)}}let U_=null;function z_(e,t){let n,i,r,s,o=2e8,a=0,l=t.top,c=t.top;for(let h=e.firstChild,u=0;h;h=h.nextSibling,u++){let e;if(1==h.nodeType)e=h.getClientRects();else{if(3!=h.nodeType)continue;e=c_(h).getClientRects()}for(let d=0;d<e.length;d++){let p=e[d];if(p.top<=l&&p.bottom>=c){l=Math.max(p.bottom,l),c=Math.min(p.top,c);let e=p.left>t.left?p.left-t.left:p.right<t.left?t.left-p.right:0;if(e<o){n=h,o=e,i=e&&3==n.nodeType?{left:p.right<t.left?p.right:p.left,top:t.top}:t,1==h.nodeType&&e&&(a=u+(t.left>=(p.left+p.right)/2?1:0));continue}}else p.top>t.top&&!r&&p.left<=t.left&&p.right>=t.left&&(r=h,s={left:Math.max(p.left,Math.min(p.right,t.left)),top:p.top});!n&&(t.left>=p.right&&t.top>=p.top||t.left>=p.left&&t.top>=p.bottom)&&(a=u+1)}}return!n&&r&&(n=r,i=s,o=0),n&&3==n.nodeType?function(e,t){let n=e.nodeValue.length,i=document.createRange();for(let r=0;r<n;r++){i.setEnd(e,r+1),i.setStart(e,r);let n=q_(i,1);if(n.top!=n.bottom&&W_(t,n))return{node:e,offset:r+(t.left>=(n.left+n.right)/2?1:0)}}return{node:e,offset:0}}(n,i):!n||o&&1==n.nodeType?{node:e,offset:a}:z_(n,i)}function W_(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function G_(e,t,n){let i=e.childNodes.length;if(i&&n.top<n.bottom)for(let r=Math.max(0,Math.min(i-1,Math.floor(i*(t.top-n.top)/(n.bottom-n.top))-2)),s=r;;){let n=e.childNodes[s];if(1==n.nodeType){let e=n.getClientRects();for(let i=0;i<e.length;i++){let r=e[i];if(W_(t,r))return G_(n,t,r)}}if((s=(s+1)%i)==r)break}return e}function $_(e,t){let n,i=e.dom.ownerDocument,r=0,s=function(e,t,n){if(e.caretPositionFromPoint)try{let i=e.caretPositionFromPoint(t,n);if(i)return{node:i.offsetNode,offset:i.offset}}catch(i){}if(e.caretRangeFromPoint){let i=e.caretRangeFromPoint(t,n);if(i)return{node:i.startContainer,offset:i.startOffset}}}(i,t.left,t.top);s&&({node:n,offset:r}=s);let o,a=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top);if(!a||!e.dom.contains(1!=a.nodeType?a.parentNode:a)){let n=e.dom.getBoundingClientRect();if(!W_(t,n))return null;if(a=G_(e.dom,t,n),!a)return null}if(A_)for(let c=a;n&&c;c=a_(c))c.draggable&&(n=void 0);if(a=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(a,t),n){if(L_&&1==n.nodeType&&(r=Math.min(r,n.childNodes.length),r<n.childNodes.length)){let e,i=n.childNodes[r];"IMG"==i.nodeName&&(e=i.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&r++}let i;N_&&r&&1==n.nodeType&&1==(i=n.childNodes[r-1]).nodeType&&"false"==i.contentEditable&&i.getBoundingClientRect().top>=t.top&&r--,n==e.dom&&r==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?o=e.state.doc.content.size:0!=r&&1==n.nodeType&&"BR"==n.childNodes[r-1].nodeName||(o=function(e,t,n,i){let r=-1;for(let s=t,o=!1;s!=e.dom;){let t=e.docView.nearestDesc(s,!0);if(!t)return null;if(1==t.dom.nodeType&&(t.node.isBlock&&t.parent||!t.contentDOM)){let e=t.dom.getBoundingClientRect();if(t.node.isBlock&&t.parent&&(!o&&e.left>i.left||e.top>i.top?r=t.posBefore:(!o&&e.right<i.left||e.bottom<i.top)&&(r=t.posAfter),o=!0),!t.contentDOM&&r<0&&!t.node.isText)return(t.node.isBlock?i.top<(e.top+e.bottom)/2:i.left<(e.left+e.right)/2)?t.posBefore:t.posAfter}s=t.dom.parentNode}return r>-1?r:e.docView.posFromDOM(t,n,-1)}(e,n,r,t))}null==o&&(o=function(e,t,n){let{node:i,offset:r}=z_(t,n),s=-1;if(1==i.nodeType&&!i.firstChild){let e=i.getBoundingClientRect();s=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(i,r,s)}(e,a,t));let l=e.docView.nearestDesc(a,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function Z_(e){return e.top<e.bottom||e.left<e.right}function q_(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(Z_(e))return e}return Array.prototype.find.call(n,Z_)||e.getBoundingClientRect()}const K_=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Y_(e,t,n){let{node:i,offset:r,atom:s}=e.docView.domFromPos(t,n<0?-1:1),o=N_||L_;if(3==i.nodeType){if(!o||!K_.test(i.nodeValue)&&(n<0?r:r!=i.nodeValue.length)){let e=r,t=r,s=n<0?1:-1;return n<0&&!r?(t++,s=-1):n>=0&&r==i.nodeValue.length?(e--,s=1):n<0?e--:t++,X_(q_(c_(i,e,t),s),s<0)}{let e=q_(c_(i,r,r),n);if(L_&&r&&/\s/.test(i.nodeValue[r-1])&&r<i.nodeValue.length){let t=q_(c_(i,r-1,r-1),-1);if(t.top==e.top){let n=q_(c_(i,r,r+1),-1);if(n.top!=e.top)return X_(n,n.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(s||0)).parent.inlineContent){if(null==s&&r&&(n<0||r==p_(i))){let e=i.childNodes[r-1];if(1==e.nodeType)return J_(e.getBoundingClientRect(),!1)}if(null==s&&r<p_(i)){let e=i.childNodes[r];if(1==e.nodeType)return J_(e.getBoundingClientRect(),!0)}return J_(i.getBoundingClientRect(),n>=0)}if(null==s&&r&&(n<0||r==p_(i))){let e=i.childNodes[r-1],t=3==e.nodeType?c_(e,p_(e)-(o?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return X_(q_(t,1),!1)}if(null==s&&r<p_(i)){let e=i.childNodes[r];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?c_(e,0,o?0:1):1==e.nodeType?e:null:null;if(t)return X_(q_(t,-1),!0)}return X_(q_(3==i.nodeType?c_(i):i,-n),n>=0)}function X_(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function J_(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function Q_(e,t,n){let i=e.state,r=e.root.activeElement;i!=t&&e.updateState(t),r!=e.dom&&e.focus();try{return n()}finally{i!=t&&e.updateState(i),r!=e.dom&&r&&r.focus()}}const eO=/[\u0590-\u08ac]/;let tO=null,nO=null,iO=!1;function rO(e,t,n){return tO==t&&nO==n?iO:(tO=t,nO=n,iO="up"==n||"down"==n?function(e,t,n){let i=t.selection,r="up"==n?i.$from:i.$to;return Q_(e,t,()=>{let{node:t}=e.docView.domFromPos(r.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let i=Y_(e,r.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=c_(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let r=t[e];if(r.bottom>r.top+1&&("up"==n?i.top-r.top>2*(r.bottom-i.top):r.bottom-i.bottom>2*(i.bottom-r.top)))return!1}}return!0})}(e,t,n):function(e,t,n){let{$head:i}=t.selection;if(!i.parent.isTextblock)return!1;let r=i.parentOffset,s=!r,o=r==i.parent.content.size,a=e.domSelection();return eO.test(i.parent.textContent)&&a.modify?Q_(e,t,()=>{let{focusNode:t,focusOffset:r,anchorNode:s,anchorOffset:o}=e.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",n,"character");let c=i.depth?e.docView.domAfterPos(i.before()):e.dom,{focusNode:h,focusOffset:u}=e.domSelectionRange(),d=h&&!c.contains(1==h.nodeType?h:h.parentNode)||t==h&&r==u;try{a.collapse(s,o),t&&(t!=s||r!=o)&&a.extend&&a.extend(t,r)}catch(p){}return null!=l&&(a.caretBidiLevel=l),d}):"left"==n||"backward"==n?s:o}(e,t,n))}class sO{constructor(e,t,n,i){this.parent=e,this.children=t,this.dom=n,this.contentDOM=i,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let i=this.children[t];if(i==e)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,i;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&(!(i=n.pmViewDesc)||i.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(i)+i.size:this.posAtStart}{let n,i;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&(!(i=n.pmViewDesc)||i.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(i):this.posAtEnd}}let i;if(e==this.dom&&this.contentDOM)i=t>o_(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){i=!1;break}if(t.previousSibling)break}if(null==i&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){i=!0;break}if(t.nextSibling)break}}return(null==i?n>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,i=e;i;i=i.parentNode){let r,s=this.getDesc(i);if(s&&(!t||s.node)){if(!n||!(r=s.nodeDOM)||(1==r.nodeType?r.contains(1==e.nodeType?e:e.parentNode):r==e))return s;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let i=e;i;i=i.parentNode){let r=this.getDesc(i);if(r)return r.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let i=this.children[t],r=n+i.size;if(n==e&&r!=n){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<r)return i.descAt(e-n-i.border);n=r}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,i=0;for(let r=0;n<this.children.length;n++){let t=this.children[n],s=r+t.size;if(s>e||t instanceof dO){i=e-r;break}r=s}if(i)return this.children[n].domFromPos(i-this.children[n].border,t);for(let r;n&&!(r=this.children[n-1]).size&&r instanceof oO&&r.side>=0;n--);if(t<=0){let e,i=!0;for(;e=n?this.children[n-1]:null,e&&e.dom.parentNode!=this.contentDOM;n--,i=!1);return e&&t&&i&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?o_(e.dom)+1:0}}{let e,i=!0;for(;e=n<this.children.length?this.children[n]:null,e&&e.dom.parentNode!=this.contentDOM;n++,i=!1);return e&&i&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?o_(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,r=-1;for(let s=n,o=0;;o++){let n=this.children[o],a=s+n.size;if(-1==i&&e<=a){let r=s+n.border;if(e>=r&&t<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,r);e=s;for(let t=o;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){i=o_(n.dom)+1;break}e-=n.size}-1==i&&(i=0)}if(i>-1&&(a>t||o==this.children.length-1)){t=a;for(let e=o+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){r=o_(n.dom);break}t+=n.size}-1==r&&(r=this.contentDOM.childNodes.length);break}s=a}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:r}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,i=!1){let r=Math.min(e,t),s=Math.max(e,t);for(let d=0,p=0;d<this.children.length;d++){let o=this.children[d],a=p+o.size;if(r>p&&s<a)return o.setSelection(e-p-o.border,t-p-o.border,n,i);p=a}let o=this.domFromPos(e,e?-1:1),a=t==e?o:this.domFromPos(t,t?-1:1),l=n.getSelection(),c=!1;if((L_||A_)&&e==t){let{node:e,offset:t}=o;if(3==e.nodeType){if(c=!(!t||"\n"!=e.nodeValue[t-1]),c&&t==e.nodeValue.length)for(let n,i=e;i;i=i.parentNode){if(n=i.nextSibling){"BR"==n.nodeName&&(o=a={node:n.parentNode,offset:o_(n)+1});break}let e=i.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];c=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(L_&&l.focusNode&&l.focusNode!=a.node&&1==l.focusNode.nodeType){let e=l.focusNode.childNodes[l.focusOffset];e&&"false"==e.contentEditable&&(i=!0)}if(!(i||c&&A_)&&h_(o.node,o.offset,l.anchorNode,l.anchorOffset)&&h_(a.node,a.offset,l.focusNode,l.focusOffset))return;let h=!1;if((l.extend||e==t)&&!c){l.collapse(o.node,o.offset);try{e!=t&&l.extend(a.node,a.offset),h=!0}catch(u){}}if(!h){if(e>t){let e=o;o=a,a=e}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(o.node,o.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,i=0;i<this.children.length;i++){let r=this.children[i],s=n+r.size;if(n==s?e<=s&&t>=n:e<s&&t>n){let i=n+r.border,o=s-r.border;if(e>=i&&t<=o)return this.dirty=e==n||t==s?2:1,void(e!=i||t!=o||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(e-i,t-i):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}n=s}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class oO extends sO{constructor(e,t,n,i){let r,s=t.type.toDOM;if("function"==typeof s&&(s=s(n,()=>r?r.parent?r.parent.posBeforeChild(r):void 0:i)),!t.type.spec.raw){if(1!=s.nodeType){let e=document.createElement("span");e.appendChild(s),s=e}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,r=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class aO extends sO{constructor(e,t,n,i){super(e,[],t,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class lO extends sO{constructor(e,t,n,i){super(e,[],n,i),this.mark=t}static create(e,t,n,i){let r=i.nodeViews[t.type.name],s=r&&r(t,i,n);return s&&s.dom||(s=UM.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new lO(e,t,s.dom,s.contentDOM||s.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let i=lO.create(this.parent,this.mark,!0,n),r=this.children,s=this.size;t<s&&(r=LO(r,t,s,n)),e>0&&(r=LO(r,0,e,n));for(let o=0;o<r.length;o++)r[o].parent=i;return i.children=r,i}}class cO extends sO{constructor(e,t,n,i,r,s,o,a,l){super(e,[],r,s),this.node=t,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=o}static create(e,t,n,i,r,s){let o,a=r.nodeViews[t.type.name],l=a&&a(t,r,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:s,n,i),c=l&&l.dom,h=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=UM.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:h}=e)}h||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let u=c;return c=wO(c,n,t),l?o=new pO(e,t,n,i,c,h||null,u,l,r,s+1):t.isText?new uO(e,t,n,i,c,u,r):new cO(e,t,n,i,c,h||null,u,r,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>HA.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&xO(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,i=t,r=e.composing?this.localCompositionInfo(e,t):null,s=r&&r.pos>-1?r:null,o=r&&r.pos<0,a=new SO(this,s&&s.node,e);!function(e,t,n,i){let r=t.locals(e),s=0;if(0==r.length){for(let n=0;n<e.childCount;n++){let o=e.child(n);i(o,r,t.forChild(s,o),n),s+=o.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let h,u,d,p;for(;o<r.length&&r[o].to==s;){let e=r[o++];e.widget&&(h?(u||(u=[h])).push(e):h=e)}if(h)if(u){u.sort(kO);for(let e=0;e<u.length;e++)n(u[e],c,!!l)}else n(h,c,!!l);if(l)p=-1,d=l,l=null;else{if(!(c<e.childCount))break;p=c,d=e.child(c++)}for(let e=0;e<a.length;e++)a[e].to<=s&&a.splice(e--,1);for(;o<r.length&&r[o].from<=s&&r[o].to>s;)a.push(r[o++]);let f=s+d.nodeSize;if(d.isText){let e=f;o<r.length&&r[o].from<e&&(e=r[o].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<f&&(l=d.cut(e-s),d=d.cut(0,e-s),f=e,p=-1)}else for(;o<r.length&&r[o].to<f;)o++;i(d,d.isInline&&!d.isLeaf?a.filter(e=>!e.inline):a.slice(),t.forChild(s,d),p),s=f}}(this.node,this.innerDeco,(t,r,s)=>{t.spec.marks?a.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!s&&a.syncToMarks(r==this.node.childCount?GA.none:this.node.child(r).marks,n,e),a.placeWidget(t,e,i)},(t,s,l,c)=>{let h;a.syncToMarks(t.marks,n,e),a.findNodeMatch(t,s,l,c)||o&&e.state.selection.from>i&&e.state.selection.to<i+t.nodeSize&&(h=a.findIndexWithChild(r.node))>-1&&a.updateNodeAt(t,s,l,h,e)||a.updateNextNode(t,s,l,e,c,i)||a.addNode(t,s,l,e,i),i+=t.nodeSize}),a.syncToMarks([],n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(s&&this.protectLocalComposition(e,s),fO(this.contentDOM,this.children,e),M_&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof HI)||n<t||i>t+this.node.content.size)return null;let r=e.input.compositionNode;if(!r||!this.dom.contains(r.parentNode))return null;if(this.node.inlineContent){let e=r.nodeValue,s=function(e,t,n,i){for(let r=0,s=0;r<e.childCount&&s<=i;){let o=e.child(r++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;r<e.childCount;){let t=e.child(r++);if(s+=t.nodeSize,!t.isText)break;l+=t.text}if(s>=n){if(s>=i&&l.slice(i-t.length-a,i-a)==t)return i-t.length;let e=a<i?l.lastIndexOf(t,i-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==i&&l.length>=i+t.length-a&&l.slice(i-a,i-a+t.length)==t)return i}}return-1}(this.node.content,e,n-t,i-t);return s<0?null:{node:r,pos:s,text:e}}return{node:r,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:n,text:i}){if(this.getDesc(t))return;let r=t;for(;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=void 0)}let s=new aO(this,r,t,i);e.input.compositionNodes.push(s),this.children=LO(this.children,n,n+i.length,e,s)}update(e,t,n,i){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,i),!0)}updateInner(e,t,n,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(xO(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=yO(this.dom,this.nodeDOM,vO(this.outerDeco,this.node,t),vO(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function hO(e,t,n,i,r){wO(i,t,e);let s=new cO(void 0,e,t,n,i,i,i,r,0);return s.contentDOM&&s.updateChildren(r,0),s}class uO extends cO{constructor(e,t,n,i,r,s,o){super(e,t,n,i,r,null,s,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let i=this.node.cut(e,t),r=document.createTextNode(i.text);return new uO(this.parent,i,this.outerDeco,this.innerDeco,r,r,n)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class dO extends sO{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class pO extends cO{constructor(e,t,n,i,r,s,o,a,l,c){super(e,t,n,i,r,s,o,l,c),this.spec=a}update(e,t,n,i){if(3==this.dirty)return!1;if(this.spec.update){let r=this.spec.update(e,t,n);return r&&this.updateInner(e,t,n,i),r}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,i){this.spec.setSelection?this.spec.setSelection(e,t,n):super.setSelection(e,t,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function fO(e,t,n){let i=e.firstChild,r=!1;for(let s=0;s<t.length;s++){let o=t[s],a=o.dom;if(a.parentNode==e){for(;a!=i;)i=CO(i),r=!0;i=i.nextSibling}else r=!0,e.insertBefore(a,i);if(o instanceof lO){let t=i?i.previousSibling:e.lastChild;fO(o.contentDOM,o.children,n),i=t?t.nextSibling:e.firstChild}}for(;i;)i=CO(i),r=!0;r&&n.trackWrites==e&&(n.trackWrites=null)}const mO=function(e){e&&(this.nodeName=e)};mO.prototype=Object.create(null);const gO=[new mO];function vO(e,t,n){if(0==e.length)return gO;let i=n?gO[0]:new mO,r=[i];for(let s=0;s<e.length;s++){let o=e[s].type.attrs;if(o){o.nodeName&&r.push(i=new mO(o.nodeName));for(let e in o){let s=o[e];null!=s&&(n&&1==r.length&&r.push(i=new mO(t.isInline?"span":"div")),"class"==e?i.class=(i.class?i.class+" ":"")+s:"style"==e?i.style=(i.style?i.style+";":"")+s:"nodeName"!=e&&(i[e]=s))}}}return r}function yO(e,t,n,i){if(n==gO&&i==gO)return t;let r=t;for(let s=0;s<i.length;s++){let t=i[s],o=n[s];if(s){let n;o&&o.nodeName==t.nodeName&&r!=e&&(n=r.parentNode)&&n.nodeName.toLowerCase()==t.nodeName||(n=document.createElement(t.nodeName),n.pmIsDeco=!0,n.appendChild(r),o=gO[0]),r=n}bO(r,o||gO[0],t)}return r}function bO(e,t,n){for(let i in t)"class"==i||"style"==i||"nodeName"==i||i in n||e.removeAttribute(i);for(let i in n)"class"!=i&&"style"!=i&&"nodeName"!=i&&n[i]!=t[i]&&e.setAttribute(i,n[i]);if(t.class!=n.class){let i=t.class?t.class.split(" ").filter(Boolean):[],r=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<i.length;t++)-1==r.indexOf(i[t])&&e.classList.remove(i[t]);for(let t=0;t<r.length;t++)-1==i.indexOf(r[t])&&e.classList.add(r[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n,i=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=i.exec(t.style);)e.style.removeProperty(n[1])}n.style&&(e.style.cssText+=n.style)}}function wO(e,t,n){return yO(e,e,gO,vO(t,n,1!=e.nodeType))}function xO(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function CO(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class SO{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,i=n.children.length,r=e.childCount,s=new Map,o=[];e:for(;r>0;){let a;for(;;)if(i){let e=n.children[i-1];if(!(e instanceof lO)){a=e,i--;break}n=e,i=e.children.length}else{if(n==t)break e;i=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=e.child(r-1))break;--r,s.set(a,r),o.push(a)}}return{index:r,matched:s,matches:o.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let i=0,r=this.stack.length>>1,s=Math.min(r,e.length);for(;i<s&&(i==r-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&!1!==e[i].type.spec.spanning;)i++;for(;i<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<e.length;){this.stack.push(this.top,this.index+1);let i=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[r])&&!this.isLocked(n.dom)){i=t;break}}if(i>-1)i>this.index&&(this.changed=!0,this.destroyBetween(this.index,i)),this.top=this.top.children[this.index];else{let i=lO.create(this.top,e[r],t,n);this.top.children.splice(this.index,0,i),this.top=i,this.changed=!0}this.index=0,r++}}findNodeMatch(e,t,n,i){let r,s=-1;if(i>=this.preMatch.index&&(r=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&r.matchesNode(e,t,n))s=this.top.children.indexOf(r,this.index);else for(let o=this.index,a=Math.min(this.top.children.length,o+5);o<a;o++){let i=this.top.children[o];if(i.matchesNode(e,t,n)&&!this.preMatch.matched.has(i)){s=o;break}}return!(s<0)&&(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,n,i,r){let s=this.top.children[i];return 3==s.dirty&&s.dom==s.contentDOM&&(s.dirty=2),!!s.update(e,t,n,r)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,n,i,r,s){for(let o=this.index;o<this.top.children.length;o++){let a=this.top.children[o];if(a instanceof cO){let l=this.preMatch.matched.get(a);if(null!=l&&l!=r)return!1;let c,h=a.dom,u=this.isLocked(h)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&xO(t,a.outerDeco));if(!u&&a.update(e,t,n,i))return this.destroyBetween(this.index,o),a.dom!=h&&(this.changed=!0),this.index++,!0;if(!u&&(c=this.recreateWrapper(a,e,t,n,i,s)))return this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(i,s+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,i,r,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let o=cO.create(this.top,t,n,i,r,s);if(o.contentDOM){o.children=e.children,e.children=[];for(let e of o.children)e.parent=o}return e.destroy(),o}addNode(e,t,n,i,r){let s=cO.create(this.top,e,t,n,i,r);s.contentDOM&&s.updateChildren(i,r+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(e)||e!=i.widget&&i.widget.type.toDOM.parentNode){let i=new oO(this.top,e,t,n);this.top.children.splice(this.index++,0,i),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof lO;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof uO)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((A_||P_)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let i=new dO(this.top,[],n,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function kO(e,t){return e.type.side-t.type.side}function LO(e,t,n,i,r){let s=[];for(let o=0,a=0;o<e.length;o++){let l=e[o],c=a,h=a+=l.size;c>=n||h<=t?s.push(l):(c<t&&s.push(l.slice(0,t-c,i)),r&&(s.push(r),r=void 0),h>n&&s.push(l.slice(n-c,l.size,i)))}return s}function EO(e,t=null){let n=e.domSelectionRange(),i=e.state.doc;if(!n.focusNode)return null;let r=e.docView.nearestDesc(n.focusNode),s=r&&0==r.size,o=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let a,l,c=i.resolve(o);if(m_(n)){for(a=c;r&&!r.node;)r=r.parent;let e=r.node;if(r&&e.isAtom&&zI.isSelectable(e)&&r.parent&&(!e.isInline||!function(e,t,n){for(let i=0==t,r=t==p_(e);i||r;){if(e==n)return!0;let t=o_(e);if(!(e=e.parentNode))return!1;i=i&&0==t,r=r&&t==p_(e)}}(n.focusNode,n.focusOffset,r.dom))){let e=r.posBefore;l=new zI(o==e?c:i.resolve(e))}}else{let t=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(t<0)return null;a=i.resolve(t)}if(!l){l=DO(e,a,c,"pointer"==t||e.state.selection.head<c.pos&&!s?1:-1)}return l}function PO(e){return e.editable?e.hasFocus():FO(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function TO(e,t=!1){let n=e.state.selection;if(OO(e,n),PO(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&P_){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&h_(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection(),n=document.createRange(),i=e.cursorWrapper.dom,r="IMG"==i.nodeName;r?n.setEnd(i.parentNode,o_(i)+1):n.setEnd(i,0);n.collapse(!1),t.removeAllRanges(),t.addRange(n),!r&&!e.state.selection.visible&&S_&&k_<=11&&(i.disabled=!0,i.disabled=!1)}(e);else{let i,r,{anchor:s,head:o}=n;!AO||n instanceof HI||(n.$from.parent.inlineContent||(i=MO(e,n.from)),n.empty||n.$from.parent.inlineContent||(r=MO(e,n.to))),e.docView.setSelection(s,o,e.root,t),AO&&(i&&_O(i),r&&_O(r)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),i=n.anchorNode,r=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{n.anchorNode==i&&n.anchorOffset==r||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{PO(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const AO=A_||P_&&T_<63;function MO(e,t){let{node:n,offset:i}=e.docView.domFromPos(t,0),r=i<n.childNodes.length?n.childNodes[i]:null,s=i?n.childNodes[i-1]:null;if(A_&&r&&"false"==r.contentEditable)return IO(r);if(!(r&&"false"!=r.contentEditable||s&&"false"!=s.contentEditable)){if(r)return IO(r);if(s)return IO(s)}}function IO(e){return e.contentEditable="true",A_&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function _O(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function OO(e,t){if(t instanceof zI){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(NO(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else NO(e)}function NO(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function DO(e,t,n,i){return e.someProp("createSelectionBetween",i=>i(e,t,n))||HI.between(t,n,i)}function RO(e){return!(e.editable&&!e.hasFocus())&&FO(e)}function FO(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function BO(e,t){let{$anchor:n,$head:i}=e.selection,r=t>0?n.max(i):n.min(i),s=r.parent.inlineContent?r.depth?e.doc.resolve(t>0?r.after():r.before()):null:r;return s&&FI.findFrom(s,t)}function VO(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function jO(e,t,n){let i=e.state.selection;if(!(i instanceof HI)){if(i instanceof zI&&i.node.isInline)return VO(e,new HI(t>0?i.$to:i.$from));{let n=BO(e.state,t);return!!n&&VO(e,n)}}if(n.indexOf("s")>-1){let{$head:n}=i,r=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!r||r.isText||!r.isLeaf)return!1;let s=e.state.doc.resolve(n.pos+r.nodeSize*(t<0?-1:1));return VO(e,new HI(i.$anchor,s))}if(!i.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=BO(e.state,t);return!!(n&&n instanceof zI)&&VO(e,n)}if(!(I_&&n.indexOf("m")>-1)){let n,r=i.$head,s=r.textOffset?null:t<0?r.nodeBefore:r.nodeAfter;if(!s||s.isText)return!1;let o=t<0?r.pos-s.nodeSize:r.pos;return!!(s.isAtom||(n=e.docView.descAt(o))&&!n.contentDOM)&&(zI.isSelectable(s)?VO(e,new zI(t<0?e.state.doc.resolve(r.pos-s.nodeSize):r)):!!N_&&VO(e,new HI(e.state.doc.resolve(t<0?o:o+s.nodeSize))))}}function HO(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function UO(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function zO(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,i=t.focusOffset;if(!n)return;let r,s,o=!1;L_&&1==n.nodeType&&i<HO(n)&&UO(n.childNodes[i],-1)&&(o=!0);for(;;)if(i>0){if(1!=n.nodeType)break;{let e=n.childNodes[i-1];if(UO(e,-1))r=n,s=--i;else{if(3!=e.nodeType)break;n=e,i=n.nodeValue.length}}}else{if(WO(n))break;{let t=n.previousSibling;for(;t&&UO(t,-1);)r=n.parentNode,s=o_(t),t=t.previousSibling;if(t)n=t,i=HO(n);else{if(n=n.parentNode,n==e.dom)break;i=0}}}o?GO(e,n,i):r&&GO(e,r,s)}(e):function(e){let t=e.domSelectionRange(),n=t.focusNode,i=t.focusOffset;if(!n)return;let r,s,o=HO(n);for(;;)if(i<o){if(1!=n.nodeType)break;if(!UO(n.childNodes[i],1))break;r=n,s=++i}else{if(WO(n))break;{let t=n.nextSibling;for(;t&&UO(t,1);)r=t.parentNode,s=o_(t)+1,t=t.nextSibling;if(t)n=t,i=0,o=HO(n);else{if(n=n.parentNode,n==e.dom)break;i=o=0}}}r&&GO(e,r,s)}(e)}function WO(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function GO(e,t,n){if(3!=t.nodeType){let e,i;(i=function(e,t){for(;e&&t==e.childNodes.length&&!f_(e);)t=o_(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=i,n=0):(e=function(e,t){for(;e&&!t&&!f_(e);)t=o_(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let i=e.domSelection();if(m_(i)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),i.removeAllRanges(),i.addRange(e)}else i.extend&&i.extend(t,n);e.domObserver.setCurSelection();let{state:r}=e;setTimeout(()=>{e.state==r&&TO(e)},50)}function $O(e,t){let n=e.state.doc.resolve(t);if(!P_&&!__&&n.parent.inlineContent){let i=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),r=(n.top+n.bottom)/2;if(r>i.top&&r<i.bottom&&Math.abs(n.left-i.left)>1)return n.left<i.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),r=(n.top+n.bottom)/2;if(r>i.top&&r<i.bottom&&Math.abs(n.left-i.left)>1)return n.left>i.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function ZO(e,t,n){let i=e.state.selection;if(i instanceof HI&&!i.empty||n.indexOf("s")>-1)return!1;if(I_&&n.indexOf("m")>-1)return!1;let{$from:r,$to:s}=i;if(!r.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=BO(e.state,t);if(n&&n instanceof zI)return VO(e,n)}if(!r.parent.inlineContent){let n=t<0?r:s,o=i instanceof GI?FI.near(n,t):FI.findFrom(n,t);return!!o&&VO(e,o)}return!1}function qO(e,t){if(!(e.state.selection instanceof HI))return!0;let{$head:n,$anchor:i,empty:r}=e.state.selection;if(!n.sameParent(i))return!0;if(!r)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let i=e.state.tr;return t<0?i.delete(n.pos-s.nodeSize,n.pos):i.delete(n.pos,n.pos+s.nodeSize),e.dispatch(i),!0}return!1}function KO(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function YO(e,t){let n=t.keyCode,i=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==n||I_&&72==n&&"c"==i)return qO(e,-1)||zO(e,-1);if(46==n&&!t.shiftKey||I_&&68==n&&"c"==i)return qO(e,1)||zO(e,1);if(13==n||27==n)return!0;if(37==n||I_&&66==n&&"c"==i){let t=37==n?"ltr"==$O(e,e.state.selection.from)?-1:1:-1;return jO(e,t,i)||zO(e,t)}if(39==n||I_&&70==n&&"c"==i){let t=39==n?"ltr"==$O(e,e.state.selection.from)?1:-1:1;return jO(e,t,i)||zO(e,t)}return 38==n||I_&&80==n&&"c"==i?ZO(e,-1,i)||zO(e,-1):40==n||I_&&78==n&&"c"==i?function(e){if(!A_||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;KO(e,n,"true"),setTimeout(()=>KO(e,n,"false"),20)}return!1}(e)||ZO(e,1,i)||zO(e,1):i==(I_?"m":"c")&&(66==n||73==n||89==n||90==n)}function XO(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:i,openStart:r,openEnd:s}=t;for(;r>1&&s>1&&1==i.childCount&&1==i.firstChild.childCount;){r--,s--;let e=i.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),i=e.content}let o=e.someProp("clipboardSerializer")||UM.fromSchema(e.state.schema),a=aN(),l=a.createElement("div");l.appendChild(o.serializeFragment(i,{document:a}));let c,h=l.firstChild,u=0;for(;h&&1==h.nodeType&&(c=sN[h.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){let t=a.createElement(c[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),u++}h=l.firstChild}return h&&1==h.nodeType&&h.setAttribute("data-pm-slice",`${r} ${s}${u?` -${u}`:""} ${JSON.stringify(n)}`),{dom:l,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function JO(e,t,n,i,r){let s,o,a=r.parent.type.spec.code;if(!n&&!t)return null;let l=t&&(i||a||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,a||i,e)}),a)return t?new ZA(HA.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):ZA.empty;let n=e.someProp("clipboardTextParser",n=>n(t,r,i,e));if(n)o=n;else{let n=r.marks(),{schema:i}=e.state,o=UM.fromSchema(i);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=s.appendChild(document.createElement("p"));e&&t.appendChild(o.serializeNode(i.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),s=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n,i=aN().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(e);(n=r&&sN[r[1].toLowerCase()])&&(e=n.map(e=>"<"+e+">").join("")+e+n.map(e=>"</"+e+">").reverse().join(""));if(i.innerHTML=e,n)for(let s=0;s<n.length;s++)i=i.querySelector(n[s])||i;return i}(n),N_&&function(e){let t=e.querySelectorAll(P_?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let i=t[n];1==i.childNodes.length&&""==i.textContent&&i.parentNode&&i.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),i)}}(s);let c=s&&s.querySelector("[data-pm-slice]"),h=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let u=+h[3];u>0;u--){let e=s.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;s=e}if(!o){let t=e.someProp("clipboardParser")||e.someProp("domParser")||_M.fromSchema(e.state.schema);o=t.parseSlice(s,{preserveWhitespace:!(!l&&!h),context:r,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||QO.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(h)o=function(e,t){if(!e.size)return e;let n,i=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(a){return e}let{content:r,openStart:s,openEnd:o}=e;for(let l=n.length-2;l>=0;l-=2){let e=i.nodes[n[l]];if(!e||e.hasRequiredAttrs())break;r=HA.from(e.create(n[l+1],r)),s++,o++}return new ZA(r,s,o)}(rN(o,+h[1],+h[2]),h[4]);else if(o=ZA.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let i,r=t.node(n).contentMatchAt(t.index(n)),s=[];if(e.forEach(e=>{if(!s)return;let t,n=r.findWrapping(e.type);if(!n)return s=null;if(t=s.length&&i.length&&tN(n,i,e,s[s.length-1],0))s[s.length-1]=t;else{s.length&&(s[s.length-1]=nN(s[s.length-1],i.length));let t=eN(e,n);s.push(t),r=r.matchType(t.type),i=n}}),s)return HA.from(s)}return e}(o.content,r),!0),o.openStart||o.openEnd){let e=0,t=0;for(let n=o.content.firstChild;e<o.openStart&&!n.type.spec.isolating;e++,n=n.firstChild);for(let n=o.content.lastChild;t<o.openEnd&&!n.type.spec.isolating;t++,n=n.lastChild);o=rN(o,e,t)}return e.someProp("transformPasted",t=>{o=t(o,e)}),o}const QO=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function eN(e,t,n=0){for(let i=t.length-1;i>=n;i--)e=t[i].create(null,HA.from(e));return e}function tN(e,t,n,i,r){if(r<e.length&&r<t.length&&e[r]==t[r]){let s=tN(e,t,n,i.lastChild,r+1);if(s)return i.copy(i.content.replaceChild(i.childCount-1,s));if(i.contentMatchAt(i.childCount).matchType(r==e.length-1?n.type:e[r+1]))return i.copy(i.content.append(HA.from(eN(n,e,r+1))))}}function nN(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,nN(e.lastChild,t-1)),i=e.contentMatchAt(e.childCount).fillBefore(HA.empty,!0);return e.copy(n.append(i))}function iN(e,t,n,i,r,s){let o=t<0?e.firstChild:e.lastChild,a=o.content;return e.childCount>1&&(s=0),r<i-1&&(a=iN(a,t,n,i,r+1,s)),r>=n&&(a=t<0?o.contentMatchAt(0).fillBefore(a,s<=r).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(HA.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,o.copy(a))}function rN(e,t,n){return t<e.openStart&&(e=new ZA(iN(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new ZA(iN(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const sN={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let oN=null;function aN(){return oN||(oN=document.implementation.createHTMLDocument("title"))}const lN={},cN={},hN={touchstart:!0,touchmove:!0};class uN{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function dN(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function pN(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>fN(e,t))})}function fN(e,t){return e.someProp("handleDOMEvents",n=>{let i=n[t.type];return!!i&&(i(e,t)||t.defaultPrevented)})}function mN(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function gN(e){return{left:e.clientX,top:e.clientY}}function vN(e,t,n,i,r){if(-1==i)return!1;let s=e.state.doc.resolve(i);for(let o=s.depth+1;o>0;o--)if(e.someProp(t,t=>o>s.depth?t(e,n,s.nodeAfter,s.before(o),r,!0):t(e,n,s.node(o),s.before(o),r,!1)))return!0;return!1}function yN(e,t,n){e.focused||e.focus();let i=e.state.tr.setSelection(t);i.setMeta("pointer",!0),e.dispatch(i)}function bN(e,t,n,i,r){return vN(e,"handleClickOn",t,n,i)||e.someProp("handleClick",n=>n(e,t,i))||(r?function(e,t){if(-1==t)return!1;let n,i,r=e.state.selection;r instanceof zI&&(n=r.node);let s=e.state.doc.resolve(t);for(let o=s.depth+1;o>0;o--){let e=o>s.depth?s.nodeAfter:s.node(o);if(zI.isSelectable(e)){i=n&&r.$from.depth>0&&o>=r.$from.depth&&s.before(r.$from.depth+1)==r.$from.pos?s.before(r.$from.depth):s.before(o);break}}return null!=i&&(yN(e,zI.create(e.state.doc,i)),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),i=n.nodeAfter;return!!(i&&i.isAtom&&zI.isSelectable(i))&&(yN(e,new zI(n)),!0)}(e,n))}function wN(e,t,n,i){return vN(e,"handleDoubleClickOn",t,n,i)||e.someProp("handleDoubleClick",n=>n(e,t,i))}function xN(e,t,n,i){return vN(e,"handleTripleClickOn",t,n,i)||e.someProp("handleTripleClick",n=>n(e,t,i))||function(e,t,n){if(0!=n.button)return!1;let i=e.state.doc;if(-1==t)return!!i.inlineContent&&(yN(e,HI.create(i,0,i.content.size)),!0);let r=i.resolve(t);for(let s=r.depth+1;s>0;s--){let t=s>r.depth?r.nodeAfter:r.node(s),n=r.before(s);if(t.inlineContent)yN(e,HI.create(i,n+1,n+1+t.content.size));else{if(!zI.isSelectable(t))continue;yN(e,zI.create(i,n))}return!0}}(e,n,i)}function CN(e){return MN(e)}cN.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!LN(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!O_||!P_||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!M_||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",t=>t(e,n))||YO(e,n)?n.preventDefault():dN(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,g_(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},cN.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},cN.keypress=(e,t)=>{let n=t;if(LN(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||I_&&n.metaKey)return;if(e.someProp("handleKeyPress",t=>t(e,n)))return void n.preventDefault();let i=e.state.selection;if(!(i instanceof HI&&i.$from.sameParent(i.$to))){let t=String.fromCharCode(n.charCode);/[\r\n]/.test(t)||e.someProp("handleTextInput",n=>n(e,i.$from.pos,i.$to.pos,t))||e.dispatch(e.state.tr.insertText(t).scrollIntoView()),n.preventDefault()}};const SN=I_?"metaKey":"ctrlKey";lN.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let i=CN(e),r=Date.now(),s="singleClick";r-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,i=t.y-e.clientY;return n*n+i*i<100}(n,e.input.lastClick)&&!n[SN]&&("singleClick"==e.input.lastClick.type?s="doubleClick":"doubleClick"==e.input.lastClick.type&&(s="tripleClick")),e.input.lastClick={time:r,x:n.clientX,y:n.clientY,type:s};let o=e.posAtCoords(gN(n));o&&("singleClick"==s?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new kN(e,o,n,!!i)):("doubleClick"==s?wN:xN)(e,o.pos,o.inside,n)?n.preventDefault():dN(e,"pointer"))};class kN{constructor(e,t,n,i){let r,s;if(this.view=e,this.pos=t,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[SN],this.allowDefault=n.shiftKey,t.inside>-1)r=e.state.doc.nodeAt(t.inside),s=t.inside;else{let n=e.state.doc.resolve(t.pos);r=n.parent,s=n.depth?n.before():0}const o=i?null:n.target,a=o?e.docView.nearestDesc(o,!0):null;this.target=a&&1==a.dom.nodeType?a.dom:null;let{selection:l}=e.state;(0==n.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||l instanceof zI&&l.from<=s&&l.to>s)&&(this.mightDrag={node:r,pos:s,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!L_||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),dN(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>TO(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(gN(e))),this.updateAllowDefault(e),this.allowDefault||!t?dN(this.view,"pointer"):bN(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||A_&&this.mightDrag&&!this.mightDrag.node.isAtom||P_&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(yN(this.view,FI.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):dN(this.view,"pointer")}move(e){this.updateAllowDefault(e),dN(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function LN(e,t){return!!e.composing||!!(A_&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}lN.touchstart=e=>{e.input.lastTouch=Date.now(),CN(e),dN(e,"pointer")},lN.touchmove=e=>{e.input.lastTouch=Date.now(),dN(e,"pointer")},lN.contextmenu=e=>CN(e);const EN=O_?5e3:-1;function PN(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>MN(e),t))}function TN(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function AN(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=p_(e=e.childNodes[t-1])}else{if(!e.parentNode||f_(e))return null;t=o_(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),i=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||f_(e))return null;t=o_(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&i&&n!=i){let t=i.pmViewDesc,r=e.domObserver.lastChangedTextNode;if(n==r||i==r)return r;if(!t||!t.isText(i.nodeValue))return i;if(e.input.compositionNode==i){let e=n.pmViewDesc;if(e&&e.isText(n.nodeValue))return i}}return n||i}function MN(e,t=!1){if(!(O_&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),TN(e),t||e.docView&&e.docView.dirty){let t=EO(e);return t&&!t.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(t)):e.updateState(e.state),!0}return!1}}cN.compositionstart=cN.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),MN(e,!0),e.markCursor=null;else if(MN(e),L_&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,i=t.focusOffset;n&&1==n.nodeType&&0!=i;){let t=i<0?n.lastChild:n.childNodes[i-1];if(!t)break;if(3==t.nodeType){e.domSelection().collapse(t,t.nodeValue.length);break}n=t,i=-1}}e.input.composing=!0}PN(e,EN)},cN.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,PN(e,20))};const IN=S_&&k_<15||M_&&D_<604;function _N(e,t,n,i,r){let s=JO(e,t,n,i,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,r,s||ZA.empty)))return!0;if(!s)return!1;let o=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(s),a=o?e.state.tr.replaceSelectionWith(o,i):e.state.tr.replaceSelection(s);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function ON(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}lN.copy=cN.cut=(e,t)=>{let n=t,i=e.state.selection,r="cut"==n.type;if(i.empty)return;let s=IN?null:n.clipboardData,o=i.content(),{dom:a,text:l}=XO(e,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let i=getSelection(),r=document.createRange();r.selectNodeContents(t),e.dom.blur(),i.removeAllRanges(),i.addRange(r),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,a),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},cN.paste=(e,t)=>{let n=t;if(e.composing&&!O_)return;let i=IN?null:n.clipboardData,r=e.input.shiftKey&&45!=e.input.lastKeyCode;i&&_N(e,ON(i),i.getData("text/html"),r,n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,i=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(i.contentEditable="true"),i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus();let r=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),i.parentNode&&i.parentNode.removeChild(i),n?_N(e,i.value,null,r,t):_N(e,i.textContent,i.innerHTML,r,t)},50)}(e,n)};class NN{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const DN=I_?"altKey":"ctrlKey";lN.dragstart=(e,t)=>{let n=t,i=e.input.mouseDown;if(i&&i.done(),!n.dataTransfer)return;let r,s=e.state.selection,o=s.empty?null:e.posAtCoords(gN(n));if(o&&o.pos>=s.from&&o.pos<=(s instanceof zI?s.to-1:s.to));else if(i&&i.mightDrag)r=zI.create(e.state.doc,i.mightDrag.pos);else if(n.target&&1==n.target.nodeType){let t=e.docView.nearestDesc(n.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&(r=zI.create(e.state.doc,t.posBefore))}let a=(r||e.state.selection).content(),{dom:l,text:c,slice:h}=XO(e,a);(!n.dataTransfer.files.length||!P_||T_>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(IN?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",IN||n.dataTransfer.setData("text/plain",c),e.dragging=new NN(h,!n[DN],r)},lN.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},cN.dragover=cN.dragenter=(e,t)=>t.preventDefault(),cN.drop=(e,t)=>{let n=t,i=e.dragging;if(e.dragging=null,!n.dataTransfer)return;let r=e.posAtCoords(gN(n));if(!r)return;let s=e.state.doc.resolve(r.pos),o=i&&i.slice;o?e.someProp("transformPasted",t=>{o=t(o,e)}):o=JO(e,ON(n.dataTransfer),IN?null:n.dataTransfer.getData("text/html"),!1,s);let a=!(!i||n[DN]);if(e.someProp("handleDrop",t=>t(e,n,o||ZA.empty,a)))return void n.preventDefault();if(!o)return;n.preventDefault();let l=o?wI(e.state.doc,s.pos,o):s.pos;null==l&&(l=s.pos);let c=e.state.tr;if(a){let{node:e}=i;e?e.replace(c):c.deleteSelection()}let h=c.mapping.map(l),u=0==o.openStart&&0==o.openEnd&&1==o.content.childCount,d=c.doc;if(u?c.replaceRangeWith(h,h,o.content.firstChild):c.replaceRange(h,h,o),c.doc.eq(d))return;let p=c.doc.resolve(h);if(u&&zI.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new zI(p));else{let t=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((e,n,i,r)=>t=r),c.setSelection(DO(e,p,c.doc.resolve(t)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))},lN.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&TO(e)},20))},lN.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},lN.beforeinput=(e,t)=>{if(P_&&O_&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,g_(8,"Backspace"))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}};for(let os in cN)lN[os]=cN[os];function RN(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class FN{constructor(e,t){this.toDOM=e,this.spec=t||UN,this.side=this.spec.side||0}map(e,t,n,i){let{pos:r,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new jN(r-n,r-n,this)}valid(){return!0}eq(e){return this==e||e instanceof FN&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&RN(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class BN{constructor(e,t){this.attrs=e,this.spec=t||UN}map(e,t,n,i){let r=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-n,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-n;return r>=s?null:new jN(r,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof BN&&RN(this.attrs,e.attrs)&&RN(this.spec,e.spec)}static is(e){return e.type instanceof BN}destroy(){}}class VN{constructor(e,t){this.attrs=e,this.spec=t||UN}map(e,t,n,i){let r=e.mapResult(t.from+i,1);if(r.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=r.pos?null:new jN(r.pos-n,s.pos-n,this)}valid(e,t){let n,{index:i,offset:r}=e.content.findIndex(t.from);return r==t.from&&!(n=e.child(i)).isText&&r+n.nodeSize==t.to}eq(e){return this==e||e instanceof VN&&RN(this.attrs,e.attrs)&&RN(this.spec,e.spec)}destroy(){}}class jN{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new jN(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new jN(e,e,new FN(t,n))}static inline(e,t,n,i){return new jN(e,t,new BN(n,i))}static node(e,t,n,i){return new jN(e,t,new VN(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof BN}get widget(){return this.type instanceof FN}}const HN=[],UN={};class zN{constructor(e,t){this.local=e.length?e:HN,this.children=t.length?t:HN}static create(e,t){return t.length?KN(t,e,0,UN):WN}find(e,t,n){let i=[];return this.findInner(null==e?0:e,null==t?1e9:t,i,0,n),i}findInner(e,t,n,i,r){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=t&&o.to>=e&&(!r||r(o.spec))&&n.push(o.copy(o.from+i,o.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,t-o,n,i+o,r)}}map(e,t,n){return this==WN||0==e.maps.length?this:this.mapInner(e,t,0,0,n||UN)}mapInner(e,t,n,i,r){let s;for(let o=0;o<this.local.length;o++){let a=this.local[o].map(e,n,i);a&&a.type.valid(t,a)?(s||(s=[])).push(a):r.onRemove&&r.onRemove(this.local[o].spec)}return this.children.length?function(e,t,n,i,r,s,o){let a=e.slice();for(let c=0,h=s;c<n.maps.length;c++){let e=0;n.maps[c].forEach((t,n,i,r)=>{let s=r-i-(n-t);for(let o=0;o<a.length;o+=3){let i=a[o+1];if(i<0||t>i+h-e)continue;let r=a[o]+h-e;n>=r?a[o+1]=t<=r?-2:-1:t>=h&&s&&(a[o]+=s,a[o+1]+=s)}e+=s}),h=n.maps[c].map(h,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(-2==a[c+1]){l=!0,a[c+1]=-1;continue}let t=n.map(e[c]+s),h=t-r;if(h<0||h>=i.content.size){l=!0;continue}let u=n.map(e[c+1]+s,-1)-r,{index:d,offset:p}=i.content.findIndex(h),f=i.maybeChild(d);if(f&&p==h&&p+f.nodeSize==u){let i=a[c+2].mapInner(n,f,t+1,e[c]+s+1,o);i!=WN?(a[c]=h,a[c+1]=u,a[c+2]=i):(a[c+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,n,i,r,s,o){function a(e,t){for(let s=0;s<e.local.length;s++){let a=e.local[s].map(i,r,t);a?n.push(a):o.onRemove&&o.onRemove(e.local[s].spec)}for(let n=0;n<e.children.length;n+=3)a(e.children[n+2],e.children[n]+t+1)}for(let l=0;l<e.length;l+=3)-1==e[l+1]&&a(e[l+2],t[l]+s+1);return n}(a,e,t,n,r,s,o),c=KN(l,i,0,o);t=c.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<c.children.length;e+=3){let n=c.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,c.children[e],c.children[e+1],c.children[e+2])}}return new zN(t.sort(YN),a)}(this.children,s||[],e,t,n,i,r):s?new zN(s.sort(YN),HN):WN}add(e,t){return t.length?this==WN?zN.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let i,r=0;e.forEach((e,s)=>{let o,a=s+n;if(o=ZN(t,e,a)){for(i||(i=this.children.slice());r<i.length&&i[r]<s;)r+=3;i[r]==s?i[r+2]=i[r+2].addInner(e,o,a+1):i.splice(r,0,s,s+e.nodeSize,KN(o,e,a+1,UN)),r+=3}});let s=$N(r?qN(t):t,-n);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||s.splice(o--,1);return new zN(s.length?this.local.concat(s).sort(YN):this.local,i||this.children)}remove(e){return 0==e.length||this==WN?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,i=this.local;for(let r=0;r<n.length;r+=3){let i,s=n[r]+t,o=n[r+1]+t;for(let t,n=0;n<e.length;n++)(t=e[n])&&t.from>s&&t.to<o&&(e[n]=null,(i||(i=[])).push(t));if(!i)continue;n==this.children&&(n=this.children.slice());let a=n[r+2].removeInner(i,s+1);a!=WN?n[r+2]=a:(n.splice(r,3),r-=3)}if(i.length)for(let r,s=0;s<e.length;s++)if(r=e[s])for(let e=0;e<i.length;e++)i[e].eq(r,t)&&(i==this.local&&(i=this.local.slice()),i.splice(e--,1));return n==this.children&&i==this.local?this:i.length||n.length?new zN(i,n):WN}forChild(e,t){if(this==WN)return this;if(t.isLeaf)return zN.empty;let n,i;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}let r=e+1,s=r+t.content.size;for(let o=0;o<this.local.length;o++){let e=this.local[o];if(e.from<s&&e.to>r&&e.type instanceof BN){let t=Math.max(r,e.from)-r,n=Math.min(s,e.to)-r;t<n&&(i||(i=[])).push(e.copy(t,n))}}if(i){let e=new zN(i.sort(YN),HN);return n?new GN([e,n]):e}return n||WN}eq(e){if(this==e)return!0;if(!(e instanceof zN)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return XN(this.localsInner(e))}localsInner(e){if(this==WN)return HN;if(e.inlineContent||!this.local.some(BN.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof BN||t.push(this.local[n]);return t}}zN.empty=new zN([],[]),zN.removeOverlap=XN;const WN=zN.empty;class GN{constructor(e){this.members=e}map(e,t){const n=this.members.map(n=>n.map(e,t,UN));return GN.from(n)}forChild(e,t){if(t.isLeaf)return zN.empty;let n=[];for(let i=0;i<this.members.length;i++){let r=this.members[i].forChild(e,t);r!=WN&&(r instanceof GN?n=n.concat(r.members):n.push(r))}return GN.from(n)}eq(e){if(!(e instanceof GN)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let i=0;i<this.members.length;i++){let r=this.members[i].localsInner(e);if(r.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<r.length;e++)t.push(r[e])}else t=r}return t?XN(n?t:t.sort(YN)):HN}static from(e){switch(e.length){case 0:return WN;case 1:return e[0];default:return new GN(e.every(e=>e instanceof zN)?e:e.reduce((e,t)=>e.concat(t instanceof zN?t:t.members),[]))}}}function $N(e,t){if(!t||!e.length)return e;let n=[];for(let i=0;i<e.length;i++){let r=e[i];n.push(new jN(r.from+t,r.to+t,r.type))}return n}function ZN(e,t,n){if(t.isLeaf)return null;let i=n+t.nodeSize,r=null;for(let s,o=0;o<e.length;o++)(s=e[o])&&s.from>n&&s.to<i&&((r||(r=[])).push(s),e[o]=null);return r}function qN(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function KN(e,t,n,i){let r=[],s=!1;t.forEach((t,o)=>{let a=ZN(e,t,o+n);if(a){s=!0;let e=KN(a,t,n+o+1,i);e!=WN&&r.push(o,o+t.nodeSize,e)}});let o=$N(s?qN(e):e,-n).sort(YN);for(let a=0;a<o.length;a++)o[a].type.valid(t,o[a])||(i.onRemove&&i.onRemove(o[a].spec),o.splice(a--,1));return o.length||r.length?new zN(o,r):WN}function YN(e,t){return e.from-t.from||e.to-t.to}function XN(e){let t=e;for(let n=0;n<t.length-1;n++){let i=t[n];if(i.from!=i.to)for(let r=n+1;r<t.length;r++){let s=t[r];if(s.from!=i.from){s.from<i.to&&(t==e&&(t=e.slice()),t[n]=i.copy(i.from,s.from),JN(t,r,i.copy(s.from,i.to)));break}s.to!=i.to&&(t==e&&(t=e.slice()),t[r]=s.copy(s.from,i.to),JN(t,r+1,s.copy(i.to,s.to)))}}return t}function JN(e,t,n){for(;t<e.length&&YN(n,e[t])>0;)t++;e.splice(t,0,n)}function QN(e){let t=[];return e.someProp("decorations",n=>{let i=n(e.state);i&&i!=WN&&t.push(i)}),e.cursorWrapper&&t.push(zN.create(e.state.doc,[e.cursorWrapper.deco])),GN.from(t)}const eD={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},tD=S_&&k_<=11;class nD{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class iD{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new nD,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);S_&&k_<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),tD&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,eD)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(RO(this.view)){if(this.suppressingSelectionUpdates)return TO(this.view);if(S_&&k_<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&h_(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,n=new Set;for(let r=e.focusNode;r;r=a_(r))n.add(r);for(let r=e.anchorNode;r;r=a_(r))if(n.has(r)){t=r;break}let i=t&&this.view.docView.nearestDesc(t);return i&&i.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&RO(e)&&!this.ignoreSelectionChange(n),r=-1,s=-1,o=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let e=this.registerMutation(t[c],a);e&&(r=r<0?e.from:Math.min(e.from,r),s=s<0?e.to:Math.max(e.to,s),e.typeOver&&(o=!0))}if(L_&&a.length){let t=a.filter(e=>"BR"==e.nodeName);if(2==t.length){let[e,n]=t;e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}else{let{focusNode:n}=this.currentSelection;for(let i of t){let t=i.parentNode;!t||"LI"!=t.nodeName||n&&aD(e,n)==t||i.remove()}}}let l=null;r<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&m_(n)&&(l=EO(e))&&l.eq(FI.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,TO(e),this.currentSelection.set(n),e.scrollToSelection()):(r>-1||i)&&(r>-1&&(e.docView.markDirty(r,s),function(e){if(rD.has(e))return;if(rD.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)){if(e.requiresGeckoHackNode=L_,sD)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),sD=!0}}(e)),this.handleDOMChange(r,s,o,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||TO(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let i=e.addedNodes[n];t.push(i),3==i.nodeType&&(this.lastChangedTextNode=i)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,r=e.nextSibling;if(S_&&k_<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:s}=e.addedNodes[t];(!n||Array.prototype.indexOf.call(e.addedNodes,n)<0)&&(i=n),(!s||Array.prototype.indexOf.call(e.addedNodes,s)<0)&&(r=s)}let s=i&&i.parentNode==e.target?o_(i)+1:0,o=n.localPosFromDOM(e.target,s,-1),a=r&&r.parentNode==e.target?o_(r):e.target.childNodes.length;return{from:o,to:n.localPosFromDOM(e.target,a,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let rD=new WeakMap,sD=!1;function oD(e,t){let n=t.startContainer,i=t.startOffset,r=t.endContainer,s=t.endOffset,o=e.domAtPos(e.state.selection.anchor);return h_(o.node,o.offset,r,s)&&([n,i,r,s]=[r,s,n,i]),{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}}function aD(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}function lD(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(A_&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||A_&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const cD=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function hD(e,t,n,i,r){let s=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=EO(e,t);if(n&&!e.state.selection.eq(n)){if(P_&&O_&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,g_(13,"Enter"))))return;let i=e.state.tr.setSelection(n);"pointer"==t?i.setMeta("pointer",!0):"key"==t&&i.scrollIntoView(),s&&i.setMeta("composition",s),e.dispatch(i)}return}let o=e.state.doc.resolve(t),a=o.sharedDepth(n);t=o.before(a+1),n=e.state.doc.resolve(n).after(a+1);let l,c,h=e.state.selection,u=function(e,t,n){let i,{node:r,fromOffset:s,toOffset:o,from:a,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),h=c.anchorNode;if(h&&e.dom.contains(1==h.nodeType?h:h.parentNode)&&(i=[{node:h,offset:c.anchorOffset}],m_(c)||i.push({node:c.focusNode,offset:c.focusOffset})),P_&&8===e.input.lastKeyCode)for(let g=o;g>s;g--){let e=r.childNodes[g-1],t=e.pmViewDesc;if("BR"==e.nodeName&&!t){o=g;break}if(!t||t.size)break}let u=e.state.doc,d=e.someProp("domParser")||_M.fromSchema(e.state.schema),p=u.resolve(a),f=null,m=d.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:s,to:o,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:i,ruleFromNode:lD,context:p});if(i&&null!=i[0].pos){let e=i[0].pos,t=i[1]&&i[1].pos;null==t&&(t=e),f={anchor:e+a,head:t+a}}return{doc:m,sel:f,from:a,to:l}}(e,t,n),d=e.state.doc,p=d.slice(u.from,u.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(l=e.state.selection.to,c="end"):(l=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let f=function(e,t,n,i,r){let s=e.findDiffStart(t,n);if(null==s)return null;let{a:o,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==r){i-=o+Math.max(0,s-Math.min(o,a))-s}if(o<s&&e.size<t.size){let e=i<=s&&i>=o?s-i:0;s-=e,s&&s<t.size&&pD(t.textBetween(s-1,s+1))&&(s+=e?1:-1),a=s+(a-o),o=s}else if(a<s){let t=i<=s&&i>=a?s-i:0;s-=t,s&&s<e.size&&pD(e.textBetween(s-1,s+1))&&(s+=t?1:-1),o=s+(o-a),a=s}return{start:s,endA:o,endB:a}}(p.content,u.doc.content,u.from,l,c);if((M_&&e.input.lastIOSEnter>Date.now()-225||O_)&&r.some(e=>1==e.nodeType&&!cD.test(e.nodeName))&&(!f||f.endA>=f.endB)&&e.someProp("handleKeyDown",t=>t(e,g_(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(!f){if(!(i&&h instanceof HI&&!h.empty&&h.$head.sameParent(h.$anchor))||e.composing||u.sel&&u.sel.anchor!=u.sel.head){if(u.sel){let t=uD(e,e.state.doc,u.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);s&&n.setMeta("composition",s),e.dispatch(n)}}return}f={start:h.from,endA:h.to,endB:h.to}}e.input.domChangeCount++,e.state.selection.from<e.state.selection.to&&f.start==f.endB&&e.state.selection instanceof HI&&(f.start>e.state.selection.from&&f.start<=e.state.selection.from+2&&e.state.selection.from>=u.from?f.start=e.state.selection.from:f.endA<e.state.selection.to&&f.endA>=e.state.selection.to-2&&e.state.selection.to<=u.to&&(f.endB+=e.state.selection.to-f.endA,f.endA=e.state.selection.to)),S_&&k_<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>u.from&&" "==u.doc.textBetween(f.start-u.from-1,f.start-u.from+1)&&(f.start--,f.endA--,f.endB--);let m,g=u.doc.resolveNoCache(f.start-u.from),v=u.doc.resolveNoCache(f.endB-u.from),y=d.resolve(f.start),b=g.sameParent(v)&&g.parent.inlineContent&&y.end()>=f.endA;if((M_&&e.input.lastIOSEnter>Date.now()-225&&(!b||r.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!b&&g.pos<u.doc.content.size&&!g.sameParent(v)&&(m=FI.findFrom(u.doc.resolve(g.pos+1),1,!0))&&m.head==v.pos)&&e.someProp("handleKeyDown",t=>t(e,g_(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>f.start&&function(e,t,n,i,r){if(n-t<=r.pos-i.pos||dD(i,!0,!1)<r.pos)return!1;let s=e.resolve(t);if(!i.parent.isTextblock){let e=s.nodeAfter;return null!=e&&n==t+e.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=e.resolve(dD(s,!0,!0));return!(!o.parent.isTextblock||o.pos>n||dD(o,!0,!1)<n)&&i.parent.content.cut(i.parentOffset).eq(o.parent.content)}(d,f.start,f.endA,g,v)&&e.someProp("handleKeyDown",t=>t(e,g_(8,"Backspace"))))return void(O_&&P_&&e.domObserver.suppressSelectionUpdates());P_&&O_&&f.endB==f.start&&(e.input.lastAndroidDelete=Date.now()),O_&&!b&&g.start()!=v.start()&&0==v.parentOffset&&g.depth==v.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==f.endA&&(f.endB-=2,v=u.doc.resolveNoCache(f.endB-u.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,g_(13,"Enter"))})},20));let w,x,C,S=f.start,k=f.endA;if(b)if(g.pos==v.pos)S_&&k_<=11&&0==g.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>TO(e),20)),w=e.state.tr.delete(S,k),x=d.resolve(f.start).marksAcross(d.resolve(f.endA));else if(f.endA==f.endB&&(C=function(e,t){let n,i,r,s=e.firstChild.marks,o=t.firstChild.marks,a=s,l=o;for(let h=0;h<o.length;h++)a=o[h].removeFromSet(a);for(let h=0;h<s.length;h++)l=s[h].removeFromSet(l);if(1==a.length&&0==l.length)i=a[0],n="add",r=e=>e.mark(i.addToSet(e.marks));else{if(0!=a.length||1!=l.length)return null;i=l[0],n="remove",r=e=>e.mark(i.removeFromSet(e.marks))}let c=[];for(let h=0;h<t.childCount;h++)c.push(r(t.child(h)));if(HA.from(c).eq(e))return{mark:i,type:n}}(g.parent.content.cut(g.parentOffset,v.parentOffset),y.parent.content.cut(y.parentOffset,f.endA-y.start()))))w=e.state.tr,"add"==C.type?w.addMark(S,k,C.mark):w.removeMark(S,k,C.mark);else if(g.parent.child(g.index()).isText&&g.index()==v.index()-(v.textOffset?0:1)){let t=g.parent.textBetween(g.parentOffset,v.parentOffset);if(e.someProp("handleTextInput",n=>n(e,S,k,t)))return;w=e.state.tr.insertText(t,S,k)}if(w||(w=e.state.tr.replace(S,k,u.doc.slice(f.start-u.from,f.endB-u.from))),u.sel){let t=uD(e,w.doc,u.sel);t&&!(P_&&O_&&e.composing&&t.empty&&(f.start!=f.endB||e.input.lastAndroidDelete<Date.now()-100)&&(t.head==S||t.head==w.mapping.map(k)-1)||S_&&t.empty&&t.head==S)&&w.setSelection(t)}x&&w.ensureMarks(x),s&&w.setMeta("composition",s),e.dispatch(w.scrollIntoView())}function uD(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:DO(e,t.resolve(n.anchor),t.resolve(n.head))}function dD(e,t,n){let i=e.depth,r=t?e.end():e.pos;for(;i>0&&(t||e.indexAfter(i)==e.node(i).childCount);)i--,r++,t=!1;if(n){let t=e.node(i).maybeChild(e.indexAfter(i));for(;t&&!t.isLeaf;)t=t.firstChild,r++}return r}function pD(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class fD{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new uN,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(bD),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=vD(this),gD(this),this.nodeViews=yD(this),this.docView=hO(this.state.doc,mD(this),QN(this),this.dom,this),this.domObserver=new iD(this,(e,t,n,i)=>hD(this,e,t,n,i)),this.domObserver.start(),function(e){for(let t in lN){let n=lN[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!mN(e,t)||fN(e,t)||!e.editable&&t.type in cN||n(e,t)},hN[t]?{passive:!0}:void 0)}A_&&e.dom.addEventListener("input",()=>null),pN(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&pN(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(bD),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let i=this.state,r=!1,s=!1;e.storedMarks&&this.composing&&(TN(this),s=!0),this.state=e;let o=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(o||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=yD(this);(function(e,t){let n=0,i=0;for(let r in e){if(e[r]!=t[r])return!0;n++}for(let r in t)i++;return n!=i})(e,this.nodeViews)&&(this.nodeViews=e,r=!0)}(o||t.handleDOMEvents!=this._props.handleDOMEvents)&&pN(this),this.editable=vD(this),gD(this);let a=QN(this),l=mD(this),c=i.plugins==e.plugins||i.doc.eq(e.doc)?e.scrollToSelection>i.scrollToSelection?"to selection":"preserve":"reset",h=r||!this.docView.matchesNode(e.doc,l,a);!h&&e.selection.eq(i.selection)||(s=!0);let u="preserve"==c&&s&&null==this.dom.style.overflowAnchor&&function(e){let t,n,i=e.dom.getBoundingClientRect(),r=Math.max(0,i.top);for(let s=(i.left+i.right)/2,o=r+1;o<Math.min(innerHeight,i.bottom);o+=5){let i=e.root.elementFromPoint(s,o);if(!i||i==e.dom||!e.dom.contains(i))continue;let a=i.getBoundingClientRect();if(a.top>=r-20){t=i,n=a.top;break}}return{refDOM:t,refTop:n,stack:j_(e.dom)}}(this);if(s){this.domObserver.stop();let t=h&&(S_||P_)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(i.selection,e.selection);if(h){let n=P_?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=AN(this)),!r&&this.docView.update(e.doc,l,a,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=hO(e.doc,l,a,this.dom,this)),n&&!this.trackWrites&&(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return h_(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?TO(this,t):(OO(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():u&&function({refDOM:e,refTop:t,stack:n}){let i=e?e.getBoundingClientRect().top:0;H_(n,0==i?0:i-t)}(u)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof zI){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&V_(this,t.getBoundingClientRect(),e)}else V_(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(i=e)}this.dragging=new NN(e.slice,e.move,i<0?void 0:zI.create(this.state.doc,i))}someProp(e,t){let n,i=this._props&&this._props[e];if(null!=i&&(n=t?t(i):i))return n;for(let s=0;s<this.directPlugins.length;s++){let i=this.directPlugins[s].props[e];if(null!=i&&(n=t?t(i):i))return n}let r=this.state.plugins;if(r)for(let s=0;s<r.length;s++){let i=r[s].props[e];if(null!=i&&(n=t?t(i):i))return n}}hasFocus(){if(S_){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(U_)return e.focus(U_);let t=j_(e);e.focus(null==U_?{get preventScroll(){return U_={preventScroll:!0},!0}}:void 0),U_||(U_=!1,H_(t,0))}(this.dom),TO(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return e||document}updateRoot(){this._root=null}posAtCoords(e){return $_(this,e)}coordsAtPos(e,t=1){return Y_(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let i=this.docView.posFromDOM(e,t,n);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return rO(this,t||this.state,e)}pasteHTML(e,t){return _N(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return _N(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(!function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],QN(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,l_=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){fN(e,t)||!lN[t.type]||!e.editable&&t.type in cN||lN[t.type](e,t)}(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return A_&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return oD(e,n)}let n;function i(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",i,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",i,!0),n?oD(e,n):null}(this,e)||e}domSelection(){return this.root.getSelection()}}function mD(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[jN.node(0,e.state.doc.content.size,t)]}function gD(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:jN.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function vD(e){return!e.someProp("editable",t=>!1===t(e.state))}function yD(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function bD(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}for(var wD={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},xD={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},CD="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),SD="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),kD=0;kD<10;kD++)wD[48+kD]=wD[96+kD]=String(kD);for(kD=1;kD<=24;kD++)wD[kD+111]="F"+kD;for(kD=65;kD<=90;kD++)wD[kD]=String.fromCharCode(kD+32),xD[kD]=String.fromCharCode(kD);for(var LD in wD)xD.hasOwnProperty(LD)||(xD[LD]=wD[LD]);const ED="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function PD(e){let t,n,i,r,s=e.split(/-(?!$)/),o=s[s.length-1];"Space"==o&&(o=" ");for(let a=0;a<s.length-1;a++){let e=s[a];if(/^(cmd|meta|m)$/i.test(e))r=!0;else if(/^a(lt)?$/i.test(e))t=!0;else if(/^(c|ctrl|control)$/i.test(e))n=!0;else if(/^s(hift)?$/i.test(e))i=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);ED?r=!0:n=!0}}return t&&(o="Alt-"+o),n&&(o="Ctrl-"+o),r&&(o="Meta-"+o),i&&(o="Shift-"+o),o}function TD(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function AD(e){let t=function(e){let t=Object.create(null);for(let n in e)t[PD(n)]=e[n];return t}(e);return function(e,n){let i,r=function(e){var t=!(CD&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||SD&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?xD:wD)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),s=t[TD(r,n)];if(s&&s(e.state,e.dispatch,e))return!0;if(1==r.length&&" "!=r){if(n.shiftKey){let i=t[TD(r,n,!1)];if(i&&i(e.state,e.dispatch,e))return!0}if((n.shiftKey||n.altKey||n.metaKey||r.charCodeAt(0)>127)&&(i=wD[n.keyCode])&&i!=r){let r=t[TD(i,n)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}const MD=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function ID(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}const _D=(e,t,n)=>{let i=ID(e,n);if(!i)return!1;let r=RD(i);if(!r){let n=i.blockRange(),r=n&&pI(n);return null!=r&&(t&&t(e.tr.lift(n,r).scrollIntoView()),!0)}let s=r.nodeBefore;if($D(e,r,t,-1))return!0;if(0==i.parent.content.size&&(ND(s,"end")||zI.isSelectable(s)))for(let o=i.depth;;o--){let n=xI(e.doc,i.before(o),i.after(o),ZA.empty);if(n&&n.slice.size<n.to-n.from){if(t){let i=e.tr.step(n);i.setSelection(ND(s,"end")?FI.findFrom(i.doc.resolve(i.mapping.map(r.pos,-1)),-1):zI.create(i.doc,r.pos-s.nodeSize)),t(i.scrollIntoView())}return!0}if(1==o||i.node(o-1).childCount>1)break}return!(!s.isAtom||r.depth!=i.depth-1)&&(t&&t(e.tr.delete(r.pos-s.nodeSize,r.pos).scrollIntoView()),!0)};function OD(e,t,n){let i=t.nodeBefore,r=t.pos-1;for(;!i.isTextblock;r--){if(i.type.spec.isolating)return!1;let e=i.lastChild;if(!e)return!1;i=e}let s=t.nodeAfter,o=t.pos+1;for(;!s.isTextblock;o++){if(s.type.spec.isolating)return!1;let e=s.firstChild;if(!e)return!1;s=e}let a=xI(e.doc,r,o,ZA.empty);if(!a||a.from!=r||a instanceof lI&&a.slice.size>=o-r)return!1;if(n){let t=e.tr.step(a);t.setSelection(HI.create(t.doc,r)),n(t.scrollIntoView())}return!0}function ND(e,t,n=!1){for(let i=e;i;i="start"==t?i.firstChild:i.lastChild){if(i.isTextblock)return!0;if(n&&1!=i.childCount)return!1}return!1}const DD=(e,t,n)=>{let{$head:i,empty:r}=e.selection,s=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):i.parentOffset>0)return!1;s=RD(i)}let o=s&&s.nodeBefore;return!(!o||!zI.isSelectable(o))&&(t&&t(e.tr.setSelection(zI.create(e.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function RD(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function FD(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}const BD=(e,t,n)=>{let i=FD(e,n);if(!i)return!1;let r=jD(i);if(!r)return!1;let s=r.nodeAfter;if($D(e,r,t,1))return!0;if(0==i.parent.content.size&&(ND(s,"start")||zI.isSelectable(s))){let n=xI(e.doc,i.before(),i.after(),ZA.empty);if(n&&n.slice.size<n.to-n.from){if(t){let i=e.tr.step(n);i.setSelection(ND(s,"start")?FI.findFrom(i.doc.resolve(i.mapping.map(r.pos)),1):zI.create(i.doc,i.mapping.map(r.pos))),t(i.scrollIntoView())}return!0}}return!(!s.isAtom||r.depth!=i.depth-1)&&(t&&t(e.tr.delete(r.pos,r.pos+s.nodeSize).scrollIntoView()),!0)},VD=(e,t,n)=>{let{$head:i,empty:r}=e.selection,s=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):i.parentOffset<i.parent.content.size)return!1;s=jD(i)}let o=s&&s.nodeAfter;return!(!o||!zI.isSelectable(o))&&(t&&t(e.tr.setSelection(zI.create(e.doc,s.pos)).scrollIntoView()),!0)};function jD(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}const HD=(e,t)=>{let{$head:n,$anchor:i}=e.selection;return!(!n.parent.type.spec.code||!n.sameParent(i))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function UD(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const zD=(e,t)=>{let n=e.selection,{$from:i,$to:r}=n;if(n instanceof GI||i.parent.inlineContent||r.parent.inlineContent)return!1;let s=UD(r.parent.contentMatchAt(r.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let n=(!i.parentOffset&&r.index()<r.parent.childCount?i:r).pos,o=e.tr.insert(n,s.createAndFill());o.setSelection(HI.create(o.doc,n+1)),t(o.scrollIntoView())}return!0},WD=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if(gI(e.doc,i))return t&&t(e.tr.split(i).scrollIntoView()),!0}let i=n.blockRange(),r=i&&pI(i);return null!=r&&(t&&t(e.tr.lift(i,r).scrollIntoView()),!0)};const GD=(e,t)=>{let{$from:n,$to:i}=e.selection;if(e.selection instanceof zI&&e.selection.node.isBlock)return!(!n.parentOffset||!gI(e.doc,n.pos)||(t&&t(e.tr.split(n.pos).scrollIntoView()),0));if(!n.parent.isBlock)return!1;if(t){let r=i.parentOffset==i.parent.content.size,s=e.tr;(e.selection instanceof HI||e.selection instanceof GI)&&s.deleteSelection();let o=0==n.depth?null:UD(n.node(-1).contentMatchAt(n.indexAfter(-1))),a=r&&o?[{type:o}]:void 0,l=gI(s.doc,s.mapping.map(n.pos),1,a);if(a||l||!gI(s.doc,s.mapping.map(n.pos),1,o?[{type:o}]:void 0)||(o&&(a=[{type:o}]),l=!0),l&&(s.split(s.mapping.map(n.pos),1,a),!r&&!n.parentOffset&&n.parent.type!=o)){let e=s.mapping.map(n.before()),t=s.doc.resolve(e);o&&n.node(-1).canReplaceWith(t.index(),t.index()+1,o)&&s.setNodeMarkup(s.mapping.map(n.before()),o)}t(s.scrollIntoView())}return!0};function $D(e,t,n,i){let r,s,o=t.nodeBefore,a=t.nodeAfter,l=o.type.spec.isolating||a.type.spec.isolating;if(!l&&function(e,t,n){let i=t.nodeBefore,r=t.nodeAfter,s=t.index();return!(!(i&&r&&i.type.compatibleContent(r.type))||(!i.content.size&&t.parent.canReplace(s-1,s)?(n&&n(e.tr.delete(t.pos-i.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(s,s+1)||!r.isTextblock&&!vI(e.doc,t.pos)||(n&&n(e.tr.clearIncompatible(t.pos,i.type,i.contentMatchAt(i.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(r=(s=o.contentMatchAt(o.childCount)).findWrapping(a.type))&&s.matchType(r[0]||a.type).validEnd){if(n){let i=t.pos+a.nodeSize,s=HA.empty;for(let e=r.length-1;e>=0;e--)s=HA.from(r[e].create(null,s));s=HA.from(o.copy(s));let l=e.tr.step(new cI(t.pos-1,i,t.pos,i,new ZA(s,1,0),r.length,!0)),c=i+2*r.length;vI(l.doc,c)&&l.join(c),n(l.scrollIntoView())}return!0}let h=a.type.spec.isolating||i>0&&l?null:FI.findFrom(t,1),u=h&&h.$from.blockRange(h.$to),d=u&&pI(u);if(null!=d&&d>=t.depth)return n&&n(e.tr.lift(u,d).scrollIntoView()),!0;if(c&&ND(a,"start",!0)&&ND(o,"end")){let i=o,r=[];for(;r.push(i),!i.isTextblock;)i=i.lastChild;let s=a,l=1;for(;!s.isTextblock;s=s.firstChild)l++;if(i.canReplace(i.childCount,i.childCount,s.content)){if(n){let i=HA.empty;for(let e=r.length-1;e>=0;e--)i=HA.from(r[e].copy(i));n(e.tr.step(new cI(t.pos-r.length,t.pos+a.nodeSize,t.pos+l,t.pos+a.nodeSize-l,new ZA(i,r.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function ZD(e){return function(t,n){let i=t.selection,r=e<0?i.$from:i.$to,s=r.depth;for(;r.node(s).isInline;){if(!s)return!1;s--}return!!r.node(s).isTextblock&&(n&&n(t.tr.setSelection(HI.create(t.doc,e<0?r.start(s):r.end(s)))),!0)}}const qD=ZD(-1),KD=ZD(1);function YD(e,t=null){return function(n,i){let r=!1;for(let s=0;s<n.selection.ranges.length&&!r;s++){let{$from:{pos:i},$to:{pos:o}}=n.selection.ranges[s];n.doc.nodesBetween(i,o,(i,s)=>{if(r)return!1;if(i.isTextblock&&!i.hasMarkup(e,t))if(i.type==e)r=!0;else{let t=n.doc.resolve(s),i=t.index();r=t.parent.canReplaceWith(i,i+1,e)}})}if(!r)return!1;if(i){let r=n.tr;for(let i=0;i<n.selection.ranges.length;i++){let{$from:{pos:s},$to:{pos:o}}=n.selection.ranges[i];r.setBlockType(s,o,e,t)}i(r.scrollIntoView())}return!0}}function XD(...e){return function(t,n,i){for(let r=0;r<e.length;r++)if(e[r](t,n,i))return!0;return!1}}function JD(e,t=null){return function(n,i){let{$from:r,$to:s}=n.selection,o=r.blockRange(s),a=!1,l=o;if(!o)return!1;if(o.depth>=2&&r.node(o.depth-1).type.compatibleContent(e)&&0==o.startIndex){if(0==r.index(o.depth-1))return!1;let e=n.doc.resolve(o.start-2);l=new cM(e,e,o.depth),o.endIndex<o.parent.childCount&&(o=new cM(r,n.doc.resolve(s.end(o.depth)),o.depth)),a=!0}let c=fI(l,e,t,o);return!!c&&(i&&i(function(e,t,n,i,r){let s=HA.empty;for(let h=n.length-1;h>=0;h--)s=HA.from(n[h].type.create(n[h].attrs,s));e.step(new cI(t.start-(i?2:0),t.end,t.start,t.end,new ZA(s,0,0),n.length,!0));let o=0;for(let h=0;h<n.length;h++)n[h].type==r&&(o=h+1);let a=n.length-o,l=t.start+n.length-(i?2:0),c=t.parent;for(let h=t.startIndex,u=t.endIndex,d=!0;h<u;h++,d=!1)!d&&gI(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(h).nodeSize;return e}(n.tr,o,c,a,e).scrollIntoView()),!0)}}function QD(e){return function(t,n){let{$from:i,$to:r}=t.selection,s=i.blockRange(r,t=>t.childCount>0&&t.firstChild.type==e);return!!s&&(!n||(i.node(s.depth-1).type==e?function(e,t,n,i){let r=e.tr,s=i.end,o=i.$to.end(i.depth);s<o&&(r.step(new cI(s-1,o,s,o,new ZA(HA.from(n.create(null,i.parent.copy())),1,0),1,!0)),i=new cM(r.doc.resolve(i.$from.pos),r.doc.resolve(o),i.depth));const a=pI(i);if(null==a)return!1;r.lift(i,a);let l=r.mapping.map(s,-1)-1;vI(r.doc,l)&&r.join(l);return t(r.scrollIntoView()),!0}(t,n,e,s):function(e,t,n){let i=e.tr,r=n.parent;for(let p=n.end,f=n.endIndex-1,m=n.startIndex;f>m;f--)p-=r.child(f).nodeSize,i.delete(p-1,p+1);let s=i.doc.resolve(n.start),o=s.nodeAfter;if(i.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==r.childCount,c=s.node(-1),h=s.index(-1);if(!c.canReplace(h+(a?0:1),h+1,o.content.append(l?HA.empty:HA.from(r))))return!1;let u=s.pos,d=u+o.nodeSize;return i.step(new cI(u-(a?1:0),d+(l?1:0),u+1,d-1,new ZA((a?HA.empty:HA.from(r.copy(HA.empty))).append(l?HA.empty:HA.from(r.copy(HA.empty))),a?0:1,l?0:1),a?0:1)),t(i.scrollIntoView()),!0}(t,n,s)))}}function eR(e){const{state:t,transaction:n}=e;let{selection:i}=n,{doc:r}=n,{storedMarks:s}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return s},get selection(){return i},get doc(){return r},get tr(){return i=n.selection,r=n.doc,s=n.storedMarks,n}}}XD(MD,_D,DD),XD(MD,BD,VD),XD(HD,zD,WD,GD),"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class tR{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:i}=t,{tr:r}=n,s=this.buildProps(r);return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,(...e)=>{const n=t(...e)(s);return r.getMeta("preventDispatch")||this.hasCustomState||i.dispatch(r),n}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:i,state:r}=this,{view:s}=i,o=[],a=!!e,l=e||r.tr,c={...Object.fromEntries(Object.entries(n).map(([e,n])=>[e,(...e)=>{const i=this.buildProps(l,t),r=n(...e)(i);return o.push(r),c}])),run:()=>(a||!t||l.getMeta("preventDispatch")||this.hasCustomState||s.dispatch(l),o.every(e=>!0===e))};return c}createCan(e){const{rawCommands:t,state:n}=this,i=!1,r=e||n.tr,s=this.buildProps(r,i),o=Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)({...s,dispatch:void 0})]));return{...o,chain:()=>this.createChain(r,i)}}buildProps(e,t=!0){const{rawCommands:n,editor:i,state:r}=this,{view:s}=i,o={tr:e,editor:i,view:s,state:eR({state:r,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([e,t])=>[e,(...e)=>t(...e)(o)]))}};return o}}class nR{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function iR(e,t,n){if(void 0===e.config[t]&&e.parent)return iR(e.parent,t,n);if("function"==typeof e.config[t]){return e.config[t].bind({...n,parent:e.parent?iR(e.parent,t,n):null})}return e.config[t]}function rR(e){return{baseExtensions:e.filter(e=>"extension"===e.type),nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function sR(e){const t=[],{nodeExtensions:n,markExtensions:i}=rR(e),r=[...n,...i],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{const n=iR(e,"addGlobalAttributes",{name:e.name,options:e.options,storage:e.storage,extensions:r});if(!n)return;n().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(([e,i])=>{t.push({type:n,name:e,attribute:{...s,...i}})})})})}),r.forEach(e=>{const n={name:e.name,options:e.options,storage:e.storage},i=iR(e,"addAttributes",n);if(!i)return;const r=i();Object.entries(r).forEach(([n,i])=>{const r={...s,...i};"function"==typeof(null==r?void 0:r.default)&&(r.default=r.default()),(null==r?void 0:r.isRequired)&&void 0===(null==r?void 0:r.default)&&delete r.default,t.push({type:e.name,name:n,attribute:r})})}),t}function oR(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function aR(...e){return e.filter(e=>!!e).reduce((e,t)=>{const n={...e};return Object.entries(t).forEach(([e,t])=>{if(n[e])if("class"===e){const i=t?t.split(" "):[],r=n[e]?n[e].split(" "):[],s=i.filter(e=>!r.includes(e));n[e]=[...r,...s].join(" ")}else n[e]="style"===e?[n[e],t].join("; "):t;else n[e]=t}),n},{})}function lR(e,t){return t.filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>aR(e,t),{})}function cR(e){return"function"==typeof e}function hR(e,t=void 0,...n){return cR(e)?t?e.bind(t)(...n):e(...n):e}function uR(e,t){return"style"in e?e:{...e,getAttrs:n=>{const i=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===i)return!1;const r=t.reduce((e,t)=>{const i=t.attribute.parseHTML?t.attribute.parseHTML(n):function(e){return"string"!=typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(n.getAttribute(t.name));return null==i?e:{...e,[t.name]:i}},{});return{...i,...r}}}}function dR(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>("attrs"!==e||!function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t))}function pR(e,t){return t.nodes[e]||t.marks[e]||null}function fR(e,t){return Array.isArray(t)?t.some(t=>("string"==typeof t?t:t.name)===e.name):t}function mR(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class gR{constructor(e){this.find=e.find,this.handler=e.handler}}function vR(e){var t;const{editor:n,from:i,to:r,text:s,rules:o,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(i);if(c.parent.type.spec.code||(null===(t=c.nodeBefore||c.nodeAfter)||void 0===t?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let h=!1;const u=((e,t=500)=>{let n="";const i=e.parentOffset;return e.parent.nodesBetween(Math.max(0,i-t),i,(e,t,r,s)=>{var o,a;const l=(null===(a=(o=e.type.spec).toText)||void 0===a?void 0:a.call(o,{node:e,pos:t,parent:r,index:s}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,i-t))}),n})(c)+s;return o.forEach(e=>{if(h)return;const t=((e,t)=>{if(mR(t))return t.exec(e);const n=t(e);if(!n)return null;const i=[n.text];return i.index=n.index,i.input=e,i.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),i.push(n.replaceWith)),i})(u,e.find);if(!t)return;const o=l.state.tr,c=eR({state:l.state,transaction:o}),d={from:i-(t[0].length-s.length),to:r},{commands:p,chain:f,can:m}=new tR({editor:n,state:c});null!==e.handler({state:c,range:d,match:t,commands:p,chain:f,can:m})&&o.steps.length&&(o.setMeta(a,{transform:o,from:i,to:r,text:s}),l.dispatch(o),h=!0)}),h}function yR(e){const{editor:t,rules:n}=e,i=new n_({state:{init:()=>null,apply(e,r){const s=e.getMeta(i);if(s)return s;const o=e.getMeta("applyInputRules");return!!o&&setTimeout(()=>{const{from:e,text:r}=o,s=e+r.length;vR({editor:t,from:e,to:s,text:r,rules:n,plugin:i})}),e.selectionSet||e.docChanged?null:r}},props:{handleTextInput:(e,r,s,o)=>vR({editor:t,from:r,to:s,text:o,rules:n,plugin:i}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{const{$cursor:r}=e.state.selection;r&&vR({editor:t,from:r.pos,to:r.pos,text:"",rules:n,plugin:i})}),!1)},handleKeyDown(e,r){if("Enter"!==r.key)return!1;const{$cursor:s}=e.state.selection;return!!s&&vR({editor:t,from:s.pos,to:s.pos,text:"\n",rules:n,plugin:i})}},isInputRules:!0});return i}class bR{constructor(e){this.find=e.find,this.handler=e.handler}}function wR(e){const{editor:t,state:n,from:i,to:r,rule:s,pasteEvent:o,dropEvent:a}=e,{commands:l,chain:c,can:h}=new tR({editor:t,state:n}),u=[];n.doc.nodesBetween(i,r,(e,t)=>{if(!e.isTextblock||e.type.spec.code)return;const d=Math.max(i,t),p=Math.min(r,t+e.content.size);((e,t,n)=>{if(mR(t))return[...e.matchAll(t)];const i=t(e,n);return i?i.map(t=>{const n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]})(e.textBetween(d-t,p-t,void 0,""),s.find,o).forEach(e=>{if(void 0===e.index)return;const t=d+e.index+1,i=t+e[0].length,r={from:n.tr.mapping.map(t),to:n.tr.mapping.map(i)},p=s.handler({state:n,range:r,match:e,commands:l,chain:c,can:h,pasteEvent:o,dropEvent:a});u.push(p)})});return u.every(e=>null!==e)}function xR(e){const{editor:t,rules:n}=e;let i=null,r=!1,s=!1,o="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,a="undefined"!=typeof DragEvent?new DragEvent("drop"):null;const l=({state:e,from:n,to:i,rule:r,pasteEvt:s})=>{const l=e.tr,c=eR({state:e,transaction:l});if(wR({editor:t,state:c,from:Math.max(n-1,0),to:i.b-1,rule:r,pasteEvent:s,dropEvent:a})&&l.steps.length)return a="undefined"!=typeof DragEvent?new DragEvent("drop"):null,o="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,l},c=n.map(e=>new n_({view(e){const t=t=>{var n;i=(null===(n=e.dom.parentElement)||void 0===n?void 0:n.contains(t.target))?e.dom.parentElement:null};return window.addEventListener("dragstart",t),{destroy(){window.removeEventListener("dragstart",t)}}},props:{handleDOMEvents:{drop:(e,t)=>(s=i===e.dom.parentElement,a=t,!1),paste:(e,t)=>{var n;const i=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/html");return o=t,r=!!(null==i?void 0:i.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,i)=>{const a=t[0],c="paste"===a.getMeta("uiEvent")&&!r,h="drop"===a.getMeta("uiEvent")&&!s,u=a.getMeta("applyPasteRules"),d=!!u;if(!c&&!h&&!d)return;if(d){const{from:t,text:n}=u,r=t+n.length,s=(e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null===(t=n.clipboardData)||void 0===t||t.setData("text/html",e),n})(n);return l({rule:e,state:i,from:t,to:{b:r},pasteEvt:s})}const p=n.doc.content.findDiffStart(i.doc.content),f=n.doc.content.findDiffEnd(i.doc.content);return"number"==typeof p&&f&&p!==f.b?l({rule:e,state:i,from:p,to:f,pasteEvt:o}):void 0}}));return c}class CR{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=CR.resolve(e),this.schema=function(e,t){var n;const i=sR(e),{nodeExtensions:r,markExtensions:s}=rR(e),o=null===(n=r.find(e=>iR(e,"topNode")))||void 0===n?void 0:n.name,a=Object.fromEntries(r.map(n=>{const r=i.filter(e=>e.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:t},o=dR({...e.reduce((e,t)=>{const i=iR(t,"extendNodeSchema",s);return{...e,...i?i(n):{}}},{}),content:hR(iR(n,"content",s)),marks:hR(iR(n,"marks",s)),group:hR(iR(n,"group",s)),inline:hR(iR(n,"inline",s)),atom:hR(iR(n,"atom",s)),selectable:hR(iR(n,"selectable",s)),draggable:hR(iR(n,"draggable",s)),code:hR(iR(n,"code",s)),whitespace:hR(iR(n,"whitespace",s)),defining:hR(iR(n,"defining",s)),isolating:hR(iR(n,"isolating",s)),attrs:Object.fromEntries(r.map(e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),a=hR(iR(n,"parseHTML",s));a&&(o.parseDOM=a.map(e=>uR(e,r)));const l=iR(n,"renderHTML",s);l&&(o.toDOM=e=>l({node:e,HTMLAttributes:lR(e,r)}));const c=iR(n,"renderText",s);return c&&(o.toText=c),[n.name,o]})),l=Object.fromEntries(s.map(n=>{const r=i.filter(e=>e.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:t},o=dR({...e.reduce((e,t)=>{const i=iR(t,"extendMarkSchema",s);return{...e,...i?i(n):{}}},{}),inclusive:hR(iR(n,"inclusive",s)),excludes:hR(iR(n,"excludes",s)),group:hR(iR(n,"group",s)),spanning:hR(iR(n,"spanning",s)),code:hR(iR(n,"code",s)),attrs:Object.fromEntries(r.map(e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),a=hR(iR(n,"parseHTML",s));a&&(o.parseDOM=a.map(e=>uR(e,r)));const l=iR(n,"renderHTML",s);return l&&(o.toDOM=e=>l({mark:e,HTMLAttributes:lR(e,r)})),[n.name,o]}));return new MM({topNode:o,nodes:a,marks:l})}(this.extensions,t),this.setupExtensions()}static resolve(e){const t=CR.sort(CR.flatten(e)),n=function(e){const t=e.filter((t,n)=>e.indexOf(t)!==n);return[...new Set(t)]}(t.map(e=>e.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(e=>`'${e}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(e=>{const t=iR(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return t?[e,...this.flatten(t())]:e}).flat(10)}static sort(e){return e.sort((e,t)=>{const n=iR(e,"priority")||100,i=iR(t,"priority")||100;return n>i?-1:n<i?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const n=iR(t,"addCommands",{name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:pR(t.name,this.schema)});return n?{...e,...n()}:e},{})}get plugins(){const{editor:e}=this,t=CR.sort([...this.extensions].reverse()),n=[],i=[],r=t.map(t=>{const r={name:t.name,options:t.options,storage:t.storage,editor:e,type:pR(t.name,this.schema)},s=[],o=iR(t,"addKeyboardShortcuts",r);let a={};if("mark"===t.type&&iR(t,"exitable",r)&&(a.ArrowRight=()=>yF.handleExit({editor:e,mark:t})),o){const t=Object.fromEntries(Object.entries(o()).map(([t,n])=>[t,()=>n({editor:e})]));a={...a,...t}}const l=new n_({props:{handleKeyDown:AD(a)}});s.push(l);const c=iR(t,"addInputRules",r);fR(t,e.options.enableInputRules)&&c&&n.push(...c());const h=iR(t,"addPasteRules",r);fR(t,e.options.enablePasteRules)&&h&&i.push(...h());const u=iR(t,"addProseMirrorPlugins",r);if(u){const e=u();s.push(...e)}return s}).flat();return[yR({editor:e,rules:n}),...xR({editor:e,rules:i}),...r]}get attributes(){return sR(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=rR(this.extensions);return Object.fromEntries(t.filter(e=>!!iR(e,"addNodeView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),i={name:t.name,options:t.options,storage:t.storage,editor:e,type:oR(t.name,this.schema)},r=iR(t,"addNodeView",i);if(!r)return[];return[t.name,(i,s,o,a)=>{const l=lR(i,n);return r()({editor:e,node:i,getPos:o,decorations:a,HTMLAttributes:l,extension:t})}]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:pR(e.name,this.schema)};if("mark"===e.type){(null===(t=hR(iR(e,"keepOnSplit",n)))||void 0===t||t)&&this.splittableMarks.push(e.name)}const i=iR(e,"onBeforeCreate",n),r=iR(e,"onCreate",n),s=iR(e,"onUpdate",n),o=iR(e,"onSelectionUpdate",n),a=iR(e,"onTransaction",n),l=iR(e,"onFocus",n),c=iR(e,"onBlur",n),h=iR(e,"onDestroy",n);i&&this.editor.on("beforeCreate",i),r&&this.editor.on("create",r),s&&this.editor.on("update",s),o&&this.editor.on("selectionUpdate",o),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),h&&this.editor.on("destroy",h)})}}function SR(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&(e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype)}function kR(e,t){const n={...e};return SR(e)&&SR(t)&&Object.keys(t).forEach(i=>{SR(t[i])&&SR(e[i])?n[i]=kR(e[i],t[i]):n[i]=t[i]}),n}class LR{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=hR(iR(this,"addOptions",{name:this.name}))),this.storage=hR(iR(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new LR(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>kR(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new LR({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=hR(iR(t,"addOptions",{name:t.name})),t.storage=hR(iR(t,"addStorage",{name:t.name,options:t.options})),t}}function ER(e,t,n){const{from:i,to:r}=t,{blockSeparator:s="\n\n",textSerializers:o={}}=n||{};let a="";return e.nodesBetween(i,r,(e,n,l,c)=>{var h;e.isBlock&&n>i&&(a+=s);const u=null==o?void 0:o[e.type.name];if(u)return l&&(a+=u({node:e,pos:n,parent:l,index:c,range:t})),!1;e.isText&&(a+=null===(h=null==e?void 0:e.text)||void 0===h?void 0:h.slice(Math.max(i,n)-n,r-n))}),a}function PR(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const TR=LR.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new n_({key:new s_("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:i,selection:r}=t,{ranges:s}=r,o=Math.min(...s.map(e=>e.$from.pos)),a=Math.max(...s.map(e=>e.$to.pos)),l=PR(n);return ER(i,{from:o,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}});function AR(e,t,n={strict:!0}){const i=Object.keys(t);return!i.length||i.every(i=>n.strict?t[i]===e[i]:mR(t[i])?t[i].test(e[i]):t[i]===e[i])}function MR(e,t,n={}){return e.find(e=>e.type===t&&AR(e.attrs,n))}function IR(e,t,n={}){return!!MR(e,t,n)}function _R(e,t,n={}){if(!e||!t)return;let i=e.parent.childAfter(e.parentOffset);if(e.parentOffset===i.offset&&0!==i.offset&&(i=e.parent.childBefore(e.parentOffset)),!i.node)return;const r=MR([...i.node.marks],t,n);if(!r)return;let s=i.index,o=e.start()+i.offset,a=s+1,l=o+i.node.nodeSize;for(MR([...i.node.marks],t,n);s>0&&r.isInSet(e.parent.child(s-1).marks);)s-=1,o-=e.parent.child(s).nodeSize;for(;a<e.parent.childCount&&IR([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function OR(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function NR(e){return e instanceof HI}function DR(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function RR(e,t=null){if(!t)return null;const n=FI.atStart(e),i=FI.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return i;const r=n.from,s=i.to;return"all"===t?HI.create(e,DR(0,r,s),DR(e.content.size,r,s)):HI.create(e,DR(t,r,s),DR(t,r,s))}function FR(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const BR=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const i=t[n];3===i.nodeType&&i.nodeValue&&/^(\n\s\s|\n)$/.test(i.nodeValue)?e.removeChild(i):1===i.nodeType&&BR(i)}return e};function VR(e){const t=`<body>${e}</body>`,n=(new window.DOMParser).parseFromString(t,"text/html").body;return BR(n)}function jR(e,t,n){n={slice:!0,parseOptions:{},...n};const i="string"==typeof e;if("object"==typeof e&&null!==e)try{return Array.isArray(e)&&e.length>0?HA.fromArray(e.map(e=>t.nodeFromJSON(e))):t.nodeFromJSON(e)}catch(r){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),jR("",t,n)}if(i){if(n.errorOnInvalidContent){let i=!1,r="";const s=new MM({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(i=!0,r="string"==typeof e?e:e.outerHTML,null)}]}})});if(n.slice?_M.fromSchema(s).parseSlice(VR(e),n.parseOptions):_M.fromSchema(s).parse(VR(e),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${r}`)})}const i=_M.fromSchema(t);return n.slice?i.parseSlice(VR(e),n.parseOptions).content:i.parse(VR(e),n.parseOptions)}return jR("",t,n)}function HR(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function UR(e,t,n={}){const{from:i,to:r,empty:s}=e.selection,o=t?oR(t,e.schema):null,a=[];e.doc.nodesBetween(i,r,(e,t)=>{if(e.isText)return;const n=Math.max(i,t),s=Math.min(r,t+e.nodeSize);a.push({node:e,from:n,to:s})});const l=r-i,c=a.filter(e=>!o||o.name===e.node.type.name).filter(e=>AR(e.node.attrs,n,{strict:!1}));if(s)return!!c.length;return c.reduce((e,t)=>e+t.to-t.from,0)>=l}function zR(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function WR(e,t){const n="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,i)=>(n.includes(i)||(t[i]=e[i]),t),{})}function GR(e,t,n={},i={}){return jR(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:i.errorOnInvalidContent})}function $R(e,t){const n=OR(t,e.schema),{from:i,to:r,empty:s}=e.selection,o=[];s?(e.storedMarks&&o.push(...e.storedMarks),o.push(...e.selection.$head.marks())):e.doc.nodesBetween(i,r,e=>{o.push(...e.marks)});const a=o.find(e=>e.type.name===n.name);return a?{...a.attrs}:{}}function ZR(e){return t=>function(e,t){for(let n=e.depth;n>0;n-=1){const i=e.node(n);if(t(i))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:i}}}(t.$from,e)}function qR(e,t){const n=zR("string"==typeof t?t:t.name,e.schema);return"node"===n?function(e,t){const n=oR(t,e.schema),{from:i,to:r}=e.selection,s=[];e.doc.nodesBetween(i,r,e=>{s.push(e)});const o=s.reverse().find(e=>e.type.name===n.name);return o?{...o.attrs}:{}}(e,t):"mark"===n?$R(e,t):{}}function KR(e){const t=function(e,t=JSON.stringify){const n={};return e.filter(e=>{const i=t(e);return!Object.prototype.hasOwnProperty.call(n,i)&&(n[i]=!0)})}(e);return 1===t.length?t:t.filter((e,n)=>{const i=t.filter((e,t)=>t!==n);return!i.some(t=>e.oldRange.from>=t.oldRange.from&&e.oldRange.to<=t.oldRange.to&&e.newRange.from>=t.newRange.from&&e.newRange.to<=t.newRange.to)})}function YR(e,t,n){const i=[];return e===t?n.resolve(e).marks().forEach(t=>{const r=_R(n.resolve(e-1),t.type);r&&i.push({mark:t,...r})}):n.nodesBetween(e,t,(e,t)=>{e&&void 0!==(null==e?void 0:e.nodeSize)&&i.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),i}function XR(e,t,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{const i=e.find(e=>e.type===t&&e.name===n);return!!i&&i.attribute.keepOnSplit}))}function JR(e,t,n={}){const{empty:i,ranges:r}=e.selection,s=t?OR(t,e.schema):null;if(i)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!s||s.name===e.type.name).find(e=>AR(e.attrs,n,{strict:!1}));let o=0;const a=[];if(r.forEach(({$from:t,$to:n})=>{const i=t.pos,r=n.pos;e.doc.nodesBetween(i,r,(e,t)=>{if(!e.isText&&!e.marks.length)return;const n=Math.max(i,t),s=Math.min(r,t+e.nodeSize);o+=s-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:s})))})}),0===o)return!1;const l=a.filter(e=>!s||s.name===e.mark.type.name).filter(e=>AR(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=a.filter(e=>!s||e.mark.type!==s&&e.mark.type.excludes(s)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=o}function QR(e,t){const{nodeExtensions:n}=rR(t),i=n.find(t=>t.name===e);if(!i)return!1;const r=hR(iR(i,"group",{name:i.name,options:i.options,storage:i.storage}));return"string"==typeof r&&r.split(" ").includes("list")}function eF(e,{checkChildren:t}={checkChildren:!0}){if(e.isText)return!e.text;if(0===e.content.childCount)return!0;if(e.isLeaf)return!1;if(t){let t=!0;return e.content.forEach(e=>{!1!==t&&(eF(e)||(t=!1))}),t}return!1}function tF(e){return e instanceof zI}function nF(e,t,n){const i=e.state.doc.content.size,r=DR(t,0,i),s=DR(n,0,i),o=e.coordsAtPos(r),a=e.coordsAtPos(s,-1),l=Math.min(o.top,a.top),c=Math.max(o.bottom,a.bottom),h=Math.min(o.left,a.left),u=Math.max(o.right,a.right),d={top:l,bottom:c,left:h,right:u,width:u-h,height:c-l,x:h,y:l};return{...d,toJSON:()=>d}}function iF(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const i=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(i)}}const rF=(e,t)=>{const n=ZR(e=>e.type===t)(e.selection);if(!n)return!0;const i=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===i)return!0;const r=e.doc.nodeAt(i);return n.node.type!==(null==r?void 0:r.type)||!vI(e.doc,n.pos)||(e.join(n.pos),!0)},sF=(e,t)=>{const n=ZR(e=>e.type===t)(e.selection);if(!n)return!0;const i=e.doc.resolve(n.start).after(n.depth);if(void 0===i)return!0;const r=e.doc.nodeAt(i);return n.node.type!==(null==r?void 0:r.type)||!vI(e.doc,i)||(e.join(i),!0)};var oF=Object.freeze({__proto__:null,blur:()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),null===(n=null===window||void 0===window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())}),!0),clearContent:(e=!1)=>({commands:t})=>t.setContent("",e),clearNodes:()=>({state:e,tr:t,dispatch:n})=>{const{selection:i}=t,{ranges:r}=i;return!n||(r.forEach(({$from:n,$to:i})=>{e.doc.nodesBetween(n.pos,i.pos,(e,n)=>{if(e.type.isText)return;const{doc:i,mapping:r}=t,s=i.resolve(r.map(n)),o=i.resolve(r.map(n+e.nodeSize)),a=s.blockRange(o);if(!a)return;const l=pI(a);if(e.type.isTextblock){const{defaultType:e}=s.parent.contentMatchAt(s.index());t.setNodeMarkup(a.start,e)}(l||0===l)&&t.lift(a,l)})}),!0)},command:e=>t=>e(t),createParagraphNear:()=>({state:e,dispatch:t})=>zD(e,t),cut:(e,t)=>({editor:n,tr:i})=>{const{state:r}=n,s=r.doc.slice(e.from,e.to);i.deleteRange(e.from,e.to);const o=i.mapping.map(t);return i.insert(o,s.content),i.setSelection(new HI(i.doc.resolve(o-1))),!0},deleteCurrentNode:()=>({tr:e,dispatch:t})=>{const{selection:n}=e,i=n.$anchor.node();if(i.content.size>0)return!1;const r=e.selection.$anchor;for(let s=r.depth;s>0;s-=1){if(r.node(s).type===i.type){if(t){const t=r.before(s),n=r.after(s);e.delete(t,n).scrollIntoView()}return!0}}return!1},deleteNode:e=>({tr:t,state:n,dispatch:i})=>{const r=oR(e,n.schema),s=t.selection.$anchor;for(let e=s.depth;e>0;e-=1){if(s.node(e).type===r){if(i){const n=s.before(e),i=s.after(e);t.delete(n,i).scrollIntoView()}return!0}}return!1},deleteRange:e=>({tr:t,dispatch:n})=>{const{from:i,to:r}=e;return n&&t.delete(i,r),!0},deleteSelection:()=>({state:e,dispatch:t})=>MD(e,t),enter:()=>({commands:e})=>e.keyboardShortcut("Enter"),exitCode:()=>({state:e,dispatch:t})=>((e,t)=>{let{$head:n,$anchor:i}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(i))return!1;let r=n.node(-1),s=n.indexAfter(-1),o=UD(r.contentMatchAt(s));if(!o||!r.canReplaceWith(s,s,o))return!1;if(t){let i=n.after(),r=e.tr.replaceWith(i,i,o.createAndFill());r.setSelection(FI.near(r.doc.resolve(i),1)),t(r.scrollIntoView())}return!0})(e,t),extendMarkRange:(e,t={})=>({tr:n,state:i,dispatch:r})=>{const s=OR(e,i.schema),{doc:o,selection:a}=n,{$from:l,from:c,to:h}=a;if(r){const e=_R(l,s,t);if(e&&e.from<=c&&e.to>=h){const t=HI.create(o,e.from,e.to);n.setSelection(t)}}return!0},first:e=>t=>{const n="function"==typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1},focus:(e=null,t={})=>({editor:n,view:i,tr:r,dispatch:s})=>{t={scrollIntoView:!0,...t};const o=()=>{FR()&&i.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(i.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())})};if(i.hasFocus()&&null===e||!1===e)return!0;if(s&&null===e&&!NR(n.state.selection))return o(),!0;const a=RR(r.doc,e)||n.state.selection,l=n.state.selection.eq(a);return s&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),o()),!0},forEach:(e,t)=>n=>e.every((e,i)=>t(e,{...n,index:i})),insertContent:(e,t)=>({tr:n,commands:i})=>i.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),insertContentAt:(e,t,n)=>({tr:i,dispatch:r,editor:s})=>{var o;if(r){let r;n={parseOptions:{},updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};try{r=jR(t,s.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:null!==(o=n.errorOnInvalidContent)&&void 0!==o?o:s.options.enableContentCheck})}catch(a){return s.emit("contentError",{editor:s,error:a,disableCollaboration:()=>{console.error("[tiptap error]: Unable to disable collaboration at this point in time")}}),!1}let{from:l,to:c}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},h=!0,u=!0;if(("type"in r?[r]:r).forEach(e=>{e.check(),h=!!h&&(e.isText&&0===e.marks.length),u=!!u&&e.isBlock}),l===c&&u){const{parent:e}=i.doc.resolve(l);e.isTextblock&&!e.type.spec.code&&!e.childCount&&(l-=1,c+=1)}let d;h?(d=Array.isArray(t)?t.map(e=>e.text||"").join(""):"object"==typeof t&&t&&t.text?t.text:t,i.insertText(d,l,c)):(d=r,i.replaceWith(l,c,d)),n.updateSelection&&function(e,t,n){const i=e.steps.length-1;if(i<t)return;const r=e.steps[i];if(!(r instanceof lI||r instanceof cI))return;const s=e.mapping.maps[i];let o=0;s.forEach((e,t,n,i)=>{0===o&&(o=i)}),e.setSelection(FI.near(e.doc.resolve(o),n))}(i,i.steps.length-1,-1),n.applyInputRules&&i.setMeta("applyInputRules",{from:l,text:d}),n.applyPasteRules&&i.setMeta("applyPasteRules",{from:l,text:d})}return!0},joinBackward:()=>({state:e,dispatch:t})=>_D(e,t),joinDown:()=>({state:e,dispatch:t})=>((e,t)=>{let n,i=e.selection;if(i instanceof zI){if(i.node.isTextblock||!vI(e.doc,i.to))return!1;n=i.to}else if(n=bI(e.doc,i.to,1),null==n)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0})(e,t),joinForward:()=>({state:e,dispatch:t})=>BD(e,t),joinItemBackward:()=>({state:e,dispatch:t,tr:n})=>{try{const i=bI(e.doc,e.selection.$from.pos,-1);return null!=i&&(n.join(i,2),t&&t(n),!0)}catch(i){return!1}},joinItemForward:()=>({state:e,dispatch:t,tr:n})=>{try{const i=bI(e.doc,e.selection.$from.pos,1);return null!=i&&(n.join(i,2),t&&t(n),!0)}catch(i){return!1}},joinTextblockBackward:()=>({state:e,dispatch:t})=>((e,t,n)=>{let i=ID(e,n);if(!i)return!1;let r=RD(i);return!!r&&OD(e,r,t)})(e,t),joinTextblockForward:()=>({state:e,dispatch:t})=>((e,t,n)=>{let i=FD(e,n);if(!i)return!1;let r=jD(i);return!!r&&OD(e,r,t)})(e,t),joinUp:()=>({state:e,dispatch:t})=>((e,t)=>{let n,i=e.selection,r=i instanceof zI;if(r){if(i.node.isTextblock||!vI(e.doc,i.from))return!1;n=i.from}else if(n=bI(e.doc,i.from,-1),null==n)return!1;if(t){let i=e.tr.join(n);r&&i.setSelection(zI.create(i.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(i.scrollIntoView())}return!0})(e,t),keyboardShortcut:e=>({editor:t,view:n,tr:i,dispatch:r})=>{const s=function(e){const t=e.split(/-(?!$)/);let n,i,r,s,o=t[t.length-1];"Space"===o&&(o=" ");for(let a=0;a<t.length-1;a+=1){const e=t[a];if(/^(cmd|meta|m)$/i.test(e))s=!0;else if(/^a(lt)?$/i.test(e))n=!0;else if(/^(c|ctrl|control)$/i.test(e))i=!0;else if(/^s(hift)?$/i.test(e))r=!0;else{if(!/^mod$/i.test(e))throw new Error(`Unrecognized modifier name: ${e}`);FR()||HR()?s=!0:i=!0}}return n&&(o=`Alt-${o}`),i&&(o=`Ctrl-${o}`),s&&(o=`Meta-${o}`),r&&(o=`Shift-${o}`),o}(e).split(/-(?!$)/),o=s.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),a=new KeyboardEvent("keydown",{key:"Space"===o?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",e=>e(n,a))});return null==l||l.steps.forEach(e=>{const t=e.map(i.mapping);t&&r&&i.maybeStep(t)}),!0},lift:(e,t={})=>({state:n,dispatch:i})=>!!UR(n,oR(e,n.schema),t)&&((e,t)=>{let{$from:n,$to:i}=e.selection,r=n.blockRange(i),s=r&&pI(r);return null!=s&&(t&&t(e.tr.lift(r,s).scrollIntoView()),!0)})(n,i),liftEmptyBlock:()=>({state:e,dispatch:t})=>WD(e,t),liftListItem:e=>({state:t,dispatch:n})=>QD(oR(e,t.schema))(t,n),newlineInCode:()=>({state:e,dispatch:t})=>HD(e,t),resetAttributes:(e,t)=>({tr:n,state:i,dispatch:r})=>{let s=null,o=null;const a=zR("string"==typeof e?e:e.name,i.schema);return!!a&&("node"===a&&(s=oR(e,i.schema)),"mark"===a&&(o=OR(e,i.schema)),r&&n.selection.ranges.forEach(e=>{i.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,i)=>{s&&s===e.type&&n.setNodeMarkup(i,void 0,WR(e.attrs,t)),o&&e.marks.length&&e.marks.forEach(r=>{o===r.type&&n.addMark(i,i+e.nodeSize,o.create(WR(r.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),selectAll:()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),selectNodeBackward:()=>({state:e,dispatch:t})=>DD(e,t),selectNodeForward:()=>({state:e,dispatch:t})=>VD(e,t),selectParentNode:()=>({state:e,dispatch:t})=>((e,t)=>{let n,{$from:i,to:r}=e.selection,s=i.sharedDepth(r);return 0!=s&&(n=i.before(s),t&&t(e.tr.setSelection(zI.create(e.doc,n))),!0)})(e,t),selectTextblockEnd:()=>({state:e,dispatch:t})=>KD(e,t),selectTextblockStart:()=>({state:e,dispatch:t})=>qD(e,t),setContent:(e,t=!1,n={},i={})=>({editor:r,tr:s,dispatch:o,commands:a})=>{var l,c;const{doc:h}=s;if("full"!==n.preserveWhitespace){const a=GR(e,r.schema,n,{errorOnInvalidContent:null!==(l=i.errorOnInvalidContent)&&void 0!==l?l:r.options.enableContentCheck});return o&&s.replaceWith(0,h.content.size,a).setMeta("preventUpdate",!t),!0}return o&&s.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:h.content.size},e,{parseOptions:n,errorOnInvalidContent:null!==(c=i.errorOnInvalidContent)&&void 0!==c?c:r.options.enableContentCheck})},setMark:(e,t={})=>({tr:n,state:i,dispatch:r})=>{const{selection:s}=n,{empty:o,ranges:a}=s,l=OR(e,i.schema);if(r)if(o){const e=$R(i,l);n.addStoredMark(l.create({...e,...t}))}else a.forEach(e=>{const r=e.$from.pos,s=e.$to.pos;i.doc.nodesBetween(r,s,(e,i)=>{const o=Math.max(i,r),a=Math.min(i+e.nodeSize,s);e.marks.find(e=>e.type===l)?e.marks.forEach(e=>{l===e.type&&n.addMark(o,a,l.create({...e.attrs,...t}))}):n.addMark(o,a,l.create(t))})});return function(e,t,n){var i;const{selection:r}=t;let s=null;if(NR(r)&&(s=r.$cursor),s){const t=null!==(i=e.storedMarks)&&void 0!==i?i:s.marks();return!!n.isInSet(t)||!t.some(e=>e.type.excludes(n))}const{ranges:o}=r;return o.some(({$from:t,$to:i})=>{let r=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(t.pos,i.pos,(e,t,i)=>{if(r)return!1;if(e.isInline){const t=!i||i.type.allowsMarkType(n),s=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));r=t&&s}return!r}),r})}(i,n,l)},setMeta:(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),setNode:(e,t={})=>({state:n,dispatch:i,chain:r})=>{const s=oR(e,n.schema);return s.isTextblock?r().command(({commands:e})=>!!YD(s,t)(n)||e.clearNodes()).command(({state:e})=>YD(s,t)(e,i)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:e=>({tr:t,dispatch:n})=>{if(n){const{doc:n}=t,i=DR(e,0,n.content.size),r=zI.create(n,i);t.setSelection(r)}return!0},setTextSelection:e=>({tr:t,dispatch:n})=>{if(n){const{doc:n}=t,{from:i,to:r}="number"==typeof e?{from:e,to:e}:e,s=HI.atStart(n).from,o=HI.atEnd(n).to,a=DR(i,s,o),l=DR(r,s,o),c=HI.create(n,a,l);t.setSelection(c)}return!0},sinkListItem:e=>({state:t,dispatch:n})=>{const i=oR(e,t.schema);return(r=i,function(e,t){let{$from:n,$to:i}=e.selection,s=n.blockRange(i,e=>e.childCount>0&&e.firstChild.type==r);if(!s)return!1;let o=s.startIndex;if(0==o)return!1;let a=s.parent,l=a.child(o-1);if(l.type!=r)return!1;if(t){let n=l.lastChild&&l.lastChild.type==a.type,i=HA.from(n?r.create():null),o=new ZA(HA.from(r.create(null,HA.from(a.type.create(null,i)))),n?3:1,0),c=s.start,h=s.end;t(e.tr.step(new cI(c-(n?3:1),h,c,h,o,1,!0)).scrollIntoView())}return!0})(t,n);var r},splitBlock:({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:i,editor:r})=>{const{selection:s,doc:o}=t,{$from:a,$to:l}=s,c=XR(r.extensionManager.attributes,a.node().type.name,a.node().attrs);if(s instanceof zI&&s.node.isBlock)return!(!a.parentOffset||!gI(o,a.pos))&&(i&&(e&&iF(n,r.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const h=l.parentOffset===l.parent.content.size,u=0===a.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1)));let d=h&&u?[{type:u,attrs:c}]:void 0,p=gI(t.doc,t.mapping.map(a.pos),1,d);if(d||p||!gI(t.doc,t.mapping.map(a.pos),1,u?[{type:u}]:void 0)||(p=!0,d=u?[{type:u,attrs:c}]:void 0),i){if(p&&(s instanceof HI&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,d),u&&!h&&!a.parentOffset&&a.parent.type!==u)){const e=t.mapping.map(a.before()),n=t.doc.resolve(e);a.node(-1).canReplaceWith(n.index(),n.index()+1,u)&&t.setNodeMarkup(t.mapping.map(a.before()),u)}e&&iF(n,r.extensionManager.splittableMarks),t.scrollIntoView()}return p},splitListItem:e=>({tr:t,state:n,dispatch:i,editor:r})=>{var s;const o=oR(e,n.schema),{$from:a,$to:l}=n.selection,c=n.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const h=a.node(-1);if(h.type!==o)return!1;const u=r.extensionManager.attributes;if(0===a.parent.content.size&&a.node(-1).childCount===a.indexAfter(-1)){if(2===a.depth||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(i){let e=HA.empty;const n=a.index(-1)?1:a.index(-2)?2:3;for(let t=a.depth-n;t>=a.depth-3;t-=1)e=HA.from(a.node(t).copy(e));const i=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,r=XR(u,a.node().type.name,a.node().attrs),l=(null===(s=o.contentMatch.defaultType)||void 0===s?void 0:s.createAndFill(r))||void 0;e=e.append(HA.from(o.createAndFill(null,l)||void 0));const c=a.before(a.depth-(n-1));t.replace(c,a.after(-i),new ZA(e,4-n,0));let h=-1;t.doc.nodesBetween(c,t.doc.content.size,(e,t)=>{if(h>-1)return!1;e.isTextblock&&0===e.content.size&&(h=t+1)}),h>-1&&t.setSelection(HI.near(t.doc.resolve(h))),t.scrollIntoView()}return!0}const d=l.pos===a.end()?h.contentMatchAt(0).defaultType:null,p=XR(u,h.type.name,h.attrs),f=XR(u,a.node().type.name,a.node().attrs);t.delete(a.pos,l.pos);const m=d?[{type:o,attrs:p},{type:d,attrs:f}]:[{type:o,attrs:p}];if(!gI(t.doc,a.pos,2))return!1;if(i){const{selection:e,storedMarks:s}=n,{splittableMarks:o}=r.extensionManager,l=s||e.$to.parentOffset&&e.$from.marks();if(t.split(a.pos,2,m).scrollIntoView(),!l||!i)return!0;const c=l.filter(e=>o.includes(e.type.name));t.ensureMarks(c)}return!0},toggleList:(e,t,n,i={})=>({editor:r,tr:s,state:o,dispatch:a,chain:l,commands:c,can:h})=>{const{extensions:u,splittableMarks:d}=r.extensionManager,p=oR(e,o.schema),f=oR(t,o.schema),{selection:m,storedMarks:g}=o,{$from:v,$to:y}=m,b=v.blockRange(y),w=g||m.$to.parentOffset&&m.$from.marks();if(!b)return!1;const x=ZR(e=>QR(e.type.name,u))(m);if(b.depth>=1&&x&&b.depth-x.depth<=1){if(x.node.type===p)return c.liftListItem(f);if(QR(x.node.type.name,u)&&p.validContent(x.node.content)&&a)return l().command(()=>(s.setNodeMarkup(x.pos,p),!0)).command(()=>rF(s,p)).command(()=>sF(s,p)).run()}return n&&w&&a?l().command(()=>{const e=h().wrapInList(p,i),t=w.filter(e=>d.includes(e.type.name));return s.ensureMarks(t),!!e||c.clearNodes()}).wrapInList(p,i).command(()=>rF(s,p)).command(()=>sF(s,p)).run():l().command(()=>!!h().wrapInList(p,i)||c.clearNodes()).wrapInList(p,i).command(()=>rF(s,p)).command(()=>sF(s,p)).run()},toggleMark:(e,t={},n={})=>({state:i,commands:r})=>{const{extendEmptyMarkRange:s=!1}=n,o=OR(e,i.schema);return JR(i,o,t)?r.unsetMark(o,{extendEmptyMarkRange:s}):r.setMark(o,t)},toggleNode:(e,t,n={})=>({state:i,commands:r})=>{const s=oR(e,i.schema),o=oR(t,i.schema);return UR(i,s,n)?r.setNode(o):r.setNode(s,n)},toggleWrap:(e,t={})=>({state:n,commands:i})=>{const r=oR(e,n.schema);return UR(n,r,t)?i.lift(r):i.wrapIn(r,t)},undoInputRule:()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let i=0;i<n.length;i+=1){const r=n[i];let s;if(r.spec.isInputRules&&(s=r.getState(e))){if(t){const t=e.tr,n=s.transform;for(let e=n.steps.length-1;e>=0;e-=1)t.step(n.steps[e].invert(n.docs[e]));if(s.text){const n=t.doc.resolve(s.from).marks();t.replaceWith(s.from,s.to,e.schema.text(s.text,n))}else t.delete(s.from,s.to)}return!0}}return!1},unsetAllMarks:()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:i,ranges:r}=n;return i||t&&r.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0},unsetMark:(e,t={})=>({tr:n,state:i,dispatch:r})=>{var s;const{extendEmptyMarkRange:o=!1}=t,{selection:a}=n,l=OR(e,i.schema),{$from:c,empty:h,ranges:u}=a;if(!r)return!0;if(h&&o){let{from:e,to:t}=a;const i=null===(s=c.marks().find(e=>e.type===l))||void 0===s?void 0:s.attrs,r=_R(c,l,i);r&&(e=r.from,t=r.to),n.removeMark(e,t,l)}else u.forEach(e=>{n.removeMark(e.$from.pos,e.$to.pos,l)});return n.removeStoredMark(l),!0},updateAttributes:(e,t={})=>({tr:n,state:i,dispatch:r})=>{let s=null,o=null;const a=zR("string"==typeof e?e:e.name,i.schema);return!!a&&("node"===a&&(s=oR(e,i.schema)),"mark"===a&&(o=OR(e,i.schema)),r&&n.selection.ranges.forEach(e=>{const r=e.$from.pos,a=e.$to.pos;i.doc.nodesBetween(r,a,(e,i)=>{s&&s===e.type&&n.setNodeMarkup(i,void 0,{...e.attrs,...t}),o&&e.marks.length&&e.marks.forEach(s=>{if(o===s.type){const l=Math.max(i,r),c=Math.min(i+e.nodeSize,a);n.addMark(l,c,o.create({...s.attrs,...t}))}})})}),!0)},wrapIn:(e,t={})=>({state:n,dispatch:i})=>function(e,t=null){return function(n,i){let{$from:r,$to:s}=n.selection,o=r.blockRange(s),a=o&&fI(o,e,t);return!!a&&(i&&i(n.tr.wrap(o,a).scrollIntoView()),!0)}}(oR(e,n.schema),t)(n,i),wrapInList:(e,t={})=>({state:n,dispatch:i})=>JD(oR(e,n.schema),t)(n,i)});const aF=LR.create({name:"commands",addCommands:()=>({...oF})}),lF=LR.create({name:"editable",addProseMirrorPlugins(){return[new n_({key:new s_("editable"),props:{editable:()=>this.editor.options.editable}})]}}),cF=LR.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new n_({key:new s_("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const i=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(i),!1},blur:(t,n)=>{e.isFocused=!1;const i=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(i),!1}}}})]}}),hF=LR.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.command(({tr:t})=>{const{selection:n,doc:i}=t,{empty:r,$anchor:s}=n,{pos:o,parent:a}=s,l=s.parent.isTextblock&&o>0?t.doc.resolve(o-1):s,c=l.parent.type.spec.isolating,h=s.pos-s.parentOffset,u=c&&1===l.parent.childCount?h===s.pos:FI.atStart(i).from===o;return!(!r||!a.type.isTextblock||a.textContent.length||!u||u&&"paragraph"===s.parent.type.name)&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},r={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return FR()||HR()?r:i},addProseMirrorPlugins(){return[new n_({key:new s_("clearDocument"),appendTransaction:(e,t,n)=>{if(!(e.some(e=>e.docChanged)&&!t.doc.eq(n.doc)))return;const{empty:i,from:r,to:s}=t.selection,o=FI.atStart(t.doc).from,a=FI.atEnd(t.doc).to;if(i||!(r===o&&s===a))return;if(!(0===n.doc.textBetween(0,n.doc.content.size," "," ").length))return;const l=n.tr,c=eR({state:n,transaction:l}),{commands:h}=new tR({editor:this.editor,state:c});return h.clearNodes(),l.steps.length?l:void 0}})]}}),uF=LR.create({name:"tabindex",addProseMirrorPlugins(){return[new n_({key:new s_("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class dF{get name(){return this.node.type.name}constructor(e,t,n=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!==(e=this.actualDepth)&&void 0!==e?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new dF(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new dF(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new dF(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,n)=>{const i=t.isBlock&&!t.isTextblock,r=this.pos+n+1,s=this.resolvedPos.doc.resolve(r);if(!i&&s.depth<=this.depth)return;const o=new dF(s,this.editor,i,i?t:null);i&&(o.actualDepth=this.depth+1),e.push(new dF(s,this.editor,i,i?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,i=this.parent;for(;i&&!n;){if(i.node.type.name===e)if(Object.keys(t).length>0){const e=i.node.attrs,n=Object.keys(t);for(let i=0;i<n.length;i+=1){const r=n[i];if(e[r]!==t[r])break}}else n=i;i=i.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let i=[];if(!this.children||0===this.children.length)return i;const r=Object.keys(t);return this.children.forEach(s=>{if(!(n&&i.length>0)){if(s.node.type.name===e){r.every(e=>t[e]===s.node.attrs[e])&&i.push(s)}n&&i.length>0||(i=i.concat(s.querySelectorAll(e,t,n)))}}),i}setAttribute(e){const t=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,e).setTextSelection(t.from).run()}}class pF extends nR{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:e})=>{throw e}},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t){const n=document.querySelector("style[data-tiptap-style]");if(null!==n)return n;const i=document.createElement("style");return t&&i.setAttribute("nonce",t),i.setAttribute("data-tiptap-style",""),i.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(i),i}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const n=cR(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:n});this.view.updateState(i)}unregisterPlugin(e){if(this.isDestroyed)return;const t="string"==typeof e?`${e}$`:e.key,n=this.state.reconfigure({plugins:this.state.plugins.filter(e=>!e.key.startsWith(t))});this.view.updateState(n)}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[lF,TR.configure({blockSeparator:null===(t=null===(e=this.options.coreExtensionOptions)||void 0===e?void 0:e.clipboardTextSerializer)||void 0===t?void 0:t.blockSeparator}),aF,cF,hF,uF]:[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new CR(n,this)}createCommandManager(){this.commandManager=new tR({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){let e;try{e=GR(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(i){if(!(i instanceof Error&&["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(i.message)))throw i;this.emit("contentError",{editor:this,error:i,disableCollaboration:()=>{this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),e=GR(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const t=RR(e,this.options.autofocus);this.view=new fD(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:e_.create({doc:e,selection:t||void 0})});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.createNodeViews(),this.prependClass();this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach(e=>{var t;return null===(t=this.capturedTransaction)||void 0===t?void 0:t.step(e)}):void(this.capturedTransaction=e);const t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),r=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),r&&this.emit("blur",{editor:this,event:r.event,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return qR(this.state,e)}isActive(e,t){const n="string"==typeof e?e:null,i="string"==typeof e?t:e;return function(e,t,n={}){if(!t)return UR(e,null,n)||JR(e,null,n);const i=zR(t,e.schema);return"node"===i?UR(e,t,n):"mark"===i&&JR(e,t,n)}(this.state,n,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return function(e,t){const n=UM.fromSchema(t).serializeFragment(e),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return function(e,t){return ER(e,{from:0,to:e.content.size},t)}(this.state.doc,{blockSeparator:t,textSerializers:{...PR(this.schema),...n}})}get isEmpty(){return eF(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(null===(e=this.view)||void 0===e?void 0:e.docView)}$node(e,t){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new dF(t,this)}get $doc(){return this.$pos(0)}}function fF(e){return new gR({find:e.find,handler:({state:t,range:n,match:i})=>{const r=hR(e.getAttributes,void 0,i);if(!1===r||null===r)return null;const{tr:s}=t,o=i[i.length-1],a=i[0];if(o){const i=a.search(/\S/),l=n.from+a.indexOf(o),c=l+o.length;if(YR(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>l).length)return null;c<n.to&&s.delete(c,n.to),l>n.from&&s.delete(n.from+i,l);const h=n.from+i+o.length;s.addMark(n.from+i,h,e.type.create(r||{})),s.removeStoredMark(e.type)}}})}function mF(e){return new gR({find:e.find,handler:({state:t,range:n,match:i})=>{const r=hR(e.getAttributes,void 0,i)||{},{tr:s}=t,o=n.from;let a=n.to;const l=e.type.create(r);if(i[1]){let e=o+i[0].lastIndexOf(i[1]);e>a?e=a:a=e+i[1].length;const t=i[0][i[0].length-1];s.insertText(t,o+i[0].length-1),s.replaceWith(e,a,l)}else if(i[0]){const t=e.type.isInline?o:o-1;s.insert(t,e.type.create(r)).delete(s.mapping.map(o),s.mapping.map(a))}s.scrollIntoView()}})}function gF(e){return new gR({find:e.find,handler:({state:t,range:n,match:i})=>{const r=t.doc.resolve(n.from),s=hR(e.getAttributes,void 0,i)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,s)}})}function vF(e){return new gR({find:e.find,handler:({state:t,range:n,match:i,chain:r})=>{const s=hR(e.getAttributes,void 0,i)||{},o=t.tr.delete(n.from,n.to),a=o.doc.resolve(n.from).blockRange(),l=a&&fI(a,e.type,s);if(!l)return null;if(o.wrap(a,l),e.keepMarks&&e.editor){const{selection:n,storedMarks:i}=t,{splittableMarks:r}=e.editor.extensionManager,s=i||n.$to.parentOffset&&n.$from.marks();if(s){const e=s.filter(e=>r.includes(e.type.name));o.ensureMarks(e)}}if(e.keepAttributes){const t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";r().updateAttributes(t,s).run()}const c=o.doc.resolve(n.from-1).nodeBefore;c&&c.type===e.type&&vI(o.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(i,c))&&o.join(n.from-1)}})}class yF{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=hR(iR(this,"addOptions",{name:this.name}))),this.storage=hR(iR(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new yF(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>kR(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new yF(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=hR(iR(t,"addOptions",{name:t.name})),t.storage=hR(iR(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:n}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const r=i.marks();if(!!!r.find(e=>(null==e?void 0:e.type.name)===t.name))return!1;const s=r.find(e=>(null==e?void 0:e.type.name)===t.name);return s&&n.removeStoredMark(s),n.insertText(" ",i.pos),e.view.dispatch(n),!0}return!1}}let bF=class e{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=hR(iR(this,"addOptions",{name:this.name}))),this.storage=hR(iR(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new e(t)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>kR(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(t={}){const n=new e(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=hR(iR(n,"addOptions",{name:n.name})),n.storage=hR(iR(n,"addStorage",{name:n.name,options:n.options})),n}};function wF(e){return new bR({find:e.find,handler:({state:t,range:n,match:i,pasteEvent:r})=>{const s=hR(e.getAttributes,void 0,i,r);if(!1===s||null===s)return null;const{tr:o}=t,a=i[i.length-1],l=i[0];let c=n.to;if(a){const i=l.search(/\S/),r=n.from+l.indexOf(a),h=r+a.length;if(YR(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>r).length)return null;h<n.to&&o.delete(h,n.to),r>n.from&&o.delete(n.from+i,r),c=n.from+i+a.length,o.addMark(n.from+i,c,e.type.create(s||{})),o.removeStoredMark(e.type)}}})}function xF(e={}){return new n_({view:t=>new CF(t,e)})}class CF{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=t.width)&&void 0!==n?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent;if(n){let n=t.nodeBefore,i=t.nodeAfter;if(n||i){let t=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(t){let r=t.getBoundingClientRect(),s=n?r.bottom:r.top;n&&i&&(s=(s+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),e={left:r.left,right:r.right,top:s-this.width/2,bottom:s+this.width/2}}}}if(!e){let t=this.editorView.coordsAtPos(this.cursorPos);e={left:t.left-this.width/2,right:t.left+this.width/2,top:t.top,bottom:t.bottom}}let i,r,s=this.editorView.dom.offsetParent;if(this.element||(this.element=s.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!s||s==document.body&&"static"==getComputedStyle(s).position)i=-pageXOffset,r=-pageYOffset;else{let e=s.getBoundingClientRect();i=e.left-s.scrollLeft,r=e.top-s.scrollTop}this.element.style.left=e.left-i+"px",this.element.style.top=e.top-r+"px",this.element.style.width=e.right-e.left+"px",this.element.style.height=e.bottom-e.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=n&&n.type.spec.disableDropCursor,r="function"==typeof i?i(this.editorView,t,e):i;if(t&&!r){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=wI(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){e.target!=this.editorView.dom&&this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const SF=LR.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[xF(this.options)]}});var kF=200,LF=function(){};LF.prototype.append=function(e){return e.length?(e=LF.from(e),!this.length&&e||e.length<kF&&this.leafAppend(e)||this.length<kF&&e.leafPrepend(this)||this.appendInner(e)):this},LF.prototype.prepend=function(e){return e.length?LF.from(e).append(this):this},LF.prototype.appendInner=function(e){return new PF(this,e)},LF.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?LF.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},LF.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},LF.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},LF.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var i=[];return this.forEach(function(t,n){return i.push(e(t,n))},t,n),i},LF.from=function(e){return e instanceof LF?e:e&&e.length?new EF(e):LF.empty};var EF=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,i){for(var r=t;r<n;r++)if(!1===e(this.values[r],i+r))return!1},t.prototype.forEachInvertedInner=function(e,t,n,i){for(var r=t-1;r>=n;r--)if(!1===e(this.values[r],i+r))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=kF)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=kF)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(LF);LF.empty=new EF([]);var PF=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,i){var r=this.left.length;return!(t<r&&!1===this.left.forEachInner(e,t,Math.min(n,r),i))&&(!(n>r&&!1===this.right.forEachInner(e,Math.max(t-r,0),Math.min(this.length,n)-r,i+r))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,i){var r=this.left.length;return!(t>r&&!1===this.right.forEachInvertedInner(e,t-r,Math.max(n,r)-r,i+r))&&(!(n<r&&!1===this.left.forEachInvertedInner(e,Math.min(t,r),n,i))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(LF);class TF{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let n,i,r=this.items.length;for(;;r--){if(this.items.get(r-1).selection){--r;break}}t&&(n=this.remapping(r,this.items.length),i=n.maps.length);let s,o,a=e.tr,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step)return n||(n=this.remapping(r,t+1),i=n.maps.length),i--,void c.push(e);if(n){c.push(new AF(e.map));let t,r=e.step.map(n.slice(i));r&&a.maybeStep(r).doc&&(t=a.mapping.maps[a.mapping.maps.length-1],l.push(new AF(t,void 0,void 0,l.length+c.length))),i--,t&&n.appendMap(t,i)}else a.maybeStep(e.step);return e.selection?(s=n?e.selection.map(n.slice(i)):e.selection,o=new TF(this.items.slice(0,r).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:o,transform:a,selection:s}}addTransform(e,t,n,i){let r=[],s=this.eventCount,o=this.items,a=!i&&o.length?o.get(o.length-1):null;for(let c=0;c<e.steps.length;c++){let n,l=e.steps[c].invert(e.docs[c]),h=new AF(e.mapping.maps[c],l,t);(n=a&&a.merge(h))&&(h=n,c?r.pop():o=o.slice(0,o.length-1)),r.push(h),t&&(s++,t=void 0),i||(a=h)}let l=s-n.depth;return l>IF&&(o=function(e,t){let n;return e.forEach((e,i)=>{if(e.selection&&0==t--)return n=i,!1}),e.slice(n)}(o,l),s-=l),new TF(o.append(r),s)}remapping(e,t){let n=new QM;return this.items.forEach((t,i)=>{let r=null!=t.mirrorOffset&&i-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,r)},e,t),n}addMaps(e){return 0==this.eventCount?this:new TF(this.items.append(e.map(e=>new AF(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-t),r=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach(e=>{e.selection&&o--},i);let a=t;this.items.forEach(t=>{let i=r.getMirror(--a);if(null==i)return;s=Math.min(s,i);let l=r.maps[i];if(t.step){let s=e.steps[i].invert(e.docs[i]),c=t.selection&&t.selection.map(r.slice(a+1,i));c&&o++,n.push(new AF(l,s,c))}else n.push(new AF(l))},i);let l=[];for(let u=t;u<s;u++)l.push(new AF(r.maps[u]));let c=this.items.slice(0,i).append(l).append(n),h=new TF(c,o);return h.emptyItemCount()>500&&(h=h.compress(this.items.length-n.length)),h}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,i=[],r=0;return this.items.forEach((s,o)=>{if(o>=e)i.push(s),s.selection&&r++;else if(s.step){let e=s.step.map(t.slice(n)),o=e&&e.getMap();if(n--,o&&t.appendMap(o,n),e){let a=s.selection&&s.selection.map(t.slice(n));a&&r++;let l,c=new AF(o.invert(),e,a),h=i.length-1;(l=i.length&&i[h].merge(c))?i[h]=l:i.push(c)}}else s.map&&n--},this.items.length,0),new TF(LF.from(i.reverse()),r)}}TF.empty=new TF(LF.empty,0);class AF{constructor(e,t,n,i){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new AF(t.getMap().invert(),t,this.selection)}}}class MF{constructor(e,t,n,i,r){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=i,this.prevComposition=r}}const IF=20;function _F(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,i,r)=>t.push(i,r));return t}function OF(e,t){if(!e)return null;let n=[];for(let i=0;i<e.length;i+=2){let r=t.map(e[i],1),s=t.map(e[i+1],-1);r<=s&&n.push(r,s)}return n}let NF=!1,DF=null;function RF(e){let t=e.plugins;if(DF!=t){NF=!1,DF=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){NF=!0;break}}return NF}const FF=new s_("history"),BF=new s_("closeHistory");function VF(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new n_({key:FF,state:{init:()=>new MF(TF.empty,TF.empty,null,0,-1),apply:(t,n,i)=>function(e,t,n,i){let r,s=n.getMeta(FF);if(s)return s.historyState;n.getMeta(BF)&&(e=new MF(e.done,e.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(o&&o.getMeta(FF))return o.getMeta(FF).redo?new MF(e.done.addTransform(n,void 0,i,RF(t)),e.undone,_F(n.mapping.maps),e.prevTime,e.prevComposition):new MF(e.done,e.undone.addTransform(n,void 0,i,RF(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||o&&!1===o.getMeta("addToHistory"))return(r=n.getMeta("rebased"))?new MF(e.done.rebased(n,r),e.undone.rebased(n,r),OF(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new MF(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),OF(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let r=n.getMeta("composition"),s=0==e.prevTime||!o&&e.prevComposition!=r&&(e.prevTime<(n.time||0)-i.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,i)=>{for(let r=0;r<t.length;r+=2)e<=t[r+1]&&i>=t[r]&&(n=!0)}),n}(n,e.prevRanges)),a=o?OF(e.prevRanges,n.mapping):_F(n.mapping.maps);return new MF(e.done.addTransform(n,s?t.selection.getBookmark():void 0,i,RF(t)),TF.empty,a,n.time,null==r?e.prevComposition:r)}}(n,i,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,i="historyUndo"==n?HF:"historyRedo"==n?UF:null;return!!i&&(t.preventDefault(),i(e.state,e.dispatch))}}}})}function jF(e,t){return(n,i)=>{let r=FF.getState(n);if(!r||0==(e?r.undone:r.done).eventCount)return!1;if(i){let s=function(e,t,n){let i=RF(t),r=FF.get(t).spec.config,s=(n?e.undone:e.done).popEvent(t,i);if(!s)return null;let o=s.selection.resolve(s.transform.doc),a=(n?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),r,i),l=new MF(n?a:s.remaining,n?s.remaining:a,null,0,-1);return s.transform.setSelection(o).setMeta(FF,{redo:n,historyState:l})}(r,n,e);s&&i(t?s.scrollIntoView():s)}return!0}}const HF=jF(!1,!0),UF=jF(!0,!0),zF=LR.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>HF(e,t),redo:()=>({state:e,dispatch:t})=>UF(e,t)}),addProseMirrorPlugins(){return[VF(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),WF=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,GF=bF.create({name:"image",addOptions:()=>({inline:!1,allowBase64:!1,HTMLAttributes:{}}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",aR(this.options.HTMLAttributes,e)]},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[mF({find:WF,type:this.type,getAttributes:e=>{const[,,t,n,i]=e;return{src:n,alt:t,title:i}}})]}}),$F=bF.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",aR(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),ZF=bF.create({name:"text",group:"inline"}),qF=e=>{let t=e,n=e.attrs.query??"";const i=e=>{const n=e.target,{selectionStart:i,selectionEnd:r,value:s}=n;if(("ArrowDown"===e.code||"Enter"===e.code)&&i===s.length&&r===s.length){const{primaryGroupKey:n}=t.attrs;lB(e,uo(t).querySelector(`.select-list[data-key="${n}"]`))}},r=e=>{const i=e.target;n=i.value,t.attrs.onQuery(n)},s=()=>{const e=uo(t).querySelector(".query");document.activeElement!==e&&(e.focus(),e.select())},o=e=>{/^[a-z0-9]$/i.test(e.key)&&(e.metaKey||e.ctrlKey||e.altKey||s())};return{oncreate(){s()},view(e){t=e;const{groups:s,headerExtra:a,layoutKey:l}=t.attrs;return Oe(".select-list-group-with-query",{onkeydown:o,"data-layout-key":l},[Oe(".select-list-group-with-query-header",Oe("label.query-label",{"aria-label":"Search"},[Oe(Jo,{icon:"search"}),Oe("input.query",{type:"text",oninput:r,onkeydown:i,value:n})]),a&&a()),Oe(KF,{groups:s})])}}},KF={view({attrs:{groups:e}}){const t=e=>{var t,n;const{code:i}=e,r=e.target;let s;"ArrowLeft"===i&&(s=null==(t=r.parentElement)?void 0:t.previousElementSibling),"ArrowRight"===i&&(s=null==(n=r.parentElement)?void 0:n.nextElementSibling),lB(e,s)};return Oe(".select-list-group",[e.map(e=>"function"==typeof e?e():Oe(oB,{onKeyArrowList:t,...e}))])}},YF=(e,t)=>Math.abs(e.top-t.top)<10,XF=(e,t)=>Math.abs(e.left-t.left)<t.width/2,JF=(e,t)=>e.right<=t.left&&YF(e,t),QF=(e,t)=>e.left>=t.right&&YF(e,t),eB=(e,t)=>e.bottom<=t.top&&XF(e,t),tB=(e,t)=>e.top>=t.bottom&&XF(e,t),nB=(e,t)=>t.left-e.right,iB=(e,t)=>e.left-t.right,rB=(e,t)=>t.top-e.bottom,sB=(e,t)=>e.top-t.bottom,oB={view({attrs:{key:e,className:t,items:n,value:i,onSelect:r,onKeyArrowList:s}}){const o=e=>{const{code:t}=e;if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t))return;const n=e.target,i=n.getBoundingClientRect(),r=n.closest(".select-list");if(!r)return;const s=Array.from(r.querySelectorAll('.item[data-index]:not([data-index="-1"])'));let o,a=1/0;for(const l of s){if(l===n)continue;const e=l.getBoundingClientRect();if("ArrowLeft"===t&&JF(e,i)){const t=nB(e,i);t<a&&(o=l,a=t)}else if("ArrowRight"===t&&QF(e,i)){const t=iB(e,i);t<a&&(o=l,a=t)}else if("ArrowUp"===t&&eB(e,i)){const t=rB(e,i);t<a&&(o=l,a=t)}else{if("ArrowDown"!==t||!tB(e,i))continue;{const t=sB(e,i);t<a&&(o=l,a=t)}}}o&&(e.preventDefault(),e.stopPropagation(),o.focus(),o.click())},a=n.map((e,t)=>{var n;if(ks(e)||"option"===e.type){let s,a,l;return ks(e)?(s=e,l=Oe(".label",e)):(s=e.value,a=e.className,l=(null==(n=e.render)?void 0:n.call(e))??Oe(".label",e.label)),Oe(aB,{value:s,index:t,selected:s===i,onSelect:()=>r(s),onKeyArrowItem:o,className:a},l)}return"header"===e.type?Oe(".header",e.label):"status"===e.type?Oe(".status",e.message):"custom"===e.type?Oe(".custom",e.render()):void 0});return Oe(".select-list.scrollable",{role:"listbox",className:t,"data-key":e,tabIndex:-1,"aria-activedescendant":i,onkeydown:s},a)}},aB={view:({attrs:{value:e,index:t,selected:n,onSelect:i,onKeyArrowItem:r,className:s},children:o})=>Oe(".item",{"data-value":e,"data-index":t,className:s,role:"option","aria-selected":String(n),tabIndex:n?0:-1,onclick:i,onkeydown:r},o),oncreate({attrs:{selected:e},dom:t}){e&&(e=>{const t=e.getBoundingClientRect(),n=e.closest(".scrollable");if(null!==n){const e=n.getBoundingClientRect(),i=t.bottom-e.top-e.height;if(i>0)return void(n.scrollTop+=i);const r=t.top-e.top;r<0&&(n.scrollTop+=r)}})(t)}};function lB(e,t){if(!t)return;console.trace();const n=t.querySelector(".item[aria-selected='true'][data-index]:not([data-index='-1'])");if(n)return e.preventDefault(),e.stopPropagation(),void n.focus();const i=t.querySelector(".item[data-index]:not([data-index='-1'])");return i?(e.preventDefault(),e.stopPropagation(),i.focus(),void i.click()):void 0}const cB={view:()=>Oe("input[type=text]",{spellcheck:!1}),oncreate(e){const t=uo(e);Ps(t instanceof HTMLInputElement);const{value:n,initialSelection:i}=e.attrs;if(t.value=n,t.addEventListener("blur",()=>{e.attrs.onchange(t.value),Oe.redraw()}),t.addEventListener("keydown",e=>{"Enter"!==e.code&&"NumpadEnter"!==e.code||(e.preventDefault(),t.blur())}),i){const e="all"===i?{start:0,end:n.length}:i;t.focus(),t.setSelectionRange(e.start,e.end)}},onupdate(e){const t=uo(e);Ps(t instanceof HTMLInputElement),t!==document.activeElement&&(t.value=e.attrs.value)}},hB=()=>{let e=!1;return{view:({attrs:{onSuccess:t,onFail:n}})=>Oe(".font-uploader",Oe(Zo,{message:()=>["Upload an SVG file from your computer to add it to the icon picker.",Oe("br"),"SVGs should be square, black with no background."],placement:"bottom"},Oe("button.secondary",{onclick:async function(){const i=await NT({accept:".svg",multiple:!0});if(i&&i.length>0){e=!0,Oe.redraw();try{const e=await uB(Array.from(i));e.length>0&&t(e[0])}catch(r){n(r)}e=!1,Oe.redraw()}},disabled:e},e?"Uploading":"Add Icon")))}},uB=async e=>{const t=[],n=[];for(const i of e){jT.showBasic({type:"info",message:["Uploading icon ",Oe("strong",i.name),""]});const e=await Qk.importCustomIcon(i);t.push(i.name),n.push(e)}return jT.showBasic({type:"info",message:[`Uploaded ${t.length} ${1===t.length?"icon":"icons"}: `,$T(t),"."]}),n},dB="All",pB="Recommended",fB="My Icons",mB="Cuttle Icons",gB="Emoji",vB="Noun Project",yB=[dB,pB,fB,mB,gB,vB],bB=" from Noun Project";class wB{constructor(){this.name=vB,this.isVisible=!0}performQuery(e){Oj.business.canSearchNounProject()&&ic.setQuery(e)}getResultsAsSelectListItems(){if(!Oj.business.canSearchNounProject())return[{type:"custom",render:()=>Oe(_B.ProListPreview,[Oe("button",{onclick:()=>TB("noun-project")},"Join Cuttle Pro"),Oe("strong","Access 1,000,000+ more icons!")])}];if("unsearched"===ic.status)return[{type:"status",message:" Type a search term"}];if("searching"===ic.status)return[{type:"custom",render:()=>Oe(_B.NounProjectLoading,[Oe(".loading-indicator"),"Searching"])}];if("error"===ic.status){return[{type:"status",message:ic.error??"Noun Project search failed, please try again."}]}return ic.results.map(e=>{const{attribution:t,id:n,thumbnail_url:i}=e,r=(e=>e.endsWith(bB)?e.slice(0,-18):e)(t);return{type:"option",label:r,value:tc+n,category:vB,className:"shape-tile",render:()=>Oe(MB,{url:i,label:r})}})}}class xB{constructor(){this.name=gB,this.isVisible=!0,this.results=[]}performQuery(e){this.results=tC.search(e)}getResultsAsSelectListItems(){return this.results.map(e=>{const{name:t,unified:n,unicode:i}=e,r=`${ur}/noto-emoji-600/${n}.svg`;return{type:"option",label:t,value:r,category:gB,className:"shape-tile",render:()=>Oe(MB,{url:r,label:t})}})}}class CB{constructor(){this.name=mB,this.isVisible=!0,this.results=[],this.cuttleShapes=Xx.map(e=>{const t=`${ur}${e.path}.svg`;return{type:"option",label:e.name,value:t,className:"shape-tile",keywords:e.name.toLocaleLowerCase()+(e.keywords?" "+e.keywords.join(" "):""),render:()=>Oe(MB,{url:t,label:e.name})}})}performQuery(e){const t=e.toLowerCase();if(""===t)this.results=this.cuttleShapes;else{const e=t.split(" ").filter(e=>e.length>0);this.results=this.cuttleShapes.filter(t=>e.some(e=>{var n;return null==(n=t.keywords)?void 0:n.includes(e)}))}}getResultsAsSelectListItems(){return this.results}}class SB{constructor(){this.name=pB,this.recommendedValues=[],this.recommendedShapes=[],this.results=[],this.isVisible=!0}setValues(e){this.recommendedValues=e,this.recommendedShapes=e.map(e=>({type:"option",label:"",value:PB(e),className:"shape-tile",keywords:"",render:()=>Oe(MB,{url:e})})),this.isVisible=this.recommendedValues.length>0,this.results=this.recommendedShapes}getExternalValue(e){return this.recommendedValues.find(t=>t.startsWith(e))}performQuery(e){this.results=""===e?this.recommendedShapes:[]}getResultsAsSelectListItems(){return this.results}}class kB{constructor(){this.name=fB,this.isVisible=!0,this.myIconsShapes=[],this.results=[],Qk.subscribe(()=>{this.onIconsUpdated()})}onIconsUpdated(){this.myIconsShapes=Qk.getIcons().map(e=>({type:"option",label:e.name,value:e.url,keywords:e.name,className:"shape-tile",render:()=>Oe(MB,{url:e.url,label:e.name,extraMenuItems:()=>[{label:`Rename ${e.name}`,action:()=>{let t=e.name;ia.open({modalView:()=>Oe(gL,{primaryAction:{label:"Rename Icon",action:async()=>{await Qk.renameCustomIcon(e.hash,t)}}},Oe(".editor-form",[Oe(cB,{value:t,onchange:e=>t=e,initialSelection:"all"})]))})}},{label:`Remove ${e.name}`,action:()=>{ia.open({modalView:()=>Oe(gL,{primaryAction:{label:"Remove Icon",action:async()=>{await Qk.removeCustomIcon(e.hash)}}},Oe(".editor-form",`Are you sure you want to remove ${e.name}?`))})}}]})})),this.performQuery(EB.query),Oe.redraw()}performQuery(e){this.results=""===e?this.myIconsShapes:this.myIconsShapes.filter(t=>t.keywords.toLowerCase().includes(e.toLowerCase()))}getResultsAsSelectListItems(){return Oj.business.canUploadImages()?0===Qk.getIcons().length&&EB.category===fB?[{type:"custom",render:()=>Oe(_B.ProListPreview,{style:{"--category-bg-image":'url("/editor/images/my-icons-preview.png")'}},Oe("strong","Click Add Icon to use your own icons in all designs."))}]:this.results:EB.category===fB?[{type:"custom",render:()=>Oe(_B.ProListPreview,{style:{"--category-bg-image":'url("/editor/images/my-icons-preview.png")'}},[Oe("button",{onclick:()=>TB("images")},"Join Cuttle Pro"),Oe("strong","Upload your own icons!")])}]:[]}}const LB=e=>e.some(e=>e.isVisible);const EB=new class{constructor(){this.recommendedCategory=new SB,this.myIconsCategory=new kB,this.symbolCategory=new CB,this.emojiCategory=new xB,this.nounProjectCategory=new wB,this.categoriesByName={[dB]:[this.recommendedCategory,this.myIconsCategory,this.symbolCategory,this.emojiCategory,this.nounProjectCategory],[pB]:[this.recommendedCategory],[fB]:[this.myIconsCategory],[mB]:[this.symbolCategory],[gB]:[this.emojiCategory],[vB]:[this.nounProjectCategory]},this.query="",this.category=dB,this.activeCategories=this.categoriesByName[dB],this.isLoading=!1,ic.subscribe(()=>Oe.redraw())}onPopupOpen(e,t=[],n){this.currentPopup=n,this.recommendedCategory.setValues(t),LB(this.activeCategories)||this.setCategory(dB),this.setSelectedValue(e),this.selectedValueWhenOpened=this.selectedValue,this.performQuery()}onPopupClose(){if(this.currentPopup=void 0,this.selectedValue&&this.selectedValue!==this.selectedValueWhenOpened){const e=sc(this.selectedValue);if("noun project"===e.type){const{nounProjectId:t}=e;Ao("noun project icon picked",{nounProjectId:t})}}}getSelectListItems(){let e;return e=this.category===dB?this.activeCategories.flatMap(e=>{const t=e.getResultsAsSelectListItems();return 0===t.length?t:[{type:"header",label:e.name},...t]}):this.activeCategories.flatMap(e=>e.getResultsAsSelectListItems()),e.length>0?e:[{type:"status",message:`No results for ${this.query} in this category`}]}setCategory(e){this.category=e,this.activeCategories=this.categoriesByName[e]}setQuery(e){this.query=e,this.performQuery()}performQuery(){for(const e of this.activeCategories)e.performQuery(this.query)}setSelectedValue(e){this.selectedValue=PB(e)}},PB=e=>{const t=sc(e);return"noun project"===t.type?tc+t.nounProjectId:e},TB=e=>{EB.currentPopup&&EB.currentPopup.close(),fT(e)},AB={oninit({attrs:{value:e,recommendedValues:t,currentPopup:n}}){EB.onPopupOpen(e,t,n)},onremove(){EB.onPopupClose()},view:e=>{const{onchange:t,recommendedValues:n}=e.attrs,i=EB.getSelectListItems(),r=[{key:"category",items:yB.filter(e=>LB(EB.categoriesByName[e])).map(e=>e===vB?IB(vB,Oj.business.canSearchNounProject()):e===fB?IB(fB,Oj.business.canUploadImages()):e),value:EB.category,onSelect:e=>{EB.setCategory(e)}}],s=async(e,n)=>{try{const i=await ic.getDataUrlForIcon(e,{maxFileSize:n?1/0:void 0});EB.setSelectedValue(tc+e),t(i),Oe.redraw()}catch(i){i instanceof nc?(({id:e,fileSize:t})=>{ia.open({modalView:()=>Oe(gL,{primaryAction:{label:"Cancel",action:()=>{Ao("noun project large icon",{nounProjectId:e,fileSize:t,wasUsed:!1})}},cancelAction:{label:"Try Anyway",action:()=>{s(e,!0),Ao("noun project large icon",{nounProjectId:e,fileSize:t,wasUsed:!0})}}},"This Noun Project icon looks suspiciously large and may make Cuttle unresponsive. Should we try using it anyway?")})})(i):console.error("Failed to fetch Noun Project icon:",i)}};return r.push({key:"shape",items:i,value:EB.selectedValue,onSelect:e=>{if(e.startsWith(tc)){const n=EB.recommendedCategory.getExternalValue(e);if(n)EB.setSelectedValue(e),t(n);else{const t=e.slice(33);s(t,!1)}}else EB.setSelectedValue(e),t(e)}}),Oe(_B.ShapePickerPopup,Oe(qF,{groups:r,layoutKey:"shape-picker",primaryGroupKey:"shape",query:EB.query,onQuery:e=>{EB.setCategory(dB),EB.setQuery(e)},headerExtra:()=>[Oe(".divider"),[Oe(hB,{onSuccess:async e=>{EB.setCategory(fB),EB.setSelectedValue(e),t(e)},onFail:e=>{console.warn("Icon upload failed.",e)}}),Oe(".help-link-wrapper",Oe(Zo,{message:()=>["Help with adding your own icons."],placement:"bottom"},Oe("a.help-link.secondary",{href:"/learn/adding-your-own-icons",target:"_blank",rel:"noreferrer noopener nofollow",role:"button","aria-label":"Help with adding your own icons."},"?")))]]}))}},MB={view({attrs:{url:e,label:t,extraMenuItems:n}}){const i=lc(e),r=Oe("img",{loading:"lazy",src:i,alt:t});return[t?Oe(Zo,{message:()=>t},r):r,n&&Oe(".extra",[Oe(ea,{icon:"dotdotdot",onclick:e=>{EB.currentPopup&&(e.stopPropagation(),EB.currentPopup.registerChildPopup(Wo({spawnFrom:e.target,placement:"top-end",overlay:"closeOnOutsidePointerDown",menuItems:n()})))}})])]}};function IB(e,t){return{type:"option",value:e,label:e,render:()=>Oe(_B.ProCategory,[Oe(".label",e),Oe(tT,{hasAccess:t})])}}const _B=qL.classes({ShapePickerPopup:{width:420,maxWidth:"100vw"},ProListPreview:{width:260,height:310,background:'linear-gradient(\n        to bottom,\n        rgba(255, 255, 255, 0.75) 0%,\n        rgba(255, 255, 255, 0.95) 50%\n      ),\n      var(--category-bg-image, url("/editor/images/noun-project-preview.png")) no-repeat center center',backgroundSize:"cover",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center","& strong":{marginTop:10}},NounProjectLoading:{display:"flex",gap:6},ProCategory:{display:"flex",gap:2,alignItems:"center",width:"100%"}});function OB(e){try{const t=(new DOMParser).parseFromString(e,"text/html");return t.querySelectorAll("table").forEach(e=>{e.querySelectorAll("td, th").forEach(e=>{const t=document.createElement("span");t.textContent=e.textContent+" ",e.replaceWith(t)});e.querySelectorAll("tr").forEach(e=>{const t=document.createElement("p");Array.from(e.children).forEach(e=>{t.appendChild(e)}),e.replaceWith(t)});e.querySelectorAll("tbody").forEach(t=>{Array.from(t.children).forEach(t=>{e.appendChild(t)}),t.remove()});const t=document.createElement("div");Array.from(e.children).forEach(e=>{t.appendChild(e)}),e.replaceWith(t)}),t.body.innerHTML}catch(t){return e}}const NB=GF.extend({selectable:!0,draggable:!0,addAttributes:()=>({src:{default:null},"data-symbol-url":{default:null},alt:{default:null},"data-glyph-index":{default:null}}),addCommands:()=>({setInlineImage:e=>({commands:t})=>t.insertContent(FB(e.src))}),parseHTML:()=>[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))return!1;const t=e.getAttribute("data-symbol-url")??e.getAttribute("src");if(t){if("error"!==sc(t).type)return{src:t}}return!1}},{tag:"img[alt]"},{tag:"img[data-glyph-index]"}]}).configure({inline:!0}),DB=bF.create({name:"doc",topNode:!0,content:"paragraph+",marks:""}),RB=e=>{let t,n=e;const i=()=>{if(!t)return"";const e=t.state.selection;return tF(e)&&"image"===e.node.type.name?e.node.attrs.src:""},r=e=>{if(!t)return;const n=t.state.selection,i=Math.min(n.$anchor.pos,n.$head.pos);t.chain().setInlineImage({src:e}).setNodeSelection(i).run()};return{view:e=>(n=e,Oe(".doc-editor-rich",[Oe(".doc-editor-rich-wrap"),Oe(jB,{getSymbolValue:i,addSymbol:r})])),oncreate(e){const i=uo(e).querySelector(".doc-editor-rich-wrap"),{value:r,editable:s}=e.attrs,o=[DB,$F,ZF,NB];s&&o.push(zF,SF),t=new pF({element:i,editable:s,extensions:o,content:BB(r),onUpdate:({editor:e})=>{if(i&&s){const t=e.getJSON();n.attrs.onchange(VB(t))}},onBlur:({editor:e})=>{if(i&&s){const t=e.getJSON();n.attrs.onchange(VB(t))}},editorProps:{attributes:{spellcheck:"false"},transformPastedHTML:OB}}),e.attrs.autoselect?(t.commands.focus(),t.commands.selectAll()):t.commands.setTextSelection(t.state.doc.content.size)},onupdate(e){if(t){let{value:n}=e.attrs;Ys(n)&&(n=new Ot(n));const i=VB(t.getJSON());n.equals(i)||t.commands.setContent(BB(n))}},onremove(){t&&t.destroy()}}},FB=e=>{const t=lc(e);return t===e?{type:"image",attrs:{src:t}}:{type:"image",attrs:{src:t,"data-symbol-url":e}}};function BB(e){Ys(e)&&(e=new Ot(e));return{type:"doc",content:e.split("\n").map(e=>({type:"paragraph",content:e.items.map(e=>Ys(e)?e.length>0?{type:"text",text:e}:void 0:e instanceof Dt?{type:"image",attrs:{"data-glyph-index":e.index,alt:e.index}}:e instanceof Nt?FB(e.source):void 0).filter(Boolean)}))}}function VB(e){const t=new Ot;if(e.content)for(let n of e.content)if("paragraph"===n.type)if(t.items.length>0&&t.append("\n"),n.content){for(let e of n.content)if("text"===e.type&&e.text)t.append(e.text);else if("image"===e.type&&e.attrs){const n=e.attrs["data-symbol-url"]??e.attrs.src;if(n)t.append(new Nt(n));else if(e.attrs["data-glyph-index"]){const n=parseInt(e.attrs["data-glyph-index"]);t.append(new Dt(n))}}}else t.append("");return t}const jB={view:e=>Oe(".rich-text-symbols-menu-button",[Oe(ea,{icon:"insert_symbol",label:"Insert Symbol",onclick:()=>{const{getSymbolValue:t,addSymbol:n}=e.attrs;Oj.isPickerOpen=!0;const i=Oj.startGesture("Rich Text Symbol Picker"),r=Vo({view:()=>Oe(AB,{value:t(),onchange:e=>{n(e)},currentPopup:r}),spawnFrom:uo(e),placement:"top-end",onclose:()=>{Oj.isPickerOpen=!1,Oj.stopGesture(i)},closeOnEnter:!0})}})])},HB=(e,t)=>{const n=UB(e,aw);if(n){const e=Math.min(t.clientY+16,window.innerHeight);return zB(n,t.clientX,e),!0}return!1},UB=(e,t)=>{let n,i;const r=e.source.base.definition.firstParameterWithInterface(t);if(r)n=e.source.base,i=r;else for(let s=0,o=e.source.modifiers.length;s<o;s++){const r=e.source.modifiers[s],o=r.definition.firstParameterWithInterface(t);if(o){n=r,i=o;break}}if(n&&i){if(n.hasArgumentWithName(i.name)&&!n.args[i.name].isLiteral())return;return new oS(e,n,i)}},zB=(e,t,n)=>{if(Oj.isCanvasTextParameterOpen)return;const i=e.expression().literalValue();if(!(Ys(i)||i instanceof Ot))return;const r=t=>{e.ensureEditableExpression().jsCode=Hb(t)};Oj.isCanvasTextParameterOpen=!0;const s=Vo({view:()=>{function t(){s.close(),Oe.redraw()}if(!Oj.project.selectableExistsAndIsValid(e))return void t();let n=e.expression().literalValue();if(n instanceof Ot||Ys(n))return Oe(RB,{value:n,editable:!0,onchange:r,autoselect:!0});t()},spawnFrom:{x:t,y:n},className:"canvas-text-parameter-popup",placement:"bottom-start",offsetV:8,onclose:()=>{Oj.isCanvasTextParameterOpen=!1}})};class WB{constructor(e,t=!1){this.node=e,this.isRenderedAsGuide="show-all-as-guides"===e.source.guidesDisplay,this.isStyled=t&&!this.isRenderedAsGuide,this.isSelected=Oj.project.selection.isNodeDirectlySelected(e),this.isRenderedAsAnchor=this.node.isAnchor(),this.isPositionLocked=this.isSelected?Oj.project.selection.isPositionLocked():e.source.isPositionLocked(),this.graphic=qC(e);const n=Oj.traceForNode(e);if(null==n?void 0:n.isSuccess()){const t=GC(e);this.baseGraphic=n.base.result.clone().affineTransform(t),n.result instanceof Ri&&1===n.result.anchors.length&&(this.isRenderedAsAnchor=!0)}}renderCanvas(e,t){if(this.isRenderedAsGuide)return;const{node:n,graphic:i}=this;if(i&&(this.isSelected||n.isVisible())&&Oj.project.isNodeVisibleForEditing(n)){if(this.isStyled&&!this.isRenderedAsAnchor){const n=Oj.canvasDimensions.size;return void EA(i,e,t,n)}if(!this.isStyled&&n.source.modifiers.length>0){const i=n.source.modifiers[n.source.modifiers.length-1];LA(n,i,e,t)}kA(n,e,t)}}hitTest(e,t){if(this.isRenderedAsGuide)return;if(!this.baseGraphic||!this.graphic)return;if(!this.isSelected&&this.node.isLocked())return;const n=Ij/t;let i=1/0;const r=new xi([this.graphic,this.baseGraphic]),s=new De(e.clone().addScalar(-n),e.clone().addScalar(n)),o=r.closestPoint(e,s);o&&o.position&&(i=e.distance(o.position));let a=!1;return this.isRenderedAsAnchor?(i-=5/t,a=i<=0):this.isStyled&&(a=this.graphic.styleContainsPoint(e)),this.isSelected&&(a||(a=i<=n)),{distance:i,isHit:a}}isContainedByBoundingBox(e){var t;return!this.isRenderedAsGuide&&Boolean(null==(t=this.baseGraphic)?void 0:t.isContainedByBoundingBox(e))}isOverlappedByBoundingBox(e){var t;return!this.isRenderedAsGuide&&Boolean(null==(t=this.baseGraphic)?void 0:t.isOverlappedByBoundingBox(e))}selectables(){return this.node.isLocked()?[]:[new rS(this.node)]}cursor(){return Oj.isAltDown?this.node.isAnchor()?"select-join-handles":"duplicate":this.isPositionLocked?"select-locked":"select"}snappingGeometry(e){if(this.baseGraphic&&(this.isSelected||!this.node.isLocked()||!e))return new uA(this.node.source.name,this.baseGraphic)}onPointerDown(e){const{project:t}=Oj,n=co(e),i=this.node.isAnchor();var r,s;n?i?(e=>{var t;const n=Oj.traceForNode(e);if(!((null==n?void 0:n.isSuccess())&&n.result instanceof Wn))return;let i,r,s=n.result.hasTangentHandles()?"free":"tangent";if("free"===s)i=new It(0,0),r=new It(0,0);else{i=n.result.handleIn.clone(),r=n.result.handleOut.clone();const s=i.isZero(),o=r.isZero();if(s&&!o)i.copy(r).negate();else if(!s&&o)r.copy(i).negate();else{if(!e.parent)return;const s=e.indexInParent();if(-1===s)return;const o=e.parent.childCount();if(o>1){const a=Oj.traceForNode(e.parent);let l=s-1,c=s+1;(null==a?void 0:a.isSuccess())&&Boolean(null==(t=a.base.args.closed)?void 0:t.evaluationResult)&&(l=(l+o)%o,c%=o);const h=l>=0?e.parent.childNodeAtIndex(l):void 0,u=c<o?e.parent.childNodeAtIndex(c):void 0;let d,p,f=n.result;if(void 0!==h){const e=Oj.traceForNode(h);(null==e?void 0:e.result)instanceof Wn&&(d=e.result)}if(void 0!==u){const e=Oj.traceForNode(u);(null==e?void 0:e.result)instanceof Wn&&(p=e.result)}if(d&&p){i.copy(f.position).sub(d.position),r.copy(p.position).sub(f.position);const e=i.length()/3,t=r.length()/3;i.normalize(),r.normalize(),r.add(i).normalize(),i.copy(r).mulScalar(-e),r.mulScalar(t)}else d&&!p?(i.copy(d.position).sub(f.position).mulScalar(1/3),r.copy(i).negate()):p&&!d&&(r.copy(p.position).sub(f.position).mulScalar(1/3),i.copy(r).negate())}}}const{args:o}=e.source.base;o.handleIn=new _b(Fb(i,2)),o.handleOut=new _b(Fb(r,2)),o.handleConstraint=new _b(`"${s}"`)})(this.node):tV(this.node,e):i&&e.altKey&&(r=e,s=this.node,DA(r,s,"handleOut",{overrideAnchorHandleConstraint:"mirror",assignAnchorHandleConstraint:"tangent"}),e.preventDefault())}}class GB{constructor(e,t){this.node=e,this.isLocked=t;const n=KC(e),i=GC(e);this.worldOriginPosition=n.clone().affineTransform(i),this.worldDefaultOriginPosition=(new It).affineTransform(i)}isValid(){return Oj.project.nodeExists(this.node)}renderCanvas(e,t){if(!this.worldOriginPosition)return;const n=IT(this.worldOriginPosition.clone().affineTransform(e)),i=Oj.project.isNodeHovered(this.node)?qL.color.blue53:qL.color.blue63;AA(n,3,i,t)}hitTest(e,t){if(!this.worldOriginPosition)return;const n=3/t,i=e.distance(this.worldOriginPosition)-n;return{distance:i,isHit:i<=0}}selectables(){return[new rS(this.node)]}cursor(){return Oj.isAltDown?"duplicate":this.isLocked?"select-locked":"select"}snappingPoints(e){return this.worldOriginPosition?[new hA(this.worldOriginPosition,"Origin","Origin")]:!e&&this.worldDefaultOriginPosition?[new hA(this.worldDefaultOriginPosition,"Default Origin","Origin")]:void 0}}class $B{constructor(e){this.children=[];const t=e.isPositionLocked();for(let n of e.items)n instanceof rS&&!n.node.source.isPassThrough()&&this.children.push(new GB(n.node,t))}}class ZB{renderCanvas(e,t){Oj.hoveredObjectInspectorGeometry&&PA(Oj.hoveredObjectInspectorGeometry,qL.color.red47Alpha40,2,!1,!1,e,t);const{project:n}=Oj,{hoveredItem:i}=n;i&&!n.selection.contains(i)&&(i instanceof rS?"show-all-as-guides"!==i.node.source.guidesDisplay&&kA(i.node,e,t):i instanceof sS&&LA(i.node,i.instance,e,t))}}class qB{constructor(e,t){this.node=e,this.instance=t}isValid(){return Oj.project.nodeExists(this.node)}renderCanvas(e,t){LA(this.node,this.instance,e,t)}}class KB{constructor(){this.children=[];for(let e of Oj.project.selection.allNodesAndInstancesToShow().items)e instanceof sS&&this.children.push(new qB(e.node,e.instance))}}class YB{constructor(e){const t=Oj.traceForComponent(e);(null==t?void 0:t.isSuccess())&&(this.graphic=t.result),this.assignDefaultStrokeToUnstyled=e instanceof yb}isValid(){return void 0!==this.graphic}renderCanvas(e,t){if(!this.graphic)return;const n=Oj.canvasDimensions.size;EA(this.graphic,e,t,n,this.assignDefaultStrokeToUnstyled)}}class XB{constructor(e,t=1){Oj.project.isNodeVisibleForEditing(e)&&(this.graphic=qC(e)),this.opacity=t}isValid(){return void 0!==this.graphic}renderCanvas(e,t){if(!this.graphic)return;const n=Oj.canvasDimensions.size;EA(this.graphic,e,t,n)}renderCanvasOpacity(){return this.opacity}}class JB{constructor(e){this.node=e}isValid(){return Oj.project.nodeExists(this.node)}renderCanvas(e,t){kA(this.node,e,t)}}class QB{constructor(e){this.node=e}isValid(){return Oj.project.nodeExists(this.node)}snappingGeometry(){const e=qC(this.node);if(e)return new uA(this.node.source.name,e)}}class eV{renderCanvas(e,t){const n=Oj.ghostGeometry;n&&PA(n,qL.color.blackAlpha20,1,!1,!1,e,t)}}const tV=(e,t)=>{if(e.hasChildNodes()&&!e.isImmutableChildren())Oj.project.clearSelection(),Oj.project.focusNode(e);else{if(HB(e,t))return;e.isImmutableChildren()&&jT.showBasic({type:"info",message:"To edit the anchors (nodes) of this shape, do Edit > Convert to Paths."})}};class nV{constructor(){this.id="canvas-base"}cursor(){return Oj.isAltDown?"select-contains":"select"}hitTest(e){return{isHit:!0}}snappingPoints(e){if(!e)return[new hA(new It,"Canvas Origin","Origin")]}snappingGeometry(e){if(!e)return[new uA("X Axis",new Rn(new It,new It(1,0))),new uA("Y Axis",new Rn(new It,new It(0,1)))]}onPointerEnter(e){Oj.project.hoveredItem=null}}class iV{renderCanvas(e,t){const{canvasDrag:n,snapping:i}=Oj;if(!n)return;const r=n.startPoint.worldPosition.clone().affineTransform(e);IT(r);const s=n.currentPoint.worldPosition.clone().affineTransform(e);if(IT(s),t.strokeStyle=n.isPrecise()?qL.color.red47:qL.color.gray50,t.lineWidth=1,t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(s.x,s.y),t.stroke(),!i.currentPoint||!i.currentPoint.worldPosition.equals(n.startPoint.worldPosition)){const e=n.startPoint.isPrecise()?qL.color.red47:qL.color.gray50;AA(r,3,e,t)}if(!i.currentPoint||!i.currentPoint.worldPosition.equals(n.currentPoint.worldPosition)){const e=n.currentPoint.isPrecise()?qL.color.red47:qL.color.gray50;AA(s,3,e,t)}}snappingReferencePoints(){const{canvasDrag:e}=Oj;if(e)return e.startPoint.worldPosition}}class rV{constructor(){if(this.children=[],Oj.project.focus instanceof CC){let e=Oj.project.focus.node;e.isPath()&&(this.children.push(new XB(e)),e=e.parent),Oj.project.focus.node.parent&&this.children.push(new sV);let t=1;for(;null!==e;)t*=.5,this.children.push(new QB(e),new XB(e,t)),e=e.parent;this.children.reverse()}else Oj.project.focus instanceof SC&&this.children.push(new YB(Oj.project.focus.component))}}class sV{renderCanvas(e,t){var n;const{focus:i}=Oj.project;Ps(i instanceof CC);const r=null==(n=qC(i.node))?void 0:n.boundingBox();if(!r)return;const s=20/Oj.viewportManager.viewportForComponent(i.component).pixelsPerUnit,o=r.center().affineTransform(e),a=e.a*(r.size().length()/2+s),{width:l,height:c}=Oj.canvasRectPixels;t.fillStyle=qL.color.blackAlpha03,t.beginPath(),t.rect(0,0,l,c),t.ellipse(o.x,o.y,a,a,0,0,ze),t.fill("evenodd"),t.font=qL.font.defaultFont14,t.fillStyle=qL.color.blackAlpha50,t.textAlign="center",t.fillText(i.node.source.name,o.x,o.y-a-12)}}class oV{constructor(e,t,n=!1){this.geometry=e,this.selectable=t,this.isSelected=Boolean(t&&Oj.project.selection.isNodeIndirectlySelected(t.node)),this.isForceDisplaySelected=n}isValid(){return void 0!==this.geometry}snappingGeometry(e){return this.geometry}renderCanvas(e,t){if(!this.geometry)return;const n=!this.isForceDisplaySelected&&this.selectable&&Oj.project.isItemHovered(this.selectable),i=this.isSelected||this.isForceDisplaySelected,r=void 0!==this.selectable;if(Oj.project.isGuidesEnabled||i||n)for(let s of this.geometry){const o=n||i?2:1.5,a=r?qL.color.red47Alpha60:qL.color.red47Alpha40;for(let n of s.geometry)PA(n,a,o,i,!1,e,t)}}selectables(){return this.selectable?[this.selectable]:[]}cursor(){return"select"}hitTest(e,t){var n;if(!this.selectable)return;if(!this.geometry)return;if(this.selectable.node.isLocked())return;const i=this.isSelected||this.isForceDisplaySelected;let r,s=1/0;if(Oj.project.isGuidesEnabled||i){for(let{geometry:t}of this.geometry)for(let i of t){const t=null==(n=i.closestPoint(e))?void 0:n.position;if(t){const n=e.distanceSquared(t);n<s&&(s=n,r=t)}}if(!r)return;return{distance:e.distance(r),isLowPriority:!this.isSelected}}}onPointerDown(e){const{selectable:t}=this;t instanceof rS&&co(e)&&tV(t.node,e)}}class aV{constructor(){this.children=[];const{focus:e,selection:t}=Oj.project;if(e instanceof CC||e instanceof SC){const n=Oj.traceForComponent(e.component);if(n){const i=e=>!!t.isNodeIndirectlySelected(e)||!!Oj.project.isNodeHovered(e),r=e instanceof CC,s=zS(n);e:for(const{geometry:t,logLevel:n,sourcePath:o}of s){const s=DC.fromSourcePath(o);if(!s){const e=new uA("",t);this.children.push(new oV([e]));continue e}let a;Ps(Oj.project.nodeExists(s));if(r&&!s.equalsNode(e.node)){let t=s;for(;null!==t;){if(!t.source.isVisible&&!i(t))continue e;if("guide"!==n&&!i(t))continue e;if("guide"===n&&t.parent&&!t.parent.source.base.definition.isShowGuides)continue e;if(t.parent&&e.node.equalsNode(t.parent)){a=t;break}t=t.parent}}const l=$C(s),c=t.clone().affineTransform(l),h=new uA("",c),u=a?new rS(a):void 0;this.children.push(new oV([h],u))}}}}}class lV{constructor(e,t,n,i){this.selectable=e,this.instanceTrace=t,this.isInteractable=i,this.isSelected=Oj.project.selection.contains(e),this.isLocked=e.isImmutable()||e.expression().isComputed(),this.worldHandlePosition=n.handlePosition}isValid(){return Oj.project.selectableExistsAndIsValid(this.selectable)}renderCanvas(e,t){if(!this.worldHandlePosition)return;const n=IT(this.worldHandlePosition.clone().affineTransform(e));t.beginPath(),t.ellipse(n.x,n.y,4,4,0,0,2*Math.PI),t.fillStyle=this.isSelected?qL.color.blue63:qL.color.white,t.strokeStyle=qL.color.blue63,t.lineWidth=1,t.fill(),t.stroke()}hitTest(e,t){if(!this.isInteractable||!this.worldHandlePosition)return;const n=4/t,i=this.worldHandlePosition.distance(e)-n;return{distance:i,isHit:i<=0}}isContainedByBoundingBox(e){return!(!this.isInteractable||!this.worldHandlePosition)&&e.containsPoint(this.worldHandlePosition)}isOverlappedByBoundingBox(e){return!(!this.isInteractable||!this.worldHandlePosition)&&e.containsPoint(this.worldHandlePosition)}selectables(){return[this.selectable]}cursor(){return this.isLocked?"select-locked":Oj.isAltDown&&this.instanceTrace.source.definition===gx?"select-split-handles":"select"}snappingPoints(e){if(!this.isLocked&&this.worldHandlePosition){let e;return e=this.selectable instanceof oS?`${this.selectable.parameter.name} (${this.selectable.instance.definition.name})`:this.selectable.parameter.name,new hA(this.worldHandlePosition,e,"Handle")}}snappingReferencePoints(e){if(!e)return this.worldHandlePosition}}class cV extends lV{constructor(e,t,n,i){super(e,t,n,i),this.worldOriginPosition=n.originPosition}renderCanvas(e,t){if(!this.worldHandlePosition||!this.worldOriginPosition)return;const n=IT(this.worldOriginPosition.clone().affineTransform(e)),i=IT(this.worldHandlePosition.clone().affineTransform(e));t.strokeStyle=qL.color.blue63,t.lineWidth=1,t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(i.x,i.y),t.stroke(),t.beginPath(),t.ellipse(i.x,i.y,4,4,0,0,ze),t.fillStyle=this.isSelected?qL.color.blue63:qL.color.white,t.fill(),t.stroke()}snappingReferencePoints(e){if(!e&&this.isSelected&&this.worldOriginPosition&&(this.selectable instanceof aS||Oj.project.selection.isNodeIndirectlySelected(this.selectable.node)))return this.worldOriginPosition}}class hV{constructor(e,t=!0){const n=[];for(let i of e.items){let e,r;if(i instanceof oS){if(e=i.parameter,e.hidden)continue;r=i.instanceTrace()}else{if(!(i instanceof aS))continue;{const{focus:t}=Oj.project;if(t instanceof CC&&null!==t.node.parent)continue;e=i.parameter,r=i.instanceTrace()}}if(!e.expression.isComputed()&&r){const s=JC(i);s&&(e.interface instanceof ew?n.push(new cV(i,r,s,t)):n.push(new lV(i,r,s,t)))}}this.children=n.sort((e,t)=>e.isSelected===t.isSelected?0:e.isSelected?1:-1)}}class uV extends hV{constructor(e=!0){let t=Oj.selectionBoxParameters;t||(t=Oj.project.selection.isEmpty()?Oj.project.focusedComponentParametersToShow():Oj.project.selectionParametersToShow()),super(t,e)}}class dV extends hV{constructor(e=!0){let t=Oj.selectionBoxParameters;t||(t=Oj.project.selectionParametersToShow()),super(t,e)}}const pV=(e,t,n)=>{let i,r;NA(e,{onConsummate(e,n){i=new FC(t),r=t.items.every(e=>e instanceof rS)},onMove(e,t){const{startPosition:n,currentPosition:r}=ET(t),s=Ne.fromTranslationPoints(n,r),o=e.altKey?"free":void 0;i.transformWorld(s,{overrideAnchorHandleConstraint:o,assignAnchorHandleConstraint:o})},onUp(e){r&&e.altKey&&(Oj.project.duplicateSelection(),i.revert())},onCancel:n,cursor:()=>Oj.isAltDown?r?"duplicate":"select-split-handles":"select"})},fV=()=>{const{project:e}=Oj;if(!e.hasOverrideTransformCenter()){const t=e.transformCenter();if(t)return e.setOverrideTransformCenter(t.clone()),!0}return!1},mV=(e,t,n,i,r,s,o)=>{let a,l,c=!1;const h=r.clone().affineTransform(n);NA(e,{disableDisplay:!0,startWorldPosition:h,onConsummate(e,i){a=new FC(t),l=n.clone().invert(),c=fV()},onMove(e,c){const{currentPosition:h}=ET(c),u=h.clone().affineTransform(l),d=e.shiftKey||!s&&t.isUniformScale();let p,f;if((o||e.ctrlKey||e.metaKey)&&(p=Oj.project.transformCenter()),s){let e=i;if(p){const t=p.worldPosition.clone().affineTransform(l);if(!d){const e=new Rn(i,r.clone().sub(i)).closestPoint(t);Ps(e),t.copy(e.position)}t.distance(r)>Ve&&(e=t)}f=Ne.fromCenterAndReferencePoints(e,r,u,{allowScale:!d||"uniform"})}else{let e=i;if(p){const t=p.worldPosition.clone().affineTransform(l);t.distance(r)>Ve&&(e=t)}f=d?Ne.fromCenterAndUniformScalePoints(e,r,u):Ne.fromCenterAndNonUniformScalePoints(e,r,u)}f.changeBasis(l,n),f.ensureMinimumBasisLength(Oj.project.settings.tolerance);const m=t.isSingle();a.transformWorld(f,{preserveRotation:m})},onUp(){c&&Oj.project.clearOverrideTransformCenter()}})},gV=(e,t,n)=>{let i;const r=fV(),s=Oj.project.transformCenter();if(!s)return;const o=n.clone().sub(s.worldPosition).angle();NA(e,{enableGridSnapping:!1,disableDisplay:!0,rotationTransformCenter:s.worldPosition,rotationReferenceStartAngle:o,startWorldPosition:n,onConsummate(e,n){i=new FC(t)},onMove(e,t){const{currentPosition:r}=ET(t),o=vV(t,e),a=Ne.fromCenterAndReferencePoints(s.worldPosition,n,r,{allowRotation:!0,rotationIncrement:o});i.transformWorld(a)},onUp(){r&&Oj.project.clearOverrideTransformCenter()}})},vV=(e,t)=>e.isPrecise()?0:t.shiftKey?15:1;class yV{constructor(e,t){const{node:n,nextNode:i}=e;this.id=`segment-${n.hash()}-${i.hash()}`,this.selectable=e,this.isSelected=Oj.project.selection.contains(this.selectable),this.isInverted=t;const r=qC(n),s=qC(i);r instanceof Wn&&s instanceof Wn&&(r.handleOut.isZero()&&s.handleIn.isZero()?this.segmentWorld=Bn.fromAnchors(r,s):this.segmentWorld=Fn.fromAnchors(r,s))}isValid(){return Oj.project.selectableExistsAndIsValid(this.selectable)}renderCanvas(e,t){if(!this.segmentWorld)return;const n=this.isSelected?qL.color.blue63:this.isInverted?qL.color.gray50:qL.color.black,i=this.isSelected?2:this.isInverted?1.5:1;PA(this.segmentWorld,n,i,this.isSelected,!1,e,t)}}class bV extends yV{isContainedByBoundingBox(e){var t;return Boolean(null==(t=this.segmentWorld)?void 0:t.isContainedByBoundingBox(e))}isOverlappedByBoundingBox(e){var t;return Boolean(null==(t=this.segmentWorld)?void 0:t.isOverlappedByBoundingBox(e))}selectables(){return[this.selectable]}hitTest(e,t){var n,i;const r=null==(i=null==(n=this.segmentWorld)?void 0:n.closestPoint(e))?void 0:i.position;if(r)return{distance:e.distance(r)}}cursor(){return this.selectable.isMoveLocked()?"select-locked":"select"}insertAnchorWithPointerEvent(e){if(!this.segmentWorld)return;const t=new hC(OT(e));AT(t);const n=this.segmentWorld.closestPoint(t.worldPosition);if(void 0!==(null==n?void 0:n.time)){const t=this.selectable.node,i=this.selectable.nextNode,r=[t,i].map(e=>{var t;return null==(t=Oj.traceForNode(e))?void 0:t.result});if(!r.every(e=>e instanceof Wn))return;const s=new Ri(r);if(s.insertAnchorAtTime(n.time)){const n=t.parent;if(n){const{project:r}=Oj,[o,a,l]=s.anchors;t.source.base.args.handleOut=new _b(Fb(o.handleOut)),i.source.base.args.handleIn=new _b(Fb(l.handleIn));const c=r.createElementWithDefinition(gx);c.base.args.position=new _b(Fb(a.position)),c.base.args.handleIn=new _b(Fb(a.handleIn)),c.base.args.handleOut=new _b(Fb(a.handleOut)),c.base.args.handleConstraint=new _b(a.hasZeroHandles()?'"free"':'"tangent"');const h=t.indexInParent()+1,u=r.spliceNodes([],[c],n,h);Oj.project.selectNodes(u),pV(e,Oj.project.selection)}}}}}const wV=new Gn(0,0,0,1);class xV{constructor(e,t,n){var i;if(this.children=[],!(Oj.project.focus instanceof CC))return;const{node:r}=Oj.project.focus;if(r.isPath()){const s=Oj.traceForNode(r);void 0===n&&(n=Boolean(null==(i=null==s?void 0:s.base.args.closed)?void 0:i.evaluationResult));const o=Boolean((null==s?void 0:s.result)instanceof Ri&&s.result.stroke&&!s.result.stroke.hairline&&s.result.stroke.color.equals(wV)),a=r.childNodes();for(let[i,r]of ns(a,n))if((!t||!t.equalsNode(i)&&!t.equalsNode(r))&&i.isAnchor()&&r.isAnchor()){const t=new lS(i,r);this.children.push(new e(t,o))}}}}class CV{constructor(){this.isSnappingStale=!1}isDisabled(){return!(Oj.project.focus instanceof CC)}markSnappingStale(){this.isSnappingStale=!0,this.removePreviewAnchor(),Oj.snapping.clear()}markSnappingReady(){this.isSnappingStale=!1}onPointerMove(e){if(this.ensurePreviewAnchorValid(),Oj.deviceStorage.geometrySnappingEnabled){this.previewAnchorNode||Oj.canvasPointerIsDown||Oj.snapping.cacheSnappingDataForHoveredInterface();const t=OT(e);e.shiftKey?Oj.snapping.updateReferenceSnappingPointNearWorldPosition(t):Oj.snapping.updateSnappingPointNearWorldPosition(t)}}onPointerLeave(e){this.stopEditing()}onKeyDown(e){"Escape"===e.key?Oj.project.selection.isEmpty()?Oj.activateTool("Select"):(this.stopEditing(),Oj.project.clearSelection(),Oj.snapping.clear()):RA(e),oo(e.key)||this.markSnappingStale()}onKeyUp(e){oo(e.key)||this.markSnappingStale()}ensurePreviewAnchorValid(){this.previewAnchorNode&&!Oj.project.nodeExists(this.previewAnchorNode)&&this.removePreviewAnchor()}interface(){this.ensurePreviewAnchorValid();let e=!this.previewPathClosedGestureId&&void 0;const t=[new SV,new rV,new xV(kV,this.previewAnchorNode,e)],n=this.focusedPath();if(n){const e=n.childNodes();let i=-1;this.previewAnchorNode&&(i=n.indexOfChildNode(this.previewAnchorNode));let r=-1;if(EV(e)){const t=e.length-1,s=this.endAnchorIndexForPathNode(n);0===s||1===s&&0===i?r=t:(s===t||s===t-1&&i===t)&&(r=0)}for(let n=0;n<e.length;++n)n!==i&&(n===r?t.push(new LV(this,e[n])):t.push(new WB(e[n])))}return this.previewAnchorNode&&t.push(new JB(this.previewAnchorNode)),t.push(new eV,new aV,new ZB,new dV,new iV),t}activate(){this.previewAnchorNode=void 0,Ps(void 0===this.previewAnchorGestureId),Ps(void 0===this.previewPathClosedGestureId),this.isSnappingStale=!1;const{selection:e}=Oj.project;e.isSingle()&&e.hasOnly(rS)&&e.items[0].node.isPath()&&Oj.project.focusNode(e.items[0].node),this.focusedPath()||Oj.project.clearSelection()}deactivate(){this.stopEditing();const{focus:e}=Oj.project;Ps(e instanceof CC),e.node.isPath()&&Oj.project.selectNode(e.node)}isPreviewingPathClosed(){return Boolean(this.previewPathClosedGestureId)}startPreviewingPathClosed(){this.previewPathClosedGestureId=Oj.startGesture("Pen Tool: Preview Path Closed")}stopPreviewingPathClosed(){this.previewPathClosedGestureId&&(Oj.stopGesture(this.previewPathClosedGestureId),this.previewPathClosedGestureId=void 0)}onCanvasPointerLeave(e){this.removePreviewAnchor()}onCanvasPointerMove(e){if(0!==e.buttons)return;if(this.isSnappingStale)return;this.ensurePreviewAnchorValid();const t=this.ensurePreviewAnchor(),n=new hC(OT(e));AT(n),TV(t,n)}onCanvasPointerDown(e){this.ensurePreviewAnchorValid();const t=this.ensurePreviewAnchor();Oj.project.selectNode(t),this.clearPreviewAnchor();let n="handleOut";const i=t.parent;if(i){const e=this.endAnchorIndexForPathNode(i);i.childCount()>1&&0===e&&(n="handleIn")}const r=Oj.snapping.currentPoint?Oj.snapping.currentPoint.worldPosition:OT(e);AV(r),DA(e,t,n,{overrideAnchorHandleConstraint:"mirror",assignAnchorHandleConstraint:"tangent",allowBreaking:!0,disableSnappingCache:!0})}onClosingNodePointerEnter(e,t){this.ensurePreviewAnchorValid();const n=this.ensureFocusedPath(),i=Oj.traceForNode(n);if((null==i?void 0:i.base.result)instanceof Ri&&!i.base.result.closed){const{args:e}=n.source.base;e.closed=new _b("true"),this.startPreviewingPathClosed()}}onClosingNodePointerLeave(e,t){if(this.ensurePreviewAnchorValid(),this.isPreviewingPathClosed()){const e=this.focusedPath();e&&delete e.source.base.args.closed,this.stopPreviewingPathClosed(),this.markSnappingStale()}}onClosingNodePointerDown(e,t){this.ensurePreviewAnchorValid();const n=this.ensureFocusedPath().childNodes(),i=n[0],r=n[n.length-1],s=(e,n)=>{Oj.project.selectNode(e),Oj.snapping.currentPoint&&Oj.snapping.addReferencePoint(Oj.snapping.currentPoint.worldPosition),DA(t,e,n,{flip:!0,allowBreaking:!0,disableSnappingCache:!0}),this.stopPreviewingPathClosed(),t.preventDefault()};e.equalsNode(i)?e.isAnchor()&&s(e,"handleIn"):e.equalsNode(r)&&r.isAnchor()&&s(r,"handleOut")}onAfterEvaluation(){this.markSnappingReady()}endAnchor(){const e=this.focusedPath();if(e){let t=this.endAnchorIndexForPathNode(e);if(t>=0){const n=e.childNodeAtIndex(t),i=qC(n);if(i instanceof Wn)return i}}}stopEditing(){this.removePreviewAnchor(),this.stopPreviewingPathClosed()}focusedPath(){const{focus:e}=Oj.project;if(e instanceof CC&&e.node.isPath())return e.node}ensureFocusedPath(){const{project:e}=Oj;Ps(e.focus instanceof CC);let t=e.focus.node;for(;t.parent&&(t.isImmutable()||t.isImmutableChildren());)t=t.parent;if(!t.isPath()){const n=e.createElementWithDefinition(mx);n.stroke=new wx(dx),t=e.spliceNodes([],[n],t)[0],e.clearSelection()}return e.focusNode(t),e.focus.node}ensurePreviewAnchor(){if(this.previewAnchorNode&&Oj.project.nodeExists(this.previewAnchorNode))return this.previewAnchorNode;let e=this.ensureFocusedPath();if(this.isNextClickCreatesNewPath()){const t=e.indexInParent(),n=Oj.project.createElementWithDefinition(mx);n.stroke=new wx(dx),e=Oj.project.spliceNodes([],[n],e.parent,t+1)[0]}const t=e.childCount();let n=this.endAnchorIndexForPathNode(e);-1!==n&&n!==t-1||(n=t);const i=this.insertPreviewAnchorAtIndex(n,e);return this.previewAnchorNode=i,i}insertPreviewAnchorAtIndex(e,t){const{project:n}=Oj;this.previewAnchorGestureId=Oj.startGesture("Pen Tool: Preview Anchor");const i=n.createElementWithDefinition(gx),[r]=n.spliceNodes([],[i],t,e);this.previewAnchorNode=r;const s=Oj.canvasPointerPositionPixels?_T(Oj.canvasPointerPositionPixels):new It;if(TV(this.previewAnchorNode,new hC(s)),Oj.deviceStorage.geometrySnappingEnabled){Oj.snapping.cacheSnappingDataForInterface(Oj.interfaceElements);const e=this.endAnchor();e&&AV(e.position)}return r}removePreviewAnchor(){var e;if(this.previewAnchorNode){let t;t=1===(null==(e=this.previewAnchorNode.parent)?void 0:e.childCount())?[this.previewAnchorNode.parent]:[this.previewAnchorNode],Oj.project.spliceNodes(t)}this.clearPreviewAnchor()}clearPreviewAnchor(){this.previewAnchorNode=void 0,this.previewAnchorGestureId&&(Oj.stopGesture(this.previewAnchorGestureId),this.previewAnchorGestureId=void 0)}isNextClickCreatesNewPath(){const e=this.ensureFocusedPath();return 0!==e.childCount()&&(-1===this.endAnchorIndexForPathNode(e)||PV(e))}endAnchorIndexForPathNode(e){if(!this.isPreviewingPathClosed()&&PV(e))return-1;if(1===e.childCount()&&this.previewAnchorNode)return 0;const t=Oj.project.selection.allNodes();if(t.isSingle()){const n=t.items[0].node;if(n.hasParentEqualToNode(e)){const[t,i]=this.firstAndLastIndicesForPathNode(e),r=n.indexInParent();if(r===t||r===i)return r}}return-1}firstAndLastIndicesForPathNode(e){var t;const n=e.childCount();let i=0,r=n-1;if(n>1){const e=null==(t=this.previewAnchorNode)?void 0:t.indexInParent();e===i&&i++,e===r&&r--}return[i,r]}}class SV extends nV{constructor(){super(...arguments),this.id="canvas-base-pen"}cursor(){return Oj.canvasPointerIsDown?"select":"pen"}onPointerLeave(e){const t=Oj.ensureEnabledActiveTool();t instanceof CV&&t.onCanvasPointerLeave(e)}onPointerMove(e){const t=Oj.ensureEnabledActiveTool();t instanceof CV&&t.onCanvasPointerMove(e)}onPointerDown(e){const t=Oj.ensureEnabledActiveTool();t instanceof CV&&t.onCanvasPointerDown(e)}}class kV extends bV{onPointerDown(e){this.insertAnchorWithPointerEvent(e)}cursor(){return"pen-add"}snappingGeometry(e){if(this.segmentWorld)return new uA("Segment",this.segmentWorld)}}class LV extends WB{constructor(e,t){super(t),this.id="closing-anchor",this.penTool=e}cursor(){return"pen-close"}onPointerEnter(e){this.penTool.onClosingNodePointerEnter(this.node,e)}onPointerLeave(e){this.penTool.onClosingNodePointerLeave(this.node,e)}onPointerDown(e){this.penTool.onClosingNodePointerDown(this.node,e)}}const EV=e=>{if(e.length>=2){if(e.length>=3)return!0;for(let t of e){const e=Oj.traceForNode(t);if((null==e?void 0:e.result)instanceof Wn&&!e.result.hasZeroHandles())return!0}}return!1},PV=e=>{const t=e.source.base.args.closed;if(t){const n=null==t?void 0:t.literalValue();if("boolean"==typeof n)return n;const i=Oj.traceForNode(e);return(null==i?void 0:i.result)instanceof Ri&&i.result.closed}return!1},TV=(e,t)=>{const n=$C(e);if(void 0!==n){const i=n.clone().invert(),{contextPosition:r,fractionDigits:s}=PT(t,i);if(e.source.isPassThrough())for(const t of e.source.base.definition.allParameters()){const n=t.interface;if(null==n?void 0:n.isPositionTransformable){const n=t.expression.literalValue();if(n instanceof It){const i=n.clone().add(r);e.source.base.args[t.name]=new _b(Fb(i,s))}}}else{const{args:t}=e.source.transform=new wx(lx);t.position=new _b(Fb(r,s))}}},AV=e=>{const{snapping:t}=Oj;t.clearReference(),t.addReferencePoint(e),t.referenceGeometry.push(...SA(e,0,15))},MV=e=>{let t=e,n=!1;const i=()=>Array.isArray(t.children)&&t.children.length>0,r=()=>{var e,r;if(n)return;const s=uo(t),o=(i()?s:s.querySelector("span")).getBoundingClientRect(),a=e=>{c.close(),t.attrs.onchange((e=>e.replace(/[\s\u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000\uFEFF]+/g," ").trim())(e))},l=e=>{const t=Array.from(document.querySelectorAll(".editable-text,"+fo.join(","))),n=t.indexOf(s);if(n>-1){const i=t[(n+(e.shiftKey?-1:1))%t.length];null==i||i.focus()}};n=!0;const c=Vo({view:()=>Oe(IV,{value:t.attrs.value,onchange:a,onTabOut:l}),spawnFrom:{x:o.left-8,y:o.top-9},className:"editable-text-popup",onclose:()=>{var e,i;n=!1,null==(i=(e=t.attrs).onclose)||i.call(e)},overlay:"closeOnOutsidePointerDown"});null==(r=(e=t.attrs).onopen)||r.call(e)},s=({attrs:{autoSelect:e}})=>{e&&!n&&(r(),Oe.redraw())};return{view(e){t=e;const{attrs:{value:n}}=e;return Oe(".editable-text",{onpointerdown:e=>{(t.attrs.singleClick||co(e))&&(e.stopPropagation(),r())},className:eo({"single-click":Boolean(t.attrs.singleClick)})},i()?e.children:Oe("span",n))},oncreate:s,onupdate:s}},IV=e=>{const{value:t,onchange:n,onTabOut:i}=e.attrs;return{view:()=>Oe(".editable-text-contenteditable",t),oncreate(e){const t=uo(e),r=t.getBoundingClientRect().width;t.style.minWidth=r+"px",t.setAttribute("contenteditable","true"),t.spellcheck=!1,_V(t),t.addEventListener("blur",()=>{n(t.textContent??"")}),t.addEventListener("keydown",e=>{"Enter"===e.code&&(e.preventDefault(),t.blur()),"Tab"===e.code&&(e.preventDefault(),t.blur(),i(e))})}}},_V=e=>{e.focus();const t=window.getSelection();if(t){t.removeAllRanges();const n=document.createRange();n.selectNodeContents(e),t.addRange(n)}};var OV,NV={exports:{}};function DV(){return OV||(OV=1,NV.exports=function(){var e=navigator.userAgent,t=navigator.platform,n=/gecko\/\d/i.test(e),i=/MSIE \d/.test(e),r=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),s=/Edge\/(\d+)/.exec(e),o=i||r||s,a=o&&(i?document.documentMode||6:+(s||r)[1]),l=!s&&/WebKit\//.test(e),c=l&&/Qt\/\d+\.\d+/.test(e),h=!s&&/Chrome\/(\d+)/.exec(e),u=h&&+h[1],d=/Opera\//.test(e),p=/Apple Computer/.test(navigator.vendor),f=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),m=/PhantomJS/.test(e),g=p&&(/Mobile\/\w+/.test(e)||navigator.maxTouchPoints>2),v=/Android/.test(e),y=g||v||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),b=g||/Mac/.test(t),w=/\bCrOS\b/.test(e),x=/win/i.test(t),C=d&&e.match(/Version\/(\d*\.\d*)/);C&&(C=Number(C[1])),C&&C>=15&&(d=!1,l=!0);var S=b&&(c||d&&(null==C||C<12.11)),k=n||o&&a>=9;function L(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var E,P=function(e,t){var n=e.className,i=L(t).exec(n);if(i){var r=n.slice(i.index+i[0].length);e.className=n.slice(0,i.index)+(r?i[1]+r:"")}};function T(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function A(e,t){return T(e).appendChild(t)}function M(e,t,n,i){var r=document.createElement(e);if(n&&(r.className=n),i&&(r.style.cssText=i),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var s=0;s<t.length;++s)r.appendChild(t[s]);return r}function I(e,t,n,i){var r=M(e,t,n,i);return r.setAttribute("role","presentation"),r}function _(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)}function O(e){var t,n=e.ownerDocument||e;try{t=e.activeElement}catch(Be){t=n.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function N(e,t){var n=e.className;L(t).test(n)||(e.className+=(n?" ":"")+t)}function D(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)n[i]&&!L(n[i]).test(t)&&(t+=" "+n[i]);return t}E=document.createRange?function(e,t,n,i){var r=document.createRange();return r.setEnd(i||e,n),r.setStart(e,t),r}:function(e,t,n){var i=document.body.createTextRange();try{i.moveToElementText(e.parentNode)}catch(Be){return i}return i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i};var R=function(e){e.select()};function F(e){return e.display.wrapper.ownerDocument}function B(e){return V(e.display.wrapper)}function V(e){return e.getRootNode?e.getRootNode():e.ownerDocument}function j(e){return F(e).defaultView}function H(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function U(e,t,n){for(var i in t||(t={}),e)!e.hasOwnProperty(i)||!1===n&&t.hasOwnProperty(i)||(t[i]=e[i]);return t}function z(e,t,n,i,r){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var s=i||0,o=r||0;;){var a=e.indexOf("\t",s);if(a<0||a>=t)return o+(t-s);o+=a-s,o+=n-o%n,s=a+1}}g?R=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:o&&(R=function(e){try{e.select()}catch(t){}});var W=function(){this.id=null,this.f=null,this.time=0,this.handler=H(this.onTimeout,this)};function G(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}W.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},W.prototype.set=function(e,t){this.f=t;var n=+new Date+e;(!this.id||n<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=n)};var $=50,Z={toString:function(){return"CodeMirror.Pass"}},q={scroll:!1},K={origin:"*mouse"},Y={origin:"+move"};function X(e,t,n){for(var i=0,r=0;;){var s=e.indexOf("\t",i);-1==s&&(s=e.length);var o=s-i;if(s==e.length||r+o>=t)return i+Math.min(o,t-r);if(r+=s-i,i=s+1,(r+=n-r%n)>=t)return i}}var J=[""];function Q(e){for(;J.length<=e;)J.push(ee(J)+" ");return J[e]}function ee(e){return e[e.length-1]}function te(e,t){for(var n=[],i=0;i<e.length;i++)n[i]=t(e[i],i);return n}function ne(e,t,n){for(var i=0,r=n(t);i<e.length&&n(e[i])<=r;)i++;e.splice(i,0,t)}function ie(){}function re(e,t){var n;return Object.create?n=Object.create(e):(ie.prototype=e,n=new ie),t&&U(t,n),n}var se=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function oe(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||se.test(e))}function ae(e,t){return t?!!(t.source.indexOf("\\w")>-1&&oe(e))||t.test(e):oe(e)}function le(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var ce=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function he(e){return e.charCodeAt(0)>=768&&ce.test(e)}function ue(e,t,n){for(;(n<0?t>0:t<e.length)&&he(e.charAt(t));)t+=n;return t}function de(e,t,n){for(var i=t>n?-1:1;;){if(t==n)return t;var r=(t+n)/2,s=i<0?Math.ceil(r):Math.floor(r);if(s==t)return e(s)?t:n;e(s)?n=s:t=s+i}}function pe(e,t,n,i){if(!e)return i(t,n,"ltr",0);for(var r=!1,s=0;s<e.length;++s){var o=e[s];(o.from<n&&o.to>t||t==n&&o.to==t)&&(i(Math.max(o.from,t),Math.min(o.to,n),1==o.level?"rtl":"ltr",s),r=!0)}r||i(t,n,"ltr")}var fe=null;function me(e,t,n){var i;fe=null;for(var r=0;r<e.length;++r){var s=e[r];if(s.from<t&&s.to>t)return r;s.to==t&&(s.from!=s.to&&"before"==n?i=r:fe=r),s.from==t&&(s.from!=s.to&&"before"!=n?i=r:fe=r)}return null!=i?i:fe}var ge=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function n(n){return n<=247?e.charAt(n):1424<=n&&n<=1524?"R":1536<=n&&n<=1785?t.charAt(n-1536):1774<=n&&n<=2220?"r":8192<=n&&n<=8203?"w":8204==n?"b":"L"}var i=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,r=/[stwN]/,s=/[LRr]/,o=/[Lb1n]/,a=/[1n]/;function l(e,t,n){this.level=e,this.from=t,this.to=n}return function(e,t){var c="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!i.test(e))return!1;for(var h=e.length,u=[],d=0;d<h;++d)u.push(n(e.charCodeAt(d)));for(var p=0,f=c;p<h;++p){var m=u[p];"m"==m?u[p]=f:f=m}for(var g=0,v=c;g<h;++g){var y=u[g];"1"==y&&"r"==v?u[g]="n":s.test(y)&&(v=y,"r"==y&&(u[g]="R"))}for(var b=1,w=u[0];b<h-1;++b){var x=u[b];"+"==x&&"1"==w&&"1"==u[b+1]?u[b]="1":","!=x||w!=u[b+1]||"1"!=w&&"n"!=w||(u[b]=w),w=x}for(var C=0;C<h;++C){var S=u[C];if(","==S)u[C]="N";else if("%"==S){var k=void 0;for(k=C+1;k<h&&"%"==u[k];++k);for(var L=C&&"!"==u[C-1]||k<h&&"1"==u[k]?"1":"N",E=C;E<k;++E)u[E]=L;C=k-1}}for(var P=0,T=c;P<h;++P){var A=u[P];"L"==T&&"1"==A?u[P]="L":s.test(A)&&(T=A)}for(var M=0;M<h;++M)if(r.test(u[M])){var I=void 0;for(I=M+1;I<h&&r.test(u[I]);++I);for(var _="L"==(M?u[M-1]:c),O=_==("L"==(I<h?u[I]:c))?_?"L":"R":c,N=M;N<I;++N)u[N]=O;M=I-1}for(var D,R=[],F=0;F<h;)if(o.test(u[F])){var B=F;for(++F;F<h&&o.test(u[F]);++F);R.push(new l(0,B,F))}else{var V=F,j=R.length,H="rtl"==t?1:0;for(++F;F<h&&"L"!=u[F];++F);for(var U=V;U<F;)if(a.test(u[U])){V<U&&(R.splice(j,0,new l(1,V,U)),j+=H);var z=U;for(++U;U<F&&a.test(u[U]);++U);R.splice(j,0,new l(2,z,U)),j+=H,V=U}else++U;V<F&&R.splice(j,0,new l(1,V,F))}return"ltr"==t&&(1==R[0].level&&(D=e.match(/^\s+/))&&(R[0].from=D[0].length,R.unshift(new l(0,0,D[0].length))),1==ee(R).level&&(D=e.match(/\s+$/))&&(ee(R).to-=D[0].length,R.push(new l(0,h-D[0].length,h)))),"rtl"==t?R.reverse():R}}();function ve(e,t){var n=e.order;return null==n&&(n=e.order=ge(e.text,t)),n}var ye=[],be=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var i=e._handlers||(e._handlers={});i[t]=(i[t]||ye).concat(n)}};function we(e,t){return e._handlers&&e._handlers[t]||ye}function xe(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var i=e._handlers,r=i&&i[t];if(r){var s=G(r,n);s>-1&&(i[t]=r.slice(0,s).concat(r.slice(s+1)))}}}function Ce(e,t){var n=we(e,t);if(n.length)for(var i=Array.prototype.slice.call(arguments,2),r=0;r<n.length;++r)n[r].apply(null,i)}function Se(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Ce(e,n||t.type,e,t),Ae(t)||t.codemirrorIgnore}function ke(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<t.length;++i)-1==G(n,t[i])&&n.push(t[i])}function Le(e,t){return we(e,t).length>0}function Ee(e){e.prototype.on=function(e,t){be(this,e,t)},e.prototype.off=function(e,t){xe(this,e,t)}}function Pe(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Te(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Ae(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Me(e){Pe(e),Te(e)}function Ie(e){return e.target||e.srcElement}function _e(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),b&&e.ctrlKey&&1==t&&(t=3),t}var Oe,Ne,De=function(){if(o&&a<9)return!1;var e=M("div");return"draggable"in e||"dragDrop"in e}();function Re(e){if(null==Oe){var t=M("span","");A(e,M("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Oe=t.offsetWidth<=1&&t.offsetHeight>2&&!(o&&a<8))}var n=Oe?M("span",""):M("span","",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function Fe(e){if(null!=Ne)return Ne;var t=A(e,document.createTextNode("AA")),n=E(t,0,1).getBoundingClientRect(),i=E(t,1,2).getBoundingClientRect();return T(e),!(!n||n.left==n.right)&&(Ne=i.right-n.right<3)}var Be,Ve=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],i=e.length;t<=i;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var s=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),o=s.indexOf("\r");-1!=o?(n.push(s.slice(0,o)),t+=o+1):(n.push(s),t=r+1)}return n}:function(e){return e.split(/\r\n?|\n/)},je=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(Be){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(Be){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},He="oncopy"in(Be=M("div"))||(Be.setAttribute("oncopy","return;"),"function"==typeof Be.oncopy),Ue=null;function ze(e){if(null!=Ue)return Ue;var t=A(e,M("span","x")),n=t.getBoundingClientRect(),i=E(t,0,1).getBoundingClientRect();return Ue=Math.abs(n.left-i.left)>1}var We={},Ge={};function $e(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),We[e]=t}function Ze(e,t){Ge[e]=t}function qe(e){if("string"==typeof e&&Ge.hasOwnProperty(e))e=Ge[e];else if(e&&"string"==typeof e.name&&Ge.hasOwnProperty(e.name)){var t=Ge[e.name];"string"==typeof t&&(t={name:t}),(e=re(t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return qe("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return qe("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Ke(e,t){t=qe(t);var n=We[t.name];if(!n)return Ke(e,"text/plain");var i=n(e,t);if(Ye.hasOwnProperty(t.name)){var r=Ye[t.name];for(var s in r)r.hasOwnProperty(s)&&(i.hasOwnProperty(s)&&(i["_"+s]=i[s]),i[s]=r[s])}if(i.name=t.name,t.helperType&&(i.helperType=t.helperType),t.modeProps)for(var o in t.modeProps)i[o]=t.modeProps[o];return i}var Ye={};function Xe(e,t){U(t,Ye.hasOwnProperty(e)?Ye[e]:Ye[e]={})}function Je(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n={};for(var i in t){var r=t[i];r instanceof Array&&(r=r.concat([])),n[i]=r}return n}function Qe(e,t){for(var n;e.innerMode&&(n=e.innerMode(t))&&n.mode!=e;)t=n.state,e=n.mode;return n||{mode:e,state:t}}function et(e,t,n){return!e.startState||e.startState(t,n)}var tt=function(e,t,n){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n};function nt(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var i=0;;++i){var r=n.children[i],s=r.chunkSize();if(t<s){n=r;break}t-=s}return n.lines[t]}function it(e,t,n){var i=[],r=t.line;return e.iter(t.line,n.line+1,function(e){var s=e.text;r==n.line&&(s=s.slice(0,n.ch)),r==t.line&&(s=s.slice(t.ch)),i.push(s),++r}),i}function rt(e,t,n){var i=[];return e.iter(t,n,function(e){i.push(e.text)}),i}function st(e,t){var n=t-e.height;if(n)for(var i=e;i;i=i.parent)i.height+=n}function ot(e){if(null==e.parent)return null;for(var t=e.parent,n=G(t.lines,e),i=t.parent;i;t=i,i=i.parent)for(var r=0;i.children[r]!=t;++r)n+=i.children[r].chunkSize();return n+t.first}function at(e,t){var n=e.first;e:do{for(var i=0;i<e.children.length;++i){var r=e.children[i],s=r.height;if(t<s){e=r;continue e}t-=s,n+=r.chunkSize()}return n}while(!e.lines);for(var o=0;o<e.lines.length;++o){var a=e.lines[o].height;if(t<a)break;t-=a}return n+o}function lt(e,t){return t>=e.first&&t<e.first+e.size}function ct(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function ht(e,t,n){if(void 0===n&&(n=null),!(this instanceof ht))return new ht(e,t,n);this.line=e,this.ch=t,this.sticky=n}function ut(e,t){return e.line-t.line||e.ch-t.ch}function dt(e,t){return e.sticky==t.sticky&&0==ut(e,t)}function pt(e){return ht(e.line,e.ch)}function ft(e,t){return ut(e,t)<0?t:e}function mt(e,t){return ut(e,t)<0?e:t}function gt(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function vt(e,t){if(t.line<e.first)return ht(e.first,0);var n=e.first+e.size-1;return t.line>n?ht(n,nt(e,n).text.length):yt(t,nt(e,t.line).text.length)}function yt(e,t){var n=e.ch;return null==n||n>t?ht(e.line,t):n<0?ht(e.line,0):e}function bt(e,t){for(var n=[],i=0;i<t.length;i++)n[i]=vt(e,t[i]);return n}tt.prototype.eol=function(){return this.pos>=this.string.length},tt.prototype.sol=function(){return this.pos==this.lineStart},tt.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},tt.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},tt.prototype.eat=function(e){var t=this.string.charAt(this.pos);if("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))return++this.pos,t},tt.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},tt.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},tt.prototype.skipToEnd=function(){this.pos=this.string.length},tt.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},tt.prototype.backUp=function(e){this.pos-=e},tt.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=z(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?z(this.string,this.lineStart,this.tabSize):0)},tt.prototype.indentation=function(){return z(this.string,null,this.tabSize)-(this.lineStart?z(this.string,this.lineStart,this.tabSize):0)},tt.prototype.match=function(e,t,n){if("string"!=typeof e){var i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&!1!==t&&(this.pos+=i[0].length),i)}var r=function(e){return n?e.toLowerCase():e};if(r(this.string.substr(this.pos,e.length))==r(e))return!1!==t&&(this.pos+=e.length),!0},tt.prototype.current=function(){return this.string.slice(this.start,this.pos)},tt.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},tt.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},tt.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};var wt=function(e,t){this.state=e,this.lookAhead=t},xt=function(e,t,n,i){this.state=t,this.doc=e,this.line=n,this.maxLookAhead=i||0,this.baseTokens=null,this.baseTokenPos=1};function Ct(e,t,n,i){var r=[e.state.modeGen],s={};It(e,t.text,e.doc.mode,n,function(e,t){return r.push(e,t)},s,i);for(var o=n.state,a=function(i){n.baseTokens=r;var a=e.state.overlays[i],l=1,c=0;n.state=!0,It(e,t.text,a.mode,n,function(e,t){for(var n=l;c<e;){var i=r[l];i>e&&r.splice(l,1,e,r[l+1],i),l+=2,c=Math.min(e,i)}if(t)if(a.opaque)r.splice(n,l-n,e,"overlay "+t),l=n+2;else for(;n<l;n+=2){var s=r[n+1];r[n+1]=(s?s+" ":"")+"overlay "+t}},s),n.state=o,n.baseTokens=null,n.baseTokenPos=1},l=0;l<e.state.overlays.length;++l)a(l);return{styles:r,classes:s.bgClass||s.textClass?s:null}}function St(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var i=kt(e,ot(t)),r=t.text.length>e.options.maxHighlightLength&&Je(e.doc.mode,i.state),s=Ct(e,t,i);r&&(i.state=r),t.stateAfter=i.save(!r),t.styles=s.styles,s.classes?t.styleClasses=s.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return t.styles}function kt(e,t,n){var i=e.doc,r=e.display;if(!i.mode.startState)return new xt(i,!0,t);var s=_t(e,t,n),o=s>i.first&&nt(i,s-1).stateAfter,a=o?xt.fromSaved(i,o,s):new xt(i,et(i.mode),s);return i.iter(s,t,function(n){Lt(e,n.text,a);var i=a.line;n.stateAfter=i==t-1||i%5==0||i>=r.viewFrom&&i<r.viewTo?a.save():null,a.nextLine()}),n&&(i.modeFrontier=a.line),a}function Lt(e,t,n,i){var r=e.doc.mode,s=new tt(t,e.options.tabSize,n);for(s.start=s.pos=i||0,""==t&&Et(r,n.state);!s.eol();)Pt(r,s,n.state),s.start=s.pos}function Et(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var n=Qe(e,t);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function Pt(e,t,n,i){for(var r=0;r<10;r++){i&&(i[0]=Qe(e,n).mode);var s=e.token(t,n);if(t.pos>t.start)return s}throw new Error("Mode "+e.name+" failed to advance stream.")}xt.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},xt.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},xt.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},xt.fromSaved=function(e,t,n){return t instanceof wt?new xt(e,Je(e.mode,t.state),n,t.lookAhead):new xt(e,Je(e.mode,t),n)},xt.prototype.save=function(e){var t=!1!==e?Je(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new wt(t,this.maxLookAhead):t};var Tt=function(e,t,n){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=n};function At(e,t,n,i){var r,s,o=e.doc,a=o.mode,l=nt(o,(t=vt(o,t)).line),c=kt(e,t.line,n),h=new tt(l.text,e.options.tabSize,c);for(i&&(s=[]);(i||h.pos<t.ch)&&!h.eol();)h.start=h.pos,r=Pt(a,h,c.state),i&&s.push(new Tt(h,r,Je(o.mode,c.state)));return i?s:new Tt(h,r,c.state)}function Mt(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var i=n[1]?"bgClass":"textClass";null==t[i]?t[i]=n[2]:new RegExp("(?:^|\\s)"+n[2]+"(?:$|\\s)").test(t[i])||(t[i]+=" "+n[2])}return e}function It(e,t,n,i,r,s,o){var a=n.flattenSpans;null==a&&(a=e.options.flattenSpans);var l,c=0,h=null,u=new tt(t,e.options.tabSize,i),d=e.options.addModeClass&&[null];for(""==t&&Mt(Et(n,i.state),s);!u.eol();){if(u.pos>e.options.maxHighlightLength?(a=!1,o&&Lt(e,t,i,u.pos),u.pos=t.length,l=null):l=Mt(Pt(n,u,i.state,d),s),d){var p=d[0].name;p&&(l="m-"+(l?p+" "+l:p))}if(!a||h!=l){for(;c<u.start;)r(c=Math.min(u.start,c+5e3),h);h=l}u.start=u.pos}for(;c<u.pos;){var f=Math.min(u.pos,c+5e3);r(f,h),c=f}}function _t(e,t,n){for(var i,r,s=e.doc,o=n?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;a>o;--a){if(a<=s.first)return s.first;var l=nt(s,a-1),c=l.stateAfter;if(c&&(!n||a+(c instanceof wt?c.lookAhead:0)<=s.modeFrontier))return a;var h=z(l.text,null,e.options.tabSize);(null==r||i>h)&&(r=a-1,i=h)}return r}function Ot(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var n=e.first,i=t-1;i>n;i--){var r=nt(e,i).stateAfter;if(r&&(!(r instanceof wt)||i+r.lookAhead<t)){n=i+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,n)}}var Nt=!1,Dt=!1;function Rt(){Nt=!0}function Ft(){Dt=!0}function Bt(e,t,n){this.marker=e,this.from=t,this.to=n}function Vt(e,t){if(e)for(var n=0;n<e.length;++n){var i=e[n];if(i.marker==t)return i}}function jt(e,t){for(var n,i=0;i<e.length;++i)e[i]!=t&&(n||(n=[])).push(e[i]);return n}function Ht(e,t,n){var i=n&&window.WeakSet&&(n.markedSpans||(n.markedSpans=new WeakSet));i&&e.markedSpans&&i.has(e.markedSpans)?e.markedSpans.push(t):(e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],i&&i.add(e.markedSpans)),t.marker.attachLine(e)}function Ut(e,t,n){var i;if(e)for(var r=0;r<e.length;++r){var s=e[r],o=s.marker;if(null==s.from||(o.inclusiveLeft?s.from<=t:s.from<t)||s.from==t&&"bookmark"==o.type&&(!n||!s.marker.insertLeft)){var a=null==s.to||(o.inclusiveRight?s.to>=t:s.to>t);(i||(i=[])).push(new Bt(o,s.from,a?null:s.to))}}return i}function zt(e,t,n){var i;if(e)for(var r=0;r<e.length;++r){var s=e[r],o=s.marker;if(null==s.to||(o.inclusiveRight?s.to>=t:s.to>t)||s.from==t&&"bookmark"==o.type&&(!n||s.marker.insertLeft)){var a=null==s.from||(o.inclusiveLeft?s.from<=t:s.from<t);(i||(i=[])).push(new Bt(o,a?null:s.from-t,null==s.to?null:s.to-t))}}return i}function Wt(e,t){if(t.full)return null;var n=lt(e,t.from.line)&&nt(e,t.from.line).markedSpans,i=lt(e,t.to.line)&&nt(e,t.to.line).markedSpans;if(!n&&!i)return null;var r=t.from.ch,s=t.to.ch,o=0==ut(t.from,t.to),a=Ut(n,r,o),l=zt(i,s,o),c=1==t.text.length,h=ee(t.text).length+(c?r:0);if(a)for(var u=0;u<a.length;++u){var d=a[u];if(null==d.to){var p=Vt(l,d.marker);p?c&&(d.to=null==p.to?null:p.to+h):d.to=r}}if(l)for(var f=0;f<l.length;++f){var m=l[f];null!=m.to&&(m.to+=h),null==m.from?Vt(a,m.marker)||(m.from=h,c&&(a||(a=[])).push(m)):(m.from+=h,c&&(a||(a=[])).push(m))}a&&(a=Gt(a)),l&&l!=a&&(l=Gt(l));var g=[a];if(!c){var v,y=t.text.length-2;if(y>0&&a)for(var b=0;b<a.length;++b)null==a[b].to&&(v||(v=[])).push(new Bt(a[b].marker,null,null));for(var w=0;w<y;++w)g.push(v);g.push(l)}return g}function Gt(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function $t(e,t,n){var i=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||i&&-1!=G(i,n)||(i||(i=[])).push(n)}}),!i)return null;for(var r=[{from:t,to:n}],s=0;s<i.length;++s)for(var o=i[s],a=o.find(0),l=0;l<r.length;++l){var c=r[l];if(!(ut(c.to,a.from)<0||ut(c.from,a.to)>0)){var h=[l,1],u=ut(c.from,a.from),d=ut(c.to,a.to);(u<0||!o.inclusiveLeft&&!u)&&h.push({from:c.from,to:a.from}),(d>0||!o.inclusiveRight&&!d)&&h.push({from:a.to,to:c.to}),r.splice.apply(r,h),l+=h.length-3}}return r}function Zt(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function qt(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function Kt(e){return e.inclusiveLeft?-1:0}function Yt(e){return e.inclusiveRight?1:0}function Xt(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var i=e.find(),r=t.find(),s=ut(i.from,r.from)||Kt(e)-Kt(t);if(s)return-s;var o=ut(i.to,r.to)||Yt(e)-Yt(t);return o||t.id-e.id}function Jt(e,t){var n,i=Dt&&e.markedSpans;if(i)for(var r=void 0,s=0;s<i.length;++s)(r=i[s]).marker.collapsed&&null==(t?r.from:r.to)&&(!n||Xt(n,r.marker)<0)&&(n=r.marker);return n}function Qt(e){return Jt(e,!0)}function en(e){return Jt(e,!1)}function tn(e,t){var n,i=Dt&&e.markedSpans;if(i)for(var r=0;r<i.length;++r){var s=i[r];s.marker.collapsed&&(null==s.from||s.from<t)&&(null==s.to||s.to>t)&&(!n||Xt(n,s.marker)<0)&&(n=s.marker)}return n}function nn(e,t,n,i,r){var s=nt(e,t),o=Dt&&s.markedSpans;if(o)for(var a=0;a<o.length;++a){var l=o[a];if(l.marker.collapsed){var c=l.marker.find(0),h=ut(c.from,n)||Kt(l.marker)-Kt(r),u=ut(c.to,i)||Yt(l.marker)-Yt(r);if(!(h>=0&&u<=0||h<=0&&u>=0)&&(h<=0&&(l.marker.inclusiveRight&&r.inclusiveLeft?ut(c.to,n)>=0:ut(c.to,n)>0)||h>=0&&(l.marker.inclusiveRight&&r.inclusiveLeft?ut(c.from,i)<=0:ut(c.from,i)<0)))return!0}}}function rn(e){for(var t;t=Qt(e);)e=t.find(-1,!0).line;return e}function sn(e){for(var t;t=en(e);)e=t.find(1,!0).line;return e}function on(e){for(var t,n;t=en(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function an(e,t){var n=nt(e,t),i=rn(n);return n==i?t:ot(i)}function ln(e,t){if(t>e.lastLine())return t;var n,i=nt(e,t);if(!cn(e,i))return t;for(;n=en(i);)i=n.find(1,!0).line;return ot(i)+1}function cn(e,t){var n=Dt&&t.markedSpans;if(n)for(var i=void 0,r=0;r<n.length;++r)if((i=n[r]).marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&hn(e,t,i))return!0}}function hn(e,t,n){if(null==n.to){var i=n.marker.find(1,!0);return hn(e,i.line,Vt(i.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var r=void 0,s=0;s<t.markedSpans.length;++s)if((r=t.markedSpans[s]).marker.collapsed&&!r.marker.widgetNode&&r.from==n.to&&(null==r.to||r.to!=n.from)&&(r.marker.inclusiveLeft||n.marker.inclusiveRight)&&hn(e,t,r))return!0}function un(e){for(var t=0,n=(e=rn(e)).parent,i=0;i<n.lines.length;++i){var r=n.lines[i];if(r==e)break;t+=r.height}for(var s=n.parent;s;s=(n=s).parent)for(var o=0;o<s.children.length;++o){var a=s.children[o];if(a==n)break;t+=a.height}return t}function dn(e){if(0==e.height)return 0;for(var t,n=e.text.length,i=e;t=Qt(i);){var r=t.find(0,!0);i=r.from.line,n+=r.from.ch-r.to.ch}for(i=e;t=en(i);){var s=t.find(0,!0);n-=i.text.length-s.from.ch,n+=(i=s.to.line).text.length-s.to.ch}return n}function pn(e){var t=e.display,n=e.doc;t.maxLine=nt(n,n.first),t.maxLineLength=dn(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=dn(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}var fn=function(e,t,n){this.text=e,qt(this,t),this.height=n?n(this):1};function mn(e,t,n,i){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Zt(e),qt(e,n);var r=i?i(e):1;r!=e.height&&st(e,r)}function gn(e){e.parent=null,Zt(e)}fn.prototype.lineNo=function(){return ot(this)},Ee(fn);var vn={},yn={};function bn(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?yn:vn;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function wn(e,t){var n=I("span",null,null,l?"padding-right: .1px":null),i={pre:I("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var r=0;r<=(t.rest?t.rest.length:0);r++){var s=r?t.rest[r-1]:t.line,o=void 0;i.pos=0,i.addToken=Cn,Fe(e.display.measure)&&(o=ve(s,e.doc.direction))&&(i.addToken=kn(i.addToken,o)),i.map=[],En(s,i,St(e,s,t!=e.display.externalMeasured&&ot(s))),s.styleClasses&&(s.styleClasses.bgClass&&(i.bgClass=D(s.styleClasses.bgClass,i.bgClass||"")),s.styleClasses.textClass&&(i.textClass=D(s.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(Re(e.display.measure))),0==r?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(l){var a=i.content.lastChild;(/\bcm-tab\b/.test(a.className)||a.querySelector&&a.querySelector(".cm-tab"))&&(i.content.className="cm-tab-wrap-hack")}return Ce(e,"renderLine",e,t.line,i.pre),i.pre.className&&(i.textClass=D(i.pre.className,i.textClass||"")),i}function xn(e){var t=M("span","","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function Cn(e,t,n,i,r,s,l){if(t){var c,h=e.splitSpaces?Sn(t,e.trailingSpace):t,u=e.cm.state.specialChars,d=!1;if(u.test(t)){c=document.createDocumentFragment();for(var p=0;;){u.lastIndex=p;var f=u.exec(t),m=f?f.index-p:t.length-p;if(m){var g=document.createTextNode(h.slice(p,p+m));o&&a<9?c.appendChild(M("span",[g])):c.appendChild(g),e.map.push(e.pos,e.pos+m,g),e.col+=m,e.pos+=m}if(!f)break;p+=m+1;var v=void 0;if("\t"==f[0]){var y=e.cm.options.tabSize,b=y-e.col%y;(v=c.appendChild(M("span",Q(b),"cm-tab"))).setAttribute("role","presentation"),v.setAttribute("cm-text","\t"),e.col+=b}else"\r"==f[0]||"\n"==f[0]?((v=c.appendChild(M("span","\r"==f[0]?"":"","cm-invalidchar"))).setAttribute("cm-text",f[0]),e.col+=1):((v=e.cm.options.specialCharPlaceholder(f[0])).setAttribute("cm-text",f[0]),o&&a<9?c.appendChild(M("span",[v])):c.appendChild(v),e.col+=1);e.map.push(e.pos,e.pos+1,v),e.pos++}}else e.col+=t.length,c=document.createTextNode(h),e.map.push(e.pos,e.pos+t.length,c),o&&a<9&&(d=!0),e.pos+=t.length;if(e.trailingSpace=32==h.charCodeAt(t.length-1),n||i||r||d||s||l){var w=n||"";i&&(w+=i),r&&(w+=r);var x=M("span",[c],w,s);if(l)for(var C in l)l.hasOwnProperty(C)&&"style"!=C&&"class"!=C&&x.setAttribute(C,l[C]);return e.content.appendChild(x)}e.content.appendChild(c)}}function Sn(e,t){if(e.length>1&&!/  /.test(e))return e;for(var n=t,i="",r=0;r<e.length;r++){var s=e.charAt(r);" "!=s||!n||r!=e.length-1&&32!=e.charCodeAt(r+1)||(s=""),i+=s,n=" "==s}return i}function kn(e,t){return function(n,i,r,s,o,a,l){r=r?r+" cm-force-border":"cm-force-border";for(var c=n.pos,h=c+i.length;;){for(var u=void 0,d=0;d<t.length&&!((u=t[d]).to>c&&u.from<=c);d++);if(u.to>=h)return e(n,i,r,s,o,a,l);e(n,i.slice(0,u.to-c),r,s,null,a,l),s=null,i=i.slice(u.to-c),c=u.to}}}function Ln(e,t,n,i){var r=!i&&n.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!i&&e.cm.display.input.needsContentAttribute&&(r||(r=e.content.appendChild(document.createElement("span"))),r.setAttribute("cm-marker",n.id)),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t,e.trailingSpace=!1}function En(e,t,n){var i=e.markedSpans,r=e.text,s=0;if(i)for(var o,a,l,c,h,u,d,p=r.length,f=0,m=1,g="",v=0;;){if(v==f){l=c=h=a="",d=null,u=null,v=1/0;for(var y=[],b=void 0,w=0;w<i.length;++w){var x=i[w],C=x.marker;if("bookmark"==C.type&&x.from==f&&C.widgetNode)y.push(C);else if(x.from<=f&&(null==x.to||x.to>f||C.collapsed&&x.to==f&&x.from==f)){if(null!=x.to&&x.to!=f&&v>x.to&&(v=x.to,c=""),C.className&&(l+=" "+C.className),C.css&&(a=(a?a+";":"")+C.css),C.startStyle&&x.from==f&&(h+=" "+C.startStyle),C.endStyle&&x.to==v&&(b||(b=[])).push(C.endStyle,x.to),C.title&&((d||(d={})).title=C.title),C.attributes)for(var S in C.attributes)(d||(d={}))[S]=C.attributes[S];C.collapsed&&(!u||Xt(u.marker,C)<0)&&(u=x)}else x.from>f&&v>x.from&&(v=x.from)}if(b)for(var k=0;k<b.length;k+=2)b[k+1]==v&&(c+=" "+b[k]);if(!u||u.from==f)for(var L=0;L<y.length;++L)Ln(t,0,y[L]);if(u&&(u.from||0)==f){if(Ln(t,(null==u.to?p+1:u.to)-f,u.marker,null==u.from),null==u.to)return;u.to==f&&(u=!1)}}if(f>=p)break;for(var E=Math.min(p,v);;){if(g){var P=f+g.length;if(!u){var T=P>E?g.slice(0,E-f):g;t.addToken(t,T,o?o+l:l,h,f+T.length==v?c:"",a,d)}if(P>=E){g=g.slice(E-f),f=E;break}f=P,h=""}g=r.slice(s,s=n[m++]),o=bn(n[m++],t.cm.options)}}else for(var A=1;A<n.length;A+=2)t.addToken(t,r.slice(s,s=n[A]),bn(n[A+1],t.cm.options))}function Pn(e,t,n){this.line=t,this.rest=on(t),this.size=this.rest?ot(ee(this.rest))-n+1:1,this.node=this.text=null,this.hidden=cn(e,t)}function Tn(e,t,n){for(var i,r=[],s=t;s<n;s=i){var o=new Pn(e.doc,nt(e.doc,s),s);i=s+o.size,r.push(o)}return r}var An=null;function Mn(e){An?An.ops.push(e):e.ownsGroup=An={ops:[e],delayedCallbacks:[]}}function In(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var i=0;i<e.ops.length;i++){var r=e.ops[i];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++].call(null,r.cm)}}while(n<t.length)}function _n(e,t){var n=e.ownsGroup;if(n)try{In(n)}finally{An=null,t(n)}}var On=null;function Nn(e,t){var n=we(e,t);if(n.length){var i,r=Array.prototype.slice.call(arguments,2);An?i=An.delayedCallbacks:On?i=On:(i=On=[],setTimeout(Dn,0));for(var s=function(e){i.push(function(){return n[e].apply(null,r)})},o=0;o<n.length;++o)s(o)}}function Dn(){var e=On;On=null;for(var t=0;t<e.length;++t)e[t]()}function Rn(e,t,n,i){for(var r=0;r<t.changes.length;r++){var s=t.changes[r];"text"==s?jn(e,t):"gutter"==s?Un(e,t,n,i):"class"==s?Hn(e,t):"widget"==s&&zn(e,t,i)}t.changes=null}function Fn(e){return e.node==e.text&&(e.node=M("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),o&&a<8&&(e.node.style.zIndex=2)),e.node}function Bn(e,t){var n=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(n&&(n+=" CodeMirror-linebackground"),t.background)n?t.background.className=n:(t.background.parentNode.removeChild(t.background),t.background=null);else if(n){var i=Fn(t);t.background=i.insertBefore(M("div",null,n),i.firstChild),e.display.input.setUneditable(t.background)}}function Vn(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):wn(e,t)}function jn(e,t){var n=t.text.className,i=Vn(e,t);t.text==t.node&&(t.node=i.pre),t.text.parentNode.replaceChild(i.pre,t.text),t.text=i.pre,i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,Hn(e,t)):n&&(t.text.className=n)}function Hn(e,t){Bn(e,t),t.line.wrapClass?Fn(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var n=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=n||""}function Un(e,t,n,i){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var r=Fn(t);t.gutterBackground=M("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),r.insertBefore(t.gutterBackground,t.text)}var s=t.line.gutterMarkers;if(e.options.lineNumbers||s){var o=Fn(t),a=t.gutter=M("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px");if(a.setAttribute("aria-hidden","true"),e.display.input.setUneditable(a),o.insertBefore(a,t.text),t.line.gutterClass&&(a.className+=" "+t.line.gutterClass),!e.options.lineNumbers||s&&s["CodeMirror-linenumbers"]||(t.lineNumber=a.appendChild(M("div",ct(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),s)for(var l=0;l<e.display.gutterSpecs.length;++l){var c=e.display.gutterSpecs[l].className,h=s.hasOwnProperty(c)&&s[c];h&&a.appendChild(M("div",[h],"CodeMirror-gutter-elt","left: "+i.gutterLeft[c]+"px; width: "+i.gutterWidth[c]+"px"))}}}function zn(e,t,n){t.alignable&&(t.alignable=null);for(var i=L("CodeMirror-linewidget"),r=t.node.firstChild,s=void 0;r;r=s)s=r.nextSibling,i.test(r.className)&&t.node.removeChild(r);Gn(e,t,n)}function Wn(e,t,n,i){var r=Vn(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),Hn(e,t),Un(e,t,n,i),Gn(e,t,i),t.node}function Gn(e,t,n){if($n(e,t.line,t,n,!0),t.rest)for(var i=0;i<t.rest.length;i++)$n(e,t.rest[i],t,n,!1)}function $n(e,t,n,i,r){if(t.widgets)for(var s=Fn(n),o=0,a=t.widgets;o<a.length;++o){var l=a[o],c=M("div",[l.node],"CodeMirror-linewidget"+(l.className?" "+l.className:""));l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),Zn(l,c,n,i),e.display.input.setUneditable(c),r&&l.above?s.insertBefore(c,n.gutter||n.text):s.appendChild(c),Nn(l,"redraw")}}function Zn(e,t,n,i){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var r=i.wrapperWidth;t.style.left=i.fixedPos+"px",e.coverGutter||(r-=i.gutterTotalWidth,t.style.paddingLeft=i.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-i.gutterTotalWidth+"px"))}function qn(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!_(document.body,e.node)){var n="position: relative;";e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),A(t.display.measure,M("div",[e.node],null,n))}return e.height=e.node.parentNode.offsetHeight}function Kn(e,t){for(var n=Ie(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}function Yn(e){return e.lineSpace.offsetTop}function Xn(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Jn(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=A(e.measure,M("pre","x","CodeMirror-line-like")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,i={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(i.left)||isNaN(i.right)||(e.cachedPaddingH=i),i}function Qn(e){return $-e.display.nativeBarWidth}function ei(e){return e.display.scroller.clientWidth-Qn(e)-e.display.barWidth}function ti(e){return e.display.scroller.clientHeight-Qn(e)-e.display.barHeight}function ni(e,t,n){var i=e.options.lineWrapping,r=i&&ei(e);if(!t.measure.heights||i&&t.measure.width!=r){var s=t.measure.heights=[];if(i){t.measure.width=r;for(var o=t.text.firstChild.getClientRects(),a=0;a<o.length-1;a++){var l=o[a],c=o[a+1];Math.abs(l.bottom-c.bottom)>2&&s.push((l.bottom+c.top)/2-n.top)}}s.push(n.bottom-n.top)}}function ii(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(var r=0;r<e.rest.length;r++)if(ot(e.rest[r])>n)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!0}}}function ri(e,t){var n=ot(t=rn(t)),i=e.display.externalMeasured=new Pn(e.doc,t,n);i.lineN=n;var r=i.built=wn(e,i);return i.text=r.pre,A(e.display.lineMeasure,r.pre),i}function si(e,t,n,i){return li(e,ai(e,t),n,i)}function oi(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Hi(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function ai(e,t){var n=ot(t),i=oi(e,n);i&&!i.text?i=null:i&&i.changes&&(Rn(e,i,n,Ri(e)),e.curOp.forceUpdate=!0),i||(i=ri(e,t));var r=ii(i,t,n);return{line:t,view:i,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function li(e,t,n,i,r){t.before&&(n=-1);var s,o=n+(i||"");return t.cache.hasOwnProperty(o)?s=t.cache[o]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(ni(e,t.view,t.rect),t.hasHeights=!0),(s=pi(e,t,n,i)).bogus||(t.cache[o]=s)),{left:s.left,right:s.right,top:r?s.rtop:s.top,bottom:r?s.rbottom:s.bottom}}var ci,hi={left:0,right:0,top:0,bottom:0};function ui(e,t,n){for(var i,r,s,o,a,l,c=0;c<e.length;c+=3)if(a=e[c],l=e[c+1],t<a?(r=0,s=1,o="left"):t<l?s=1+(r=t-a):(c==e.length-3||t==l&&e[c+3]>t)&&(r=(s=l-a)-1,t>=l&&(o="right")),null!=r){if(i=e[c+2],a==l&&n==(i.insertLeft?"left":"right")&&(o=n),"left"==n&&0==r)for(;c&&e[c-2]==e[c-3]&&e[c-1].insertLeft;)i=e[2+(c-=3)],o="left";if("right"==n&&r==l-a)for(;c<e.length-3&&e[c+3]==e[c+4]&&!e[c+5].insertLeft;)i=e[(c+=3)+2],o="right";break}return{node:i,start:r,end:s,collapse:o,coverStart:a,coverEnd:l}}function di(e,t){var n=hi;if("left"==t)for(var i=0;i<e.length&&(n=e[i]).left==n.right;i++);else for(var r=e.length-1;r>=0&&(n=e[r]).left==n.right;r--);return n}function pi(e,t,n,i){var r,s=ui(t.map,n,i),l=s.node,c=s.start,h=s.end,u=s.collapse;if(3==l.nodeType){for(var d=0;d<4;d++){for(;c&&he(t.line.text.charAt(s.coverStart+c));)--c;for(;s.coverStart+h<s.coverEnd&&he(t.line.text.charAt(s.coverStart+h));)++h;if((r=o&&a<9&&0==c&&h==s.coverEnd-s.coverStart?l.parentNode.getBoundingClientRect():di(E(l,c,h).getClientRects(),i)).left||r.right||0==c)break;h=c,c-=1,u="right"}o&&a<11&&(r=fi(e.display.measure,r))}else{var p;c>0&&(u=i="right"),r=e.options.lineWrapping&&(p=l.getClientRects()).length>1?p["right"==i?p.length-1:0]:l.getBoundingClientRect()}if(o&&a<9&&!c&&(!r||!r.left&&!r.right)){var f=l.parentNode.getClientRects()[0];r=f?{left:f.left,right:f.left+Di(e.display),top:f.top,bottom:f.bottom}:hi}for(var m=r.top-t.rect.top,g=r.bottom-t.rect.top,v=(m+g)/2,y=t.view.measure.heights,b=0;b<y.length-1&&!(v<y[b]);b++);var w=b?y[b-1]:0,x=y[b],C={left:("right"==u?r.right:r.left)-t.rect.left,right:("left"==u?r.left:r.right)-t.rect.left,top:w,bottom:x};return r.left||r.right||(C.bogus=!0),e.options.singleCursorHeightPerLine||(C.rtop=m,C.rbottom=g),C}function fi(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!ze(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*i,bottom:t.bottom*i}}function mi(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function gi(e){e.display.externalMeasure=null,T(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)mi(e.display.view[t])}function vi(e){gi(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function yi(e){return h&&v?-(e.body.getBoundingClientRect().left-parseInt(getComputedStyle(e.body).marginLeft)):e.defaultView.pageXOffset||(e.documentElement||e.body).scrollLeft}function bi(e){return h&&v?-(e.body.getBoundingClientRect().top-parseInt(getComputedStyle(e.body).marginTop)):e.defaultView.pageYOffset||(e.documentElement||e.body).scrollTop}function wi(e){var t=rn(e).widgets,n=0;if(t)for(var i=0;i<t.length;++i)t[i].above&&(n+=qn(t[i]));return n}function xi(e,t,n,i,r){if(!r){var s=wi(t);n.top+=s,n.bottom+=s}if("line"==i)return n;i||(i="local");var o=un(t);if("local"==i?o+=Yn(e.display):o-=e.display.viewOffset,"page"==i||"window"==i){var a=e.display.lineSpace.getBoundingClientRect();o+=a.top+("window"==i?0:bi(F(e)));var l=a.left+("window"==i?0:yi(F(e)));n.left+=l,n.right+=l}return n.top+=o,n.bottom+=o,n}function Ci(e,t,n){if("div"==n)return t;var i=t.left,r=t.top;if("page"==n)i-=yi(F(e)),r-=bi(F(e));else if("local"==n||!n){var s=e.display.sizer.getBoundingClientRect();i+=s.left,r+=s.top}var o=e.display.lineSpace.getBoundingClientRect();return{left:i-o.left,top:r-o.top}}function Si(e,t,n,i,r){return i||(i=nt(e.doc,t.line)),xi(e,i,si(e,i,t.ch,r),n)}function ki(e,t,n,i,r,s){function o(t,o){var a=li(e,r,t,o?"right":"left",s);return o?a.left=a.right:a.right=a.left,xi(e,i,a,n)}i=i||nt(e.doc,t.line),r||(r=ai(e,i));var a=ve(i,e.doc.direction),l=t.ch,c=t.sticky;if(l>=i.text.length?(l=i.text.length,c="before"):l<=0&&(l=0,c="after"),!a)return o("before"==c?l-1:l,"before"==c);function h(e,t,n){return o(n?e-1:e,1==a[t].level!=n)}var u=me(a,l,c),d=fe,p=h(l,u,"before"==c);return null!=d&&(p.other=h(l,d,"before"!=c)),p}function Li(e,t){var n=0;t=vt(e.doc,t),e.options.lineWrapping||(n=Di(e.display)*t.ch);var i=nt(e.doc,t.line),r=un(i)+Yn(e.display);return{left:n,right:n,top:r,bottom:r+i.height}}function Ei(e,t,n,i,r){var s=ht(e,t,n);return s.xRel=r,i&&(s.outside=i),s}function Pi(e,t,n){var i=e.doc;if((n+=e.display.viewOffset)<0)return Ei(i.first,0,null,-1,-1);var r=at(i,n),s=i.first+i.size-1;if(r>s)return Ei(i.first+i.size-1,nt(i,s).text.length,null,1,1);t<0&&(t=0);for(var o=nt(i,r);;){var a=Ii(e,o,r,t,n),l=tn(o,a.ch+(a.xRel>0||a.outside>0?1:0));if(!l)return a;var c=l.find(1);if(c.line==r)return c;o=nt(i,r=c.line)}}function Ti(e,t,n,i){i-=wi(t);var r=t.text.length,s=de(function(t){return li(e,n,t-1).bottom<=i},r,0);return{begin:s,end:r=de(function(t){return li(e,n,t).top>i},s,r)}}function Ai(e,t,n,i){return n||(n=ai(e,t)),Ti(e,t,n,xi(e,t,li(e,n,i),"line").top)}function Mi(e,t,n,i){return!(e.bottom<=n)&&(e.top>n||(i?e.left:e.right)>t)}function Ii(e,t,n,i,r){r-=un(t);var s=ai(e,t),o=wi(t),a=0,l=t.text.length,c=!0,h=ve(t,e.doc.direction);if(h){var u=(e.options.lineWrapping?Oi:_i)(e,t,n,s,h,i,r);a=(c=1!=u.level)?u.from:u.to-1,l=c?u.to:u.from-1}var d,p,f=null,m=null,g=de(function(t){var n=li(e,s,t);return n.top+=o,n.bottom+=o,!!Mi(n,i,r,!1)&&(n.top<=r&&n.left<=i&&(f=t,m=n),!0)},a,l),v=!1;if(m){var y=i-m.left<m.right-i,b=y==c;g=f+(b?0:1),p=b?"after":"before",d=y?m.left:m.right}else{c||g!=l&&g!=a||g++,p=0==g?"after":g==t.text.length?"before":li(e,s,g-(c?1:0)).bottom+o<=r==c?"after":"before";var w=ki(e,ht(n,g,p),"line",t,s);d=w.left,v=r<w.top?-1:r>=w.bottom?1:0}return Ei(n,g=ue(t.text,g,1),p,v,i-d)}function _i(e,t,n,i,r,s,o){var a=de(function(a){var l=r[a],c=1!=l.level;return Mi(ki(e,ht(n,c?l.to:l.from,c?"before":"after"),"line",t,i),s,o,!0)},0,r.length-1),l=r[a];if(a>0){var c=1!=l.level,h=ki(e,ht(n,c?l.from:l.to,c?"after":"before"),"line",t,i);Mi(h,s,o,!0)&&h.top>o&&(l=r[a-1])}return l}function Oi(e,t,n,i,r,s,o){var a=Ti(e,t,i,o),l=a.begin,c=a.end;/\s/.test(t.text.charAt(c-1))&&c--;for(var h=null,u=null,d=0;d<r.length;d++){var p=r[d];if(!(p.from>=c||p.to<=l)){var f=li(e,i,1!=p.level?Math.min(c,p.to)-1:Math.max(l,p.from)).right,m=f<s?s-f+1e9:f-s;(!h||u>m)&&(h=p,u=m)}}return h||(h=r[r.length-1]),h.from<l&&(h={from:l,to:h.to,level:h.level}),h.to>c&&(h={from:h.from,to:c,level:h.level}),h}function Ni(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==ci){ci=M("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)ci.appendChild(document.createTextNode("x")),ci.appendChild(M("br"));ci.appendChild(document.createTextNode("x"))}A(e.measure,ci);var n=ci.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),T(e.measure),n||1}function Di(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=M("span","xxxxxxxxxx"),n=M("pre",[t],"CodeMirror-line-like");A(e.measure,n);var i=t.getBoundingClientRect(),r=(i.right-i.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}function Ri(e){for(var t=e.display,n={},i={},r=t.gutters.clientLeft,s=t.gutters.firstChild,o=0;s;s=s.nextSibling,++o){var a=e.display.gutterSpecs[o].className;n[a]=s.offsetLeft+s.clientLeft+r,i[a]=s.clientWidth}return{fixedPos:Fi(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:i,wrapperWidth:t.wrapper.clientWidth}}function Fi(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Bi(e){var t=Ni(e.display),n=e.options.lineWrapping,i=n&&Math.max(5,e.display.scroller.clientWidth/Di(e.display)-3);return function(r){if(cn(e.doc,r))return 0;var s=0;if(r.widgets)for(var o=0;o<r.widgets.length;o++)r.widgets[o].height&&(s+=r.widgets[o].height);return n?s+(Math.ceil(r.text.length/i)||1)*t:s+t}}function Vi(e){var t=e.doc,n=Bi(e);t.iter(function(e){var t=n(e);t!=e.height&&st(e,t)})}function ji(e,t,n,i){var r=e.display;if(!n&&"true"==Ie(t).getAttribute("cm-not-content"))return null;var s,o,a=r.lineSpace.getBoundingClientRect();try{s=t.clientX-a.left,o=t.clientY-a.top}catch(u){return null}var l,c=Pi(e,s,o);if(i&&c.xRel>0&&(l=nt(e.doc,c.line).text).length==c.ch){var h=z(l,l.length,e.options.tabSize)-l.length;c=ht(c.line,Math.max(0,Math.round((s-Jn(e.display).left)/Di(e.display))-h))}return c}function Hi(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var n=e.display.view,i=0;i<n.length;i++)if((t-=n[i].size)<0)return i}function Ui(e,t,n,i){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),i||(i=0);var r=e.display;if(i&&n<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)Dt&&an(e.doc,t)<r.viewTo&&Wi(e);else if(n<=r.viewFrom)Dt&&ln(e.doc,n+i)>r.viewFrom?Wi(e):(r.viewFrom+=i,r.viewTo+=i);else if(t<=r.viewFrom&&n>=r.viewTo)Wi(e);else if(t<=r.viewFrom){var s=Gi(e,n,n+i,1);s?(r.view=r.view.slice(s.index),r.viewFrom=s.lineN,r.viewTo+=i):Wi(e)}else if(n>=r.viewTo){var o=Gi(e,t,t,-1);o?(r.view=r.view.slice(0,o.index),r.viewTo=o.lineN):Wi(e)}else{var a=Gi(e,t,t,-1),l=Gi(e,n,n+i,1);a&&l?(r.view=r.view.slice(0,a.index).concat(Tn(e,a.lineN,l.lineN)).concat(r.view.slice(l.index)),r.viewTo+=i):Wi(e)}var c=r.externalMeasured;c&&(n<c.lineN?c.lineN+=i:t<c.lineN+c.size&&(r.externalMeasured=null))}function zi(e,t,n){e.curOp.viewChanged=!0;var i=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(i.externalMeasured=null),!(t<i.viewFrom||t>=i.viewTo)){var s=i.view[Hi(e,t)];if(null!=s.node){var o=s.changes||(s.changes=[]);-1==G(o,n)&&o.push(n)}}}function Wi(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Gi(e,t,n,i){var r,s=Hi(e,t),o=e.display.view;if(!Dt||n==e.doc.first+e.doc.size)return{index:s,lineN:n};for(var a=e.display.viewFrom,l=0;l<s;l++)a+=o[l].size;if(a!=t){if(i>0){if(s==o.length-1)return null;r=a+o[s].size-t,s++}else r=a-t;t+=r,n+=r}for(;an(e.doc,n)!=n;){if(s==(i<0?0:o.length-1))return null;n+=i*o[s-(i<0?1:0)].size,s+=i}return{index:s,lineN:n}}function $i(e,t,n){var i=e.display;0==i.view.length||t>=i.viewTo||n<=i.viewFrom?(i.view=Tn(e,t,n),i.viewFrom=t):(i.viewFrom>t?i.view=Tn(e,t,i.viewFrom).concat(i.view):i.viewFrom<t&&(i.view=i.view.slice(Hi(e,t))),i.viewFrom=t,i.viewTo<n?i.view=i.view.concat(Tn(e,i.viewTo,n)):i.viewTo>n&&(i.view=i.view.slice(0,Hi(e,n)))),i.viewTo=n}function Zi(e){for(var t=e.display.view,n=0,i=0;i<t.length;i++){var r=t[i];r.hidden||r.node&&!r.changes||++n}return n}function qi(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Ki(e,t){void 0===t&&(t=!0);var n=e.doc,i={},r=i.cursors=document.createDocumentFragment(),s=i.selection=document.createDocumentFragment(),o=e.options.$customCursor;o&&(t=!0);for(var a=0;a<n.sel.ranges.length;a++)if(t||a!=n.sel.primIndex){var l=n.sel.ranges[a];if(!(l.from().line>=e.display.viewTo||l.to().line<e.display.viewFrom)){var c=l.empty();if(o){var h=o(e,l);h&&Yi(e,h,r)}else(c||e.options.showCursorWhenSelecting)&&Yi(e,l.head,r);c||Ji(e,l,s)}}return i}function Yi(e,t,n){var i=ki(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),r=n.appendChild(M("div","","CodeMirror-cursor"));if(r.style.left=i.left+"px",r.style.top=i.top+"px",r.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)){var s=Si(e,t,"div",null,null),o=s.right-s.left;r.style.width=(o>0?o:e.defaultCharWidth())+"px"}if(i.other){var a=n.appendChild(M("div","","CodeMirror-cursor CodeMirror-secondarycursor"));a.style.display="",a.style.left=i.other.left+"px",a.style.top=i.other.top+"px",a.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function Xi(e,t){return e.top-t.top||e.left-t.left}function Ji(e,t,n){var i=e.display,r=e.doc,s=document.createDocumentFragment(),o=Jn(e.display),a=o.left,l=Math.max(i.sizerWidth,ei(e)-i.sizer.offsetLeft)-o.right,c="ltr"==r.direction;function h(e,t,n,i){t<0&&(t=0),t=Math.round(t),i=Math.round(i),s.appendChild(M("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==n?l-e:n)+"px;\n                             height: "+(i-t)+"px"))}function u(t,n,i){var s,o,u=nt(r,t),d=u.text.length;function p(n,i){return Si(e,ht(t,n),"div",u,i)}function f(t,n,i){var r=Ai(e,u,null,t),s="ltr"==n==("after"==i)?"left":"right";return p("after"==i?r.begin:r.end-(/\s/.test(u.text.charAt(r.end-1))?2:1),s)[s]}var m=ve(u,r.direction);return pe(m,n||0,null==i?d:i,function(e,t,r,u){var g="ltr"==r,v=p(e,g?"left":"right"),y=p(t-1,g?"right":"left"),b=null==n&&0==e,w=null==i&&t==d,x=0==u,C=!m||u==m.length-1;if(y.top-v.top<=3){var S=(c?w:b)&&C,k=(c?b:w)&&x?a:(g?v:y).left,L=S?l:(g?y:v).right;h(k,v.top,L-k,v.bottom)}else{var E,P,T,A;g?(E=c&&b&&x?a:v.left,P=c?l:f(e,r,"before"),T=c?a:f(t,r,"after"),A=c&&w&&C?l:y.right):(E=c?f(e,r,"before"):a,P=!c&&b&&x?l:v.right,T=!c&&w&&C?a:y.left,A=c?f(t,r,"after"):l),h(E,v.top,P-E,v.bottom),v.bottom<y.top&&h(a,v.bottom,null,y.top),h(T,y.top,A-T,y.bottom)}(!s||Xi(v,s)<0)&&(s=v),Xi(y,s)<0&&(s=y),(!o||Xi(v,o)<0)&&(o=v),Xi(y,o)<0&&(o=y)}),{start:s,end:o}}var d=t.from(),p=t.to();if(d.line==p.line)u(d.line,d.ch,p.ch);else{var f=nt(r,d.line),m=nt(r,p.line),g=rn(f)==rn(m),v=u(d.line,d.ch,g?f.text.length+1:null).end,y=u(p.line,g?0:null,p.ch).start;g&&(v.top<y.top-2?(h(v.right,v.top,null,v.bottom),h(a,y.top,y.left,y.bottom)):h(v.right,v.top,y.left-v.right,v.bottom)),v.bottom<y.top&&h(a,v.bottom,null,y.top)}n.appendChild(s)}function Qi(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){e.hasFocus()||ir(e),t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function er(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||nr(e))}function tr(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&ir(e))},100)}function nr(e,t){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(Ce(e,"focus",e,t),e.state.focused=!0,N(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),l&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Qi(e))}function ir(e,t){e.state.delayingBlurEvent||(e.state.focused&&(Ce(e,"blur",e,t),e.state.focused=!1,P(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function rr(e){for(var t=e.display,n=t.lineDiv.offsetTop,i=Math.max(0,t.scroller.getBoundingClientRect().top),r=t.lineDiv.getBoundingClientRect().top,s=0,l=0;l<t.view.length;l++){var c=t.view[l],h=e.options.lineWrapping,u=void 0,d=0;if(!c.hidden){if(r+=c.line.height,o&&a<8){var p=c.node.offsetTop+c.node.offsetHeight;u=p-n,n=p}else{var f=c.node.getBoundingClientRect();u=f.bottom-f.top,!h&&c.text.firstChild&&(d=c.text.firstChild.getBoundingClientRect().right-f.left-1)}var m=c.line.height-u;if((m>.005||m<-.005)&&(r<i&&(s-=m),st(c.line,u),sr(c.line),c.rest))for(var g=0;g<c.rest.length;g++)sr(c.rest[g]);if(d>e.display.sizerWidth){var v=Math.ceil(d/Di(e.display));v>e.display.maxLineLength&&(e.display.maxLineLength=v,e.display.maxLine=c.line,e.display.maxLineChanged=!0)}}}Math.abs(s)>2&&(t.scroller.scrollTop+=s)}function sr(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var n=e.widgets[t],i=n.node.parentNode;i&&(n.height=i.offsetHeight)}}function or(e,t,n){var i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;i=Math.floor(i-Yn(e));var r=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,s=at(t,i),o=at(t,r);if(n&&n.ensure){var a=n.ensure.from.line,l=n.ensure.to.line;a<s?(s=a,o=at(t,un(nt(t,a))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=o&&(s=at(t,un(nt(t,l))-e.wrapper.clientHeight),o=l)}return{from:s,to:Math.max(o,s+1)}}function ar(e,t){if(!Se(e,"scrollCursorIntoView")){var n=e.display,i=n.sizer.getBoundingClientRect(),r=null,s=n.wrapper.ownerDocument;if(t.top+i.top<0?r=!0:t.bottom+i.top>(s.defaultView.innerHeight||s.documentElement.clientHeight)&&(r=!1),null!=r&&!m){var o=M("div","",null,"position: absolute;\n                         top: "+(t.top-n.viewOffset-Yn(e.display))+"px;\n                         height: "+(t.bottom-t.top+Qn(e)+n.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(r),e.display.lineSpace.removeChild(o)}}}function lr(e,t,n,i){var r;null==i&&(i=0),e.options.lineWrapping||t!=n||(n="before"==t.sticky?ht(t.line,t.ch+1,"before"):t,t=t.ch?ht(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t);for(var s=0;s<5;s++){var o=!1,a=ki(e,t),l=n&&n!=t?ki(e,n):a,c=hr(e,r={left:Math.min(a.left,l.left),top:Math.min(a.top,l.top)-i,right:Math.max(a.left,l.left),bottom:Math.max(a.bottom,l.bottom)+i}),h=e.doc.scrollTop,u=e.doc.scrollLeft;if(null!=c.scrollTop&&(vr(e,c.scrollTop),Math.abs(e.doc.scrollTop-h)>1&&(o=!0)),null!=c.scrollLeft&&(br(e,c.scrollLeft),Math.abs(e.doc.scrollLeft-u)>1&&(o=!0)),!o)break}return r}function cr(e,t){var n=hr(e,t);null!=n.scrollTop&&vr(e,n.scrollTop),null!=n.scrollLeft&&br(e,n.scrollLeft)}function hr(e,t){var n=e.display,i=Ni(e.display);t.top<0&&(t.top=0);var r=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:n.scroller.scrollTop,s=ti(e),o={};t.bottom-t.top>s&&(t.bottom=t.top+s);var a=e.doc.height+Xn(n),l=t.top<i,c=t.bottom>a-i;if(t.top<r)o.scrollTop=l?0:t.top;else if(t.bottom>r+s){var h=Math.min(t.top,(c?a:t.bottom)-s);h!=r&&(o.scrollTop=h)}var u=e.options.fixedGutter?0:n.gutters.offsetWidth,d=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:n.scroller.scrollLeft-u,p=ei(e)-n.gutters.offsetWidth,f=t.right-t.left>p;return f&&(t.right=t.left+p),t.left<10?o.scrollLeft=0:t.left<d?o.scrollLeft=Math.max(0,t.left+u-(f?0:10)):t.right>p+d-3&&(o.scrollLeft=t.right+(f?0:10)-p),o}function ur(e,t){null!=t&&(mr(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+t)}function dr(e){mr(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function pr(e,t,n){null==t&&null==n||mr(e),null!=t&&(e.curOp.scrollLeft=t),null!=n&&(e.curOp.scrollTop=n)}function fr(e,t){mr(e),e.curOp.scrollToPos=t}function mr(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,gr(e,Li(e,t.from),Li(e,t.to),t.margin))}function gr(e,t,n,i){var r=hr(e,{left:Math.min(t.left,n.left),top:Math.min(t.top,n.top)-i,right:Math.max(t.right,n.right),bottom:Math.max(t.bottom,n.bottom)+i});pr(e,r.scrollLeft,r.scrollTop)}function vr(e,t){Math.abs(e.doc.scrollTop-t)<2||(n||qr(e,{top:t}),yr(e,t,!0),n&&qr(e),jr(e,100))}function yr(e,t,n){t=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t)),(e.display.scroller.scrollTop!=t||n)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function br(e,t,n,i){t=Math.max(0,Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!i||(e.doc.scrollLeft=t,Jr(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function wr(e){var t=e.display,n=t.gutters.offsetWidth,i=Math.round(e.doc.height+Xn(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:i,scrollHeight:i+Qn(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}var xr=function(e,t,n){this.cm=n;var i=this.vert=M("div",[M("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),r=this.horiz=M("div",[M("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");i.tabIndex=r.tabIndex=-1,e(i),e(r),be(i,"scroll",function(){i.clientHeight&&t(i.scrollTop,"vertical")}),be(r,"scroll",function(){r.clientWidth&&t(r.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,o&&a<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};xr.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?i+"px":"0";var r=e.viewHeight-(t?i:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+r)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?i+"px":"0",this.horiz.style.left=e.barLeft+"px";var s=e.viewWidth-e.barLeft-(n?i:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+s)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?i:0,bottom:t?i:0}},xr.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},xr.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},xr.prototype.zeroWidthHack=function(){var e=b&&!f?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.visibility=this.vert.style.visibility="hidden",this.disableHoriz=new W,this.disableVert=new W},xr.prototype.enableZeroWidthBar=function(e,t,n){function i(){var r=e.getBoundingClientRect();("vert"==n?document.elementFromPoint(r.right-1,(r.top+r.bottom)/2):document.elementFromPoint((r.right+r.left)/2,r.bottom-1))!=e?e.style.visibility="hidden":t.set(1e3,i)}e.style.visibility="",t.set(1e3,i)},xr.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var Cr=function(){};function Sr(e,t){t||(t=wr(e));var n=e.display.barWidth,i=e.display.barHeight;kr(e,t);for(var r=0;r<4&&n!=e.display.barWidth||i!=e.display.barHeight;r++)n!=e.display.barWidth&&e.options.lineWrapping&&rr(e),kr(e,wr(e)),n=e.display.barWidth,i=e.display.barHeight}function kr(e,t){var n=e.display,i=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=i.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=i.bottom)+"px",n.heightForcer.style.borderBottom=i.bottom+"px solid transparent",i.right&&i.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=i.bottom+"px",n.scrollbarFiller.style.width=i.right+"px"):n.scrollbarFiller.style.display="",i.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=i.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}Cr.prototype.update=function(){return{bottom:0,right:0}},Cr.prototype.setScrollLeft=function(){},Cr.prototype.setScrollTop=function(){},Cr.prototype.clear=function(){};var Lr={native:xr,null:Cr};function Er(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&P(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new Lr[e.options.scrollbarStyle](function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),be(t,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),t.setAttribute("cm-not-content","true")},function(t,n){"horizontal"==n?br(e,t):vr(e,t)},e),e.display.scrollbars.addClass&&N(e.display.wrapper,e.display.scrollbars.addClass)}var Pr=0;function Tr(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Pr,markArrays:null},Mn(e.curOp)}function Ar(e){var t=e.curOp;t&&_n(t,function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;Mr(e)})}function Mr(e){for(var t=e.ops,n=0;n<t.length;n++)Ir(t[n]);for(var i=0;i<t.length;i++)_r(t[i]);for(var r=0;r<t.length;r++)Or(t[r]);for(var s=0;s<t.length;s++)Nr(t[s]);for(var o=0;o<t.length;o++)Dr(t[o])}function Ir(e){var t=e.cm,n=t.display;zr(t),e.updateMaxLine&&pn(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new Ur(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function _r(e){e.updatedDisplay=e.mustUpdate&&$r(e.cm,e.update)}function Or(e){var t=e.cm,n=t.display;e.updatedDisplay&&rr(t),e.barMeasure=wr(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=si(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+Qn(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-ei(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection())}function Nr(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&br(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var n=e.focus&&e.focus==O(B(t));e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,n),(e.updatedDisplay||e.startHeight!=t.doc.height)&&Sr(t,e.barMeasure),e.updatedDisplay&&Xr(t,e.barMeasure),e.selectionChanged&&Qi(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),n&&er(e.cm)}function Dr(e){var t=e.cm,n=t.display,i=t.doc;e.updatedDisplay&&Zr(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null!=e.scrollTop&&yr(t,e.scrollTop,e.forceScroll),null!=e.scrollLeft&&br(t,e.scrollLeft,!0,!0),e.scrollToPos&&ar(t,lr(t,vt(i,e.scrollToPos.from),vt(i,e.scrollToPos.to),e.scrollToPos.margin));var r=e.maybeHiddenMarkers,s=e.maybeUnhiddenMarkers;if(r)for(var o=0;o<r.length;++o)r[o].lines.length||Ce(r[o],"hide");if(s)for(var a=0;a<s.length;++a)s[a].lines.length&&Ce(s[a],"unhide");n.wrapper.offsetHeight&&(i.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Ce(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Rr(e,t){if(e.curOp)return t();Tr(e);try{return t()}finally{Ar(e)}}function Fr(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Tr(e);try{return t.apply(e,arguments)}finally{Ar(e)}}}function Br(e){return function(){if(this.curOp)return e.apply(this,arguments);Tr(this);try{return e.apply(this,arguments)}finally{Ar(this)}}}function Vr(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Tr(t);try{return e.apply(this,arguments)}finally{Ar(t)}}}function jr(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,H(Hr,e))}function Hr(e){var t=e.doc;if(!(t.highlightFrontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,i=kt(e,t.highlightFrontier),r=[];t.iter(i.line,Math.min(t.first+t.size,e.display.viewTo+500),function(s){if(i.line>=e.display.viewFrom){var o=s.styles,a=s.text.length>e.options.maxHighlightLength?Je(t.mode,i.state):null,l=Ct(e,s,i,!0);a&&(i.state=a),s.styles=l.styles;var c=s.styleClasses,h=l.classes;h?s.styleClasses=h:c&&(s.styleClasses=null);for(var u=!o||o.length!=s.styles.length||c!=h&&(!c||!h||c.bgClass!=h.bgClass||c.textClass!=h.textClass),d=0;!u&&d<o.length;++d)u=o[d]!=s.styles[d];u&&r.push(i.line),s.stateAfter=i.save(),i.nextLine()}else s.text.length<=e.options.maxHighlightLength&&Lt(e,s.text,i),s.stateAfter=i.line%5==0?i.save():null,i.nextLine();if(+new Date>n)return jr(e,e.options.workDelay),!0}),t.highlightFrontier=i.line,t.modeFrontier=Math.max(t.modeFrontier,i.line),r.length&&Rr(e,function(){for(var t=0;t<r.length;t++)zi(e,r[t],"text")})}}var Ur=function(e,t,n){var i=e.display;this.viewport=t,this.visible=or(i,e.doc,t),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=ei(e),this.force=n,this.dims=Ri(e),this.events=[]};function zr(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Qn(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Qn(e)+"px",t.scrollbarsClipped=!0)}function Wr(e){if(e.hasFocus())return null;var t=O(B(e));if(!t||!_(e.display.lineDiv,t))return null;var n={activeElt:t};if(window.getSelection){var i=j(e).getSelection();i.anchorNode&&i.extend&&_(e.display.lineDiv,i.anchorNode)&&(n.anchorNode=i.anchorNode,n.anchorOffset=i.anchorOffset,n.focusNode=i.focusNode,n.focusOffset=i.focusOffset)}return n}function Gr(e){if(e&&e.activeElt&&e.activeElt!=O(V(e.activeElt))&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&_(document.body,e.anchorNode)&&_(document.body,e.focusNode))){var t=e.activeElt.ownerDocument,n=t.defaultView.getSelection(),i=t.createRange();i.setEnd(e.anchorNode,e.anchorOffset),i.collapse(!1),n.removeAllRanges(),n.addRange(i),n.extend(e.focusNode,e.focusOffset)}}function $r(e,t){var n=e.display,i=e.doc;if(t.editorIsHidden)return Wi(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==Zi(e))return!1;Qr(e)&&(Wi(e),t.dims=Ri(e));var r=i.first+i.size,s=Math.max(t.visible.from-e.options.viewportMargin,i.first),o=Math.min(r,t.visible.to+e.options.viewportMargin);n.viewFrom<s&&s-n.viewFrom<20&&(s=Math.max(i.first,n.viewFrom)),n.viewTo>o&&n.viewTo-o<20&&(o=Math.min(r,n.viewTo)),Dt&&(s=an(e.doc,s),o=ln(e.doc,o));var a=s!=n.viewFrom||o!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;$i(e,s,o),n.viewOffset=un(nt(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var l=Zi(e);if(!a&&0==l&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var c=Wr(e);return l>4&&(n.lineDiv.style.display="none"),Kr(e,n.updateLineNumbers,t.dims),l>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,Gr(c),T(n.cursorDiv),T(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,a&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,jr(e,400)),n.updateLineNumbers=null,!0}function Zr(e,t){for(var n=t.viewport,i=!0;;i=!1){if(i&&e.options.lineWrapping&&t.oldDisplayWidth!=ei(e))i&&(t.visible=or(e.display,e.doc,n));else if(n&&null!=n.top&&(n={top:Math.min(e.doc.height+Xn(e.display)-ti(e),n.top)}),t.visible=or(e.display,e.doc,n),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!$r(e,t))break;rr(e);var r=wr(e);qi(e),Sr(e,r),Xr(e,r),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function qr(e,t){var n=new Ur(e,t);if($r(e,n)){rr(e),Zr(e,n);var i=wr(e);qi(e),Sr(e,i),Xr(e,i),n.finish()}}function Kr(e,t,n){var i=e.display,r=e.options.lineNumbers,s=i.lineDiv,o=s.firstChild;function a(t){var n=t.nextSibling;return l&&b&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var c=i.view,h=i.viewFrom,u=0;u<c.length;u++){var d=c[u];if(d.hidden);else if(d.node&&d.node.parentNode==s){for(;o!=d.node;)o=a(o);var p=r&&null!=t&&t<=h&&d.lineNumber;d.changes&&(G(d.changes,"gutter")>-1&&(p=!1),Rn(e,d,h,n)),p&&(T(d.lineNumber),d.lineNumber.appendChild(document.createTextNode(ct(e.options,h)))),o=d.node.nextSibling}else{var f=Wn(e,d,h,n);s.insertBefore(f,o)}h+=d.size}for(;o;)o=a(o)}function Yr(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px",Nn(e,"gutterChanged",e)}function Xr(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Qn(e)+"px"}function Jr(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var i=Fi(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,s=i+"px",o=0;o<n.length;o++)if(!n[o].hidden){e.options.fixedGutter&&(n[o].gutter&&(n[o].gutter.style.left=s),n[o].gutterBackground&&(n[o].gutterBackground.style.left=s));var a=n[o].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=s}e.options.fixedGutter&&(t.gutters.style.left=i+r+"px")}}function Qr(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=ct(e.options,t.first+t.size-1),i=e.display;if(n.length!=i.lineNumChars){var r=i.measure.appendChild(M("div",[M("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=r.firstChild.offsetWidth,o=r.offsetWidth-s;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(s,i.lineGutter.offsetWidth-o)+1,i.lineNumWidth=i.lineNumInnerWidth+o,i.lineNumChars=i.lineNumInnerWidth?n.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",Yr(e.display),!0}return!1}function es(e,t){for(var n=[],i=!1,r=0;r<e.length;r++){var s=e[r],o=null;if("string"!=typeof s&&(o=s.style,s=s.className),"CodeMirror-linenumbers"==s){if(!t)continue;i=!0}n.push({className:s,style:o})}return t&&!i&&n.push({className:"CodeMirror-linenumbers",style:null}),n}function ts(e){var t=e.gutters,n=e.gutterSpecs;T(t),e.lineGutter=null;for(var i=0;i<n.length;++i){var r=n[i],s=r.className,o=r.style,a=t.appendChild(M("div",null,"CodeMirror-gutter "+s));o&&(a.style.cssText=o),"CodeMirror-linenumbers"==s&&(e.lineGutter=a,a.style.width=(e.lineNumWidth||1)+"px")}t.style.display=n.length?"":"none",Yr(e)}function ns(e){ts(e.display),Ui(e),Jr(e)}function is(e,t,i,r){var s=this;this.input=i,s.scrollbarFiller=M("div",null,"CodeMirror-scrollbar-filler"),s.scrollbarFiller.setAttribute("cm-not-content","true"),s.gutterFiller=M("div",null,"CodeMirror-gutter-filler"),s.gutterFiller.setAttribute("cm-not-content","true"),s.lineDiv=I("div",null,"CodeMirror-code"),s.selectionDiv=M("div",null,null,"position: relative; z-index: 1"),s.cursorDiv=M("div",null,"CodeMirror-cursors"),s.measure=M("div",null,"CodeMirror-measure"),s.lineMeasure=M("div",null,"CodeMirror-measure"),s.lineSpace=I("div",[s.measure,s.lineMeasure,s.selectionDiv,s.cursorDiv,s.lineDiv],null,"position: relative; outline: none");var c=I("div",[s.lineSpace],"CodeMirror-lines");s.mover=M("div",[c],null,"position: relative"),s.sizer=M("div",[s.mover],"CodeMirror-sizer"),s.sizerWidth=null,s.heightForcer=M("div",null,null,"position: absolute; height: "+$+"px; width: 1px;"),s.gutters=M("div",null,"CodeMirror-gutters"),s.lineGutter=null,s.scroller=M("div",[s.sizer,s.heightForcer,s.gutters],"CodeMirror-scroll"),s.scroller.setAttribute("tabIndex","-1"),s.wrapper=M("div",[s.scrollbarFiller,s.gutterFiller,s.scroller],"CodeMirror"),h&&105===u&&(s.wrapper.style.clipPath="inset(0px)"),s.wrapper.setAttribute("translate","no"),o&&a<8&&(s.gutters.style.zIndex=-1,s.scroller.style.paddingRight=0),l||n&&y||(s.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(s.wrapper):e(s.wrapper)),s.viewFrom=s.viewTo=t.first,s.reportedViewFrom=s.reportedViewTo=t.first,s.view=[],s.renderedView=null,s.externalMeasured=null,s.viewOffset=0,s.lastWrapHeight=s.lastWrapWidth=0,s.updateLineNumbers=null,s.nativeBarWidth=s.barHeight=s.barWidth=0,s.scrollbarsClipped=!1,s.lineNumWidth=s.lineNumInnerWidth=s.lineNumChars=null,s.alignWidgets=!1,s.cachedCharWidth=s.cachedTextHeight=s.cachedPaddingH=null,s.maxLine=null,s.maxLineLength=0,s.maxLineChanged=!1,s.wheelDX=s.wheelDY=s.wheelStartX=s.wheelStartY=null,s.shift=!1,s.selForContextMenu=null,s.activeTouch=null,s.gutterSpecs=es(r.gutters,r.lineNumbers),ts(s),i.init(s)}Ur.prototype.signal=function(e,t){Le(e,t)&&this.events.push(arguments)},Ur.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ce.apply(null,this.events[e])};var rs=0,ss=null;function os(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}}function as(e){var t=os(e);return t.x*=ss,t.y*=ss,t}function ls(e,t){h&&102==u&&(null==e.display.chromeScrollHack?e.display.sizer.style.pointerEvents="none":clearTimeout(e.display.chromeScrollHack),e.display.chromeScrollHack=setTimeout(function(){e.display.chromeScrollHack=null,e.display.sizer.style.pointerEvents=""},100));var i=os(t),r=i.x,s=i.y,o=ss;0===t.deltaMode&&(r=t.deltaX,s=t.deltaY,o=1);var a=e.display,c=a.scroller,p=c.scrollWidth>c.clientWidth,f=c.scrollHeight>c.clientHeight;if(r&&p||s&&f){if(s&&b&&l)e:for(var m=t.target,g=a.view;m!=c;m=m.parentNode)for(var v=0;v<g.length;v++)if(g[v].node==m){e.display.currentWheelTarget=m;break e}if(r&&!n&&!d&&null!=o)return s&&f&&vr(e,Math.max(0,c.scrollTop+s*o)),br(e,Math.max(0,c.scrollLeft+r*o)),(!s||s&&f)&&Pe(t),void(a.wheelStartX=null);if(s&&null!=o){var y=s*o,w=e.doc.scrollTop,x=w+a.wrapper.clientHeight;y<0?w=Math.max(0,w+y-50):x=Math.min(e.doc.height,x+y+50),qr(e,{top:w,bottom:x})}rs<20&&0!==t.deltaMode&&(null==a.wheelStartX?(a.wheelStartX=c.scrollLeft,a.wheelStartY=c.scrollTop,a.wheelDX=r,a.wheelDY=s,setTimeout(function(){if(null!=a.wheelStartX){var e=c.scrollLeft-a.wheelStartX,t=c.scrollTop-a.wheelStartY,n=t&&a.wheelDY&&t/a.wheelDY||e&&a.wheelDX&&e/a.wheelDX;a.wheelStartX=a.wheelStartY=null,n&&(ss=(ss*rs+n)/(rs+1),++rs)}},200)):(a.wheelDX+=r,a.wheelDY+=s))}}o?ss=-.53:n?ss=15:h?ss=-.7:p&&(ss=-1/3);var cs=function(e,t){this.ranges=e,this.primIndex=t};cs.prototype.primary=function(){return this.ranges[this.primIndex]},cs.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],i=e.ranges[t];if(!dt(n.anchor,i.anchor)||!dt(n.head,i.head))return!1}return!0},cs.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new hs(pt(this.ranges[t].anchor),pt(this.ranges[t].head));return new cs(e,this.primIndex)},cs.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},cs.prototype.contains=function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var i=this.ranges[n];if(ut(t,i.from())>=0&&ut(e,i.to())<=0)return n}return-1};var hs=function(e,t){this.anchor=e,this.head=t};function us(e,t,n){var i=e&&e.options.selectionsMayTouch,r=t[n];t.sort(function(e,t){return ut(e.from(),t.from())}),n=G(t,r);for(var s=1;s<t.length;s++){var o=t[s],a=t[s-1],l=ut(a.to(),o.from());if(i&&!o.empty()?l>0:l>=0){var c=mt(a.from(),o.from()),h=ft(a.to(),o.to()),u=a.empty()?o.from()==o.head:a.from()==a.head;s<=n&&--n,t.splice(--s,2,new hs(u?h:c,u?c:h))}}return new cs(t,n)}function ds(e,t){return new cs([new hs(e,t||e)],0)}function ps(e){return e.text?ht(e.from.line+e.text.length-1,ee(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function fs(e,t){if(ut(e,t.from)<0)return e;if(ut(e,t.to)<=0)return ps(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=ps(t).ch-t.to.ch),ht(n,i)}function ms(e,t){for(var n=[],i=0;i<e.sel.ranges.length;i++){var r=e.sel.ranges[i];n.push(new hs(fs(r.anchor,t),fs(r.head,t)))}return us(e.cm,n,e.sel.primIndex)}function gs(e,t,n){return e.line==t.line?ht(n.line,e.ch-t.ch+n.ch):ht(n.line+(e.line-t.line),e.ch)}function vs(e,t,n){for(var i=[],r=ht(e.first,0),s=r,o=0;o<t.length;o++){var a=t[o],l=gs(a.from,r,s),c=gs(ps(a),r,s);if(r=a.to,s=c,"around"==n){var h=e.sel.ranges[o],u=ut(h.head,h.anchor)<0;i[o]=new hs(u?c:l,u?l:c)}else i[o]=new hs(l,l)}return new cs(i,e.sel.primIndex)}function ys(e){e.doc.mode=Ke(e.options,e.doc.modeOption),bs(e)}function bs(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,jr(e,100),e.state.modeGen++,e.curOp&&Ui(e)}function ws(e,t){return 0==t.from.ch&&0==t.to.ch&&""==ee(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function xs(e,t,n,i){function r(e){return n?n[e]:null}function s(e,n,r){mn(e,n,r,i),Nn(e,"change",e,t)}function o(e,t){for(var n=[],s=e;s<t;++s)n.push(new fn(c[s],r(s),i));return n}var a=t.from,l=t.to,c=t.text,h=nt(e,a.line),u=nt(e,l.line),d=ee(c),p=r(c.length-1),f=l.line-a.line;if(t.full)e.insert(0,o(0,c.length)),e.remove(c.length,e.size-c.length);else if(ws(e,t)){var m=o(0,c.length-1);s(u,u.text,p),f&&e.remove(a.line,f),m.length&&e.insert(a.line,m)}else if(h==u)if(1==c.length)s(h,h.text.slice(0,a.ch)+d+h.text.slice(l.ch),p);else{var g=o(1,c.length-1);g.push(new fn(d+h.text.slice(l.ch),p,i)),s(h,h.text.slice(0,a.ch)+c[0],r(0)),e.insert(a.line+1,g)}else if(1==c.length)s(h,h.text.slice(0,a.ch)+c[0]+u.text.slice(l.ch),r(0)),e.remove(a.line+1,f);else{s(h,h.text.slice(0,a.ch)+c[0],r(0)),s(u,d+u.text.slice(l.ch),p);var v=o(1,c.length-1);f>1&&e.remove(a.line+1,f-1),e.insert(a.line+1,v)}Nn(e,"change",e,t)}function Cs(e,t,n){function i(e,r,s){if(e.linked)for(var o=0;o<e.linked.length;++o){var a=e.linked[o];if(a.doc!=r){var l=s&&a.sharedHist;n&&!l||(t(a.doc,l),i(a.doc,e,l))}}}i(e,null,!0)}function Ss(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,Vi(e),ys(e),ks(e),e.options.direction=t.direction,e.options.lineWrapping||pn(e),e.options.mode=t.modeOption,Ui(e)}function ks(e){("rtl"==e.doc.direction?N:P)(e.display.lineDiv,"CodeMirror-rtl")}function Ls(e){Rr(e,function(){ks(e),Ui(e)})}function Es(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function Ps(e,t){var n={from:pt(t.from),to:ps(t),text:it(e,t.from,t.to)};return Ns(e,n,t.from.line,t.to.line+1),Cs(e,function(e){return Ns(e,n,t.from.line,t.to.line+1)},!0),n}function Ts(e){for(;e.length&&ee(e).ranges;)e.pop()}function As(e,t){return t?(Ts(e.done),ee(e.done)):e.done.length&&!ee(e.done).ranges?ee(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),ee(e.done)):void 0}function Ms(e,t,n,i){var r=e.history;r.undone.length=0;var s,o,a=+new Date;if((r.lastOp==i||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&r.lastModTime>a-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(s=As(r,r.lastOp==i)))o=ee(s.changes),0==ut(t.from,t.to)&&0==ut(t.from,o.to)?o.to=ps(t):s.changes.push(Ps(e,t));else{var l=ee(r.done);for(l&&l.ranges||Os(e.sel,r.done),s={changes:[Ps(e,t)],generation:r.generation},r.done.push(s);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(n),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=a,r.lastOp=r.lastSelOp=i,r.lastOrigin=r.lastSelOrigin=t.origin,o||Ce(e,"historyAdded")}function Is(e,t,n,i){var r=t.charAt(0);return"*"==r||"+"==r&&n.ranges.length==i.ranges.length&&n.somethingSelected()==i.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function _s(e,t,n,i){var r=e.history,s=i&&i.origin;n==r.lastSelOp||s&&r.lastSelOrigin==s&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==s||Is(e,s,ee(r.done),t))?r.done[r.done.length-1]=t:Os(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=s,r.lastSelOp=n,i&&!1!==i.clearRedo&&Ts(r.undone)}function Os(e,t){var n=ee(t);n&&n.ranges&&n.equals(e)||t.push(e)}function Ns(e,t,n,i){var r=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,i),function(n){n.markedSpans&&((r||(r=t["spans_"+e.id]={}))[s]=n.markedSpans),++s})}function Ds(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function Rs(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var i=[],r=0;r<t.text.length;++r)i.push(Ds(n[r]));return i}function Fs(e,t){var n=Rs(e,t),i=Wt(e,t);if(!n)return i;if(!i)return n;for(var r=0;r<n.length;++r){var s=n[r],o=i[r];if(s&&o)e:for(var a=0;a<o.length;++a){for(var l=o[a],c=0;c<s.length;++c)if(s[c].marker==l.marker)continue e;s.push(l)}else o&&(n[r]=o)}return n}function Bs(e,t,n){for(var i=[],r=0;r<e.length;++r){var s=e[r];if(s.ranges)i.push(n?cs.prototype.deepCopy.call(s):s);else{var o=s.changes,a=[];i.push({changes:a});for(var l=0;l<o.length;++l){var c=o[l],h=void 0;if(a.push({from:c.from,to:c.to,text:c.text}),t)for(var u in c)(h=u.match(/^spans_(\d+)$/))&&G(t,Number(h[1]))>-1&&(ee(a)[u]=c[u],delete c[u])}}}return i}function Vs(e,t,n,i){if(i){var r=e.anchor;if(n){var s=ut(t,r)<0;s!=ut(n,r)<0?(r=t,t=n):s!=ut(t,n)<0&&(t=n)}return new hs(r,t)}return new hs(n||t,t)}function js(e,t,n,i,r){null==r&&(r=e.cm&&(e.cm.display.shift||e.extend)),$s(e,new cs([Vs(e.sel.primary(),t,n,r)],0),i)}function Hs(e,t,n){for(var i=[],r=e.cm&&(e.cm.display.shift||e.extend),s=0;s<e.sel.ranges.length;s++)i[s]=Vs(e.sel.ranges[s],t[s],null,r);$s(e,us(e.cm,i,e.sel.primIndex),n)}function Us(e,t,n,i){var r=e.sel.ranges.slice(0);r[t]=n,$s(e,us(e.cm,r,e.sel.primIndex),i)}function zs(e,t,n,i){$s(e,ds(t,n),i)}function Ws(e,t,n){var i={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new hs(vt(e,t[n].anchor),vt(e,t[n].head))},origin:n&&n.origin};return Ce(e,"beforeSelectionChange",e,i),e.cm&&Ce(e.cm,"beforeSelectionChange",e.cm,i),i.ranges!=t.ranges?us(e.cm,i.ranges,i.ranges.length-1):t}function Gs(e,t,n){var i=e.history.done,r=ee(i);r&&r.ranges?(i[i.length-1]=t,Zs(e,t,n)):$s(e,t,n)}function $s(e,t,n){Zs(e,t,n),_s(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Zs(e,t,n){(Le(e,"beforeSelectionChange")||e.cm&&Le(e.cm,"beforeSelectionChange"))&&(t=Ws(e,t,n));var i=n&&n.bias||(ut(t.primary().head,e.sel.primary().head)<0?-1:1);qs(e,Ys(e,t,i,!0)),n&&!1===n.scroll||!e.cm||"nocursor"==e.cm.getOption("readOnly")||dr(e.cm)}function qs(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,ke(e.cm)),Nn(e,"cursorActivity",e))}function Ks(e){qs(e,Ys(e,e.sel,null,!1))}function Ys(e,t,n,i){for(var r,s=0;s<t.ranges.length;s++){var o=t.ranges[s],a=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[s],l=Js(e,o.anchor,a&&a.anchor,n,i),c=o.head==o.anchor?l:Js(e,o.head,a&&a.head,n,i);(r||l!=o.anchor||c!=o.head)&&(r||(r=t.ranges.slice(0,s)),r[s]=new hs(l,c))}return r?us(e.cm,r,t.primIndex):t}function Xs(e,t,n,i,r){var s=nt(e,t.line);if(s.markedSpans)for(var o=0;o<s.markedSpans.length;++o){var a=s.markedSpans[o],l=a.marker,c="selectLeft"in l?!l.selectLeft:l.inclusiveLeft,h="selectRight"in l?!l.selectRight:l.inclusiveRight;if((null==a.from||(c?a.from<=t.ch:a.from<t.ch))&&(null==a.to||(h?a.to>=t.ch:a.to>t.ch))){if(r&&(Ce(l,"beforeCursorEnter"),l.explicitlyCleared)){if(s.markedSpans){--o;continue}break}if(!l.atomic)continue;if(n){var u=l.find(i<0?1:-1),d=void 0;if((i<0?h:c)&&(u=Qs(e,u,-i,u&&u.line==t.line?s:null)),u&&u.line==t.line&&(d=ut(u,n))&&(i<0?d<0:d>0))return Xs(e,u,t,i,r)}var p=l.find(i<0?-1:1);return(i<0?c:h)&&(p=Qs(e,p,i,p.line==t.line?s:null)),p?Xs(e,p,t,i,r):null}}return t}function Js(e,t,n,i,r){var s=i||1,o=Xs(e,t,n,s,r)||!r&&Xs(e,t,n,s,!0)||Xs(e,t,n,-s,r)||!r&&Xs(e,t,n,-s,!0);return o||(e.cantEdit=!0,ht(e.first,0))}function Qs(e,t,n,i){return n<0&&0==t.ch?t.line>e.first?vt(e,ht(t.line-1)):null:n>0&&t.ch==(i||nt(e,t.line)).text.length?t.line<e.first+e.size-1?ht(t.line+1,0):null:new ht(t.line,t.ch+n)}function eo(e){e.setSelection(ht(e.firstLine(),0),ht(e.lastLine()),q)}function to(e,t,n){var i={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return i.canceled=!0}};return n&&(i.update=function(t,n,r,s){t&&(i.from=vt(e,t)),n&&(i.to=vt(e,n)),r&&(i.text=r),void 0!==s&&(i.origin=s)}),Ce(e,"beforeChange",e,i),e.cm&&Ce(e.cm,"beforeChange",e.cm,i),i.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:i.from,to:i.to,text:i.text,origin:i.origin}}function no(e,t,n){if(e.cm){if(!e.cm.curOp)return Fr(e.cm,no)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(Le(e,"beforeChange")||e.cm&&Le(e.cm,"beforeChange"))||(t=to(e,t,!0))){var i=Nt&&!n&&$t(e,t.from,t.to);if(i)for(var r=i.length-1;r>=0;--r)io(e,{from:i[r].from,to:i[r].to,text:r?[""]:t.text,origin:t.origin});else io(e,t)}}function io(e,t){if(1!=t.text.length||""!=t.text[0]||0!=ut(t.from,t.to)){var n=ms(e,t);Ms(e,t,n,e.cm?e.cm.curOp.id:NaN),oo(e,t,n,Wt(e,t));var i=[];Cs(e,function(e,n){n||-1!=G(i,e.history)||(uo(e.history,t),i.push(e.history)),oo(e,t,null,Wt(e,t))})}}function ro(e,t,n){var i=e.cm&&e.cm.state.suppressEdits;if(!i||n){for(var r,s=e.history,o=e.sel,a="undo"==t?s.done:s.undone,l="undo"==t?s.undone:s.done,c=0;c<a.length&&(r=a[c],n?!r.ranges||r.equals(e.sel):r.ranges);c++);if(c!=a.length){for(s.lastOrigin=s.lastSelOrigin=null;;){if(!(r=a.pop()).ranges){if(i)return void a.push(r);break}if(Os(r,l),n&&!r.equals(e.sel))return void $s(e,r,{clearRedo:!1});o=r}var h=[];Os(o,l),l.push({changes:h,generation:s.generation}),s.generation=r.generation||++s.maxGeneration;for(var u=Le(e,"beforeChange")||e.cm&&Le(e.cm,"beforeChange"),d=function(n){var i=r.changes[n];if(i.origin=t,u&&!to(e,i,!1))return a.length=0,{};h.push(Ps(e,i));var s=n?ms(e,i):ee(a);oo(e,i,s,Fs(e,i)),!n&&e.cm&&e.cm.scrollIntoView({from:i.from,to:ps(i)});var o=[];Cs(e,function(e,t){t||-1!=G(o,e.history)||(uo(e.history,i),o.push(e.history)),oo(e,i,null,Fs(e,i))})},p=r.changes.length-1;p>=0;--p){var f=d(p);if(f)return f.v}}}}function so(e,t){if(0!=t&&(e.first+=t,e.sel=new cs(te(e.sel.ranges,function(e){return new hs(ht(e.anchor.line+t,e.anchor.ch),ht(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){Ui(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,i=n.viewFrom;i<n.viewTo;i++)zi(e.cm,i,"gutter")}}function oo(e,t,n,i){if(e.cm&&!e.cm.curOp)return Fr(e.cm,oo)(e,t,n,i);if(t.to.line<e.first)so(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);so(e,r),t={from:ht(e.first,0),to:ht(t.to.line+r,t.to.ch),text:[ee(t.text)],origin:t.origin}}var s=e.lastLine();t.to.line>s&&(t={from:t.from,to:ht(s,nt(e,s).text.length),text:[t.text[0]],origin:t.origin}),t.removed=it(e,t.from,t.to),n||(n=ms(e,t)),e.cm?ao(e.cm,t,i):xs(e,t,i),Zs(e,n,q),e.cantEdit&&Js(e,ht(e.firstLine(),0))&&(e.cantEdit=!1)}}function ao(e,t,n){var i=e.doc,r=e.display,s=t.from,o=t.to,a=!1,l=s.line;e.options.lineWrapping||(l=ot(rn(nt(i,s.line))),i.iter(l,o.line+1,function(e){if(e==r.maxLine)return a=!0,!0})),i.sel.contains(t.from,t.to)>-1&&ke(e),xs(i,t,n,Bi(e)),e.options.lineWrapping||(i.iter(l,s.line+t.text.length,function(e){var t=dn(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,a=!1)}),a&&(e.curOp.updateMaxLine=!0)),Ot(i,s.line),jr(e,400);var c=t.text.length-(o.line-s.line)-1;t.full?Ui(e):s.line!=o.line||1!=t.text.length||ws(e.doc,t)?Ui(e,s.line,o.line+1,c):zi(e,s.line,"text");var h=Le(e,"changes"),u=Le(e,"change");if(u||h){var d={from:s,to:o,text:t.text,removed:t.removed,origin:t.origin};u&&Nn(e,"change",e,d),h&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(d)}e.display.selForContextMenu=null}function lo(e,t,n,i,r){var s;i||(i=n),ut(i,n)<0&&(n=(s=[i,n])[0],i=s[1]),"string"==typeof t&&(t=e.splitLines(t)),no(e,{from:n,to:i,text:t,origin:r})}function co(e,t,n,i){n<e.line?e.line+=i:t<e.line&&(e.line=t,e.ch=0)}function ho(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r],o=!0;if(s.ranges){s.copied||((s=e[r]=s.deepCopy()).copied=!0);for(var a=0;a<s.ranges.length;a++)co(s.ranges[a].anchor,t,n,i),co(s.ranges[a].head,t,n,i)}else{for(var l=0;l<s.changes.length;++l){var c=s.changes[l];if(n<c.from.line)c.from=ht(c.from.line+i,c.from.ch),c.to=ht(c.to.line+i,c.to.ch);else if(t<=c.to.line){o=!1;break}}o||(e.splice(0,r+1),r=0)}}}function uo(e,t){var n=t.from.line,i=t.to.line,r=t.text.length-(i-n)-1;ho(e.done,n,i,r),ho(e.undone,n,i,r)}function po(e,t,n,i){var r=t,s=t;return"number"==typeof t?s=nt(e,gt(e,t)):r=ot(t),null==r?null:(i(s,r)&&e.cm&&zi(e.cm,r,n),s)}function fo(e){this.lines=e,this.parent=null;for(var t=0,n=0;n<e.length;++n)e[n].parent=this,t+=e[n].height;this.height=t}function mo(e){this.children=e;for(var t=0,n=0,i=0;i<e.length;++i){var r=e[i];t+=r.chunkSize(),n+=r.height,r.parent=this}this.size=t,this.height=n,this.parent=null}hs.prototype.from=function(){return mt(this.anchor,this.head)},hs.prototype.to=function(){return ft(this.anchor,this.head)},hs.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},fo.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,i=e+t;n<i;++n){var r=this.lines[n];this.height-=r.height,gn(r),Nn(r,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var i=0;i<t.length;++i)t[i].parent=this},iterN:function(e,t,n){for(var i=e+t;e<i;++e)if(n(this.lines[e]))return!0}},mo.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var i=this.children[n],r=i.chunkSize();if(e<r){var s=Math.min(t,r-e),o=i.height;if(i.removeInner(e,s),this.height-=o-i.height,r==s&&(this.children.splice(n--,1),i.parent=null),0==(t-=s))break;e=0}else e-=r}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof fo))){var a=[];this.collapse(a),this.children=[new fo(a)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var i=0;i<this.children.length;++i){var r=this.children[i],s=r.chunkSize();if(e<=s){if(r.insertInner(e,t,n),r.lines&&r.lines.length>50){for(var o=r.lines.length%25+25,a=o;a<r.lines.length;){var l=new fo(r.lines.slice(a,a+=25));r.height-=l.height,this.children.splice(++i,0,l),l.parent=this}r.lines=r.lines.slice(0,o),this.maybeSpill()}break}e-=s}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=new mo(e.children.splice(e.children.length-5,5));if(e.parent){e.size-=t.size,e.height-=t.height;var n=G(e.parent.children,e);e.parent.children.splice(n+1,0,t)}else{var i=new mo(e.children);i.parent=e,e.children=[i,t],e=i}t.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var i=0;i<this.children.length;++i){var r=this.children[i],s=r.chunkSize();if(e<s){var o=Math.min(t,s-e);if(r.iterN(e,o,n))return!0;if(0==(t-=o))break;e=0}else e-=s}}};var go=function(e,t,n){if(n)for(var i in n)n.hasOwnProperty(i)&&(this[i]=n[i]);this.doc=e,this.node=t};function vo(e,t,n){un(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&ur(e,n)}function yo(e,t,n,i){var r=new go(e,n,i),s=e.cm;return s&&r.noHScroll&&(s.display.alignWidgets=!0),po(e,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);if(null==r.insertAt?n.push(r):n.splice(Math.min(n.length,Math.max(0,r.insertAt)),0,r),r.line=t,s&&!cn(e,t)){var i=un(t)<e.scrollTop;st(t,t.height+qn(r)),i&&ur(s,r.height),s.curOp.forceUpdate=!0}return!0}),s&&Nn(s,"lineWidgetAdded",s,r,"number"==typeof t?t:ot(t)),r}go.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,i=ot(n);if(null!=i&&t){for(var r=0;r<t.length;++r)t[r]==this&&t.splice(r--,1);t.length||(n.widgets=null);var s=qn(this);st(n,Math.max(0,n.height-s)),e&&(Rr(e,function(){vo(e,n,-s),zi(e,i,"widget")}),Nn(e,"lineWidgetCleared",e,this,i))}},go.prototype.changed=function(){var e=this,t=this.height,n=this.doc.cm,i=this.line;this.height=null;var r=qn(this)-t;r&&(cn(this.doc,i)||st(i,i.height+r),n&&Rr(n,function(){n.curOp.forceUpdate=!0,vo(n,i,r),Nn(n,"lineWidgetChanged",n,e,ot(i))}))},Ee(go);var bo=0,wo=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++bo};function xo(e,t,n,i,r){if(i&&i.shared)return So(e,t,n,i,r);if(e.cm&&!e.cm.curOp)return Fr(e.cm,xo)(e,t,n,i,r);var s=new wo(e,r),o=ut(t,n);if(i&&U(i,s,!1),o>0||0==o&&!1!==s.clearWhenEmpty)return s;if(s.replacedWith&&(s.collapsed=!0,s.widgetNode=I("span",[s.replacedWith],"CodeMirror-widget"),i.handleMouseEvents||s.widgetNode.setAttribute("cm-ignore-events","true"),i.insertLeft&&(s.widgetNode.insertLeft=!0)),s.collapsed){if(nn(e,t.line,t,n,s)||t.line!=n.line&&nn(e,n.line,t,n,s))throw new Error("Inserting collapsed marker partially overlapping an existing one");Ft()}s.addToHistory&&Ms(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var a,l=t.line,c=e.cm;if(e.iter(l,n.line+1,function(i){c&&s.collapsed&&!c.options.lineWrapping&&rn(i)==c.display.maxLine&&(a=!0),s.collapsed&&l!=t.line&&st(i,0),Ht(i,new Bt(s,l==t.line?t.ch:null,l==n.line?n.ch:null),e.cm&&e.cm.curOp),++l}),s.collapsed&&e.iter(t.line,n.line+1,function(t){cn(e,t)&&st(t,0)}),s.clearOnEnter&&be(s,"beforeCursorEnter",function(){return s.clear()}),s.readOnly&&(Rt(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),s.collapsed&&(s.id=++bo,s.atomic=!0),c){if(a&&(c.curOp.updateMaxLine=!0),s.collapsed)Ui(c,t.line,n.line+1);else if(s.className||s.startStyle||s.endStyle||s.css||s.attributes||s.title)for(var h=t.line;h<=n.line;h++)zi(c,h,"text");s.atomic&&Ks(c.doc),Nn(c,"markerAdded",c,s)}return s}wo.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Tr(e),Le(this,"clear")){var n=this.find();n&&Nn(this,"clear",n.from,n.to)}for(var i=null,r=null,s=0;s<this.lines.length;++s){var o=this.lines[s],a=Vt(o.markedSpans,this);e&&!this.collapsed?zi(e,ot(o),"text"):e&&(null!=a.to&&(r=ot(o)),null!=a.from&&(i=ot(o))),o.markedSpans=jt(o.markedSpans,a),null==a.from&&this.collapsed&&!cn(this.doc,o)&&e&&st(o,Ni(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var l=0;l<this.lines.length;++l){var c=rn(this.lines[l]),h=dn(c);h>e.display.maxLineLength&&(e.display.maxLine=c,e.display.maxLineLength=h,e.display.maxLineChanged=!0)}null!=i&&e&&this.collapsed&&Ui(e,i,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Ks(e.doc)),e&&Nn(e,"markerCleared",e,this,i,r),t&&Ar(e),this.parent&&this.parent.clear()}},wo.prototype.find=function(e,t){var n,i;null==e&&"bookmark"==this.type&&(e=1);for(var r=0;r<this.lines.length;++r){var s=this.lines[r],o=Vt(s.markedSpans,this);if(null!=o.from&&(n=ht(t?s:ot(s),o.from),-1==e))return n;if(null!=o.to&&(i=ht(t?s:ot(s),o.to),1==e))return i}return n&&{from:n,to:i}},wo.prototype.changed=function(){var e=this,t=this.find(-1,!0),n=this,i=this.doc.cm;t&&i&&Rr(i,function(){var r=t.line,s=ot(t.line),o=oi(i,s);if(o&&(mi(o),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!cn(n.doc,r)&&null!=n.height){var a=n.height;n.height=null;var l=qn(n)-a;l&&st(r,r.height+l)}Nn(i,"markerChanged",i,e)})},wo.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=G(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},wo.prototype.detachLine=function(e){if(this.lines.splice(G(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},Ee(wo);var Co=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};function So(e,t,n,i,r){(i=U(i)).shared=!1;var s=[xo(e,t,n,i,r)],o=s[0],a=i.widgetNode;return Cs(e,function(e){a&&(i.widgetNode=a.cloneNode(!0)),s.push(xo(e,vt(e,t),vt(e,n),i,r));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;o=ee(s)}),new Co(s,o)}function ko(e){return e.findMarks(ht(e.first,0),e.clipPos(ht(e.lastLine())),function(e){return e.parent})}function Lo(e,t){for(var n=0;n<t.length;n++){var i=t[n],r=i.find(),s=e.clipPos(r.from),o=e.clipPos(r.to);if(ut(s,o)){var a=xo(e,s,o,i.primary,i.primary.type);i.markers.push(a),a.parent=i}}}function Eo(e){for(var t=function(t){var n=e[t],i=[n.primary.doc];Cs(n.primary.doc,function(e){return i.push(e)});for(var r=0;r<n.markers.length;r++){var s=n.markers[r];-1==G(i,s.doc)&&(s.parent=null,n.markers.splice(r--,1))}},n=0;n<e.length;n++)t(n)}Co.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Nn(this,"clear")}},Co.prototype.find=function(e,t){return this.primary.find(e,t)},Ee(Co);var Po=0,To=function(e,t,n,i,r){if(!(this instanceof To))return new To(e,t,n,i,r);null==n&&(n=0),mo.call(this,[new fo([new fn("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=n;var s=ht(n,0);this.sel=ds(s),this.history=new Es(null),this.id=++Po,this.modeOption=t,this.lineSep=i,this.direction="rtl"==r?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),xs(this,{from:s,to:s,text:e}),$s(this,ds(s),q)};To.prototype=re(mo.prototype,{constructor:To,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,i=0;i<t.length;++i)n+=t[i].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=rt(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:Vr(function(e){var t=ht(this.first,0),n=this.first+this.size-1;no(this,{from:t,to:ht(n,nt(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&pr(this.cm,0,0),$s(this,ds(t),q)}),replaceRange:function(e,t,n,i){lo(this,e,t=vt(this,t),n=n?vt(this,n):t,i)},getRange:function(e,t,n){var i=it(this,vt(this,e),vt(this,t));return!1===n?i:""===n?i.join(""):i.join(n||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(lt(this,e))return nt(this,e)},getLineNumber:function(e){return ot(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=nt(this,e)),rn(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return vt(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Vr(function(e,t,n){zs(this,vt(this,"number"==typeof e?ht(e,t||0):e),null,n)}),setSelection:Vr(function(e,t,n){zs(this,vt(this,e),vt(this,t||e),n)}),extendSelection:Vr(function(e,t,n){js(this,vt(this,e),t&&vt(this,t),n)}),extendSelections:Vr(function(e,t){Hs(this,bt(this,e),t)}),extendSelectionsBy:Vr(function(e,t){Hs(this,bt(this,te(this.sel.ranges,e)),t)}),setSelections:Vr(function(e,t,n){if(e.length){for(var i=[],r=0;r<e.length;r++)i[r]=new hs(vt(this,e[r].anchor),vt(this,e[r].head||e[r].anchor));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),$s(this,us(this.cm,i,t),n)}}),addSelection:Vr(function(e,t,n){var i=this.sel.ranges.slice(0);i.push(new hs(vt(this,e),vt(this,t||e))),$s(this,us(this.cm,i,i.length-1),n)}),getSelection:function(e){for(var t,n=this.sel.ranges,i=0;i<n.length;i++){var r=it(this,n[i].from(),n[i].to());t=t?t.concat(r):r}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],n=this.sel.ranges,i=0;i<n.length;i++){var r=it(this,n[i].from(),n[i].to());!1!==e&&(r=r.join(e||this.lineSeparator())),t[i]=r}return t},replaceSelection:function(e,t,n){for(var i=[],r=0;r<this.sel.ranges.length;r++)i[r]=e;this.replaceSelections(i,t,n||"+input")},replaceSelections:Vr(function(e,t,n){for(var i=[],r=this.sel,s=0;s<r.ranges.length;s++){var o=r.ranges[s];i[s]={from:o.from(),to:o.to(),text:this.splitLines(e[s]),origin:n}}for(var a=t&&"end"!=t&&vs(this,i,t),l=i.length-1;l>=0;l--)no(this,i[l]);a?Gs(this,a):this.cm&&dr(this.cm)}),undo:Vr(function(){ro(this,"undo")}),redo:Vr(function(){ro(this,"redo")}),undoSelection:Vr(function(){ro(this,"undo",!0)}),redoSelection:Vr(function(){ro(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(var r=0;r<e.undone.length;r++)e.undone[r].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){var e=this;this.history=new Es(this.history),Cs(this,function(t){return t.history=e.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Bs(this.history.done),undone:Bs(this.history.undone)}},setHistory:function(e){var t=this.history=new Es(this.history);t.done=Bs(e.done.slice(0),null,!0),t.undone=Bs(e.undone.slice(0),null,!0)},setGutterMarker:Vr(function(e,t,n){return po(this,e,"gutter",function(e){var i=e.gutterMarkers||(e.gutterMarkers={});return i[t]=n,!n&&le(i)&&(e.gutterMarkers=null),!0})}),clearGutter:Vr(function(e){var t=this;this.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&po(t,n,"gutter",function(){return n.gutterMarkers[e]=null,le(n.gutterMarkers)&&(n.gutterMarkers=null),!0})})}),lineInfo:function(e){var t;if("number"==typeof e){if(!lt(this,e))return null;if(t=e,!(e=nt(this,e)))return null}else if(null==(t=ot(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:Vr(function(e,t,n){return po(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[i]){if(L(n).test(e[i]))return!1;e[i]+=" "+n}else e[i]=n;return!0})}),removeLineClass:Vr(function(e,t,n){return po(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",r=e[i];if(!r)return!1;if(null==n)e[i]=null;else{var s=r.match(L(n));if(!s)return!1;var o=s.index+s[0].length;e[i]=r.slice(0,s.index)+(s.index&&o!=r.length?" ":"")+r.slice(o)||null}return!0})}),addLineWidget:Vr(function(e,t,n){return yo(this,e,t,n)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return xo(this,vt(this,e),vt(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return xo(this,e=vt(this,e),e,n,"bookmark")},findMarksAt:function(e){var t=[],n=nt(this,(e=vt(this,e)).line).markedSpans;if(n)for(var i=0;i<n.length;++i){var r=n[i];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,n){e=vt(this,e),t=vt(this,t);var i=[],r=e.line;return this.iter(e.line,t.line+1,function(s){var o=s.markedSpans;if(o)for(var a=0;a<o.length;a++){var l=o[a];null!=l.to&&r==e.line&&e.ch>=l.to||null==l.from&&r!=e.line||null!=l.from&&r==t.line&&l.from>=t.ch||n&&!n(l.marker)||i.push(l.marker.parent||l.marker)}++r}),i},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var i=0;i<n.length;++i)null!=n[i].from&&e.push(n[i].marker)}),e},posFromIndex:function(e){var t,n=this.first,i=this.lineSeparator().length;return this.iter(function(r){var s=r.text.length+i;if(s>e)return t=e,!0;e-=s,++n}),vt(this,ht(n,t))},indexFromPos:function(e){var t=(e=vt(this,e)).ch;if(e.line<this.first||e.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,e.line,function(e){t+=e.text.length+n}),t},copy:function(e){var t=new To(rt(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var i=new To(rt(this,t,n),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Lo(i,ko(this)),i},unlinkDoc:function(e){if(e instanceof Ua&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t)if(this.linked[t].doc==e){this.linked.splice(t,1),e.unlinkDoc(this),Eo(ko(this));break}if(e.history==this.history){var n=[e.id];Cs(e,function(e){return n.push(e.id)},!0),e.history=new Es(null),e.history.done=Bs(this.history.done,n),e.history.undone=Bs(this.history.undone,n)}},iterLinkedDocs:function(e){Cs(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Ve(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:Vr(function(e){"rtl"!=e&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(e){return e.order=null}),this.cm&&Ls(this.cm))})}),To.prototype.eachLine=To.prototype.iter;var Ao=0;function Mo(e){var t=this;if(Oo(t),!Se(t,e)&&!Kn(t.display,e)){Pe(e),o&&(Ao=+new Date);var n=ji(t,e,!0),i=e.dataTransfer.files;if(n&&!t.isReadOnly())if(i&&i.length&&window.FileReader&&window.File)for(var r=i.length,s=Array(r),a=0,l=function(){++a==r&&Fr(t,function(){var e={from:n=vt(t.doc,n),to:n,text:t.doc.splitLines(s.filter(function(e){return null!=e}).join(t.doc.lineSeparator())),origin:"paste"};no(t.doc,e),Gs(t.doc,ds(vt(t.doc,n),vt(t.doc,ps(e))))})()},c=function(e,n){if(t.options.allowDropFileTypes&&-1==G(t.options.allowDropFileTypes,e.type))l();else{var i=new FileReader;i.onerror=function(){return l()},i.onload=function(){var e=i.result;/[\x00-\x08\x0e-\x1f]{2}/.test(e)||(s[n]=e),l()},i.readAsText(e)}},h=0;h<i.length;h++)c(i[h],h);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout(function(){return t.display.input.focus()},20);try{var u=e.dataTransfer.getData("Text");if(u){var d;if(t.state.draggingText&&!t.state.draggingText.copy&&(d=t.listSelections()),Zs(t.doc,ds(n,n)),d)for(var p=0;p<d.length;++p)lo(t.doc,"",d[p].anchor,d[p].head,"drag");t.replaceSelection(u,"around","paste"),t.display.input.focus()}}catch(f){}}}}function Io(e,t){if(o&&(!e.state.draggingText||+new Date-Ao<100))Me(t);else if(!Se(e,t)&&!Kn(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!p)){var n=M("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),d&&n.parentNode.removeChild(n)}}function _o(e,t){var n=ji(e,t);if(n){var i=document.createDocumentFragment();Yi(e,n,i),e.display.dragCursor||(e.display.dragCursor=M("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),A(e.display.dragCursor,i)}}function Oo(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function No(e){if(document.getElementsByClassName){for(var t=document.getElementsByClassName("CodeMirror"),n=[],i=0;i<t.length;i++){var r=t[i].CodeMirror;r&&n.push(r)}n.length&&n[0].operation(function(){for(var t=0;t<n.length;t++)e(n[t])})}}var Do=!1;function Ro(){Do||(Fo(),Do=!0)}function Fo(){var e;be(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,No(Bo)},100))}),be(window,"blur",function(){return No(ir)})}function Bo(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var Vo={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},jo=0;jo<10;jo++)Vo[jo+48]=Vo[jo+96]=String(jo);for(var Ho=65;Ho<=90;Ho++)Vo[Ho]=String.fromCharCode(Ho);for(var Uo=1;Uo<=12;Uo++)Vo[Uo+111]=Vo[Uo+63235]="F"+Uo;var zo={};function Wo(e){var t,n,i,r,s=e.split(/-(?!$)/);e=s[s.length-1];for(var o=0;o<s.length-1;o++){var a=s[o];if(/^(cmd|meta|m)$/i.test(a))r=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else{if(!/^s(hift)?$/i.test(a))throw new Error("Unrecognized modifier name: "+a);i=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),r&&(e="Cmd-"+e),i&&(e="Shift-"+e),e}function Go(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==i){delete e[n];continue}for(var r=te(n.split(" "),Wo),s=0;s<r.length;s++){var o=void 0,a=void 0;s==r.length-1?(a=r.join(" "),o=i):(a=r.slice(0,s+1).join(" "),o="...");var l=t[a];if(l){if(l!=o)throw new Error("Inconsistent bindings for "+a)}else t[a]=o}delete e[n]}for(var c in t)e[c]=t[c];return e}function $o(e,t,n,i){var r=(t=Yo(t)).call?t.call(e,i):t[e];if(!1===r)return"nothing";if("..."===r)return"multi";if(null!=r&&n(r))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return $o(e,t.fallthrough,n,i);for(var s=0;s<t.fallthrough.length;s++){var o=$o(e,t.fallthrough[s],n,i);if(o)return o}}}function Zo(e){var t="string"==typeof e?e:Vo[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function qo(e,t,n){var i=e;return t.altKey&&"Alt"!=i&&(e="Alt-"+e),(S?t.metaKey:t.ctrlKey)&&"Ctrl"!=i&&(e="Ctrl-"+e),(S?t.ctrlKey:t.metaKey)&&"Mod"!=i&&(e="Cmd-"+e),!n&&t.shiftKey&&"Shift"!=i&&(e="Shift-"+e),e}function Ko(e,t){if(d&&34==e.keyCode&&e.char)return!1;var n=Vo[e.keyCode];return null!=n&&!e.altGraphKey&&(3==e.keyCode&&e.code&&(n=e.code),qo(n,e,t))}function Yo(e){return"string"==typeof e?zo[e]:e}function Xo(e,t){for(var n=e.doc.sel.ranges,i=[],r=0;r<n.length;r++){for(var s=t(n[r]);i.length&&ut(s.from,ee(i).to)<=0;){var o=i.pop();if(ut(o.from,s.from)<0){s.from=o.from;break}}i.push(s)}Rr(e,function(){for(var t=i.length-1;t>=0;t--)lo(e.doc,"",i[t].from,i[t].to,"+delete");dr(e)})}function Jo(e,t,n){var i=ue(e.text,t+n,n);return i<0||i>e.text.length?null:i}function Qo(e,t,n){var i=Jo(e,t.ch,n);return null==i?null:new ht(t.line,i,n<0?"after":"before")}function ea(e,t,n,i,r){if(e){"rtl"==t.doc.direction&&(r=-r);var s=ve(n,t.doc.direction);if(s){var o,a=r<0?ee(s):s[0],l=r<0==(1==a.level)?"after":"before";if(a.level>0||"rtl"==t.doc.direction){var c=ai(t,n);o=r<0?n.text.length-1:0;var h=li(t,c,o).top;o=de(function(e){return li(t,c,e).top==h},r<0==(1==a.level)?a.from:a.to-1,o),"before"==l&&(o=Jo(n,o,1))}else o=r<0?a.to:a.from;return new ht(i,o,l)}}return new ht(i,r<0?n.text.length:0,r<0?"before":"after")}function ta(e,t,n,i){var r=ve(t,e.doc.direction);if(!r)return Qo(t,n,i);n.ch>=t.text.length?(n.ch=t.text.length,n.sticky="before"):n.ch<=0&&(n.ch=0,n.sticky="after");var s=me(r,n.ch,n.sticky),o=r[s];if("ltr"==e.doc.direction&&o.level%2==0&&(i>0?o.to>n.ch:o.from<n.ch))return Qo(t,n,i);var a,l=function(e,n){return Jo(t,e instanceof ht?e.ch:e,n)},c=function(n){return e.options.lineWrapping?(a=a||ai(e,t),Ai(e,t,a,n)):{begin:0,end:t.text.length}},h=c("before"==n.sticky?l(n,-1):n.ch);if("rtl"==e.doc.direction||1==o.level){var u=1==o.level==i<0,d=l(n,u?1:-1);if(null!=d&&(u?d<=o.to&&d<=h.end:d>=o.from&&d>=h.begin)){var p=u?"before":"after";return new ht(n.line,d,p)}}var f=function(e,t,i){for(var s=function(e,t){return t?new ht(n.line,l(e,1),"before"):new ht(n.line,e,"after")};e>=0&&e<r.length;e+=t){var o=r[e],a=t>0==(1!=o.level),c=a?i.begin:l(i.end,-1);if(o.from<=c&&c<o.to)return s(c,a);if(c=a?o.from:l(o.to,-1),i.begin<=c&&c<i.end)return s(c,a)}},m=f(s+i,i,h);if(m)return m;var g=i>0?h.end:l(h.begin,-1);return null==g||i>0&&g==t.text.length||!(m=f(i>0?0:r.length-1,i,c(g)))?null:m}zo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},zo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},zo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},zo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},zo.default=b?zo.macDefault:zo.pcDefault;var na={selectAll:eo,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),q)},killLine:function(e){return Xo(e,function(t){if(t.empty()){var n=nt(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:ht(t.head.line+1,0)}:{from:t.head,to:ht(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){return Xo(e,function(t){return{from:ht(t.from().line,0),to:vt(e.doc,ht(t.to().line+1,0))}})},delLineLeft:function(e){return Xo(e,function(e){return{from:ht(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){return Xo(e,function(t){var n=e.charCoords(t.head,"div").top+5;return{from:e.coordsChar({left:0,top:n},"div"),to:t.from()}})},delWrappedLineRight:function(e){return Xo(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:i}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(ht(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(ht(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(t){return ia(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(t){return sa(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(t){return ra(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(t){var n=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},Y)},goLineLeft:function(e){return e.extendSelectionsBy(function(t){var n=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},Y)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(t){var n=e.cursorCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return i.ch<e.getLine(i.line).search(/\S/)?sa(e,t.head):i},Y)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),i=e.options.tabSize,r=0;r<n.length;r++){var s=n[r].from(),o=z(e.getLine(s.line),s.ch,i);t.push(Q(i-o%i))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return Rr(e,function(){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++)if(t[i].empty()){var r=t[i].head,s=nt(e.doc,r.line).text;if(s)if(r.ch==s.length&&(r=new ht(r.line,r.ch-1)),r.ch>0)r=new ht(r.line,r.ch+1),e.replaceRange(s.charAt(r.ch-1)+s.charAt(r.ch-2),ht(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var o=nt(e.doc,r.line-1).text;o&&(r=new ht(r.line,1),e.replaceRange(s.charAt(0)+e.doc.lineSeparator()+o.charAt(o.length-1),ht(r.line-1,o.length-1),r,"+transpose"))}n.push(new hs(r,r))}e.setSelections(n)})},newlineAndIndent:function(e){return Rr(e,function(){for(var t=e.listSelections(),n=t.length-1;n>=0;n--)e.replaceRange(e.doc.lineSeparator(),t[n].anchor,t[n].head,"+input");t=e.listSelections();for(var i=0;i<t.length;i++)e.indentLine(t[i].from().line,null,!0);dr(e)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function ia(e,t){var n=nt(e.doc,t),i=rn(n);return i!=n&&(t=ot(i)),ea(!0,e,i,t,1)}function ra(e,t){var n=nt(e.doc,t),i=sn(n);return i!=n&&(t=ot(i)),ea(!0,e,n,t,-1)}function sa(e,t){var n=ia(e,t.line),i=nt(e.doc,n.line),r=ve(i,e.doc.direction);if(!r||0==r[0].level){var s=Math.max(n.ch,i.text.search(/\S/)),o=t.line==n.line&&t.ch<=s&&t.ch;return ht(n.line,o?0:s,n.sticky)}return n}function oa(e,t,n){if("string"==typeof t&&!(t=na[t]))return!1;e.display.input.ensurePolled();var i=e.display.shift,r=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),r=t(e)!=Z}finally{e.display.shift=i,e.state.suppressEdits=!1}return r}function aa(e,t,n){for(var i=0;i<e.state.keyMaps.length;i++){var r=$o(t,e.state.keyMaps[i],n,e);if(r)return r}return e.options.extraKeys&&$o(t,e.options.extraKeys,n,e)||$o(t,e.options.keyMap,n,e)}var la=new W;function ca(e,t,n,i){var r=e.state.keySeq;if(r){if(Zo(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:la.set(50,function(){e.state.keySeq==r&&(e.state.keySeq=null,e.display.input.reset())}),ha(e,r+" "+t,n,i))return!0}return ha(e,t,n,i)}function ha(e,t,n,i){var r=aa(e,t,i);return"multi"==r&&(e.state.keySeq=t),"handled"==r&&Nn(e,"keyHandled",e,t,n),"handled"!=r&&"multi"!=r||(Pe(n),Qi(e)),!!r}function ua(e,t){var n=Ko(t,!0);return!!n&&(t.shiftKey&&!e.state.keySeq?ca(e,"Shift-"+n,t,function(t){return oa(e,t,!0)})||ca(e,n,t,function(t){if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return oa(e,t)}):ca(e,n,t,function(t){return oa(e,t)}))}function da(e,t,n){return ca(e,"'"+n+"'",t,function(t){return oa(e,t,!0)})}var pa=null;function fa(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField()||(t.curOp.focus=O(B(t)),Se(t,e)))){o&&a<11&&27==e.keyCode&&(e.returnValue=!1);var i=e.keyCode;t.display.shift=16==i||e.shiftKey;var r=ua(t,e);d&&(pa=r?i:null,r||88!=i||He||!(b?e.metaKey:e.ctrlKey)||t.replaceSelection("",null,"cut")),n&&!b&&!r&&46==i&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),18!=i||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||ma(t)}}function ma(e){var t=e.display.lineDiv;function n(e){18!=e.keyCode&&e.altKey||(P(t,"CodeMirror-crosshair"),xe(document,"keyup",n),xe(document,"mouseover",n))}N(t,"CodeMirror-crosshair"),be(document,"keyup",n),be(document,"mouseover",n)}function ga(e){16==e.keyCode&&(this.doc.sel.shift=!1),Se(this,e)}function va(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField()||Kn(t.display,e)||Se(t,e)||e.ctrlKey&&!e.altKey||b&&e.metaKey)){var n=e.keyCode,i=e.charCode;if(d&&n==pa)return pa=null,void Pe(e);if(!d||e.which&&!(e.which<10)||!ua(t,e)){var r=String.fromCharCode(null==i?n:i);"\b"!=r&&(da(t,e,r)||t.display.input.onKeyPress(e))}}}var ya,ba,wa=400,xa=function(e,t,n){this.time=e,this.pos=t,this.button=n};function Ca(e,t){var n=+new Date;return ba&&ba.compare(n,e,t)?(ya=ba=null,"triple"):ya&&ya.compare(n,e,t)?(ba=new xa(n,e,t),ya=null,"double"):(ya=new xa(n,e,t),ba=null,"single")}function Sa(e){var t=this,n=t.display;if(!(Se(t,e)||n.activeTouch&&n.input.supportsTouch()))if(n.input.ensurePolled(),n.shift=e.shiftKey,Kn(n,e))l||(n.scroller.draggable=!1,setTimeout(function(){return n.scroller.draggable=!0},100));else if(!_a(t,e)){var i=ji(t,e),r=_e(e),s=i?Ca(i,r):"single";j(t).focus(),1==r&&t.state.selectingText&&t.state.selectingText(e),i&&ka(t,r,i,s,e)||(1==r?i?Ea(t,i,s,e):Ie(e)==n.scroller&&Pe(e):2==r?(i&&js(t.doc,i),setTimeout(function(){return n.input.focus()},20)):3==r&&(k?t.display.input.onContextMenu(e):tr(t)))}}function ka(e,t,n,i,r){var s="Click";return"double"==i?s="Double"+s:"triple"==i&&(s="Triple"+s),ca(e,qo(s=(1==t?"Left":2==t?"Middle":"Right")+s,r),r,function(t){if("string"==typeof t&&(t=na[t]),!t)return!1;var i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),i=t(e,n)!=Z}finally{e.state.suppressEdits=!1}return i})}function La(e,t,n){var i=e.getOption("configureMouse"),r=i?i(e,t,n):{};if(null==r.unit){var s=w?n.shiftKey&&n.metaKey:n.altKey;r.unit=s?"rectangle":"single"==t?"char":"double"==t?"word":"line"}return(null==r.extend||e.doc.extend)&&(r.extend=e.doc.extend||n.shiftKey),null==r.addNew&&(r.addNew=b?n.metaKey:n.ctrlKey),null==r.moveOnDrag&&(r.moveOnDrag=!(b?n.altKey:n.ctrlKey)),r}function Ea(e,t,n,i){o?setTimeout(H(er,e),0):e.curOp.focus=O(B(e));var r,s=La(e,n,i),a=e.doc.sel;e.options.dragDrop&&De&&!e.isReadOnly()&&"single"==n&&(r=a.contains(t))>-1&&(ut((r=a.ranges[r]).from(),t)<0||t.xRel>0)&&(ut(r.to(),t)>0||t.xRel<0)?Pa(e,i,t,s):Aa(e,i,t,s)}function Pa(e,t,n,i){var r=e.display,s=!1,c=Fr(e,function(t){l&&(r.scroller.draggable=!1),e.state.draggingText=!1,e.state.delayingBlurEvent&&(e.hasFocus()?e.state.delayingBlurEvent=!1:tr(e)),xe(r.wrapper.ownerDocument,"mouseup",c),xe(r.wrapper.ownerDocument,"mousemove",h),xe(r.scroller,"dragstart",u),xe(r.scroller,"drop",c),s||(Pe(t),i.addNew||js(e.doc,n,null,null,i.extend),l&&!p||o&&9==a?setTimeout(function(){r.wrapper.ownerDocument.body.focus({preventScroll:!0}),r.input.focus()},20):r.input.focus())}),h=function(e){s=s||Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)>=10},u=function(){return s=!0};l&&(r.scroller.draggable=!0),e.state.draggingText=c,c.copy=!i.moveOnDrag,be(r.wrapper.ownerDocument,"mouseup",c),be(r.wrapper.ownerDocument,"mousemove",h),be(r.scroller,"dragstart",u),be(r.scroller,"drop",c),e.state.delayingBlurEvent=!0,setTimeout(function(){return r.input.focus()},20),r.scroller.dragDrop&&r.scroller.dragDrop()}function Ta(e,t,n){if("char"==n)return new hs(t,t);if("word"==n)return e.findWordAt(t);if("line"==n)return new hs(ht(t.line,0),vt(e.doc,ht(t.line+1,0)));var i=n(e,t);return new hs(i.from,i.to)}function Aa(e,t,n,i){o&&tr(e);var r=e.display,s=e.doc;Pe(t);var a,l,c=s.sel,h=c.ranges;if(i.addNew&&!i.extend?(l=s.sel.contains(n),a=l>-1?h[l]:new hs(n,n)):(a=s.sel.primary(),l=s.sel.primIndex),"rectangle"==i.unit)i.addNew||(a=new hs(n,n)),n=ji(e,t,!0,!0),l=-1;else{var u=Ta(e,n,i.unit);a=i.extend?Vs(a,u.anchor,u.head,i.extend):u}i.addNew?-1==l?(l=h.length,$s(s,us(e,h.concat([a]),l),{scroll:!1,origin:"*mouse"})):h.length>1&&h[l].empty()&&"char"==i.unit&&!i.extend?($s(s,us(e,h.slice(0,l).concat(h.slice(l+1)),0),{scroll:!1,origin:"*mouse"}),c=s.sel):Us(s,l,a,K):(l=0,$s(s,new cs([a],0),K),c=s.sel);var d=n;function p(t){if(0!=ut(d,t))if(d=t,"rectangle"==i.unit){for(var r=[],o=e.options.tabSize,h=z(nt(s,n.line).text,n.ch,o),u=z(nt(s,t.line).text,t.ch,o),p=Math.min(h,u),f=Math.max(h,u),m=Math.min(n.line,t.line),g=Math.min(e.lastLine(),Math.max(n.line,t.line));m<=g;m++){var v=nt(s,m).text,y=X(v,p,o);p==f?r.push(new hs(ht(m,y),ht(m,y))):v.length>y&&r.push(new hs(ht(m,y),ht(m,X(v,f,o))))}r.length||r.push(new hs(n,n)),$s(s,us(e,c.ranges.slice(0,l).concat(r),l),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var b,w=a,x=Ta(e,t,i.unit),C=w.anchor;ut(x.anchor,C)>0?(b=x.head,C=mt(w.from(),x.anchor)):(b=x.anchor,C=ft(w.to(),x.head));var S=c.ranges.slice(0);S[l]=Ma(e,new hs(vt(s,C),b)),$s(s,us(e,S,l),K)}}var f=r.wrapper.getBoundingClientRect(),m=0;function g(t){var n=++m,o=ji(e,t,!0,"rectangle"==i.unit);if(o)if(0!=ut(o,d)){e.curOp.focus=O(B(e)),p(o);var a=or(r,s);(o.line>=a.to||o.line<a.from)&&setTimeout(Fr(e,function(){m==n&&g(t)}),150)}else{var l=t.clientY<f.top?-20:t.clientY>f.bottom?20:0;l&&setTimeout(Fr(e,function(){m==n&&(r.scroller.scrollTop+=l,g(t))}),50)}}function v(t){e.state.selectingText=!1,m=1/0,t&&(Pe(t),r.input.focus()),xe(r.wrapper.ownerDocument,"mousemove",y),xe(r.wrapper.ownerDocument,"mouseup",b),s.history.lastSelOrigin=null}var y=Fr(e,function(e){0!==e.buttons&&_e(e)?g(e):v(e)}),b=Fr(e,v);e.state.selectingText=b,be(r.wrapper.ownerDocument,"mousemove",y),be(r.wrapper.ownerDocument,"mouseup",b)}function Ma(e,t){var n=t.anchor,i=t.head,r=nt(e.doc,n.line);if(0==ut(n,i)&&n.sticky==i.sticky)return t;var s=ve(r);if(!s)return t;var o=me(s,n.ch,n.sticky),a=s[o];if(a.from!=n.ch&&a.to!=n.ch)return t;var l,c=o+(a.from==n.ch==(1!=a.level)?0:1);if(0==c||c==s.length)return t;if(i.line!=n.line)l=(i.line-n.line)*("ltr"==e.doc.direction?1:-1)>0;else{var h=me(s,i.ch,i.sticky),u=h-o||(i.ch-n.ch)*(1==a.level?-1:1);l=h==c-1||h==c?u<0:u>0}var d=s[c+(l?-1:0)],p=l==(1==d.level),f=p?d.from:d.to,m=p?"after":"before";return n.ch==f&&n.sticky==m?t:new hs(new ht(n.line,f,m),i)}function Ia(e,t,n,i){var r,s;if(t.touches)r=t.touches[0].clientX,s=t.touches[0].clientY;else try{r=t.clientX,s=t.clientY}catch(h){return!1}if(r>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;i&&Pe(t);var o=e.display,a=o.lineDiv.getBoundingClientRect();if(s>a.bottom||!Le(e,n))return Ae(t);s-=a.top-o.viewOffset;for(var l=0;l<e.display.gutterSpecs.length;++l){var c=o.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=r)return Ce(e,n,e,at(e.doc,s),e.display.gutterSpecs[l].className,t),Ae(t)}}function _a(e,t){return Ia(e,t,"gutterClick",!0)}function Oa(e,t){Kn(e.display,t)||Na(e,t)||Se(e,t,"contextmenu")||k||e.display.input.onContextMenu(t)}function Na(e,t){return!!Le(e,"gutterContextMenu")&&Ia(e,t,"gutterContextMenu",!1)}function Da(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),vi(e)}xa.prototype.compare=function(e,t,n){return this.time+wa>e&&0==ut(t,this.pos)&&n==this.button};var Ra={toString:function(){return"CodeMirror.Init"}},Fa={},Ba={};function Va(e){var t=e.optionHandlers;function n(n,i,r,s){e.defaults[n]=i,r&&(t[n]=s?function(e,t,n){n!=Ra&&r(e,t,n)}:r)}e.defineOption=n,e.Init=Ra,n("value","",function(e,t){return e.setValue(t)},!0),n("mode",null,function(e,t){e.doc.modeOption=t,ys(e)},!0),n("indentUnit",2,ys,!0),n("indentWithTabs",!1),n("smartIndent",!0),n("tabSize",4,function(e){bs(e),vi(e),Ui(e)},!0),n("lineSeparator",null,function(e,t){if(e.doc.lineSep=t,t){var n=[],i=e.doc.first;e.doc.iter(function(e){for(var r=0;;){var s=e.text.indexOf(t,r);if(-1==s)break;r=s+t.length,n.push(ht(i,s))}i++});for(var r=n.length-1;r>=0;r--)lo(e.doc,t,n[r],ht(n[r].line,n[r].ch+t.length))}}),n("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]/g,function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),n!=Ra&&e.refresh()}),n("specialCharPlaceholder",xn,function(e){return e.refresh()},!0),n("electricChars",!0),n("inputStyle",y?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),n("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),n("autocorrect",!1,function(e,t){return e.getInputField().autocorrect=t},!0),n("autocapitalize",!1,function(e,t){return e.getInputField().autocapitalize=t},!0),n("rtlMoveVisually",!x),n("wholeLineUpdateBefore",!0),n("theme","default",function(e){Da(e),ns(e)},!0),n("keyMap","default",function(e,t,n){var i=Yo(t),r=n!=Ra&&Yo(n);r&&r.detach&&r.detach(e,i),i.attach&&i.attach(e,r||null)}),n("extraKeys",null),n("configureMouse",null),n("lineWrapping",!1,Ha,!0),n("gutters",[],function(e,t){e.display.gutterSpecs=es(t,e.options.lineNumbers),ns(e)},!0),n("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?Fi(e.display)+"px":"0",e.refresh()},!0),n("coverGutterNextToScrollbar",!1,function(e){return Sr(e)},!0),n("scrollbarStyle","native",function(e){Er(e),Sr(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),n("lineNumbers",!1,function(e,t){e.display.gutterSpecs=es(e.options.gutters,t),ns(e)},!0),n("firstLineNumber",1,ns,!0),n("lineNumberFormatter",function(e){return e},ns,!0),n("showCursorWhenSelecting",!1,qi,!0),n("resetSelectionOnContextMenu",!0),n("lineWiseCopyCut",!0),n("pasteLinesPerSelection",!0),n("selectionsMayTouch",!1),n("readOnly",!1,function(e,t){"nocursor"==t&&(ir(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)}),n("screenReaderLabel",null,function(e,t){t=""===t?null:t,e.display.input.screenReaderLabelChanged(t)}),n("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),n("dragDrop",!0,ja),n("allowDropFileTypes",null),n("cursorBlinkRate",530),n("cursorScrollMargin",0),n("cursorHeight",1,qi,!0),n("singleCursorHeightPerLine",!0,qi,!0),n("workTime",100),n("workDelay",100),n("flattenSpans",!0,bs,!0),n("addModeClass",!1,bs,!0),n("pollInterval",100),n("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),n("historyEventDelay",1250),n("viewportMargin",10,function(e){return e.refresh()},!0),n("maxHighlightLength",1e4,bs,!0),n("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),n("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),n("autofocus",null),n("direction","ltr",function(e,t){return e.doc.setDirection(t)},!0),n("phrases",null)}function ja(e,t,n){if(!t!=!(n&&n!=Ra)){var i=e.display.dragFunctions,r=t?be:xe;r(e.display.scroller,"dragstart",i.start),r(e.display.scroller,"dragenter",i.enter),r(e.display.scroller,"dragover",i.over),r(e.display.scroller,"dragleave",i.leave),r(e.display.scroller,"drop",i.drop)}}function Ha(e){e.options.lineWrapping?(N(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(P(e.display.wrapper,"CodeMirror-wrap"),pn(e)),Vi(e),Ui(e),vi(e),setTimeout(function(){return Sr(e)},100)}function Ua(e,t){var n=this;if(!(this instanceof Ua))return new Ua(e,t);this.options=t=t?U(t):{},U(Fa,t,!1);var i=t.value;"string"==typeof i?i=new To(i,t.mode,null,t.lineSeparator,t.direction):t.mode&&(i.modeOption=t.mode),this.doc=i;var r=new Ua.inputStyles[t.inputStyle](this),s=this.display=new is(e,i,r,t);for(var c in s.wrapper.CodeMirror=this,Da(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Er(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new W,keySeq:null,specialChars:null},t.autofocus&&!y&&s.input.focus(),o&&a<11&&setTimeout(function(){return n.display.input.reset(!0)},20),za(this),Ro(),Tr(this),this.curOp.forceUpdate=!0,Ss(this,i),t.autofocus&&!y||this.hasFocus()?setTimeout(function(){n.hasFocus()&&!n.state.focused&&nr(n)},20):ir(this),Ba)Ba.hasOwnProperty(c)&&Ba[c](this,t[c],Ra);Qr(this),t.finishInit&&t.finishInit(this);for(var h=0;h<Wa.length;++h)Wa[h](this);Ar(this),l&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(s.lineDiv).textRendering&&(s.lineDiv.style.textRendering="auto")}function za(e){var t=e.display;be(t.scroller,"mousedown",Fr(e,Sa)),be(t.scroller,"dblclick",o&&a<11?Fr(e,function(t){if(!Se(e,t)){var n=ji(e,t);if(n&&!_a(e,t)&&!Kn(e.display,t)){Pe(t);var i=e.findWordAt(n);js(e.doc,i.anchor,i.head)}}}):function(t){return Se(e,t)||Pe(t)}),be(t.scroller,"contextmenu",function(t){return Oa(e,t)}),be(t.input.getField(),"contextmenu",function(n){t.scroller.contains(n.target)||Oa(e,n)});var n,i={end:0};function r(){t.activeTouch&&(n=setTimeout(function(){return t.activeTouch=null},1e3),(i=t.activeTouch).end=+new Date)}function s(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function l(e,t){if(null==t.left)return!0;var n=t.left-e.left,i=t.top-e.top;return n*n+i*i>400}be(t.scroller,"touchstart",function(r){if(!Se(e,r)&&!s(r)&&!_a(e,r)){t.input.ensurePolled(),clearTimeout(n);var o=+new Date;t.activeTouch={start:o,moved:!1,prev:o-i.end<=300?i:null},1==r.touches.length&&(t.activeTouch.left=r.touches[0].pageX,t.activeTouch.top=r.touches[0].pageY)}}),be(t.scroller,"touchmove",function(){t.activeTouch&&(t.activeTouch.moved=!0)}),be(t.scroller,"touchend",function(n){var i=t.activeTouch;if(i&&!Kn(t,n)&&null!=i.left&&!i.moved&&new Date-i.start<300){var s,o=e.coordsChar(t.activeTouch,"page");s=!i.prev||l(i,i.prev)?new hs(o,o):!i.prev.prev||l(i,i.prev.prev)?e.findWordAt(o):new hs(ht(o.line,0),vt(e.doc,ht(o.line+1,0))),e.setSelection(s.anchor,s.head),e.focus(),Pe(n)}r()}),be(t.scroller,"touchcancel",r),be(t.scroller,"scroll",function(){t.scroller.clientHeight&&(vr(e,t.scroller.scrollTop),br(e,t.scroller.scrollLeft,!0),Ce(e,"scroll",e))}),be(t.scroller,"mousewheel",function(t){return ls(e,t)}),be(t.scroller,"DOMMouseScroll",function(t){return ls(e,t)}),be(t.wrapper,"scroll",function(){return t.wrapper.scrollTop=t.wrapper.scrollLeft=0}),t.dragFunctions={enter:function(t){Se(e,t)||Me(t)},over:function(t){Se(e,t)||(_o(e,t),Me(t))},start:function(t){return Io(e,t)},drop:Fr(e,Mo),leave:function(t){Se(e,t)||Oo(e)}};var c=t.input.getField();be(c,"keyup",function(t){return ga.call(e,t)}),be(c,"keydown",Fr(e,fa)),be(c,"keypress",Fr(e,va)),be(c,"focus",function(t){return nr(e,t)}),be(c,"blur",function(t){return ir(e,t)})}Ua.defaults=Fa,Ua.optionHandlers=Ba;var Wa=[];function Ga(e,t,n,i){var r,s=e.doc;null==n&&(n="add"),"smart"==n&&(s.mode.indent?r=kt(e,t).state:n="prev");var o=e.options.tabSize,a=nt(s,t),l=z(a.text,null,o);a.stateAfter&&(a.stateAfter=null);var c,h=a.text.match(/^\s*/)[0];if(i||/\S/.test(a.text)){if("smart"==n&&((c=s.mode.indent(r,a.text.slice(h.length),a.text))==Z||c>150)){if(!i)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>s.first?z(nt(s,t-1).text,null,o):0:"add"==n?c=l+e.options.indentUnit:"subtract"==n?c=l-e.options.indentUnit:"number"==typeof n&&(c=l+n),c=Math.max(0,c);var u="",d=0;if(e.options.indentWithTabs)for(var p=Math.floor(c/o);p;--p)d+=o,u+="\t";if(d<c&&(u+=Q(c-d)),u!=h)return lo(s,u,ht(t,0),ht(t,h.length),"+input"),a.stateAfter=null,!0;for(var f=0;f<s.sel.ranges.length;f++){var m=s.sel.ranges[f];if(m.head.line==t&&m.head.ch<h.length){var g=ht(t,h.length);Us(s,f,new hs(g,g));break}}}Ua.defineInitHook=function(e){return Wa.push(e)};var $a=null;function Za(e){$a=e}function qa(e,t,n,i,r){var s=e.doc;e.display.shift=!1,i||(i=s.sel);var o=+new Date-200,a="paste"==r||e.state.pasteIncoming>o,l=Ve(t),c=null;if(a&&i.ranges.length>1)if($a&&$a.text.join("\n")==t){if(i.ranges.length%$a.text.length==0){c=[];for(var h=0;h<$a.text.length;h++)c.push(s.splitLines($a.text[h]))}}else l.length==i.ranges.length&&e.options.pasteLinesPerSelection&&(c=te(l,function(e){return[e]}));for(var u=e.curOp.updateInput,d=i.ranges.length-1;d>=0;d--){var p=i.ranges[d],f=p.from(),m=p.to();p.empty()&&(n&&n>0?f=ht(f.line,f.ch-n):e.state.overwrite&&!a?m=ht(m.line,Math.min(nt(s,m.line).text.length,m.ch+ee(l).length)):a&&$a&&$a.lineWise&&$a.text.join("\n")==l.join("\n")&&(f=m=ht(f.line,0)));var g={from:f,to:m,text:c?c[d%c.length]:l,origin:r||(a?"paste":e.state.cutIncoming>o?"cut":"+input")};no(e.doc,g),Nn(e,"inputRead",e,g)}t&&!a&&Ya(e,t),dr(e),e.curOp.updateInput<2&&(e.curOp.updateInput=u),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Ka(e,t){var n=e.clipboardData&&e.clipboardData.getData("Text");if(n)return e.preventDefault(),t.isReadOnly()||t.options.disableInput||!t.hasFocus()||Rr(t,function(){return qa(t,n,0,null,"paste")}),!0}function Ya(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,i=n.ranges.length-1;i>=0;i--){var r=n.ranges[i];if(!(r.head.ch>100||i&&n.ranges[i-1].head.line==r.head.line)){var s=e.getModeAt(r.head),o=!1;if(s.electricChars){for(var a=0;a<s.electricChars.length;a++)if(t.indexOf(s.electricChars.charAt(a))>-1){o=Ga(e,r.head.line,"smart");break}}else s.electricInput&&s.electricInput.test(nt(e.doc,r.head.line).text.slice(0,r.head.ch))&&(o=Ga(e,r.head.line,"smart"));o&&Nn(e,"electricInput",e,r.head.line)}}}function Xa(e){for(var t=[],n=[],i=0;i<e.doc.sel.ranges.length;i++){var r=e.doc.sel.ranges[i].head.line,s={anchor:ht(r,0),head:ht(r+1,0)};n.push(s),t.push(e.getRange(s.anchor,s.head))}return{text:t,ranges:n}}function Ja(e,t,n,i){e.setAttribute("autocorrect",n?"on":"off"),e.setAttribute("autocapitalize",i?"on":"off"),e.setAttribute("spellcheck",!!t)}function Qa(){var e=M("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),t=M("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return l?e.style.width="1000px":e.setAttribute("wrap","off"),g&&(e.style.border="1px solid black"),t}function el(e){var t=e.optionHandlers,n=e.helpers={};e.prototype={constructor:e,focus:function(){j(this).focus(),this.display.input.focus()},setOption:function(e,n){var i=this.options,r=i[e];i[e]==n&&"mode"!=e||(i[e]=n,t.hasOwnProperty(e)&&Fr(this,t[e])(this,n,r),Ce(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Yo(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:Br(function(t,n){var i=t.token?t:e.getMode(this.options,t);if(i.startState)throw new Error("Overlays may not be stateful.");ne(this.state.overlays,{mode:i,modeSpec:t,opaque:n&&n.opaque,priority:n&&n.priority||0},function(e){return e.priority}),this.state.modeGen++,Ui(this)}),removeOverlay:Br(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var i=t[n].modeSpec;if(i==e||"string"==typeof e&&i.name==e)return t.splice(n,1),this.state.modeGen++,void Ui(this)}}),indentLine:Br(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),lt(this.doc,e)&&Ga(this,e,t,n)}),indentSelection:Br(function(e){for(var t=this.doc.sel.ranges,n=-1,i=0;i<t.length;i++){var r=t[i];if(r.empty())r.head.line>n&&(Ga(this,r.head.line,e,!0),n=r.head.line,i==this.doc.sel.primIndex&&dr(this));else{var s=r.from(),o=r.to(),a=Math.max(n,s.line);n=Math.min(this.lastLine(),o.line-(o.ch?0:1))+1;for(var l=a;l<n;++l)Ga(this,l,e);var c=this.doc.sel.ranges;0==s.ch&&t.length==c.length&&c[i].from().ch>0&&Us(this.doc,i,new hs(s,c[i].to()),q)}}}),getTokenAt:function(e,t){return At(this,e,t)},getLineTokens:function(e,t){return At(this,ht(e),t,!0)},getTokenTypeAt:function(e){e=vt(this.doc,e);var t,n=St(this,nt(this.doc,e.line)),i=0,r=(n.length-1)/2,s=e.ch;if(0==s)t=n[2];else for(;;){var o=i+r>>1;if((o?n[2*o-1]:0)>=s)r=o;else{if(!(n[2*o+1]<s)){t=n[2*o+2];break}i=o+1}}var a=t?t.indexOf("overlay "):-1;return a<0?t:0==a?null:t.slice(0,a-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i=[];if(!n.hasOwnProperty(t))return i;var r=n[t],s=this.getModeAt(e);if("string"==typeof s[t])r[s[t]]&&i.push(r[s[t]]);else if(s[t])for(var o=0;o<s[t].length;o++){var a=r[s[t][o]];a&&i.push(a)}else s.helperType&&r[s.helperType]?i.push(r[s.helperType]):r[s.name]&&i.push(r[s.name]);for(var l=0;l<r._global.length;l++){var c=r._global[l];c.pred(s,this)&&-1==G(i,c.val)&&i.push(c.val)}return i},getStateAfter:function(e,t){var n=this.doc;return kt(this,(e=gt(n,null==e?n.first+n.size-1:e))+1,t).state},cursorCoords:function(e,t){var n=this.doc.sel.primary();return ki(this,null==e?n.head:"object"==typeof e?vt(this.doc,e):e?n.from():n.to(),t||"page")},charCoords:function(e,t){return Si(this,vt(this.doc,e),t||"page")},coordsChar:function(e,t){return Pi(this,(e=Ci(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Ci(this,{top:e,left:0},t||"page").top,at(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,n){var i,r=!1;if("number"==typeof e){var s=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>s&&(e=s,r=!0),i=nt(this.doc,e)}else i=e;return xi(this,i,{top:0,left:0},t||"page",n||r).top+(r?this.doc.height-un(i):0)},defaultTextHeight:function(){return Ni(this.display)},defaultCharWidth:function(){return Di(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,i,r){var s=this.display,o=(e=ki(this,vt(this.doc,e))).bottom,a=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),s.sizer.appendChild(t),"over"==i)o=e.top;else if("above"==i||"near"==i){var l=Math.max(s.wrapper.clientHeight,this.doc.height),c=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);("above"==i||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?o=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(o=e.bottom),a+t.offsetWidth>c&&(a=c-t.offsetWidth)}t.style.top=o+"px",t.style.left=t.style.right="","right"==r?(a=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?a=0:"middle"==r&&(a=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=a+"px"),n&&cr(this,{left:a,top:o,right:a+t.offsetWidth,bottom:o+t.offsetHeight})},triggerOnKeyDown:Br(fa),triggerOnKeyPress:Br(va),triggerOnKeyUp:ga,triggerOnMouseDown:Br(Sa),execCommand:function(e){if(na.hasOwnProperty(e))return na[e].call(null,this)},triggerElectric:Br(function(e){Ya(this,e)}),findPosH:function(e,t,n,i){var r=1;t<0&&(r=-1,t=-t);for(var s=vt(this.doc,e),o=0;o<t&&!(s=tl(this.doc,s,r,n,i)).hitSide;++o);return s},moveH:Br(function(e,t){var n=this;this.extendSelectionsBy(function(i){return n.display.shift||n.doc.extend||i.empty()?tl(n.doc,i.head,e,t,n.options.rtlMoveVisually):e<0?i.from():i.to()},Y)}),deleteH:Br(function(e,t){var n=this.doc.sel,i=this.doc;n.somethingSelected()?i.replaceSelection("",null,"+delete"):Xo(this,function(n){var r=tl(i,n.head,e,t,!1);return e<0?{from:r,to:n.head}:{from:n.head,to:r}})}),findPosV:function(e,t,n,i){var r=1,s=i;t<0&&(r=-1,t=-t);for(var o=vt(this.doc,e),a=0;a<t;++a){var l=ki(this,o,"div");if(null==s?s=l.left:l.left=s,(o=nl(this,l,r,n)).hitSide)break}return o},moveV:Br(function(e,t){var n=this,i=this.doc,r=[],s=!this.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(o){if(s)return e<0?o.from():o.to();var a=ki(n,o.head,"div");null!=o.goalColumn&&(a.left=o.goalColumn),r.push(a.left);var l=nl(n,a,e,t);return"page"==t&&o==i.sel.primary()&&ur(n,Si(n,l,"div").top-a.top),l},Y),r.length)for(var o=0;o<i.sel.ranges.length;o++)i.sel.ranges[o].goalColumn=r[o]}),findWordAt:function(e){var t=nt(this.doc,e.line).text,n=e.ch,i=e.ch;if(t){var r=this.getHelper(e,"wordChars");"before"!=e.sticky&&i!=t.length||!n?++i:--n;for(var s=t.charAt(n),o=ae(s,r)?function(e){return ae(e,r)}:/\s/.test(s)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!ae(e)};n>0&&o(t.charAt(n-1));)--n;for(;i<t.length&&o(t.charAt(i));)++i}return new hs(ht(e.line,n),ht(e.line,i))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?N(this.display.cursorDiv,"CodeMirror-overwrite"):P(this.display.cursorDiv,"CodeMirror-overwrite"),Ce(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==O(B(this))},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Br(function(e,t){pr(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Qn(this)-this.display.barHeight,width:e.scrollWidth-Qn(this)-this.display.barWidth,clientHeight:ti(this),clientWidth:ei(this)}},scrollIntoView:Br(function(e,t){null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:ht(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?fr(this,e):gr(this,e.from,e.to,e.margin)}),setSize:Br(function(e,t){var n=this,i=function(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e};null!=e&&(this.display.wrapper.style.width=i(e)),null!=t&&(this.display.wrapper.style.height=i(t)),this.options.lineWrapping&&gi(this);var r=this.display.viewFrom;this.doc.iter(r,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){zi(n,r,"widget");break}++r}),this.curOp.forceUpdate=!0,Ce(this,"refresh",this)}),operation:function(e){return Rr(this,e)},startOperation:function(){return Tr(this)},endOperation:function(){return Ar(this)},refresh:Br(function(){var e=this.display.cachedTextHeight;Ui(this),this.curOp.forceUpdate=!0,vi(this),pr(this,this.doc.scrollLeft,this.doc.scrollTop),Yr(this.display),(null==e||Math.abs(e-Ni(this.display))>.5||this.options.lineWrapping)&&Vi(this),Ce(this,"refresh",this)}),swapDoc:Br(function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),Ss(this,e),vi(this),this.display.input.reset(),pr(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,Nn(this,"swapDoc",this,t),t}),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ee(e),e.registerHelper=function(t,i,r){n.hasOwnProperty(t)||(n[t]=e[t]={_global:[]}),n[t][i]=r},e.registerGlobalHelper=function(t,i,r,s){e.registerHelper(t,i,s),n[t]._global.push({pred:r,val:s})}}function tl(e,t,n,i,r){var s=t,o=n,a=nt(e,t.line),l=r&&"rtl"==e.direction?-n:n;function c(){var n=t.line+l;return!(n<e.first||n>=e.first+e.size)&&(t=new ht(n,t.ch,t.sticky),a=nt(e,n))}function h(s){var o;if("codepoint"==i){var h=a.text.charCodeAt(t.ch+(n>0?0:-1));if(isNaN(h))o=null;else{var u=n>0?h>=55296&&h<56320:h>=56320&&h<57343;o=new ht(t.line,Math.max(0,Math.min(a.text.length,t.ch+n*(u?2:1))),-n)}}else o=r?ta(e.cm,a,t,n):Qo(a,t,n);if(null==o){if(s||!c())return!1;t=ea(r,e.cm,a,t.line,l)}else t=o;return!0}if("char"==i||"codepoint"==i)h();else if("column"==i)h(!0);else if("word"==i||"group"==i)for(var u=null,d="group"==i,p=e.cm&&e.cm.getHelper(t,"wordChars"),f=!0;!(n<0)||h(!f);f=!1){var m=a.text.charAt(t.ch)||"\n",g=ae(m,p)?"w":d&&"\n"==m?"n":!d||/\s/.test(m)?null:"p";if(!d||f||g||(g="s"),u&&u!=g){n<0&&(n=1,h(),t.sticky="after");break}if(g&&(u=g),n>0&&!h(!f))break}var v=Js(e,t,s,o,!0);return dt(s,v)&&(v.hitSide=!0),v}function nl(e,t,n,i){var r,s,o=e.doc,a=t.left;if("page"==i){var l=Math.min(e.display.wrapper.clientHeight,j(e).innerHeight||o(e).documentElement.clientHeight),c=Math.max(l-.5*Ni(e.display),3);r=(n>0?t.bottom:t.top)+n*c}else"line"==i&&(r=n>0?t.bottom+3:t.top-3);for(;(s=Pi(e,a,r)).outside;){if(n<0?r<=0:r>=o.height){s.hitSide=!0;break}r+=5*n}return s}var il=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new W,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function rl(e,t){var n=oi(e,t.line);if(!n||n.hidden)return null;var i=nt(e.doc,t.line),r=ii(n,i,t.line),s=ve(i,e.doc.direction),o="left";s&&(o=me(s,t.ch)%2?"right":"left");var a=ui(r.map,t.ch,o);return a.offset="right"==a.collapse?a.end:a.start,a}function sl(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}function ol(e,t){return t&&(e.bad=!0),e}function al(e,t,n,i,r){var s="",o=!1,a=e.doc.lineSeparator(),l=!1;function c(e){return function(t){return t.id==e}}function h(){o&&(s+=a,l&&(s+=a),o=l=!1)}function u(e){e&&(h(),s+=e)}function d(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(n)return void u(n);var s,p=t.getAttribute("cm-marker");if(p){var f=e.findMarks(ht(i,0),ht(r+1,0),c(+p));return void(f.length&&(s=f[0].find(0))&&u(it(e.doc,s.from,s.to).join(a)))}if("false"==t.getAttribute("contenteditable"))return;var m=/^(pre|div|p|li|table|br)$/i.test(t.nodeName);if(!/^br$/i.test(t.nodeName)&&0==t.textContent.length)return;m&&h();for(var g=0;g<t.childNodes.length;g++)d(t.childNodes[g]);/^(pre|p)$/i.test(t.nodeName)&&(l=!0),m&&(o=!0)}else 3==t.nodeType&&u(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;d(t),t!=n;)t=t.nextSibling,l=!1;return s}function ll(e,t,n){var i;if(t==e.display.lineDiv){if(!(i=e.display.lineDiv.childNodes[n]))return ol(e.clipPos(ht(e.display.viewTo-1)),!0);t=null,n=0}else for(i=t;;i=i.parentNode){if(!i||i==e.display.lineDiv)return null;if(i.parentNode&&i.parentNode==e.display.lineDiv)break}for(var r=0;r<e.display.view.length;r++){var s=e.display.view[r];if(s.node==i)return cl(s,t,n)}}function cl(e,t,n){var i=e.text.firstChild,r=!1;if(!t||!_(i,t))return ol(ht(ot(e.line),0),!0);if(t==i&&(r=!0,t=i.childNodes[n],n=0,!t)){var s=e.rest?ee(e.rest):e.line;return ol(ht(ot(s),s.text.length),r)}var o=3==t.nodeType?t:null,a=t;for(o||1!=t.childNodes.length||3!=t.firstChild.nodeType||(o=t.firstChild,n&&(n=o.nodeValue.length));a.parentNode!=i;)a=a.parentNode;var l=e.measure,c=l.maps;function h(t,n,i){for(var r=-1;r<(c?c.length:0);r++)for(var s=r<0?l.map:c[r],o=0;o<s.length;o+=3){var a=s[o+2];if(a==t||a==n){var h=ot(r<0?e.line:e.rest[r]),u=s[o]+i;return(i<0||a!=t)&&(u=s[o+(i?1:0)]),ht(h,u)}}}var u=h(o,a,n);if(u)return ol(u,r);for(var d=a.nextSibling,p=o?o.nodeValue.length-n:0;d;d=d.nextSibling){if(u=h(d,d.firstChild,0))return ol(ht(u.line,u.ch-p),r);p+=d.textContent.length}for(var f=a.previousSibling,m=n;f;f=f.previousSibling){if(u=h(f,f.firstChild,-1))return ol(ht(u.line,u.ch+m),r);m+=f.textContent.length}}il.prototype.init=function(e){var t=this,n=this,i=n.cm,r=n.div=e.lineDiv;function s(e){for(var t=e.target;t;t=t.parentNode){if(t==r)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(t.className))break}return!1}function o(e){if(s(e)&&!Se(i,e)){if(i.somethingSelected())Za({lineWise:!1,text:i.getSelections()}),"cut"==e.type&&i.replaceSelection("",null,"cut");else{if(!i.options.lineWiseCopyCut)return;var t=Xa(i);Za({lineWise:!0,text:t.text}),"cut"==e.type&&i.operation(function(){i.setSelections(t.ranges,0,q),i.replaceSelection("",null,"cut")})}if(e.clipboardData){e.clipboardData.clearData();var o=$a.text.join("\n");if(e.clipboardData.setData("Text",o),e.clipboardData.getData("Text")==o)return void e.preventDefault()}var a=Qa(),l=a.firstChild;Ja(l),i.display.lineSpace.insertBefore(a,i.display.lineSpace.firstChild),l.value=$a.text.join("\n");var c=O(V(r));R(l),setTimeout(function(){i.display.lineSpace.removeChild(a),c.focus(),c==r&&n.showPrimarySelection()},50)}}r.contentEditable=!0,Ja(r,i.options.spellcheck,i.options.autocorrect,i.options.autocapitalize),be(r,"paste",function(e){!s(e)||Se(i,e)||Ka(e,i)||a<=11&&setTimeout(Fr(i,function(){return t.updateFromDOM()}),20)}),be(r,"compositionstart",function(e){t.composing={data:e.data,done:!1}}),be(r,"compositionupdate",function(e){t.composing||(t.composing={data:e.data,done:!1})}),be(r,"compositionend",function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),be(r,"touchstart",function(){return n.forceCompositionEnd()}),be(r,"input",function(){t.composing||t.readFromDOMSoon()}),be(r,"copy",o),be(r,"cut",o)},il.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},il.prototype.prepareSelection=function(){var e=Ki(this.cm,!1);return e.focus=O(V(this.div))==this.div,e},il.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},il.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},il.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,i=t.doc.sel.primary(),r=i.from(),s=i.to();if(t.display.viewTo==t.display.viewFrom||r.line>=t.display.viewTo||s.line<t.display.viewFrom)e.removeAllRanges();else{var o=ll(t,e.anchorNode,e.anchorOffset),a=ll(t,e.focusNode,e.focusOffset);if(!o||o.bad||!a||a.bad||0!=ut(mt(o,a),r)||0!=ut(ft(o,a),s)){var l=t.display.view,c=r.line>=t.display.viewFrom&&rl(t,r)||{node:l[0].measure.map[2],offset:0},h=s.line<t.display.viewTo&&rl(t,s);if(!h){var u=l[l.length-1].measure,d=u.maps?u.maps[u.maps.length-1]:u.map;h={node:d[d.length-1],offset:d[d.length-2]-d[d.length-3]}}if(c&&h){var p,f=e.rangeCount&&e.getRangeAt(0);try{p=E(c.node,c.offset,h.offset,h.node)}catch(Be){}p&&(!n&&t.state.focused?(e.collapse(c.node,c.offset),p.collapsed||(e.removeAllRanges(),e.addRange(p))):(e.removeAllRanges(),e.addRange(p)),f&&null==e.anchorNode?e.addRange(f):n&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},il.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},il.prototype.showMultipleSelections=function(e){A(this.cm.display.cursorDiv,e.cursors),A(this.cm.display.selectionDiv,e.selection)},il.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},il.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return _(this.div,t)},il.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()&&O(V(this.div))==this.div||this.showSelection(this.prepareSelection(),!0),this.div.focus())},il.prototype.blur=function(){this.div.blur()},il.prototype.getField=function(){return this.div},il.prototype.supportsTouch=function(){return!0},il.prototype.receivedFocus=function(){var e=this,t=this;function n(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,n))}this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):Rr(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,n)},il.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},il.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var e=this.getSelection(),t=this.cm;if(v&&h&&this.cm.display.gutterSpecs.length&&sl(e.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var n=ll(t,e.anchorNode,e.anchorOffset),i=ll(t,e.focusNode,e.focusOffset);n&&i&&Rr(t,function(){$s(t.doc,ds(n,i),q),(n.bad||i.bad)&&(t.curOp.selectionChanged=!0)})}}},il.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t,n,i=this.cm,r=i.display,s=i.doc.sel.primary(),o=s.from(),a=s.to();if(0==o.ch&&o.line>i.firstLine()&&(o=ht(o.line-1,nt(i.doc,o.line-1).length)),a.ch==nt(i.doc,a.line).text.length&&a.line<i.lastLine()&&(a=ht(a.line+1,0)),o.line<r.viewFrom||a.line>r.viewTo-1)return!1;o.line==r.viewFrom||0==(e=Hi(i,o.line))?(t=ot(r.view[0].line),n=r.view[0].node):(t=ot(r.view[e].line),n=r.view[e-1].node.nextSibling);var l,c,h=Hi(i,a.line);if(h==r.view.length-1?(l=r.viewTo-1,c=r.lineDiv.lastChild):(l=ot(r.view[h+1].line)-1,c=r.view[h+1].node.previousSibling),!n)return!1;for(var u=i.doc.splitLines(al(i,n,c,t,l)),d=it(i.doc,ht(t,0),ht(l,nt(i.doc,l).text.length));u.length>1&&d.length>1;)if(ee(u)==ee(d))u.pop(),d.pop(),l--;else{if(u[0]!=d[0])break;u.shift(),d.shift(),t++}for(var p=0,f=0,m=u[0],g=d[0],v=Math.min(m.length,g.length);p<v&&m.charCodeAt(p)==g.charCodeAt(p);)++p;for(var y=ee(u),b=ee(d),w=Math.min(y.length-(1==u.length?p:0),b.length-(1==d.length?p:0));f<w&&y.charCodeAt(y.length-f-1)==b.charCodeAt(b.length-f-1);)++f;if(1==u.length&&1==d.length&&t==o.line)for(;p&&p>o.ch&&y.charCodeAt(y.length-f-1)==b.charCodeAt(b.length-f-1);)p--,f++;u[u.length-1]=y.slice(0,y.length-f).replace(/^\u200b+/,""),u[0]=u[0].slice(p).replace(/\u200b+$/,"");var x=ht(t,p),C=ht(l,d.length?ee(d).length-f:0);return u.length>1||u[0]||ut(x,C)?(lo(i.doc,u,x,C,"+input"),!0):void 0},il.prototype.ensurePolled=function(){this.forceCompositionEnd()},il.prototype.reset=function(){this.forceCompositionEnd()},il.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},il.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()},80))},il.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||Rr(this.cm,function(){return Ui(e.cm)})},il.prototype.setUneditable=function(e){e.contentEditable="false"},il.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly()||Fr(this.cm,qa)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},il.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},il.prototype.onContextMenu=function(){},il.prototype.resetPosition=function(){},il.prototype.needsContentAttribute=!0;var hl=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new W,this.hasSelection=!1,this.composing=null,this.resetting=!1};function ul(e,t){if((t=t?U(t):{}).value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),null==t.autofocus){var n=O(V(e));t.autofocus=n==e||null!=e.getAttribute("autofocus")&&n==document.body}function i(){e.value=a.getValue()}var r;if(e.form&&(be(e.form,"submit",i),!t.leaveSubmitMethodAlone)){var s=e.form;r=s.submit;try{var o=s.submit=function(){i(),s.submit=r,s.submit(),s.submit=o}}catch(Be){}}t.finishInit=function(n){n.save=i,n.getTextArea=function(){return e},n.toTextArea=function(){n.toTextArea=isNaN,i(),e.parentNode.removeChild(n.getWrapperElement()),e.style.display="",e.form&&(xe(e.form,"submit",i),t.leaveSubmitMethodAlone||"function"!=typeof e.form.submit||(e.form.submit=r))}},e.style.display="none";var a=Ua(function(t){return e.parentNode.insertBefore(t,e.nextSibling)},t);return a}function dl(e){e.off=xe,e.on=be,e.wheelEventPixels=as,e.Doc=To,e.splitLines=Ve,e.countColumn=z,e.findColumn=X,e.isWordChar=oe,e.Pass=Z,e.signal=Ce,e.Line=fn,e.changeEnd=ps,e.scrollbarModel=Lr,e.Pos=ht,e.cmpPos=ut,e.modes=We,e.mimeModes=Ge,e.resolveMode=qe,e.getMode=Ke,e.modeExtensions=Ye,e.extendMode=Xe,e.copyState=Je,e.startState=et,e.innerMode=Qe,e.commands=na,e.keyMap=zo,e.keyName=Ko,e.isModifierKey=Zo,e.lookupKey=$o,e.normalizeKeyMap=Go,e.StringStream=tt,e.SharedTextMarker=Co,e.TextMarker=wo,e.LineWidget=go,e.e_preventDefault=Pe,e.e_stopPropagation=Te,e.e_stop=Me,e.addClass=N,e.contains=_,e.rmClass=P,e.keyNames=Vo}hl.prototype.init=function(e){var t=this,n=this,i=this.cm;this.createField(e);var r=this.textarea;function s(e){if(!Se(i,e)){if(i.somethingSelected())Za({lineWise:!1,text:i.getSelections()});else{if(!i.options.lineWiseCopyCut)return;var t=Xa(i);Za({lineWise:!0,text:t.text}),"cut"==e.type?i.setSelections(t.ranges,null,q):(n.prevInput="",r.value=t.text.join("\n"),R(r))}"cut"==e.type&&(i.state.cutIncoming=+new Date)}}e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),g&&(r.style.width="0px"),be(r,"input",function(){o&&a>=9&&t.hasSelection&&(t.hasSelection=null),n.poll()}),be(r,"paste",function(e){Se(i,e)||Ka(e,i)||(i.state.pasteIncoming=+new Date,n.fastPoll())}),be(r,"cut",s),be(r,"copy",s),be(e.scroller,"paste",function(t){if(!Kn(e,t)&&!Se(i,t)){if(!r.dispatchEvent)return i.state.pasteIncoming=+new Date,void n.focus();var s=new Event("paste");s.clipboardData=t.clipboardData,r.dispatchEvent(s)}}),be(e.lineSpace,"selectstart",function(t){Kn(e,t)||Pe(t)}),be(r,"compositionstart",function(){var e=i.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}}),be(r,"compositionend",function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)})},hl.prototype.createField=function(e){this.wrapper=Qa(),this.textarea=this.wrapper.firstChild;var t=this.cm.options;Ja(this.textarea,t.spellcheck,t.autocorrect,t.autocapitalize)},hl.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},hl.prototype.prepareSelection=function(){var e=this.cm,t=e.display,n=e.doc,i=Ki(e);if(e.options.moveInputWithCursor){var r=ki(e,n.sel.primary().head,"div"),s=t.wrapper.getBoundingClientRect(),o=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+o.top-s.top)),i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+o.left-s.left))}return i},hl.prototype.showSelection=function(e){var t=this.cm.display;A(t.cursorDiv,e.cursors),A(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},hl.prototype.reset=function(e){if(!(this.contextMenuPending||this.composing&&e)){var t=this.cm;if(this.resetting=!0,t.somethingSelected()){this.prevInput="";var n=t.getSelection();this.textarea.value=n,t.state.focused&&R(this.textarea),o&&a>=9&&(this.hasSelection=n)}else e||(this.prevInput=this.textarea.value="",o&&a>=9&&(this.hasSelection=null));this.resetting=!1}},hl.prototype.getField=function(){return this.textarea},hl.prototype.supportsTouch=function(){return!1},hl.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!y||O(V(this.textarea))!=this.textarea))try{this.textarea.focus()}catch(Be){}},hl.prototype.blur=function(){this.textarea.blur()},hl.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},hl.prototype.receivedFocus=function(){this.slowPoll()},hl.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},hl.prototype.fastPoll=function(){var e=!1,t=this;function n(){t.poll()||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,n))}t.pollingFast=!0,t.polling.set(20,n)},hl.prototype.poll=function(){var e=this,t=this.cm,n=this.textarea,i=this.prevInput;if(this.contextMenuPending||this.resetting||!t.state.focused||je(n)&&!i&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var r=n.value;if(r==i&&!t.somethingSelected())return!1;if(o&&a>=9&&this.hasSelection===r||b&&/[\uf700-\uf7ff]/.test(r))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var s=r.charCodeAt(0);if(8203!=s||i||(i=""),8666==s)return this.reset(),this.cm.execCommand("undo")}for(var l=0,c=Math.min(i.length,r.length);l<c&&i.charCodeAt(l)==r.charCodeAt(l);)++l;return Rr(t,function(){qa(t,r.slice(l),i.length-l,null,e.composing?"*compose":null),r.length>1e3||r.indexOf("\n")>-1?n.value=e.prevInput="":e.prevInput=r,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},hl.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},hl.prototype.onKeyPress=function(){o&&a>=9&&(this.hasSelection=null),this.fastPoll()},hl.prototype.onContextMenu=function(e){var t=this,n=t.cm,i=n.display,r=t.textarea;t.contextMenuPending&&t.contextMenuPending();var s=ji(n,e),c=i.scroller.scrollTop;if(s&&!d){n.options.resetSelectionOnContextMenu&&-1==n.doc.sel.contains(s)&&Fr(n,$s)(n.doc,ds(s),q);var h,u=r.style.cssText,p=t.wrapper.style.cssText,f=t.wrapper.offsetParent.getBoundingClientRect();if(t.wrapper.style.cssText="position: static",r.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-f.top-5)+"px; left: "+(e.clientX-f.left-5)+"px;\n      z-index: 1000; background: "+(o?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",l&&(h=r.ownerDocument.defaultView.scrollY),i.input.focus(),l&&r.ownerDocument.defaultView.scrollTo(null,h),i.input.reset(),n.somethingSelected()||(r.value=t.prevInput=" "),t.contextMenuPending=v,i.selForContextMenu=n.doc.sel,clearTimeout(i.detectingSelectAll),o&&a>=9&&g(),k){Me(e);var m=function(){xe(window,"mouseup",m),setTimeout(v,20)};be(window,"mouseup",m)}else setTimeout(v,50)}function g(){if(null!=r.selectionStart){var e=n.somethingSelected(),s=""+(e?r.value:"");r.value="",r.value=s,t.prevInput=e?"":"",r.selectionStart=1,r.selectionEnd=s.length,i.selForContextMenu=n.doc.sel}}function v(){if(t.contextMenuPending==v&&(t.contextMenuPending=!1,t.wrapper.style.cssText=p,r.style.cssText=u,o&&a<9&&i.scrollbars.setScrollTop(i.scroller.scrollTop=c),null!=r.selectionStart)){(!o||o&&a<9)&&g();var e=0,s=function(){i.selForContextMenu==n.doc.sel&&0==r.selectionStart&&r.selectionEnd>0&&""==t.prevInput?Fr(n,eo)(n):e++<10?i.detectingSelectAll=setTimeout(s,500):(i.selForContextMenu=null,i.input.reset())};i.detectingSelectAll=setTimeout(s,200)}}},hl.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e,this.textarea.readOnly=!!e},hl.prototype.setUneditable=function(){},hl.prototype.needsContentAttribute=!1,Va(Ua),el(Ua);var pl="iter insert remove copy getEditor constructor".split(" ");for(var fl in To.prototype)To.prototype.hasOwnProperty(fl)&&G(pl,fl)<0&&(Ua.prototype[fl]=function(e){return function(){return e.apply(this.doc,arguments)}}(To.prototype[fl]));return Ee(To),Ua.inputStyles={textarea:hl,contenteditable:il},Ua.defineMode=function(e){Ua.defaults.mode||"null"==e||(Ua.defaults.mode=e),$e.apply(this,arguments)},Ua.defineMIME=Ze,Ua.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),Ua.defineMIME("text/plain","null"),Ua.defineExtension=function(e,t){Ua.prototype[e]=t},Ua.defineDocExtension=function(e,t){To.prototype[e]=t},Ua.fromTextArea=ul,dl(Ua),Ua.version="5.65.20",Ua}()),NV.exports}const RV=D(DV()),FV=qs().allowMultipleMatches.subexpression(Hy).toRegex(),BV=e=>{var t;const n=[];let i,r;for(;i=FV.exec(e);)if(r=null==(t=i.groups)?void 0:t.Number){const e={type:"Number",value:+r,string:r},t={start:i.index,end:i.index+r.length,literal:e};n.push(t)}return n};var VV;VV||(VV=1,function(e){var t={},n=/[^\s\u00a0]/,i=e.Pos,r=e.cmpPos;function s(e){var t=e.search(n);return-1==t?0:t}function o(e,t,n){return/\bstring\b/.test(e.getTokenTypeAt(i(t.line,0)))&&!/^[\'\"\`]/.test(n)}function a(e,t){var n=e.getMode();return!1!==n.useInnerComments&&n.innerMode?e.getModeAt(t):n}e.commands.toggleComment=function(e){e.toggleComment()},e.defineExtension("toggleComment",function(e){e||(e=t);for(var n=this,r=1/0,s=this.listSelections(),o=null,a=s.length-1;a>=0;a--){var l=s[a].from(),c=s[a].to();l.line>=r||(c.line>=r&&(c=i(r,0)),r=l.line,null==o?n.uncomment(l,c,e)?o="un":(n.lineComment(l,c,e),o="line"):"un"==o?n.uncomment(l,c,e):n.lineComment(l,c,e))}}),e.defineExtension("lineComment",function(e,r,l){l||(l=t);var c=this,h=a(c,e),u=c.getLine(e.line);if(null!=u&&!o(c,e,u)){var d=l.lineComment||h.lineComment;if(d){var p=Math.min(0!=r.ch||r.line==e.line?r.line+1:r.line,c.lastLine()+1),f=null==l.padding?" ":l.padding,m=l.commentBlankLines||e.line==r.line;c.operation(function(){if(l.indent){for(var t=null,r=e.line;r<p;++r){var o=-1===(a=c.getLine(r)).search(n)?a:a.slice(0,s(a));(null==t||t.length>o.length)&&(t=o)}for(r=e.line;r<p;++r){var a=c.getLine(r),h=t.length;(m||n.test(a))&&(a.slice(0,h)!=t&&(h=s(a)),c.replaceRange(t+d+f,i(r,0),i(r,h)))}}else for(r=e.line;r<p;++r)(m||n.test(c.getLine(r)))&&c.replaceRange(d+f,i(r,0))})}else(l.blockCommentStart||h.blockCommentStart)&&(l.fullLines=!0,c.blockComment(e,r,l))}}),e.defineExtension("blockComment",function(e,s,o){o||(o=t);var l=this,c=a(l,e),h=o.blockCommentStart||c.blockCommentStart,u=o.blockCommentEnd||c.blockCommentEnd;if(h&&u){if(!/\bcomment\b/.test(l.getTokenTypeAt(i(e.line,0)))){var d=Math.min(s.line,l.lastLine());d!=e.line&&0==s.ch&&n.test(l.getLine(d))&&--d;var p=null==o.padding?" ":o.padding;e.line>d||l.operation(function(){if(0!=o.fullLines){var t=n.test(l.getLine(d));l.replaceRange(p+u,i(d)),l.replaceRange(h+p,i(e.line,0));var a=o.blockCommentLead||c.blockCommentLead;if(null!=a)for(var f=e.line+1;f<=d;++f)(f!=d||t)&&l.replaceRange(a+p,i(f,0))}else{var m=0==r(l.getCursor("to"),s),g=!l.somethingSelected();l.replaceRange(u,s),m&&l.setSelection(g?s:l.getCursor("from"),s),l.replaceRange(h,e)}})}}else(o.lineComment||c.lineComment)&&0!=o.fullLines&&l.lineComment(e,s,o)}),e.defineExtension("uncomment",function(e,r,s){s||(s=t);var o,l=this,c=a(l,e),h=Math.min(0!=r.ch||r.line==e.line?r.line:r.line-1,l.lastLine()),u=Math.min(e.line,h),d=s.lineComment||c.lineComment,p=[],f=null==s.padding?" ":s.padding;e:if(d){for(var m=u;m<=h;++m){var g=l.getLine(m),v=g.indexOf(d);if(v>-1&&!/comment/.test(l.getTokenTypeAt(i(m,v+1)))&&(v=-1),-1==v&&n.test(g))break e;if(v>-1&&n.test(g.slice(0,v)))break e;p.push(g)}if(l.operation(function(){for(var e=u;e<=h;++e){var t=p[e-u],n=t.indexOf(d),r=n+d.length;n<0||(t.slice(r,r+f.length)==f&&(r+=f.length),o=!0,l.replaceRange("",i(e,n),i(e,r)))}}),o)return!0}var y=s.blockCommentStart||c.blockCommentStart,b=s.blockCommentEnd||c.blockCommentEnd;if(!y||!b)return!1;var w=s.blockCommentLead||c.blockCommentLead,x=l.getLine(u),C=x.indexOf(y);if(-1==C)return!1;var S=h==u?x:l.getLine(h),k=S.indexOf(b,h==u?C+y.length:0),L=i(u,C+1),E=i(h,k+1);if(-1==k||!/comment/.test(l.getTokenTypeAt(L))||!/comment/.test(l.getTokenTypeAt(E))||l.getRange(L,E,"\n").indexOf(b)>-1)return!1;var P=x.lastIndexOf(y,e.ch),T=-1==P?-1:x.slice(0,e.ch).indexOf(b,P+y.length);if(-1!=P&&-1!=T&&T+b.length!=e.ch)return!1;T=S.indexOf(b,r.ch);var A=S.slice(r.ch).lastIndexOf(y,T-r.ch);return P=-1==T||-1==A?-1:r.ch+A,(-1==T||-1==P||P==r.ch)&&(l.operation(function(){l.replaceRange("",i(h,k-(f&&S.slice(k-f.length,k)==f?f.length:0)),i(h,k+b.length));var e=C+y.length;if(f&&x.slice(e,e+f.length)==f&&(e+=f.length),l.replaceRange("",i(u,C),i(u,e)),w)for(var t=u+1;t<=h;++t){var r=l.getLine(t),s=r.indexOf(w);if(-1!=s&&!n.test(r.slice(0,s))){var o=s+w.length;f&&r.slice(o,o+f.length)==f&&(o+=f.length),l.replaceRange("",i(t,s),i(t,o))}}}),!0)})}(DV()));var jV;jV||(jV=1,function(e){var t=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),n=e.Pos,i={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function r(e){return e&&e.bracketRegex||/[(){}[\]]/}function s(e,t,s){var a=e.getLineHandle(t.line),l=t.ch-1,c=s&&s.afterCursor;null==c&&(c=/(^| )cm-fat-cursor($| )/.test(e.getWrapperElement().className));var h=r(s),u=!c&&l>=0&&h.test(a.text.charAt(l))&&i[a.text.charAt(l)]||h.test(a.text.charAt(l+1))&&i[a.text.charAt(++l)];if(!u)return null;var d=">"==u.charAt(1)?1:-1;if(s&&s.strict&&d>0!=(l==t.ch))return null;var p=e.getTokenTypeAt(n(t.line,l+1)),f=o(e,n(t.line,l+(d>0?1:0)),d,p,s);return null==f?null:{from:n(t.line,l),to:f&&f.pos,match:f&&f.ch==u.charAt(0),forward:d>0}}function o(e,t,s,o,a){for(var l=a&&a.maxScanLineLength||1e4,c=a&&a.maxScanLines||1e3,h=[],u=r(a),d=s>0?Math.min(t.line+c,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-c),p=t.line;p!=d;p+=s){var f=e.getLine(p);if(f){var m=s>0?0:f.length-1,g=s>0?f.length:-1;if(!(f.length>l))for(p==t.line&&(m=t.ch-(s<0?1:0));m!=g;m+=s){var v=f.charAt(m);if(u.test(v)&&(void 0===o||(e.getTokenTypeAt(n(p,m+1))||"")==(o||""))){var y=i[v];if(y&&">"==y.charAt(1)==s>0)h.push(v);else{if(!h.length)return{pos:n(p,m),ch:v};h.pop()}}}}}return p-s!=(s>0?e.lastLine():e.firstLine())&&null}function a(e,i,r){for(var o=e.state.matchBrackets.maxHighlightLineLength||1e3,a=r&&r.highlightNonMatching,l=[],c=e.listSelections(),h=0;h<c.length;h++){var u=c[h].empty()&&s(e,c[h].head,r);if(u&&(u.match||!1!==a)&&e.getLine(u.from.line).length<=o){var d=u.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";l.push(e.markText(u.from,n(u.from.line,u.from.ch+1),{className:d})),u.to&&e.getLine(u.to.line).length<=o&&l.push(e.markText(u.to,n(u.to.line,u.to.ch+1),{className:d}))}}if(l.length){t&&e.state.focused&&e.focus();var p=function(){e.operation(function(){for(var e=0;e<l.length;e++)l[e].clear()})};if(!i)return p;setTimeout(p,800)}}function l(e){e.operation(function(){e.state.matchBrackets.currentlyHighlighted&&(e.state.matchBrackets.currentlyHighlighted(),e.state.matchBrackets.currentlyHighlighted=null),e.state.matchBrackets.currentlyHighlighted=a(e,!1,e.state.matchBrackets)})}function c(e){e.state.matchBrackets&&e.state.matchBrackets.currentlyHighlighted&&(e.state.matchBrackets.currentlyHighlighted(),e.state.matchBrackets.currentlyHighlighted=null)}e.defineOption("matchBrackets",!1,function(t,n,i){i&&i!=e.Init&&(t.off("cursorActivity",l),t.off("focus",l),t.off("blur",c),c(t)),n&&(t.state.matchBrackets="object"==typeof n?n:{},t.on("cursorActivity",l),t.on("focus",l),t.on("blur",c))}),e.defineExtension("matchBrackets",function(){a(this,!0)}),e.defineExtension("findMatchingBracket",function(e,t,n){return(n||"boolean"==typeof t)&&(n?(n.strict=t,t=n):t=t?{strict:!0}:null),s(this,e,t)}),e.defineExtension("scanForBracket",function(e,t,n,i){return o(this,e,t,n,i)})}(DV()));var HV;HV||(HV=1,function(e){var t="CodeMirror-hint",n="CodeMirror-hint-active";function i(e,t){if(this.cm=e,this.options=t,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length,this.options.updateOnCursorActivity){var n=this;e.on("cursorActivity",this.activityFunc=function(){n.cursorActivity()})}}e.showHint=function(e,t,n){if(!t)return e.showHint(n);n&&n.async&&(t.async=!0);var i={hint:t};if(n)for(var r in n)i[r]=n[r];return e.showHint(i)},e.defineExtension("showHint",function(t){t=o(this,this.getCursor("start"),t);var n=this.listSelections();if(!(n.length>1)){if(this.somethingSelected()){if(!t.hint.supportsSelection)return;for(var r=0;r<n.length;r++)if(n[r].head.line!=n[r].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var s=this.state.completionActive=new i(this,t);s.options.hint&&(e.signal(this,"startCompletion",this),s.update(!0))}}),e.defineExtension("closeHint",function(){this.state.completionActive&&this.state.completionActive.close()});var r=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},s=window.cancelAnimationFrame||clearTimeout;function o(e,t,n){var i=e.options.hintOptions,r={};for(var s in f)r[s]=f[s];if(i)for(var s in i)void 0!==i[s]&&(r[s]=i[s]);if(n)for(var s in n)void 0!==n[s]&&(r[s]=n[s]);return r.hint.resolve&&(r.hint=r.hint.resolve(e,t)),r}function a(e){return"string"==typeof e?e:e.text}function l(e,t){var n={Up:function(){t.moveFocus(-1)},Down:function(){t.moveFocus(1)},PageUp:function(){t.moveFocus(1-t.menuSize(),!0)},PageDown:function(){t.moveFocus(t.menuSize()-1,!0)},Home:function(){t.setFocus(0)},End:function(){t.setFocus(t.length-1)},Enter:t.pick,Tab:t.pick,Esc:t.close};/Mac/.test(navigator.platform)&&(n["Ctrl-P"]=function(){t.moveFocus(-1)},n["Ctrl-N"]=function(){t.moveFocus(1)});var i=e.options.customKeys,r=i?{}:n;function s(e,i){var s;s="string"!=typeof i?function(e){return i(e,t)}:n.hasOwnProperty(i)?n[i]:i,r[e]=s}if(i)for(var o in i)i.hasOwnProperty(o)&&s(o,i[o]);var a=e.options.extraKeys;if(a)for(var o in a)a.hasOwnProperty(o)&&s(o,a[o]);return r}function c(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function h(i,r){this.id="cm-complete-"+Math.floor(Math.random(1e6)),this.completion=i,this.data=r,this.picked=!1;var s=this,o=i.cm,h=o.getInputField().ownerDocument,u=h.defaultView||h.parentWindow,d=this.hints=h.createElement("ul");d.setAttribute("role","listbox"),d.setAttribute("aria-expanded","true"),d.id=this.id;var p=i.cm.options.theme;d.className="CodeMirror-hints "+p,this.selectedHint=r.selectedHint||0;for(var f=r.list,m=0;m<f.length;++m){var g=d.appendChild(h.createElement("li")),v=f[m],y=t+(m!=this.selectedHint?"":" "+n);null!=v.className&&(y=v.className+" "+y),g.className=y,m==this.selectedHint&&g.setAttribute("aria-selected","true"),g.id=this.id+"-"+m,g.setAttribute("role","option"),v.render?v.render(g,r,v):g.appendChild(h.createTextNode(v.displayText||a(v))),g.hintId=m}var b=i.options.container||h.body,w=o.cursorCoords(i.options.alignWithWord?r.from:null),x=w.left,C=w.bottom,S=!0,k=0,L=0;if(b!==h.body){var E=-1!==["absolute","relative","fixed"].indexOf(u.getComputedStyle(b).position)?b:b.offsetParent,P=E.getBoundingClientRect(),T=h.body.getBoundingClientRect();k=P.left-T.left-E.scrollLeft,L=P.top-T.top-E.scrollTop}d.style.left=x-k+"px",d.style.top=C-L+"px";var A=u.innerWidth||Math.max(h.body.offsetWidth,h.documentElement.offsetWidth),M=u.innerHeight||Math.max(h.body.offsetHeight,h.documentElement.offsetHeight);b.appendChild(d),o.getInputField().setAttribute("aria-autocomplete","list"),o.getInputField().setAttribute("aria-owns",this.id),o.getInputField().setAttribute("aria-activedescendant",this.id+"-"+this.selectedHint);var I,_=i.options.moveOnOverlap?d.getBoundingClientRect():new DOMRect,O=!!i.options.paddingForScrollbar&&d.scrollHeight>d.clientHeight+1;if(setTimeout(function(){I=o.getScrollInfo()}),_.bottom-M>0){var N=_.bottom-_.top,D=_.top-(w.bottom-w.top)-2;M-_.top<D?(N>D&&(d.style.height=(N=D)+"px"),d.style.top=(C=w.top-N)-L+"px",S=!1):d.style.height=M-_.top-2+"px"}var R,F=_.right-A;if(O&&(F+=o.display.nativeBarWidth),F>0&&(_.right-_.left>A&&(d.style.width=A-5+"px",F-=_.right-_.left-A),d.style.left=(x=Math.max(w.left-F-k,0))+"px"),O)for(var B=d.firstChild;B;B=B.nextSibling)B.style.paddingRight=o.display.nativeBarWidth+"px";o.addKeyMap(this.keyMap=l(i,{moveFocus:function(e,t){s.changeActive(s.selectedHint+e,t)},setFocus:function(e){s.changeActive(e)},menuSize:function(){return s.screenAmount()},length:f.length,close:function(){i.close()},pick:function(){s.pick()},data:r})),i.options.closeOnUnfocus&&(o.on("blur",this.onBlur=function(){R=setTimeout(function(){i.close()},100)}),o.on("focus",this.onFocus=function(){clearTimeout(R)})),o.on("scroll",this.onScroll=function(){var e=o.getScrollInfo(),t=o.getWrapperElement().getBoundingClientRect();I||(I=o.getScrollInfo());var n=C+I.top-e.top,r=n-(u.pageYOffset||(h.documentElement||h.body).scrollTop);if(S||(r+=d.offsetHeight),r<=t.top||r>=t.bottom)return i.close();d.style.top=n+"px",d.style.left=x+I.left-e.left+"px"}),e.on(d,"dblclick",function(e){var t=c(d,e.target||e.srcElement);t&&null!=t.hintId&&(s.changeActive(t.hintId),s.pick())}),e.on(d,"click",function(e){var t=c(d,e.target||e.srcElement);t&&null!=t.hintId&&(s.changeActive(t.hintId),i.options.completeOnSingleClick&&s.pick())}),e.on(d,"mousedown",function(){setTimeout(function(){o.focus()},20)});var V=this.getSelectedHintRange();return 0===V.from&&0===V.to||this.scrollToActive(),e.signal(r,"select",f[this.selectedHint],d.childNodes[this.selectedHint]),!0}function u(e,t){if(!e.somethingSelected())return t;for(var n=[],i=0;i<t.length;i++)t[i].supportsSelection&&n.push(t[i]);return n}function d(e,t,n,i){if(e.async)e(t,i,n);else{var r=e(t,n);r&&r.then?r.then(i):i(r)}}function p(t,n){var i,r=t.getHelpers(n,"hint");if(r.length){var s=function(e,t,n){var i=u(e,r);function s(r){if(r==i.length)return t(null);d(i[r],e,n,function(e){e&&e.list.length>0?t(e):s(r+1)})}s(0)};return s.async=!0,s.supportsSelection=!0,s}return(i=t.getHelper(t.getCursor(),"hintWords"))?function(t){return e.hint.fromList(t,{words:i})}:e.hint.anyword?function(t,n){return e.hint.anyword(t,n)}:function(){}}i.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.options.updateOnCursorActivity&&this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&e.signal(this.data,"close"),this.widget&&this.widget.close(),e.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,n){var i=t.list[n],r=this;this.cm.operation(function(){i.hint?i.hint(r.cm,t,i):r.cm.replaceRange(a(i),i.from||t.from,i.to||t.to,"complete"),e.signal(t,"pick",i),r.cm.scrollIntoView()}),this.options.closeOnPick&&this.close()},cursorActivity:function(){this.debounce&&(s(this.debounce),this.debounce=0);var e=this.startPos;this.data&&(e=this.data.from);var t=this.cm.getCursor(),n=this.cm.getLine(t.line);if(t.line!=this.startPos.line||n.length-t.ch!=this.startLen-this.startPos.ch||t.ch<e.ch||this.cm.somethingSelected()||!t.ch||this.options.closeCharacters.test(n.charAt(t.ch-1)))this.close();else{var i=this;this.debounce=r(function(){i.update()}),this.widget&&this.widget.disable()}},update:function(e){if(null!=this.tick){var t=this,n=++this.tick;d(this.options.hint,this.cm,this.options,function(i){t.tick==n&&t.finishUpdate(i,e)})}},finishUpdate:function(t,n){this.data&&e.signal(this.data,"update");var i=this.widget&&this.widget.picked||n&&this.options.completeSingle;this.widget&&this.widget.close(),this.data=t,t&&t.list.length&&(i&&1==t.list.length?this.pick(t,0):(this.widget=new h(this,t),e.signal(t,"shown")))}},h.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode&&this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var e=this.completion.cm.getInputField();e.removeAttribute("aria-activedescendant"),e.removeAttribute("aria-owns");var t=this.completion.cm;this.completion.options.closeOnUnfocus&&(t.off("blur",this.onBlur),t.off("focus",this.onFocus)),t.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,i){if(t>=this.data.list.length?t=i?this.data.list.length-1:0:t<0&&(t=i?0:this.data.list.length-1),this.selectedHint!=t){var r=this.hints.childNodes[this.selectedHint];r&&(r.className=r.className.replace(" "+n,""),r.removeAttribute("aria-selected")),(r=this.hints.childNodes[this.selectedHint=t]).className+=" "+n,r.setAttribute("aria-selected","true"),this.completion.cm.getInputField().setAttribute("aria-activedescendant",r.id),this.scrollToActive(),e.signal(this.data,"select",this.data.list[this.selectedHint],r)}},scrollToActive:function(){var e=this.getSelectedHintRange(),t=this.hints.childNodes[e.from],n=this.hints.childNodes[e.to],i=this.hints.firstChild;t.offsetTop<this.hints.scrollTop?this.hints.scrollTop=t.offsetTop-i.offsetTop:n.offsetTop+n.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=n.offsetTop+n.offsetHeight-this.hints.clientHeight+i.offsetTop)},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1},getSelectedHintRange:function(){var e=this.completion.options.scrollMargin||0;return{from:Math.max(0,this.selectedHint-e),to:Math.min(this.data.list.length-1,this.selectedHint+e)}}},e.registerHelper("hint","auto",{resolve:p}),e.registerHelper("hint","fromList",function(t,n){var i,r=t.getCursor(),s=t.getTokenAt(r),o=e.Pos(r.line,s.start),a=r;s.start<r.ch&&/\w/.test(s.string.charAt(r.ch-s.start-1))?i=s.string.substr(0,r.ch-s.start):(i="",o=r);for(var l=[],c=0;c<n.words.length;c++){var h=n.words[c];h.slice(0,i.length)==i&&l.push(h)}if(l.length)return{list:l,from:o,to:a}}),e.commands.autocomplete=e.showHint;var f={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnPick:!0,closeOnUnfocus:!0,updateOnCursorActivity:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null,paddingForScrollbar:!0,moveOnOverlap:!0};e.defineOption("hintOptions",null)}(DV()));var UV,zV;UV||(UV=1,(zV=DV()).defineMode("javascript",function(e,t){var n,i,r=e.indentUnit,s=t.statementIndent,o=t.jsonld,a=t.json||o,l=!1!==t.trackScope,c=t.typescript,h=t.wordCharacters||/[\w$\xa1-\uffff]/,u=function(){function e(e){return{type:e,style:"keyword"}}var t=e("keyword a"),n=e("keyword b"),i=e("keyword c"),r=e("keyword d"),s=e("operator"),o={type:"atom",style:"atom"};return{if:e("if"),while:t,with:t,else:n,do:n,try:n,finally:n,return:r,break:r,continue:r,new:e("new"),delete:i,void:i,throw:i,debugger:e("debugger"),var:e("var"),const:e("var"),let:e("var"),function:e("function"),catch:e("catch"),for:e("for"),switch:e("switch"),case:e("case"),default:e("default"),in:s,typeof:s,instanceof:s,true:o,false:o,null:o,undefined:o,NaN:o,Infinity:o,this:e("this"),class:e("class"),super:e("atom"),yield:i,export:e("export"),import:e("import"),extends:i,await:i}}(),d=/[+\-*&%=<>!?|~^@]/,p=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function f(e){for(var t,n=!1,i=!1;null!=(t=e.next());){if(!n){if("/"==t&&!i)return;"["==t?i=!0:i&&"]"==t&&(i=!1)}n=!n&&"\\"==t}}function m(e,t,r){return n=e,i=r,t}function g(e,t){var n=e.next();if('"'==n||"'"==n)return t.tokenize=v(n),t.tokenize(e,t);if("."==n&&e.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return m("number","number");if("."==n&&e.match(".."))return m("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(n))return m(n);if("="==n&&e.eat(">"))return m("=>","operator");if("0"==n&&e.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return m("number","number");if(/\d/.test(n))return e.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),m("number","number");if("/"==n)return e.eat("*")?(t.tokenize=y,y(e,t)):e.eat("/")?(e.skipToEnd(),m("comment","comment")):it(e,t,1)?(f(e),e.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),m("regexp","string-2")):(e.eat("="),m("operator","operator",e.current()));if("`"==n)return t.tokenize=b,b(e,t);if("#"==n&&"!"==e.peek())return e.skipToEnd(),m("meta","meta");if("#"==n&&e.eatWhile(h))return m("variable","property");if("<"==n&&e.match("!--")||"-"==n&&e.match("->")&&!/\S/.test(e.string.slice(0,e.start)))return e.skipToEnd(),m("comment","comment");if(d.test(n))return">"==n&&t.lexical&&">"==t.lexical.type||(e.eat("=")?"!"!=n&&"="!=n||e.eat("="):/[<>*+\-|&?]/.test(n)&&(e.eat(n),">"==n&&e.eat(n))),"?"==n&&e.eat(".")?m("."):m("operator","operator",e.current());if(h.test(n)){e.eatWhile(h);var i=e.current();if("."!=t.lastType){if(u.propertyIsEnumerable(i)){var r=u[i];return m(r.type,r.style,i)}if("async"==i&&e.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return m("async","keyword",i)}return m("variable","variable",i)}}function v(e){return function(t,n){var i,r=!1;if(o&&"@"==t.peek()&&t.match(p))return n.tokenize=g,m("jsonld-keyword","meta");for(;null!=(i=t.next())&&(i!=e||r);)r=!r&&"\\"==i;return r||(n.tokenize=g),m("string","string")}}function y(e,t){for(var n,i=!1;n=e.next();){if("/"==n&&i){t.tokenize=g;break}i="*"==n}return m("comment","comment")}function b(e,t){for(var n,i=!1;null!=(n=e.next());){if(!i&&("`"==n||"$"==n&&e.eat("{"))){t.tokenize=g;break}i=!i&&"\\"==n}return m("quasi","string-2",e.current())}var w="([{}])";function x(e,t){t.fatArrowAt&&(t.fatArrowAt=null);var n=e.string.indexOf("=>",e.start);if(!(n<0)){if(c){var i=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(e.string.slice(e.start,n));i&&(n=i.index)}for(var r=0,s=!1,o=n-1;o>=0;--o){var a=e.string.charAt(o),l=w.indexOf(a);if(l>=0&&l<3){if(!r){++o;break}if(0==--r){"("==a&&(s=!0);break}}else if(l>=3&&l<6)++r;else if(h.test(a))s=!0;else if(/["'\/`]/.test(a))for(;;--o){if(0==o)return;if(e.string.charAt(o-1)==a&&"\\"!=e.string.charAt(o-2)){o--;break}}else if(s&&!r){++o;break}}s&&!r&&(t.fatArrowAt=o)}}var C={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function S(e,t,n,i,r,s){this.indented=e,this.column=t,this.type=n,this.prev=r,this.info=s,null!=i&&(this.align=i)}function k(e,t){if(!l)return!1;for(var n=e.localVars;n;n=n.next)if(n.name==t)return!0;for(var i=e.context;i;i=i.prev)for(n=i.vars;n;n=n.next)if(n.name==t)return!0}function L(e,t,n,i,r){var s=e.cc;for(E.state=e,E.stream=r,E.marked=null,E.cc=s,E.style=t,e.lexical.hasOwnProperty("align")||(e.lexical.align=!0);;)if((s.length?s.pop():a?W:U)(n,i)){for(;s.length&&s[s.length-1].lex;)s.pop()();return E.marked?E.marked:"variable"==n&&k(e,i)?"variable-2":t}}var E={state:null,marked:null,cc:null};function P(){for(var e=arguments.length-1;e>=0;e--)E.cc.push(arguments[e])}function T(){return P.apply(null,arguments),!0}function A(e,t){for(var n=t;n;n=n.next)if(n.name==e)return!0;return!1}function M(e){var n=E.state;if(E.marked="def",l){if(n.context)if("var"==n.lexical.info&&n.context&&n.context.block){var i=I(e,n.context);if(null!=i)return void(n.context=i)}else if(!A(e,n.localVars))return void(n.localVars=new N(e,n.localVars));t.globalVars&&!A(e,n.globalVars)&&(n.globalVars=new N(e,n.globalVars))}}function I(e,t){if(t){if(t.block){var n=I(e,t.prev);return n?n==t.prev?t:new O(n,t.vars,!0):null}return A(e,t.vars)?t:new O(t.prev,new N(e,t.vars),!1)}return null}function _(e){return"public"==e||"private"==e||"protected"==e||"abstract"==e||"readonly"==e}function O(e,t,n){this.prev=e,this.vars=t,this.block=n}function N(e,t){this.name=e,this.next=t}var D=new N("this",new N("arguments",null));function R(){E.state.context=new O(E.state.context,E.state.localVars,!1),E.state.localVars=D}function F(){E.state.context=new O(E.state.context,E.state.localVars,!0),E.state.localVars=null}function B(){E.state.localVars=E.state.context.vars,E.state.context=E.state.context.prev}function V(e,t){var n=function(){var n=E.state,i=n.indented;if("stat"==n.lexical.type)i=n.lexical.indented;else for(var r=n.lexical;r&&")"==r.type&&r.align;r=r.prev)i=r.indented;n.lexical=new S(i,E.stream.column(),e,null,n.lexical,t)};return n.lex=!0,n}function j(){var e=E.state;e.lexical.prev&&(")"==e.lexical.type&&(e.indented=e.lexical.indented),e.lexical=e.lexical.prev)}function H(e){function t(n){return n==e?T():";"==e||"}"==n||")"==n||"]"==n?P():T(t)}return t}function U(e,t){return"var"==e?T(V("vardef",t),Pe,H(";"),j):"keyword a"==e?T(V("form"),$,U,j):"keyword b"==e?T(V("form"),U,j):"keyword d"==e?E.stream.match(/^\s*$/,!1)?T():T(V("stat"),q,H(";"),j):"debugger"==e?T(H(";")):"{"==e?T(V("}"),F,ue,j,B):";"==e?T():"if"==e?("else"==E.state.lexical.info&&E.state.cc[E.state.cc.length-1]==j&&E.state.cc.pop()(),T(V("form"),$,U,j,Oe)):"function"==e?T(Fe):"for"==e?T(V("form"),F,Ne,U,B,j):"class"==e||c&&"interface"==t?(E.marked="keyword",T(V("form","class"==e?e:t),Ue,j)):"variable"==e?c&&"declare"==t?(E.marked="keyword",T(U)):c&&("module"==t||"enum"==t||"type"==t)&&E.stream.match(/^\s*\w/,!1)?(E.marked="keyword","enum"==t?T(et):"type"==t?T(Ve,H("operator"),ge,H(";")):T(V("form"),Te,H("{"),V("}"),ue,j,j)):c&&"namespace"==t?(E.marked="keyword",T(V("form"),W,U,j)):c&&"abstract"==t?(E.marked="keyword",T(U)):T(V("stat"),re):"switch"==e?T(V("form"),$,H("{"),V("}","switch"),F,ue,j,j,B):"case"==e?T(W,H(":")):"default"==e?T(H(":")):"catch"==e?T(V("form"),R,z,U,j,B):"export"==e?T(V("stat"),$e,j):"import"==e?T(V("stat"),qe,j):"async"==e?T(U):"@"==t?T(W,U):P(V("stat"),W,H(";"),j)}function z(e){if("("==e)return T(je,H(")"))}function W(e,t){return Z(e,t,!1)}function G(e,t){return Z(e,t,!0)}function $(e){return"("!=e?P():T(V(")"),q,H(")"),j)}function Z(e,t,n){if(E.state.fatArrowAt==E.stream.start){var i=n?ee:Q;if("("==e)return T(R,V(")"),ce(je,")"),j,H("=>"),i,B);if("variable"==e)return P(R,Te,H("=>"),i,B)}var r=n?Y:K;return C.hasOwnProperty(e)?T(r):"function"==e?T(Fe,r):"class"==e||c&&"interface"==t?(E.marked="keyword",T(V("form"),He,j)):"keyword c"==e||"async"==e?T(n?G:W):"("==e?T(V(")"),q,H(")"),j,r):"operator"==e||"spread"==e?T(n?G:W):"["==e?T(V("]"),Qe,j,r):"{"==e?he(oe,"}",null,r):"quasi"==e?P(X,r):"new"==e?T(te(n)):T()}function q(e){return e.match(/[;\}\)\],]/)?P():P(W)}function K(e,t){return","==e?T(q):Y(e,t,!1)}function Y(e,t,n){var i=0==n?K:Y,r=0==n?W:G;return"=>"==e?T(R,n?ee:Q,B):"operator"==e?/\+\+|--/.test(t)||c&&"!"==t?T(i):c&&"<"==t&&E.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?T(V(">"),ce(ge,">"),j,i):"?"==t?T(W,H(":"),r):T(r):"quasi"==e?P(X,i):";"!=e?"("==e?he(G,")","call",i):"."==e?T(se,i):"["==e?T(V("]"),q,H("]"),j,i):c&&"as"==t?(E.marked="keyword",T(ge,i)):"regexp"==e?(E.state.lastType=E.marked="operator",E.stream.backUp(E.stream.pos-E.stream.start-1),T(r)):void 0:void 0}function X(e,t){return"quasi"!=e?P():"${"!=t.slice(t.length-2)?T(X):T(q,J)}function J(e){if("}"==e)return E.marked="string-2",E.state.tokenize=b,T(X)}function Q(e){return x(E.stream,E.state),P("{"==e?U:W)}function ee(e){return x(E.stream,E.state),P("{"==e?U:G)}function te(e){return function(t){return"."==t?T(e?ie:ne):"variable"==t&&c?T(ke,e?Y:K):P(e?G:W)}}function ne(e,t){if("target"==t)return E.marked="keyword",T(K)}function ie(e,t){if("target"==t)return E.marked="keyword",T(Y)}function re(e){return":"==e?T(j,U):P(K,H(";"),j)}function se(e){if("variable"==e)return E.marked="property",T()}function oe(e,t){return"async"==e?(E.marked="property",T(oe)):"variable"==e||"keyword"==E.style?(E.marked="property","get"==t||"set"==t?T(ae):(c&&E.state.fatArrowAt==E.stream.start&&(n=E.stream.match(/^\s*:\s*/,!1))&&(E.state.fatArrowAt=E.stream.pos+n[0].length),T(le))):"number"==e||"string"==e?(E.marked=o?"property":E.style+" property",T(le)):"jsonld-keyword"==e?T(le):c&&_(t)?(E.marked="keyword",T(oe)):"["==e?T(W,de,H("]"),le):"spread"==e?T(G,le):"*"==t?(E.marked="keyword",T(oe)):":"==e?P(le):void 0;var n}function ae(e){return"variable"!=e?P(le):(E.marked="property",T(Fe))}function le(e){return":"==e?T(G):"("==e?P(Fe):void 0}function ce(e,t,n){function i(r,s){if(n?n.indexOf(r)>-1:","==r){var o=E.state.lexical;return"call"==o.info&&(o.pos=(o.pos||0)+1),T(function(n,i){return n==t||i==t?P():P(e)},i)}return r==t||s==t?T():n&&n.indexOf(";")>-1?P(e):T(H(t))}return function(n,r){return n==t||r==t?T():P(e,i)}}function he(e,t,n){for(var i=3;i<arguments.length;i++)E.cc.push(arguments[i]);return T(V(t,n),ce(e,t),j)}function ue(e){return"}"==e?T():P(U,ue)}function de(e,t){if(c){if(":"==e)return T(ge);if("?"==t)return T(de)}}function pe(e,t){if(c&&(":"==e||"in"==t))return T(ge)}function fe(e){if(c&&":"==e)return E.stream.match(/^\s*\w+\s+is\b/,!1)?T(W,me,ge):T(ge)}function me(e,t){if("is"==t)return E.marked="keyword",T()}function ge(e,t){return"keyof"==t||"typeof"==t||"infer"==t||"readonly"==t?(E.marked="keyword",T("typeof"==t?G:ge)):"variable"==e||"void"==t?(E.marked="type",T(Se)):"|"==t||"&"==t?T(ge):"string"==e||"number"==e||"atom"==e?T(Se):"["==e?T(V("]"),ce(ge,"]",","),j,Se):"{"==e?T(V("}"),ye,j,Se):"("==e?T(ce(Ce,")"),ve,Se):"<"==e?T(ce(ge,">"),ge):"quasi"==e?P(we,Se):void 0}function ve(e){if("=>"==e)return T(ge)}function ye(e){return e.match(/[\}\)\]]/)?T():","==e||";"==e?T(ye):P(be,ye)}function be(e,t){return"variable"==e||"keyword"==E.style?(E.marked="property",T(be)):"?"==t||"number"==e||"string"==e?T(be):":"==e?T(ge):"["==e?T(H("variable"),pe,H("]"),be):"("==e?P(Be,be):e.match(/[;\}\)\],]/)?void 0:T()}function we(e,t){return"quasi"!=e?P():"${"!=t.slice(t.length-2)?T(we):T(ge,xe)}function xe(e){if("}"==e)return E.marked="string-2",E.state.tokenize=b,T(we)}function Ce(e,t){return"variable"==e&&E.stream.match(/^\s*[?:]/,!1)||"?"==t?T(Ce):":"==e?T(ge):"spread"==e?T(Ce):P(ge)}function Se(e,t){return"<"==t?T(V(">"),ce(ge,">"),j,Se):"|"==t||"."==e||"&"==t?T(ge):"["==e?T(ge,H("]"),Se):"extends"==t||"implements"==t?(E.marked="keyword",T(ge)):"?"==t?T(ge,H(":"),ge):void 0}function ke(e,t){if("<"==t)return T(V(">"),ce(ge,">"),j,Se)}function Le(){return P(ge,Ee)}function Ee(e,t){if("="==t)return T(ge)}function Pe(e,t){return"enum"==t?(E.marked="keyword",T(et)):P(Te,de,Ie,_e)}function Te(e,t){return c&&_(t)?(E.marked="keyword",T(Te)):"variable"==e?(M(t),T()):"spread"==e?T(Te):"["==e?he(Me,"]"):"{"==e?he(Ae,"}"):void 0}function Ae(e,t){return"variable"!=e||E.stream.match(/^\s*:/,!1)?("variable"==e&&(E.marked="property"),"spread"==e?T(Te):"}"==e?P():"["==e?T(W,H("]"),H(":"),Ae):T(H(":"),Te,Ie)):(M(t),T(Ie))}function Me(){return P(Te,Ie)}function Ie(e,t){if("="==t)return T(G)}function _e(e){if(","==e)return T(Pe)}function Oe(e,t){if("keyword b"==e&&"else"==t)return T(V("form","else"),U,j)}function Ne(e,t){return"await"==t?T(Ne):"("==e?T(V(")"),De,j):void 0}function De(e){return"var"==e?T(Pe,Re):"variable"==e?T(Re):P(Re)}function Re(e,t){return")"==e?T():";"==e?T(Re):"in"==t||"of"==t?(E.marked="keyword",T(W,Re)):P(W,Re)}function Fe(e,t){return"*"==t?(E.marked="keyword",T(Fe)):"variable"==e?(M(t),T(Fe)):"("==e?T(R,V(")"),ce(je,")"),j,fe,U,B):c&&"<"==t?T(V(">"),ce(Le,">"),j,Fe):void 0}function Be(e,t){return"*"==t?(E.marked="keyword",T(Be)):"variable"==e?(M(t),T(Be)):"("==e?T(R,V(")"),ce(je,")"),j,fe,B):c&&"<"==t?T(V(">"),ce(Le,">"),j,Be):void 0}function Ve(e,t){return"keyword"==e||"variable"==e?(E.marked="type",T(Ve)):"<"==t?T(V(">"),ce(Le,">"),j):void 0}function je(e,t){return"@"==t&&T(W,je),"spread"==e?T(je):c&&_(t)?(E.marked="keyword",T(je)):c&&"this"==e?T(de,Ie):P(Te,de,Ie)}function He(e,t){return"variable"==e?Ue(e,t):ze(e,t)}function Ue(e,t){if("variable"==e)return M(t),T(ze)}function ze(e,t){return"<"==t?T(V(">"),ce(Le,">"),j,ze):"extends"==t||"implements"==t||c&&","==e?("implements"==t&&(E.marked="keyword"),T(c?ge:W,ze)):"{"==e?T(V("}"),We,j):void 0}function We(e,t){return"async"==e||"variable"==e&&("static"==t||"get"==t||"set"==t||c&&_(t))&&E.stream.match(/^\s+#?[\w$\xa1-\uffff]/,!1)?(E.marked="keyword",T(We)):"variable"==e||"keyword"==E.style?(E.marked="property",T(Ge,We)):"number"==e||"string"==e?T(Ge,We):"["==e?T(W,de,H("]"),Ge,We):"*"==t?(E.marked="keyword",T(We)):c&&"("==e?P(Be,We):";"==e||","==e?T(We):"}"==e?T():"@"==t?T(W,We):void 0}function Ge(e,t){if("!"==t)return T(Ge);if("?"==t)return T(Ge);if(":"==e)return T(ge,Ie);if("="==t)return T(G);var n=E.state.lexical.prev;return P(n&&"interface"==n.info?Be:Fe)}function $e(e,t){return"*"==t?(E.marked="keyword",T(Je,H(";"))):"default"==t?(E.marked="keyword",T(W,H(";"))):"{"==e?T(ce(Ze,"}"),Je,H(";")):P(U)}function Ze(e,t){return"as"==t?(E.marked="keyword",T(H("variable"))):"variable"==e?P(G,Ze):void 0}function qe(e){return"string"==e?T():"("==e?P(W):"."==e?P(K):P(Ke,Ye,Je)}function Ke(e,t){return"{"==e?he(Ke,"}"):("variable"==e&&M(t),"*"==t&&(E.marked="keyword"),T(Xe))}function Ye(e){if(","==e)return T(Ke,Ye)}function Xe(e,t){if("as"==t)return E.marked="keyword",T(Ke)}function Je(e,t){if("from"==t)return E.marked="keyword",T(W)}function Qe(e){return"]"==e?T():P(ce(G,"]"))}function et(){return P(V("form"),Te,H("{"),V("}"),ce(tt,"}"),j,j)}function tt(){return P(Te,Ie)}function nt(e,t){return"operator"==e.lastType||","==e.lastType||d.test(t.charAt(0))||/[,.]/.test(t.charAt(0))}function it(e,t,n){return t.tokenize==g&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(t.lastType)||"quasi"==t.lastType&&/\{\s*$/.test(e.string.slice(0,e.pos-(n||0)))}return R.lex=F.lex=!0,B.lex=!0,j.lex=!0,{startState:function(e){var n={tokenize:g,lastType:"sof",cc:[],lexical:new S((e||0)-r,0,"block",!1),localVars:t.localVars,context:t.localVars&&new O(null,null,!1),indented:e||0};return t.globalVars&&"object"==typeof t.globalVars&&(n.globalVars=t.globalVars),n},token:function(e,t){if(e.sol()&&(t.lexical.hasOwnProperty("align")||(t.lexical.align=!1),t.indented=e.indentation(),x(e,t)),t.tokenize!=y&&e.eatSpace())return null;var r=t.tokenize(e,t);return"comment"==n?r:(t.lastType="operator"!=n||"++"!=i&&"--"!=i?n:"incdec",L(t,r,n,i,e))},indent:function(e,n){if(e.tokenize==y||e.tokenize==b)return zV.Pass;if(e.tokenize!=g)return 0;var i,o=n&&n.charAt(0),a=e.lexical;if(!/^\s*else\b/.test(n))for(var l=e.cc.length-1;l>=0;--l){var c=e.cc[l];if(c==j)a=a.prev;else if(c!=Oe&&c!=B)break}for(;("stat"==a.type||"form"==a.type)&&("}"==o||(i=e.cc[e.cc.length-1])&&(i==K||i==Y)&&!/^[,\.=+\-*:?[\(]/.test(n));)a=a.prev;s&&")"==a.type&&"stat"==a.prev.type&&(a=a.prev);var h=a.type,u=o==h;return"vardef"==h?a.indented+("operator"==e.lastType||","==e.lastType?a.info.length+1:0):"form"==h&&"{"==o?a.indented:"form"==h?a.indented+r:"stat"==h?a.indented+(nt(e,n)?s||r:0):"switch"!=a.info||u||0==t.doubleIndentSwitch?a.align?a.column+(u?0:1):a.indented+(u?0:r):a.indented+(/^(?:case|default)\b/.test(n)?r:2*r)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:a?null:"/*",blockCommentEnd:a?null:"*/",blockCommentContinue:a?null:" * ",lineComment:a?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:a?"json":"javascript",jsonldMode:o,jsonMode:a,expressionAllowed:it,skipExpression:function(e){L(e,"atom","atom","true",new zV.StringStream("",2,null))}}}),zV.registerHelper("wordChars","javascript",/[\w$]/),zV.defineMIME("text/javascript","javascript"),zV.defineMIME("text/ecmascript","javascript"),zV.defineMIME("application/javascript","javascript"),zV.defineMIME("application/x-javascript","javascript"),zV.defineMIME("application/ecmascript","javascript"),zV.defineMIME("application/json",{name:"javascript",json:!0}),zV.defineMIME("application/x-json",{name:"javascript",json:!0}),zV.defineMIME("application/manifest+json",{name:"javascript",json:!0}),zV.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),zV.defineMIME("text/typescript",{name:"javascript",typescript:!0}),zV.defineMIME("application/typescript",{name:"javascript",typescript:!0}));var WV,GV={};function $V(){return WV||(WV=1,function(e){function t(t,n,i){var r,s=t.getWrapperElement();return(r=s.appendChild(document.createElement("div"))).className=i?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top","string"==typeof n?r.innerHTML=n:r.appendChild(n),e.addClass(s,"dialog-opened"),r}function n(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}e.defineExtension("openDialog",function(i,r,s){s||(s={}),n(this,null);var o=t(this,i,s.bottom),a=!1,l=this;function c(t){if("string"==typeof t)u.value=t;else{if(a)return;a=!0,e.rmClass(o.parentNode,"dialog-opened"),o.parentNode.removeChild(o),l.focus(),s.onClose&&s.onClose(o)}}var h,u=o.getElementsByTagName("input")[0];return u?(u.focus(),s.value&&(u.value=s.value,!1!==s.selectValueOnOpen&&u.select()),s.onInput&&e.on(u,"input",function(e){s.onInput(e,u.value,c)}),s.onKeyUp&&e.on(u,"keyup",function(e){s.onKeyUp(e,u.value,c)}),e.on(u,"keydown",function(t){s&&s.onKeyDown&&s.onKeyDown(t,u.value,c)||((27==t.keyCode||!1!==s.closeOnEnter&&13==t.keyCode)&&(u.blur(),e.e_stop(t),c()),13==t.keyCode&&r(u.value,t))}),!1!==s.closeOnBlur&&e.on(o,"focusout",function(e){null!==e.relatedTarget&&c()})):(h=o.getElementsByTagName("button")[0])&&(e.on(h,"click",function(){c(),l.focus()}),!1!==s.closeOnBlur&&e.on(h,"blur",c),h.focus()),c}),e.defineExtension("openConfirm",function(i,r,s){n(this,null);var o=t(this,i,s&&s.bottom),a=o.getElementsByTagName("button"),l=!1,c=this,h=1;function u(){l||(l=!0,e.rmClass(o.parentNode,"dialog-opened"),o.parentNode.removeChild(o),c.focus())}a[0].focus();for(var d=0;d<a.length;++d){var p=a[d];(function(t){e.on(p,"click",function(n){e.e_preventDefault(n),u(),t&&t(c)})})(r[d]),e.on(p,"blur",function(){--h,setTimeout(function(){h<=0&&u()},200)}),e.on(p,"focus",function(){++h})}}),e.defineExtension("openNotification",function(i,r){n(this,c);var s,o=t(this,i,r&&r.bottom),a=!1,l=r&&void 0!==r.duration?r.duration:5e3;function c(){a||(a=!0,clearTimeout(s),e.rmClass(o.parentNode,"dialog-opened"),o.parentNode.removeChild(o))}return e.on(o,"click",function(t){e.e_preventDefault(t),c()}),l&&(s=setTimeout(c,l)),c})}(DV())),GV}$V();var ZV;ZV||(ZV=1,function(e){function t(e,t,n,i,r){e.openDialog?e.openDialog(t,r,{value:i,selectValueOnOpen:!0,bottom:e.options.search.bottom}):r(prompt(n,i))}function n(e){return e.phrase("Jump to line:")+' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+e.phrase("(Use line:column or scroll% syntax)")+"</span>"}function i(e,t){var n=Number(t);return/^[-+]/.test(t)?e.getCursor().line+n:n-1}e.defineOption("search",{bottom:!1}),e.commands.jumpToLine=function(e){var r=e.getCursor();t(e,n(e),e.phrase("Jump to line:"),r.line+1+":"+r.ch,function(t){var n;if(t)if(n=/^\s*([\+\-]?\d+)\s*\:\s*(\d+)\s*$/.exec(t))e.setCursor(i(e,n[1]),Number(n[2]));else if(n=/^\s*([\+\-]?\d+(\.\d+)?)\%\s*/.exec(t)){var s=Math.round(e.lineCount()*Number(n[1])/100);/^[-+]/.test(n[1])&&(s=r.line+s+1),e.setCursor(s-1,r.ch)}else(n=/^\s*\:?\s*([\+\-]?\d+)\s*/.exec(t))&&e.setCursor(i(e,n[1]),r.ch)})},e.keyMap.default["Alt-G"]="jumpToLine"}(DV(),$V()));var qV,KV,YV={};function XV(){return qV||(qV=1,function(e){var t,n,i=e.Pos;function r(e){var t=e.flags;return null!=t?t:(e.ignoreCase?"i":"")+(e.global?"g":"")+(e.multiline?"m":"")}function s(e,t){for(var n=r(e),i=n,s=0;s<t.length;s++)-1==i.indexOf(t.charAt(s))&&(i+=t.charAt(s));return n==i?e:new RegExp(e.source,i)}function o(e){return/\\s|\\n|\n|\\W|\\D|\[\^/.test(e.source)}function a(e,t,n){t=s(t,"g");for(var r=n.line,o=n.ch,a=e.lastLine();r<=a;r++,o=0){t.lastIndex=o;var l=e.getLine(r),c=t.exec(l);if(c)return{from:i(r,c.index),to:i(r,c.index+c[0].length),match:c}}}function l(e,t,n){if(!o(t))return a(e,t,n);t=s(t,"gm");for(var r,l=1,c=n.line,h=e.lastLine();c<=h;){for(var u=0;u<l&&!(c>h);u++){var d=e.getLine(c++);r=null==r?d:r+"\n"+d}l*=2,t.lastIndex=n.ch;var p=t.exec(r);if(p){var f=r.slice(0,p.index).split("\n"),m=p[0].split("\n"),g=n.line+f.length-1,v=f[f.length-1].length;return{from:i(g,v),to:i(g+m.length-1,1==m.length?v+m[0].length:m[m.length-1].length),match:p}}}}function c(e,t,n){for(var i,r=0;r<=e.length;){t.lastIndex=r;var s=t.exec(e);if(!s)break;var o=s.index+s[0].length;if(o>e.length-n)break;(!i||o>i.index+i[0].length)&&(i=s),r=s.index+1}return i}function h(e,t,n){t=s(t,"g");for(var r=n.line,o=n.ch,a=e.firstLine();r>=a;r--,o=-1){var l=e.getLine(r),h=c(l,t,o<0?0:l.length-o);if(h)return{from:i(r,h.index),to:i(r,h.index+h[0].length),match:h}}}function u(e,t,n){if(!o(t))return h(e,t,n);t=s(t,"gm");for(var r,a=1,l=e.getLine(n.line).length-n.ch,u=n.line,d=e.firstLine();u>=d;){for(var p=0;p<a&&u>=d;p++){var f=e.getLine(u--);r=null==r?f:f+"\n"+r}a*=2;var m=c(r,t,l);if(m){var g=r.slice(0,m.index).split("\n"),v=m[0].split("\n"),y=u+g.length,b=g[g.length-1].length;return{from:i(y,b),to:i(y+v.length-1,1==v.length?b+v[0].length:v[v.length-1].length),match:m}}}}function d(e,t,n,i){if(e.length==t.length)return n;for(var r=0,s=n+Math.max(0,e.length-t.length);;){if(r==s)return r;var o=r+s>>1,a=i(e.slice(0,o)).length;if(a==n)return o;a>n?s=o:r=o+1}}function p(e,r,s,o){if(!r.length)return null;var a=o?t:n,l=a(r).split(/\r|\n\r?/);e:for(var c=s.line,h=s.ch,u=e.lastLine()+1-l.length;c<=u;c++,h=0){var p=e.getLine(c).slice(h),f=a(p);if(1==l.length){var m=f.indexOf(l[0]);if(-1==m)continue e;return s=d(p,f,m,a)+h,{from:i(c,d(p,f,m,a)+h),to:i(c,d(p,f,m+l[0].length,a)+h)}}var g=f.length-l[0].length;if(f.slice(g)==l[0]){for(var v=1;v<l.length-1;v++)if(a(e.getLine(c+v))!=l[v])continue e;var y=e.getLine(c+l.length-1),b=a(y),w=l[l.length-1];if(b.slice(0,w.length)==w)return{from:i(c,d(p,f,g,a)+h),to:i(c+l.length-1,d(y,b,w.length,a))}}}}function f(e,r,s,o){if(!r.length)return null;var a=o?t:n,l=a(r).split(/\r|\n\r?/);e:for(var c=s.line,h=s.ch,u=e.firstLine()-1+l.length;c>=u;c--,h=-1){var p=e.getLine(c);h>-1&&(p=p.slice(0,h));var f=a(p);if(1==l.length){var m=f.lastIndexOf(l[0]);if(-1==m)continue e;return{from:i(c,d(p,f,m,a)),to:i(c,d(p,f,m+l[0].length,a))}}var g=l[l.length-1];if(f.slice(0,g.length)==g){var v=1;for(s=c-l.length+1;v<l.length-1;v++)if(a(e.getLine(s+v))!=l[v])continue e;var y=e.getLine(c+1-l.length),b=a(y);if(b.slice(b.length-l[0].length)==l[0])return{from:i(c+1-l.length,d(y,b,y.length-l[0].length,a)),to:i(c,d(p,f,g.length,a))}}}}function m(e,t,n,r){var o;this.atOccurrence=!1,this.afterEmptyMatch=!1,this.doc=e,n=n?e.clipPos(n):i(0,0),this.pos={from:n,to:n},"object"==typeof r?o=r.caseFold:(o=r,r=null),"string"==typeof t?(null==o&&(o=!1),this.matches=function(n,i){return(n?f:p)(e,t,i,o)}):(t=s(t,"gm"),r&&!1===r.multiline?this.matches=function(n,i){return(n?h:a)(e,t,i)}:this.matches=function(n,i){return(n?u:l)(e,t,i)})}String.prototype.normalize?(t=function(e){return e.normalize("NFD").toLowerCase()},n=function(e){return e.normalize("NFD")}):(t=function(e){return e.toLowerCase()},n=function(e){return e}),m.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(t){var n=this.doc.clipPos(t?this.pos.from:this.pos.to);if(this.afterEmptyMatch&&this.atOccurrence&&(n=i(n.line,n.ch),t?(n.ch--,n.ch<0&&(n.line--,n.ch=(this.doc.getLine(n.line)||"").length)):(n.ch++,n.ch>(this.doc.getLine(n.line)||"").length&&(n.ch=0,n.line++)),0!=e.cmpPos(n,this.doc.clipPos(n))))return this.atOccurrence=!1;var r=this.matches(t,n);if(this.afterEmptyMatch=r&&0==e.cmpPos(r.from,r.to),r)return this.pos=r,this.atOccurrence=!0,this.pos.match||!0;var s=i(t?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:s,to:s},this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(t,n){if(this.atOccurrence){var r=e.splitLines(t);this.doc.replaceRange(r,this.pos.from,this.pos.to,n),this.pos.to=i(this.pos.from.line+r.length-1,r[r.length-1].length+(1==r.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,t,n){return new m(this.doc,e,t,n)}),e.defineDocExtension("getSearchCursor",function(e,t,n){return new m(this,e,t,n)}),e.defineExtension("selectMatches",function(t,n){for(var i=[],r=this.getSearchCursor(t,this.getCursor("from"),n);r.findNext()&&!(e.cmpPos(r.to(),this.getCursor("to"))>0);)i.push({anchor:r.from(),head:r.to()});i.length&&this.setSelections(i,0)})}(DV())),YV}KV||(KV=1,function(e){function t(e,t){return"string"==typeof e?e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t?"gi":"g"):e.global||(e=new RegExp(e.source,e.ignoreCase?"gi":"g")),{token:function(t){e.lastIndex=t.pos;var n=e.exec(t.string);if(n&&n.index==t.pos)return t.pos+=n[0].length||1,"searching";n?t.pos=n.index:t.skipToEnd()}}}function n(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null}function i(e){return e.state.search||(e.state.search=new n)}function r(e){return"string"==typeof e&&e==e.toLowerCase()}function s(e,t,n){return e.getSearchCursor(t,n,{caseFold:r(t),multiline:!0})}function o(e,t,n,i,r){e.openDialog(t,i,{value:n,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){f(e)},onKeyDown:r,bottom:e.options.search.bottom})}function a(e,t,n,i,r){e.openDialog?e.openDialog(t,r,{value:i,selectValueOnOpen:!0,bottom:e.options.search.bottom}):r(prompt(n,i))}function l(e,t,n,i){e.openConfirm?e.openConfirm(t,i):confirm(n)&&i[0]()}function c(e){return e.replace(/\\([nrt\\])/g,function(e,t){return"n"==t?"\n":"r"==t?"\r":"t"==t?"\t":"\\"==t?"\\":e})}function h(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);if(t)try{e=new RegExp(t[1],-1==t[2].indexOf("i")?"":"i")}catch(n){}else e=c(e);return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e}function u(e,n,i){n.queryText=i,n.query=h(i),e.removeOverlay(n.overlay,r(n.query)),n.overlay=t(n.query,r(n.query)),e.addOverlay(n.overlay),e.showMatchesOnScrollbar&&(n.annotate&&(n.annotate.clear(),n.annotate=null),n.annotate=e.showMatchesOnScrollbar(n.query,r(n.query)))}function d(t,n,r,s){var l=i(t);if(l.query)return p(t,n);var c=t.getSelection()||l.lastQuery;if(c instanceof RegExp&&"x^"==c.source&&(c=null),r&&t.openDialog){var h=null,d=function(n,i){e.e_stop(i),n&&(n!=l.queryText&&(u(t,l,n),l.posFrom=l.posTo=t.getCursor()),h&&(h.style.opacity=1),p(t,i.shiftKey,function(e,n){var i;n.line<3&&document.querySelector&&(i=t.display.wrapper.querySelector(".CodeMirror-dialog"))&&i.getBoundingClientRect().bottom-4>t.cursorCoords(n,"window").top&&((h=i).style.opacity=.4)}))};o(t,g(t),c,d,function(n,r){var s=e.keyName(n),o=t.getOption("extraKeys"),a=o&&o[s]||e.keyMap[t.getOption("keyMap")][s];"findNext"==a||"findPrev"==a||"findPersistentNext"==a||"findPersistentPrev"==a?(e.e_stop(n),u(t,i(t),r),t.execCommand(a)):"find"!=a&&"findPersistent"!=a||(e.e_stop(n),d(r,n))}),s&&c&&(u(t,l,c),p(t,n))}else a(t,g(t),"Search for:",c,function(e){e&&!l.query&&t.operation(function(){u(t,l,e),l.posFrom=l.posTo=t.getCursor(),p(t,n)})})}function p(t,n,r){t.operation(function(){var o=i(t),a=s(t,o.query,n?o.posFrom:o.posTo);(a.find(n)||(a=s(t,o.query,n?e.Pos(t.lastLine()):e.Pos(t.firstLine(),0))).find(n))&&(t.setSelection(a.from(),a.to()),t.scrollIntoView({from:a.from(),to:a.to()},20),o.posFrom=a.from(),o.posTo=a.to(),r&&r(a.from(),a.to()))})}function f(e){e.operation(function(){var t=i(e);t.lastQuery=t.query,t.query&&(t.query=t.queryText=null,e.removeOverlay(t.overlay),t.annotate&&(t.annotate.clear(),t.annotate=null))})}function m(e,t){var n=e?document.createElement(e):document.createDocumentFragment();for(var i in t)n[i]=t[i];for(var r=2;r<arguments.length;r++){var s=arguments[r];n.appendChild("string"==typeof s?document.createTextNode(s):s)}return n}function g(e){var t=m("label",{className:"CodeMirror-search-label"},e.phrase("Search:"),m("input",{type:"text",style:"width: 10em",className:"CodeMirror-search-field",id:"CodeMirror-search-field"}));return t.setAttribute("for","CodeMirror-search-field"),m("",null,t," ",m("span",{style:"color: #666",className:"CodeMirror-search-hint"},e.phrase("(Use /re/ syntax for regexp search)")))}function v(e){return m("",null," ",m("input",{type:"text",style:"width: 10em",className:"CodeMirror-search-field"})," ",m("span",{style:"color: #666",className:"CodeMirror-search-hint"},e.phrase("(Use /re/ syntax for regexp search)")))}function y(e){return m("",null,m("span",{className:"CodeMirror-search-label"},e.phrase("With:"))," ",m("input",{type:"text",style:"width: 10em",className:"CodeMirror-search-field"}))}function b(e){return m("",null,m("span",{className:"CodeMirror-search-label"},e.phrase("Replace?"))," ",m("button",{},e.phrase("Yes"))," ",m("button",{},e.phrase("No"))," ",m("button",{},e.phrase("All"))," ",m("button",{},e.phrase("Stop")))}function w(e,t,n){e.operation(function(){for(var i=s(e,t);i.findNext();)if("string"!=typeof t){var r=e.getRange(i.from(),i.to()).match(t);i.replace(n.replace(/\$(\d)/g,function(e,t){return r[t]}))}else i.replace(n)})}function x(e,t){if(!e.getOption("readOnly")){var n=e.getSelection()||i(e).lastQuery,r=t?e.phrase("Replace all:"):e.phrase("Replace:"),o=m("",null,m("span",{className:"CodeMirror-search-label"},r),v(e));a(e,o,r,n,function(n){n&&(n=h(n),a(e,y(e),e.phrase("Replace with:"),"",function(i){if(i=c(i),t)w(e,n,i);else{f(e);var r=s(e,n,e.getCursor("from")),o=function(){var t,c=r.from();!(t=r.findNext())&&(r=s(e,n),!(t=r.findNext())||c&&r.from().line==c.line&&r.from().ch==c.ch)||(e.setSelection(r.from(),r.to()),e.scrollIntoView({from:r.from(),to:r.to()}),l(e,b(e),e.phrase("Replace?"),[function(){a(t)},o,function(){w(e,n,i)}]))},a=function(e){r.replace("string"==typeof n?i:i.replace(/\$(\d)/g,function(t,n){return e[n]})),o()};o()}}))})}}e.defineOption("search",{bottom:!1}),e.commands.find=function(e){f(e),d(e)},e.commands.findPersistent=function(e){f(e),d(e,!1,!0)},e.commands.findPersistentNext=function(e){d(e,!1,!0,!0)},e.commands.findPersistentPrev=function(e){d(e,!0,!0,!0)},e.commands.findNext=d,e.commands.findPrev=function(e){d(e,!0)},e.commands.clearSearch=f,e.commands.replace=x,e.commands.replaceAll=function(e){x(e,!0)}}(DV(),XV(),$V())),XV();class JV{constructor(e){this.options=e,this._unusedPool=[]}create(e){let t=this._unusedPool.pop();return t?(e.appendChild(t.getWrapperElement()),t):(t=RV(e,this.options),t.on("keyHandled",(e,t,n)=>{n.stopPropagation()}),t)}dispose(e){this._unusedPool.push(e)}}const QV=document.createElement("div"),ej=RV(QV),tj={view:()=>null,onupdate(){ej.startOperation()}},nj={view:()=>null,onupdate(){ej.endOperation()}},ij=to()?"Cmd":"Ctrl",rj=RV.normalizeKeyMap({Tab:!1,"Shift-Tab":!1,[`${ij}-/`]:"toggleComment","Alt-Enter":"newlineAndIndent",[`${ij}-Z`]:!1,[`${ij}-Shift-Z`]:!1,[`${ij}-D`]:!1}),sj=to()?"Cmd":"Ctrl",oj="cuttle-number-scrub",aj={mode:"javascript",tabSize:2,indentUnit:2,indentWithTabs:!1,matchBrackets:!0,lineWrapping:!0,dragDrop:!1,undoDepth:0,extraKeys:rj},lj=new JV(aj),cj=e=>{const t=e.getCursor(),n=e.listSelections(),i=e.lastLine();return 1===n.length&&(0===t.line&&0===t.ch||t.line===i&&t.ch===e.getLine(i).length)},hj=e=>{if(e.lastLine()>0)return;const t=e.getLine(0);return BV(t)};class uj{constructor(e){this.cm=e,this.managedLineWidgets=[]}updateWithLineAnnotations(e){this.managedLineWidgets=this.managedLineWidgets.filter(t=>{const n=e.some(e=>e.line===t.line);return n||this.dispose(t),n});for(let t of e){const e=this.managedLineWidgets.find(e=>e.line===t.line);e?e.view=t.view:this.managedLineWidgets.push(this.create(t))}window.requestAnimationFrame(()=>{for(let e of this.managedLineWidgets)e.lineWidget.changed()})}create(e){const t=document.createElement("div");t.className="codemirror-widget-container";let{line:n,view:i}=e,r=n;r<0&&(r=this.cm.lastLine()+1);const s={line:n,view:i,lineWidget:this.cm.addLineWidget(r-1,t),containerEl:t};return Oe.mount(t,{view:()=>s.view()}),s}dispose(e){Oe.mount(e.containerEl,null),e.lineWidget.clear()}disposeAll(){for(let e of this.managedLineWidgets)this.dispose(e);this.managedLineWidgets=[]}}const dj=e=>{let t,n,i=e,r=!1;const s=()=>i.attrs.value.includes("\n");let o;const a=new ResizeObserver(()=>{t&&!o&&(o=requestAnimationFrame(()=>{t.refresh(),o=void 0}))}),l=()=>{const{onChange:e,value:n}=i.attrs,r=t.getValue();r!==n&&(e(r),Oe.redraw())},c=()=>{var e,n;t.hasFocus()&&(null==(n=(e=i.attrs).onSelection)||n.call(e,t.listSelections()))},h=()=>{var e,n;r||(s()?t.execCommand("goDocStart"):t.execCommand("selectAll")),r=!1,null==(n=(e=i.attrs).onFocus)||n.call(e),Oe.redraw()},u=()=>{var e,t,n,r;null==(t=(e=i.attrs).onSelection)||t.call(e,[]),null==(r=(n=i.attrs).onBlur)||r.call(n),Oe.redraw()},d=()=>{var e,t;null==(t=(e=i.attrs).onNumberScrub)||t.call(e)},p={Enter:e=>{var t,n;i.attrs.confirmOnEnter?(e.getInputField().blur(),Oe.redraw(),null==(n=(t=i.attrs).onConfirm)||n.call(t)):e.execCommand("newlineAndIndent")},Tab:e=>{const t=cj(e);if(s()){if(t)return RV.Pass;const n=e.somethingSelected(),i=e.listSelections();return n||i.every(t=>{const{anchor:n}=t;if(0===n.line)return!1;if(0===n.ch)return!0;const i=e.getStateAfter(n.line).indented;return n.ch<=i})?void e.execCommand("indentMore"):void e.execCommand("goDocEnd")}if(!t){const t=hj(e);if(t){const n=e.getCursor(),i=t.find(e=>e.start>=n.ch);if(i)return void e.setSelection({line:n.line,ch:i.start},{line:n.line,ch:i.end})}}return RV.Pass},"Shift-Tab":e=>{const t=cj(e);if(s()){if(t)return RV.Pass;const n=e.somethingSelected(),i=e.listSelections();return n||i.every(t=>{const{anchor:n}=t;if(0===n.line)return!1;const i=e.getStateAfter(n.line).indented;return i>0&&n.ch<=i})?void e.execCommand("indentLess"):void e.execCommand("goDocStart")}if(!t){const t=hj(e);if(t){const n=e.getCursor();t.reverse();const i=t.find(e=>e.end<n.ch);if(i)return void e.setSelection({line:n.line,ch:i.start},{line:n.line,ch:i.end})}}return RV.Pass},Backspace:e=>{if(e.somethingSelected())return void e.execCommand("delCharBefore");const t=e.getOption("indentUnit")??2,n=e.listSelections().map(e=>e.anchor);let i=!1;for(let r of n){const n=e.getStateAfter(r.line).indented;r.ch>0&&r.ch<=n&&r.ch%t===0||(i=!0)}i?e.execCommand("delCharBefore"):e.execCommand("indentLess")},[`${sj}-Enter`]:()=>{var e,t;null==(t=(e=i.attrs).onCommandEnter)||t.call(e)},[`${sj}-S`]:()=>{var e,t;null==(t=(e=i.attrs).onCommandEnter)||t.call(e)},[`${sj}-F`]:()=>{s()&&t.execCommand("find")},[`${sj}-G`]:()=>{s()&&t.execCommand("findNext")},[`Shift-${sj}-F`]:()=>{s()&&t.execCommand("findPrev")},[`Shift-${sj}-G`]:()=>{s()&&t.execCommand("findPrev")}},f=(e,t,n)=>{const i=e.getOption("tabSize")??aj.tabSize??2,r=(RV.countColumn(t.text,null,i)+2)*e.defaultCharWidth();n.style.textIndent="-"+r+"px",n.style.paddingLeft=4+r+"px"},m=e=>{if(i.attrs.readOnly)return;if(r=!0,e.shiftKey||e.ctrlKey||e.altKey||e.metaKey)return;if("mouse"===e.pointerType&&0!==e.button)return;e.target.matches(".cm-number")&&((e,t)=>{t.preventDefault();const{start:n,end:i}=((e,t)=>{const n=e.coordsChar({left:t.clientX,top:t.clientY},"window");e.cursorCoords(n,"window").left<t.clientX&&n.ch++;let i=e.getTokenAt(n,!0);"number"!==i.type&&(n.ch++,i=e.getTokenAt(n,!0));const r=n.line;let s={line:r,ch:i.start},o={line:r,ch:i.end};if(s.ch>0){const t={line:s.line,ch:s.ch-1};"-"===e.getRange(t,s)&&(s=t)}return{start:s,end:o}})(e,t);e.focus(),e.setSelection(n,i);const r=e.getSelection(),s=Math.min(3,xr(r));"touch"!==t.pointerType&&OA(t,{stringValue:r,fractionDigits:s,onChange(t){e.replaceSelection(t,"around"),RV.signal(e,oj,e)}})})(t,e)},g=()=>{r=!1},v=e=>{"all"===e?t.execCommand("selectAll"):t.setSelections(e,void 0,{scroll:!1})},y=()=>{const{value:e,lineAnnotations:r,readOnly:s,forcedSelections:o}=i.attrs;if(t){t.getValue()!==e&&t.setValue(e),t.setOption("readOnly",s);const n=null==o?void 0:o();n&&(t.focus(),v(n))}r&&n.updateWithLineAnnotations(r)};return{oncreate(e){var r,s;const o=uo(e);t=lj.create(o),n=new uj(t),y(),null==(s=(r=e.attrs).onCodeMirror)||s.call(r,t),t.on("change",l),t.on("cursorActivity",c),t.on("focus",h),t.on("blur",u),t.on("renderLine",f),t.on(oj,d),t.addKeyMap(p);const{initialSelections:m}=e.attrs;if(m&&(t.focus(),v(m)),e.attrs.codeHints){const e=()=>{if(void 0===i.attrs.codeHints)return;const e=(n=i.attrs.codeHints(),{hint:e=>{const t=e.getCursor(),i=e.getLine(t.line),r=e.getTokenAt(t);if(r.type&&/\b(?:string|comment)\b/.test(r.type))return;let s=t.ch,o=t.ch;for(;s&&/[\w\.]/.test(i.charAt(s-1));)--s;for(;o<i.length&&/\w/.test(i.charAt(o));)++o;const a=i.slice(s,o),l=a.toLowerCase(),c=[],h=[];n.forEach(e=>{e.text.startsWith(a)?c.push(e):e.text.toLowerCase().startsWith(l)&&h.push(e)});const u=[...c,...h];return u.length>0?{list:u,from:RV.Pos(t.line,s),to:RV.Pos(t.line,o)}:void 0},completeSingle:!1});var n;t.showHint(e)},n=bo(e,150);t.on("keydown",function(t,i){i.ctrlKey&&32===i.keyCode?e():i.ctrlKey||i.metaKey||!("_"===i.key||i.keyCode>=65&&i.keyCode<=90)||n()})}a.observe(o)},onupdate(){y()},onremove(){t.off("change",l),t.off("cursorActivity",c),t.off("focus",h),t.off("blur",u),t.off("renderLine",f),t.off(oj,d),t.removeKeyMap(p),n.disposeAll(),lj.dispose(t),a.disconnect(),o&&cancelAnimationFrame(o)},view(e){i=e;const{readOnly:t}=i.attrs;return Oe(".code-editor",{className:eo({readOnly:t}),onpointerdown:m,onpointerup:g})}}},pj=e=>{let t=e,n=!1;const i=e=>{e.stopPropagation(),(()=>{var e,i;if(n)return;const r=uo(t).getBoundingClientRect(),s=e=>{o.close(),t.attrs.onChange(e)};n=!0;const o=Vo({view:()=>Oe(fj,{value:t.attrs.value,onchange:s}),spawnFrom:{x:.5*(r.left+r.right),y:.5*(r.top+r.bottom)-17},placement:"bottom",className:"editable-value-popup",onclose:()=>{var e,i;n=!1,null==(i=(e=t.attrs).onClose)||i.call(e)},overlay:"closeOnOutsidePointerDown"});null==(i=(e=t.attrs).onOpen)||i.call(e)})()};return{view:e=>(t=e,Oe(".editable-value",{onpointerdown:i},e.children))}},fj=e=>{const{value:t,onchange:n}=e.attrs;let i=t;const r=e=>{i=e},s=()=>{n(i)};return{view:()=>Oe(dj,{value:i,confirmOnEnter:!0,initialSelections:"all",onChange:r,onBlur:s})}},mj={view({attrs:{stringValue:e,fractionDigits:t,prefix:n,suffix:i,readOnly:r,tabIndex:s,onClick:o,onChange:a,onFocus:l}}){const c=n=>{n.preventDefault(),n.stopPropagation(),r||OA(n,{stringValue:e,fractionDigits:t,onChange:a,onCancel:o})},h=eo({disabled:r});return Oe("span.number-scrubber",{className:h,onpointerdown:e=>{c(e)},onmousedown:e=>{c(e)},tabIndex:s,onfocus:l},[Oe("span.prefix",n),Oe(gj,{stringValue:e,fractionDigits:t}),Oe("span.suffix",i)])}},gj={view({attrs:{value:e,stringValue:t,fractionDigits:n}}){void 0===e&&(e=+t),void 0===t&&(t=Db(e,n)),t=wr(wr(t,"0"),".");const i=e.toFixed(n),r=i.includes(t);return[Oe("span.number-value",i),!r&&Oe("span.number-ellipsis","")]}},vj={view({attrs:{position:e,normal:t,rotation:n},children:i}){const r=(t.angle()-90).toFixed(1),s=Math.round(e.x),o=Math.round(e.y);return Oe("div.transform-box-label",{style:{transform:`translate(-50%,-50%) translate(${s}px,${o}px) rotate(${r}deg) translate(0,20px) rotate(${n??0}deg)`}},i)}},yj={view({attrs:{name:e,value:t,fractionDigits:n,isLocked:i,onChange:r}}){const s=Db(t,n),o=[Oe(gj,{stringValue:s,fractionDigits:n}),Oe("span.number-unit",Oj.project.settings.units)];return i?Oe(".dimension-editor.locked",{onpointerdown:t=>{t.stopPropagation(),jT.showBasic({type:"error",message:`Can't change the ${e} because a formula is being used in the shape's scale.`,nextStep:"Try changing the scale in the Inspector."})}},o):Oe(pj,{value:s,onChange:e=>{const t=Yy(e);t&&"Number"===t.type&&r(t)}},Oe(".dimension-editor",o))}};class bj{constructor(e,t){this.children=[],this.selection=e,this.isImmutable=e.isImmutable(),this.isPositionLocked=e.isPositionLocked(),this.isScaleLocked=this.isPositionLocked||e.isScaleLocked()||e.isSkewLocked(),this.isRotationLocked=this.isPositionLocked&&e.isSingle()||e.isRotationLocked();const{boundingBox:n,boundingBoxTransform:i}=YC(e);if(!n||!i)return;if(n.min.equals(n.max))return;if(0===i.determinant())return;const r=Ri.fromBoundingBox(n);i.isMirror()&&r.reverse();const s=r.clone().affineTransform(i),o=s.anchors[0].position.distance(s.anchors[1].position),a=s.anchors[1].position.distance(s.anchors[2].position),l=r.clone().affineTransform(i).affineTransform(t),c=ns(l.anchors,!0).map(([e,t])=>t.position.clone().sub(e.position).normalize());c.unshift(c.pop());const h=c.map((e,t)=>[c[(t+3)%4],e]);h.forEach(([e,t],n)=>{t.isZero()&&t.copy(e).rotate90()});const u=h.map(([e,t])=>e.clone().add(t).normalize()),d=l.clone();for(let f=0;f<4;++f){const[e,t]=h[f];let n=10;const i=-e.dot(t);0!==i&&(n/=Math.sin(Math.acos(i)));const r=e.clone().add(t).mulScalar(n);d.anchors[f].position.add(r).round()}const p=d.segments();this.boxData={boundingBox:n,boundingBoxTransform:i,worldBoxWidth:o,worldBoxHeight:a,viewBoxPath:l,viewBoxPathSegmentNormals:c,paddedViewBoxPathSegments:p};for(let f=0;f<4;++f){const{s:e,e:n}=p[f],o=16;if(e.distance(n)>2*o){const a=n.clone().sub(e).normalize().mulScalar(o).add(e),l=e.clone().sub(n).normalize().mulScalar(o).add(n),h="transform-box-side-"+f;this.children.push({hitTest:(e,n)=>{const i=e.clone().affineTransform(t),r=new Bn(a,l).closestPoint(i);if(r){const e=(r.position.distance(i)-2)/n;return{distance:e,isHit:e<=0}}},onPointerDown:e=>{if(this.isImmutable)return void jT.showBasic({type:"error",message:"Can't resize because a selected shape is immutable."});if(this.isScaleLocked)return void jT.showBasic({type:"error",message:"Can't resize because a formula is being used in the shape's Transform.",nextStep:"Try changing the scale directly in the Inspector."});const t=r.anchors[(f+2)%4].position.clone().mix(r.anchors[(f+3)%4].position,.5),n=r.anchors[f].position.clone().mix(r.anchors[(f+1)%4].position,.5);t.distance(n)>Ve&&mV(e,this.selection,i,t,n,!0,this.isPositionLocked)},cursor:()=>{if(this.isScaleLocked)return"select-locked";return`resize-arrows-${wj(c[f],12,0,180)}`},renderCanvas:(e,t)=>{const n=Oj.downInterfaceElement??Oj.hoveredInterfaceElement;if((null==n?void 0:n.id)!==h)return null;t.lineCap="square",t.lineJoin="miter",t.strokeStyle=qL.color.white,t.lineWidth=4,t.beginPath(),t.moveTo(a.x,a.y),t.lineTo(l.x,l.y),t.stroke(),t.strokeStyle=qL.color.blue63,t.lineWidth=2,t.beginPath(),t.moveTo(a.x,a.y),t.lineTo(l.x,l.y),t.stroke()},snappingPoints:e=>{if(!e)return;const t=s.anchors[f].position.clone().mix(s.anchors[f+1&3].position,.5);return[new hA(t,"Transform Box","Box")]},id:h})}}for(let f=0;f<4;++f){const{position:e}=d.anchors[f],n=u[f].clone().mulScalar(4).add(e),i=s.anchors[f].position;this.children.push({hitTest(e,i){const r=(e.clone().affineTransform(t).distance(n)-2)/i;return{distance:r,isHit:r<=0}},onPointerDown:e=>{this.isImmutable?jT.showBasic({type:"error",message:"Can't rotate because a selected shape is immutable."}):this.isRotationLocked?jT.showBasic({type:"error",message:"Can't rotate because a formula is being used in the shape's Transform.",nextStep:"Try changing the rotation directly in the Inspector."}):gV(e,this.selection,i)},cursor:()=>this.isRotationLocked?"select-locked":`rotate-arrows-${wj(u[f],24,225,360)}`,snappingPoints:e=>{if(!e)return;return[new hA(i,"Transform Box","Box")]}})}for(let f=0;f<4;++f){const e=d.anchors[f].position,[n,o]=h[f].map(t=>t.clone().mulScalar(-8).add(e)),a=new Ri([new Wn(n),new Wn(e),new Wn(o)]);this.children.push({hitTest:(e,n)=>{var i;const r=e.clone().affineTransform(t),s=null==(i=a.closestPoint(r))?void 0:i.position;if(!s)return;const o=(r.distance(s)-2)/n;return{distance:o,isHit:o<=0}},onPointerDown:e=>{if(this.isImmutable)return void jT.showBasic({type:"error",message:"Can't resize because a selected shape is immutable."});if(this.isScaleLocked)return void jT.showBasic({type:"error",message:"Can't resize because a formula is being used in the shape's Transform.",nextStep:"Try changing the scale directly in the Inspector."});const t=r.anchors[(f+2)%4].position,n=r.anchors[f].position;mV(e,this.selection,i,t,n,!1,this.isPositionLocked)},cursor:()=>{if(this.isScaleLocked)return"select-locked";return`resize-arrows-${wj(u[f],12,0,180)}`},renderCanvas:(e,t)=>{t.lineCap="square",t.lineJoin="miter",t.strokeStyle=qL.color.white,t.lineWidth=4,t.beginPath(),lr(a,t),t.stroke(),t.strokeStyle=qL.color.blue63,t.lineWidth=2,t.beginPath(),lr(a,t),t.stroke()},snappingPoints:e=>{if(!e)return;return[new hA(s.anchors[f].position,"Transform Box","Box")]}})}}isValid(){return this.selection.items.every(e=>Oj.project.selectableExistsAndIsValid(e))}cursor(){return this.isPositionLocked?"select-locked":Oj.isAltDown?"duplicate":"select"}selectables(){return this.selection.items}renderHtml(e){const t=Oj.project.focusedComponent();if(Ps(t,"Should only be used when a component is focused"),!this.boxData)return;let n,i;if(!this.selection.isSingle()&&!Oj.isMidGesture()){const e=e=>t=>{if(1!==t.buttons)return;t.stopPropagation();const n=this.selection.allNodes().mutables().toNodes();tS(n,e)},{s:t,e:i}=this.boxData.paddedViewBoxPathSegments[0],{s:r,e:s}=this.boxData.paddedViewBoxPathSegments[3],o=Math.floor(r.x),a=Math.floor(t.y),l=Math.floor(i.x-t.x),c=`left:${o}px;top:${a}px;height:${Math.floor(r.y-s.y)}px`;n=[Oe(".transform-box-tools",{style:`left:${o}px;top:${a}px;width:${l}px`},[Oe(".align-tools.horizontal",[Oe(ea,{icon:"align_left",onpointerdown:e("left")}),Oe(ea,{icon:"align_center",onpointerdown:e("center")}),Oe(ea,{icon:"align_right",onpointerdown:e("right")})])]),Oe(".transform-box-tools.left",{style:c},[Oe(".align-tools.vertical",[Oe(ea,{icon:"align_top",onpointerdown:e("top")}),Oe(ea,{icon:"align_middle",onpointerdown:e("middle")}),Oe(ea,{icon:"align_bottom",onpointerdown:e("bottom")})])])]}{const e=this.boxData.viewBoxPathSegmentNormals[0].y+.001>=this.boxData.viewBoxPathSegmentNormals[2].y?0:2,n=this.boxData.viewBoxPathSegmentNormals[1].y+.001>=this.boxData.viewBoxPathSegmentNormals[3].y?1:3,{s:r,e:s}=this.boxData.paddedViewBoxPathSegments[n],o=r.clone().add(s).mulScalar(.5),a=r.clone().sub(s).rotate90().normalize(),{s:l,e:c}=this.boxData.paddedViewBoxPathSegments[e],h=l.clone().add(c).mulScalar(.5),u=l.clone().sub(c).rotate90().normalize(),d=Oj.viewportManager.viewportForComponent(t),{fractionDigits:p}=d.precisionInfo();let f;if(this.selection.isSingle()){const{s:t,e:i}=this.boxData.paddedViewBoxPathSegments[((u.y>a.y?e:n)+2)%4],r=t.clone().add(i).mulScalar(.5),s=t.clone().sub(i).rotate90().normalize(),o=this.selection.items[0].node.source;f=Oe(vj,{position:r,normal:s,rotation:180},Oe(MV,{value:o.name,singleClick:!0,onchange:e=>{Oj.project.renameElement(o,e)}},o.name))}const{boundingBox:m,boundingBoxTransform:g,worldBoxWidth:v,worldBoxHeight:y}=this.boxData,b=e=>{if(!isFinite(e.value))return;let t=e.value;e.unit&&(t*=Jr(e.unit,Oj.project.settings.units));const n=t/v,i=this.selection.isUniformScale()?new It(n):new It(n,1);nS(this.selection,m,g,i)},w=e=>{if(!isFinite(e.value))return;let t=e.value;e.unit&&(t*=Jr(e.unit,Oj.project.settings.units));const n=t/y,i=this.selection.isUniformScale()?new It(n):new It(1,n);nS(this.selection,m,g,i)};i=[f,Oe(vj,{position:h,normal:u},Oe(yj,{name:"width",value:v,fractionDigits:p,isLocked:this.isScaleLocked,onChange:b})),Oe(vj,{position:o,normal:a},Oe(yj,{name:"height",value:y,fractionDigits:p,isLocked:this.isScaleLocked,onChange:w}))]}return[i,n]}}const wj=(e,t,n,i)=>{const r=n-Mi(e.y,e.x);return Math.round(r*(t/i)+t)%t};class xj{constructor(){this.transformCenter=Oj.project.transformCenter(),this.isPositionLocked=Oj.project.selection.allTransformable().isPositionLocked()}renderCanvas(e,t){if(!this.transformCenter)return;const n=this.transformCenter.worldPosition.clone().affineTransform(e);IT(n),n.subScalar(7.5),t.translate(n.x,n.y),t.beginPath(),t.moveTo(8,3.02746),t.bezierCurveTo(10.0858,3.25804,11.742,4.91419,11.9725,7),t.lineTo(15,7),t.lineTo(15,8),t.lineTo(11.9725,8),t.bezierCurveTo(11.742,10.0858,10.0858,11.742,8,11.9725),t.lineTo(8,15),t.lineTo(7,15),t.lineTo(7,11.9725),t.bezierCurveTo(4.91419,11.742,3.25804,10.0858,3.02746,8),t.lineTo(0,8),t.lineTo(0,7),t.lineTo(3.02746,7),t.bezierCurveTo(3.25804,4.91419,4.91419,3.25804,7,3.02746),t.lineTo(7,0),t.lineTo(8,0),t.lineTo(8,3.02746),t.closePath(),t.moveTo(11,7.5),t.bezierCurveTo(11,9.433,9.433,11,7.5,11),t.bezierCurveTo(5.567,11,4,9.433,4,7.5),t.bezierCurveTo(4,5.567,5.567,4,7.5,4),t.bezierCurveTo(9.433,4,11,5.567,11,7.5),t.closePath(),t.fillStyle=qL.color.blue63,t.fill("evenodd")}hitTest(e,t){if(!this.transformCenter)return;const n=6/t,i=this.transformCenter.worldPosition.distance(e)-n;return{distance:i,isHit:i<=0}}cursor(){return this.isPositionLocked?"select-locked":"select"}snappingPoints(e){if(e&&this.transformCenter)return new hA(this.transformCenter.worldPosition,"Transform Center","Origin")}onPointerDown(e){var t;this.isPositionLocked?jT.showBasic({type:"error",message:"Can't move Transform Center because a formula is being used in the shape's Transform.",nextStep:"Try changing the origin directly in the Inspector."}):NA(e,{startWorldPosition:null==(t=this.transformCenter)?void 0:t.worldPosition,onMove(e,t){if(!Oj.project.hasOverrideTransformCenter()){const e=Oj.project.selection.allNodes();if(e.isSingle()&&!e.isPassThrough()){const n=e.items[0].node,i=Oj.traceForNode(n);if(null==i?void 0:i.isSuccess()){const{currentPosition:e}=ET(t),r=GC(n).clone().invert(),{fractionDigits:s}=LT(r),o=e.clone().affineTransform(r);t.isPrecise()||o.roundToFixed(s);const a=KC(n),l=o.clone().sub(a).affineTransformWithoutTranslation(i.transformMatrix());return new BC(n).transformContext(Ne.fromTranslation(l),{preserveImageTransforms:!0}),void(n.source.transform&&(n.source.transform.args.origin=new _b(Fb(o,s))))}}}Oj.project.setOverrideTransformCenter(t.currentPoint)}})}}class Cj{onPointerMove(e){!Oj.deviceStorage.geometrySnappingEnabled||Oj.canvasPointerIsDown||Oj.definitionDrag||(Oj.snapping.cacheSnappingDataForHoveredInterface(),Oj.snapping.updateSnappingPointNearWorldPosition(OT(e),{isSource:!0}))}onPointerLeave(e){Oj.snapping.clearCurrentPoint()}onKeyDown(e){const{project:t}=Oj;if("Escape"===e.key)if(t.selection.isEmpty()){if(t.focus instanceof CC&&t.focus.node.parent){const e=t.focus.node;t.focusNode(t.focus.node.parent),t.selectNode(e)}}else t.clearSelection();else RA(e)}interface(e){const{project:t}=Oj,n=t.interactableNodesToShow(),i=[new Sj,new rV,new xV(kj),...n.items.map(e=>new WB(e.node,!0)),new eV],r=t.selection.allNodesAndInstancesToShow(),s=r.directlySelectedNodes(),o=r.allNodes(),a=!Oj.isPickerOpen;if(a){for(let e of s.items)i.push(new WB(e.node));i.push(new KB)}i.push(new aV,new ZB,new iV),a&&i.push(new uV,new $B(o));const l=a&&t.isTransformBoxEnabled&&!s.isAllAnchors()&&!s.isPassThrough();return l&&i.push(new bj(s,e)),(Oj.isControlDown||Oj.isMetaDown||t.hasOverrideTransformCenter())&&(l||o.isSingle()&&!o.isAllAnchors())&&i.push(new xj),i}}class Sj extends nV{onPointerDown(e){const{project:t}=Oj;co(e)&&t.focus instanceof CC&&t.focus.node.parent?(t.clearSelection(),t.focusNode(t.focus.node.parent)):(e=>{const t=OT(e),{project:n}=Oj,i=n.selection,r=n.selection.isEmpty()?n.focusedComponentParametersToShow():n.selectionParametersToShow();_A(e,{onConsummate(){Oj.selectionBoxParameters=r},onMove(e){var n,r,s;const o=OT(e);Oj.selectionBox=new De(t,o);const a=Oj.selectionBox.clone().canonicalize(),l=!e.altKey;let c=new hS;for(let t of Oj.interfaceElements){let e=null==(n=t.selectables)?void 0:n.call(t);e&&(0!==e.length&&(l?null==(r=t.isOverlappedByBoundingBox)?void 0:r.call(t,a):null==(s=t.isContainedByBoundingBox)?void 0:s.call(t,a))&&c.add(...e))}const h=e=>e instanceof oS||e instanceof aS;c.items.every(h)||(c=c.filter(e=>!h(e))),c.hasOnly(lS)||(c=c.filter(e=>!(e instanceof lS)||c.isNodeDirectlySelected(e.node)&&c.isNodeDirectlySelected(e.nextNode)));const{project:u}=Oj;u.selection=e.shiftKey?i.clone():new hS,u.selection.addUnique(...c.items),u.updateSelection()},onUp(e){Oj.selectionBox=null,Oj.selectionBoxParameters=void 0},onCancel(){Oj.project.clearSelection()}})})(e)}}class kj extends bV{onPointerDown(e){co(e)?this.insertAnchorWithPointerEvent(e):this.shouldBend()&&(this.selectable.isBendLocked()||((e,t)=>{let n,i,r,s,o;NA(e,{enableGridSnapping:!1,isValid:()=>Oj.project.selectableExistsAndIsValid(t),onConsummate(e,a){var l;const c=t.node,h=t.nextNode;n=new VC(oS.fromName(c,c.source.base,"handleOut")),i=new VC(oS.fromName(h,h.source.base,"handleIn"));const u=Oj.traceForNode(c),d=Oj.traceForNode(h);if((null==u?void 0:u.isSuccess())&&u.result instanceof Wn&&(null==d?void 0:d.isSuccess())&&d.result instanceof Wn){let t;r=new Ri([u.result,d.result]),o=$C(c).clone().invert(),t=a.startPoint.isPrecise()?a.startPoint.worldPosition.clone().affineTransform(o):OT(e).affineTransform(o);const n=null==(l=r.closestPoint(t))?void 0:l.time;void 0!==n&&(s=Ct(n,Ve,.999999))}},onMove(e,t){const[a,l]=r.anchors,c=a.handleOut.clone(),h=l.handleIn.clone();c.isZero()&&h.isZero()?(c.copy(a.position).mix(l.position,1/3),h.copy(l.position).mix(a.position,1/3)):(c.add(a.position),h.add(l.position));const u=t.currentPoint.worldPosition.clone().affineTransform(o),d=r.positionAtTime(s),p=c.clone().mix(h,s),f=1-s,m=s*s*s,g=m/(m+f*f*f),v=a.position.clone().mix(l.position,g);let y;y=d._almostEquals(v)?1/3:p.distance(d)/d.distance(v);const b=v.clone().mix(u,y+1).clone().sub(p),w=b.clone().mulScalar(s*s*-2+s+1).add(c),x=b.clone().mulScalar(f*f*-2+f+1).add(h).clone().sub(l.position),C=w.clone().sub(a.position);!x.isFinite()||C.isFinite();const S=e.altKey?"free":void 0,k={overrideAnchorHandleConstraint:S,assignAnchorHandleConstraint:S};n.assignValue(C,k),i.assignValue(x,k)},onCancel(){}})})(e,this.selectable),e.preventDefault())}shouldBend(){let e=Oj.project.selection.items.length<=1;return Oj.isMetaDown&&(e=!e),e}cursor(){return this.shouldBend()?this.selectable.isBendLocked()?"select-locked":Oj.isAltDown?"select-bend-split":"select-bend":"select"}}class Lj{constructor(e,t,n){this.allowRotate=e,this.allowScale=t,this.uniformScale=n}isDisabled(){const{selection:e}=Oj.project;if(e.isEmpty())return!0;const t=e.isPositionLocked(),n=this.allowScale&&!this.uniformScale;return!(!n||!t)||(!(!n||!e.isUniformScale())||(!(!this.allowRotate&&!this.allowScale||!t||e.isSingle())||(!(!this.allowRotate&&!n||!e.isRotationLocked())||!(!this.allowScale||!e.isScaleLocked()))))}interface(){const{project:e}=Oj,t=e.interactableNodesToShow(),n=[new Ej(this),new rV,new xV(yV),...t.items.map(e=>new XB(e.node)),...t.items.map(e=>new QB(e.node)),new eV];if(!Oj.isPickerOpen){const e=Oj.project.selection.allNodesAndInstancesToShow().directlySelectedNodes();for(let t of e.items)n.push(new JB(t.node))}return n.push(new aV,new ZB,new xj,new uV(!1),new Pj),n}onCanvasPointerDown(e){((e,t,n,i,r)=>{let s;const o=fV(),a=Oj.project.transformCenter()??new hC(new It);NA(e,{rotationTransformCenter:a.worldPosition,onConsummate(e,n){s=new FC(t)},onMove(e,t){const{startPosition:o,currentPosition:l}=ET(t),c=n||e.ctrlKey||e.metaKey,h=vV(t,e),u=Ne.fromCenterAndReferencePoints(a.worldPosition,o,l,{allowRotation:c,allowScale:!!i&&(!r||"uniform"),rotationIncrement:h});s.transformWorld(u,{preserveRotation:r&&!c})},onUp(){o&&Oj.project.clearOverrideTransformCenter()}})})(e,Oj.project.selection,this.allowRotate,this.allowScale,this.uniformScale)}onPointerMove(e){!Oj.canvasPointerIsDown&&Oj.deviceStorage.geometrySnappingEnabled&&(Oj.snapping.cacheSnappingDataForInterface(Oj.interfaceElements,{isSource:!0}),Oj.snapping.updateSnappingPointNearWorldPosition(OT(e),{isSource:!0}))}onKeyDown(e){"Escape"===e.key&&Oj.activateTool("Select")}}class Ej extends nV{constructor(e){super(),this.transformTool=e}onPointerDown(e){this.transformTool.onCanvasPointerDown(e)}}class Pj{renderCanvas(e,t){const n=Oj.project.transformCenter();if(!n)return;const i=n.worldPosition.clone().affineTransform(e);let r,s;IT(i),t.beginPath(),t.ellipse(i.x,i.y,2.5,2.5,0,0,ze),t.fillStyle=qL.color.blue53,t.fill();const{canvasDrag:o}=Oj;let a;if(o?(r=o.startPoint.worldPosition.clone().affineTransform(e),IT(r),s=o.currentPoint.worldPosition.clone().affineTransform(e),IT(s)):Oj.canvasPointerPositionPixels&&(r=IT(Oj.canvasPointerPositionPixels.clone())),Oj.snapping.currentPoint&&(a=Oj.snapping.currentPoint.worldPosition.clone().affineTransform(e),IT(a)),t.lineWidth=1,r){t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(r.x,r.y);const e=s?qL.color.gray50:qL.color.blue53;t.strokeStyle=e,t.stroke(),a&&a.equals(r)||(t.beginPath(),t.ellipse(r.x,r.y,2.5,2.5,0,0,ze),t.fillStyle=e,t.fill())}s&&(t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(s.x,s.y),t.strokeStyle=qL.color.blue53,t.stroke(),a&&a.equals(s)||(t.beginPath(),t.ellipse(s.x,s.y,2.5,2.5,0,0,ze),t.fillStyle=qL.color.blue53,t.fill()))}snappingReferencePoints(e){const t=Oj.project.transformCenter();return null==t?void 0:t.worldPosition}}class Tj{constructor(){this.viewportsByComponentId={}}viewportForComponent(e){let t=this.viewportsByComponentId[e.id];return t||(t=this.initializeViewportForComponent(e)),t}initializeViewportForComponent(e){const t=new nk;if(this.viewportsByComponentId[e.id]=t,this.zoomViewportToFitAll(t,e),!e.isAutoScale){const n=Oj.deviceStorage.currentScreenPPI()??110;this.zoomViewportToPixelsPerInch(t,n),this.zoomViewportOutToFitAll(t,e)}return t}zoomViewportToPixelsPerInch(e,t){const n=Jr(Oj.project.settings.units,"in");e.pixelsPerUnit=t*n}zoomViewportOutToFitAll(e,t){var n;const i=Oj.traceForComponent(t),r=null==(n=null==i?void 0:i.result)?void 0:n.boundingBox();if(r){e.worldBoundingBox(Oj.canvasDimensions).containsBoundingBox(r)||e.scaleToFitBoundingBox(r,Oj.canvasDimensions)}}zoomViewportToFitAll(e,t){var n;const i=Oj.traceForComponent(t),r=null==(n=null==i?void 0:i.result)?void 0:n.boundingBox();r&&e.scaleToFitBoundingBox(r,Oj.canvasDimensions)}zoomViewport(e,t,n,i){if(!t.isEmpty()){const n=t.worldBoundingBox();if(n){const t=e.worldBoundingBox(Oj.canvasDimensions);n.overlapsBoundingBox(t)||(e.center=n.center())}}e.scale(n,i)}zoomViewportToFitSelection(e,t,n){if(n.isEmpty())return void this.zoomViewportToFitAll(e,t);const i=n.worldBoundingBox();i&&e.scaleToFitBoundingBox(i,Oj.canvasDimensions)}zoomViewportToFitFocus(e,t){if(t instanceof CC){const n=new hS([new rS(t.node)]);this.zoomViewportToFitSelection(e,t.component,n)}else this.zoomViewportToFitAll(e,t.component)}}class Aj{constructor(e){this.startPoint=e,this.currentPoint=e.clone()}distance(){return this.startPoint.worldPosition.distance(this.currentPoint.worldPosition)}isPrecise(){return this.startPoint.isPrecise()&&this.currentPoint.isPrecise()}isPreciseH(){return this.startPoint.isPreciseH&&this.currentPoint.isPreciseH}isPreciseV(){return this.startPoint.isPreciseV&&this.currentPoint.isPreciseV}}class Mj{constructor(e){this.subject=e}}const Ij=7,_j=Ij;const Oj=new class{constructor(){this.project=new gS,this.storage=fL,this.deviceStorage=xf,this.shouldCheckpointAfterNextEvaluation=!1,this.shouldForceSaveAtNextCheckpoint=!1,this.lastCheckpointTimeMs=0,this.tools={Select:new Cj,Pen:new CV,Scale:new Lj(!1,!0,!0),"Scale 1D":new Lj(!1,!0,!1),Rotate:new Lj(!0,!1,!0)},this.activeToolName="Select",this.interfaceElements=[],this.hoveredInterfaceElement=void 0,this.downInterfaceElement=void 0,this.hoveredObjectInspectorGeometry=void 0,this.expandedParameterFolders=new WeakSet,this.outlineReorder=null,this.modifierReorder=null,this.parameterReorder=null,this.parameterFolderReorder=null,this.definitionDrag=void 0,this.projectTrace=void 0,this.tracesByNode={},this.tracesByDefinition=new Map,this.isVersionHistoryOpen=!1,this.canvasRectPixels=new DOMRect,this.canvasDimensions=new ik,this.canvasPointerPositionPixels=void 0,this.canvasPointerIsDown=!1,this.isCanvasPanning=!1,this.selectionBox=null,this.selectionBoxParameters=void 0,this.ghostGeometry=null,this.snapping=new dA,this.viewportManager=new Tj,this.isShiftDown=!1,this.isControlDown=!1,this.isAltDown=!1,this.isMetaDown=!1,this.isSpaceDown=!1,this.isPickerOpen=!1,this.isProjectParameterInspectorOpen=!1,this.isComponentParameterInspectorOpen=!1,this.isCanvasTextParameterOpen=!1,this.isFirstRedrawAfterBecameVisible=!0,this.gestureIds=new Set,this.debug_gestureTimeoutsById=new Map,this._editingMode="editing",this.evaluateElementMemoizer=new IS,ef.subscribe(()=>this.evaluateElementMemoizer.globalChanged("getFontFromURL")),ql.subscribe(()=>this.evaluateElementMemoizer.globalChanged("getImageFromURL")),oc.subscribe(()=>{this.evaluateElementMemoizer.globalChanged("getEmojiSVGFromURL"),this.evaluateElementMemoizer.globalChanged("getFontFromURL")}),this.evaluator=new YS(this.evaluateElementMemoizer),this.editHistory=new TS(this.project),this.business=new Za}updateEvaluation(){Pr()&&(this.project.assertIsValid(),this.project.assertIdsAreUnique()),this.projectTrace=this.evaluator.evaluateProject(this.project),this.tracesByNode={},this.tracesByDefinition=new Map;for(let e of this.projectTrace.definitions){const t=e.source.definition;this.tracesByDefinition.set(t,e)}this.evaluationHappenedSuccessfully()}traceForNode(e){const t=e.hash();let n=this.tracesByNode[t];if(n)return n;if(e.parent){const n=this.traceForNode(e.parent);if(n)for(const i of n.childElementTraces())if(i.source===e.source)return this.tracesByNode[t]=i,i}else if(this.projectTrace)for(const{element:i}of this.projectTrace.definitions)if(i&&i.source===e.source)return this.tracesByNode[t]=i,i}traceForComponent(e){return this.tracesByDefinition.get(e)}getProjectSnapshot(){return this.editHistory.currentSnapshot()}loadProjectSnapshot(e,t){this.project=e.toProject(),this.project.projectId=t,this.project.ensureProjectDataExists(),this.project.ensureProjectNamesDontConflictWithGlobals()}async overwriteWithProject(e){const t=this.storage.getProjectId(),{snapshot:n}=await Jk({getProjectOptions:{projectId:e},upgradeSnapshotOptions:{defaultProjectId:t}});n&&(await this.saveVersion(),this.loadProjectSnapshot(n,t),this.project.components.forEach(n=>{n.projectId===e&&(n.projectId=t)}),this.project.modifiers.forEach(n=>{n.projectId===e&&(n.projectId=t)}),this.checkpoint(),Oe.redraw())}initFocus(e){const{projectId:t,edit:n,view:i,embed:r}=e;r||"_intro"===t||"_staging"===t||(n?this.enterEditingMode():i||this.project.documentation.hasContent()?this.enterViewingMode():this.enterEditingMode())}enterViewingMode(){this._editingMode="viewing",this.project.setParameterDefaults(),this.project.focusedDocumentation()||this.project.focusItem(this.project.documentation)}enterEditingMode(e){this._editingMode="editing",this.project.revertParametersToDefault(),e?this.project.focusItem(e):this.project.ensureValidFocusedComponent(),qT()}isEditingMode(){return"editing"===this._editingMode}debug_loadProjectSnapshotJSON(e){const t=kS.fromJSON(e);Ps(t,"Could not create project snapshot."),this.loadProjectSnapshot(t,"debug")}loadProjectFromSVG(e){const t=/<!--([^-]*)-->/.exec(e);if(t){const e=t[1],n=vr(e),i=kS.fromString(n);if(i){const e=i.toProject();new gC(e).renameConflictingDefinitionsBeforeImportToProject(this.project);const t=new LS;return t.components=e.components,t.modifiers=e.modifiers,t.projectParameters=e.allParameters(),oA(this.project,t),!0}}return!1}resetEditHistory(){this.editHistory=new TS(this.project)}checkpoint(){const e=this.editHistory.checkpoint(this.project);this.debug_lastCheckpointDifference=e,this.shouldForceSaveAtNextCheckpoint||"material"===e?(this.shouldForceSaveAtNextCheckpoint=!1,this.savetoStorage(),this.debug_lastCheckpointSaved=!0):this.debug_lastCheckpointSaved=!1,this.lastCheckpointTimeMs=Date.now()}checkpointAfterNextEvaluation(){this.shouldCheckpointAfterNextEvaluation=!0}evaluationHappenedSuccessfully(){var e,t;if(this.shouldCheckpointAfterNextEvaluation&&this.isEditingMode()){let e=this.isMidGesture();if(e){Date.now()-this.lastCheckpointTimeMs>3e4&&(console.warn("It's been too long since the last checkpoint. Saving!"),e=!1)}e||(this.checkpoint(),this.shouldCheckpointAfterNextEvaluation=!1)}null==(t=(e=this.activeTool()).onAfterEvaluation)||t.call(e)}hasUndo(){return this.editHistory.hasUndo()}hasRedo(){return this.editHistory.hasRedo()}undo(){this.hasUndo()&&(this.project=this.editHistory.undo(),this.shouldForceSaveAtNextCheckpoint=!0,this.checkpointAfterNextEvaluation(),this.snapping.clear())}redo(){this.hasRedo()&&(this.project=this.editHistory.redo(),this.shouldForceSaveAtNextCheckpoint=!0,this.checkpointAfterNextEvaluation(),this.snapping.clear())}deleteSelection(){this.project.deleteSelection(),this.snapping.clear()}async snapshotPayload(){const e=this.editHistory.currentSnapshot(),t=await(async()=>{const e=Oj.project.previewComponent(),t=Oj.traceForComponent(e);if(!(null==t?void 0:t.result))return;const n=new It(800,450),i=HP(t.result,n,"px");return e instanceof yb&&!i.graphic.hasStyle()&&i.graphic.assignStroke(new Vi),_P(i,{backgroundColor:"#ffffff",hairlineStrokeWidthPixels:2})})();void 0===t&&console.warn("previewPNG undefined");return{projectSnapshot:e,previewPNG:t,coverPhoto:void 0!==this.storage.getProjectForkedFrom()&&va.loggedInUser?this.project.documentation.firstImageWithUserId(va.loggedInUser.userId):this.project.documentation.firstImage()}}async savetoStorage(){if(!this.isEditingMode())return;const e=await this.snapshotPayload();this.storage.checkpoint(e)}resetStorage(){window.localStorage.clear(),window.location.reload()}async saveVersion(){if(this.storage.hasWritePermission()){const e=await this.snapshotPayload();return await this.storage.saveVersion(e)}throw new Error("Unable to save a version")}openRealSizeCalibration(){ia.open({modalView:()=>Oe(xL)})}openPointerInitModal(){this.deviceStorage.pointerInitShown=!0,ia.open({modalView:()=>Oe(lA)})}openGettingStartedSequence(){this.gettingStartedState=new FS}closeGettingStartedSequence(){this.gettingStartedState=void 0}activeTool(){return this.tools[this.activeToolName]}ensureEnabledActiveTool(){var e;const t=this.activeTool();return(null==(e=t.isDisabled)?void 0:e.call(t))&&this.activateTool("Select"),this.activeTool()}activateTool(e){var t,n,i,r;null==(n=(t=this.activeTool()).deactivate)||n.call(t),this.activeToolName=e,this.snapping.clear(),null==(r=(i=this.activeTool()).activate)||r.call(i)}updateGhostGeometry(){const{project:e}=this,t=new xi;for(let n of e.selection.allNodes().toNodes()){const e=qC(n);e&&t.items.push(e)}if(e.focus instanceof CC&&e.focus.node.isPath()){const n=qC(e.focus.node);n&&t.items.push(n)}this.ghostGeometry=t}clearGhostGeometry(){this.ghostGeometry=null}snappingDistanceWorld(){const e=this.project.focusedComponent();Ps(e,"Snapping distance should only be used when a component is focused");const t=this.viewportManager.viewportForComponent(e);return _j/t.pixelsPerUnit}selectionDistanceWorld(){const e=this.project.focusedComponent();Ps(e,"Selection distance should only be used when a component is focused");const t=this.viewportManager.viewportForComponent(e);return Ij/t.pixelsPerUnit}gridIncrement(){const e=this.project.focusedComponent();Ps(e);const t=this.viewportManager.viewportForComponent(e),{interval:n,subdivisions:i}=YL(t,this.project.settings.gridDivisions);return n/i}startGesture(e){const t=Symbol(e);this.gestureIds.add(t);const n=window.setTimeout(()=>{console.warn(`Gesture "${t.description}" has been active for 30 seconds!`),Ao("long gesture",{gestureName:t.description});const e=window.setTimeout(()=>{console.warn(`Gesture "${t.description}" has been active for a further 5 minutes! Stopping.`),this.stopGesture(t),Ao("gesture failsafe",{gestureName:t.description})},3e5);this.debug_gestureTimeoutsById.set(t,e)},3e4);return this.debug_gestureTimeoutsById.set(t,n),t}stopGesture(e){const t=this.debug_gestureTimeoutsById.get(e);clearTimeout(t),this.debug_gestureTimeoutsById.delete(e),this.gestureIds.delete(e),this.checkpointAfterNextEvaluation()}isMidGesture(){return this.gestureIds.size>0}isCanvasPanningOrPreparingToPan(){return this.isCanvasPanning||this.isSpaceDown&&this.canvasPointerPositionPixels}zoomViewport(e,t){const n=this.project.focusedComponent();if(!n)return;const i=this.viewportManager.viewportForComponent(n);this.viewportManager.zoomViewport(i,this.project.selection,e,t)}zoomViewportToPixelsPerInch(e){const t=this.project.focusedComponent();if(!t)return;const n=this.viewportManager.viewportForComponent(t);this.viewportManager.zoomViewportToPixelsPerInch(n,e)}zoomViewportToFitSelected(){const e=this.project.focusedComponent();if(!e)return;const t=this.viewportManager.viewportForComponent(e);this.viewportManager.zoomViewportToFitSelection(t,e,this.project.selection)}zoomViewportToFitFocused(){const{focus:e}=this.project;if(e instanceof CC||e instanceof SC){const t=this.viewportManager.viewportForComponent(e.component);this.viewportManager.zoomViewportToFitFocus(t,e)}}zoomViewportToFitAll(){const e=this.project.focusedComponent();if(!e)return;const t=this.viewportManager.viewportForComponent(e);this.viewportManager.zoomViewportToFitAll(t,e)}async ensureExamplesData(){if(this.examplesData)return this.examplesData;const e=(await Ms(async()=>{const{generatedExamplesData:e}=await import("./examples-data-CHe4cgV7.js");return{generatedExamplesData:e}},[])).generatedExamplesData;return this.examplesData=new MS(e),this.examplesData}},Nj={setComponentParameters:function(e){const t=Oj.project.focusedComponent();if(t){for(const n in e){const i=t.parameterWithName(n);i?i.expression.jsCode=e[n]+"":console.warn("Component parameter not found: "+n)}Oe.redraw.sync()}else console.warn("Must be focused on a component.")},setProjectParameters:function(e){for(const t in e){const n=Oj.project.parameterWithName(t);n?n.expression.jsCode=e[t]+"":console.warn("Project parameter not found: "+t)}Oe.redraw.sync()},exportPNG:async function(e){await Rj("png",e),await Dj()},exportSVG:async function(e){await Rj("svg",e),await Dj()},exportPDF:async function(e){await Rj("pdf",e),await Dj()},exportDXF:async function(e){await Rj("dxf",e),await Dj()},help:function(){}};function Dj(){return new Promise(e=>{setTimeout(()=>{e()},250)})}const Rj=async(e,t)=>{if(!(await bT()))return;const n=Oj.project.focusedComponent();if(!n)return;const i=CP(n,e,t);i&&(WP([i]),Vj(n.name),wT())};let Fj,Bj=0;const Vj=e=>{Bj++,window.clearTimeout(Fj),Fj=window.setTimeout(()=>{Ao("project downloaded via console",{component:e,count:Bj,license:Oj.storage.getProjectLicense(),creditId:Oj.storage.getCreditId()}),Bj=0},1500)};var jj,Hj={exports:{}};var Uj=(jj||(jj=1,Hj.exports=function(e,t,n){e=e||{};var i=t.prototype,r={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function s(e,t,n,r){return i.fromToBase(e,t,n,r)}n.en.relativeTime=r,i.fromToBase=function(t,i,s,o,a){for(var l,c,h,u=s.$locale().relativeTime||r,d=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],p=d.length,f=0;f<p;f+=1){var m=d[f];m.d&&(l=o?n(t).diff(s,m.d,!0):s.diff(t,m.d,!0));var g=(e.rounding||Math.round)(Math.abs(l));if(h=l>0,g<=m.r||!m.r){g<=1&&f>0&&(m=d[f-1]);var v=u[m.l];a&&(g=a(""+g)),c="string"==typeof v?v.replace("%d",g):v(g,i,m.l,h);break}}if(i)return c;var y=h?u.future:u.past;return"function"==typeof y?y(c):y.replace("%s",c)},i.to=function(e,t){return s(e,t,this,!0)},i.from=function(e,t){return s(e,t,this)};var o=function(e){return e.$u?n.utc():n()};i.toNow=function(e){return this.to(o(this),e)},i.fromNow=function(e){return this.from(o(this),e)}}),Hj.exports);const zj=D(Uj);const Wj=e=>{const t=window.cuttle_pageLoadData;Js(t)&&Xs(t.checkpoints)&&t.checkpoints.push({name:e,time:Date.now()})},Gj=bo(()=>{Oj.checkpointAfterNextEvaluation(),Oe.redraw()},500),$j={backspace:""},Zj={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"};class qj{constructor(e,t){this.key=e,this.command=(null==t?void 0:t.command)??!1,this.shift=!!(null==t?void 0:t.shift),this.option=!!(null==t?void 0:t.option),this.displayOnly=!!(null==t?void 0:t.displayOnly)}toString(){let e="";const t=to();return!0===this.command&&(e+=t?"":"Ctrl+"),this.shift&&(e+=t?"":"Shift+"),this.option&&(e+=t?"":"Alt+"),$j[this.key]?e+=$j[this.key]:e+=this.key.toUpperCase(),e}matchesEvent(e){if(this.displayOnly)return!1;const t=to(),n="optional"===this.command||(t?e.metaKey:e.ctrlKey)===this.command,i=e.shiftKey===this.shift,r=e.altKey===this.option,s=(e=>{const t=Zj[e.which];return void 0!==t?t:e.key.toLowerCase()})(e)===this.key;return n&&i&&r&&s}}const Kj=[],Yj=(e,t)=>{e.displayOnly||Kj.push({accelerator:e,action:t})},Xj=e=>{const t=Oj.traceForComponent(e);Ps(null==t?void 0:t.isSuccess());const n=HP(t.result,new It(72),"px");Ps(n);return FP(n,{hairlineStrokeWidth:1,maximumFractionDigits:2}).replace(/\n/g,"")},Jj=e=>{const{spawnFrom:t,label:n,initialValue:i,onsubmit:r,placeholder:s,note:o,autofocus:a,oncancel:l}=e,c=Vo({spawnFrom:t,view:()=>Oe(Qj,{label:n,initialValue:i,placeholder:s,note:o,autofocus:a,onsubmit:e=>{c.close(),r(e)},oncancel:()=>{c.close()}}),overlay:!0,onclose:()=>{null==l||l()}})},Qj={view:({attrs:{label:e,placeholder:t,note:n,autofocus:i,onsubmit:r,oncancel:s}})=>Oe(".prompt",[Oe("form",{onsubmit:e=>{e.preventDefault(),r(e.target.querySelector(".prompt-input").value)}},[Oe("label",{},[e,Oe("input.prompt-input",{type:"text",placeholder:t,autofocus:i,onkeyup:e=>{"Escape"===e.key&&(null==s||s())}})]),n&&Oe(".prompt-note",n),Oe("input",{type:"submit",value:"OK"})])]),oncreate:({dom:e,attrs:{autofocus:t,initialValue:n}})=>{var i;t&&(null==(i=e.querySelector(".prompt-input"))||i.focus()),n&&(e.querySelector(".prompt-input").value=n)}},eH={view:({attrs:{options:e,className:t,selected:n,onchange:i}})=>Oe("select",{className:t,onchange:t=>{Ps(t.target instanceof HTMLSelectElement);let n=e[t.target.selectedIndex];"object"==typeof n&&(n=n.value),i(n)}},e.map(e=>{let t,i;return"object"==typeof e?(t=e.value,i=e.label):(t=e,i=e),Oe("option",{value:t,selected:n===t},i)}))},tH=e=>{const t=e.attrs.filename;let n=e.attrs.format;return{view({attrs:{filename:e,format:i,formatOptions:r,autoSelect:s,onchange:o}}){const a=(e,i)=>{const r="."+i;(e=vf(e,r))===r&&(e=vf(t,r)),n=i,o(e,i)},l=e.lastIndexOf(".");return Oe(".filename-input",[Oe(cB,{value:e,initialSelection:s?{start:0,end:l>0?l:e.length}:void 0,onchange:e=>a(e,n)}),Oe(eH,{options:r,selected:i,onchange:t=>a(e,t)})])}}},nH=`url('data:image/svg+xml;base64,${btoa('\n<svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect width="8" height="8" fill="white"/>\n<rect width="4" height="4" fill="#DDDDDD"/>\n<rect x="4" y="4" width="4" height="4" fill="#DDDDDD"/>\n</svg>\n')}')`,iH=["none",new Gn(0,0,0,1),new Gn(0,0,1,1),new Gn(0,1,0,1),new Gn(0,1,1,1),new Gn(.5,.5,.5,1),new Gn(1,0,0,1),new Gn(1,0,1,1),new Gn(1,1,0,1),new Gn(1,1,1,1)],rH=e=>{const t=e.toCSSString();return`linear-gradient(${t}, ${t}), ${nH}`},sH=e=>{let t,n=e,[i,r,s,o]="none"===n.attrs.color?[0,0,0,1]:n.attrs.color.toHSVA();const a=e=>{n.attrs.onchange(e)},l=e=>t=>{const n=t.target.getBoundingClientRect(),l=t=>{const l=St((t.clientX-n.left)/n.width),c=St((t.clientY-n.top)/n.height);e(l,c),(()=>{const e=Gn.fromHSVA(i,r,s,o);a(e)})()};l(t),_A(t,{onMove:l})},c=l((e,t)=>{r=e,s=1-t}),h=l((e,t)=>{i=1-t,0!==r||0!==s&&.5!==s||(r=.618,s=1)}),u=l((e,t)=>{o=1-t}),d=e=>{e instanceof Gn&&([i,r,s,o]=e.toHSVA()),a(e)},p=()=>{const e="none"===n.attrs.color?new Gn(0,0,0,1):n.attrs.color;let[a,l,p,f]=e.toHSVA();if(s=p,o=f,s>0&&(r=l),r>0&&s>0){(0===i||1===i)&&(0===a||1===a)||(i=a)}const m=Gn.fromHSVA(i,1,1,1),g=e.clone();g.a=1;const v=`linear-gradient(to top, rgb(0,0,0), transparent), linear-gradient(to left, ${m.toCSSString()}, white)`,y=`linear-gradient(to top, transparent, ${g.toCSSString()}), ${nH}`,b=t=>t instanceof Gn&&t.equals(e)||"none"===t&&null===n.attrs.color,w=e=>{n.attrs.onchange(e),t.close()},x=Oj.project.allColors().filter(e=>!iH.some(t=>t instanceof Gn&&e.equals(t)));return Oe(lH.ColorPickerPopup,[Oe(lH.ColorPickerPalette,[Oe(lH.ColorPickerValueSaturation,{onpointerdown:c,style:{background:v}},[Oe(lH.ColorPickerValueSaturationIndicator,{style:{top:100*(1-s)+"%",left:100*r+"%","background-color":g.toCSSString()}})]),Oe(lH.ColorPickerHue,{onpointerdown:h},[Oe(lH.ColorPickerHueIndicator,{style:{top:100*(1-i)+"%"}})]),Oe(lH.ColorPickerAlpha,{onpointerdown:u,style:{background:y}},[Oe(lH.ColorPickerAlphaIndicator,{style:{top:100*(1-o)+"%"}})])]),Oe(aH,{color:n.attrs.color,onchange:d}),Oe(lH.ColorPickerSwatches,iH.map(e=>Oe(oH,{color:e,onpointerdown:()=>w(e),isChosen:b(e)}))),x.length>0&&[Oe(lH.ColorPickerSwatchesCategoryName,"Project"),Oe(lH.ColorPickerSwatches,x.map(e=>Oe(oH,{color:e,onpointerdown:()=>w(e),isChosen:b(e)})))]])};return{view(e){n=e;const{color:i}=n.attrs;return Oe(".color-picker",[Oe(oH,{color:i,onpointerdown:n=>{n.stopPropagation();const i=uo(e);Oj.isPickerOpen=!0;const r=Oj.startGesture("Color Picker");t=Vo({spawnFrom:i,view:p,placement:"top-start",offset:8,onclose:()=>{Oj.isPickerOpen=!1,Oj.stopGesture(r)}})}})])}}},oH={view:({attrs:{color:e,onpointerdown:t,isChosen:n}})=>Oe(lH.ColorPickerSwatch,{style:"none"===e?void 0:{background:rH(e)},onpointerdown:t,className:eo({chosen:n,none:"none"===e})})},aH={view({attrs:{color:e,onchange:t}}){const n="none"===e?"none":e.toCSSHexString(),i="none"===e?"":ps(100*e.a,4).toString(),r=n=>{n!==e&&(e=n,t(n))};return Oe(lH.ColorCodeInput,[Oe("label","Color Code"),Oe(cB,{value:n,onchange:t=>{if("none"===(t=t.trim()))return void r("none");const n=t.startsWith("#")?t:`#${t}`,i=Gn.fromCSSString(n);Gn.isValid(i)&&(e instanceof Gn&&(i.a=e.a),r(i))}}),Oe(cB,{value:i,onchange:t=>{if("none"===e)return;let n=parseFloat(t);if(Ss(n)){n=Ct(n,0,100);const t=e.clone();t.a=n/100,r(t)}}})])}},lH=qL.classes({ColorPickerPopup:{display:"flex",flexDirection:"column",gap:8,padding:8,width:324},ColorPickerSwatch:{width:20,height:20,boxShadow:"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px inset",borderRadius:2,cursor:"pointer","&.none":{background:"linear-gradient(45deg, #fff 45%, #f00 50%, #f00 50%, #fff 55%)"}},ColorPickerPalette:{display:"flex",gap:4},ColorPickerValueSaturation:{position:"relative",width:260,height:260},ColorPickerValueSaturationIndicator:{pointerEvents:"none",zIndex:1,position:"absolute",marginLeft:-6,marginTop:-6,width:12,height:12,border:"1px solid #fff",borderRadius:8,boxShadow:"rgba(0, 0, 0, 0.2) 0px 0px 0px 1px inset, rgba(0, 0, 0, 0.2) 0px 0px 0px 1px"},ColorPickerHue:{position:"relative",width:20,height:260,background:"linear-gradient(0deg, #f00, #ff0, #0f0, #0ff, #00f, #f0f, #f00)"},ColorPickerHueIndicator:{pointerEvents:"none",position:"absolute",marginTop:-1,width:20,height:2,border:"1px solid #fff",borderRadius:1,boxShadow:"rgba(0, 0, 0, 0.2) 0px 0px 0px 1px"},ColorPickerAlphaIndicator:{pointerEvents:"none",position:"absolute",marginTop:-1,width:20,height:2,border:"1px solid #fff",borderRadius:1,boxShadow:"rgba(0, 0, 0, 0.2) 0px 0px 0px 1px"},ColorPickerAlpha:{position:"relative",width:20,height:260},ColorPickerSwatches:{display:"flex",flexWrap:"wrap",gap:4},ColorPickerSwatchesCategoryName:{marginTop:4,color:qL.color.blackAlpha60,textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em",fontSize:12,lineHeight:"10px"},ColorCodeInput:{display:"flex",flexDirection:"row",gap:4,alignItems:"baseline","& input":{font:qL.font.monospaceFont14,"&:nth-of-type(1)":{width:150,flexGrow:1},"&:nth-of-type(2)":{width:75}}}}),cH={view({attrs:{component:e}}){var t;const n=Oj.traceForComponent(e),i=((null==(t=null==n?void 0:n.result)?void 0:t.boundingBox())??new De).size(),{units:r}=Oj.project.settings;return Oe(hH,{units:r,width:i.x,height:i.y})}},hH={view:({attrs:{units:e,width:t,height:n,depth:i}})=>Oe(".component-dimensions",[Oe("span.dimension",[Oe(Zo,{message:()=>"Width",placement:"top"},[Oe(Jo,{icon:"width"})]),Oe("span.number",Oe("span.number-value",t.toFixed(2)),Oe("span.number-unit",e))]),Oe("span.spacing"),Oe("span.dimension",[Oe(Zo,{message:()=>"Height",placement:"top"},[Oe(Jo,{icon:"height"})]),Oe("span.number",Oe("span.number-value",n.toFixed(2)),Oe("span.number-unit",e))]),Ss(i)&&[Oe("span.spacing"),Oe("span.dimension",[Oe(Zo,{message:()=>"Depth",placement:"top"},[Oe(Jo,{icon:"depth"})]),Oe("span.number",Oe("span.number-value",i.toFixed(2)),Oe("span.number-unit",e))])]])},uH={view:({attrs:{value:e,onChange:t}})=>Oe(eH,{options:Zr,className:"unit-select",selected:e,onchange:e=>{t(e)}})},dH=()=>{let e,t,n=!1;const i=e=>{t=pH(e.string,e.unit),n=!0},r=()=>{n=!1};return{onupdate({attrs:{literal:e,forceEditing:t}}){t&&!n&&i(e)},view({attrs:{literal:s,onChange:o,minFractionDigits:a=0,maxFractionDigits:l=3}}){if(n)return Ps(void 0!==t),Oe(".literal-input",[Oe(dj,{value:t,readOnly:!1,confirmOnEnter:!0,initialSelections:e,onChange(e){t=e;const n=Yy(e);n&&"Number"===n.type&&o(e)},onSelection(t){e=t},onFocus:()=>i(s),onBlur:r})]);const c=()=>{const t=BV(s.string);var n;n=t.length>=1?t[0]:"all",i(s),e="all"===n?n:[{anchor:{line:0,ch:n.start},head:{line:0,ch:n.end}}]},{unit:h}=s,u=Ct(xr(s.string),a,l);return Oe(".literal-input",[Oe(mj,{stringValue:s.string,fractionDigits:u,tabIndex:0,onChange(e){o(pH(e,h))},onClick:c,onFocus:c}),h&&Oe(uH,{value:h,onChange:e=>{const t=Qr(s.value,h,e),n=jb(t,e,a);o(n)}})])}}},pH=(e,t)=>t?`${e} ${t}`:e,fH=e=>e&&"Number"===e.type?e.unit?Qr(e.value,e.unit,"mm"):e.value:1;class mH{constructor(e){this.dependencyStatus="loading",this.filename="untitled",this.format="3mf",this.layers=[],this.isCanvasInitialized=!1,this.canvasWidth=0,this.canvasHeight=0,this.animationFrameId=null,this.component=e,this.filename=SP(e,this.format),this.initLayers(),this.initLibraries()}destructor(){null!==this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0)}initLayers(){const e=Oj.traceForComponent(this.component);Ps(null==e?void 0:e.isSuccess());const t=e.result.clone();t.allPathsAndCompoundPaths().forEach(e=>{let t=e.allPaths().every(e=>e.closed);!(e.fill instanceof ji)&&t&&e.stroke&&e.stroke.hairline&&(e.fill=new ji(e.stroke.color))});const n=xi.flatten(t,void 0,!0),i=new Map;n.allPathsByColor().map(e=>new wi(e).copyStyle(e[0])).forEach(e=>{if(e.fill instanceof ji){let t=e.fill.color.toRGB8Number();i.set(t,e)}});this.layers=Array.from(i.entries()).map(([e,t],n)=>({color:e,index:n,depthString:jb(3,"mm",1),compoundPath:t}))}async initLibraries(){if(!this.dependencies){try{const{THREE:e,OrbitControls:t,STLExporter:n,SVGLoader:i,exportTo3MF:r}=await Ms(async()=>{const{THREE:e,OrbitControls:t,STLExporter:n,SVGLoader:i,exportTo3MF:r}=await import("./3d-dependencies-BhtbaEib.js");return{THREE:e,OrbitControls:t,STLExporter:n,SVGLoader:i,exportTo3MF:r}},[]);this.dependencies={THREE:e,OrbitControls:t,STLExporter:n,SVGLoader:i,exportTo3MF:r}}catch(e){this.dependencyStatus="loadError"}finally{Oe.redraw()}this.canvas&&!this.isCanvasInitialized&&this.initCanvas(this.canvas)}}initCanvas(e){if(this.isCanvasInitialized)return;if(this.canvas=e,!this.dependencies)return;const{THREE:t,OrbitControls:n}=this.dependencies;try{const i=new t.Scene;this.scene=i,i.background=new t.Color(qL.color.gray94);const r=this.componentToShapes(this.component);this.threeGroup=r,i.add(r);const s=(new t.Box3).setFromObject(r),o=s.getCenter(new t.Vector3),a=s.getSize(new t.Vector3),l=Math.max(a.x,a.y,a.z),c=new t.AmbientLight(16777215,1.2);i.add(c);const h=Math.max(2*l,100),u=new t.DirectionalLight(16777215,.8);u.position.copy(o).add(new t.Vector3(.5*h,h,h)),i.add(u);const d=new t.DirectionalLight(16777215,.5);d.position.copy(o).add(new t.Vector3(-.25*h,-h,h)),i.add(d);const p=new t.OrthographicCamera;this.camera=p;const f=Math.max(3*l,500),m=new t.Vector3(.5*-f,.5*-f,.5*f);p.position.copy(o).add(m),p.up.set(0,0,1);const g=new n(p,e);this.controls=g,g.enableDamping=!0,g.dampingFactor=.05,g.target.copy(o),this.fitCameraToScene();const v=new t.WebGLRenderer({antialias:!0,canvas:e});this.renderer=v,v.setPixelRatio(window.devicePixelRatio),this.resizeObserver=new ResizeObserver(e=>{for(const t of e){const{width:e,height:n}=t.contentRect;this.handleResize(e,n)}});const y=e.parentElement;this.resizeObserver.observe(y);const b=y.getBoundingClientRect();this.handleResize(b.width,b.height);const w=()=>{this.animationFrameId=requestAnimationFrame(w),g.update(),v.render(i,p)};this.animationFrameId=requestAnimationFrame(w),this.isCanvasInitialized=!0,this.dependencyStatus="ready"}catch(i){return void(this.dependencyStatus="webglError")}finally{Oe.redraw()}}handleResize(e,t){if(!this.renderer)return;const n=Math.max(64,Math.floor(e)),i=Math.max(64,Math.floor(t));this.canvasWidth=n,this.canvasHeight=i,this.renderer.setSize(n,i),this.updateCameraProjection()}setLayers(e){this.layers=e,this.rebuildShapes()}setFilenameAndFormat(e,t){this.filename=e,this.format=t}getThreeSize(){if(!this.dependencies)return;if(!this.threeGroup)return;const{THREE:e}=this.dependencies;return(new e.Box3).setFromObject(this.threeGroup).getSize(new e.Vector3)}rebuildShapes(){if(!this.scene||!this.threeGroup)return;this.scene.remove(this.threeGroup);const e=this.componentToShapes(this.component);this.threeGroup=e,this.scene.add(e),this.fitCameraToScene()}fitCameraToScene(){if(!(this.scene&&this.camera&&this.threeGroup&&this.controls&&this.dependencies))return;const{THREE:e}=this.dependencies,t=(new e.Box3).setFromObject(this.threeGroup),n=t.getSize(new e.Vector3),i=t.getCenter(new e.Vector3);this.controls.target.copy(i);const r=new e.Vector3;this.camera.getWorldDirection(r),r.normalize();const s=Math.max(n.x,n.y,n.z),o=Math.max(100,2*s);this.camera.position.copy(i).add(r.multiplyScalar(-o)),this.updateCameraProjection(),this.controls.update()}updateCameraProjection(){if(!this.camera||!this.threeGroup||!this.dependencies)return;const{THREE:e}=this.dependencies,t=this.canvasWidth/this.canvasHeight,n=(new e.Box3).setFromObject(this.threeGroup),i=n.getSize(new e.Vector3),r=n.getCenter(new e.Vector3),s=Math.max(i.x,i.y,i.z),o=.1*s,a=Math.max(i.x,i.y,i.z)+o,l=this.camera.position.distanceTo(r),c=s/2,h=.33*s;this.camera.near=Math.max(.1,l-c-h),this.camera.far=l+c+h,t>1?(this.camera.left=-a/2*t,this.camera.right=a/2*t,this.camera.top=a/2,this.camera.bottom=-a/2):(this.camera.left=-a/2,this.camera.right=a/2,this.camera.top=a/2/t,this.camera.bottom=-a/2/t),this.camera.updateProjectionMatrix()}componentToShapes(e){Ps(this.dependencies);const t=this.dependencies.THREE,n=Oj.traceForComponent(e);Ps(null==n?void 0:n.isSuccess());const i=n.result.clone(),r=i.boundingBox();if(Ps(r),i.transform({position:r.center().negate()}),"mm"!==Oj.project.settings.units){const e=Jr(Oj.project.settings.units,"mm");i.transform({scale:e})}const s=new t.Group;let o=0;for(const a of this.layers){const e=Yy(a.depthString),t=o,n=o+fH(e),i=a.compoundPath.clone();if(i.transform({position:r.center().negate()}),"mm"!==Oj.project.settings.units){const e=Jr(Oj.project.settings.units,"mm");i.transform({scale:e})}const l=this.compoundPathToThreeShape(i,a.color,t,n);l&&s.add(l),o=n}return s}compoundPathToThreeShape(e,t,n,i){Ps(this.dependencies);const{THREE:r,SVGLoader:s}=this.dependencies,o=i-n;if(o<=0)return void console.warn("Layer front should be greater than layer back.");const a=new r.Group,l=new r.MeshPhongMaterial({color:new r.Color(t),side:r.FrontSide,flatShading:!0}),c=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">\n  <path d="${function(e){const t=e.clone();t.transform({scale:new It(1,-1)});return yH(Ui.fromPaths(t.allPaths())),t.toSVGPathString()}(e)}" fill-rule="evenodd"></path>\n</svg>`;return(new s).parse(c).paths.forEach(e=>{s.createShapes(e).forEach(e=>{const t=new r.ExtrudeGeometry(e,{depth:o,bevelEnabled:!1});t.translate(0,0,n);const i=new r.Mesh(t,l);a.add(i)})}),a}exportSTL(){Ps(this.dependencies);const{STLExporter:e}=this.dependencies;Ps(this.threeGroup);const t=(new e).parse(this.threeGroup,{binary:!0});return new Blob([t],{type:"application/octet-stream"})}async export3MF(){Ps(this.dependencies);const{exportTo3MF:e}=this.dependencies;Ps(this.threeGroup);return await e(this.threeGroup)}async export(){switch(this.format){case"stl":return this.exportSTL();case"3mf":return await this.export3MF();default:throw new Error(`Unsupported format: ${this.format}`)}}}const gH=e=>{const t=new mH(e.attrs.component);return{oncreate(e){const n=uo(e).querySelector("canvas");n&&t.initCanvas(n)},onremove(){t.destructor()},view(){const e=t.getThreeSize(),n="ready"===t.dependencyStatus;let i;switch(t.dependencyStatus){case"loading":i=Oe(".loading-indicator");break;case"loadError":i=[Oe("p","Error loading 3D export feature."),Oe("p","Please reload the page.")];break;case"webglError":i=[Oe("p",["This feature requires WebGL. See Cuttles ",Oe("a",{href:"https://cuttle.xyz/learn/cuttle-system-requirements",target:"_blank"},"system requirements"),"."]),Oe("p",["If this continues please contact ",Oe("a",{href:"mailto:support@cuttle.xyz?subject=WebGL%20error"},"support@cuttle.xyz"),"."])]}return i&&(i=Oe(bH.CanvasStatus,i)),Oe(".simple-modal-box"+bH.Export3DModal,[Oe(bH.CanvasContainer,[Oe("canvas"),e&&Oe(bH.Dimensions,[Oe(hH,{units:"mm",width:e.x,height:e.y,depth:e.z})]),i]),Oe(bH.RightSide,[Oe(".simple-modal-contents",[Oe(".editor-form",[Oe(tH,{filename:t.filename,format:t.format,formatOptions:[{label:"3MF",value:"3mf"},{label:"STL",value:"stl"}],autoSelect:!0,onchange:(e,n)=>{t.setFilenameAndFormat(e,n)}}),Oe(vH,{value:t.layers,onChange:e=>{t.setLayers(e)}})])]),Oe(".simple-modal-actions",[Oe(vL,{primaryAction:{label:`Download ${t.format.toUpperCase()}`,action:async()=>{const e=await t.export();eA(t.component.name,t.format),wT(),iE.saveAs(e,t.filename)},disabled:!n},cancelAction:{label:"Cancel",action:()=>{t.destructor()}}})])])])}}},vH={view:e=>{const{value:t,onChange:n}=e.attrs,i=[...t].reverse();return Oe(bH.LayerConfigurator,[i.map(e=>{const{color:i,depthString:r,index:s}=e,o=Yy(r);return Ps(o&&"Number"===o.type),Oe(bH.LayerConfiguratorRow,[Oe(sH,{color:Gn.fromRGB8Number(i),onchange(e){((e,i)=>{const r=t.slice();"none"!==i&&(r[e].color=i.toRGB8Number(),n(r))})(s,e)}}),Oe(dH,{literal:o,minFractionDigits:1,onChange(e){((e,i)=>{Ps(t[e].index===e),t[e].depthString=i,n(t)})(s,e)}})])})])}};function yH(e,t=0){for(const n of e.contained)if(n instanceof zi){t%2==0!==n.path.signedArea()<0&&n.path.reverse(),yH(n,t+1)}}const bH=qL.classes({Export3DModal:{display:"flex",flexDirection:"row",width:1e3,height:500},RightSide:{display:"flex",flexDirection:"column",flex:"1 1 auto","& .simple-modal-contents":{flex:"1 1 auto",minWidth:240},"& .simple-modal-actions":{flex:"0 0 auto"}},CanvasContainer:{display:"flex",flex:"0 1 540px",position:"relative",overflow:"hidden",alignItems:"center",justifyContent:"center","& canvas":{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"block"}},Dimensions:{position:"absolute",left:16,bottom:16},CanvasStatus:{font:qL.font.defaultFont14,userSelect:"text",textAlign:"center"},LayerConfigurator:{display:"flex",flexDirection:"column",gap:8,"& .literal-input":{flex:"1 0 auto",gap:6}},LayerConfiguratorRow:{display:"flex",flexDirection:"row",gap:12,alignItems:"center",padding:"2px 8px",borderRadius:6,backgroundColor:qL.color.gray94}}),wH=20,xH=(e,t,n,i,r,s)=>{const o=e.clone().invert(),a=new It(0,0).affineTransform(o),l=n.clone().affineTransform(o),{interval:c,subdivisions:h}=YL(t,r),u=a.clone().divScalar(c).floor().mulScalar(c),d=l.clone().divScalar(c).ceil().mulScalar(c),p=Oj.canvasPointerPositionPixels;s.fillStyle=qL.color.gray96,s.fillRect(0,0,n.x,wH),s.fillRect(0,0,wH,n.y),s.lineCap="butt",s.lineWidth=1.5,s.font=qL.font.defaultFont12,s.textAlign="center",s.textBaseline="hanging",s.beginPath();for(let f=u.x;f<d.x;f+=c)for(let t=1;t<h;t++){const n=new It(f+t*c/h,0).affineTransform(e).x;n>wH&&(s.moveTo(n,16),s.lineTo(n,20))}s.strokeStyle=qL.color.gray80,s.stroke(),s.beginPath();for(let f=u.x;f<d.x;f+=c){const t=new It(f,0).affineTransform(e).x;t>wH&&(s.moveTo(t,15),s.lineTo(t,20))}s.strokeStyle=qL.color.gray70,s.stroke(),s.fillStyle=qL.color.gray70;for(let f=u.x;f<d.x;f+=c){const t=new It(f,0).affineTransform(e).x;if(t>wH){const e=CH(f,i,r);s.fillText(e,t,2)}}s.beginPath();for(let f=u.y;f<d.y;f+=c)for(let t=1;t<h;t++){const n=new It(0,f+t*c/h).affineTransform(e).y;n>wH&&(s.moveTo(16,n),s.lineTo(20,n))}s.strokeStyle=qL.color.gray80,s.stroke(),s.beginPath();for(let f=u.y;f<d.y;f+=c){const t=new It(0,f).affineTransform(e).y;t>wH&&(s.moveTo(15,t),s.lineTo(20,t))}s.strokeStyle=qL.color.gray70,s.stroke(),s.fillStyle=qL.color.gray70;for(let f=u.y;f<d.y;f+=c){const t=new It(0,f).affineTransform(e).y;if(t>wH){const e=CH(f,i,r);s.save(),s.translate(2,t),s.rotate(-.5*Math.PI),s.fillText(e,0,0),s.restore()}}p&&p.x>wH&&p.y>wH&&(s.beginPath(),s.moveTo(p.x,0),s.lineTo(p.x,wH),s.moveTo(0,p.y),s.lineTo(wH,p.y),s.strokeStyle=qL.color.gray70,s.stroke())},CH=(e,t,n)=>{if("fractional"===n){const n=Math.trunc(e),i=e-n;if(0===i)return`${n}${t}`;for(let e=2;e<=4096;e*=2){const r=i*e;if(Number.isInteger(r))return 0===n?`${r}/${e}${t}`:`${n} ${Math.abs(r)}/${e}${t}`}}return parseFloat(e.toFixed(12)).toString()+t},SH=[{value:"svg",label:"SVG"},{value:"png",label:"PNG"},{value:"pdf",label:"PDF"},{value:"dxf",label:"DXF"}],kH=[{value:"none",label:"Standard SVG (default)"},{value:"glowforge",label:"Glowforge"},{value:"cricut",label:"Cricut"}],LH=async e=>{await bT()&&ia.open({modalView:()=>Oe(EH,{exportOptions:e})})},EH={view({attrs:{exportOptions:e}}){const t=e.some(e=>"svg"===e.format);return Oe(gL,{primaryAction:{label:1===e.length?`Download ${e[0].format.toUpperCase()}`:"Download",action:()=>QT(e)}},Oe(".editor-form",[e.map((e,t)=>Oe(tH,{filename:e.filename,format:e.format,formatOptions:SH,autoSelect:0===t,onchange:(t,n)=>{e.filename=t,e.format=n}})),t&&Oe(PH)]))}},PH={view(e){const t=Oj.deviceStorage.svgPostprocess;return Oe(".editor-form-key-values",[Oe(".editor-form-key","Optimize for Device"),Oe(".editor-form-value",Oe(eH,{options:kH,selected:t,onchange:e=>{Ps(mf(e)),Oj.deviceStorage.svgPostprocess=e}})),"glowforge"===t&&Oe(".editor-form-comment",["Exports an SVG optimized for Glowforge.",Oe("ul",Oe("li","Recolors paths so that inner paths will list before outer paths in the Glowforge interface. This lets you schedule inner cuts earlier in the cutting process."))]),"cricut"===t&&Oe(".editor-form-comment",["Exports an SVG optimized for Cricut Design Space.",Oe("ul",[Oe("li","Groups will be ungrouped."),Oe("li",'All shapes of the same color will be "pre-attached" (combined into a Compound Path).'),Oe("li","Black will be replaced with gray (it shows up better in Design Space).")])])])}},TH=async()=>{const e=await NT({accept:Vl.join(",")});if(!e||e.length<1)throw"No files chosen.";return e[0]},AH=e=>e.size>20971520?(jT.showBasic({message:"You chose a file larger than 20MB.",nextStep:"Try resizing or compressing the image before uploading.",type:"error"}),!1):!!Zl(e)||(jT.showBasic({message:`You chose a ${e.type} file to upload, but we don't support that type yet.`,nextStep:"Try uploading an image file.",type:"error"}),!1),MH=async e=>{if(!AH(e))throw"Image file format not supported";const t=await Oj.storage.uploadFile(e),n=`${Jl}${t}`;return Ao("upload image",{url:n}),n},IH=/^([<>])?(([1-9]\d*)?([xcbB?hHiIfdsp]))*$/,_H=/([1-9]\d*)?([xcbB?hHiIfdsp])/g,OH=(e,t,n)=>String.fromCharCode(...new Uint8Array(e.buffer,e.byteOffset+t,n)),NH=(e,t,n,i)=>new Uint8Array(e.buffer,e.byteOffset+t,n).set(i.split("").map(e=>e.charCodeAt(0))),DH=e=>({x:e=>[1,e,0],c:e=>[e,1,e=>({u:t=>OH(t,e,1),p:(t,n)=>NH(t,e,1,n)})],"?":e=>[e,1,e=>({u:t=>Boolean(t.getUint8(e)),p:(t,n)=>t.setUint8(e,n)})],b:e=>[e,1,e=>({u:t=>t.getInt8(e),p:(t,n)=>t.setInt8(e,n)})],B:e=>[e,1,e=>({u:t=>t.getUint8(e),p:(t,n)=>t.setUint8(e,n)})],h:t=>[t,2,t=>({u:n=>n.getInt16(t,e),p:(n,i)=>n.setInt16(t,i,e)})],H:t=>[t,2,t=>({u:n=>n.getUint16(t,e),p:(n,i)=>n.setUint16(t,i,e)})],i:t=>[t,4,t=>({u:n=>n.getInt32(t,e),p:(n,i)=>n.setInt32(t,i,e)})],I:t=>[t,4,t=>({u:n=>n.getUint32(t,e),p:(n,i)=>n.setUint32(t,i,e)})],f:t=>[t,4,t=>({u:n=>n.getFloat32(t,e),p:(n,i)=>n.setFloat32(t,i,e)})],d:t=>[t,8,t=>({u:n=>n.getFloat64(t,e),p:(n,i)=>n.setFloat64(t,i,e)})],s:e=>[1,e,t=>({u:n=>OH(n,t,e),p:(n,i)=>NH(n,t,e,i.slice(0,e))})],p:e=>[1,e,t=>({u:n=>((e,t,n)=>OH(e,t+1,Math.min(e.getUint8(t),n-1)))(n,t,e),p:(n,i)=>((e,t,n,i)=>{e.setUint8(t,i.length),NH(e,t+1,n-1,i)})(n,t,e,i.slice(0,e-1))})]}),RH=new RangeError("Structure larger than remaining buffer"),FH=new RangeError("Not enough values for structure");function BH(e){let t=[],n=0,i=IH.exec(e);if(!i)throw new RangeError("Invalid format string");const r=DH("<"===i[1]),s=(e,t)=>r[t](e?parseInt(e,10):1);for(;i=_H.exec(e);)((e,i,r)=>{for(let s=0;s<e;++s,n+=i)r&&t.push(r(n))})(...s(...i.slice(1)));const o=(e,i)=>{if(e.byteLength<(0|i)+n)throw RH;let r=new DataView(e,0|i);return t.map(e=>e.u(r))},a=(e,i,...r)=>{if(r.length<t.length)throw FH;if(e.byteLength<i+n)throw RH;const s=new DataView(e,i);new Uint8Array(e,i,n).fill(0),t.forEach((e,t)=>e.p(s,r[t]))};return Object.freeze({unpack:e=>o(e,0),pack:(...e)=>{let t=new ArrayBuffer(n);return a(t,0,...e),t},unpack_from:o,pack_into:a,pack_into_with_array:(e,i,r)=>{const s=new DataView(e,i);new Uint8Array(e,i,n).fill(0),t.forEach((e,t)=>e.p(s,r[t]))},iter_unpack:function*(e){for(let t=0;t+n<=e.byteLength;t+=n)yield o(e,t)},format:e,size:n})}function VH(e){var t=new ArrayBuffer(e);return new Uint8Array(t).buffer}function jH(e){return e+3&-4}async function HH(e){let t=mo(e.name),n=[e];"ttc"===t&&(n=await async function(e){const t=await e.arrayBuffer(),n=BH("4c").unpack_from(t,0).join("");if("ttcf"!==n)throw new Error("Unexpected file format: "+n);const i=e.name,r=i.substring(0,i.lastIndexOf(".")),s=[];for(let o=0,a=BH("I").unpack_from(t,8)[0];o<a;o++){const e=BH("I").unpack_from(t,12+4*o)[0],n=BH("H").unpack_from(t,e+4)[0],i=12+16*n;let a=0;for(let r=0;r<n;r++)a+=jH(BH("I").unpack_from(t,e+12+12+16*r)[0]);const l=VH(i+a),c=BH(i+"b").unpack_from(t,e);BH(i+"b").pack_into(l,0,...c);let h=i;const u=`${r}_${o}.ttf`;for(let r=0;r<n;r++){const n=BH("I").unpack_from(t,e+12+8+16*r)[0],i=BH("I").unpack_from(t,e+12+12+16*r)[0];BH("I").pack_into(l,20+16*r,h);const s=1048576,o=i%s;let a=parseInt((i/s).toString());o>0&&a++,Array.from(Array(a)).forEach((e,i)=>{const r=n+i*s,c=a!=i+1?s:o,u=BH(c+"b").unpack_from(t,r);BH(c+"b").pack_into_with_array(l,h,u),h+=jH(c)})}const d=new File([l],u,{type:"font/ttf"});s.push(d)}return s}(e),t="ttf");const i=[];for(let r of n){const e=URL.createObjectURL(r),n=await zp.load(e);if(URL.revokeObjectURL(e),!n)throw new Error("Could not parse font.");const s=await r.arrayBuffer(),o=await To(s),a=n.getEnglishName("preferredFamily")||n.getEnglishName("fontFamily")||r.name,l=n.getEnglishName("preferredSubfamily")||n.getEnglishName("fontSubfamily")||"default",c=`${a} (${l})`;i.push({file:r,family:a,variant:l,label:c,hash:o,fileExtension:t})}return i}const UH=async e=>{const t=zH(e),n=Object.keys(t);if(n.length<1)return void jT.showBasic({type:"error",message:"Cant import files of this type.",nextStep:"Cuttle can import SVGs, images, and fonts."});if(n.length>1)return void jT.showBasic({type:"error",message:"Cant import mixed file types.",nextStep:"Try importing files of a single type. (SVGs, images, or fonts)"});const i=n[0],r=t[i];"svg"===i&&$H(r),"image"!==i?"font"!==i||XH(r):Oj.project.focusedDocumentation()?GH(r):KH(r)},zH=e=>{const t={};for(let n of e){const e=WH(n);e&&(t[e]||(t[e]=[]),t[e].push(n))}return t},WH=e=>(e=>"image/svg+xml"===Gl(e))(e)?"svg":Zl(e)?"image":(e=>{const t=Gl(e);return!!t&&Hl.includes(t)})(e)?"font":void 0,GH=e=>{if(Oj.activeDocEditor)for(let t of e)Oj.activeDocEditor.chain().focus().cuttleImageUpload({file:t}).run()},$H=async e=>{for(let t of e)await ZH(t);Oj.checkpointAfterNextEvaluation(),Oe.redraw()},ZH=e=>new Promise((t,n)=>{const i=new FileReader;i.onload=i=>{const r=i.target.result;if(!Oj.loadProjectFromSVG(r)){qH(r,e.name)||n()}t()},i.onerror=e=>{n()},i.readAsText(e)}),qH=(e,t)=>{const n=Oj.project.focusedComponent();if(!n)return jT.showBasic({type:"error",message:"Cant import SVGs into the Read Me.",nextStep:"Try selecting a component on the left hand side first."}),!1;const i=Fr(e,{units:Oj.project.settings.units});if(!i)return jT.showBasic({type:"error",message:"Could not parse this SVG."}),!1;const r=jS(i);if(!r)return jT.showBasic({type:"error",message:"Could not find any geometry in this SVG."}),!1;const s=Oj.project,o=s.bakeGeometry(r);if(!o)return!1;t&&s.renameElement(o,JH(t));const a=s.spliceNodes([],[o],s.topNode());s.selectNodes(a);const l=r.boundingBox(),c=Oj.viewportManager.viewportForComponent(n),h=c.worldBoundingBox(Oj.canvasDimensions);return l&&!h.containsBoundingBox(l)&&c.scaleToFitBoundingBox(h.expandToIncludeBoundingBox(l),Oj.canvasDimensions),!0},KH=async(e,t)=>{if(!BT("images"))throw new Error("Images feature not available.");for(let n of e)jT.showBasic({type:"info",message:["Uploading image ",Oe("strong",n.name),"."]}),await YH(n,t);jT.showBasic({type:"info",message:[`Uploaded ${e.length} ${1===e.length?"image":"images"}: `,$T(e.map(e=>e.name)),"."]}),Oj.checkpointAfterNextEvaluation(),Oe.redraw()},YH=async(e,t=e.name)=>{const n=await MH(e),{project:i}=Oj,r=i.createElementWithDefinition(Bx);r.base.args.image=new _b(Rb(n)),r.transform=new wx(lx);const s=Jr("px",i.settings.units);r.transform.args.scale=new _b(Db(s)),t&&i.renameElement(r,JH(t));const o=i.spliceNodes([],[r],i.topNode());i.selectNodes(o)};async function XH(e){try{const t=[];for(let i of e){const e=await HH(i);if(!e.length)throw new Error("Font info not found.");t.push(e)}const n=t.flat();for(let e of n)jT.showBasic({type:"info",message:["Uploading font ",Oe("strong",e.label),"."]}),await Oj.storage.addFontForLoggedInUser(e);if(!n.length)throw new Error("Font import failed.");{const e=n.map(e=>e.label);jT.showBasic({type:"info",message:[`Uploaded ${e.length} ${1===e.length?"font":"fonts"}: `,$T(e),"."]}),ef.resetErrors(),await aL.refreshCustomFonts()}return n}catch(t){throw jT.showBasic({type:"error",message:"Error reading this font file.",nextStep:"Try uploading another version of the font, for example TTF, OTF, or WOFF."}),Ao("font import error",{names:e.map(e=>e.name),error:String(t)}),t}}const JH=e=>{const t=e.lastIndexOf(".");return t>0?e.substring(0,t):e},QH=(e,t)=>{const{project:n}=Oj,i=e.allNodes().topNodes().mutables().sortInDocumentOrder().toNodes(),r=n.createElementWithDefinition(t);r.children=i.map(e=>e.source);const{insertionParent:s,insertionIndex:o}=n.insertionPoint(),[a]=n.spliceNodes(i,[r],s,o);return n.selectNode(a),n.expandNode(a),a},eU=e=>QH(Oj.project.selection,e),tU=()=>{const e=Oj.project.createModifier(),t=nU(e);t&&(Oj.project.setEditingCode(t,!0),Oj.autoSelectForRename=e)},nU=e=>{const{project:t}=Oj;if(t.selection.isSingle()&&t.selection.allInstances().isSingle()){const{node:n,instance:i}=t.selection.items[0],r=n.source.modifiers.indexOf(i),s=new wx(e);return n.source.modifiers.splice(r+1,0,s),t.selectItem(new sS(n,s)),s}const n=t.selection.allNodes().sortInDocumentOrder();if(n.isEmpty())return;if(n.isSingle()){let{node:i}=n.items[0];i.isAnchor()&&!t.isNodeExpanded(i.parent)&&(i=i.parent);const r=new wx(e);return i.source.modifiers.push(r),t.selectItem(new sS(i,r)),r}const i=QH(n,px),r=new wx(e);return i.source.modifiers.push(r),t.selectItem(new sS(i,r)),r},iU=e=>()=>nU(e),rU=()=>{const e=new gC(Oj.project).unusedModifiers();for(const n of e)Oj.project.removeModifier(n);const t="Removed unused modifiers: "+e.map(e=>e.name).join(", ");jT.showBasic({type:"info",message:t,nextStep:"You can undo if this isn't what you expected."})},sU=e=>{var t,n,i;const{project:r}=Oj,s=r.selection.allNodes().mutables().sortInDocumentOrder().toNodes(),o=[];for(let a of s)if(a.hasDefinition(e)){const e=a.parent,s=a.indexInParent(),l=r.reparentNodes(a.childNodes(),e,s);for(let r of l){const e=r.source;e.base.definition!==mx||(null==(t=e.fill)?void 0:t.isEnabled)||(null==(n=e.stroke)?void 0:n.isEnabled)||((null==(i=a.source.stroke)?void 0:i.isEnabled)?e.stroke=a.source.stroke.clone():e.stroke=new wx(dx))}l&&o.push(l),r.spliceNodes([a])}else o.push([a]);o.length>0&&r.selectNodes(o.flat())};const oU=new class{constructor(){this.lastCopyTimeMillis=0}reportCopy(){this.lastCopyTimeMillis=Date.now()}reportPaste(){this.lastCopyTimeMillis=0}reportLeave(){this.lastCopyTimeMillis>0&&Date.now()-this.lastCopyTimeMillis<1e4&&(Ao("external paste"),this.lastCopyTimeMillis=0)}};document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&oU.reportLeave()}),window.addEventListener("blur",()=>{oU.reportLeave()});const aU="cuttleClipboard",lU=e=>{const{selection:t}=Oj.project;if(t.isEmpty())return void jT.showBasic({type:"warning",message:"Nothing to copy.",nextStep:"Try selecting something before copying."});const n=t=>{var n;e?null==(n=e.clipboardData)||n.setData("text/plain",t):po(t),cU(t),oU.reportCopy()};if(t.isSingle()){const e=t.items[0];if(e instanceof oS||e instanceof aS)return n(e.expression().latestCode()),t}const i=Oj.project.selectionPortableProjectData();try{return n(iA(i)),t}catch(r){r instanceof rr&&XT()}},cU=e=>{if(localStorage)try{localStorage.setItem(aU,e)}catch(t){console.error("Couldn't set Local Storage clipboard. Storage full.")}},hU=()=>{const e=window.getSelection();if(e){const t=""===e.toString();if("Range"===e.type&&!t)return!0}return!1},uU=e=>{const t=ES.fromSVGString(e);if(!t)return!1;const n=t.toPortableProjectData();if(!n)return!1;const i=oA(Oj.project,n);return!i||(i instanceof hS||Oj.project.focusItem(i),JT("Pasted",i),!0)},dU=e=>{if(!Oj.project.focusedComponent())return;if(io())return;if(hU())return;if(Oj.project.selection.isEmpty())return void jT.showBasic({type:"warning",message:"Nothing to cut.",nextStep:"Try selecting something before cutting."});lU(e)&&(JT("Cut",Oj.project.selection),Oj.deleteSelection()),e.preventDefault(),Oe.redraw()},pU=e=>{Oj.project.focusedComponent()&&(io()||hU()||(lU(e),JT("Copied",Oj.project.selection),e.preventDefault(),Oe.redraw()))},fU=e=>{const{clipboardData:t}=e;if(!t)return;oU.reportPaste();const n=t.getData("text/plain");if(n){if(uU(n))return e.preventDefault(),void Oe.redraw();if(n.startsWith("<svg")||n.startsWith("<?xml"))return qH(n,"Pasted Graphic")&&jT.showBasic({type:"info",message:"Pasted SVG"}),e.preventDefault(),void Oe.redraw()}if(Oj.project.focus instanceof CC&&t.items.length>0){const e=ls(Array.from(t.items).map(e=>e.getAsFile())).filter(e=>Zl(e));e.length>0&&KH(e,"Pasted Image")}};const mU=new class{constructor(){this.projectCardsByProjectId={},this.projectsToFetch=new Set,this.willFetchNextFrame=!1}rememberProjectCard(e){this.projectCardsByProjectId[e.projectId]=e}rememberProjectCards(e){for(let t of e)this.rememberProjectCard(t)}fetchProjectNextFrame(e){this.projectCardsByProjectId[e]="loading",this.projectsToFetch.add(e),this.willFetchNextFrame||(this.willFetchNextFrame=!0,requestAnimationFrame(()=>{this.fetchQueuedProjects(),this.willFetchNextFrame=!1}))}async fetchQueuedProjects(){const e=Array.from(this.projectsToFetch);this.projectsToFetch.clear();const{projectCards:t}=await Os("getProjectCardsByProjectIds",{projectIds:e});this.rememberProjectCards(t)}getProject(e){return this.projectCardsByProjectId[e]||this.fetchProjectNextFrame(e),this.projectCardsByProjectId[e]}};const gU=new class{constructor(){this.hasLoadedFavorites=!1,this.favoriteProjectIds=[]}async refresh(){if(va.loggedInUser){const{projects:e}=await Os("getFavoriteProjects",{});mU.rememberProjectCards(e),this.favoriteProjectIds=e.map(e=>e.projectId)}else this.favoriteProjectIds=[];this.hasLoadedFavorites=!0,Oe.redraw()}isFavorite(e){return this.favoriteProjectIds.includes(e)}async toggleFavorite(e){this.isFavorite(e)?(this.favoriteProjectIds=this.favoriteProjectIds.filter(t=>t!==e),await Os("removeFavorite",{projectId:e})):(this.favoriteProjectIds.unshift(e),await Os("addFavorite",{projectId:e})),await this.refresh()}};va.subscribe(()=>{gU.refresh()});const vU={view({attrs:{projectId:e}}){const t=gU.isFavorite(e);return Oe(".favorite-star-button",{onclick:t=>{t.preventDefault(),gU.toggleFavorite(e)}},[Oe(Jo,{icon:t?"star_on":"star_off"}),Oe(Jo,{icon:t?"star_on_hover":"star_off_hover"})])}},yU={view({attrs:{icon:e},children:t}){const n=bU(e);return Oe(wU.IconMessage+wU[n],[Oe(wU.Icon,{"aria-label":n},Oe(Jo,{icon:e})),Oe(wU.Message,t)])}},bU=e=>"error"===e?"Error":"warning"===e?"Warning":"Info",wU=qL.classes({IconMessage:{padding:"8px 16px 8px 8px",borderRadius:4,display:"flex",alignItems:"start",gap:8,font:qL.font.defaultFont14},Icon:{width:20,height:20,flexShrink:0},Message:{userSelect:"text",whiteSpace:"pre-line",wordBreak:"break-word",cursor:"text"},Info:{backgroundColor:qL.color.green85},Error:{backgroundColor:qL.color.red85},Warning:{backgroundColor:qL.color.yellow88}}),xU=bF.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,aR(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.setNode(this.name,e),toggleHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>gF({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),CU=LR.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new n_({key:new s_("placeholder"),props:{decorations:({doc:e,selection:t})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=t,r=[];if(!n)return null;const s=this.editor.isEmpty;return e.descendants((e,t)=>{const n=i>=t&&i<=t+e.nodeSize,o=!e.isLeaf&&eF(e);if((n||!this.options.showOnlyCurrent)&&o){const i=[this.options.emptyNodeClass];s&&i.push(this.options.emptyEditorClass);const o=jN.node(t,t+e.nodeSize,{class:i.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:n}):this.options.placeholder});r.push(o)}return this.options.includeChildren}),zN.create(e,r)}}})]}}),SU=bF.create({name:"doc",topNode:!0,content:"heading",marks:""}),kU=e=>{let t,n=e;return{view:e=>(n=e,Oe(".doc-editor-title")),oncreate(e){const i=uo(e),{value:r,editable:s}=e.attrs,o=[SU,xU,ZF];s&&o.push(CU.configure({placeholder:"Project name"}),zF),t=new pF({element:i,editable:s,extensions:o,content:{type:"doc",content:[{type:"heading",attrs:{level:1},content:r?[{type:"text",text:r}]:void 0}]},editorProps:{handleKeyDown:(e,t)=>!(!s||"Enter"!==t.key)&&(n.attrs.onchange(i.textContent||""),!0)},onBlur(){s&&n.attrs.onchange(i.textContent||"")}})},onremove(){t&&t.destroy()}}},LU={view({attrs:{changedParameters:e,onClose:t}}){const n=()=>{ia.close()},i=[],r=[];e.forEach(e=>{e.interface instanceof cw?i.push(e):r.push(e)});const s=i.length>0,o=r.length>0;return Oe(".modal-box.save-confirm-modal",[o&&[Oe("p","Youve changed parameters while in packaged view."),AU(r)],s&&[Oe("p","Note: changes to image parameters will be automatically cleared."),AU(i)],Oe(".save-confirm-modal-actions",[Oe("button.secondary",{onclick:n},"Cancel"),Oe("button.secondary",{className:eo({"full-width":!o}),onclick:()=>{Oj.enterEditingMode(),n(),null==t||t()}},"Clear changes"),o&&Oe("button",{onclick:()=>{TU(e),Oj.project.setParameterDefaults(),Oj.enterEditingMode(),n(),null==t||t()}},"Keep changes")])])}},EU=e=>new Promise(t=>{const n=PU().filter(e=>e.isOverridden());if(Oj.storage.hasWritePermission()){if(n.length>0)return void ia.open({modalView:()=>Oe(LU,{changedParameters:n,onClose:t})})}else TU(n),Oj.project.setParameterDefaults();Oj.enterEditingMode(e),t()}),PU=()=>[...Oj.project.allParameters(),...Oj.project.components.flatMap(e=>e.allParameters())],TU=e=>{e.forEach(e=>{e.interface instanceof cw&&(e.revertToDefault(),e.clearDefault())})},AU=e=>Oe("ul",[e.slice(0,8).map(e=>Oe("li",e.name)),e.length>8&&`and ${e.length-8} more`]),MU={view({attrs:{editable:e}}){const t=Oj.storage.getProjectName(),n=Oj.storage.getProjectId();return Oe(".doc-editor-meta",[Oe(kU,{value:t,editable:e,onchange:e=>{Oj.storage.setProjectName(e)}}),!Na.isMinisite()&&[Oe(".doc-editor-meta-top",[Oe(FU),Oj.isEditingMode()?[Oe(IU)]:[Oe(OU),Oe(RU),Oe(vU,{projectId:n}),Oe(_U)]]),Oe(VU),Oe(UU),Oe(WU),Oe(GU)],Oe(KU)])}},IU={view:()=>Oe("button.secondary.doc-editor-meta-edit-toggle",{onclick:()=>Oj.enterViewingMode()},[Oe(Jo,{icon:"visible"}),"Preview Read Me"])},_U={view(e){const t=[];if(Oj.project.documentation.hasEmbeddedComponent()&&t.push({label:DU(),icon:()=>Oe(Jo,{icon:"edit"}),action:NU}),Oj.storage.hasWritePermission()&&(t.push({type:"separator"}),t.push({label:"Edit Read Me",icon:()=>Oe(Jo,{icon:"doc"}),action:async()=>{await EU(Oj.project.documentation)}})),t.length<1)return;return Oe(ea,{onclick:()=>{Wo({menuItems:t,spawnFrom:uo(e),placement:"bottom-start"})},icon:"dotdotdot"})}},OU={view(){if(!Oj.project.documentation.hasEmbeddedComponent())return;return Oe("button",{onclick:()=>{const e=document.querySelector("[data-cuttle-component-id]");e&&e.scrollIntoView({behavior:"smooth",block:"start"})}},"Customize this template")}},NU=async()=>{(()=>{const e=Oj.business.canEdit();if(!1===e.hasAccess){if("no-minisite"===e.reason)return!1;if("no-pro"===e.reason)return fT(e.feature,!0),!1}return!0===e.hasAccess})()&&await EU(Oj.project.exportComponent())},DU=()=>["Open In Cuttle Editor",Oj.storage.isProTemplate()&&Oe(tT,{hasAccess:Oj.business.hasProFeature("templates")})],RU={view(){if(!Oj.project.documentation.hasEmbeddedComponent())return Oe("button",{onclick:NU},DU())}},FU={view(){const e=Oj.storage.getProjectOwner(),t=Oj.storage.getProjectOwnerDisplayName(),n=Oj.storage.getProjectOwnerAvatar(),i=Oj.isEditingMode();return Oe(".doc-editor-by",Oe(BU,{username:e,displayName:t,openLinksInNewTab:i},[Oe(ya,{avatarUrl:n,username:e,size:32})]))}},BU={view:({children:e,attrs:{username:t,displayName:n,openLinksInNewTab:i}})=>Oe("a",{href:"/@"+t,target:i?"_blank":void 0},[e,n||"@"+t])},VU={view(){const e=Oj.storage.getProjectForkedFrom();if(e)return Oe(".doc-editor-forked.doc-editor-meta-flex",[Oe(zU,{icon:"fork"},Oe("span",["Remix of ",Oe("a",{href:hr+Co(e),target:"_blank"},e.name)," by ",Oe(BU,{username:e.owner,displayName:e.ownerDisplayName??void 0})])),Oe(jU)])}},jU={view(){const e=Oj.storage.getProjectForkedFrom();if(!e)return;const t=Oj.storage.getProjectCreationDate(),n=e.publishedDate;if(!t||!n)return;const i=new Date(t),r=new Date(n);if(!(i<r))return;const s=hr+Co(e);return Oe(yU,{icon:"warning"},["This project was copied from the ",Oe("a",{href:s,target:"_blank"},e.name),` template on ${Eo(i)}. That template was updated on ${Eo(r)}. If you are having issues, please try the `,Oe("a",{href:s,target:"_blank"},"official (updated) version"),"."])}},HU={public:{icon:"share_public",label:"Public",tooltip:"Anyone can view this project and it will be listed on your public profile page"},unlisted:{icon:"share_unlisted",label:"Unlisted",tooltip:"Anyone with the link can view this project"},private:{icon:"share_private",label:"Private",tooltip:"Only you can view this project"}},UU={view(){const e=Oj.storage.getPublishedSnapshotId()===Oj.storage.getCurrentSnapshotId(),t=Oj.storage.hasWritePermission(),n=Oj.storage.getShareStatus(),i=HU[n],r=[];r.push(Oe(zU,i,i.label));const s=Oj.storage.getProjectPublishedDate();if(s){let e=Po(s);const t=Oj.storage.getProjectFirstMadePublicDate();if(t){const n=Po(t);n!==e&&(e=`${n} (updated ${e})`)}r.push(Oe(zU,{icon:"published"},e))}if("private"!==n&&t&&!e&&r.push(Oe(zU,{icon:"check",tooltip:"Changes have been made since the project was published",className:"is-behind"},"Unpublished Changes")),0!==r.length)return Oe(".doc-editor-status.doc-editor-meta-flex",r)}},zU={view({attrs:{icon:e,tooltip:t,className:n},children:i}){const r=Oe(".doc-editor-icon-status",{className:n},[Oe(Jo,{icon:e}),i]);return t?Oe(Zo,{message:()=>t,placement:"top-start"},r):r}},WU={view(){const e=Oj.storage.isOfficialCuttleTemplate(),t=Oj.storage.isProTemplate();if(!(e||t))return;let n;if(t||e){return n=Oj.business.canDownload().hasAccess?[Oe("p","Your Cuttle Pro membership grants you a commercial license to sell physical items derived from this template.")]:Oe("p",t?["To make or sell physical items ",Oe(ZU),"."]:["Free for personal use. To sell physical items ",Oe(ZU),"."]),Oe(".doc-editor-license",[Oe(".license-header",[Oe(".license-title","LICENSE"),Oe($U,{href:"/learn/licensing",openNewTab:!0},"Learn more")]),Oe(".license-description",n),Oe(qU,{bullets:[{type:t?"pro":"allowed",text:"Create physical items for personal use."},{type:"pro",text:"Sell physical items derived from this template."},{type:"restricted",text:["Sell or give away digital items (like SVGs) derived from this template. We sometimes allow this on a case-by-case basis. ",Oe($U,{href:"/learn/licensing",openNewTab:!0},"Learn more"),"."]}]})])}}},GU={view(){const e=Oj.isEditingMode();if(!e)return;const t=Oj.storage.hasWritePermission(),n=Oj.storage.getCreditId()===Oj.storage.getProjectId(),i=Oj.business.canLicensePro(),r=Oj.business.canLicenseMinisite();if(!(e&&t&&n&&(i||r)))return;const s=Oj.storage.getProjectLicense(),o=["none"];return i&&o.push("pro"),r&&o.push("minisite paid"),Oe(".doc-editor-license-edit.doc-editor-meta-flex",[Oe(zU,{icon:"license"},[Oe("label","License"),Oe(eH,{selected:s||"none",options:o,onchange:e=>{let t="none"===e?null:e;Oj.storage.setProjectLicense(t)}})])])}},$U={view:({attrs:{href:e,onclick:t,openNewTab:n},children:i})=>Oe(n?"a[target=_blank]":Oe.route.Link,{href:e,onclick:t},i)},ZU={view:()=>Oe($U,{href:"/pricing",onclick:()=>Ao("license upgrade"),openNewTab:!0},"upgrade to Cuttle Pro")},qU={view({attrs:{bullets:e}}){const t=e=>"allowed"===e?Oe(Jo,{icon:"license_allowed"}):"pro"===e?Oe(tT,{hasAccess:Oj.business.hasProFeature("templates")}):Oe(Jo,{icon:"license_restricted"});return Oe(".license-bullets",e.map(({type:e,text:n})=>[Oe(".license-bullet-icon",t(e)),Oe(".license-bullet-text",n)]))}},KU={view(){if(!Oj.storage.hasWritePermission())return;if("private"===Oj.storage.getShareStatus())return;const e=Oj.project.usesProFont(),t=Oj.storage.isProTemplate()||"minisite paid"===Oj.storage.getProjectLicense(),n=e&&!t;return n?Oe(".project-audit.doc-editor-meta-flex",[n&&Oe(yU,{icon:"warning"},"This project uses Pro fonts. Other Cuttle users will only be able to download it if they are members of Cuttle Pro.")]):void 0}},YU={view:({attrs:{minWidthPixels:e}})=>{if(Oj.storage.sequenceToLoad())return;if(!Oj.project.focusedComponent())return;let t,n;return Oj.storage.hasWritePermission()?n=Oe(".top-menu-project-name",[Oe(MV,{value:Oj.storage.getProjectName(),singleClick:!0,onchange:e=>Oj.storage.setProjectName(e)})]):(t=Oe(BU,{username:Oj.storage.getProjectOwner(),displayName:Oj.storage.getProjectOwnerDisplayName()}),n=Oe(".top-menu-project-name",[Oj.storage.getProjectName()])),Oe(".top-menu-project",{style:{"min-width":e+"px"}},Oe(".top-menu-project-title",[t,t&&Oe(".top-menu-project-divider","/"),n]))}},XU=()=>{let e=!1,t=!1;return{view:()=>{const n=Oj.storage.getShareStatus(),i=Oj.storage.getPublishedSnapshotId(),r=Oj.storage.getCurrentSnapshotId(),s=async()=>{e=!0;const t=await Oj.saveVersion(),n=Oj.project.documentation.firstParagraphText();await Oj.storage.setPublishedSnapshot(t,n),e=!1,Oe.redraw()},o=async t=>{e=!0,Oj.storage.setShareStatus(t),"private"===t?await Oj.storage.setPublishedSnapshot():Oj.storage.getPublishedSnapshotId()||await s(),e=!1,Oe.redraw()};let a=Oe(JU.CopyLink,{onclick:()=>{const e=Oj.storage.getProjectUrl();po(e),t=!0}},[Oe(Jo,{icon:t?"check":"copy_link"}),"Copy Link"]);const l=Oj.project.allCustomFonts(),c=l.length>0,h=c;let u,d;if(u=e?Oe(".loading-indicator"):i?i!==r?[Oe(JU.PublishedDescription,[Oe("p","The published version is different than the current version. External viewers will see the published version.")]),Oe("button",{onclick:s,disabled:h&&"public"===n},"Publish this version")]:[Oe(JU.PublishedDescription,[Oe("p","The current version is published. If you modify the current version, external viewers will continue to see the published version.")])]:null,c){const e=l.map(e=>{var t;return(null==(t=aL.familyAndVariantByValue(e))?void 0:t.fontFamily.family)||"Unknown"});d=Oe(yU,{icon:"warning"},["This project uses My Fonts. Other users will not be able to use these fonts. If you want to make this project public, replace uses of ",VT(e),"."])}return Oe(JU.ShareMenu,[Oe(JU.Options,[Oe(JU.Option,[Oe("input[type=radio][name=cuttle-share-menu][id=cuttle-share-menu-private]",{checked:"private"===n,onchange:()=>o("private")}),Oe("label.cuttle-share-menu-label[for=cuttle-share-menu-private]",[Oe(JU.LabelTitle,"Private"),Oe(JU.LabelDescription,"Only you can view this project")])]),Oe(JU.Option,[Oe("input[type=radio][name=cuttle-share-menu][id=cuttle-share-menu-unlisted]",{checked:"unlisted"===n,onchange:()=>o("unlisted")}),Oe("label.cuttle-share-menu-label[for=cuttle-share-menu-unlisted]",[Oe(JU.LabelTitle,"Unlisted"),Oe(JU.LabelDescription,"Anyone with the link can view this project")])]),Oe(JU.Option,{className:eo({disabled:h})},[Oe("input[type=radio][name=cuttle-share-menu][id=cuttle-share-menu-public]",{checked:"public"===n,onchange:()=>o("public"),disabled:h}),Oe("label.cuttle-share-menu-label[for=cuttle-share-menu-public]",[Oe(JU.LabelTitle,"Public"),Oe(JU.LabelDescription,"Anyone can view this project and it will be listed on your public profile page")])])]),d,u,"private"!==n?a:null])}}},JU=qL.classes({ShareMenu:{maxWidth:340,padding:"8px 16px",display:"flex",flexDirection:"column",gap:"16px",alignItems:"start"},Options:{display:"flex",flexDirection:"column",gap:"4px"},Option:{display:"flex",alignItems:"start","& input":{marginTop:5,marginRight:8},"&.disabled":{opacity:.5}},LabelTitle:{fontSize:"14px",lineHeight:"24px"},LabelDescription:{color:qL.color.blackAlpha60,fontSize:"12px",lineHeight:"16px"},PublishedDescription:{"& p":{font:qL.font.defaultFont14,margin:0}},CopyLink:{display:"flex",alignItems:"center",gap:4,cursor:"pointer",color:qL.color.blue63,"& .icon20 svg path":{fill:qL.color.blue63},"&:hover":{color:qL.color.blue53,"& svg path":{fill:qL.color.blue53}}}});var QU,ez={exports:{}};var tz=(QU||(QU=1,function(e){function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}
/**
       *  @preserve  JavaScript implementation of
       *  Algorithm for Automatically Fitting Digitized Curves
       *  by Philip J. Schneider
       *  "Graphics Gems", Academic Press, 1990
       *
       *  The MIT License (MIT)
       *
       *  https://github.com/soswow/fit-curves
       */function n(e,t,n){if(!Array.isArray(e))throw new TypeError("First argument should be an array");if(e.forEach(function(t){if(!Array.isArray(t)||t.some(function(e){return"number"!=typeof e})||t.length!==e[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),e=e.filter(function(t,n){return 0===n||!t.every(function(t,i){return t===e[n-1][i]})}),e.length<2)return[];var r=e.length,s=d(e[1],e[0]),o=d(e[r-2],e[r-1]);return i(e,s,o,t,n)}function i(e,t,n,s,a){var c,h,u,d,f,m,g,v,y,b,w,x,C,S=20;if(2===e.length)return x=p.vectorLen(p.subtract(e[0],e[1]))/3,[c=[e[0],p.addArrays(e[0],p.mulItems(t,x)),p.addArrays(e[1],p.mulItems(n,x)),e[1]]];var k=r(e,h=l(e),h,t,n,a);if(c=k[0],d=k[1],m=k[2],0===d||d<s)return[c];if(d<s*s)for(u=h,f=d,g=m,C=0;C<S;C++){var L=r(e,h,u=o(c,e,u),t,n,a);if(c=L[0],d=L[1],m=L[2],d<s)return[c];if(m===g){var E=d/f;if(E>.9999&&E<1.0001)break}f=d,g=m}if(w=[],(v=p.subtract(e[m-1],e[m+1])).every(function(e){return 0===e})){var P=[-(v=p.subtract(e[m-1],e[m]))[1],v[0]];v[0]=P[0],v[1]=P[1]}return y=p.normalize(v),b=p.mulItems(y,-1),w=(w=w.concat(i(e.slice(0,m+1),t,y,s,a))).concat(i(e.slice(m),b,n,s,a))}function r(e,t,n,i,r,o){var a,l,h,u=c(e,a=s(e,n,i,r),t);return l=u[0],h=u[1],o&&o({bez:a,points:e,params:t,maxErr:l,maxPoint:h}),[a,l,h]}function s(e,t,n,i){var r,s,o,a,l,c,h,u,d,m,g,v,y,b,w,x,C,S=e[0],k=e[e.length-1];for(r=[S,null,null,k],s=p.zeros_Xx2x2(t.length),y=0,b=t.length;y<b;y++)C=1-(x=t[y]),(o=s[y])[0]=p.mulItems(n,3*x*(C*C)),o[1]=p.mulItems(i,3*C*(x*x));for(a=[[0,0],[0,0]],l=[0,0],y=0,b=e.length;y<b;y++)x=t[y],o=s[y],a[0][0]+=p.dot(o[0],o[0]),a[0][1]+=p.dot(o[0],o[1]),a[1][0]+=p.dot(o[0],o[1]),a[1][1]+=p.dot(o[1],o[1]),w=p.subtract(e[y],f.q([S,S,k,k],x)),l[0]+=p.dot(o[0],w),l[1]+=p.dot(o[1],w);return c=a[0][0]*a[1][1]-a[1][0]*a[0][1],h=a[0][0]*l[1]-a[1][0]*l[0],u=l[0]*a[1][1]-l[1]*a[0][1],m=0===c?0:h/c,(d=0===c?0:u/c)<(g=1e-6*(v=p.vectorLen(p.subtract(S,k))))||m<g?(r[1]=p.addArrays(S,p.mulItems(n,v/3)),r[2]=p.addArrays(k,p.mulItems(i,v/3))):(r[1]=p.addArrays(S,p.mulItems(n,d)),r[2]=p.addArrays(k,p.mulItems(i,m))),r}function o(e,t,n){return n.map(function(n,i){return a(e,t[i],n)})}function a(e,t,n){var i=p.subtract(f.q(e,n),t),r=f.qprime(e,n),s=p.mulMatrix(i,r),o=p.sum(p.squareItems(r))+2*p.mulMatrix(i,f.qprimeprime(e,n));return 0===o?n:n-s/o}function l(e){var t,n,i,r=[];return e.forEach(function(e,s){t=s?n+p.vectorLen(p.subtract(e,i)):0,r.push(t),n=t,i=e}),r=r.map(function(e){return e/n})}function c(e,t,n){var i,r,s,o,a,l,c,d;r=0,s=Math.floor(e.length/2);var m=h(t,10);for(a=0,l=e.length;a<l;a++)c=e[a],d=u(t,n[a],m,10),(i=(o=p.subtract(f.q(t,d),c))[0]*o[0]+o[1]*o[1])>r&&(r=i,s=a);return[r,s]}var h=function(e,t){for(var n,i=[0],r=e[0],s=0,o=1;o<=t;o++)n=f.q(e,o/t),s+=p.vectorLen(p.subtract(n,r)),i.push(s),r=n;return i=i.map(function(e){return e/s})};function u(e,t,n,i){if(t<0)return 0;if(t>1)return 1;for(var r,s,o,a,l=1;l<=i;l++)if(t<=n[l]){o=(l-1)/i,s=l/i,a=(t-(r=n[l-1]))/(n[l]-r)*(s-o)+o;break}return a}function d(e,t){return p.normalize(p.subtract(e,t))}var p=function(){function e(){t(this,e)}return e.zeros_Xx2x2=function(e){for(var t=[];e--;)t.push([0,0]);return t},e.mulItems=function(e,t){return e.map(function(e){return e*t})},e.mulMatrix=function(e,t){return e.reduce(function(e,n,i){return e+n*t[i]},0)},e.subtract=function(e,t){return e.map(function(e,n){return e-t[n]})},e.addArrays=function(e,t){return e.map(function(e,n){return e+t[n]})},e.addItems=function(e,t){return e.map(function(e){return e+t})},e.sum=function(e){return e.reduce(function(e,t){return e+t})},e.dot=function(t,n){return e.mulMatrix(t,n)},e.vectorLen=function(e){return Math.hypot.apply(Math,e)},e.divItems=function(e,t){return e.map(function(e){return e/t})},e.squareItems=function(e){return e.map(function(e){return e*e})},e.normalize=function(e){return this.divItems(e,this.vectorLen(e))},e}(),f=function(){function e(){t(this,e)}return e.q=function(e,t){var n=1-t,i=p.mulItems(e[0],n*n*n),r=p.mulItems(e[1],3*n*n*t),s=p.mulItems(e[2],3*n*t*t),o=p.mulItems(e[3],t*t*t);return p.addArrays(p.addArrays(i,r),p.addArrays(s,o))},e.qprime=function(e,t){var n=1-t,i=p.mulItems(p.subtract(e[1],e[0]),3*n*n),r=p.mulItems(p.subtract(e[2],e[1]),6*n*t),s=p.mulItems(p.subtract(e[3],e[2]),3*t*t);return p.addArrays(p.addArrays(i,r),s)},e.qprimeprime=function(e,t){return p.addArrays(p.mulItems(p.addArrays(p.subtract(e[2],p.mulItems(e[1],2)),e[0]),6*(1-t)),p.mulItems(p.addArrays(p.subtract(e[3],p.mulItems(e[2],2)),e[1]),6*t))},e}();e.exports=n,e.exports.fitCubic=i,e.exports.createTangent=d}(ez)),ez.exports);const nz=D(tz),iz=[0,1,2,3],rz=[new It(0,-1),new It(1,0),new It(0,1),new It(-1,0)],sz=1048576,oz=(e,t=.5,n=!1)=>{if(!(e.fill instanceof Hi))return;const i=ql.getImageFromURL(e.fill.image);if(!i)return;const r=e.fill.transform.clone().translate(new It(-.5));let s=i.width,o=i.height;if(s*o>sz){const e=s/o;o=Math.max(1,Math.floor(Math.sqrt(sz/e))),s=Math.max(1,Math.floor(o*e)),r.scale(new It(i.width/s,i.height/o)),console.warn(`Resizing image from ${i.width}x${i.height} to ${s}x${o}.`)}const a=Rr(i._image,s,o);if(!a)return;const l=pz(a.data);let{background:c,foreground:h,grayscale:u}=lz(l,a.width,a.height);if(!n){if(hz(c,h,l)>.05)throw new az}u=gz(u,0,a.width);const d=((e,t,n,i)=>{const r=(n,i)=>e[i*t+n],s=new Float32Array(t*n),o=new Float32Array(t*n);for(let f=0;f<n-1;f++)for(let e=0;e<t-1;e++){const n=r(e+1,f),a=r(e+1,f+1),l=r(e,f+1);s[f*t+e]=n>i!=a>i?Ct((i-n)/(a-n),.001,.999):-2,o[f*t+e]=l>i!=a>i?Ct((i-l)/(a-l),.001,.999):-2}const a=(e,t,n)=>0===t?new It(e.x+n,e.y):2===t?new It(e.x+n,e.y+1):new It(3===t?e.x:e.x+1,e.y+n),l=(e,n)=>{if(0===n){const n=e.x,i=e.y-1;o[i*t+n]-=1}else if(2===n){const n=e.x,i=e.y;o[i*t+n]-=1}else if(3===n){const n=e.x-1,i=e.y;s[i*t+n]-=1}else{const n=e.x,i=e.y;s[i*t+n]-=1}},c=(e,n)=>{if(0===n){const n=e.x,i=e.y-1;return o[i*t+n]}if(2===n){const n=e.x,i=e.y;return o[i*t+n]}if(3===n){const n=e.x-1,i=e.y;return s[i*t+n]}{const n=e.x,i=e.y;return s[i*t+n]}},h=(e,t)=>{const n=[(t+1)%4,(t+2)%4,(t+3)%4],i=n.map(t=>c(e,t));if(i[0]>0&&i[1]>0&&i[2]>0)if(u(e)){if(3===t)return 0;if(0===t)return 3;if(1===t)return 2;if(2===t)return 1}else{if(3===t)return 2;if(2===t)return 3;if(1===t)return 0;if(0===t)return 1}for(let r=0;r<3;r++)if(i[r]>0)return n[r]},u=e=>{const t=new It(0,0);for(let n of iz){const i=It.add(e,rz[n]),r=(n+2)%4,s=(c(i,r)+1)%1,o=a(i,r,s);let l=!0,h=new It(0,0);const u=[(r+1)%4,(r+2)%4,(r+3)%4];for(let e of u){const t=c(i,e);if(-2===t)l=!1;else{const n=a(i,e,(t+1)%1);h=It.sub(o,n)}}l||(h.normalize(),h.y>0&&h.mulScalar(-1),t.add(h))}return t.x>0},d=(e,t)=>{const n=[];for(;;){const i=c(e,t),r=a(e,t,i);n.push(r),l(e,t);const s=It.add(e,rz[t]),o=h(s,(t+2)%4);if(void 0===o)break;e=s,t=o}return n},p=[];for(let f=0;f<n;f++)for(let e=0;e<t-1;e++){let t=new It(e,f);if(c(t,1)>=0){const e=d(t,1);p.push(e)}}return p})(u,a.width+2,a.height+2,t),p=[];for(let g of d){const e=wz(g,1);let t=Sz(e,2,.2);for(let n of t)e[n]=g[n];0===t.length&&(t=[0]);{const n=Cz(e,t).map(e=>xz(e,.1)),i=Ri.fromFragments(n);p.push(i)}}const f=new wi(p).affineTransform(r).assignFill(new ji(h));let m;return m=wi.booleanIntersect([e,f]).copyStyle(f),m=jS(m),m};class az extends Error{constructor(){super("Looks like this image contains more than 2 colors and may not trace well.")}}const lz=(e,t,n)=>{const i=mz(e,t,n),r=yz(i);r.sort((e,t)=>t.colors.length-e.colors.length);const s=r[0].center.clone();s.a=1;let o,a;if(e.some(e=>e.a<1)){const t=e.filter(e=>1===e.a);o=cz(t.length>0?t:e).clone(),o.a=1,a=e.map(e=>e.a)}else{const t=yz(e);t.sort((e,t)=>vz(t.center,s)-vz(e.center,s)),o=cz(t[0].colors).clone(),o.a=1,a=e.map(e=>dz(e,s,o))}return{background:s,foreground:o,grayscale:a}},cz=e=>{const t=fz(e,32);let n=t[0],i=1/0;for(const r of t){let e=0;for(const n of t)r!==n&&(e+=vz(r,n));e<i&&(n=r,i=e)}return n},hz=(e,t,n)=>{const i=t.r-e.r,r=t.g-e.g,s=t.b-e.b;let o=0;for(const a of n)o+=uz(e.r,e.g,e.b,i,r,s,a.r,a.g,a.b);return o/n.length},uz=(e,t,n,i,r,s,o,a,l)=>{const c=o-e,h=a-t,u=l-n,d=i*i+r*r+s*s;if(0===d)return 0;const p=(c*i+h*r+u*s)/d,f=c-i*p,m=h-r*p,g=u-s*p;return Math.sqrt(f*f+m*m+g*g)},dz=(e,t,n)=>{const i=n.r-t.r,r=n.g-t.g,s=n.b-t.b;return((e.r-t.r)*i+(e.g-t.g)*r+(e.b-t.b)*s)/(i*i+r*r+s*s)},pz=e=>{const t=[];for(let n=0;n<e.length;n+=4)t.push(new Gn(e[n]/255,e[n+1]/255,e[n+2]/255,e[n+3]/255));return t},fz=(e,t)=>{if(e.length<=t)return e;const n=new Array(t);for(let i=0;i<t;++i)n[i]=e[Math.floor(i/t*e.length)];return n},mz=(e,t,n)=>{const i=new Array(2*t+2*n-4);let r=0;for(let s=0;s<t;++s)i[r++]=e[s];for(let s=1;s<n;++s)i[r++]=e[t*s+t-1];for(let s=t-1;--s>=0;)i[r++]=e[t*(n-1)+s];for(let s=n-1;--s>=1;)i[r++]=e[t*s];return i},gz=(e,t,n)=>{const i=e.length,r=n+2,s=new Array(i+2*(i/n)+2*r).fill(t);let o=r,a=0;for(;a<i;){o++;for(let t=0;t<n;++t)s[o++]=e[a++];o++}return s},vz=(e,t)=>{const n=t.r-e.r,i=t.g-e.g,r=t.b-e.b;return n*n+i*i*r*r},yz=e=>{const t=e=>e.r+e.g+e.b,n=e.reduce((e,n)=>t(e)<t(n)?e:n,e[0]),i=e.reduce((e,n)=>t(e)>t(n)?e:n,e[0]),r=[{center:n.clone(),colors:[]},{center:i.clone(),colors:[]}];for(let s=0;s<10;++s){for(const e of r)e.colors=[];for(const t of e){let e=r[0],n=1/0;for(const i of r){const r=vz(t,i.center);r<n&&(e=i,n=r)}e.colors.push(t)}for(const e of r)if(e.center.set(0,0,0,0),e.colors.length>0){for(const t of e.colors)e.center.add(t);e.center.mulScalar(1/e.colors.length)}}return r},bz=(e,t)=>Math.exp(-e*e/(2*t*t))/(Math.sqrt(2*Math.PI)*t),wz=(e,t)=>{const n=2*Math.ceil(3*t)+1,i=Math.floor(n/2);if(i<=0)return e;const r=[];let s=0;for(let a=-i;a<=i;a++){const e=bz(a,t);r.push(e),s+=e}for(let a=0;a<r.length;a++)r[a]/=s;const o=e.map((e,t,n)=>{let s=0,o=0;for(let a=-i;a<=i;a++){const e=r[a+i],l=Et(t+a,n.length);s+=n[l].x*e,o+=n[l].y*e}return new It(s,o)});return o},xz=(e,t,n=!1)=>{const i=e.length;if(i<2)throw"Error: Can't fit a curve to less than 2 points";if(2===i)return Ri.fromPoints(e);const r=e.map(e=>[e.x,e.y]);return((e,t)=>{const n=e=>new It(e[0],e[1]),i=[];i.push(n(e[0][0]));for(const r of e)i.push(n(r[1])),i.push(n(r[2])),i.push(n(r[3]));return Ri.fromCubicBezierPoints(i,t)})(nz(r,t),n)},Cz=(e,t)=>{const n=e.length,i=[],r=t.length;for(let s=0;s<r;s++){const o=t[s];let a=t[(s+1)%r];a<=o&&(a+=n);const l=[];for(let t=o;t<=a;t++){const i=e[t%n];l.push(i)}i.push(l)}return i},Sz=(e,t,n)=>{const i=e.length,r=[];for(let o=0;o<i;o++){const t=e[(o-1+i)%i],n=e[o],s=e[(o+1)%i],a=It.sub(t,n),l=It.sub(s,n),c=It.sub(a,l).length(),h=It.add(a,l).length();r[o]=h/c}const s=[];for(let o=0;o<i;o++){let e=n;for(let n=o-t;n<=o+t;n++)e=Math.max(e,r[(n+i)%i]);r[o]===e&&s.push(o)}return s},kz=(e,t=!1)=>{try{const n=[],i=[];for(const{node:r}of e.items){const e=Oj.traceForNode(r);if(!(null==e?void 0:e.isSuccess()))continue;const s=r.parent;let o=r.indexInParent();const a=e.result.allPathsAndCompoundPaths().find(e=>e.fill instanceof Hi);if(!a)continue;const l=oz(a,void 0,t);if(!l)continue;const c=Oj.project.bakeGeometry(l);if(!c)continue;const h=Oj.project.spliceNodes([],[c],s,++o);n.push(...h),a.fill instanceof Hi&&i.push(a.fill.image)}n.length>0&&(Oj.project.selectNodes(n),jT.show({view:()=>Oe(Ez,{images:i})}))}catch(n){n instanceof az&&ia.open({modalView:()=>Oe(Lz,{selection:e})})}},Lz={view:({attrs:{selection:e}})=>Oe(gL,{primaryAction:{label:"OK",action:()=>{}},cancelAction:{label:"Trace Anyway",action:()=>kz(e,!0)}},[Oe("h3","This image may not trace well "),"Trace Image works best on simple images with two colors, like logos, silhouettes, cartoons, and drawings."])},Ez={view:({attrs:{images:e}})=>Oe(".toast-message",[Oe(".message","How did your image trace come out?"),Oe(".toast-actions",[Oe("button.secondary",{onclick:()=>jT.dismiss()}," Great"),Oe("button.secondary",{onclick:()=>{jT.show({view:()=>Oe(Pz,{images:e})})}}," Not so great")])])},Pz={view:({attrs:{images:e}})=>Oe(".toast-message",[Oe(".message","Okay to share this image with Cuttle developers so we can improve Image Trace?"),Oe(".toast-actions",[Oe("button.secondary",{onclick:()=>{Ao("trace image survey",{images:e}),jT.dismiss()}},"Yes!"),Oe("button.secondary",{onclick:()=>jT.dismiss()},"No, dont share this image")])])},Tz=(e,t,n)=>{const i=Boolean(null==n?void 0:n.isBetaFeature);return{label:i?[e,Oe(".feature-tag","BETA")]:e,icon:()=>t.icon&&Oe(Jo,{icon:t.icon}),enabled:Mz,action:()=>{i&&!BT("beta")||nU(t)}}},Az=()=>{"local"===Oj.storage.type?Oj.project=new gS:window.open("/new-project")},Mz=()=>!Oj.project.selection.isEmpty(),Iz=()=>Oj.project.hasFocusedComponent(),_z=e=>Oj.project.selection.directlySelectedNodes().items.some(({node:t})=>t.hasDefinition(e)),Oz=()=>_z(px),Nz={label:"Duplicate",accelerator:new qj("d",{command:!0}),action:()=>Oj.project.duplicateSelection(),enabled:Mz},Dz={label:"Group",accelerator:new qj("g",{command:!0}),action:(Rz=px,()=>eU(Rz)),enabled:Mz};var Rz;const Fz={label:"Ungroup",accelerator:new qj("g",{command:!0,shift:!0}),action:()=>{sU(px)},enabled:Oz},Bz={label:"Ungroup All",action:()=>{const{project:e}=Oj,t=e.selection.allNodes().mutables().sortInDocumentOrder().toNodes(),n=[];for(let i of t)if(i.hasDefinition(px)){const t=[],r=e=>{e.forEach(e=>{e.hasDefinition(px)?r(e.childNodes()):t.push(e)})};r(i.childNodes());const s=e.reparentNodes(t,i.parent,i.indexInParent());s&&n.push(s),e.spliceNodes([i])}else n.push([i]);n.length>0&&e.selectNodes(n.flat())},enabled:Oz},Vz={label:"Split Path at Anchor",action:()=>{const e=Oj.project.selection.directlySelectedNodes().sortInDocumentOrder();for(const t of e.toNodes()){if(!t.isAnchor())continue;if(!Oj.project.nodeExists(t))continue;const e=t.parent;if(!e||!e.isPath())continue;const n=e.source.base.expressionForParameterWithName("closed");if(!(null==n?void 0:n.isLiteral()))continue;if(Boolean(n.literalValue())){e.source.base.args.closed=new _b("false");const n=t.indexInParent();as(e.sourceChildren(),n);const i=t.source.clone(),r=Oj.project.spliceNodes([],[i],e);Oj.project.selectNodes(r)}else{if(!e.parent)continue;const n=t.indexInParent();if(0===n)continue;if(n===e.childCount()-1)continue;const i=Oj.project.duplicateElementWithoutChildren(e.source),[r]=Oj.project.spliceNodes([],[i],e.parent),s=Oj.project.duplicateElement(t.source),o=e.childNodes().slice(n+1);Oj.project.spliceNodes(o,[s,...o.map(e=>e.source)],r),Oj.project.selectNode(r)}}},enabled:()=>{const e=Oj.project.selection.directlySelectedNodes();return e.isSingle()&&e.hasAnchor()}},jz={label:"Reverse Path Direction",action:()=>{for(let e of Oj.project.selection.items)for(let t of e.nodes()){t.source.children.length>1&&t.source.children.reverse();for(let e of t.childNodes())if(e.isAnchor()){const{args:t}=e.source.base,{handleIn:n,handleOut:i}=t;n?t.handleOut=n:delete t.handleOut,i?t.handleIn=i:delete t.handleIn}}},enabled:()=>Oj.project.selection.directlySelectedNodes().items.some(({node:e})=>e.source.children.length>1)},Hz={label:"Create Compound Path",action:()=>{eU(fx).source.stroke=new wx(dx)},enabled:Mz},Uz={label:"Release Compound Path",action:()=>sU(fx),enabled:()=>_z(fx)},zz={label:"Bring to Front",action:()=>{const e=Oj.project,t=e.selection.allNodes().mutables().sortInDocumentOrder();for(let n of t.items){const t=n.node.parent;e.spliceNodes([n.node],[n.node.source],t,t.childCount())}},accelerator:new qj("]",{command:!0,option:!0}),enabled:Mz},Wz={label:"Bring Forward",action:()=>{const e=Oj.project,t=e.selection.allNodes().mutables().sortInDocumentOrder().reverse();for(let n of t.items){const t=n.node.parent;e.spliceNodes([n.node],[n.node.source],t,n.node.indexInParent()+2)}},accelerator:new qj("]",{command:!0}),enabled:Mz},Gz={label:"Send Backward",action:()=>{const e=Oj.project,t=e.selection.allNodes().mutables().sortInDocumentOrder();let n,i;for(let r of t.items){const t=r.node.parent,s=r.node.indexInParent(),o=Math.max(0,s-1);(null==n?void 0:n.equalsNode(t))&&o===i?i=s:(i=o,e.spliceNodes([r.node],[r.node.source],t,o)),n=t}},accelerator:new qj("[",{command:!0}),enabled:Mz},$z={label:"Send to Back",action:()=>{const e=Oj.project,t=e.selection.allNodes().mutables().sortInDocumentOrder().reverse();for(let n of t.items){const t=n.node.parent;e.spliceNodes([n.node],[n.node.source],t,0)}},accelerator:new qj("[",{command:!0,option:!0}),enabled:Mz},Zz=()=>Mz()&&!Oj.project.selection.isScaleLocked(),qz={label:"Flip Horizontal",action:()=>{const e=Oj.project.selection.allNodes().mutables().toNodes();QC(e,new It(1,0))},enabled:Zz},Kz={label:"Flip Vertical",action:()=>{const e=Oj.project.selection.allNodes().mutables().toNodes();QC(e,new It(0,1))},enabled:Zz},Yz={label:"Align Left",action:()=>{const e=Oj.project.selection.allNodes().mutables().toNodes();tS(e,"left")},enabled:Mz},Xz={label:"Align Center",action:()=>{const e=Oj.project.selection.allNodes().mutables().toNodes();tS(e,"center")},enabled:Mz},Jz={label:"Align Right",action:()=>{const e=Oj.project.selection.allNodes().mutables().toNodes();tS(e,"right")},enabled:Mz},Qz={label:"Align Top",action:()=>{const e=Oj.project.selection.allNodes().mutables().toNodes();tS(e,"top")},enabled:Mz},eW={label:"Align Vertical Center",action:()=>{const e=Oj.project.selection.allNodes().mutables().toNodes();tS(e,"middle")},enabled:Mz},tW={label:"Align Bottom",action:()=>{const e=Oj.project.selection.allNodes().mutables().toNodes();tS(e,"bottom")},enabled:Mz},nW={label:"Align Selection",enabled:Mz,submenu:()=>[Yz,Xz,Jz,Qz,eW,tW]},iW={label:"Show Contents In Outline",action:()=>{const e=Oj.project.selection.allNodes().items;for(const t of e)t.node.hasChildNodes()&&Oj.project.expandNode(t.node)},enabled:()=>{const e=Oj.project.selection.allNodes().items;for(const t of e)if(t.node.hasChildNodes())return!0;return!1}},rW={label:"Extract as Component",action:()=>{const e=Oj.project,t=e.selection.allNodes().mutables().sortInDocumentOrder().toNodes();e.extractAsComponent(t)},enabled:Mz},sW={label:"Convert to Paths",action:()=>{const e=Oj.project.selection.allNodes().mutables().sortInDocumentOrder(),t=[];for(const n of e.items){const e=Oj.traceForNode(n.node);if(!(null==e?void 0:e.isSuccess()))continue;const i=jS(e.result.clone());if(!i)continue;const r=Oj.project.bakeGeometry(i);if(!r)continue;const s=n.node.parent,o=n.node.indexInParent(),[a]=Oj.project.spliceNodes([n.node],[r],s,o);t.push(a)}Oj.project.selectNodes(t)},enabled:Mz},oW={label:["Trace Image",Oe(".feature-tag","BETA")],action:()=>{BT("beta")&&(()=>{const e=Oj.project.selection.topNodes().sortInDocumentOrder();kz(e)})()},enabled:()=>{const{selection:e}=Oj.project;return!e.isEmpty()}},aW={label:"Cut",action:()=>{if(Oj.project.selection.isEmpty())return void jT.showBasic({type:"warning",message:"Nothing to cut.",nextStep:"Try selecting something before cutting."});const e=lU();e&&(JT("Cut",e),Oj.deleteSelection(),Oe.redraw())},accelerator:new qj("X",{command:!0,displayOnly:!0}),enabled:Mz},lW={label:"Copy",action:()=>{const e=lU();e&&JT("Copied",e)},accelerator:new qj("C",{command:!0,displayOnly:!0}),enabled:Mz},cW={label:"Paste",action:()=>{var e;if(null==(e=document.queryCommandSupported)?void 0:e.call(document,"paste"))return void document.execCommand("paste");oU.reportPaste();const t=localStorage.getItem(aU);if(t){uU(t)&&Oe.redraw()}},accelerator:new qj("V",{command:!0,displayOnly:!0})},hW={label:"Delete",action:()=>Oj.deleteSelection(),accelerator:new qj("backspace"),enabled:Mz},uW={label:[Oe(Jo,{icon:"visible"}),"Visible"],action:()=>{const e=Oj.project.selection.allNodes(),t=!e.items.some(e=>e.node.isVisible());for(let n of e.items)n.node.source.isVisible=t},icon:()=>Oj.project.selection.allNodes().items.some(e=>e.node.isVisible())&&Oe(Jo,{icon:"check"}),enabled:Mz},dW={label:[Oe(Jo,{icon:"locked"}),"Locked"],action:()=>{const e=Oj.project.selection.allNodes(),t=!e.items.some(e=>e.node.isLocked());for(let n of e.items)n.node.source.isLocked=t},icon:()=>Oj.project.selection.allNodes().items.some(e=>e.node.isLocked())&&Oe(Jo,{icon:"check"}),enabled:Mz},pW=(e,t,n)=>({label:[Oe(Jo,{icon:t}),e],action:()=>{const e=Oj.project.selection.allNodes();for(let t of e.items)t.node.source.guidesDisplay=n},icon:()=>(e=>Oj.project.selection.allNodes().items.some(t=>t.node.source.guidesDisplay===e))(n)&&Oe(Jo,{icon:"check"}),enabled:Mz}),fW=[aW,lW,cW,Nz,hW,{type:"separator"},Dz,Fz,Bz,{type:"separator"},zz,Wz,Gz,$z,{type:"separator"},qz,Kz,{type:"separator"},nW,{type:"separator"},rW,sW,oW,{type:"separator"},Hz,Uz,{type:"separator"},jz,Vz,{type:"separator"},{label:"Display",submenu:()=>[uW,dW,{type:"separator"},pW("Show Guides","show_guides","show"),pW("Show Shapes As Guides","all_guides","show-all-as-guides"),pW("Hide Guides","hide_guides","hide")]},{type:"separator"},iW],mW=e=>{$o(e,fW)},gW={view(){const e=Oj.storage.getPublishedSnapshotId(),t=Oj.storage.getCurrentSnapshotId(),n=eo({"is-shared":"number"==typeof e,"is-behind":e!==t});return Oe(".icon.published-status",{className:n},Oe(Jo,{icon:"check"}))}},vW=e=>{Oj.storage.hasWritePermission()&&Oj.saveVersion();const t=Oj.project.focusedComponent();if(!t)return;const n=xP([t],e);"cuttle.svg"===e?QT(n):LH(n)},yW=()=>{Oj.storage.hasWritePermission()&&Oj.saveVersion(),tA()},bW=[{label:()=>"Cuttle.xyz",id:"cuttle",icon:"logo",submenu:()=>[{custom:()=>Oe(kW,{title:"My Projects",href:"/dashboard"})},{type:"separator"},{custom:()=>Oe(kW,{title:"Templates",href:"/templates"})},{type:"separator"},{custom:()=>Oe(kW,{title:"Learn Cuttle",href:"/learn"})}]},{label:()=>"File",id:"file",submenu:()=>[{label:"New",action:Az,icon:()=>Oe(Jo,{icon:"new_tab"})},{type:"separator"},{label:"Import SVG or Image",action:async()=>{const e=await(async()=>{const e=await NT({accept:Vl.join(",")});if(!e||e.length<1)throw"No files chosen.";return Array.from(e)})();UH(e)},enabled:Iz},{type:"separator"},{label:"Export SVG",action:()=>vW("svg"),enabled:Iz},{label:"Export PDF",action:()=>vW("pdf"),enabled:Iz},{label:"Export PNG",action:()=>vW("png"),enabled:Iz},{label:"Export DXF",action:()=>vW("dxf"),enabled:Iz},{label:["Export for 3D Printing",Oe(".feature-tag","BETA")],action:()=>{if(!BT("beta"))return;const e=Oj.project.focusedComponent();e&&(async e=>{ia.open({modalView:()=>Oe(gH,{component:e})})})(e)},enabled:Iz},{type:"separator"},{label:"Print",accelerator:new qj("p",{command:!0}),action:yW,enabled:Iz},{type:"separator"},{label:"Save a Version",action:async()=>{await Oj.saveVersion(),await Oj.storage.refreshSnapshots(),Oj.isVersionHistoryOpen=!0,Oe.redraw()},enabled:()=>Oj.storage.hasWritePermission()},{label:"Browse Version History",action:()=>Oj.isVersionHistoryOpen=!0,enabled:()=>Oj.storage.hasWritePermission()}]},{label:()=>"Edit",id:"edit",submenu:()=>[{label:"Undo",accelerator:new qj("z",{command:!0}),enabled:()=>Oj.hasUndo(),action(){Oj.undo()}},{label:"Redo",accelerator:new qj("z",{command:!0,shift:!0}),enabled:()=>Oj.hasRedo(),action(){Oj.redo()}},{type:"separator"},{label:"Select All",accelerator:new qj("a",{command:!0}),action:()=>{Oj.project.focus instanceof CC&&Oj.project.selectNodes(Oj.project.focus.node.childNodes().filter(e=>{var t;if(!e.isVisible()||"show-all-as-guides"===e.source.guidesDisplay)return!1;const n=null==(t=Oj.traceForNode(e))?void 0:t.result;return n&&n.looseBoundingBox()}))},enabled:()=>Oj.project.focus instanceof CC},{type:"separator"},...fW]},{label:()=>"View",id:"view",submenu:()=>[{label:"Zoom In",accelerator:new qj("=",{command:"optional"}),action:()=>Oj.zoomViewport(Math.SQRT2,!0),enabled:Iz},{label:"Zoom Out",accelerator:new qj("-",{command:"optional"}),action:()=>Oj.zoomViewport(1/Math.SQRT2,!0),enabled:Iz},{type:"separator"},{label:"Zoom to Real Size",action:()=>{let e=Oj.deviceStorage.currentScreenPPI();e?Oj.zoomViewportToPixelsPerInch(e):Oj.openRealSizeCalibration()},accelerator:new qj("0",{command:!0}),enabled:Iz},{label:"Calibrate This Screen",action:()=>Oj.openRealSizeCalibration(),enabled:Iz},{type:"separator"},{label:"Zoom to Fit All",accelerator:new qj("f",{command:!0,shift:!0}),action:()=>Oj.zoomViewportToFitAll(),enabled:Iz},{label:"Zoom to Fit Focused",action:()=>Oj.zoomViewportToFitFocused(),enabled:Iz},{label:"Zoom to Fit Selected",accelerator:new qj("f",{command:!0}),action:()=>Oj.zoomViewportToFitSelected(),enabled:Iz},{type:"separator"},{label:[Oe(Jo,{icon:"trackpad"}),"Trackpad: Scroll to Pan"],action:()=>Oj.deviceStorage.scrollBehavior="pan",icon:()=>"pan"===Oj.deviceStorage.scrollBehavior?Oe(Jo,{icon:"check"}):null,tooltip:()=>{const e=to()?"":"Ctrl";return Oe("div",[Oe("div","Scrolling will pan the canvas."),Oe("div",`Pinch to zoom, or hold ${e} and scroll to zoom.`)])}},{label:[Oe(Jo,{icon:"mouse"}),"Mouse: Scroll to Zoom"],action:()=>Oj.deviceStorage.scrollBehavior="zoom",icon:()=>"zoom"===Oj.deviceStorage.scrollBehavior?Oe(Jo,{icon:"check"}):null,tooltip:()=>(to(),Oe("div",[Oe("div","Scrolling will zoom the canvas."),Oe("div","Drag with right mouse button to pan.")]))},{type:"separator"},{label:"Show Transform Box",action:()=>{Oj.project.isTransformBoxEnabled=!Oj.project.isTransformBoxEnabled},icon:()=>Oj.project.isTransformBoxEnabled?Oe(Jo,{icon:"check"}):null},{type:"separator"},{label:"Show Grid",action:()=>{Oj.project.isGridEnabled=!Oj.project.isGridEnabled},icon:()=>Oj.project.isGridEnabled?Oe(Jo,{icon:"check"}):null},{label:"Show Guides",action:()=>{Oj.project.isGuidesEnabled=!Oj.project.isGuidesEnabled},icon:()=>Oj.project.isGuidesEnabled?Oe(Jo,{icon:"check"}):null},{label:"Snap to Grid",action:()=>Oj.deviceStorage.gridSnappingEnabled=!Oj.deviceStorage.gridSnappingEnabled,icon:()=>Oj.deviceStorage.gridSnappingEnabled?Oe(Jo,{icon:"check"}):null,accelerator:new qj("u",{command:!0,shift:!0})},{label:"Snap to Geometry",action:()=>Oj.deviceStorage.geometrySnappingEnabled=!Oj.deviceStorage.geometrySnappingEnabled,icon:()=>Oj.deviceStorage.geometrySnappingEnabled?Oe(Jo,{icon:"check"}):null,accelerator:new qj("u",{command:!0})}]},{label:()=>"Modify",id:"modify",submenu:()=>{const e=ls([Tz("Mirror Repeat",Ww),Tz("Linear Repeat",Gw),Tz("Rotational Repeat",$w),Tz("Tile Repeat",Zw),Tz("Transform Repeat",qw),{type:"separator"},Tz("Round Corners",Yw),Tz("Dashed Lines",Xw),Tz("Text Along Path",Jw),Tz("Text Within Box",Qw),{type:"separator"},Tz("Merge Paths",Uw),{type:"separator"},Tz("Outline Stroke",Vw),Tz("Expand (Offset)",jw),Tz("Contract (Inset)",Hw),{type:"separator"},Tz("Boolean Union (Weld)",Iw),Tz("Boolean Difference",Ow),Tz("Boolean Intersect",_w),{type:"separator"},Tz("Mask",Nw),Tz("Fit Within",rx),Tz("Attach",sx,{isBetaFeature:!0}),{type:"separator"},Tz("Flatten",Dw),Tz("Layered Stack",Rw),{type:"separator"},Tz("Remove Holes",Fw),Tz("Remove Overlaps",tx),Tz("Weld And Score",nx),{type:"separator"},{label:"Advanced",submenu:()=>[Tz("Visible",Kw),{type:"separator"},Tz("Add Hole",Bw,{isBetaFeature:!0}),{type:"separator"},Tz("Warp Coordinates",ex),Tz("Warped Text",ix)]},{type:"separator"},{label:"New Modifier",icon:()=>Oe(Jo,{icon:"plus"}),action:tU,enabled:Mz}]);Oj.project.modifiers.length>0&&(e.push({type:"separator"}),e.push(...Oj.project.modifiers.map(e=>({label:e.name,action:iU(e),enabled:Mz}))));return new gC(Oj.project).unusedModifiers().length>0&&(e.push({type:"separator"}),e.push({label:"Remove Unused Modifiers",action:rU})),e}},{label:()=>"Help",id:"help",submenu:()=>[{custom:()=>Oe(kW,{title:"Learn Cuttle",description:"Getting started guide, video tutorials, and reference documentation",href:"/learn"})},{type:"separator"},{visible:()=>!va.isSubscriptionEducation(),custom:()=>Oe(kW,{title:"Discord Chat Room",description:"Chat with us and fellow Cuttle users. Great place to ask questions!",href:"https://discord.gg/QRsB3VT"})}]},{label:()=>["Share",Oe(gW)],id:"share",submenu:()=>[{custom:()=>Oe(XU)}],visible:()=>Oj.storage.hasWritePermission()}];let wW,xW;const CW={oninit(){bW.forEach(e=>{e.submenu().forEach(e=>{if(e.accelerator){const t=()=>{var t;e.enabled&&!e.enabled()||null==(t=e.action)||t.call(e)};Yj(e.accelerator,t)}})}),Yj(new qj("v"),()=>{Oj.activateTool("Select")}),Yj(new qj("p"),()=>{Oj.activateTool("Pen")}),Yj(new qj("r"),()=>{Oj.activateTool("Rotate")}),Yj(new qj("s"),()=>{Oj.activateTool("Scale")}),Yj(new qj("g"),()=>{Oj.deviceStorage.gridSnappingEnabled=!Oj.deviceStorage.gridSnappingEnabled}),Yj(new qj("u"),()=>{Oj.deviceStorage.geometrySnappingEnabled=!Oj.deviceStorage.geometrySnappingEnabled}),Yj(new qj("delete"),()=>{Oj.deleteSelection()}),document.addEventListener("cut",dU),document.addEventListener("copy",pU),document.addEventListener("paste",fU,!0)},view:()=>Oe(".top-menu",[Oe(".top-menu-left",bW.map(e=>Oe(SW,{topMenuItem:e,key:e.id}))),Oe(yL,{className:"top-menu-right",view(e){const t=Oj.canvasRectPixels,n=window.innerWidth-e.width,i=t.width+wH-2*Math.max(0,n-t.left);return Oe(".top-menu-right",Oe(YU,{minWidthPixels:i}))}})])},SW={view(e){var t;const{topMenuItem:n}=e.attrs;if(!1===(null==(t=n.visible)?void 0:t.call(n)))return null;const i=()=>{const t=n.submenu();wW=n,xW=Wo({menuItems:t,spawnFrom:uo(e),className:"top-menu-popup",placement:"bottom-start",onclose:()=>{wW=void 0,xW=void 0},yMin:28})},r=eo({open:wW===n,"has-icon":Boolean(n.icon)});return Oe(".top-menu-item",{"data-automation-id":`top-menu-item-${n.id}`,className:r,onpointerdown:()=>{wW&&xW?xW.close():i()},onpointerenter:()=>{wW&&xW&&(xW.close(),i())}},[n.icon&&Oe(".top-menu-item-icon",Oe(Jo,{icon:n.icon})),n.label()])}},kW={view:({attrs:{title:e,description:t,href:n}})=>Oe("a.top-menu-biglink-item",{href:n,target:"_blank"},[Oe(".top-menu-biglink-title",[e,Oe(".top-menu-item-icon",Oe(Jo,{icon:"new_tab"}))]),t&&Oe(".top-menu-biglink-description",t)])},LW=new JV({mode:"text/plain",tabSize:2,indentUnit:2,indentWithTabs:!1,lineWrapping:!0,dragDrop:!1,undoDepth:0,extraKeys:rj}),EW=e=>{let t,n,i=e,r=!1;const s=new ResizeObserver(()=>{t&&!n&&(n=requestAnimationFrame(()=>{t.refresh(),n=void 0}))}),o=()=>{const{onchange:e,value:n}=i.attrs,r=t.getValue();r!==n&&(e(r),Oe.redraw())},a=()=>{var e,n;if(!r){/\n/.test(i.attrs.value)?t.execCommand("goDocStart"):t.execCommand("selectAll")}r=!1,null==(n=(e=i.attrs).onfocus)||n.call(e),Oe.redraw()},l=()=>{var e,t;null==(t=(e=i.attrs).onblur)||t.call(e),Oe.redraw()},c=to()?"Cmd":"Ctrl",h={Enter:e=>{i.attrs.confirmOnEnter?(e.getInputField().blur(),Oe.redraw()):e.execCommand("newlineAndIndent")},[`${c}-F`]:()=>{},[`${c}-G`]:()=>{},[`Shift-${c}-F`]:()=>{},[`Shift-${c}-G`]:()=>{}},u=()=>{const{value:e,readOnly:n}=i.attrs;t&&(t.getValue()!==e&&t.setValue(e),t.setOption("readOnly",n))},d=e=>{e.stopPropagation()},p=e=>{e.stopPropagation(),r=!0},f=()=>{r=!1};return{oncreate(e){const n=uo(e);t=LW.create(n),u();const{initialSelection:i}=e.attrs;i&&(t.focus(),"all"===i?t.execCommand("selectAll"):t.setSelection({line:0,ch:i.start},{line:0,ch:i.end})),t.on("change",o),t.on("focus",a),t.on("blur",l),t.addKeyMap(h),s.observe(n)},onupdate(){u()},onremove(){t.off("change",o),t.off("focus",a),t.off("blur",l),t.removeKeyMap(h),LW.dispose(t),s.disconnect(),n&&cancelAnimationFrame(n)},view:e=>(i=e,Oe(".text-editor",{className:eo({readonly:i.attrs.readOnly}),onclick:d,onpointerdown:p,onpointerup:f}))}},PW=()=>{const e=Oj.storage.getProjectId(),t=Oj.storage.getProjectTags(),n=Boolean(null==t?void 0:t.length),i=n?"feedback-optional":"feedback-required";let r=i,s="";return{view(){let t=null;return r!==i&&(t=Oe(yU,{icon:"warning"},n?"Project already has tags. Is this optional feedback?":"Project does not have tags. Is this required feedback?")),Oe(gL,{primaryAction:{label:"Send",action:()=>async function(){try{if(""===s.trim())throw new Error("Message cannot be empty");await Os("sendProjectFeedback",{projectId:e,message:s,messageType:r})}catch(t){console.error(t),alert("Failed to send message: "+s)}}()}},Oe(".editor-form",[Oe(eH,{options:[{value:"feedback-required",label:"Required"},{value:"feedback-optional",label:"Optional"}],selected:r,onchange:e=>r=e}),t,Oe(TW.EditorWrapper,Oe(EW,{value:s,initialSelection:"all",onchange:e=>s=e}))]))}}},TW=qL.classes({EditorWrapper:{"& .CodeMirror-scroll":{minHeight:"75px"}}});let AW;function MW(){if(RT())return AW?(AW.close(),void(AW=void 0)):void(AW=Wo({menuItems:IW,spawnFrom:{x:0,y:28},onclose:()=>{AW=void 0}}))}const IW=[{label:Oe(".feature-tag","ADMIN"),accelerator:new qj("1",{command:!0,shift:!0,displayOnly:!0}),enabled:()=>!1},{label:"Overwrite from Project",action:function(){Jj({label:"Project URL",placeholder:"https://cuttle.xyz/...",onsubmit:e=>{const{projectId:t}=Sr(e);t&&Oj.overwriteWithProject(t)},spawnFrom:{x:20,y:window.innerHeight-20},autofocus:!0})}},{label:"Local Pro Testing",action:()=>{RT()&&(va.featureFlags.hasProFeatures=!va.featureFlags.hasProFeatures)},icon:()=>va.featureFlags.hasProFeatures&&Oe(Jo,{icon:"check"})},{label:"Show Debug Inspector",action:function(){Oj.debug_hideInfoInspector=!Oj.debug_hideInfoInspector},icon:()=>!Oj.debug_hideInfoInspector&&Oe(Jo,{icon:"check"})},{type:"separator"},{label:"Export Cuttle SVG",action:()=>vW("cuttle.svg"),enabled:()=>Oj.project.hasFocusedComponent()},{label:"Export Project Examples",action:()=>{const e=Oj.getProjectSnapshot().toString(),t={};for(const o of Oj.project.components)t[o.name]=Xj(o);const n={snapshot:e,thumbnails:t},i=JSON.stringify(n),r=new Blob([i],{type:"application/json"}),s=`${Oj.storage.getProjectId()}.json`;iE.saveAs(r,s)}},{type:"separator"},{label:"Edit Project Tags",action:()=>{ia.open({modalView:()=>Oe(_W)})}},{type:"separator"},{label:"Send Project Feedback",action:()=>{ia.open({modalView:()=>Oe(PW)})}}];const _W=()=>{const e=Oj.storage.getProjectTags(),t=Oj.storage.getAllTags(),n=new Set(null==e?void 0:e.map(e=>e.tagId)),i=[{title:"Feature",comments:["Check all that apply.","Almost everything has Customizable Text.","Family Names means you can list multiple names."],slugs:["customizable-text","multiple-names"]},{title:"Holiday",comments:["Dont check more than one.","Occasional exceptions: a flower is both Mothers Day and Valentines Day."],slugs:["christmas","easter","halloween","mothers-day-fathers-day","valentines-day"]},{title:"Theme",comments:["Check all that apply.","If you check Graduation, dont also check School."],slugs:["baby-newborn","graduation","school","sports","weddings-and-parties"]},{title:"Form Factor",comments:["Dont check more than one.","If it cant be used year-round (too holiday-specific), dont check any.","Keychains are small and horizontal vs Bag Tags which are large and circular. Only check one or the other."],slugs:["bag-tags","cake-toppers","decor","keychains","jewelry-and-wearables","laser-cut-boxes","paper-and-cardstock","tools-and-testers","toys-and-puzzles"]}];return{view(){let e="Tag list not loaded, please check back another time.",r={label:"OK",action:()=>{}};if(t){e=[];for(const{title:r,comments:s,slugs:o}of i){e.push(Oe("h3",r)),e.push(...s.map(e=>Oe("p",e)));for(const i of o){const r=t.find(e=>e.slug===i);if(r){const t=n.has(r.tagId);e.push(Oe("label",[Oe(xT,{checked:t,onclick:()=>{t?n.delete(r.tagId):n.add(r.tagId)}}),r.tagName]))}}}r={label:"Save",action:()=>{const e=t.filter(e=>n.has(e.tagId));Oj.storage.setProjectTags(e),ia.close()}}}return Oe(gL,{primaryAction:r},Oe(".edit-project-tags-modal",e))}}};const OW=(e,{definitionDrag:t,onConsummate:n,onUp:i,onCancel:r})=>{Oj.definitionDrag=t,_A(e,{cursor:()=>"grabbing",onConsummate:e=>{Oj.definitionDrag&&(Oj.definitionDrag.isConsummated=!0),null==n||n(e)},onUp:e=>{null==i||i(e),Oj.definitionDrag=void 0},onCancel:e=>{null==r||r(e),Oj.definitionDrag=void 0}})};class NW{constructor(e,t){this.definition=e,this.args=t}transformer(){return this.nodeTransformer}parentNode(){var e;return(null==(e=this.node)?void 0:e.parent)??void 0}initialScale(){let e=1;return this.definition===Bx?e=Jr("px",Oj.project.settings.units):this.definition.isAutoScale&&(e="auto"),e}tryInsert(e,t){if(!this.isConsummated)return!1;const{project:n}=Oj,{definition:i,args:r}=this;if(n.focus instanceof kC)return this.message="Can't insert into the Read Me",!1;if(n.focus instanceof LC)return this.message="Can't insert into settings",!1;if(n.focus instanceof SC)return this.message="Can't insert into a code component",!1;if(this.definition===n.focus.component)return this.message="Can't insert Component into itself.",!1;if(n.focus.node.isImmutable()||n.focus.node.isImmutableChildren())return this.message="Can't insert into a built-in Component",!1;const s=n.createElementWithDefinition(i);if(this.args)for(let a in r)s.base.args[a]=this.args[a];if(mb(i))(i instanceof vb||i instanceof yb)&&("stroke"===i.defaultStyle?s.stroke=new wx(dx):"fill"===i.defaultStyle&&(s.fill=new wx(cx)));else if(i instanceof yb){const e=Oj.traceForComponent(i);(null==e?void 0:e.result)&&!e.result.hasStyle()&&(s.stroke=new wx(dx))}const[o]=n.spliceNodes([],[s],e,t);return this.node=o,this.nodeTransformer=new BC(o),n.selectNode(o),!0}remove(){this.node&&Oj.project.spliceNodes([this.node]),this.node=void 0,this.nodeTransformer=void 0,this.message=void 0}}class DW{constructor(e,t){this.snapshotString=e,this.isAutoScale=t}parentNode(){return this.insertionParent}initialScale(){if(this.isAutoScale)return"auto"}transformer(){return this.selectionTransformer}tryInsert(e,t){const n=ES.fromString(this.snapshotString);Ps(n);const{project:i}=Oj;i.focusNode(e),void 0!==t&&t>0&&(Ps(e.childCount()>=t),i.selectNode(e.childNodeAtIndex(t-1)));const r=n.toPortableProjectData();Ps(r);for(const a of r.components)for(const e of i.components){const t=e.name;if(t===a.name&&!e.isImmutable){const n=i.makeDefinitionNameGenerator().generate(t);i.renameDefinition(e,n),jT.showBasic({type:"info",message:`Renamed your component ${t} to ${n}.`})}}const s=oA(i,r);Ps(s instanceof hS);const o=s.toNodes();o.length>0&&(this.node=o[0]),this.insertionParent=e,this.selectionTransformer=new FC(s)}remove(){Oj.deleteSelection()}}class RW{constructor(){this.id="definition-drag"}cursor(){return"select"}hitTest(e){if(Oj.definitionDrag)return{isHit:!0}}onPointerEnter(e){const{definitionDrag:t}=Oj;t&&(Oj.activateTool("Select"),Oj.updateGhostGeometry(),Oj.deviceStorage.geometrySnappingEnabled&&Oj.snapping.cacheSnappingDataForInterface(Oj.interfaceElements))}onPointerMove(e){const{definitionDrag:t}=Oj;if(!t)return;if(!t.node){const{insertionParent:e,insertionIndex:n}=Oj.project.insertionPoint({forbidCollapsedParentPath:!0});void 0!==e&&t.tryInsert(e,n)}const n=t.transformer();if(!n)return;const i=t.parentNode();if(!i)return;const r=new hC(OT(e));Oj.deviceStorage.geometrySnappingEnabled&&Oj.snapping.updateSnappingPointNearWorldPosition(r.worldPosition),AT(r);const s=GC(i);if(s){const e=s.clone().invert(),{contextPosition:i}=PT(r,e);let o=t.initialScale();"auto"===o&&(o=(()=>{const e=Oj.project.focusedComponent();Ps(e,"A focused component is required for ideal unit square scale.");const t=100/Oj.viewportManager.viewportForComponent(e).pixelsPerUnit;return Math.pow(10,Math.round(Math.log10(t)))})());const a=void 0===o;n.transformContext(Ne.fromTransform({position:i,scale:o}),{preserveScale:a})}}onPointerUp(e){Oj.clearGhostGeometry(),Oj.snapping.clear()}onPointerLeave(e){const{definitionDrag:t}=Oj;t&&t.remove(),this.onPointerUp(e)}}class FW{renderCanvas(e,t){if(!Oj.deviceStorage.geometrySnappingEnabled)return;const{snapping:n,canvasDrag:i}=Oj;if(n.currentPoint){if(n.currentPoint.sources)for(let i of n.currentPoint.sources)i.geometry instanceof Wn||PA(i.geometry,qL.color.red47Alpha60,2,!1,!1,e,t);const r=n.currentPoint.worldPosition.clone().affineTransform(e);if(AA(r,3,qL.color.red47,t),!i||i.startPoint.isPrecise())for(let i of n.referencePoints){const n=i.clone().affineTransform(e);AA(n,3,qL.color.red47,t)}}}}const BW={view(){const e=Oj.snapping.currentPoint;if(!e||Fo.length>0||!Oj.deviceStorage.geometrySnappingEnabled)return;const t=Oj.project.focusedComponent();if(!t)return;const n=Oj.viewportManager.viewportForComponent(t).viewMatrixWithCanvasDimensions(Oj.canvasDimensions),i=e.worldPosition.clone().affineTransform(n);i.x+=Oj.canvasRectPixels.x,i.y+=Oj.canvasRectPixels.y,i.floor();const r={left:i.x+"px",top:i.y+"px"};return Oe(".snapping-point-tooltip",{style:r},e.message())}};class VW{constructor(){this.hoveredInterfaceElementNeedsUpdate=!1}updateInterfaceElements(e){const t=Oj.ensureEnabledActiveTool().interface(e);t.push(new RW),t.push(new FW),Oj.interfaceElements=HW(t,[]),this.hoveredInterfaceElementNeedsUpdate&&!Oj.isCanvasPanningOrPreparingToPan()&&this.updateHoveredInterfaceElement()}updateCurrentPointerEvent(e){this.currentPointerEvent=e,Oj.isShiftDown=e.shiftKey,Oj.isControlDown=e.ctrlKey,Oj.isAltDown=e.altKey,Oj.isMetaDown=e.metaKey}updateHoveredInterfaceElement(){var e,t,n,i;if(!Oj.project.hasFocusedComponent())return;if(!this.currentPointerEvent)return;const r=OT(this.currentPointerEvent),s=((e,t)=>{const n=Oj.project.focusedComponent();Ps(n,"Should only be used when a component is focused");const i=Oj.selectionDistanceWorld(),r=Oj.viewportManager.viewportForComponent(n);let s,o,a=1/0,l=!0;for(let c=e.length;--c>=0;){const n=e[c];if(void 0!==n.isValid&&!n.isValid())continue;if(void 0===n.hitTest)continue;const h=n.hitTest(t,r.pixelsPerUnit);if(h){const{distance:e,isHit:t,isLowPriority:r}=h;if(void 0!==e&&e<=i&&(e<a-1e-6||l&&!r)&&(o=n,a=e,l=Boolean(r)),t){s=n;break}}}return a<=i?o:s})(Oj.interfaceElements,r),o=null==(e=Oj.hoveredInterfaceElement)?void 0:e.id,a=null==s?void 0:s.id;if(o!==a){if(void 0!==o){const e=Oj.hoveredInterfaceElement;null==(t=e.onPointerLeave)||t.call(e,this.currentPointerEvent)}if(void 0!==a){const e=s;null==(n=e.onPointerEnter)||n.call(e,this.currentPointerEvent)}}Oj.hoveredInterfaceElement=s;const l=null==(i=null==s?void 0:s.selectables)?void 0:i.call(s);l&&l.length>0&&Oj.project.selectableExistsAndIsValid(l[0])&&(Oj.project.hoveredItem=l[0]),this.hoveredInterfaceElementNeedsUpdate=!1}clearHoveredInterfaceElementWithEvent(e){var t,n;jW(Oj.hoveredInterfaceElement)&&void 0!==Oj.hoveredInterfaceElement.id&&(null==(n=(t=Oj.hoveredInterfaceElement).onPointerLeave)||n.call(t,e)),Oj.hoveredInterfaceElement=void 0}render(e,t,n,i,r,s){var o;r.save(),r.scale(i,i);const{units:a,gridDivisions:l}=Oj.project.settings;Oj.project.isGridEnabled&&KL(e,t,n,l,r);for(let c of Oj.interfaceElements)if(jW(c)&&c.renderCanvas){const t=(null==(o=c.renderCanvasOpacity)?void 0:o.call(c))??1;if(t<1){s.save(),s.scale(i,i),s.clearRect(0,0,n.x,n.y),c.renderCanvas(e,s),s.restore(),r.globalAlpha=t;const o=r.getTransform();r.resetTransform(),r.drawImage(s.canvas,0,0),r.setTransform(o),r.globalAlpha=1}else r.save(),c.renderCanvas(e,r),r.restore()}UW(e,r),xH(e,t,n,a,l,r),r.restore()}renderHtml(e){const t=e=>t=>{t.stopPropagation(),OW(t,{definitionDrag:new NW(Cx,{angle:new _b(Db(e))})})};return[Oe(".html-ruler-mask",[Oe(".html-ruler-offset",[Oj.interfaceElements.map(t=>{var n;return null==(n=t.renderHtml)?void 0:n.call(t,e)})])]),Oe(".ruler-grab-h",{onpointerdown:t(0)}),Oe(".ruler-grab-v",{onpointerdown:t(90)})]}onPointerDown(e,t){var n,i,r,s;if(!Oj.project.hasFocusedComponent())return;if(!jW(Oj.hoveredInterfaceElement))return;this.updateCurrentPointerEvent(e);const{project:o}=Oj,a=null==(i=(n=Oj.hoveredInterfaceElement).selectables)?void 0:i.call(n);if(Oj.isSpaceDown||ho(e)||(e=>1===e.button)(e)){((e,t,n)=>{const i=OT(e);_A(e,{onConsummate(){Oj.isCanvasPanning=!0},onMove(e){const t=OT(e),r=i.clone().sub(t);n.center.add(r)},onCancel(e){t(e)},onUp(){Oj.isCanvasPanning=!1},cursor:()=>"grab"})})(e,()=>{var t,n;jW(Oj.hoveredInterfaceElement)&&(a&&(o.selection.contains(...a)||o.selectItems(a),mW(e)),null==(n=(t=Oj.hoveredInterfaceElement).onContextMenu)||n.call(t,e))},t)}else{let t;if(a){const n=o.selection.contains(...a);e.shiftKey?(t=!n,o.toggleSelectItems(a,!0)):n||o.selectItems(a)}if(Oj.canvasPointerIsDown=!0,Oj.downInterfaceElement=Oj.hoveredInterfaceElement,null==(s=(r=Oj.downInterfaceElement).onPointerDown)||s.call(r,e),a&&!e.defaultPrevented&&o.selection.contains(...a)){if(o.selection.isImmutable())return void _A(e,{onConsummate:()=>{jT.showBasic({type:"error",message:"Can't move the selection because it contains an immutable shape."})}});if(o.selection.isPositionLocked())return void _A(e,{onConsummate:()=>{jT.showBasic({type:"error",message:"Can't move the selection because a formula is being used in a Transform.",nextStep:"Try changing the position directly in the Inspector."})}});const n=()=>{e.shiftKey&&o.toggleSelectItems(a,t)};pV(e,o.selection,n)}}}onPointerMove(e){var t,n,i,r;if(!Oj.project.hasFocusedComponent())return;if(this.updateCurrentPointerEvent(e),Oj.canvasPointerPositionPixels=MT(e),ho(e))return;const s=Oj.isCanvasPanningOrPreparingToPan();s||Oj.canvasPointerIsDown||this.updateHoveredInterfaceElement(),jW(Oj.hoveredInterfaceElement)&&(null==(n=(t=Oj.hoveredInterfaceElement).onPointerMove)||n.call(t,e)),s||null==(r=(i=Oj.ensureEnabledActiveTool()).onPointerMove)||r.call(i,e)}onPointerEnter(e){var t,n;Oj.project.hasFocusedComponent()&&(this.updateCurrentPointerEvent(e),Oj.canvasPointerIsDown=0!==e.buttons,Oj.isCanvasPanningOrPreparingToPan()||this.updateHoveredInterfaceElement(),null==(n=(t=Oj.ensureEnabledActiveTool()).onPointerEnter)||n.call(t,e))}onPointerLeave(e){var t,n;Oj.project.hasFocusedComponent()&&(this.updateCurrentPointerEvent(e),Oj.canvasPointerPositionPixels=void 0,Oj.canvasPointerIsDown=!1,this.clearHoveredInterfaceElementWithEvent(e),null==(n=(t=Oj.ensureEnabledActiveTool()).onPointerLeave)||n.call(t,e),this.currentPointerEvent=void 0)}onPointerUp(e){var t,n,i;Oj.project.hasFocusedComponent()&&(this.updateCurrentPointerEvent(e),Oj.canvasPointerIsDown=!1,jW(Oj.downInterfaceElement)&&(null==(n=(t=Oj.downInterfaceElement).onPointerUp)||n.call(t,e)),Oj.downInterfaceElement=void 0,Oj.isCanvasPanningOrPreparingToPan()||this.updateHoveredInterfaceElement(),(null==(i=Oj.definitionDrag)?void 0:i.node)&&HB(Oj.definitionDrag.node,e))}onKeyEvent(e){Oj.project.hasFocusedComponent()&&(io()||(this.hoveredInterfaceElementNeedsUpdate=!0))}onViewportChange(e,t){const n=new It(e.deltaX,e.deltaY).mulScalar(.75/t.pixelsPerUnit);t.center.add(n);const i=e.deltaScale;if(Oj.canvasPointerPositionPixels){const e=_T(Oj.canvasPointerPositionPixels);t.scaleFromCenter(i,e)}else t.scale(i)}}const jW=e=>void 0!==e&&(void 0===e.isValid||e.isValid()),HW=(e,t)=>{for(let n of e)jW(n)&&(t.push(n),void 0!==n.children&&HW(n.children,t));return t},UW=(e,t)=>{const{selectionBox:n}=Oj;if(!n)return;const i=n.min.clone().affineTransform(e),r=n.max.clone().affineTransform(e),s=IT(It.min(i,r)),o=IT(It.max(i,r));t.beginPath(),t.rect(s.x,s.y,o.x-s.x,o.y-s.y);!Oj.isAltDown&&(t.fillStyle=qL.color.blue63Alpha10,t.fill()),t.strokeStyle=qL.color.blue63,t.lineWidth=1,t.lineJoin="miter",t.stroke()};document.addEventListener("wheel",()=>{});const zW={oninit(e){this.latestVnode=e,this.ui=new VW},oncreate(e){this.latestVnode=e;const t=uo(e);this.gestureListener=new kT(t,e=>this.ui.onViewportChange(e,this.latestVnode.attrs.viewport));const n=t.getElementsByClassName("canvas")[0];Ps(n instanceof HTMLCanvasElement),this.context=n.getContext("2d",{alpha:!1}),Ps(this.context),this.offscreenCanvas=document.createElement("canvas"),this.offscreenContext=this.offscreenCanvas.getContext("2d"),Ps(this.offscreenContext),this.context.fillStyle=qL.color.white,this.context.fillRect(0,0,n.width,n.height),this.onKeyEvent=e=>this.ui.onKeyEvent(e),window.addEventListener("keydown",this.onKeyEvent),window.addEventListener("keyup",this.onKeyEvent)},onupdate(e){this.latestVnode=e;const{viewport:t,canvasDimensions:n}=e.attrs,i=t.viewMatrixWithCanvasDimensions(n),r=DT(),s=n.size.x*r,o=n.size.y*r;this.offscreenCanvas.width=s,this.offscreenCanvas.height=o,Ps(this.context),Ps(this.offscreenContext),this.context.fillStyle=qL.color.white,this.context.fillRect(0,0,s,o),this.ui.render(i,t,n.size,r,this.context,this.offscreenContext),this.context.restore(),this.offscreenContext.restore()},onremove(e){this.gestureListener.dispose(),window.removeEventListener("keydown",this.onKeyEvent),window.removeEventListener("keyup",this.onKeyEvent)},view({attrs:{viewport:e,canvasDimensions:t}}){var n;const i=e.viewMatrixWithCanvasDimensions(t);let r;if(this.ui.updateInterfaceElements(i),Oj.isCanvasPanningOrPreparingToPan())r=Oj.isCanvasPanning?"grabbing":"grab";else{const e=Oj.downInterfaceElement||Oj.hoveredInterfaceElement;r=null==(n=null==e?void 0:e.cursor)?void 0:n.call(e)}const s=DT();return Oe(".viewport-main",{className:r?`cursor-${r}`:void 0,onpointerdown:t=>this.ui.onPointerDown(t,e),onpointermove:e=>this.ui.onPointerMove(e),onpointerup:e=>this.ui.onPointerUp(e),onpointerenter:e=>this.ui.onPointerEnter(e),onpointerleave:e=>this.ui.onPointerLeave(e)},[Oe("canvas.canvas",{width:t.size.x*s,height:t.size.y*s,style:`width:${t.size.x}px;height:${t.size.y}px`}),Oe(".html",this.ui.renderHtml(i))])}},WW={view({attrs:{project:e,documentation:t}}){const n=eo({focused:e.focusedDocumentation()===t});return Oe(".components-custom-item",{className:n,onpointerdown:()=>{e.focusItem(t)}},[Oe(Qo,{icon:"doc"}),Oe(".components-custom-item-name",t.name)])}},GW={view({attrs:{project:e,settings:t}}){const n=eo({focused:e.focus instanceof LC&&e.focus.settings===t});return Oe(".components-custom-item",{className:n,onpointerdown:()=>{e.focusItem(t)}},[Oe(Qo,{icon:"settings"}),Oe(".components-custom-item-name","Units & Settings")])}},$W={oncreate(e){const t=uo(e);Ps(t instanceof HTMLCanvasElement),this.context=t.getContext("2d"),Ps(this.context),ZW(this.context),e.attrs.render(e.attrs.viewportSize,this.context),qW(this.context)},onupdate(e){Ps(this.context),ZW(this.context),e.attrs.render(e.attrs.viewportSize,this.context),qW(this.context)},view({attrs:{viewportSize:e}}){const t=window.devicePixelRatio||1;return Oe("canvas",{width:e.x*t,height:e.y*t,style:`width:${e.x}px;height:${e.y}px`})}},ZW=e=>{const t=window.devicePixelRatio||1;e.save(),e.scale(t,t)},qW=e=>{e.restore()},KW=(e,t)=>Oe(".thumbnail",{style:`width:${e}px;height:${t}px`}),YW={onbeforeupdate(e,t){if(Oj.isFirstRedrawAfterBecameVisible)return!0;return!(e.attrs.graphic===t.attrs.graphic&&e.attrs.isHovered===t.attrs.isHovered&&e.attrs.isFocused===t.attrs.isFocused&&this.latestPixelRatio===DT())},onupdate(){this.latestPixelRatio=DT()},view({attrs:{graphic:e,parameterPoints:t,width:n,height:i,padding:r,isHovered:s,isFocused:o,isBuiltin:a,fillColor:l,strokeColor:c}}){if(!e)return KW(n,i);const h=new It(n-2*r,i-2*r);let u=e.looseBoundingBox();if(t)for(let b of t)u?u.expandToIncludePoint(b):u=new De(b.clone(),b.clone());if(!u)return KW(n,i);let d=u.size();d.isZero()&&(u.expandScalar(.5),d.set(1,1));const p=d.x/d.y,f=h.x/h.y;let m;if(p>f){const e=d.x/f-d.y;m=new It(0,e/2)}else{const e=d.y*f-d.x;m=new It(e/2,0)}const g=Math.min(h.x/d.x,h.y/d.y),v=Ne.fromTransform({position:new It(r,r)}).mul(Ne.fromTransform({scale:g})).mul(Ne.fromTransform({position:m.clone().sub(u.min)}));l||(l=a?s?qL.color.blue63Alpha80:qL.color.gray70:o?qL.color.blue53Alpha20:s?qL.color.blue63Alpha20:qL.color.blackAlpha10),c||(c=o?qL.color.blue53:s?qL.color.blue63:qL.color.gray70);const y=a?void 0:c;return Oe(".thumbnail",{style:`width:${n}px; height:${i}px;`},Oe($W,{viewportSize:new It(n,i),render:(n,i)=>{if(i.clearRect(0,0,n.x,n.y),XW(e,l,c,y,v,i),t){const e=new It,n=o||s?qL.color.blue43:qL.color.gray24;for(let r of t)e.copy(r).affineTransform(v).round(),i.fillStyle=n,i.beginPath(),i.ellipse(e.x,e.y,2,2,0,0,ze),i.fill(),i.fillStyle=qL.color.white,i.beginPath(),i.ellipse(e.x,e.y,1,1,0,0,ze),i.fill()}}}))}},XW=(e,t,n,i,r,s)=>{if(e instanceof xi)for(let o of e.items)XW(o,t,n,i,r,s);else if(e instanceof Ri||e instanceof wi){s.beginPath();const o=e.clone().affineTransform(r);lr(o,s),t&&(e instanceof wi||e.closed)&&(s.fillStyle=t,s.fill("evenodd"),n=i),n&&(s.lineCap="round",s.lineJoin="round",s.lineWidth=1,s.strokeStyle=n,s.stroke())}},JW=()=>{const e=Oj.project,t=e.createComponent();e.focusItem(t),Oj.autoSelectForRename=t},QW=[{label:"New Component",action:JW},{label:"New Code Component ",action:()=>{const e=Oj.project,t=e.createCodeComponent();e.focusItem(t),Oj.autoSelectForRename=t}}],eG={view:e=>Oe(ea,{icon:"chevron_down",className:"new-component-extra",onpointerdown:()=>{Wo({menuItems:QW,spawnFrom:uo(e),placement:"bottom-end"})}})},tG={oncreate(e){Oj.ensureExamplesData()},view(e){const{query:t,category:n}=iC,i=()=>{iC.goBack()},r=!(Oj.project.focusedComponent()instanceof vb),s=!r&&!va.storageGet("hasOpenedCreationPanel");return Oe(".components",{className:eo({"creation-panel-advertise":s})},[Oe("label.creation-panel-search",{"aria-label":"Search",className:eo({disabled:r})},[Oe(Jo,{icon:"search"}),Oe("input",{type:"text",oninput:e=>{const t=e.target.value;iC.setQuery(t)},value:t,placeholder:"Search",disabled:r})]),Oe(".creation-panel",Oe(".creation-panel-pages",{style:{transform:`translateX(${-199*iC.index}px)`}},[Oe(".creation-panel-page",{inert:0!==iC.index},[Oe("button.creation-panel-browse-all",{onclick:()=>{iC.goTo(1),va.storageUpdate({hasOpenedCreationPanel:!0})},disabled:r,className:eo({disabled:r})},[Oe(".icon20"),Oe(".label","Browse All Shapes"),Oe(Jo,{icon:"chevron_right"})]),Oe(".query-results.scrollable",[Oe(nG,{disableBuiltIns:r})])]),Oe(".creation-panel-page",{inert:1!==iC.index},[Oe("button",{"aria-label":"Back",onclick:i},[Oe(Jo,{icon:"chevron_left"}),Oe(".label",""===t?"All Shapes":"Search Results"),Oe(".icon20")]),""===t?Oe(iG):Oe(oG,{query:t})]),n&&Oe(".creation-panel-page",{inert:2!==iC.index},[Oe("button",{"aria-label":"Back",onclick:i},[Oe(Jo,{icon:"chevron_left"}),Oe(".label",n.category),Oe(".icon20")]),Oe(sG,{category:n})])]))])}},nG={view(e){const{disableBuiltIns:t}=e.attrs;return[Oe(".component-category.basic-shapes",{className:eo({disabled:t})},[Oe(hG,{category:Yx,shapes:Yx.shapes})]),Oe(cG,{title:"Project"},[Oe(WW,{project:Oj.project,documentation:Oj.project.documentation}),Oe(GW,{project:Oj.project,settings:Oj.project.settings})]),Oe(lG)]}},iG={view:()=>Oj.examplesData?Oe(".query-results.scrollable",Jx.map(e=>{const{shapes:t,featuredShapes:n}=e;return Oe(aG,{category:e,shapes:ls(n.map(e=>t.find(t=>Cf(t)===e))),hasMore:e.shapes.length>e.featuredShapes.length})})):Oe(rG)},rG={view:()=>Oe(".query-loading",[Oe(".loading-indicator"),Oe("span","Loading")])},sG={view({attrs:{category:e}}){const t=e.displayMore??e.display;return Oe(".query-results.scrollable",Oe(".query-category",[Oe(".query-category-components",{className:t},Oe(hG,{category:e,shapes:e.shapes,overrideDisplay:t}))]))}},oG={view({attrs:{query:e}}){const{results:t}=iC;return 0===t.length?Oe(nC,{query:e}):Oj.examplesData?Oe(".query-results.scrollable",t.map(({category:e,results:t})=>Oe(aG,{category:e,shapes:t}))):Oe(rG)}},aG={view({attrs:{category:e,shapes:t,hasMore:n}}){if(0!==t.length)return Oe(".query-category.has-category-heading",[n?Oe("button.query-category-title",{onclick:()=>iC.setCategory(e)},[Oe(".label",e.category),Oe(".more",["More",Oe(Jo,{icon:"chevron_right"})])]):Oe(".query-category-title",e.category),Oe(".query-category-components",{className:e.display},Oe(hG,{category:e,shapes:t}))])}},lG={view(){const e=Oj.project.components;return Oe(cG,{title:"Components"},[e.map((e,t)=>{if(!e.isImmutable)return[Oe(vG,{insertionIndex:t}),Oe(fG,{definition:e,display:"one-up"})]}),Oe(vG,{insertionIndex:e.length}),Oe(".new-component",[Oe(Zo,{className:"new-component-button",message:()=>"New Component"},[Oe(ea,{icon:"plus",onpointerdown:JW})]),Oe(eG)])])}},cG=e=>({view:({children:e,attrs:{title:t}})=>Oe(".component-category",[Oe(".component-category-header",Oe(".component-category-title",t)),Oe(".component-category-components",e)])}),hG={view({attrs:{category:e,shapes:t,overrideDisplay:n}}){const i=n??e.display;return t.map(e=>"builtin"===e.type?Oe(fG,{definition:e.definition,display:i}):"component"===e.type||"guts"===e.type?Oe(uG,{shape:e,display:i}):"emoji"===e.type?Oe(dG,{shape:e}):"cuttle-symbol"===e.type?Oe(pG,{assetPath:e.path,name:e.name,alt:e.name}):void 0)}},uG={view(e){var t;const{attrs:{shape:n,display:i}}=e,r=null==(t=Oj.examplesData)?void 0:t.exampleDataWithName(n.name);if(!r)return;const s=Oe(".thumbnail",Oe.trust(r.thumbnail)),o="one-up"===i||"one-up-compact"===i?[Oe(".component-thumbnail",s),Oe(".component-name",n.name)]:Oe(".component-thumbnail",Oe(Zo,{message:()=>n.name,placement:"bottom-start",offsetH:8,offsetV:6},s));return Oe(".component.example",{onpointerdown:t=>{const i=new DW(r.snapshot,Boolean(n.isAutoScale));OW(t,{definitionDrag:i,onCancel:()=>{gG(e)}}),Ao("create shape",{name:n.name})}},o)}},dG={view(e){const{attrs:{shape:t}}=e;return Oe(pG,{assetPath:`/noto-emoji-600/${t.unicodeId}`,name:t.name,alt:t.emoji})}},pG={view(e){const{attrs:{assetPath:t,name:n,alt:i}}=e,r=`${ur}${t}.svg`,s=mG["four-up"];return Oe(".component.example.emoji.four-up",{onpointerdown:t=>{const i=new DW(`{"app":"Cuttle","type":"PortableProjectData","version":36,"payload":{"@class":"PortableProjectData","@id":"0","elements":[{"@id":"1","@class":"Element","name":"${n}","base":{"@id":"2","@class":"Instance","definition":{"@builtin":"EmojiDefinition"},"args":{"@id":"3","emoji":{"@id":"4","@class":"Expression","jsCode":"\\"${r}\\"","editingJsCode":null}},"isEnabled":true,"repeatIndexVariableName":null},"transform":{"@id":"5","@class":"Instance","definition":{"@builtin":"TransformDefinition"},"args":{"@id":"6","position":{"@id":"7","@class":"Expression","jsCode":"Vec(0.00, 0.00)","editingJsCode":null}},"isEnabled":true,"repeatIndexVariableName":null},"modifiers":[],"fill":{"@id":"8","@class":"Instance","definition":{"@builtin":"FillDefinition"},"args":{"@id":"9"},"isEnabled":true,"repeatIndexVariableName":null},"stroke":null,"children":[],"isLocked":false,"isVisible":true,"guidesDisplay":"show"}],"instances":[],"components":[],"modifiers":[],"componentParameters":[],"projectParameters":[]}}`,!0);OW(t,{definitionDrag:i,onCancel:()=>{gG(e)}}),Ao("create shape",{name:n})},"aria-label":i},Oe(Zo,{message:()=>n,placement:"bottom-start"},Oe("img",{loading:"lazy",src:lc(r),key:t,alt:i,width:s.x,height:s.y})))}},fG={view(e){var t;const{definition:n,display:i}=e.attrs,r=n.isPro,s=e=>{Oj.project.renameDefinition(n,e)},o=[];let a=null;if(!n.isImmutable&&(n instanceof vb||n instanceof yb)){o.push({label:"Copy Component",action:()=>{(e=>{const t=Oj.project.componentPortableProjectData(e);try{const n=iA(t);cU(n),po(n),JT("Copied",e)}catch(n){n instanceof rr&&XT()}})(n)}},{label:"Duplicate Component",action:()=>{Oj.project.duplicateComponent(n)}},{label:"Delete Component",action:()=>{const e=new gC(Oj.project).dependentPathsForSource(n);e.length>0?jT.showBasic({type:"error",message:["Can't delete this component because it's being used in ",Oe("strong",e[0].join("  ")),e.length>1&&[" and ",e.length-1," others."],"."],nextStep:"Remove this component from the rest of the project before deleting it."}):Oj.project.removeComponent(n)}},{label:"Rename Component",action:()=>{Oj.autoSelectForRename=n}});a=Oe(".extra",[Oe(ea,{onpointerdown:t=>{t.stopPropagation();const n=uo(e);Wo({menuItems:o,spawnFrom:n,placement:"right-start"})},icon:"dotdotdot",className:"extra-hidden"})])}const l=Oj.definitionDrag instanceof NW&&Oj.definitionDrag.definition===n,c=l&&(null==(t=Oj.definitionDrag)?void 0:t.message),h=Oj.project.focusedComponent()===n,u=eo({dragging:l,focused:h,message:Boolean(c)}),d=Oj.tracesByDefinition.get(n),p=null==d?void 0:d.result,f=[];if(d)for(let x of n.allParameters()){if(x.hidden)continue;const e=new aS(n,x),t=JC(e);t&&f.push(t.handlePosition)}let m,g=e=>Oe("div",e);const v="one-up"===i||"one-up-compact"===i;if(v)if(n.isImmutable)m=n.name;else{let e=!1;Oj.autoSelectForRename===n&&(e=!0,Oj.autoSelectForRename=void 0),m=Oe(MV,{value:n.name,onchange:s,autoSelect:e})}else g=e=>Oe(Zo,{message:()=>n.name,placement:"bottom-start"},e);let y;c&&(y=Oe(".component-message.tooltip",c));const b=n instanceof yb&&!n.isImmutable,w=mG[i];return Oe(".component",{className:u,onpointerdown:t=>{if(ho(t))return void(o.length>0&&$o(t,o));if(r&&!BT("pro-fonts"))return;const i=new NW(n);OW(t,{definitionDrag:i,onUp:()=>{if(!n.isImmutable){let e=i.hoveredInsertionIndex;if(void 0!==e){const t=Oj.project.components.indexOf(n);Oj.project.components.splice(t,1),t<e&&(e-=1),Oj.project.components.splice(e,0,n)}}},onCancel:()=>{n.isImmutable?gG(e):Oj.project.focusItem(n)}}),n.isImmutable&&Ao("create shape",{name:n.name})},onpointerenter:e=>{this.isHovered=!0},onpointerleave:e=>{this.isHovered=!1}},[Oe(".component-thumbnail",g(n.icon?Oe(".thumbnail-icon",{className:eo({hover:this.isHovered})},Oe(Qo,{icon:n.icon})):Oe(YW,{graphic:p,width:w.x,height:w.y,padding:2,parameterPoints:f,isHovered:this.isHovered,isFocused:h,isBuiltin:n.isImmutable,fillColor:"two-up"===i?qL.color.gray50:void 0}))),b&&Oe(".code-component-badge",Oe(Xo,{icon:"code_component_badge"})),v&&Oe(".component-name",m),r&&Oe(tT,{hasAccess:Oj.business.hasProFeature("pro-fonts")}),a,y])}},mG={"four-up":new It(36),"one-up":new It(36),"one-up-compact":new It(36,24),"two-up":new It(72)},gG=e=>{Vo({view:()=>"Drag onto canvas ",spawnFrom:uo(e),placement:"right",className:"tooltip",offset:-8,overlay:"closeOnOutsidePointerDown"})},vG={view({attrs:{insertionIndex:e}}){var t;if(!(Oj.definitionDrag instanceof NW))return;const n=Oj.definitionDrag.definition;if(!(n instanceof vb||n instanceof yb)||n.isImmutable)return;const i=Oj.project.components.indexOf(n);if(e===i||e===i+1)return;const r=eo({hovered:(null==(t=Oj.definitionDrag)?void 0:t.hoveredInsertionIndex)===e});return Oe(".component-reorder-hit-target",{className:r,onpointerenter:()=>{Oj.definitionDrag instanceof NW&&(Oj.definitionDrag.hoveredInsertionIndex=e)},onpointerleave:()=>{Oj.definitionDrag instanceof NW&&(Oj.definitionDrag.hoveredInsertionIndex=void 0)}})}};var yG="top",bG="bottom",wG="right",xG="left",CG="auto",SG=[yG,bG,wG,xG],kG="start",LG="end",EG="viewport",PG="popper",TG=SG.reduce(function(e,t){return e.concat([t+"-"+kG,t+"-"+LG])},[]),AG=[].concat(SG,[CG]).reduce(function(e,t){return e.concat([t,t+"-"+kG,t+"-"+LG])},[]),MG=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function IG(e){return e?(e.nodeName||"").toLowerCase():null}function _G(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function OG(e){return e instanceof _G(e).Element||e instanceof Element}function NG(e){return e instanceof _G(e).HTMLElement||e instanceof HTMLElement}function DG(e){return"undefined"!=typeof ShadowRoot&&(e instanceof _G(e).ShadowRoot||e instanceof ShadowRoot)}const RG={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach(function(e){var n=t.styles[e]||{},i=t.attributes[e]||{},r=t.elements[e];NG(r)&&IG(r)&&(Object.assign(r.style,n),Object.keys(i).forEach(function(e){var t=i[e];!1===t?r.removeAttribute(e):r.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(e){var i=t.elements[e],r=t.attributes[e]||{},s=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce(function(e,t){return e[t]="",e},{});NG(i)&&IG(i)&&(Object.assign(i.style,s),Object.keys(r).forEach(function(e){i.removeAttribute(e)}))})}},requires:["computeStyles"]};function FG(e){return e.split("-")[0]}var BG=Math.max,VG=Math.min,jG=Math.round;function HG(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function UG(){return!/^((?!chrome|android).)*safari/i.test(HG())}function zG(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=e.getBoundingClientRect(),r=1,s=1;t&&NG(e)&&(r=e.offsetWidth>0&&jG(i.width)/e.offsetWidth||1,s=e.offsetHeight>0&&jG(i.height)/e.offsetHeight||1);var o=(OG(e)?_G(e):window).visualViewport,a=!UG()&&n,l=(i.left+(a&&o?o.offsetLeft:0))/r,c=(i.top+(a&&o?o.offsetTop:0))/s,h=i.width/r,u=i.height/s;return{width:h,height:u,top:c,right:l+h,bottom:c+u,left:l,x:l,y:c}}function WG(e){var t=zG(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}function GG(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&DG(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function $G(e){return _G(e).getComputedStyle(e)}function ZG(e){return["table","td","th"].indexOf(IG(e))>=0}function qG(e){return((OG(e)?e.ownerDocument:e.document)||window.document).documentElement}function KG(e){return"html"===IG(e)?e:e.assignedSlot||e.parentNode||(DG(e)?e.host:null)||qG(e)}function YG(e){return NG(e)&&"fixed"!==$G(e).position?e.offsetParent:null}function XG(e){for(var t=_G(e),n=YG(e);n&&ZG(n)&&"static"===$G(n).position;)n=YG(n);return n&&("html"===IG(n)||"body"===IG(n)&&"static"===$G(n).position)?t:n||function(e){var t=/firefox/i.test(HG());if(/Trident/i.test(HG())&&NG(e)&&"fixed"===$G(e).position)return null;var n=KG(e);for(DG(n)&&(n=n.host);NG(n)&&["html","body"].indexOf(IG(n))<0;){var i=$G(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(e)||t}function JG(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function QG(e,t,n){return BG(e,VG(t,n))}function e$(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function t$(e,t){return t.reduce(function(t,n){return t[n]=e,t},{})}const n$={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,i=e.name,r=e.options,s=n.elements.arrow,o=n.modifiersData.popperOffsets,a=FG(n.placement),l=JG(a),c=[xG,wG].indexOf(a)>=0?"height":"width";if(s&&o){var h=function(e,t){return e$("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:t$(e,SG))}(r.padding,n),u=WG(s),d="y"===l?yG:xG,p="y"===l?bG:wG,f=n.rects.reference[c]+n.rects.reference[l]-o[l]-n.rects.popper[c],m=o[l]-n.rects.reference[l],g=XG(s),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=f/2-m/2,b=h[d],w=v-u[c]-h[p],x=v/2-u[c]/2+y,C=QG(b,x,w),S=l;n.modifiersData[i]=((t={})[S]=C,t.centerOffset=C-x,t)}},effect:function(e){var t=e.state,n=e.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!=typeof i||(i=t.elements.popper.querySelector(i)))&&GG(t.elements.popper,i)&&(t.elements.arrow=i)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function i$(e){return e.split("-")[1]}var r$={top:"auto",right:"auto",bottom:"auto",left:"auto"};function s$(e){var t,n=e.popper,i=e.popperRect,r=e.placement,s=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,h=e.roundOffsets,u=e.isFixed,d=o.x,p=void 0===d?0:d,f=o.y,m=void 0===f?0:f,g="function"==typeof h?h({x:p,y:m}):{x:p,y:m};p=g.x,m=g.y;var v=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),b=xG,w=yG,x=window;if(c){var C=XG(n),S="clientHeight",k="clientWidth";if(C===_G(n)&&"static"!==$G(C=qG(n)).position&&"absolute"===a&&(S="scrollHeight",k="scrollWidth"),r===yG||(r===xG||r===wG)&&s===LG)w=bG,m-=(u&&C===x&&x.visualViewport?x.visualViewport.height:C[S])-i.height,m*=l?1:-1;if(r===xG||(r===yG||r===bG)&&s===LG)b=wG,p-=(u&&C===x&&x.visualViewport?x.visualViewport.width:C[k])-i.width,p*=l?1:-1}var L,E=Object.assign({position:a},c&&r$),P=!0===h?function(e,t){var n=e.x,i=e.y,r=t.devicePixelRatio||1;return{x:jG(n*r)/r||0,y:jG(i*r)/r||0}}({x:p,y:m},_G(n)):{x:p,y:m};return p=P.x,m=P.y,l?Object.assign({},E,((L={})[w]=y?"0":"",L[b]=v?"0":"",L.transform=(x.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",L)):Object.assign({},E,((t={})[w]=y?m+"px":"",t[b]=v?p+"px":"",t.transform="",t))}var o$={passive:!0};var a$={left:"right",right:"left",bottom:"top",top:"bottom"};function l$(e){return e.replace(/left|right|bottom|top/g,function(e){return a$[e]})}var c$={start:"end",end:"start"};function h$(e){return e.replace(/start|end/g,function(e){return c$[e]})}function u$(e){var t=_G(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function d$(e){return zG(qG(e)).left+u$(e).scrollLeft}function p$(e){var t=$G(e),n=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function f$(e){return["html","body","#document"].indexOf(IG(e))>=0?e.ownerDocument.body:NG(e)&&p$(e)?e:f$(KG(e))}function m$(e,t){var n;void 0===t&&(t=[]);var i=f$(e),r=i===(null==(n=e.ownerDocument)?void 0:n.body),s=_G(i),o=r?[s].concat(s.visualViewport||[],p$(i)?i:[]):i,a=t.concat(o);return r?a:a.concat(m$(KG(o)))}function g$(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function v$(e,t,n){return t===EG?g$(function(e,t){var n=_G(e),i=qG(e),r=n.visualViewport,s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;var c=UG();(c||!c&&"fixed"===t)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a+d$(e),y:l}}(e,n)):OG(t)?function(e,t){var n=zG(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):g$(function(e){var t,n=qG(e),i=u$(e),r=null==(t=e.ownerDocument)?void 0:t.body,s=BG(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=BG(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+d$(e),l=-i.scrollTop;return"rtl"===$G(r||n).direction&&(a+=BG(n.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(qG(e)))}function y$(e,t,n,i){var r="clippingParents"===t?function(e){var t=m$(KG(e)),n=["absolute","fixed"].indexOf($G(e).position)>=0&&NG(e)?XG(e):e;return OG(n)?t.filter(function(e){return OG(e)&&GG(e,n)&&"body"!==IG(e)}):[]}(e):[].concat(t),s=[].concat(r,[n]),o=s[0],a=s.reduce(function(t,n){var r=v$(e,n,i);return t.top=BG(r.top,t.top),t.right=VG(r.right,t.right),t.bottom=VG(r.bottom,t.bottom),t.left=BG(r.left,t.left),t},v$(e,o,i));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function b$(e){var t,n=e.reference,i=e.element,r=e.placement,s=r?FG(r):null,o=r?i$(r):null,a=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(s){case yG:t={x:a,y:n.y-i.height};break;case bG:t={x:a,y:n.y+n.height};break;case wG:t={x:n.x+n.width,y:l};break;case xG:t={x:n.x-i.width,y:l};break;default:t={x:n.x,y:n.y}}var c=s?JG(s):null;if(null!=c){var h="y"===c?"height":"width";switch(o){case kG:t[c]=t[c]-(n[h]/2-i[h]/2);break;case LG:t[c]=t[c]+(n[h]/2-i[h]/2)}}return t}function w$(e,t){void 0===t&&(t={});var n=t,i=n.placement,r=void 0===i?e.placement:i,s=n.strategy,o=void 0===s?e.strategy:s,a=n.boundary,l=void 0===a?"clippingParents":a,c=n.rootBoundary,h=void 0===c?EG:c,u=n.elementContext,d=void 0===u?PG:u,p=n.altBoundary,f=void 0!==p&&p,m=n.padding,g=void 0===m?0:m,v=e$("number"!=typeof g?g:t$(g,SG)),y=d===PG?"reference":PG,b=e.rects.popper,w=e.elements[f?y:d],x=y$(OG(w)?w:w.contextElement||qG(e.elements.popper),l,h,o),C=zG(e.elements.reference),S=b$({reference:C,element:b,placement:r}),k=g$(Object.assign({},b,S)),L=d===PG?k:C,E={top:x.top-L.top+v.top,bottom:L.bottom-x.bottom+v.bottom,left:x.left-L.left+v.left,right:L.right-x.right+v.right},P=e.modifiersData.offset;if(d===PG&&P){var T=P[r];Object.keys(E).forEach(function(e){var t=[wG,bG].indexOf(e)>=0?1:-1,n=[yG,bG].indexOf(e)>=0?"y":"x";E[e]+=T[n]*t})}return E}const x$={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var r=n.mainAxis,s=void 0===r||r,o=n.altAxis,a=void 0===o||o,l=n.fallbackPlacements,c=n.padding,h=n.boundary,u=n.rootBoundary,d=n.altBoundary,p=n.flipVariations,f=void 0===p||p,m=n.allowedAutoPlacements,g=t.options.placement,v=FG(g),y=l||(v===g||!f?[l$(g)]:function(e){if(FG(e)===CG)return[];var t=l$(e);return[h$(e),t,h$(t)]}(g)),b=[g].concat(y).reduce(function(e,n){return e.concat(FG(n)===CG?function(e,t){void 0===t&&(t={});var n=t,i=n.placement,r=n.boundary,s=n.rootBoundary,o=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?AG:l,h=i$(i),u=h?a?TG:TG.filter(function(e){return i$(e)===h}):SG,d=u.filter(function(e){return c.indexOf(e)>=0});0===d.length&&(d=u);var p=d.reduce(function(t,n){return t[n]=w$(e,{placement:n,boundary:r,rootBoundary:s,padding:o})[FG(n)],t},{});return Object.keys(p).sort(function(e,t){return p[e]-p[t]})}(t,{placement:n,boundary:h,rootBoundary:u,padding:c,flipVariations:f,allowedAutoPlacements:m}):n)},[]),w=t.rects.reference,x=t.rects.popper,C=new Map,S=!0,k=b[0],L=0;L<b.length;L++){var E=b[L],P=FG(E),T=i$(E)===kG,A=[yG,bG].indexOf(P)>=0,M=A?"width":"height",I=w$(t,{placement:E,boundary:h,rootBoundary:u,altBoundary:d,padding:c}),_=A?T?wG:xG:T?bG:yG;w[M]>x[M]&&(_=l$(_));var O=l$(_),N=[];if(s&&N.push(I[P]<=0),a&&N.push(I[_]<=0,I[O]<=0),N.every(function(e){return e})){k=E,S=!1;break}C.set(E,N)}if(S)for(var D=function(e){var t=b.find(function(t){var n=C.get(t);if(n)return n.slice(0,e).every(function(e){return e})});if(t)return k=t,"break"},R=f?3:1;R>0;R--){if("break"===D(R))break}t.placement!==k&&(t.modifiersData[i]._skip=!0,t.placement=k,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function C$(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function S$(e){return[yG,wG,bG,xG].some(function(t){return e[t]>=0})}const k$={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,i=t.rects.reference,r=t.rects.popper,s=t.modifiersData.preventOverflow,o=w$(t,{elementContext:"reference"}),a=w$(t,{altBoundary:!0}),l=C$(o,i),c=C$(a,r,s),h=S$(l),u=S$(c);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:u},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":u})}};const L$={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,i=e.name,r=n.offset,s=void 0===r?[0,0]:r,o=AG.reduce(function(e,n){return e[n]=function(e,t,n){var i=FG(e),r=[xG,yG].indexOf(i)>=0?-1:1,s="function"==typeof n?n(Object.assign({},t,{placement:e})):n,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[xG,wG].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}(n,t.rects,s),e},{}),a=o[t.placement],l=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[i]=o}};const E$={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=b$({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})},data:{}};const P$={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name,r=n.mainAxis,s=void 0===r||r,o=n.altAxis,a=void 0!==o&&o,l=n.boundary,c=n.rootBoundary,h=n.altBoundary,u=n.padding,d=n.tether,p=void 0===d||d,f=n.tetherOffset,m=void 0===f?0:f,g=w$(t,{boundary:l,rootBoundary:c,padding:u,altBoundary:h}),v=FG(t.placement),y=i$(t.placement),b=!y,w=JG(v),x="x"===w?"y":"x",C=t.modifiersData.popperOffsets,S=t.rects.reference,k=t.rects.popper,L="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,E="number"==typeof L?{mainAxis:L,altAxis:L}:Object.assign({mainAxis:0,altAxis:0},L),P=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(C){if(s){var A,M="y"===w?yG:xG,I="y"===w?bG:wG,_="y"===w?"height":"width",O=C[w],N=O+g[M],D=O-g[I],R=p?-k[_]/2:0,F=y===kG?S[_]:k[_],B=y===kG?-k[_]:-S[_],V=t.elements.arrow,j=p&&V?WG(V):{width:0,height:0},H=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},U=H[M],z=H[I],W=QG(0,S[_],j[_]),G=b?S[_]/2-R-W-U-E.mainAxis:F-W-U-E.mainAxis,$=b?-S[_]/2+R+W+z+E.mainAxis:B+W+z+E.mainAxis,Z=t.elements.arrow&&XG(t.elements.arrow),q=Z?"y"===w?Z.clientTop||0:Z.clientLeft||0:0,K=null!=(A=null==P?void 0:P[w])?A:0,Y=O+$-K,X=QG(p?VG(N,O+G-K-q):N,O,p?BG(D,Y):D);C[w]=X,T[w]=X-O}if(a){var J,Q="x"===w?yG:xG,ee="x"===w?bG:wG,te=C[x],ne="y"===x?"height":"width",ie=te+g[Q],re=te-g[ee],se=-1!==[yG,xG].indexOf(v),oe=null!=(J=null==P?void 0:P[x])?J:0,ae=se?ie:te-S[ne]-k[ne]-oe+E.altAxis,le=se?te+S[ne]+k[ne]-oe-E.altAxis:re,ce=p&&se?(ue=QG(ae,te,he=le))>he?he:ue:QG(p?ae:ie,te,p?le:re);C[x]=ce,T[x]=ce-te}var he,ue;t.modifiersData[i]=T}},requiresIfExists:["offset"]};function T$(e,t,n){void 0===n&&(n=!1);var i,r,s=NG(t),o=NG(t)&&function(e){var t=e.getBoundingClientRect(),n=jG(t.width)/e.offsetWidth||1,i=jG(t.height)/e.offsetHeight||1;return 1!==n||1!==i}(t),a=qG(t),l=zG(e,o,n),c={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(s||!s&&!n)&&(("body"!==IG(t)||p$(a))&&(c=(i=t)!==_G(i)&&NG(i)?{scrollLeft:(r=i).scrollLeft,scrollTop:r.scrollTop}:u$(i)),NG(t)?((h=zG(t,!0)).x+=t.clientLeft,h.y+=t.clientTop):a&&(h.x=d$(a))),{x:l.left+c.scrollLeft-h.x,y:l.top+c.scrollTop-h.y,width:l.width,height:l.height}}function A$(e){var t=new Map,n=new Set,i=[];function r(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){if(!n.has(e)){var i=t.get(e);i&&r(i)}}),i.push(e)}return e.forEach(function(e){t.set(e.name,e)}),e.forEach(function(e){n.has(e.name)||r(e)}),i}var M$={placement:"bottom",modifiers:[],strategy:"absolute"};function I$(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}function _$(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,i=void 0===n?[]:n,r=t.defaultOptions,s=void 0===r?M$:r;return function(e,t,n){void 0===n&&(n=s);var r,o,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},M$,s),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],c=!1,h={state:a,setOptions:function(n){var r="function"==typeof n?n(a.options):n;u(),a.options=Object.assign({},s,a.options,r),a.scrollParents={reference:OG(e)?m$(e):e.contextElement?m$(e.contextElement):[],popper:m$(t)};var o,c,d=function(e){var t=A$(e);return MG.reduce(function(e,n){return e.concat(t.filter(function(e){return e.phase===n}))},[])}((o=[].concat(i,a.options.modifiers),c=o.reduce(function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e},{}),Object.keys(c).map(function(e){return c[e]})));return a.orderedModifiers=d.filter(function(e){return e.enabled}),a.orderedModifiers.forEach(function(e){var t=e.name,n=e.options,i=void 0===n?{}:n,r=e.effect;if("function"==typeof r){var s=r({state:a,name:t,instance:h,options:i}),o=function(){};l.push(s||o)}}),h.update()},forceUpdate:function(){if(!c){var e=a.elements,t=e.reference,n=e.popper;if(I$(t,n)){a.rects={reference:T$(t,XG(n),"fixed"===a.options.strategy),popper:WG(n)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach(function(e){return a.modifiersData[e.name]=Object.assign({},e.data)});for(var i=0;i<a.orderedModifiers.length;i++)if(!0!==a.reset){var r=a.orderedModifiers[i],s=r.fn,o=r.options,l=void 0===o?{}:o,u=r.name;"function"==typeof s&&(a=s({state:a,options:l,name:u,instance:h})||a)}else a.reset=!1,i=-1}}},update:(r=function(){return new Promise(function(e){h.forceUpdate(),e(a)})},function(){return o||(o=new Promise(function(e){Promise.resolve().then(function(){o=void 0,e(r())})})),o}),destroy:function(){u(),c=!0}};if(!I$(e,t))return h;function u(){l.forEach(function(e){return e()}),l=[]}return h.setOptions(n).then(function(e){!c&&n.onFirstUpdate&&n.onFirstUpdate(e)}),h}}var O$=_$({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,i=e.options,r=i.scroll,s=void 0===r||r,o=i.resize,a=void 0===o||o,l=_G(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach(function(e){e.addEventListener("scroll",n.update,o$)}),a&&l.addEventListener("resize",n.update,o$),function(){s&&c.forEach(function(e){e.removeEventListener("scroll",n.update,o$)}),a&&l.removeEventListener("resize",n.update,o$)}},data:{}},E$,{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,i=n.gpuAcceleration,r=void 0===i||i,s=n.adaptive,o=void 0===s||s,a=n.roundOffsets,l=void 0===a||a,c={placement:FG(t.placement),variation:i$(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,s$(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,s$(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},RG,L$,x$,P$,n$,k$]}),N$="tippy-content",D$="tippy-arrow",R$="tippy-svg-arrow",F$={passive:!0,capture:!0},B$=function(){return document.body};function V$(e,t,n){if(Array.isArray(e)){var i=e[t];return null==i?Array.isArray(n)?n[t]:n:i}return e}function j$(e,t){var n={}.toString.call(e);return 0===n.indexOf("[object")&&n.indexOf(t+"]")>-1}function H$(e,t){return"function"==typeof e?e.apply(void 0,t):e}function U$(e,t){return 0===t?e:function(i){clearTimeout(n),n=setTimeout(function(){e(i)},t)};var n}function z$(e){return[].concat(e)}function W$(e,t){-1===e.indexOf(t)&&e.push(t)}function G$(e){return[].slice.call(e)}function $$(e){return Object.keys(e).reduce(function(t,n){return void 0!==e[n]&&(t[n]=e[n]),t},{})}function Z$(){return document.createElement("div")}function q$(e){return["Element","Fragment"].some(function(t){return j$(e,t)})}function K$(e){return q$(e)?[e]:function(e){return j$(e,"NodeList")}(e)?G$(e):Array.isArray(e)?e:G$(document.querySelectorAll(e))}function Y$(e,t){e.forEach(function(e){e&&(e.style.transitionDuration=t+"ms")})}function X$(e,t){e.forEach(function(e){e&&e.setAttribute("data-state",t)})}function J$(e,t,n){var i=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(t){e[i](t,n)})}function Q$(e,t){for(var n=t;n;){var i;if(e.contains(n))return!0;n=null==n.getRootNode||null==(i=n.getRootNode())?void 0:i.host}return!1}var eZ={isTouch:!1},tZ=0;function nZ(){eZ.isTouch||(eZ.isTouch=!0,window.performance&&document.addEventListener("mousemove",iZ))}function iZ(){var e=performance.now();e-tZ<20&&(eZ.isTouch=!1,document.removeEventListener("mousemove",iZ)),tZ=e}function rZ(){var e,t=document.activeElement;if((e=t)&&e._tippy&&e._tippy.reference===e){var n=t._tippy;t.blur&&!n.state.isVisible&&t.blur()}}var sZ=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto,oZ=Object.assign({appendTo:B$,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),aZ=Object.keys(oZ);function lZ(e){var t=(e.plugins||[]).reduce(function(t,n){var i,r=n.name,s=n.defaultValue;r&&(t[r]=void 0!==e[r]?e[r]:null!=(i=oZ[r])?i:s);return t},{});return Object.assign({},e,t)}function cZ(e,t){var n=Object.assign({},t,{content:H$(t.content,[e])},t.ignoreAttributes?{}:function(e,t){return(t?Object.keys(lZ(Object.assign({},oZ,{plugins:t}))):aZ).reduce(function(t,n){var i=(e.getAttribute("data-tippy-"+n)||"").trim();if(!i)return t;if("content"===n)t[n]=i;else try{t[n]=JSON.parse(i)}catch(r){t[n]=i}return t},{})}(e,t.plugins));return n.aria=Object.assign({},oZ.aria,n.aria),n.aria={expanded:"auto"===n.aria.expanded?t.interactive:n.aria.expanded,content:"auto"===n.aria.content?t.interactive?null:"describedby":n.aria.content},n}function hZ(e,t){e.innerHTML=t}function uZ(e){var t=Z$();return!0===e?t.className=D$:(t.className=R$,q$(e)?t.appendChild(e):hZ(t,e)),t}function dZ(e,t){q$(t.content)?(hZ(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?hZ(e,t.content):e.textContent=t.content)}function pZ(e){var t=e.firstElementChild,n=G$(t.children);return{box:t,content:n.find(function(e){return e.classList.contains(N$)}),arrow:n.find(function(e){return e.classList.contains(D$)||e.classList.contains(R$)}),backdrop:n.find(function(e){return e.classList.contains("tippy-backdrop")})}}function fZ(e){var t=Z$(),n=Z$();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var i=Z$();function r(n,i){var r=pZ(t),s=r.box,o=r.content,a=r.arrow;i.theme?s.setAttribute("data-theme",i.theme):s.removeAttribute("data-theme"),"string"==typeof i.animation?s.setAttribute("data-animation",i.animation):s.removeAttribute("data-animation"),i.inertia?s.setAttribute("data-inertia",""):s.removeAttribute("data-inertia"),s.style.maxWidth="number"==typeof i.maxWidth?i.maxWidth+"px":i.maxWidth,i.role?s.setAttribute("role",i.role):s.removeAttribute("role"),n.content===i.content&&n.allowHTML===i.allowHTML||dZ(o,e.props),i.arrow?a?n.arrow!==i.arrow&&(s.removeChild(a),s.appendChild(uZ(i.arrow))):s.appendChild(uZ(i.arrow)):a&&s.removeChild(a)}return i.className=N$,i.setAttribute("data-state","hidden"),dZ(i,e.props),t.appendChild(n),n.appendChild(i),r(e.props,e.props),{popper:t,onUpdate:r}}fZ.$$tippy=!0;var mZ=1,gZ=[],vZ=[];function yZ(e,t){var n,i,r,s,o,a,l,c,h=cZ(e,Object.assign({},oZ,lZ($$(t)))),u=!1,d=!1,p=!1,f=!1,m=[],g=U$(Z,h.interactiveDebounce),v=mZ++,y=(c=h.plugins).filter(function(e,t){return c.indexOf(e)===t}),b={id:v,reference:e,popper:Z$(),popperInstance:null,props:h,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:y,clearDelayTimeouts:function(){clearTimeout(n),clearTimeout(i),cancelAnimationFrame(r)},setProps:function(t){if(b.state.isDestroyed)return;O("onBeforeUpdate",[b,t]),G();var n=b.props,i=cZ(e,Object.assign({},n,$$(t),{ignoreAttributes:!0}));b.props=i,W(),n.interactiveDebounce!==i.interactiveDebounce&&(R(),g=U$(Z,i.interactiveDebounce));n.triggerTarget&&!i.triggerTarget?z$(n.triggerTarget).forEach(function(e){e.removeAttribute("aria-expanded")}):i.triggerTarget&&e.removeAttribute("aria-expanded");D(),_(),C&&C(n,i);b.popperInstance&&(X(),Q().forEach(function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)}));O("onAfterUpdate",[b,t])},setContent:function(e){b.setProps({content:e})},show:function(){var e=b.state.isVisible,t=b.state.isDestroyed,n=!b.state.isEnabled,i=eZ.isTouch&&!b.props.touch,r=V$(b.props.duration,0,oZ.duration);if(e||t||n||i)return;if(T().hasAttribute("disabled"))return;if(O("onShow",[b],!1),!1===b.props.onShow(b))return;b.state.isVisible=!0,P()&&(x.style.visibility="visible");_(),j(),b.state.isMounted||(x.style.transition="none");if(P()){var s=M();Y$([s.box,s.content],0)}a=function(){var e;if(b.state.isVisible&&!f){if(f=!0,x.offsetHeight,x.style.transition=b.props.moveTransition,P()&&b.props.animation){var t=M(),n=t.box,i=t.content;Y$([n,i],r),X$([n,i],"visible")}N(),D(),W$(vZ,b),null==(e=b.popperInstance)||e.forceUpdate(),O("onMount",[b]),b.props.animation&&P()&&function(e,t){U(e,t)}(r,function(){b.state.isShown=!0,O("onShown",[b])})}},function(){var e,t=b.props.appendTo,n=T();e=b.props.interactive&&t===B$||"parent"===t?n.parentNode:H$(t,[n]);e.contains(x)||e.appendChild(x);b.state.isMounted=!0,X()}()},hide:function(){var e=!b.state.isVisible,t=b.state.isDestroyed,n=!b.state.isEnabled,i=V$(b.props.duration,1,oZ.duration);if(e||t||n)return;if(O("onHide",[b],!1),!1===b.props.onHide(b))return;b.state.isVisible=!1,b.state.isShown=!1,f=!1,u=!1,P()&&(x.style.visibility="hidden");if(R(),H(),_(!0),P()){var r=M(),s=r.box,o=r.content;b.props.animation&&(Y$([s,o],i),X$([s,o],"hidden"))}N(),D(),b.props.animation?P()&&function(e,t){U(e,function(){!b.state.isVisible&&x.parentNode&&x.parentNode.contains(x)&&t()})}(i,b.unmount):b.unmount()},hideWithInteractivity:function(e){A().addEventListener("mousemove",g),W$(gZ,g),g(e)},enable:function(){b.state.isEnabled=!0},disable:function(){b.hide(),b.state.isEnabled=!1},unmount:function(){b.state.isVisible&&b.hide();if(!b.state.isMounted)return;J(),Q().forEach(function(e){e._tippy.unmount()}),x.parentNode&&x.parentNode.removeChild(x);vZ=vZ.filter(function(e){return e!==b}),b.state.isMounted=!1,O("onHidden",[b])},destroy:function(){if(b.state.isDestroyed)return;b.clearDelayTimeouts(),b.unmount(),G(),delete e._tippy,b.state.isDestroyed=!0,O("onDestroy",[b])}};if(!h.render)return b;var w=h.render(b),x=w.popper,C=w.onUpdate;x.setAttribute("data-tippy-root",""),x.id="tippy-"+b.id,b.popper=x,e._tippy=b,x._tippy=b;var S=y.map(function(e){return e.fn(b)}),k=e.hasAttribute("aria-expanded");return W(),D(),_(),O("onCreate",[b]),h.showOnCreate&&ee(),x.addEventListener("mouseenter",function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()}),x.addEventListener("mouseleave",function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&A().addEventListener("mousemove",g)}),b;function L(){var e=b.props.touch;return Array.isArray(e)?e:[e,0]}function E(){return"hold"===L()[0]}function P(){var e;return!(null==(e=b.props.render)||!e.$$tippy)}function T(){return l||e}function A(){var e,t,n=T().parentNode;return n?null!=(t=z$(n)[0])&&null!=(e=t.ownerDocument)&&e.body?t.ownerDocument:document:document}function M(){return pZ(x)}function I(e){return b.state.isMounted&&!b.state.isVisible||eZ.isTouch||s&&"focus"===s.type?0:V$(b.props.delay,e?0:1,oZ.delay)}function _(e){void 0===e&&(e=!1),x.style.pointerEvents=b.props.interactive&&!e?"":"none",x.style.zIndex=""+b.props.zIndex}function O(e,t,n){var i;(void 0===n&&(n=!0),S.forEach(function(n){n[e]&&n[e].apply(n,t)}),n)&&(i=b.props)[e].apply(i,t)}function N(){var t=b.props.aria;if(t.content){var n="aria-"+t.content,i=x.id;z$(b.props.triggerTarget||e).forEach(function(e){var t=e.getAttribute(n);if(b.state.isVisible)e.setAttribute(n,t?t+" "+i:i);else{var r=t&&t.replace(i,"").trim();r?e.setAttribute(n,r):e.removeAttribute(n)}})}}function D(){!k&&b.props.aria.expanded&&z$(b.props.triggerTarget||e).forEach(function(e){b.props.interactive?e.setAttribute("aria-expanded",b.state.isVisible&&e===T()?"true":"false"):e.removeAttribute("aria-expanded")})}function R(){A().removeEventListener("mousemove",g),gZ=gZ.filter(function(e){return e!==g})}function F(t){if(!eZ.isTouch||!p&&"mousedown"!==t.type){var n=t.composedPath&&t.composedPath()[0]||t.target;if(!b.props.interactive||!Q$(x,n)){if(z$(b.props.triggerTarget||e).some(function(e){return Q$(e,n)})){if(eZ.isTouch)return;if(b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else O("onClickOutside",[b,t]);!0===b.props.hideOnClick&&(b.clearDelayTimeouts(),b.hide(),d=!0,setTimeout(function(){d=!1}),b.state.isMounted||H())}}}function B(){p=!0}function V(){p=!1}function j(){var e=A();e.addEventListener("mousedown",F,!0),e.addEventListener("touchend",F,F$),e.addEventListener("touchstart",V,F$),e.addEventListener("touchmove",B,F$)}function H(){var e=A();e.removeEventListener("mousedown",F,!0),e.removeEventListener("touchend",F,F$),e.removeEventListener("touchstart",V,F$),e.removeEventListener("touchmove",B,F$)}function U(e,t){var n=M().box;function i(e){e.target===n&&(J$(n,"remove",i),t())}if(0===e)return t();J$(n,"remove",o),J$(n,"add",i),o=i}function z(t,n,i){void 0===i&&(i=!1),z$(b.props.triggerTarget||e).forEach(function(e){e.addEventListener(t,n,i),m.push({node:e,eventType:t,handler:n,options:i})})}function W(){var e;E()&&(z("touchstart",$,{passive:!0}),z("touchend",q,{passive:!0})),(e=b.props.trigger,e.split(/\s+/).filter(Boolean)).forEach(function(e){if("manual"!==e)switch(z(e,$),e){case"mouseenter":z("mouseleave",q);break;case"focus":z(sZ?"focusout":"blur",K);break;case"focusin":z("focusout",K)}})}function G(){m.forEach(function(e){var t=e.node,n=e.eventType,i=e.handler,r=e.options;t.removeEventListener(n,i,r)}),m=[]}function $(e){var t,n=!1;if(b.state.isEnabled&&!Y(e)&&!d){var i="focus"===(null==(t=s)?void 0:t.type);s=e,l=e.currentTarget,D(),!b.state.isVisible&&j$(e,"MouseEvent")&&gZ.forEach(function(t){return t(e)}),"click"===e.type&&(b.props.trigger.indexOf("mouseenter")<0||u)&&!1!==b.props.hideOnClick&&b.state.isVisible?n=!0:ee(e),"click"===e.type&&(u=!n),n&&!i&&te(e)}}function Z(e){var t=e.target,n=T().contains(t)||x.contains(t);"mousemove"===e.type&&n||function(e,t){var n=t.clientX,i=t.clientY;return e.every(function(e){var t=e.popperRect,r=e.popperState,s=e.props.interactiveBorder,o=r.placement.split("-")[0],a=r.modifiersData.offset;if(!a)return!0;var l="bottom"===o?a.top.y:0,c="top"===o?a.bottom.y:0,h="right"===o?a.left.x:0,u="left"===o?a.right.x:0,d=t.top-i+l>s,p=i-t.bottom-c>s,f=t.left-n+h>s,m=n-t.right-u>s;return d||p||f||m})}(Q().concat(x).map(function(e){var t,n=null==(t=e._tippy.popperInstance)?void 0:t.state;return n?{popperRect:e.getBoundingClientRect(),popperState:n,props:h}:null}).filter(Boolean),e)&&(R(),te(e))}function q(e){Y(e)||b.props.trigger.indexOf("click")>=0&&u||(b.props.interactive?b.hideWithInteractivity(e):te(e))}function K(e){b.props.trigger.indexOf("focusin")<0&&e.target!==T()||b.props.interactive&&e.relatedTarget&&x.contains(e.relatedTarget)||te(e)}function Y(e){return!!eZ.isTouch&&E()!==e.type.indexOf("touch")>=0}function X(){J();var t=b.props,n=t.popperOptions,i=t.placement,r=t.offset,s=t.getReferenceClientRect,o=t.moveTransition,l=P()?pZ(x).arrow:null,c=s?{getBoundingClientRect:s,contextElement:s.contextElement||T()}:e,h=[{name:"offset",options:{offset:r}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!o}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(P()){var n=M().box;["placement","reference-hidden","escaped"].forEach(function(e){"placement"===e?n.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?n.setAttribute("data-"+e,""):n.removeAttribute("data-"+e)}),t.attributes.popper={}}}}];P()&&l&&h.push({name:"arrow",options:{element:l,padding:3}}),h.push.apply(h,(null==n?void 0:n.modifiers)||[]),b.popperInstance=O$(c,x,Object.assign({},n,{placement:i,onFirstUpdate:a,modifiers:h}))}function J(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Q(){return G$(x.querySelectorAll("[data-tippy-root]"))}function ee(e){b.clearDelayTimeouts(),e&&O("onTrigger",[b,e]),j();var t=I(!0),i=L(),r=i[0],s=i[1];eZ.isTouch&&"hold"===r&&s&&(t=s),t?n=setTimeout(function(){b.show()},t):b.show()}function te(e){if(b.clearDelayTimeouts(),O("onUntrigger",[b,e]),b.state.isVisible){if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(e.type)>=0&&u)){var t=I(!1);t?i=setTimeout(function(){b.state.isVisible&&b.hide()},t):r=requestAnimationFrame(function(){b.hide()})}}else H()}}function bZ(e,t){void 0===t&&(t={});var n=oZ.plugins.concat(t.plugins||[]);document.addEventListener("touchstart",nZ,F$),window.addEventListener("blur",rZ);var i=Object.assign({},t,{plugins:n}),r=K$(e).reduce(function(e,t){var n=t&&yZ(t,i);return n&&e.push(n),e},[]);return q$(e)?r[0]:r}bZ.defaultProps=oZ,bZ.setDefaultProps=function(e){Object.keys(e).forEach(function(t){oZ[t]=e[t]})},bZ.currentInput=eZ,Object.assign({},RG,{effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow)}}),bZ.setDefaultProps({render:fZ});class wZ{constructor({editor:e,element:t,view:n,tippyOptions:i={},updateDelay:r=250,shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:e,state:t,from:n,to:i})=>{const{doc:r,selection:s}=t,{empty:o}=s,a=!r.textBetween(n,i).length&&NR(t.selection),l=this.element.contains(document.activeElement);return!(!e.hasFocus()&&!l||o||a||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:e})=>{var t;this.preventHide?this.preventHide=!1:(null==e?void 0:e.relatedTarget)&&(null===(t=this.element.parentNode)||void 0===t?void 0:t.contains(e.relatedTarget))||this.hide()},this.tippyBlurHandler=e=>{this.blurHandler({event:e})},this.handleDebouncedUpdate=(e,t)=>{const n=!(null==t?void 0:t.selection.eq(e.state.selection)),i=!(null==t?void 0:t.doc.eq(e.state.doc));(n||i)&&(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(e,n,i,t)},this.updateDelay))},this.updateHandler=(e,t,n,i)=>{var r,s,o;const{state:a,composing:l}=e,{selection:c}=a;if(l||!t&&!n)return;this.createTooltip();const{ranges:h}=c,u=Math.min(...h.map(e=>e.$from.pos)),d=Math.max(...h.map(e=>e.$to.pos));(null===(r=this.shouldShow)||void 0===r?void 0:r.call(this,{editor:this.editor,view:e,state:a,oldState:i,from:u,to:d}))?(null===(s=this.tippy)||void 0===s||s.setProps({getReferenceClientRect:(null===(o=this.tippyOptions)||void 0===o?void 0:o.getReferenceClientRect)||(()=>{if(tF(a.selection)){let t=e.nodeDOM(u);const n=t.dataset.nodeViewWrapper?t:t.querySelector("[data-node-view-wrapper]");if(n&&(t=n.firstChild),t)return t.getBoundingClientRect()}return nF(e,u,d)})}),this.show()):this.hide()},this.editor=e,this.element=t,this.view=n,this.updateDelay=r,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;!this.tippy&&t&&(this.tippy=bZ(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){const{state:n}=e,i=n.selection.from!==n.selection.to;if(this.updateDelay>0&&i)return void this.handleDebouncedUpdate(e,t);const r=!(null==t?void 0:t.selection.eq(e.state.selection)),s=!(null==t?void 0:t.doc.eq(e.state.doc));this.updateHandler(e,r,s,t)}show(){var e;null===(e=this.tippy)||void 0===e||e.show()}hide(){var e;null===(e=this.tippy)||void 0===e||e.hide()}destroy(){var e,t;(null===(e=this.tippy)||void 0===e?void 0:e.popper.firstChild)&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),null===(t=this.tippy)||void 0===t||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const xZ=LR.create({name:"bubbleMenu",addOptions:()=>({element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[(e={pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow},new n_({key:"string"==typeof e.pluginKey?new s_(e.pluginKey):e.pluginKey,view:t=>new wZ({view:t,...e})}))]:[];var e}});class CZ{constructor({editor:e,element:t,view:n,tippyOptions:i={},shouldShow:r}){this.preventHide=!1,this.shouldShow=({view:e,state:t})=>{const{selection:n}=t,{$anchor:i,empty:r}=n,s=1===i.depth,o=i.parent.isTextblock&&!i.parent.type.spec.code&&!i.parent.textContent;return!!(e.hasFocus()&&r&&s&&o&&this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:e})=>{var t;this.preventHide?this.preventHide=!1:(null==e?void 0:e.relatedTarget)&&(null===(t=this.element.parentNode)||void 0===t?void 0:t.contains(e.relatedTarget))||this.hide()},this.tippyBlurHandler=e=>{this.blurHandler({event:e})},this.editor=e,this.element=t,this.view=n,r&&(this.shouldShow=r),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;!this.tippy&&t&&(this.tippy=bZ(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){var n,i,r;const{state:s}=e,{doc:o,selection:a}=s,{from:l,to:c}=a;if(t&&t.doc.eq(o)&&t.selection.eq(a))return;this.createTooltip();(null===(n=this.shouldShow)||void 0===n?void 0:n.call(this,{editor:this.editor,view:e,state:s,oldState:t}))?(null===(i=this.tippy)||void 0===i||i.setProps({getReferenceClientRect:(null===(r=this.tippyOptions)||void 0===r?void 0:r.getReferenceClientRect)||(()=>nF(e,l,c))}),this.show()):this.hide()}show(){var e;null===(e=this.tippy)||void 0===e||e.show()}hide(){var e;null===(e=this.tippy)||void 0===e||e.hide()}destroy(){var e,t;(null===(e=this.tippy)||void 0===e?void 0:e.popper.firstChild)&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),null===(t=this.tippy)||void 0===t||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const SZ=LR.create({name:"floatingMenu",addOptions:()=>({element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[(e={pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow},new n_({key:"string"==typeof e.pluginKey?new s_(e.pluginKey):e.pluginKey,view:t=>new CZ({view:t,...e})}))]:[];var e}}),kZ="numeric",LZ="ascii",EZ="alpha",PZ="asciinumeric",TZ="alphanumeric",AZ="domain",MZ="emoji",IZ="scheme",_Z="slashscheme",OZ="whitespace";function NZ(e,t){return e in t||(t[e]=[]),t[e]}function DZ(e,t,n){t[kZ]&&(t[PZ]=!0,t[TZ]=!0),t[LZ]&&(t[PZ]=!0,t[EZ]=!0),t[PZ]&&(t[TZ]=!0),t[EZ]&&(t[TZ]=!0),t[TZ]&&(t[AZ]=!0),t[MZ]&&(t[AZ]=!0);for(const i in t){const t=NZ(i,n);t.indexOf(e)<0&&t.push(e)}}function RZ(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}RZ.groups={},RZ.prototype={accepts(){return!!this.t},go(e){const t=this,n=t.j[e];if(n)return n;for(let i=0;i<t.jr.length;i++){const n=t.jr[i][0],r=t.jr[i][1];if(r&&n.test(e))return r}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,n,i){for(let r=0;r<e.length;r++)this.tt(e[r],t,n,i)},tr(e,t,n,i){let r;return i=i||RZ.groups,t&&t.j?r=t:(r=new RZ(t),n&&i&&DZ(t,n,i)),this.jr.push([e,r]),r},ts(e,t,n,i){let r=this;const s=e.length;if(!s)return r;for(let o=0;o<s-1;o++)r=r.tt(e[o]);return r.tt(e[s-1],t,n,i)},tt(e,t,n,i){i=i||RZ.groups;const r=this;if(t&&t.j)return r.j[e]=t,t;const s=t;let o,a=r.go(e);if(a?(o=new RZ,Object.assign(o.j,a.j),o.jr.push.apply(o.jr,a.jr),o.jd=a.jd,o.t=a.t):o=new RZ,s){if(i)if(o.t&&"string"==typeof o.t){const e=Object.assign(function(e,t){const n={};for(const i in t)t[i].indexOf(e)>=0&&(n[i]=!0);return n}(o.t,i),n);DZ(s,e,i)}else n&&DZ(s,n,i);o.t=s}return r.j[e]=o,o}};const FZ=(e,t,n,i,r)=>e.ta(t,n,i,r),BZ=(e,t,n,i,r)=>e.tr(t,n,i,r),VZ=(e,t,n,i,r)=>e.ts(t,n,i,r),jZ=(e,t,n,i,r)=>e.tt(t,n,i,r),HZ="WORD",UZ="UWORD",zZ="ASCIINUMERICAL",WZ="ALPHANUMERICAL",GZ="LOCALHOST",$Z="TLD",ZZ="UTLD",qZ="SCHEME",KZ="SLASH_SCHEME",YZ="NUM",XZ="WS",JZ="NL",QZ="OPENBRACE",eq="CLOSEBRACE",tq="OPENBRACKET",nq="CLOSEBRACKET",iq="OPENPAREN",rq="CLOSEPAREN",sq="OPENANGLEBRACKET",oq="CLOSEANGLEBRACKET",aq="FULLWIDTHLEFTPAREN",lq="FULLWIDTHRIGHTPAREN",cq="LEFTCORNERBRACKET",hq="RIGHTCORNERBRACKET",uq="LEFTWHITECORNERBRACKET",dq="RIGHTWHITECORNERBRACKET",pq="FULLWIDTHLESSTHAN",fq="FULLWIDTHGREATERTHAN",mq="AMPERSAND",gq="APOSTROPHE",vq="ASTERISK",yq="AT",bq="BACKSLASH",wq="BACKTICK",xq="CARET",Cq="COLON",Sq="COMMA",kq="DOLLAR",Lq="DOT",Eq="EQUALS",Pq="EXCLAMATION",Tq="HYPHEN",Aq="PERCENT",Mq="PIPE",Iq="PLUS",_q="POUND",Oq="QUERY",Nq="QUOTE",Dq="FULLWIDTHMIDDLEDOT",Rq="SEMI",Fq="SLASH",Bq="TILDE",Vq="UNDERSCORE",jq="EMOJI",Hq="SYM";var Uq=Object.freeze({__proto__:null,ALPHANUMERICAL:WZ,AMPERSAND:mq,APOSTROPHE:gq,ASCIINUMERICAL:zZ,ASTERISK:vq,AT:yq,BACKSLASH:bq,BACKTICK:wq,CARET:xq,CLOSEANGLEBRACKET:oq,CLOSEBRACE:eq,CLOSEBRACKET:nq,CLOSEPAREN:rq,COLON:Cq,COMMA:Sq,DOLLAR:kq,DOT:Lq,EMOJI:jq,EQUALS:Eq,EXCLAMATION:Pq,FULLWIDTHGREATERTHAN:fq,FULLWIDTHLEFTPAREN:aq,FULLWIDTHLESSTHAN:pq,FULLWIDTHMIDDLEDOT:Dq,FULLWIDTHRIGHTPAREN:lq,HYPHEN:Tq,LEFTCORNERBRACKET:cq,LEFTWHITECORNERBRACKET:uq,LOCALHOST:GZ,NL:JZ,NUM:YZ,OPENANGLEBRACKET:sq,OPENBRACE:QZ,OPENBRACKET:tq,OPENPAREN:iq,PERCENT:Aq,PIPE:Mq,PLUS:Iq,POUND:_q,QUERY:Oq,QUOTE:Nq,RIGHTCORNERBRACKET:hq,RIGHTWHITECORNERBRACKET:dq,SCHEME:qZ,SEMI:Rq,SLASH:Fq,SLASH_SCHEME:KZ,SYM:Hq,TILDE:Bq,TLD:$Z,UNDERSCORE:Vq,UTLD:ZZ,UWORD:UZ,WORD:HZ,WS:XZ});const zq=/[a-z]/,Wq=new RegExp("\\p{L}","u"),Gq=new RegExp("\\p{Emoji}","u"),$q=/\d/,Zq=/\s/;let qq=null,Kq=null;function Yq(e,t){const n=function(e){const t=[],n=e.length;let i=0;for(;i<n;){let r,s=e.charCodeAt(i),o=s<55296||s>56319||i+1===n||(r=e.charCodeAt(i+1))<56320||r>57343?e[i]:e.slice(i,i+2);t.push(o),i+=o.length}return t}(t.replace(/[A-Z]/g,e=>e.toLowerCase())),i=n.length,r=[];let s=0,o=0;for(;o<i;){let a=e,l=null,c=0,h=null,u=-1,d=-1;for(;o<i&&(l=a.go(n[o]));)a=l,a.accepts()?(u=0,d=0,h=a):u>=0&&(u+=n[o].length,d++),c+=n[o].length,s+=n[o].length,o++;s-=u,o-=d,c-=u,r.push({t:h.t,v:t.slice(s-c,s),s:s-c,e:s})}return r}function Xq(e,t,n,i,r){let s;const o=t.length;for(let a=0;a<o-1;a++){const n=t[a];e.j[n]?s=e.j[n]:(s=new RZ(i),s.jr=r.slice(),e.j[n]=s),e=s}return s=new RZ(n),s.jr=r.slice(),e.j[t[o-1]]=s,s}function Jq(e){const t=[],n=[];let i=0;for(;i<e.length;){let r=0;for(;"0123456789".indexOf(e[i+r])>=0;)r++;if(r>0){t.push(n.join(""));for(let t=parseInt(e.substring(i,i+r),10);t>0;t--)n.pop();i+=r}else n.push(e[i]),i++}return t}const Qq={defaultProtocol:"http",events:null,format:tK,formatHref:tK,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function eK(e,t=null){let n=Object.assign({},Qq);e&&(n=Object.assign(n,e instanceof eK?e.o:e));const i=n.ignoreTags,r=[];for(let s=0;s<i.length;s++)r.push(i[s].toUpperCase());this.o=n,t&&(this.defaultRender=t),this.ignoreTags=r}function tK(e){return e}function nK(e,t){this.t="token",this.v=e,this.tk=t}function iK(e,t){class n extends nK{constructor(t,n){super(t,n),this.t=e}}for(const i in t)n.prototype[i]=t[i];return n.t=e,n}eK.prototype={o:Qq,ignoreTags:[],defaultRender:e=>e,check(e){return this.get("validate",e.toString(),e)},get(e,t,n){const i=null!=t;let r=this.o[e];return r?("object"==typeof r?(r=n.t in r?r[n.t]:Qq[e],"function"==typeof r&&i&&(r=r(t,n))):"function"==typeof r&&i&&(r=r(t,n.t,n)),r):r},getObj(e,t,n){let i=this.o[e];return"function"==typeof i&&null!=t&&(i=i(t,n.t,n)),i},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}},nK.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),n=e.get("truncate",t,this),i=e.get("format",t,this);return n&&i.length>n?i.substring(0,n)+"":i},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=Qq.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,n=this.toHref(e.get("defaultProtocol")),i=e.get("formatHref",n,this),r=e.get("tagName",n,t),s=this.toFormattedString(e),o={},a=e.get("className",n,t),l=e.get("target",n,t),c=e.get("rel",n,t),h=e.getObj("attributes",n,t),u=e.getObj("events",n,t);return o.href=i,a&&(o.class=a),l&&(o.target=l),c&&(o.rel=c),h&&Object.assign(o,h),{tagName:r,attributes:o,content:s,eventListeners:u}}};const rK=iK("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),sK=iK("text"),oK=iK("nl"),aK=iK("url",{isLink:!0,toHref(e=Qq.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==GZ&&e[1].t===Cq}}),lK=e=>new RZ(e);function cK(e,t,n){const i=n[0].s,r=n[n.length-1].e;return new e(t.slice(i,r),n)}const hK="undefined"!=typeof console&&console&&console.warn||(()=>{}),uK={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function dK(e,t=!1){if(uK.initialized&&hK(`linkifyjs: already initialized - will not register custom scheme "${e}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');uK.customSchemes.push([e,t])}function pK(){uK.scanner=function(e=[]){const t={};RZ.groups=t;const n=new RZ;null==qq&&(qq=Jq("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==Kq&&(Kq=Jq("121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222")),jZ(n,"'",gq),jZ(n,"{",QZ),jZ(n,"}",eq),jZ(n,"[",tq),jZ(n,"]",nq),jZ(n,"(",iq),jZ(n,")",rq),jZ(n,"<",sq),jZ(n,">",oq),jZ(n,"",aq),jZ(n,"",lq),jZ(n,"",cq),jZ(n,"",hq),jZ(n,"",uq),jZ(n,"",dq),jZ(n,"",pq),jZ(n,"",fq),jZ(n,"&",mq),jZ(n,"*",vq),jZ(n,"@",yq),jZ(n,"`",wq),jZ(n,"^",xq),jZ(n,":",Cq),jZ(n,",",Sq),jZ(n,"$",kq),jZ(n,".",Lq),jZ(n,"=",Eq),jZ(n,"!",Pq),jZ(n,"-",Tq),jZ(n,"%",Aq),jZ(n,"|",Mq),jZ(n,"+",Iq),jZ(n,"#",_q),jZ(n,"?",Oq),jZ(n,'"',Nq),jZ(n,"/",Fq),jZ(n,";",Rq),jZ(n,"~",Bq),jZ(n,"_",Vq),jZ(n,"\\",bq),jZ(n,"",Dq);const i=BZ(n,$q,YZ,{[kZ]:!0});BZ(i,$q,i);const r=BZ(i,zq,zZ,{[PZ]:!0}),s=BZ(i,Wq,WZ,{[TZ]:!0}),o=BZ(n,zq,HZ,{[LZ]:!0});BZ(o,$q,r),BZ(o,zq,o),BZ(r,$q,r),BZ(r,zq,r);const a=BZ(n,Wq,UZ,{[EZ]:!0});BZ(a,zq),BZ(a,$q,s),BZ(a,Wq,a),BZ(s,$q,s),BZ(s,zq),BZ(s,Wq,s);const l=jZ(n,"\n",JZ,{[OZ]:!0}),c=jZ(n,"\r",XZ,{[OZ]:!0}),h=BZ(n,Zq,XZ,{[OZ]:!0});jZ(n,"",h),jZ(c,"\n",l),jZ(c,"",h),BZ(c,Zq,h),jZ(h,"\r"),jZ(h,"\n"),BZ(h,Zq,h),jZ(h,"",h);const u=BZ(n,Gq,jq,{[MZ]:!0});jZ(u,"#"),BZ(u,Gq,u),jZ(u,"",u);const d=jZ(u,"");jZ(d,"#"),BZ(d,Gq,u);const p=[[zq,o],[$q,r]],f=[[zq,null],[Wq,a],[$q,s]];for(let m=0;m<qq.length;m++)Xq(n,qq[m],$Z,HZ,p);for(let m=0;m<Kq.length;m++)Xq(n,Kq[m],ZZ,UZ,f);DZ($Z,{tld:!0,ascii:!0},t),DZ(ZZ,{utld:!0,alpha:!0},t),Xq(n,"file",qZ,HZ,p),Xq(n,"mailto",qZ,HZ,p),Xq(n,"http",KZ,HZ,p),Xq(n,"https",KZ,HZ,p),Xq(n,"ftp",KZ,HZ,p),Xq(n,"ftps",KZ,HZ,p),DZ(qZ,{scheme:!0,ascii:!0},t),DZ(KZ,{slashscheme:!0,ascii:!0},t),e=e.sort((e,t)=>e[0]>t[0]?1:-1);for(let m=0;m<e.length;m++){const t=e[m][0],i=e[m][1]?{[IZ]:!0}:{[_Z]:!0};t.indexOf("-")>=0?i[AZ]=!0:zq.test(t)?$q.test(t)?i[PZ]=!0:i[LZ]=!0:i[kZ]=!0,VZ(n,t,t,i)}return VZ(n,"localhost",GZ,{ascii:!0}),n.jd=new RZ(Hq),{start:n,tokens:Object.assign({groups:t},Uq)}}(uK.customSchemes);for(let e=0;e<uK.tokenQueue.length;e++)uK.tokenQueue[e][1]({scanner:uK.scanner});uK.parser=function({groups:e}){const t=e.domain.concat([mq,vq,yq,bq,wq,xq,kq,Eq,Tq,YZ,Aq,Mq,Iq,_q,Fq,Hq,Bq,Vq]),n=[gq,Cq,Sq,Lq,Pq,Aq,Oq,Nq,Rq,sq,oq,QZ,eq,nq,tq,iq,rq,aq,lq,cq,hq,uq,dq,pq,fq],i=[mq,gq,vq,bq,wq,xq,kq,Eq,Tq,QZ,eq,Aq,Mq,Iq,_q,Oq,Fq,Hq,Bq,Vq],r=lK(),s=jZ(r,Bq);FZ(s,i,s),FZ(s,e.domain,s);const o=lK(),a=lK(),l=lK();FZ(r,e.domain,o),FZ(r,e.scheme,a),FZ(r,e.slashscheme,l),FZ(o,i,s),FZ(o,e.domain,o);const c=jZ(o,yq);jZ(s,yq,c),jZ(a,yq,c),jZ(l,yq,c);const h=jZ(s,Lq);FZ(h,i,s),FZ(h,e.domain,s);const u=lK();FZ(c,e.domain,u),FZ(u,e.domain,u);const d=jZ(u,Lq);FZ(d,e.domain,u);const p=lK(rK);FZ(d,e.tld,p),FZ(d,e.utld,p),jZ(c,GZ,p);const f=jZ(u,Tq);jZ(f,Tq,f),FZ(f,e.domain,u),FZ(p,e.domain,u),jZ(p,Lq,d),jZ(p,Tq,f);const m=jZ(p,Cq);FZ(m,e.numeric,rK);const g=jZ(o,Tq),v=jZ(o,Lq);jZ(g,Tq,g),FZ(g,e.domain,o),FZ(v,i,s),FZ(v,e.domain,o);const y=lK(aK);FZ(v,e.tld,y),FZ(v,e.utld,y),FZ(y,e.domain,o),FZ(y,i,s),jZ(y,Lq,v),jZ(y,Tq,g),jZ(y,yq,c);const b=jZ(y,Cq),w=lK(aK);FZ(b,e.numeric,w);const x=lK(aK),C=lK();FZ(x,t,x),FZ(x,n,C),FZ(C,t,x),FZ(C,n,C),jZ(y,Fq,x),jZ(w,Fq,x);const S=jZ(a,Cq),k=jZ(l,Cq),L=jZ(k,Fq),E=jZ(L,Fq);FZ(a,e.domain,o),jZ(a,Lq,v),jZ(a,Tq,g),FZ(l,e.domain,o),jZ(l,Lq,v),jZ(l,Tq,g),FZ(S,e.domain,x),jZ(S,Fq,x),jZ(S,Oq,x),FZ(E,e.domain,x),FZ(E,t,x),jZ(E,Fq,x);const P=[[QZ,eq],[tq,nq],[iq,rq],[sq,oq],[aq,lq],[cq,hq],[uq,dq],[pq,fq]];for(let T=0;T<P.length;T++){const[e,i]=P[T],r=jZ(x,e);jZ(C,e,r),jZ(r,i,x);const s=lK(aK);FZ(r,t,s);const o=lK();FZ(r,n),FZ(s,t,s),FZ(s,n,o),FZ(o,t,s),FZ(o,n,o),jZ(s,i,x),jZ(o,i,x)}return jZ(r,GZ,y),jZ(r,JZ,oK),{start:r,tokens:Uq}}(uK.scanner.tokens);for(let e=0;e<uK.pluginQueue.length;e++)uK.pluginQueue[e][1]({scanner:uK.scanner,parser:uK.parser});return uK.initialized=!0,uK}function fK(e){return uK.initialized||pK(),function(e,t,n){let i=n.length,r=0,s=[],o=[];for(;r<i;){let a=e,l=null,c=null,h=0,u=null,d=-1;for(;r<i&&!(l=a.go(n[r].t));)o.push(n[r++]);for(;r<i&&(c=l||a.go(n[r].t));)l=null,a=c,a.accepts()?(d=0,u=a):d>=0&&d++,r++,h++;if(d<0)r-=h,r<i&&(o.push(n[r]),r++);else{o.length>0&&(s.push(cK(sK,t,o)),o=[]),r-=d,h-=d;const e=u.t,i=n.slice(r-h,r);s.push(cK(e,t,i))}}return o.length>0&&s.push(cK(sK,t,o)),s}(uK.parser.start,e,Yq(uK.scanner.start,e))}function mK(e,t=null,n=null){if(t&&"object"==typeof t){if(n)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);n=t,t=null}const i=new eK(n),r=fK(e),s=[];for(let o=0;o<r.length;o++){const e=r[o];!e.isLink||t&&e.t!==t||!i.check(e)||s.push(e.toFormattedObject(i))}return s}function gK(e){return new n_({key:new s_("autolink"),appendTransaction:(t,n,i)=>{const r=t.some(e=>e.docChanged)&&!n.doc.eq(i.doc),s=t.some(e=>e.getMeta("preventAutolink"));if(!r||s)return;const{tr:o}=i,a=function(e,t){const n=new DI(e);return t.forEach(e=>{e.steps.forEach(e=>{n.step(e)})}),n}(n.doc,[...t]),l=function(e){const{mapping:t,steps:n}=e,i=[];return t.maps.forEach((e,r)=>{const s=[];if(e.ranges.length)e.forEach((e,t)=>{s.push({from:e,to:t})});else{const{from:e,to:t}=n[r];if(void 0===e||void 0===t)return;s.push({from:e,to:t})}s.forEach(({from:e,to:n})=>{const s=t.slice(r).map(e,-1),o=t.slice(r).map(n),a=t.invert().map(s,-1),l=t.invert().map(o);i.push({oldRange:{from:a,to:l},newRange:{from:s,to:o}})})}),KR(i)}(a);return l.forEach(({newRange:t})=>{const n=function(e,t,n){const i=[];return e.nodesBetween(t.from,t.to,(e,t)=>{n(e)&&i.push({node:e,pos:t})}),i}(i.doc,t,e=>e.isTextblock);let r,s;if(n.length>1?(r=n[0],s=i.doc.textBetween(r.pos,r.pos+r.node.nodeSize,void 0," ")):n.length&&i.doc.textBetween(t.from,t.to," "," ").endsWith(" ")&&(r=n[0],s=i.doc.textBetween(r.pos,t.to,void 0," ")),r&&s){const t=s.split(" ").filter(e=>""!==e);if(t.length<=0)return!1;const n=t[t.length-1],l=r.pos+s.lastIndexOf(n);if(!n)return!1;const c=fK(n).map(t=>t.toObject(e.defaultProtocol));if(!(1===(a=c).length?a[0].isLink:3===a.length&&a[1].isLink&&["()","[]"].includes(a[0].value+a[2].value)))return!1;c.filter(e=>e.isLink).map(e=>({...e,from:l+e.start+1,to:l+e.end+1})).filter(e=>!i.schema.marks.code||!i.doc.rangeHasMark(e.from,e.to,i.schema.marks.code)).filter(t=>e.validate(t.value)).forEach(t=>{YR(t.from,t.to,i.doc).some(t=>t.mark.type===e.type)||o.addMark(t.from,t.to,e.type.create({href:t.href}))})}var a}),o.steps.length?o:void 0}})}fK.scan=Yq;const vK=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g,yK=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i;function bK(e){return!e||e.replace(vK,"").match(yK)}const wK=yF.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.protocols.forEach(e=>{"string"!=typeof e?dK(e.scheme,e.optionalSlashes):dK(e)})},onDestroy(){RZ.groups={},uK.scanner=null,uK.parser=null,uK.tokenQueue=[],uK.pluginQueue=[],uK.customSchemes=[],uK.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:e=>!!e}),addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML:()=>[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!(!t||!bK(t))&&{href:t}}}],renderHTML({HTMLAttributes:e}){return bK(e.href)?["a",aR(this.options.HTMLAttributes,e),0]:["a",aR(this.options.HTMLAttributes,{...e,href:""}),0]},addCommands(){return{setLink:e=>({chain:t})=>t().setMark(this.name,e).setMeta("preventAutolink",!0).run(),toggleLink:e=>({chain:t})=>t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[wF({find:e=>{const t=[];if(e){const{validate:n}=this.options,i=mK(e).filter(e=>e.isLink&&n(e.value));i.length&&i.forEach(e=>t.push({text:e.value,data:{href:e.href},index:e.start}))}return t},type:this.type,getAttributes:e=>{var t;return{href:null===(t=e.data)||void 0===t?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[];var t;return this.options.autolink&&e.push(gK({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:this.options.validate})),!0===this.options.openOnClick&&e.push((t={type:this.type},new n_({key:new s_("handleClickLink"),props:{handleClick:(e,n,i)=>{var r,s;if(0!==i.button)return!1;if(!e.editable)return!1;let o=i.target;const a=[];for(;"DIV"!==o.nodeName;)a.push(o),o=o.parentNode;if(!a.find(e=>"A"===e.nodeName))return!1;const l=qR(e.state,t.type.name),c=i.target,h=null!==(r=null==c?void 0:c.href)&&void 0!==r?r:l.href,u=null!==(s=null==c?void 0:c.target)&&void 0!==s?s:l.target;return!(!c||!h||(window.open(h,u),0))}}}))),this.options.linkOnPaste&&e.push(function(e){return new n_({key:new s_("handlePasteLink"),props:{handlePaste:(t,n,i)=>{const{state:r}=t,{selection:s}=r,{empty:o}=s;if(o)return!1;let a="";i.content.forEach(e=>{a+=e.textContent});const l=mK(a,{defaultProtocol:e.defaultProtocol}).find(e=>e.isLink&&e.value===a);return!(!a||!l||(e.editor.commands.setMark(e.type,{href:l.href}),0))}}})}({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),e}}),xK=/^\s*>\s$/,CK=bF.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return["blockquote",aR(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[vF({find:xK,type:this.type})]}}),SK=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,kK=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,LK=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,EK=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,PK=yF.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],renderHTML({HTMLAttributes:e}){return["strong",aR(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[fF({find:SK,type:this.type}),fF({find:LK,type:this.type})]},addPasteRules(){return[wF({find:kK,type:this.type}),wF({find:EK,type:this.type})]}}),TK=bF.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",aR(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),AK=yF.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:e=>!!e.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:e}){return["span",aR(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=$R(e,this.type);return!!Object.entries(n).some(([,e])=>!!e)||t.unsetMark(this.name)}}}}),MK=/^\s*([-+*])\s$/,IK=bF.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",aR(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(TK.name,this.editor.getAttributes(AK.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=vF({find:MK,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=vF({find:MK,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(AK.name),editor:this.editor})),[e]}}),_K=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))$/,OK=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))/g,NK=yF.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",aR(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[fF({find:_K,type:this.type})]},addPasteRules(){return[wF({find:OK,type:this.type})]}}),DK=/^```([a-z]+)?[\s\n]$/,RK=/^~~~([a-z]+)?[\s\n]$/,FK=bF.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,i=[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter(e=>e.startsWith(n)).map(e=>e.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:e,HTMLAttributes:t}){return["pre",aR(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!n&&t.parent.textContent.length)&&this.editor.commands.clearNodes())},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:i,empty:r}=n;if(!r||i.parent.type!==this.type)return!1;const s=i.parentOffset===i.parent.nodeSize-2,o=i.parent.textContent.endsWith("\n\n");return!(!s||!o)&&e.chain().command(({tr:e})=>(e.delete(i.pos-2,i.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:i}=t,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;if(!(r.parentOffset===r.parent.nodeSize-2))return!1;const o=r.after();if(void 0===o)return!1;return i.nodeAt(o)?e.commands.command(({tr:e})=>(e.setSelection(FI.near(i.resolve(o))),!0)):e.commands.exitCode()}}},addInputRules(){return[gF({find:DK,type:this.type,getAttributes:e=>({language:e[1]})}),gF({find:RK,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new n_({key:new s_("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),i=t.clipboardData.getData("vscode-editor-data"),r=i?JSON.parse(i):void 0,s=null==r?void 0:r.mode;if(!n||!s)return!1;const{tr:o,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,"\n"));return o.replaceSelectionWith(this.type.create({language:s},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(HI.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),e.dispatch(o),!0}}})]}}),BK=bF.create({name:"doc",topNode:!0,content:"block+"});class VK extends FI{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return VK.valid(n)?new VK(n):FI.near(n)}content(){return ZA.empty}eq(e){return e instanceof VK&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new VK(e.resolve(t.pos))}getBookmark(){return new jK(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),i=e.node(t);if(0!=n)for(let e=i.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}else if(i.type.spec.isolating)return!0}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),i=e.node(t);if(n!=i.childCount)for(let e=i.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}else if(i.type.spec.isolating)return!0}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,n=!1){e:for(;;){if(!n&&VK.valid(e))return e;let i=e.pos,r=null;for(let n=e.depth;;n--){let s=e.node(n);if(t>0?e.indexAfter(n)<s.childCount:e.index(n)>0){r=s.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;i+=t;let o=e.doc.resolve(i);if(VK.valid(o))return o}for(;;){let s=t>0?r.firstChild:r.lastChild;if(!s){if(r.isAtom&&!r.isText&&!zI.isSelectable(r)){e=e.doc.resolve(i+r.nodeSize*t),n=!1;continue e}break}r=s,i+=t;let o=e.doc.resolve(i);if(VK.valid(o))return o}return null}}}VK.prototype.visible=!1,VK.findFrom=VK.findGapCursorFrom,FI.jsonID("gapcursor",VK);class jK{constructor(e){this.pos=e}map(e){return new jK(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return VK.valid(t)?new VK(t):FI.near(t)}}const HK=AD({ArrowLeft:UK("horiz",-1),ArrowRight:UK("horiz",1),ArrowUp:UK("vert",-1),ArrowDown:UK("vert",1)});function UK(e,t){const n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,i,r){let s=e.selection,o=t>0?s.$to:s.$from,a=s.empty;if(s instanceof HI){if(!r.endOfTextblock(n)||0==o.depth)return!1;a=!1,o=e.doc.resolve(t>0?o.after():o.before())}let l=VK.findGapCursorFrom(o,t,a);return!!l&&(i&&i(e.tr.setSelection(new VK(l))),!0)}}function zK(e,t,n){if(!e||!e.editable)return!1;let i=e.state.doc.resolve(t);if(!VK.valid(i))return!1;let r=e.posAtCoords({left:n.clientX,top:n.clientY});return!(r&&r.inside>-1&&zI.isSelectable(e.state.doc.nodeAt(r.inside)))&&(e.dispatch(e.state.tr.setSelection(new VK(i))),!0)}function WK(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof VK))return!1;let{$from:n}=e.state.selection,i=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!i)return!1;let r=HA.empty;for(let o=i.length-1;o>=0;o--)r=HA.from(i[o].createAndFill(null,r));let s=e.state.tr.replace(n.pos,n.pos,new ZA(r,0,0));return s.setSelection(HI.near(s.doc.resolve(n.pos+1))),e.dispatch(s),!1}function GK(e){if(!(e.selection instanceof VK))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",zN.create(e.doc,[jN.widget(e.selection.head,t,{key:"gapcursor"})])}const $K=LR.create({name:"gapCursor",addProseMirrorPlugins:()=>[new n_({props:{decorations:GK,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&VK.valid(n)?new VK(n):null,handleClick:zK,handleKeyDown:HK,handleDOMEvents:{beforeinput:WK}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!==(t=hR(iR(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))&&void 0!==t?t:null}}}),ZK=bF.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",aR(this.options.HTMLAttributes,e)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:i})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:e,storedMarks:r}=n;if(e.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=i.extensionManager,a=r||e.$to.parentOffset&&e.$from.marks();return t().insertContent({type:this.name}).command(({tr:e,dispatch:t})=>{if(t&&a&&s){const t=a.filter(e=>o.includes(e.type.name));e.ensureMarks(t)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),qK=bF.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",aR(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{const{selection:n}=t,{$from:i,$to:r}=n,s=e();return 0===i.parentOffset?s.insertContentAt({from:Math.max(i.pos-1,0),to:r.pos},{type:this.name}):tF(n)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:e,dispatch:t})=>{var n;if(t){const{$to:t}=e.selection,i=t.end();if(t.nodeAfter)t.nodeAfter.isTextblock?e.setSelection(HI.create(e.doc,t.pos+1)):t.nodeAfter.isBlock?e.setSelection(zI.create(e.doc,t.pos)):e.setSelection(HI.create(e.doc,t.pos));else{const r=null===(n=t.parent.type.contentMatch.defaultType)||void 0===n?void 0:n.create();r&&(e.insert(i,r),e.setSelection(HI.create(e.doc,i+1)))}e.scrollIntoView()}return!0}).run()}}},addInputRules(){return[mF({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),KK=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,YK=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,XK=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,JK=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,QK=yF.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:e}){return["em",aR(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[fF({find:KK,type:this.type}),fF({find:XK,type:this.type})]},addPasteRules(){return[wF({find:YK,type:this.type}),wF({find:JK,type:this.type})]}}),eY=bF.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",aR(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),tY=bF.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",aR(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),nY=yF.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:e=>!!e.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:e}){return["span",aR(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=$R(e,this.type);return!!Object.entries(n).some(([,e])=>!!e)||t.unsetMark(this.name)}}}}),iY=/^(\d+)\.\s$/,rY=bF.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return 1===t?["ol",aR(this.options.HTMLAttributes,n),0]:["ol",aR(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(tY.name,this.editor.getAttributes(nY.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=vF({find:iY,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=vF({find:iY,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(nY.name)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),sY=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,oY=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,aY=yF.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",aR(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[fF({find:sY,type:this.type})]},addPasteRules(){return[wF({find:oY,type:this.type})]}}),lY=LR.create({name:"starterKit",addExtensions(){var e,t,n,i,r,s,o,a,l,c,h,u,d,p,f,m,g,v;const y=[];return!1!==this.options.bold&&y.push(PK.configure(null===(e=this.options)||void 0===e?void 0:e.bold)),!1!==this.options.blockquote&&y.push(CK.configure(null===(t=this.options)||void 0===t?void 0:t.blockquote)),!1!==this.options.bulletList&&y.push(IK.configure(null===(n=this.options)||void 0===n?void 0:n.bulletList)),!1!==this.options.code&&y.push(NK.configure(null===(i=this.options)||void 0===i?void 0:i.code)),!1!==this.options.codeBlock&&y.push(FK.configure(null===(r=this.options)||void 0===r?void 0:r.codeBlock)),!1!==this.options.document&&y.push(BK.configure(null===(s=this.options)||void 0===s?void 0:s.document)),!1!==this.options.dropcursor&&y.push(SF.configure(null===(o=this.options)||void 0===o?void 0:o.dropcursor)),!1!==this.options.gapcursor&&y.push($K.configure(null===(a=this.options)||void 0===a?void 0:a.gapcursor)),!1!==this.options.hardBreak&&y.push(ZK.configure(null===(l=this.options)||void 0===l?void 0:l.hardBreak)),!1!==this.options.heading&&y.push(xU.configure(null===(c=this.options)||void 0===c?void 0:c.heading)),!1!==this.options.history&&y.push(zF.configure(null===(h=this.options)||void 0===h?void 0:h.history)),!1!==this.options.horizontalRule&&y.push(qK.configure(null===(u=this.options)||void 0===u?void 0:u.horizontalRule)),!1!==this.options.italic&&y.push(QK.configure(null===(d=this.options)||void 0===d?void 0:d.italic)),!1!==this.options.listItem&&y.push(eY.configure(null===(p=this.options)||void 0===p?void 0:p.listItem)),!1!==this.options.orderedList&&y.push(rY.configure(null===(f=this.options)||void 0===f?void 0:f.orderedList)),!1!==this.options.paragraph&&y.push($F.configure(null===(m=this.options)||void 0===m?void 0:m.paragraph)),!1!==this.options.strike&&y.push(aY.configure(null===(g=this.options)||void 0===g?void 0:g.strike)),!1!==this.options.text&&y.push(ZF.configure(null===(v=this.options)||void 0===v?void 0:v.text)),y}}),cY={view({attrs:{expanded:e,hidden:t,onpointerdown:n,className:i}}){void 0===i?i="":i+=" ";return eo({expanded:e,hidden:t})&&(i+=eo({expanded:e,hidden:t})),Oe(".expander",{onpointerdown:n,className:i,"aria-expanded":String(e)},Oe(Jo,{icon:"expander"}))}},hY=bF.create({name:"doc",topNode:!0,content:"paragraph+",marks:""}),uY=e=>{let t,n=e;return{view:e=>(n=e,Oe(".doc-editor-text")),oncreate(e){const i=uo(e),{value:r,editable:s,placeholder:o,autofocus:a}=e.attrs,l=[hY,$F,ZF];s&&l.push(CU.configure({placeholder:o}),zF),t=new pF({element:i,editable:s,extensions:l,content:dY(r),onUpdate:({editor:e})=>{if(i&&s){const t=e.getText({blockSeparator:"\n"})||"";n.attrs.onchange(t||"")}},onBlur:({editor:e})=>{if(i&&s){const t=(e.getText({blockSeparator:"\n"})||"").trim();e.commands.setContent(dY(t)),n.attrs.onchange(t)}}}),a&&(t.commands.focus(),Oj.autoSelectForRename=void 0)},onupdate(e){if(t){const{value:n}=e.attrs;n!==t.getText({blockSeparator:"\n"})&&t.commands.setContent(dY(n))}},onremove(){t&&t.destroy()}}};function dY(e){return{type:"doc",content:e.split("\n").map(e=>({type:"paragraph",content:e?[{type:"text",text:e}]:void 0}))}}const pY=Array.isArray,fY=e=>e&&!pY(e)&&"object"==typeof e,mY=e=>e.constructor.displayName||e.constructor.name,gY=()=>{let e=!1;return{view({attrs:{name:t,object:n,numberUnits:i,selectable:r}}){const s=(e=>pY(e)?e.map((e,t)=>({name:t.toFixed(0),object:e})):fY(e)?Object.keys(e).map(t=>({name:t,object:e[t]})):[])(n);if(void 0===t&&0===s.length)return Oe(vY,{object:n,numberUnits:i,selectable:r});const o=eo({expanded:e,childless:0===s.length});return Oe(".oi-node",[Oe(".oi-item",[Oe(".oi-expander",{onpointerdown:()=>{e=!e},className:o}),Oe(".oi-item-content",[void 0===t?null:Oe("span.oi-name",t),Oe(vY,{object:n,numberUnits:i,selectable:r})])]),e?Oe(".oi-children",[s.map(({name:e,object:t})=>Oe(gY,{name:e,object:t,numberUnits:i,selectable:r}))]):null])}}},vY={view:({attrs:{object:e,numberUnits:t,selectable:n}})=>pY(e)?Oe("span.oi-type-array",[e.map(e=>Oe("span.oi-type-array-item",[Oe(yY,{object:e,numberUnits:t,selectable:n})]))]):fY(e)?Oe("span.oi-type-object",[n&&xY(e)?Oe("span.oi-type-object-class",wY(e,n),mY(e)):Oe("span.oi-type-object-class",mY(e)),Oe("span.oi-type-object-entries",[Object.keys(e).map(i=>{const r=e[i];return Oe("span.oi-type-object-entry",[Oe("span.oi-type-object-key",i),Oe("span.oi-type-object-value",[Oe(yY,{object:r,numberUnits:t,selectable:n})])])})])]):Oe(yY,{object:e,numberUnits:t,selectable:n})},yY={view({attrs:{object:e,numberUnits:t,selectable:n}}){if(void 0===e)return Oe("span.oi-type-other","undefined");if(null===e)return Oe("span.oi-type-other","null");if("string"==typeof e)return Oe("span.oi-type-string",JSON.stringify(e));if("number"==typeof e)return Oe(bY,{object:e,numberUnits:t});if("function"==typeof e){const t="string"==typeof e.name?e.name:"";return Oe("span.oi-type-function",[t,"()"])}return pY(e)?0===e.length?Oe("span.oi-type-array",""):Oe("span.oi-type-array","..."):fY(e)?n&&xY(e)?Oe("span.oi-type-object-class",wY(e,n),mY(e)):Oe("span.oi-type-object-class",mY(e)):Oe("span.oi-type-other",e.toString())}},bY={view({attrs:{object:e,numberUnits:t}}){const n=e.toString(),i=$r(e,6),r=n.length>i.length;return Oe("span.oi-type-number",{className:eo({"oi-detailed":r})},[Oe("span.oi-detail-number",n),r&&Oe("span.oi-short-number",i),t&&Oe("span.oi-number-units"," "+t)])}},wY=(e,t)=>({onpointerover:()=>{const n=t.contextMatrix();e instanceof De&&(e=Ri.fromBoundingBox(e)),Oj.hoveredObjectInspectorGeometry=e.clone().affineTransform(n)},onpointerout:()=>{Oj.hoveredObjectInspectorGeometry=void 0}}),xY=e=>Dn.isValid(e)||It.isValid(e)||De.isValid(e),CY={view({attrs:{expressionTrace:e,selectable:t,units:n}}){if(null==e?void 0:e.isSuccess){const i=e.evaluationResult;return Oe(".evaluation-result",Oe(gY,{object:i,numberUnits:n,selectable:t}))}}},SY=e=>t=>({text:t,className:e}),kY=["console.log(","console.warn(","console.error(","console.geometry(","console.guide(","cuttle.project.units"].map(SY("code-hint-builtin code-hint-builtin-env")),LY=()=>{let e;return{view:({attrs:{expression:t,expressionTrace:n,readOnly:i,forceMultiline:r,initialSelections:s,selectable:o,onBlur:a,onFocus:l,onChangeCode:c,onCommitCode:h,onChangeSelection:u}})=>{const d=t.latestCode(),p=r||d.includes("\n"),f=!r&&!PY(d,e),m=!t.isCommitted(),g=()=>{null==h||h()},v=m&&p?Oe(".expression-editor-commit",{tabIndex:0},Oe(Zo,{message:()=>["Run Code",Oe("span.tooltip-accelerator",new qj("Enter",{command:!0}).toString())]},Oe(Jo,{icon:"play"}))):void 0;return Oe(".expression-editor",{className:eo({changed:m})},[Oe(dj,{value:d,lineAnnotations:EY(n,o),readOnly:i,confirmOnEnter:f,forcedSelections:()=>{if(!(Oj.project.focus instanceof kC)){const{expressionFocus:e}=Oj.project;if(e&&e.expression===t)return e.selections}},initialSelections:s,onChange:e=>{null==c||c(e)},onFocus:()=>{Oj.project.focusExpression(t),null==l||l()},onBlur:()=>{Oj.project.blurExpressionIfFocused(t),null==a||a()},onSelection:n=>{e=n;const{expressionFocus:i}=Oj.project;i&&i.expression===t&&(i.selections=n,null==u||u(n))},onConfirm:g,onCommandEnter:g,onNumberScrub:g,codeHints:()=>{const e=Oj.project.categorizedNamesInExpressionScope(t);return[...e.parameters.map(SY("code-hint-my code-hint-parameter")),...e.repeats.map(SY("code-hint-my code-hint-parameter")),...e.components.map(SY("code-hint-my code-hint-component")),...e.modifiers.map(SY("code-hint-my code-hint-modifier")),...e.builtins.map(SY("code-hint-builtin code-hint-builtin-def")),...e.units.map(SY("code-hint-builtin code-hint-builtin-units")),...e.globals.map(SY("code-hint-builtin code-hint-builtin-env")),...kY]}}),v])}}},EY=(e,t)=>{if(!e)return[];const n=ss(e.messages,e=>e.line);return n.size<1?[]:Array.from(n.values()).map(e=>({line:e[0].line??-1,view:()=>Oe(".expression-message-group",e.map(e=>{const n="expression-message "+e.logLevel;return Oe("div",{className:n},[Oe(gY,{object:e.message,selectable:t})])}))}))},PY=(e,t)=>{if(/\n|;|\/\/|\/\*+|\b(?:var|let|const|return)\b/.test(e))return!0;if(t){if(t.length>1)return!0;if(1===t.length){const n=Math.min(t[0].anchor.ch,t[0].head.ch),i=e.slice(0,n);if(/(?:\[|\(|{|,)\s*$/.test(i))return!0}}return!1},TY={view({attrs:{selectable:e,onClickCreateVariation:t}}){var n;const{instance:i}=e,{definition:r}=i;Ps(r instanceof yb||r instanceof Nb);const s=r.code,o=null==(n=e.instanceTrace())?void 0:n.code,a=r.isImmutable,l=e.isImmutable();return[Oe(".inspector-row",Oe(".parameter-code-note",[a&&!l?[Oe("a",{href:"/learn/scripting",target:"_blank",onclick:t},"Create a variation"),` to edit the code of this built-in ${i.definition instanceof yb?"component":"modifier"}. `]:["See Cuttle's ",Oe("a",{href:"/learn/scripting",target:"_blank"},"scripting reference"),"."]])),Oe(".inspector-row",[Oe(".expression-input",[Oe(LY,{expression:s,expressionTrace:o,readOnly:a,forceMultiline:!0,selectable:e,onBlur:()=>{s.commitEditingCode()},onChangeCode:e=>{s.editingJsCode=e},onCommitCode:()=>{s.commitEditingCode()}})])]),Oe(".inspector-row",Oe(CY,{expressionTrace:o,units:void 0,selectable:e}))]}},AY={view({attrs:{trace:e,showLogLevels:t}}){if(void 0===e)return;const n=e.expressionTraces().flatMap(e=>e.messages);if(n.length<1)return;const i=n.filter(e=>t.includes(e.logLevel));return i.length<1?void 0:i.map(e=>Oe(IY,{message:e}))}},MY={view({attrs:{component:e,showLogLevels:t}}){if(e instanceof yb)return;const n=Oj.traceForComponent(e);if(!n)return;if(!n.element)return;const i=US(n.element).filter(e=>t.includes(e.logLevel));return i.length<1?void 0:i.map(e=>Oe(IY,{message:e}))}},IY={view:({attrs:{message:e}})=>"error"===e.logLevel?Oe(yU,{icon:"error"},function(e){if(e.includes("MALLOC"))return"Cuttle has run out of memory. Please reduce the number of shapes in your design. You might have to refresh the browser to continue.";return e}(String(e.message))):"warn"===e.logLevel||"warn-global"===e.logLevel?Oe(yU,{icon:"warning"},String(e.message)):Oe(yU,{icon:"info"},String(e.message))};const _Y={view:e=>{const{value:t,onchange:n,recommendedValues:i}=e.attrs;let r,s="https://assets.cuttle.xyz/noto-emoji-600/1f642.svg";const o=sc(t);"error"===o.type?console.warn("Unexpected emoji value.",t):(s=t,"asset"===o.type&&o.directory.includes("emoji")&&(r=function(e){const t=e.split("-").map(e=>parseInt(e,16));return String.fromCodePoint(...t)}(o.name)));const a=Oe("img",{width:32,height:32,src:lc(s),alt:r});return Oe("button.secondary.emoji-picker",{onclick:()=>{const r=uo(e);Oj.isPickerOpen=!0;const s=Oj.startGesture("Emoji Picker"),o=Vo({spawnFrom:r,view:()=>Oe(AB,{value:t,onchange:n,recommendedValues:i,currentPopup:o}),placement:"top-start",offset:8,onclose:()=>{Oj.isPickerOpen=!1,Oj.stopGesture(s)},closeOnEnter:!0})}},[a])}};qL.addRule(".parameter button.emoji-picker",{backgroundColor:qL.color.gray91,padding:4,margin:0,border:"none","& img":{opacity:.85,pointerEvents:"none"}});const OY=()=>{let e=!1;return{view:({attrs:{onSuccess:t,onFail:n}})=>Oe(".font-uploader",Oe(Zo,{message:()=>["Choose a font to add to your account",Oe("br"),"(Supported font types: ttc, ttf, otf, woff)"],placement:"bottom"},Oe("button.secondary",{onclick:async function(){const i=await NT({accept:Object.keys(zl).map(e=>"."+e).join(","),multiple:!0});if(i&&i.length>0){e=!0,Oe.redraw();try{const e=await XH(Array.from(i));t(e[0].hash)}catch(r){n(r)}e=!1,Oe.redraw()}},disabled:e},e?"Uploading":"Add Font")))}},NY="Recommended",DY={oninit(){aL.ensureBuiltInFontsLoaded()},view(e){var t;const{fontUrl:n,onchange:i,recommendedValues:r}=e.attrs;let s=BY(n),o=(null==(t=null==s?void 0:s.fontVariant)?void 0:t.label)||ef.getLabel(n)||ef.getError(n)||n;n.startsWith(Xp)?o=[o,Oe(".feature-tag","My Font")]:(e=>e.startsWith("https://assets.cuttle.xyz/fonts")&&e.endsWith(".json"))(n)&&(o=[o,Oe(".feature-tag","Pro")]);const a=aL.isFontInfoLoaded();a||(o="Loading");const l=!a,c=()=>{if(l)return;const t=n;let o=t;const a=e=>{o=e,i(e)},c=uo(e);Oj.isPickerOpen=!0;const h=Oj.startGesture("Font Picker"),u=Vo({spawnFrom:c,view:()=>Oe(RY,{value:o,familyAndVariant:s,onchange:a,recommendedValues:r,createdPopup:u}),placement:"top-start",offset:8,onclose:()=>{if(Oj.isEditingMode()){const e=aL.familyAndVariantByValue(o);e&&(e.fontFamily.pro&&(BT("pro-fonts")||i(t)),e.fontFamily.category===nL&&(BT("fonts")||i(t)))}Oj.isPickerOpen=!1,Oj.stopGesture(h)},closeOnEnter:!0})},h=eo({disabled:l});return[Oe(".font-picker.select",{onpointerdown:e=>{e.stopPropagation(),c()},tabIndex:0,onkeydown:e=>{"Enter"!==e.code&&"Space"!==e.code||(e.preventDefault(),e.stopPropagation(),c())},className:h},o)]}},RY=e=>{var t,n;let i=e,{value:r,familyAndVariant:s,recommendedValues:o}=e.attrs,a=tL,l=null==(t=null==s?void 0:s.fontFamily)?void 0:t.family,c=null==(n=null==s?void 0:s.fontVariant)?void 0:n.variant;"Noto Sans"!==l&&(null==s?void 0:s.fontFamily)&&!oL(s.fontFamily)&&(a=s.fontFamily.category),aL.isFontInArrayOrArchive(r,o)&&(a=NY);let h="",u=[];const d=()=>{var e;u=aL.filteredFontFamilyNames(a,h,null==(e=null==s?void 0:s.fontFamily)?void 0:e.family)};d();const p=e=>{a=tL,h=e,d()},f=()=>{if(l&&c){const e=aL.familyAndVariantByNames(l,c);if(s=e,!e||!e.fontVariant)return;const t=e.fontVariant.value;i.attrs.onchange(t),r=t}},m=e=>{a=e,d()},g=e=>{var t;if(e!==l){if(l=e,l){const e=null==(t=aL.familyDefaultVariant(l))?void 0:t.variant;e&&(c=e)}f()}},v=e=>{c=e,f()},y=()=>Oe(OY,{onSuccess:async e=>{const t=aL.familyAndVariantByValue(e);t?(m(nL),g(t.fontFamily.family),v(t.fontVariant.variant)):console.warn("Didn't find newly-uploaded font option.",e)},onFail:e=>{console.warn("Font upload failed.",e)}});return{view(e){var t,n;i=e;let d=aL.categories.slice();o.length>0&&d.splice(1,0,NY);const f=[{key:"categories",className:"categories",items:d,value:a,onSelect:m}],b={hasAccess:Oj.business.hasProFeature("pro-fonts")};let w=!1;if(u&&u.length>0&&f.push({key:"families",className:"families",items:u.map(e=>{w||e.value!==l||(w=!0);const t=e.pro&&Oe(tT,b);return{type:"option",label:e.label,value:e.value,render:()=>[Oe(".label",e.label),t]}}),value:l,onSelect:g}),(null==(t=null==s?void 0:s.fontFamily)?void 0:t.variants)&&a!==NY){let e;w&&(e=null==(n=null==s?void 0:s.fontFamily)?void 0:n.variants.map(e=>VY({fontVariant:e,fontPickerPopup:i.attrs.createdPopup,fontPickerValue:r,fontPickerOnChange:i.attrs.onchange}))),e&&e.length>0&&f.push({key:"variants",className:"variants",items:e,value:c,onSelect:v})}if(a===nL&&0===u.length)f.push(()=>Oe(FY,{key:"my-fonts-empty"},y()));else if(h&&0===u.length)f.push(()=>Oe(".search-empty",{key:"search-empty"},`No results for ${h}${a===tL?"":" in this category"}.`));else if(a===NY){const t=function(e){const{recommendedValues:t,selectedValue:n,onSelect:i}=e,r=Na.isMinisite(),s=t.map(e=>{var t,n;e instanceof Tr&&(e=e.url);const i=BY(e),s=!r&&(null==(t=null==i?void 0:i.fontFamily)?void 0:t.pro)&&Oe(tT,{hasAccess:Oj.business.hasProFeature("pro-fonts")}),o=(null==(n=null==i?void 0:i.fontVariant)?void 0:n.label)||ef.getLabel(e)||(null==i?void 0:i.fontFamily.family)||e;return{type:"option",label:o,value:e,render:()=>[Oe(".label",o),s]}});if(s.length>0)return s.sort((e,t)=>e.label.localeCompare(t.label)),{key:"recommended",className:"recommended",items:s,value:n,onSelect:i};return}({recommendedValues:o,selectedValue:r,onSelect:t=>{r=t,e.attrs.onchange(r)}});t&&f.push(t)}return Oe(".font-picker-popup",Oe(qF,{groups:f,layoutKey:"font-picker",primaryGroupKey:"families",onQuery:p,headerExtra:()=>[Oe(".divider"),y(),Oe(".help-link-wrapper",Oe(Zo,{message:()=>["Help with adding your own fonts."],placement:"bottom"},Oe("a.help-link.secondary",{href:"/learn/adding-your-own-fonts",target:"_blank",rel:"noreferrer noopener nofollow",role:"button","aria-label":"Help with adding your own fonts."},"?")))]}))}}},FY={view:({children:e})=>Oe(".my-fonts-empty",[Oe(".note",["Choose a font to add to your account. Supported font types: ",Oe("br"),"ttc, ttf, otf, woff."]),e,Oe(".note",Oe("a",{href:"/learn/adding-your-own-fonts",target:"_blank",rel:"noreferrer noopener nofollow"},"Help with adding your own fonts."))])};function BY(e){let t=aL.familyAndVariantByValue(e);if(!t){const i=ef.getNames(e);if(i&&i.family&&i.variant)t=aL.familyAndVariantByNames(i.family,i.variant);else try{ef.getFontFromURL(e)}catch(n){}}return t}const VY=e=>{if(!Boolean(Jp(e.fontVariant.value)))return{type:"option",label:e.fontVariant.variant,value:e.fontVariant.variant};const{fontVariant:t,fontPickerPopup:n,fontPickerValue:i,fontPickerOnChange:r}=e,s=e=>{e.stopPropagation(),n.registerChildPopup(Wo({menuItems:[{label:`Remove ${t.label}`,action:()=>{ia.open({modalView:()=>Oe(gL,{primaryAction:{label:"Remove",action:async()=>{if(i===t.value){const e=aL.nextCustomFontValue(t.value);e&&r(e)}await aL.removeCustomFont(t.value)}}},`Are you sure you want to remove the font ${t.label} from your font list?`)})}}],spawnFrom:e.target,placement:"top-end",overlay:"closeOnOutsidePointerDown"}))};return{type:"option",label:t.variant,value:t.variant,render:()=>[Oe(".label",t.variant),Oe(".extra",[Oe(ea,{icon:"dotdotdot",onclick:s})])]}},jY=()=>{let e=!1;return{view({attrs:{url:t,onChange:n,isTemporary:i}}){const r=eo({secondary:!0,hidden:""!==t});return Oe(".literal-input.image-input",[Oe(".image-input-swatch",{ondrop:ondrop,style:`background: center/contain no-repeat url("${br(ec(t))}"), center repeat url("/editor/images/image-swatch-checkerboard.svg")`},Oe(eT,{feature:"images",hasAccess:Oj.business.hasProFeature("images"),className:r,disabled:e,onClick:async t=>{const r=Oj.business.hasProFeature("images")?await TH():await(async()=>{const e=await NT({accept:Vl.join(",")});if(!e||e.length<1)throw"No files chosen.";return e[0]})();if(!r)return;if(!AH(r))return;if(i&&(e=>{const t=Gl(e);return!!t&&Fl.includes(t)})(r)){const e=URL.createObjectURL(r);return n(e),void Oe.redraw()}e=!0;const s=await MH(r);n(s),e=!1},enableProCheck:!i},e?"Uploading":"Choose Image"))])}}},HY=e=>{let t,n=!1,i=e.attrs.expression.latestCode();return{view({attrs:{expression:e,expressionTrace:r,parameterInterface:s,isImmutable:o,forceMultiline:a,isEditingExpression:l,disableEditExpressionButton:c,selectable:h,onChangeCode:u,onCommitCode:d,onChangeSelection:p,onExpressionEditorFocus:f,onExpressionEditorBlur:m,mixedHint:g}}){i=e.latestCode();const v=a||i.includes("\n"),y=e=>{t=e},b=e=>{n=!0,y("all"===e?e:[{anchor:{line:0,ch:e.start},head:{line:0,ch:e.end}}])};if(l&&!n&&b("all"),!l&&!v&&!n){const e=(e,n)=>{i=i.slice(0,e.start)+n+i.slice(e.end),e.end=e.start+n.length,t(i)},t=e=>{null==u||u(e)},n=UY(i,s,Boolean(o),Boolean(c),t,e,b,g);if(n)return n}return[Oe(".expression-input",[Oe(LY,{expression:e,expressionTrace:r,readOnly:o,forceMultiline:a,initialSelections:t,selectable:h,onFocus:()=>{n=!0,null==f||f()},onBlur:()=>{n=!1,null==m||m()},onChangeCode:u,onCommitCode:d,onChangeSelection:e=>{y(e),null==p||p(e)}})]),g]}}},UY=(e,t,n,i,r,s,o,a)=>{let l;i||(l=Oe(".edit-expression",{onclick:()=>{o("all")},tabIndex:-1}));const c=Yy(e);if(!c)return;let h;if("Number"===c.type||"Vec"===c.type){const{unit:e}=c;e&&(h=Oe(uH,{value:e,onChange:t=>{const n=Qr(c.value,e,t),i=jb(n,t);r(i)}}))}if("Number"===c.type){const i=BV(e);if(1!==i.length)return;const r=i[0],u=zY(c,t);if(void 0===t||t instanceof qb||t instanceof Xb||t instanceof Yb||t instanceof Jb)return Oe(".literal-input",[Oe(mj,{stringValue:r.literal.string,suffix:t instanceof Xb?"":void 0,readOnly:n,fractionDigits:u,onChange(e){s(r,e)},onClick(){o(r)},tabIndex:0,onFocus(){o(r)}}),h,a,l]);if(t instanceof Kb)return Oe(".literal-input",[Oe(mj,{stringValue:Db(100*c.value),suffix:"%",readOnly:n,fractionDigits:Math.max(0,u-2),onChange(e){s(r,Db(+e/100,u))},onClick(){o(r)},tabIndex:0,onFocus(){o(r)}}),a,l])}if("Boolean"===c.type&&(void 0===t||t instanceof Zb)){const e=e=>{e.target.checked?r("true"):r("false")};return Oe(".literal-input.boolean-input",Oe(xT,{checked:c.value,disabled:n,mixed:Boolean(a),onclick:e}),a,l)}if("Vec"===c.type&&(void 0===t||t instanceof ew||t instanceof tw)){const i=BV(e);if(2!==i.length)return;const[r,u]=i;return Oe(".literal-input.vec-input",[Oe(mj,{stringValue:r.literal.string,prefix:"x",readOnly:n,fractionDigits:zY(c.x,t),onChange(e){s(r,e)},onClick(){o(r)},tabIndex:0,onFocus(){o(r)}}),Oe(mj,{stringValue:u.literal.string,prefix:"y",readOnly:n,fractionDigits:zY(c.y,t),onChange(e){s(u,e)},onClick(){o(u)},tabIndex:0,onFocus(){o(u)}}),h,a,l])}if(t instanceof nw){if("Color"!==c.type&&"String"!==c.type)return;if("String"===c.type&&"none"!==c.value)return;const e="String"===c.type?"none":c.value;return Oe(".literal-input.color-input",[Oe(sH,{color:e,onchange:e=>{r("none"===e?'"none"':Bb(e))}}),a,l])}if(t instanceof Qb){let i,u=!1;const d=BV(e);if("Vec"===c.type&&2===d.length){const[e,r]=d,a=zY(c.x,t),l=zY(c.y,t);i=[Oe(mj,{stringValue:e.literal.string,prefix:"x",readOnly:n,fractionDigits:a,onChange(t){s(e,t)},onClick(){o(e)},tabIndex:0,onFocus(){o(r)}}),Oe(mj,{stringValue:r.literal.string,prefix:"y",readOnly:n,fractionDigits:l,onChange(e){s(r,e)},onClick(){o(r)},tabIndex:0,onFocus(){o(r)}})]}else if("Number"===c.type&&1===d.length){const e=d[0],r=zY(c,t);i=Oe(mj,{stringValue:e.literal.string,prefix:"xy",readOnly:n,fractionDigits:r,onChange(t){s(e,t)},onClick(){o(e)},tabIndex:0,onFocus(){o(e)}}),u=!0}if(!i)return;return Oe(".literal-input.size-input",[i,h,Oe(Zo,{message:()=>u?"Uniform Scale":"Non-uniform Scale"},[Oe(ea,{icon:u?"uniform_scale":"non_uniform_scale",onclick:()=>{if("Number"===c.type){const e=jb(new It(c.value),c.unit);r(e)}else if("Vec"===c.type){const e=jb(c.value.x,c.unit);r(e)}}})]),a,l])}if(t instanceof rw){let e,{options:i}=t;if("String"===c.type)e=c.value;else{if("AffineMatrix"!==c.type)return;i=[...i,{label:"custom",value:"custom"}],e="custom"}return Oe(".literal-input.select-input",[Oe(WY,{value:e,options:i,readOnly:n,onChange:r}),a,l])}if(t instanceof iw){if("String"!==c.type)return;const{options:e}=t;if(e.some(e=>e.value===c.value))return Oe(".literal-input.select-input",[Oe(WY,{value:c.value,options:e,readOnly:n,onChange:r}),a,l])}if(t instanceof lw){if("String"!==c.type)return;const{recommendedValues:e}=t;return Oe(".literal-input",[Oe(_Y,{value:c.value,onchange:e=>r(Rb(e)),recommendedValues:e})])}if(t instanceof ow){if("String"!==c.type&&"Font"!==c.type)return;const{recommendedValues:e}=t;return Oe(DY,{fontUrl:"Font"===c.type?c.url.value:c.value,onchange:e=>{const t=Rb(e);"Font"===c.type?s(c.urlRange,t):r(t)},recommendedValues:e})}if(t instanceof aw){let e;if("RichText"===c.type&&(e=c.value),"String"===c.type&&(e=new Ot(c.value)),!e)return;return Oe(".literal-input.text-literal-input",[Oe(RB,{value:e,editable:!n,onchange:t=>{e&&!t.equals(e)&&(r(Hb(t)),Oe.redraw())}}),a])}if(t instanceof cw){if("String"!==c.type)return;const e=!Oj.isEditingMode();return Oe(jY,{url:c.value,onChange:e=>{e!==c.value&&r(`"${br(e)}"`)},isTemporary:e})}},zY=(e,t)=>{if(void 0===t||"auto"===t.precisionDigits)return Math.min(3,xr(e.string));if("nudge"===t.precisionDigits){const t=Oj.project.focusedComponent();if(!t)return Math.min(3,xr(e.string));let n=Oj.viewportManager.viewportForComponent(t).precisionInfo().fractionDigits;if(e.unit){const t=Oj.project.settings.units,i=Jr(t,e.unit);n=Math.max(0,n-Math.round(Math.log10(i)))}return n}return t.precisionDigits},WY={view({attrs:{value:e,options:t,readOnly:n,onChange:i}}){const r=t.findIndex(t=>t.value===e);if(r<0)return;return Oe("select",{onchange:e=>{const n=e.target.selectedIndex;i(Rb(t[n].value))},disabled:n},t.map((e,t)=>Oe("option",{selected:r===t},e.label)))}},GY=e=>{let t=e;const n=e.attrs.controller.heroExpression().literal(),i=ow.options.map(e=>{const t=n&&"Font"===n.type?n.options[e.name]:void 0;return{expression:new _b(t?t.string:e.defaultExpressionCode),option:e}});let r=!1;const s=(e,n)=>{const{controller:i}=t.attrs;"all"===e?i.changeCode(n):i.replaceCodeRange(n,e),i.commitCode()},o=(e,t)=>`${e}: ${t.string}`,a=(e,t,n)=>{const i=Object.entries(e.options).map(([e,t])=>o(e,t));i.push(`${t}: ${n}`);const r=`Font(${e.url.string}, {${i.join(", ")}})`;s("all",r)},l=(e,t)=>{const n=Object.entries(e.options).filter(([e])=>e!==t).map(([e,t])=>o(e,t)),i=n.length<1?e.url.string:`Font(${e.url.string}, {${n.join(", ")}})`;s("all",i)};return{onbeforeupdate(e){t=e;const{attrs:{controller:n}}=e,r=n.heroExpression().literal();for(const t of i){const e=t.option,n=r&&"Font"===r.type&&r.options[e.name],i=n?n.string:e.defaultExpressionCode;t.expression=new _b(i)}},view({attrs:{controller:e}}){var t;const n=e.heroExpression().literal();if(!n)return;const o=null==(t=e.heroParameter().defaultExpression)?void 0:t.literal();let c=0;const h=[];for(const p of i){const{expression:t,option:i}=p,u="Font"===n.type?n.options[i.name]:void 0,d=void 0!==u;if(d&&c++,!d&&("startStyle"===i.name||"betweenStyle"===i.name||"endStyle"===i.name)){const e=n.value;if(ks(e)||e instanceof Tr)try{const t=ef.getFontFromURL(e);if(!t||!t._hasGlyphAlternates())continue}catch{continue}}let f=u&&u.string===i.defaultExpressionCode,m=d,g=e.isOverridden();if("Font"===(null==o?void 0:o.type)){const e=o.options[i.name];f=(null==u?void 0:u.string)===(null==e?void 0:e.string),m=!f,g=!f}const v=n=>{t.editingJsCode=n;if(!Yy(n))return;const r=e.heroExpression().literal();if(r)if("Font"===r.type){const e=r.optionRanges[i.name];e?s(e,n):a(r,i.name,n)}else"String"===r.type&&s("all",`Font(${r.string}, {${i.name}: ${n}})`)},y=()=>{const n=e.heroExpression().literal();if(n&&"Font"===n.type){if("Font"===(null==o?void 0:o.type)){const e=o.options[i.name];if(e){t.editingJsCode=e.string;return void(n.optionRanges[i.name]&&s(n.optionRanges[i.name],e.string))}}t.editingJsCode=i.defaultExpressionCode,l(n,i.name)}},b=()=>{t.revertEditingCode()};(d||r)&&(h.push(Oe(".inspector-row.parameter",{className:eo({overridden:g})},[Oe(".parameter-name",e.isEmbed()?yf(i.name):i.name),Oe(".parameter-value",[Oe(HY,{expression:t,disableEditExpressionButton:!0,onChangeCode:e=>v(e),onExpressionEditorBlur:b,parameterInterface:i.interface})]),Oe(".extra",[m&&Oe(Zo,{message:()=>o?"Revert Option to Default":"Remove Option"},[Oe(ea,{icon:"revert",onpointerdown:y})])])])),i.comment&&h.push(Oe(".inspector-row.comment",i.comment.split("\n").map(e=>Oe("p",e)))))}const u=c===ow.options.length,d=Oe(".inspector-row.parameter",[Oe(".parameter-name"),Oe(".parameter-value",[Oe("button.small-pill",{onclick:()=>{r=!r},disabled:u},[r?"Show Fewer Options":"Show More Options"])])]);return 0===h.length?d:Oe(".inspector-indent",h,d)}}},$Y={oncreate(e){const t=uo(e).querySelector("textarea");if(t instanceof HTMLTextAreaElement){const{parameter:n}=e.attrs;n.interface instanceof iw&&(t.value=ZY(n.interface.options))}},view(e){const{parameter:t,onChange:n}=e.attrs;return Oe(mL,{title:"Edit Options",actions:[{label:"Set Options",action:()=>{const i=uo(e).querySelector("textarea");if(i instanceof HTMLTextAreaElement){const e=qY(i.value);e.length>0&&(t.interface=new iw(e),n(e))}}}],widthAuto:!0},Oe(".select-options-modal-contents",[Oe("textarea",{placeholder:"New Line\nSeparated\nList",autofocus:!0}),Oe("p","Write each option on a new line.")]))}},ZY=e=>e.map(e=>e.label).join("\n"),qY=e=>(e=>{const t=[];for(let n of e)-1===t.indexOf(n)&&t.push(n);return t})(e.split("\n").map(e=>e.trim()).filter(e=>""!==e)).map(e=>({label:e,value:e})),KY=new class{constructor(e){this.cache={},this.dummyCanvas=document.createElement("canvas"),this.dummyCtx=this.dummyCanvas.getContext("2d"),this.dummyCtx.font=e}getWidth(e){if(this.cache.hasOwnProperty(e))return this.cache[e];const t=this.dummyCtx.measureText(e).width;return this.cache[e]=t}}(qL.font.defaultFont14),YY={view(e){const{attrs:{controller:t}}=e,n=KY.getWidth(t.heroParameter().name)>qL.dimension.parameterNameWidth,i=!t.stack.isMixed&&t.isEditingDefinition&&!t.isImmutableDefinition()&&!t.isEmbed(),r=eo({overridden:t.isOverridden(),hidden:t.heroParameter().hidden||t.isDerived(),multiline:t.isMultiline(),longname:n,selectable:!0,selected:t.isSelected(),hovered:t.isHovered()}),s=[];let o={};if(!t.isEmbed()){const e=e=>{ho(e)?s.length>0&&$o(e,s):i?(e=>{_A(e,{cursor:()=>"grabbing",onConsummate(){Oj.parameterReorder={definition:t.definition(),parameter:t.heroParameter()}},onUp(){var e;const{parameterReorder:n}=Oj;if(n){const i=t.heroParameter(),r=(null==(e=t.folder)?void 0:e.parameters)??t.definition().parameters;let s=n.hoveredInsertionIndex;if(void 0!==s){const e=r.indexOf(i);r.splice(e,1);const o=n.hoveredInsertionParent??t.definition();r===o.parameters&&e<s&&(s-=1),o.parameters.splice(s,0,i)}}Oj.parameterReorder=null},onCancel(){t.selectParameter(e)}})})(e):t.canSelectParameter()&&t.selectParameter(e)};o={onpointerdown:e,onpointerenter:e=>{0===e.buttons&&Oj.project.selectableExistsAndIsValid(t.stack.heroSelectable)&&(Oj.project.hoveredItem=t.stack.heroSelectable)},onpointerleave:e=>{Oj.project.hoveredItem=null}}}const a=t.heroParameter();let l,c;{let e=a.name;if(t.isEmbed())e=yf(a.name);else if(t.canRenameParameter()){const n=Oj.autoSelectForRename===a;n&&(Oj.autoSelectForRename=void 0),e=Oe(MV,{value:a.name,onchange:e=>t.renameParameter(e),autoSelect:n})}l=Oe(".parameter-name",o,e)}{let e;if(t.stack.isMixed){e=Oe(Zo,{message:()=>[`Mixed ${a.name} value.`,Oe("br"),`Click to set the first selected ${a.name} value on all selected items.`]},Oe("button.mixed-hint",{onclick:e=>{e.stopPropagation(),t.stack.setEditingExpressionCode(t.heroExpression().jsCode),t.stack.commitEditingExpression()}},"Mixed "))}const n=t.heroExpression(),i=t.heroExpressionTrace(),r=n.literalUnit(),s=Oj.project.settings.units,o=r&&r!==s;let l;(!t.isLiteral()||o)&&(l=Oe(CY,{expressionTrace:i,units:o?s:void 0,selectable:t.stack.heroSelectable})),c=Oe(".parameter-value",[Oe(HY,{expression:n,expressionTrace:i,parameterInterface:t.interface(),isImmutable:t.isImmutable(),isEditingExpression:t.isEditingExpression(),onChangeCode:e=>t.changeCode(e),onCommitCode:()=>t.commitCode(),onExpressionEditorBlur:()=>t.onExpressionBlur(),mixedHint:e}),l])}const h=()=>{Ps(t.interface()instanceof iw),ia.open({modalView:()=>Oe($Y,{parameter:t.heroParameter(),onChange:e=>{if(!t.isLiteral())return;const n=t.heroExpression().literalValue();if(!Ys(n))return;e.some(e=>e.value===n)||t.changeCode(Rb(e[0].value))}})})};let u=[];if(t.isEmbed())t.isOverridden()&&u.push(Oe(Zo,{message:()=>"Revert Parameter to Default"},Oe(ea,{icon:"revert",onpointerdown:()=>t.revertToDefault()})));else{if(t.canEditExpression()&&s.push({label:"Edit Expression",action:()=>t.editExpression()}),(t.canRevertToDefault()||t.canSetAsDefault())&&(s.length&&s.push({type:"separator"}),t.canRevertToDefault()&&s.push({label:"Revert to Default Value",action:()=>t.revertToDefault()}),t.canSetAsDefault()&&s.push({label:"Set as Default Value",action:()=>t.setAsDefault()})),(t.canAddComment()||t.canRemoveComment())&&(s.length&&s.push({type:"separator"}),t.canAddComment()&&s.push({label:"Add Comment",action:()=>t.addComment()}),t.canRemoveComment()&&s.push({label:"Delete Comment",action:()=>t.removeComment()})),t.canChangeInterface()){const e=t.interface();if(s.length&&s.push({type:"separator"}),s.push(((e,t)=>{const n=e=>()=>{if(e)return Oe(Jo,{icon:"check"})};return{label:"Parameter Type",submenu:()=>[{label:"Auto",icon:n(void 0===e.interface),action:()=>e.interface=void 0},{type:"separator"},{label:"Angle",icon:n(e.interface instanceof Xb),action:()=>{e.interface=new Xb;const t=Yy(e.expression.jsCode);t&&"Number"===t.type||(e.expression.jsCode="0")}},{label:"Checkbox",icon:n(e.interface instanceof Zb),action:()=>{e.interface=new Zb;const t=Yy(e.expression.jsCode);t&&"Boolean"===t.type||(e.expression.jsCode="false")}},{label:"Color",icon:n(e.interface instanceof nw),action:()=>{e.interface=new nw;const t=Yy(e.expression.jsCode);if(t){if("Color"===t.type)return;if("String"===t.type&&"none"===t.value)return}e.expression.jsCode="Color(0.000, 0.000, 0.000, 1.000)"}},{label:"Emoji",icon:n(e.interface instanceof lw),action:()=>{e.interface=new lw,e.expression.jsCode.startsWith('"https')||(e.expression.jsCode=`"${ur}/noto-emoji-600/1f642.svg"`)}},{label:"Font",icon:n(e.interface instanceof ow),action:()=>{e.interface=new ow,e.expression.jsCode.startsWith('"http')||e.expression.jsCode.startsWith('"Font(')||(e.expression.jsCode='"https://fonts.gstatic.com/s/notosans/v39/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A99d41P6zHtY.ttf"')}},{label:"Image",icon:n(e.interface instanceof cw),action:()=>{e.interface=new cw,e.expression.jsCode.startsWith('"https')||(e.expression.jsCode='""')}},{label:"Number",icon:n(e.interface instanceof qb),action:()=>{e.interface=new qb;const t=Yy(e.expression.jsCode);t&&"Number"===t.type||(e.expression.jsCode="0.00")}},{label:"Percent",icon:n(e.interface instanceof Kb),action:()=>{e.interface=new Kb;const t=Yy(e.expression.jsCode);t&&"Number"===t.type?e.expression.jsCode=t.string:e.expression.jsCode="0.00"}},{label:"Point",icon:n(e.interface instanceof tw),action:()=>{e.interface=new tw;const t=Yy(e.expression.jsCode);t&&"Vec"===t.type||(e.expression.jsCode="Vec(0.00, 0.00)")}},{label:"Select",icon:n(e.interface instanceof iw),action:()=>{if(e.interface instanceof iw)return void t();const n=[],i=Yy(e.expression.jsCode);i&&"String"===i.type?n.push({label:i.value,value:i.value}):(n.push({label:"first",value:"first"},{label:"second",value:"second"}),e.expression.jsCode='"first"'),e.interface=new iw(n),t()}},{label:"Text",icon:n(e.interface instanceof aw),action:()=>{e.interface=new aw;const t=Yy(e.expression.jsCode);t&&"RichText"===t.type||(t&&"String"===t.type?e.expression.jsCode=`RichText(${JSON.stringify(t.value)})`:e.expression.jsCode='RichText("Aa")')}},{type:"separator",visible:FT},{label:["Distance",Oe(".feature-tag","ADMIN")],icon:n(e.interface instanceof Yb),action:()=>{e.interface=new Yb;const t=Yy(e.expression.jsCode);t&&"Number"===t.type||(e.expression.jsCode="0.00")},visible:FT},{label:["Vector",Oe(".feature-tag","ADMIN")],icon:n(e.interface instanceof ew),action:()=>{const t=window.prompt("Vector parameters move relative to a Point parameter. What is the origin Point parameter name? For example, p1.",e.interface instanceof ew?e.interface.originParameterName:"");if(!t||""===t)return;e.interface=new ew(t);const n=Yy(e.expression.jsCode);n&&"Vec"===n.type||(e.expression.jsCode="Vec(0.00, 0.00)")},visible:FT}]}})(t.heroParameter(),h)),e instanceof iw&&s.push({label:"Edit Select Options",action:h}),e instanceof lw){const n=t.heroExpression().literalValue();n&&Ys(n)?e.recommendedValues.includes(n)?s.push({label:"Remove Emoji from Recommended",action:()=>{if(!Ys(n))return;const i=e.recommendedValues.filter(e=>e!==n);t.changeInterface(new lw(i))}}):s.push({label:"Add Emoji to Recommended",action:()=>{if(!Ys(n))return;const i=[...e.recommendedValues,n];t.changeInterface(new lw(i))}}):s.push({label:"Add Emoji to Recommended",action:()=>{},enabled:()=>!1})}if(e instanceof ow){const n=t.heroExpression().literalValue();Ys(n)||n instanceof Tr?(d=n,p=e.recommendedValues,aL.isFontInArrayOrArchive(d,p)?s.push({label:"Remove Font from Recommended",action:()=>{if(!(Ys(n)||n instanceof Tr))return;const i=n instanceof Tr?n.url:n,r=e.recommendedValues.filter(e=>e!==i);t.changeInterface(new ow(r))}}):s.push({label:"Add Font to Recommended",action:()=>{if(!(Ys(n)||n instanceof Tr))return;const i=n instanceof Tr?n.url:n,r=[...e.recommendedValues,i];t.changeInterface(new ow(r))}})):s.push({label:"Add Font to Recommended",action:()=>{},enabled:()=>!1})}}t.canHideParameter()&&(s.length&&s.push({type:"separator"}),s.push({label:"Hide Parameter",icon:()=>t.isHidden()?Oe(Jo,{icon:"check"}):void 0,action:()=>t.setParameterHidden(!t.isHidden()),tooltip:t.isDerived()?()=>"This parameter is hidden because it references another parameter":void 0}));const e=[];t.canExtractAsParameter()&&(e.push({label:"Extract as Project Parameter",action:()=>t.extractAsProjectParameter()}),e.push({label:"Extract as Component Parameter",action:()=>t.extractAsComponentParameter()})),t.canMoveParameterToProject()&&e.push({label:"Move Parameter to Project",action:()=>t.moveParameterToProject()}),t.canRemoveParameter()&&e.push({label:"Delete Parameter",action:()=>t.removeParameter()}),e.length&&s.push({type:"separator"},...e)}var d,p;if(s.length>0){const t=()=>{Wo({menuItems:s,spawnFrom:uo(e),placement:"top-end"})};u.push(Oe(ea,{icon:"dotdotdot",className:"extra-hidden",onpointerdown:t}))}const f=Oe(".extra",u);let m;const{comment:g}=t.heroParameter();if(void 0!==g){let e;t.canEditComment()?e=Oe(uY,{value:g??"",placeholder:"Write a note about your parameter",editable:!0,onchange:e=>t.setComment(e),autofocus:Oj.autoSelectForRename instanceof Mj&&Oj.autoSelectForRename.subject===t.heroParameter()}):""!==g&&(e=g.split("\n").map(e=>Oe("p",e))),e&&(m=Oe(".inspector-row.comment",e))}const v=t.interface()instanceof ow&&!t.isEditingExpression();return[Oe(".inspector-row.parameter",{className:r},[l,c,f]),v&&Oe(GY,{controller:t}),m]}};class XY{constructor(e,t){this.preferEditingDefinition=!1;const n=this.heroSelectable=e[0],i=n.definition();this.selectables=e.filter(e=>e.definition()===i);const r=n.expression().latestCode();this.isImmutable=this.selectables.some(e=>e.isImmutable()),this.isMixed=this.selectables.some(e=>e.expression().latestCode()!==r),this.isMultiline=r.includes("\n"),this.preferEditingDefinition=t}setEditingExpressionCode(e){for(let t of this.selectables){t.ensureEditableExpression(this.preferEditingDefinition).editingJsCode=e}}commitEditingExpression(){for(let e of this.selectables)e.expression().commitEditingCode()}tryCompileAndCommitEditingExpression(){for(let e of this.selectables){const t=e.expression();t.isCommitted()||t.tryCompileAndCommit(()=>Oj.project.allNamesInExpressionScope(t))}}revertToDefault(){for(let e of this.selectables)e.revertToDefault()}}class JY{constructor(e,t,n){this.folder=t,this.isEditingDefinition=n,this.stack=new XY(e,n)}isEmbed(){return Oj.project.focus instanceof kC}heroParameter(){return this.stack.heroSelectable.parameter}heroExpression(){return this.stack.heroSelectable.expression()}heroExpressionTrace(){return this.stack.heroSelectable.expressionTrace()}interface(){return this.heroParameter().interface}definition(){return this.stack.heroSelectable.definition()}isImmutable(){return this.stack.isImmutable}isImmutableDefinition(){return this.definition().isImmutable}isOverridden(){return this.stack.heroSelectable.isOverridden()}isLiteral(){return this.heroExpression().isLiteral()}isDerived(){return Oj.project.isParameterDerived(this.definition(),this.heroParameter())}isMultiline(){return this.stack.isMultiline}isHidden(){return Boolean(this.heroParameter().hidden)}isVisible(){return Oj.project.isParameterVisible(this.definition(),this.heroParameter())}isHovered(){return Oj.project.isItemHovered(this.stack.heroSelectable)}isSelected(){return Oj.project.selection.contains(this.stack.heroSelectable)}isEditingExpression(){var e;return(null==(e=Oj.project.expressionFocus)?void 0:e.expression)===this.heroExpression()}canRevertToDefault(){return this.isOverridden()&&!this.isImmutable()}revertToDefault(){this.stack.revertToDefault()}canEditExpression(){return this.isLiteral()||this.interface()instanceof iw}editExpression(){Oj.project.focusExpression(this.heroExpression())}canSetAsDefault(){return!this.stack.isMixed&&this.isOverridden()&&this.isEditingDefinition&&!this.isImmutableDefinition()&&!this.isEmbed()}setAsDefault(){Ps(this.stack.heroSelectable instanceof oS),this.stack.heroSelectable.setAsDefault(),this.stack.heroSelectable.revertToDefault()}canExtractAsParameter(){return this.isLiteral()&&!this.isEmbed()&&!this.isImmutable()&&!this.stack.isMixed&&!this.isEditingDefinition&&this.stack.heroSelectable instanceof oS&&(e=this.stack.heroSelectable,Oj.project.focusedComponent()===Oj.project.contextComponentForNode(e.node));var e}extractAsComponentParameter(){const e=Oj.project.focusedComponent();if(!e)return;const t=this.heroParameter(),n=Oj.project.createParameter(e,this.heroExpression().jsCode,t.name);t.interface&&(n.interface=t.interface.clone()),Oj.isComponentParameterInspectorOpen=!0,Oj.autoSelectForRename=n,this.changeCode(n.name)}extractAsProjectParameter(){if(!Oj.project.focusedComponent())return;const e=this.heroParameter(),t=Oj.project.createParameter(Oj.project,this.heroExpression().jsCode,e.name);e.interface&&(t.interface=e.interface.clone()),Oj.isProjectParameterInspectorOpen=!0,Oj.autoSelectForRename=t,this.changeCode(t.name)}canMoveParameterToProject(){return this.isLiteral()&&!this.isEmbed()&&!this.isImmutable()&&!this.stack.isMixed&&this.isEditingDefinition&&this.stack.heroSelectable instanceof aS&&(this.stack.heroSelectable.component instanceof vb||this.stack.heroSelectable.component instanceof yb)}moveParameterToProject(){Ps(this.stack.heroSelectable instanceof aS),Ps(this.stack.heroSelectable.component instanceof vb||this.stack.heroSelectable.component instanceof yb),Oj.project.moveComponentParameterToProject(this.stack.heroSelectable)}canHideParameter(){return!this.stack.isMixed&&this.isEditingDefinition&&!this.isImmutableDefinition()&&!this.isEmbed()}setParameterHidden(e){this.heroParameter().hidden=e}canRemoveParameter(){return!this.stack.isMixed&&this.isEditingDefinition&&!this.isImmutableDefinition()&&!this.isEmbed()}removeParameter(){Oj.project.removeDefinitionParameter(this.definition(),this.heroParameter())}canRenameParameter(){return!this.stack.isMixed&&this.isEditingDefinition&&!this.isImmutableDefinition()&&!this.isEmbed()}renameParameter(e){Oj.project.renameDefinitionParameter(this.definition(),this.heroParameter(),e)}canSelectParameter(){return!this.isEmbed()}selectParameter(e){e.shiftKey?Oj.project.toggleSelectItems(this.stack.selectables):Oj.project.selectItems(this.stack.selectables)}canEditComment(){return this.isEditingDefinition&&!this.isImmutableDefinition()&&!this.isEmbed()}canAddComment(){return this.canEditComment()&&void 0===this.heroParameter().comment}addComment(){const e=this.heroParameter();e.comment="",Oj.autoSelectForRename=new Mj(e)}setComment(e){this.heroParameter().comment=e}canRemoveComment(){return this.canEditComment()&&void 0!==this.heroParameter().comment}removeComment(){this.heroParameter().comment=void 0}canChangeInterface(){return this.isEditingDefinition&&!this.isImmutableDefinition()&&!this.isEmbed()}changeInterface(e){this.heroParameter().interface=e}changeCode(e){this.stack.setEditingExpressionCode(e),this.stack.isMultiline||this.stack.tryCompileAndCommitEditingExpression()}replaceCodeRange(e,t){let n=this.heroExpression().latestCode();n=n.slice(0,t.start)+e+n.slice(t.end),this.changeCode(n)}commitCode(){this.stack.commitEditingExpression()}onExpressionBlur(){this.canRevertToDefault()&&this.heroExpression().isEmpty()?this.revertToDefault():this.commitCode()}}const QY={view({attrs:{definition:e,insertionIndex:t,insertionParent:n}}){if(!Oj.parameterReorder)return null;if(e!==Oj.parameterReorder.definition)return null;const{parameterReorder:i}=Oj,r=eo({hovered:i&&i.hoveredInsertionParent===n&&i.hoveredInsertionIndex===t});return Oe(".parameter-reorder-hit-target",{className:r,onpointerenter:()=>{Oj.parameterReorder&&(Oj.parameterReorder.hoveredInsertionIndex=t,Oj.parameterReorder.hoveredInsertionParent=n)},onpointerleave:()=>{Oj.parameterReorder&&(Oj.parameterReorder.hoveredInsertionIndex=void 0,Oj.parameterReorder.hoveredInsertionParent=void 0)}})}},eX={view({attrs:{definition:e,insertionIndex:t}}){if(!Oj.parameterFolderReorder)return null;if(e!==Oj.parameterFolderReorder.definition)return null;const{parameterFolderReorder:n}=Oj,i=eo({hovered:n&&n.hoveredInsertionIndex===t});return Oe(".parameter-reorder-hit-target",{className:i,onpointerenter:()=>{Oj.parameterFolderReorder&&(Oj.parameterFolderReorder.hoveredInsertionIndex=t)},onpointerleave:()=>{Oj.parameterFolderReorder&&(Oj.parameterFolderReorder.hoveredInsertionIndex=void 0)}})}},tX=(e,t,n,i)=>t.map(t=>{let r=e.map(e=>{if(i){const n=e.instance.definition;if(n instanceof vb||n instanceof gS||n instanceof yb&&!Oj.project.isEditingCode(e.instance))return new aS(n,t)}const n=new oS(e.node,e.instance,t);return Ps(Oj.project.selectableExistsAndIsValid(n)),n});if(n||!i){const n=e[0];r=r.filter(e=>{const i=Oj.project.isParameterVisible(e.definition(),e.parameter),r=n.instance.args.hasOwnProperty(t.name);return(i||r)&&!iX(n,e)})}return r}).filter(e=>e.length>0),nX={view:({attrs:{parameterSelectables:e,parameters:t,isEditingDefinition:n,folder:i}})=>e.map(e=>{const r=new JY(e,i,n),s=r.definition(),o=t.indexOf(r.heroParameter()),a=o===t.length-1;return[Oe(QY,{definition:s,insertionIndex:o,insertionParent:i}),Oe(YY,{controller:r}),a&&Oe(QY,{definition:s,insertionIndex:o+1,insertionParent:i})]})},iX=(e,t)=>{var n,i;const{name:r}=t.parameter,s=t.definition();if(s===dx){let t=!1;const i=e.instanceTrace();if((null==(n=null==i?void 0:i.args.hairline)?void 0:n.evaluationResult)&&(t=!0),!0===t&&("width"===r||"alignment"===r||"cap"===r||"join"===r||"miterLimit"===r))return!0}if(s===cx){const t=e.instanceTrace(),n=null==(i=null==t?void 0:t.args.type)?void 0:i.evaluationResult;if("color"===n&&("image"===r||"opacity"===r||"transform"===r))return!0;if("image"===n&&"color"===r)return!0}return!1},rX={view(e){var t;const{attrs:{selectables:n,folder:i,isEditingDefinition:r}}=e,s=Oj.project.focus instanceof kC,o=n[0].definition();if(s||!r){if(i.parameters.every(e=>!Oj.project.isParameterVisible(o,e)))return}const a=n[0].isImmutable(),l=r&&!a&&!s;let c,h;{let e=i.name;if(l){const t=e=>{i.name=e},n=Oj.autoSelectForRename===i;n&&(Oj.autoSelectForRename=void 0),e=Oe(MV,{value:i.name,onchange:t,autoSelect:n})}c=Oe(".parameter-folder-name",e)}if(l){const t=()=>{Oj.project.removeDefinitionParameterFolder(o,i)};h=Oe(".extra",[Oe(ea,{icon:"dotdotdot",className:"extra-hidden",onpointerdown:n=>{n.stopPropagation();Wo({menuItems:[{label:"Delete Parameter Folder",action:t}],spawnFrom:uo(e),placement:"top-end"})}})])}const u=e=>{e.stopPropagation();Oj.expandedParameterFolders.has(i)?Oj.expandedParameterFolders.delete(i):Oj.expandedParameterFolders.add(i)},d=eo({hovered:(null==(t=Oj.parameterReorder)?void 0:t.hoveredInsertionParent)===i}),p=Oj.expandedParameterFolders.has(i),f=i.parameters.length>0&&p;return[Oe(".inspector-row.parameter-folder",{className:d,onpointerdown:e=>{l?_A(e,{cursor:()=>"grabbing",onConsummate(){Oj.parameterFolderReorder={definition:o,folder:i}},onUp(){const{parameterFolderReorder:e}=Oj;if(e){let t=e.hoveredInsertionIndex;if(void 0!==t){const e=o.parameterFolders.indexOf(i);o.parameterFolders.splice(e,1),e<t&&(t-=1),o.parameterFolders.splice(t,0,i)}}Oj.parameterFolderReorder=null},onCancel(){u(e)}}):u(e)},onpointerenter:()=>{Oj.parameterReorder&&(Oj.parameterReorder.hoveredInsertionParent=i,Oj.parameterReorder.hoveredInsertionIndex=i.parameters.length)},onpointerleave:()=>{Oj.parameterReorder&&(Oj.parameterReorder.hoveredInsertionParent=void 0,Oj.parameterReorder.hoveredInsertionIndex=void 0)}},[Oe(cY,{expanded:p,onpointerdown:u}),c,Oe(".inspector-header-space"),h]),f&&Oe(".inspector-indent",{className:d},Oe(nX,{parameterSelectables:tX(n,i.parameters,s,r),parameters:i.parameters,isEditingDefinition:r,folder:i}))]}},sX={view({attrs:{selectables:e,isEditingDefinition:t}}){const n=e[0],i=n.definition(),r=Oj.project.focus instanceof kC,s=tX(e,i.parameters,r,t),o=Oe(nX,{parameterSelectables:s,parameters:i.parameters,isEditingDefinition:t}),a=i.parameterFolders.map((n,r)=>{const s=r===i.parameterFolders.length-1;return[Oe(eX,{definition:i,insertionIndex:r}),Oe(rX,{selectables:e,folder:n,isEditingDefinition:t}),s&&Oe(eX,{definition:i,insertionIndex:r+1})]});return[0===s.length&&Oe(QY,{definition:i,insertionIndex:0}),o,a,!r&&[Oe(".inspector-row.instance-inspector-messages",[Oe(AY,{trace:n.instanceTrace(),showLogLevels:["info","warn","warn-global","error"]})]),t&&(i instanceof yb||i instanceof Nb)&&Oe(TY,{selectable:n,onClickCreateVariation:e=>{e.preventDefault(),Oj.project.createVariationOfInstance(n.instance)}})]]}},oX={view(e){const{attrs:{selectable:t,isContext:n,isModifier:i}}=e,{node:r,instance:s}=t,{definition:o}=s,a=hX(o),l=o instanceof yb||o instanceof Nb,c=o.isImmutable,h=n||Oj.project.isEditingCode(s),u=n||h,d=t.isImmutable(),p=Oj.project.focus instanceof kC,f=o instanceof gS,m=o instanceof vb||o instanceof yb,g=u&&m,v=m&&FT(),y=()=>{f?Oj.isProjectParameterInspectorOpen=!0:m&&(Oj.isComponentParameterInspectorOpen=!0)},b=u&&!c&&!p,w=b&&void 0===o.comment,x=()=>{y(),o.comment="",Oj.autoSelectForRename=new Mj(o)},C=b&&void 0!==o.comment,S=()=>{o.comment=void 0},k=u&&!c&&!p,L=()=>{y();const e=Oj.project.createParameter(o,"0");Oj.autoSelectForRename=e},E=()=>{y();const e=new uw("Folder");o.parameterFolders.push(e),Oj.autoSelectForRename=e},P=!n&&l&&!p,T=()=>{Oj.project.setEditingCode(s,!h)},A=i&&!d&&r.source.modifiers.includes(s),M=()=>{Oj.project.setEditingCode(s,!1),r.source.removeModifier(s),Oj.project.ensureProjectDataExists()},I=[],_=()=>{Oj.autoSelectForRename=o},O=u&&!c&&!p;let N=[];u||(A&&I.push({label:["Remove ",Oe("span.user-defined-name",a)," from ",Oe("span.user-defined-name",r.source.name)],action:M}),I.push({label:["Create variation of ",Oe("span.user-defined-name",a)],action:()=>Oj.project.createVariationOfInstance(s)}),O&&I.push({label:["Rename ",Oe("span.user-defined-name",a)],action:_})),g&&(I.push({label:`Show guides in uses of ${o.name}`,icon:()=>o.isShowGuides?Oe(Jo,{icon:"check"}):void 0,action:()=>o.isShowGuides=!o.isShowGuides}),I.push({label:`Scale uses of ${o.name} automatically`,icon:()=>o.isAutoScale?Oe(Jo,{icon:"check"}):void 0,action:()=>o.isAutoScale=!o.isAutoScale}),I.push({label:"Transform Style",submenu:()=>[{label:"Uniform Scale (default)",tooltip:()=>"Transformations add a Transform modifier. Scaling is uniform by default.",icon:()=>!o.isPassThrough&&o.isDefaultUniformScale?Oe(Jo,{icon:"check"}):void 0,action:()=>{o.isDefaultUniformScale=!0,Oj.project.setDefinitionIsPassThrough(o,!1)}},{label:"Freeform",tooltip:()=>"Transformations add a Transform modifier. Scaling is non-uniform by default.",icon:()=>o.isPassThrough||o.isDefaultUniformScale?void 0:Oe(Jo,{icon:"check"}),action:()=>{o.isDefaultUniformScale=!1,Oj.project.setDefinitionIsPassThrough(o,!1)}},{label:"Handles Only (advanced)",tooltip:()=>"Transformations pass through to handles and other transformable parameters. Instances can't have a Transform modifier.",icon:()=>o.isPassThrough?Oe(Jo,{icon:"check"}):void 0,action:()=>{Oj.project.setDefinitionIsPassThrough(o,!o.isPassThrough)}}]}));const D=[];k&&D.push({label:"New Parameter Folder",action:E}),w&&D.push({label:"Add Comment",action:x}),C&&D.push({label:"Remove Comment",action:S}),D.length>0&&(I.length>0&&I.push({type:"separator"}),I.push(...D));const R=[];if(v){const e=Oj.project.focusedComponent(),t=Oj.project.components.filter(t=>t!==e);t.push(...oC),t.length>0&&R.push({label:["Replace Definition",Oe(".feature-tag","ADMIN")],submenu:()=>t.map(e=>({label:e.name,action:()=>{s.replaceDefinition(e)}}))})}if(R.length>0&&(I.length>0&&I.push({type:"separator"}),I.push(...R)),I.length>0){const e=e=>{Wo({menuItems:I,spawnFrom:e.target,placement:"top-end"})};N.push(Oe(ea,{icon:"dotdotdot",className:"extra-hidden",onpointerdown:e}))}if(k&&N.push(Oe(ea,{icon:"plus",label:"New Parameter",onclick:L})),P){const e=eo({active:h});N.push(Oe(ea,{icon:"edit",label:c?"View Code":"Edit Code",onclick:T,className:e}))}let F,B,V;if(F=n?Oe(lX,{selectable:t}):Oe(aX,{selectable:t,isNameEditable:O}),void 0!==o.comment){let e;b?e=Oe(uY,{value:o.comment,placeholder:"Write a note about this",editable:b,onchange:e=>o.comment=e,autofocus:Oj.autoSelectForRename instanceof Mj&&Oj.autoSelectForRename.subject===o}):""!==o.comment&&(e=o.comment.split("\n").map(e=>Oe("p",e))),e&&(B=Oe(".inspector-row.comment",e))}void 0!==o.learnMorePageLink&&(V=Oe(".inspector-row.comment",[Oe("p",[Oe("a",{href:o.learnMorePageLink,target:"_blank"},"Learn more")," about using ",o.name])]));let j,H=s.isEnabled||h;return n&&(H=!!p||(o instanceof gS?Oj.isProjectParameterInspectorOpen:!(o instanceof vb)||Oj.isComponentParameterInspectorOpen)),H?j=[B,V,Oe(sX,{selectables:[t],isEditingDefinition:u}),s.isRepeatModifier()&&Oe(pX,{selectable:t})]:(f||m)&&(j=Oe(dX,{selectable:t,onclick:y})),Oe(".inspector-section",{className:eo({"editing-definition":u})},[!p&&Oe(".inspector-row.inspector-header",{onpointerdown:e=>{ho(e)&&I.length>0&&$o(e,I)}},[F,Oe(".inspector-header-space"),N]),j])}},aX={view({attrs:{selectable:e,isNameEditable:t,hideEnabledCheckbox:n}}){let i;if(!n&&e.isModifier()&&!e.isBase()){const t=e.isImmutable(),n=n=>{if(t)return;const i=n.target instanceof HTMLInputElement&&n.target.checked;e.instance.isEnabled=i};i=Oe(".inspector-header-enabled",[Oe(xT,{disabled:t,checked:e.instance.isEnabled,onclick:n})])}const r=e.definition();let s;r instanceof Nb&&r.icon&&(s=Oe(".inspector-header-icon",Oe(Jo,{icon:r.icon})));let o=[i,s,Oe(".inspector-header-name",{className:eo({editable:t}),onclick:e=>e.stopPropagation()},Oe(cX,{definition:r,editable:t}))];return i&&!t&&(o=Oe("label.inspector-header-label",o)),o}},lX={view({attrs:{selectable:e}}){const t=e.definition(),n=t instanceof gS,i=t.hasParameters()&&!(t instanceof yb),r=n?Oj.isProjectParameterInspectorOpen:Oj.isComponentParameterInspectorOpen;return[Oe(".inspector-header-name",{className:"editable",onclick:e=>e.stopPropagation()},Oe(cX,{definition:t,editable:!0})),i&&Oe(cY,{expanded:r,onpointerdown:()=>{n?Oj.isProjectParameterInspectorOpen=!Oj.isProjectParameterInspectorOpen:Oj.isComponentParameterInspectorOpen=!Oj.isComponentParameterInspectorOpen},className:"extra-hidden"})]}},cX={view({attrs:{definition:e,editable:t}}){const n=hX(e);if(!t)return n;let i=!1;return Oj.autoSelectForRename===e&&(i=!0,Oj.autoSelectForRename=void 0),Oe(MV,{value:n,onchange:t=>uX(e,t),autoSelect:i})}},hX=e=>e instanceof gS?Oj.storage.getProjectName():e.name,uX=(e,t)=>{e instanceof gS?Oj.storage.setProjectName(t):(e instanceof vb||e instanceof yb||e instanceof Nb)&&Oj.project.renameDefinition(e,t)},dX={view:({attrs:{selectable:e,onclick:t}})=>{var n;const i=e.instance.definition.allParameters().map(e=>e.name).join(", "),r=null==(n=e.instance.definition.comment)?void 0:n.trim().replace(/\n/g," ");if(i||r)return Oe(".inspector-row.inspector-parameters-summary",{onclick:t},[r&&Oe(".inspector-parameters-summary-comment",r),Oe(".inspector-parameters-summary-names",i),Oe("button.small-pill",{onclick:t},"Show All")])}},pX={view({attrs:{selectable:e}}){const{instance:t}=e,n=null!==t.repeatIndexVariableName;return[Oe("label.inspector-row.instance-settings-category",[Oe(xT,{checked:n,disabled:!1,onclick:()=>{t.repeatIndexVariableName?t.repeatIndexVariableName=null:Oj.project.createRepeatIndexVariable(e)}}),Oe(".instance-settings-category-name","Customize Each Repetition")]),n&&[Oe(fX,{selectable:e}),Oe(".inspector-row.comment",Oe("p","This index variable takes on a different value for each repetition, starting at 0 and increasing sequentially. You can use it in expressions to make each repetition different."))]]}},fX={view:({attrs:{selectable:e}})=>[Oe(".inspector-row.instance-setting",[Oe(".instance-setting-name",[Oe(MV,{value:e.instance.repeatIndexVariableName,onchange:t=>{Oj.project.renameRepeatIndexVariable(e,t)}})]),Oe(".instance-setting-value",Oe(mX,{trace:e.instanceTrace()}))])]},mX={view({attrs:{trace:e}}){const t=null==e?void 0:e.args.repetitions;if(!(null==t?void 0:t.isSuccess))return;let n=1;{const e=t.evaluationResult;Ks(e)&&isFinite(e)&&e>0&&(n=e)}const i=Math.min(10,n)-1;if(i<0)return;const r=n-1;return Oe(".repetitions-sequence",[i>0&&Oe("span.first-repetitions",[ts(i).join(", "),Oe("span",i<r?"  ":", ")]),Oe("span",r)])}},gX={view({attrs:{selectable:e}}){const t=Oj.project.customizedRepeatModifiersInInstanceScope(e);if(0!==t.length)return t.map(e=>{if(e.instance.isEnabled)return Oe(".inspector-section.repeat-variables.editing-definition",[Oe(".inspector-row.inspector-header",[Oe(aX,{selectable:e,isNameEditable:!1,hideEnabledCheckbox:!0})]),Oe(fX,{selectable:e})])})}},vX={view({attrs:{nodesInDocumentOrder:e,definition:t,slot:n}}){var i;const r=e.some(e=>e.isImmutable());if(r)return;let s=!1,o=0;for(let h of e){const e=h.source[n];if(e&&(e.isEnabled&&o++,!s)){const t=null==(i=Oj.traceForNode(h))?void 0:i.traceForInstance(e);t&&!t.isSuccess()&&(s=!0)}}const a=o===e.length,l=!a&&o>0;let c=Oe(xT,{disabled:r,checked:a,mixed:l,onclick:i=>{if(r)return;const s=i.target instanceof HTMLButtonElement||i.target instanceof HTMLInputElement&&i.target.checked;let o;for(let t of e){const e=t.source[n];(null==e?void 0:e.isEnabled)&&(o=e)}for(let r of e){const e=r.source[n];e instanceof wx?e.isEnabled=s:s&&(r.source[n]=o?o.clone():new wx(t))}}});return l&&(c=Oe(Zo,{message:()=>[`Mixed ${n}.`,Oe("br"),`Click to add ${n} to all selected items.`]},c)),Oe(".inspector-section",[Oe(".inspector-header.inspector-row",Oe("label.inspector-header-label",[Oe(".inspector-header-enabled",c),t instanceof Nb&&void 0!==t.icon?Oe(".inspector-header-icon",Oe(Jo,{icon:t.icon})):void 0,Oe(".inspector-header-name",t.name)])),a&&Oe(sX,{selectables:e.map(e=>{const t=e.source[n];return Ps(t),new sS(e,t)}),isEditingDefinition:!1})])}},yX={view({attrs:{component:e,heightFactor:t}}){const n=t?`flex-basis: ${(100*t).toFixed(3)}vh`:"",i=Oj.project.selection.allNodes(),r=Oj.project.selection.allInstances(),s=[],o=Oj.project.focus instanceof kC,a=o;if(!(a&&!Oj.project.definitionHasVisibleParameter(Oj.project))){const e=Oe(oX,{selectable:new wX,isContext:!0});s.push(e)}if(!(a&&!Oj.project.definitionHasVisibleParameter(e))){const t=Oe(oX,{selectable:new xX(e),isContext:!0});s.push(t)}if(!i.isEmpty()){const e=Oe(CX,{node:i.items[0].node});s.push(e)}if(r.isSingle()&&i.isSingle()){const e=r.items[0];s.push(Oe(gX,{selectable:e}),Oe(oX,{selectable:e,isContext:!1,isModifier:!e.isBase()}))}else if(i.isSingle()){const{node:e}=i.items[0];s.push(Oe(gX,{selectable:new sS(e,e.source.base)}),Oe(bX,{node:e}))}else if(i.isMultiple()&&!i.hasAnchor()){const e=i.sortInDocumentOrder().items.map(e=>e.node);s.push(Oe(vX,{nodesInDocumentOrder:e,slot:"fill",definition:cx})),s.push(Oe(vX,{nodesInDocumentOrder:e,slot:"stroke",definition:dx}))}if(!o||0!==s.length)return Oe(".inspector",{className:eo({scrollable:!o}),style:n},s)}},bX={view({attrs:{node:e}}){const t=new sS(e,e.source.base);return[Oe(oX,{selectable:t}),!e.source.isPassThrough()&&Oe(vX,{nodesInDocumentOrder:[e],slot:"transform",definition:lx}),!e.isAnchor()&&[Oe(vX,{nodesInDocumentOrder:[e],slot:"fill",definition:cx}),Oe(vX,{nodesInDocumentOrder:[e],slot:"stroke",definition:dx})],e.source.modifiers.map(t=>{const n=new sS(e,t);return Oe(oX,{selectable:n,isModifier:!0})})]}};class wX extends sS{constructor(){const e=new wx(Oj.project);super(new DC(null,new bx(e)),e)}instanceTrace(){var e;return null==(e=Oj.projectTrace)?void 0:e.base}}class xX extends sS{constructor(e){const t=new wx(e);super(new DC(null,new bx(t)),t),this.component=e}instanceTrace(){return Oj.traceForComponent(this.component)}}const CX={view({attrs:{node:e}}){let t=[];const n=[];let i=e.parent;for(;i;)i.createsNewContext()&&n.unshift(i),i=i.parent;for(let r of n){const e=new sS(r,r.source.base);t.push(Oe(oX,{selectable:e}))}return t}},SX=()=>{const e=new nk;return{view({attrs:{component:t,canvasDimensions:n,zoomViewport:i,hideRulers:r}}){let s;const o=t instanceof yb,a=Oj.traceForComponent(t);if((null==a?void 0:a.isSuccess())&&(s=a.result,i)){const t=s.boundingBox();t&&e.scaleToFitBoundingBox(t,n)}const l=n.size,c=e.viewMatrixWithBounds(n.usableArea);return Oe(".viewport-main",Oe($W,{viewportSize:l,render:(t,n)=>{n.fillStyle=qL.color.white,n.fillRect(0,0,t.x,t.y);const{units:i,gridDivisions:a}=Oj.project.settings;Oj.project.isGridEnabled&&KL(c,e,t,a,n),s&&EA(s,c,n,t,o),r||xH(c,e,t,i,a,n)}}))}}},kX={view:({attrs:{component:e,marginBottom:t,zoomViewport:n,hideRulers:i}})=>Oe(yL,{className:"svg-preview-canvas-autosize",view:r=>{const s=new It(r.width,r.height),o=i?new It(0,0):new It(wH,wH),a=new It(s.x,s.y-t),l=new De(o,a),c=new ik(s,l);return Oe(SX,{component:e,canvasDimensions:c,zoomViewport:n,hideRulers:i})}})},LX=(e,t)=>Oe(".thumbnail",{style:`width:${e}px;height:${t}px`}),EX={onbeforeupdate(e,t){if(Oj.isFirstRedrawAfterBecameVisible)return!0;return!(e.attrs.graphic===t.attrs.graphic&&this.latestPixelRatio===DT())},onupdate(){this.latestPixelRatio=DT()},view({attrs:{graphic:e,width:t,height:n,padding:i}}){if(!e)return LX(t,n);const r=new It(t-2*i,n-2*i),s=e.looseBoundingBox();if(!s)return LX(t,n);let o=s.size();o.isZero()&&(s.expandScalar(.5),o.set(1,1));const a=o.x/o.y,l=r.x/r.y;let c;if(a>l){const e=o.x/l-o.y;c=new It(0,e/2)}else{const e=o.y*l-o.x;c=new It(e/2,0)}const h=Math.min(r.x/o.x,r.y/o.y),u=Ne.fromTransform({position:new It(i,i)}).mul(Ne.fromTransform({scale:h})).mul(Ne.fromTransform({position:c.clone().sub(s.min)})),d=e.clone().affineTransform(u).scaleStroke(h);return Oe(".thumbnail-color",{style:`width:${t}px; height:${n}px;`},Oe($W,{viewportSize:new It(t,n),render:(e,t)=>{t.clearRect(0,0,e.x,e.y),sr(d,t,e,{hairlineStrokeWidth:.5/(this.latestPixelRatio||1)})}}))}},PX="hasSeenCustomize";class TX{constructor(e,t,n,i,r){this.componentIds=e,this.selectedComponentId=e[0],this.showCustomizeHint=!0,this.nodeViewRendererProps=r,this.hideActionsAndDimensions=t,this.hideRulers=n,this.hideParameters=i,this.isGallery=Oj.isEditingMode()?e.length>1:e.filter(e=>Boolean(Oj.project.componentById(e))).length>1}selectComponent(e){this.selectedComponentId=e}selectedComponent(){return Oj.project.componentById(this.selectedComponentId)}lastComponent(){const e=this.componentIds[this.componentIds.length-1];return Oj.project.componentById(e)}hasDownloadableComponent(){const e=this.lastComponent();return Boolean(e&&"none"!==e.defaultExportFormat)}addComponent(e){const t=this.getEditorPos();Oj.activeDocEditor&&void 0!==t&&Oj.activeDocEditor.chain().focus().makeOrAddToCuttleGallery({currentIds:this.componentIds,componentId:e,pos:t}).run()}removeComponent(e){if(1===this.componentIds.length)return;const t=this.getEditorPos();Oj.activeDocEditor&&void 0!==t&&Oj.activeDocEditor.chain().focus().removeFromCuttleGallery({currentIds:this.componentIds,componentId:e,pos:t}).run()}getEditorPos(){var e;if("function"==typeof(null==(e=this.nodeViewRendererProps)?void 0:e.getPos))return this.nodeViewRendererProps.getPos()}}const AX=e=>{const t=new TX(e.attrs.componentIds,Boolean(e.attrs.hideActionsAndDimensions),Boolean(e.attrs.hideRulers),Boolean(e.attrs.hideParameters),e.attrs.nodeViewRendererProps);return{view(e){var n;const{componentIds:i}=e.attrs,r=t.selectedComponent();if(!r)return Oe("figcaption",{class:"error"},"Component not found in this project. Remove this block, and embed the component again.");const s=Oj.storage.hasWritePermission()&&Oj.isEditingMode(),o=t.isGallery||s,a=!t.hideParameters&&(r.hasParameters()||Oj.project.hasParameters()),l=a&&!s&&t.showCustomizeHint,c=va.loggedInUser&&va.storageGet(PX),h=l&&!c,u=e=>{e.stopPropagation(),h&&(t.showCustomizeHint=!1,va.loggedInUser&&va.storageUpdate({[PX]:!0}))},d=[];if(!t.hideActionsAndDimensions){const e=t.lastComponent(),n=e&&(t.hasDownloadableComponent()||s),i=e&&s,r=!t.hasDownloadableComponent();if(n&&d.push(Oe(".component-embed-download",Oe(_X,{component:e,className:eo({"component-embed-download-primary":!0,secondary:r,"has-next-button":i})}))),i){const i=()=>{t.selectComponent(e.id)};d.push(Oe(".component-embed-file-type",Oe(OX,{component:e,onMenuOpen:i,className:eo({button:!0,secondary:r,"has-previous-button":n})})))}}return Oe(".component-embed",{className:eo({"has-parameters":a})},[Oe(".component-embed-wide-sticky",[Oe(".component-embed-narrow-sticky",[Oe(".component-embed-canvas",[Oe(kX,{component:r,marginBottom:t.hideActionsAndDimensions?0:56,zoomViewport:!IA,hideRulers:t.hideRulers}),!t.hideActionsAndDimensions&&Oe(".component-embed-actions",[Oe(".component-embed-actions-left-spacer"),Oe(".component-embed-dimensions",Oe(cH,{component:r})),d])])]),o&&Oe(".component-embed-under",[Oe(MX,{componentIds:i,context:t,canEdit:s})])]),a&&Oe(".component-embed-meta",{onkeydown:u,onkeyup:u,onkeypress:u,oncopy:u,oncut:u,onpaste:u,onclick:u,className:eo({"show-hint":h})},[h&&Oe(".customize-hint",{onclick:onclick},"Customize this!"),Oe(".component-embed-inspector",Oe(yX,{component:r})),Oe(".component-embed-warnings",[Oe(".instance-inspector-messages",[Oe(AY,{trace:Oj.traceForComponent(r),showLogLevels:["info","warn","warn-global","error"]}),Oe(AY,{trace:null==(n=Oj.projectTrace)?void 0:n.base,showLogLevels:["info","warn","warn-global","error"]}),Oe(MY,{component:r,showLogLevels:["warn-global"]})])])])])}}},MX={view(e){const{componentIds:t,context:n,canEdit:i}=e.attrs;return Oe(".component-gallery-thumbnails",[t.map((e,r)=>{const s=Oj.project.componentById(e),o=i&&t.length>1&&Oe(".component-gallery-remove",[Oe(".component-gallery-icon-background",[Oe(ea,{icon:"x",onclick:()=>n.removeComponent(e)})])]);if(!s){if(!i)return;return Oe(Zo,{message:()=>" Component not found. Remove this one from the gallery.",placement:"bottom"},Oe(".component-gallery-thumbnail.error",o))}const a=r===t.length-1&&"none"!==s.defaultExportFormat&&!n.hideActionsAndDimensions,l=Oj.tracesByDefinition.get(s),c=null==l?void 0:l.result;return Oe(Zo,{message:()=>s.name,placement:"bottom"},Oe(".component-gallery-thumbnail",{className:eo({selected:e===n.selectedComponentId})},[Oe("div",{onclick:()=>n.selectComponent(e)},Oe(EX,{graphic:c,width:120,height:90,padding:8}),a&&Oe(Xo,{icon:"download_badge"})),o]))}),i&&Oe(IX,{componentIds:t,context:n})])}},IX={view(e){const{componentIds:t,context:n}=e.attrs,i=Oj.project.components.filter(e=>!e.isImmutable&&!t.includes(e.id));if(0===i.length)return;return Oe(Zo,{message:()=>"Add Component",placement:"right",className:"add-component-to-gallery"},Oe(ea,{onclick:e=>{var t;const r=[];for(const s of i){const e=null==(t=Oj.tracesByDefinition.get(s))?void 0:t.result;r.push({label:s.name,icon:()=>Oe(".doc-editor-line-menu-components-thumbnail",Oe(YW,{graphic:e,width:20,height:20,padding:2})),action:()=>{n.addComponent(s.id)}})}Wo({className:"doc-editor-line-menu-components",menuItems:r,spawnFrom:e.currentTarget,placement:"right-start"})},icon:"plus"}))}},_X={view(e){const{component:t,className:n}=e.attrs,i="none"===t.defaultExportFormat;if(i)return Oe("button",{className:n,disabled:i},"Download Hidden");const r=[t],s="Download "+t.defaultExportFormat.toUpperCase(),o=Oj.storage.isProTemplate()&&Oe(tT,{hasAccess:Oj.business.hasProFeature("templates")});return Oe("button",{onclick:()=>{const e=xP(r);LH(e)},className:n},[Oe(Jo,{icon:"download"}),s,o])}},OX={view(e){const{component:t,onMenuOpen:n,className:i}=e.attrs,r=t.defaultExportFormat,s=[{label:"SVG",format:"svg"},{label:"PDF",format:"pdf"},{label:"PNG",format:"png"},{label:"DXF",format:"dxf"}],o=[];for(let a of s)o.push({label:a.label,icon:()=>r===a.format?Oe(Jo,{icon:"check"}):void 0,action:()=>{t.defaultExportFormat=a.format}});return o.push({type:"separator"}),o.push({label:"Hide Download Button",icon:()=>"none"===r?Oe(Jo,{icon:"check"}):void 0,action:()=>{t.defaultExportFormat="none"},tooltip:()=>"Hides the download button for this component in the packaged view."}),Oe(ea,{icon:"chevron_down",className:i,label:"Export File Type",onclick:()=>{n(),Wo({menuItems:o,spawnFrom:uo(e),placement:"bottom-start"})}})}},NX=(e,t)=>{const{editor:n,getPos:i}=t,r=document.createElement("div");r.setAttribute("data-drag-handle","true"),e.setAttribute("data-has-drag-handle","true"),e.setAttribute("tabindex","0"),e.addEventListener("focus",()=>{"function"==typeof i&&n.commands.setNodeSelection(i())}),e.prepend(r);let s=!1;const o=e=>{0===e.button&&"function"==typeof i&&(n.commands.setNodeSelection(i()),s=!0,window.addEventListener("mouseup",a))},a=()=>{s=!1,window.removeEventListener("mouseup",a)},l={view:()=>Oe(".drag-handle.icon-button",{onmousedown:o},Oe(Jo,{icon:"drag_handle"}))};return Oe.mount(r,l),setTimeout(()=>{e.removeAttribute("draggable")},100),{selectNode(){e.classList.add("ProseMirror-selectednode")},deselectNode(){e.classList.remove("ProseMirror-selectednode")},stopEvent(e){if(s)return!1;return(null==e?void 0:e.target)!==r&&(("drop"!==e.type||!n.view.dragging)&&(e.type.startsWith("drag")&&e.preventDefault(),!0))},destroy(){Oe.mount(r,null)}}},DX="cuttleComponent",RX=bF.create({name:DX,content:"",marks:"",group:"block",selectable:!1,draggable:!1,addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>({componentid:{default:null}}),parseHTML:()=>[{tag:"figure",getAttrs:e=>{if("string"==typeof e)return!1;if(!(e instanceof HTMLElement))return!1;let t=e.getAttribute("data-cuttle-component-id");return!!t&&(t=t.split(","),{componentid:t})}}],renderHTML:({HTMLAttributes:e})=>["figure",{"data-cuttle-component-id":Xs(e.componentid)?e.componentid.join(","):e.componentid}],renderText:({node:e})=>`[Cuttle component embed: ${Xs(e.attrs.componentid)?e.attrs.componentid.join(", "):e.attrs.componentid}]\n\n`,addNodeView:()=>e=>{const{node:t}=e,n=document.createElement("figure"),i=Xs(t.attrs.componentid)?t.attrs.componentid.join(","):t.attrs.componentid;n.setAttribute("data-cuttle-component-id",i),function(e,t,n){Oe.mount(e,{view:function(){return Xs(t)||(t=[t]),Oe(AX,{componentIds:t,nodeViewRendererProps:n})}})}(n,t.attrs.componentid,e);const r=NX(n,e);return{dom:n,...r,destroy(){var e;r.destroy(),e=n,Oe.mount(e,null)}}},addCommands(){return{insertCuttleComponent:e=>({chain:t,editor:n})=>{const{component:i}=e,{selection:r}=n.state,s=r.$head;return t().insertContentAt(s.before(),[{type:this.name,attrs:{componentid:[i.id]}}]).run()},makeOrAddToCuttleGallery:e=>({tr:t,dispatch:n})=>{const{currentIds:i,componentId:r,pos:s}=e,o=t.doc.nodeAt(s);if((null==o?void 0:o.type.name)!==DX)return!1;const a=Xs(i)?[...i,r]:[i,r];return null==n||n(t.setSelection(zI.create(t.doc,s)).setNodeAttribute(s,"componentid",a)),!0},removeFromCuttleGallery:e=>({tr:t,dispatch:n})=>{const{currentIds:i,componentId:r,pos:s}=e,o=t.doc.nodeAt(s);if((null==o?void 0:o.type.name)!==DX)return!1;const a=i.filter(e=>e!==r);return null==n||n(t.setSelection(zI.create(t.doc,s)).setNodeAttribute(s,"componentid",a)),!0}}}}),FX=/!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\)/,BX=(e,t,n)=>{if(t)return`/${mr}/${e}`;return`https://${fr}.imgix.net/${e}?auto=compress,format&q=${40+40/n}&fit=max&width=700&height=1280&dpr=${n}`},VX=bF.create({name:"cuttleImage",selectable:!1,draggable:!1,addOptions:()=>({inline:!1,HTMLAttributes:{}}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},addAttributes:()=>({path:{default:null},alt:{default:null}}),parseHTML:()=>[{tag:"img[path]"}],renderHTML({HTMLAttributes:e}){let t,n;if("data:"===e.path.substring(0,5))t=e.path;else{const i=vo(e.path),r=BX(e.path,i,1);if(t=r,!i){n=`${r} 1x, ${BX(e.path,i,2)} 2x`}}return["figure",{class:"doc-image"},["img",aR(this.options.HTMLAttributes,e,{src:t,srcset:n})]]},renderText:({node:e})=>`[Cuttle image embed: ${BX(e.attrs.path,!0,1)}]\n\n`,addCommands(){return{setCuttleImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[mF({find:FX,type:this.type,getAttributes:e=>{const[,t,n]=e;return{src:n,alt:t}}})]}}),jX=e=>{const{creationDate:t,firstMadePublicDate:n,publishedDate:i}=e;if(n){const e=Po(n);if(i){const t=Po(i);if(e!==t)return`${e} (updated ${t})`}return e}return Po(t)},HX=e=>wo(e.ownerUsername,e.name,e.projectId),UX={view:({attrs:{project:e,openLinksInNewTab:t,price:n,hideOwner:i}})=>Oe(".card",[Oe(zX,{project:e,openLinksInNewTab:t,price:n}),Oe(".card-info",[Oe(WX,{project:e,openLinksInNewTab:t}),i?null:Oe(GX,{project:e,openLinksInNewTab:t})])])},zX={view({attrs:{project:e,openLinksInNewTab:t,price:n}}){const i=e.name||"Untitled Project";let r;if(e.coverPhoto){const{src:t,srcset:n}=(e=>{if(vo(e)){const t=`/${mr}/${e}`;return{src:t,srcset:`${t} 1x`}}const t=yo(e,1);return{src:t,srcset:`${t} 1x, ${yo(e,2)} 2x`}})(e.coverPhoto);r=Oe("img.card-image",{alt:i,src:t,srcset:n})}else{const t=e=>{e.target.src=ko};r=Oe("img.card-image",{alt:i,src:e.previewImage,onerror:t})}const s=va.loggedInUser?Oe(".card-favorite",Oe(vU,{projectId:e.projectId})):null;let o;return"free"===n?o=Oe(".card-price-free","free"):"pro"===n&&(o=Oe(".card-price-pro","pro")),Oe("a",{href:HX(e),target:t?"_blank":void 0},[Oe(".container-16-by-9.card-cover",[r,s,o])])}},WX={view({attrs:{project:e,openLinksInNewTab:t}}){const n=e.name||"Untitled Project";return Oe(".card-title-row",[Oe("a",{href:HX(e),target:t?"_blank":void 0},n)])}},GX={view({attrs:{project:e,openLinksInNewTab:t}}){const n=e.ownerDisplayName||`@${e.ownerUsername}`,i={href:`/@${e.ownerUsername}`,target:t?"_blank":void 0};return Oe(".card-owner-date-row",[Oe(Oe.route.Link,{...i,"aria-hidden":"true"},[Oe(ya,{avatarUrl:e.ownerAvatar,username:e.ownerUsername,size:35})]),Oe(".card-owner-date-right-side",[Oe(".card-owner",[Oe(Oe.route.Link,i,n)]),Oe(".card-date",jX(e))])])}},$X=qs().startOfInput.string(hr).string("/@").oneOrMore.anyChar.char("-").namedCapture("id").oneOrMore.word.end().toRegex(),ZX=e=>{const t=$X.exec(e.trim());if(t&&t.groups)return t.groups.id},qX=bF.create({name:"cuttleProjectCard",content:"",marks:"",group:"block",selectable:!1,draggable:!1,addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>({cuttleprojectid:{default:null}}),parseHTML:()=>[{tag:"figure",getAttrs:e=>{if("string"==typeof e)return!1;if(!(e instanceof HTMLElement))return!1;const t=e.getAttribute("data-cuttle-project-id");return!!t&&{cuttleprojectid:t}}}],renderHTML:({HTMLAttributes:e})=>["figure",{"data-cuttle-project-id":e.cuttleprojectid}],renderText:({node:e})=>`[Cuttle project card embed: ${e.attrs.cuttleprojectid}]\n\n`,addNodeView:()=>e=>{const{node:t}=e,n=document.createElement("figure");var i,r;n.setAttribute("data-cuttle-project-id",t.attrs.cuttleprojectid),i=n,r=t.attrs.cuttleprojectid,Oe.mount(i,{view:function(){const e=mU.getProject(r);return"loading"===e?Oe("figcaption.loading-message","Loading project info..."):Oe(UX,{project:e,openLinksInNewTab:Oj.isEditingMode()})}});const s=NX(n,e);return{dom:n,...s,destroy(){s.destroy(),function(e){Oe.mount(e,null)}(n)}}},addCommands(){return{insertCuttleProjectCard:e=>({chain:t,editor:n})=>{const{url:i}=e,r=ZX(i);if(r){const{selection:e}=n.state,i=e.$head;return t().insertContentAt(i.before(),[{type:this.name,attrs:{cuttleprojectid:r}}]).run()}return!1}}},addProseMirrorPlugins(){return[new n_({key:new s_("handlePasteCuttleProjectURL"),props:{handlePaste:(e,t,n)=>{if(1!==n.content.childCount)return!1;const{state:i}=e,{selection:r}=i,{empty:s}=r;if(!s)return!1;const o=r.$head;if(o.node().content.size>0)return!1;let a="";n.content.forEach(e=>{a+=e.textContent});const l=ZX(a);return!!l&&(this.editor.chain().insertContentAt(o.before(),[{type:this.name,attrs:{cuttleprojectid:l}}]).run(),!0)}}})]}});let KX=!1;const YX=e=>{e.setAttribute("data-selection-changing","false")},XX=LR.create({name:"selectionChanging",addCommands:()=>({cuttleAllowSelectionMenu:()=>({editor:e})=>(setTimeout(()=>{const t=e.view.dom.parentElement;t&&YX(t)}),!0)}),onSelectionUpdate(){const e=this.editor.view.dom.parentElement;e&&(e=>{if(KX)return;KX=!0,(e=>{e.setAttribute("data-selection-changing","true")})(e);const t=()=>{KX=!1,YX(e),window.removeEventListener("pointerup",t),window.removeEventListener("keyup",t)};window.addEventListener("pointerup",t),window.addEventListener("keyup",t)})(e)}}),JX=qs().startOfInput.string("http").optional.string("s").string("://").optional.string("m.").optional.string("www.").anyOf.string("youtu.be/").group.string("youtube.com/").anyOf.string("embed/").string("watch/").string("shorts/").string("v/").string("?v=").string("watch?v=").end().end().end().namedCapture("id").oneOrMore.anyOf.word.string("-").end().end().toRegex(),QX=e=>{const t=JX.exec(e.trim());if(t&&t.groups)return t.groups.id},eJ=bF.create({name:"videoPlayer",content:"",marks:"",group:"block",selectable:!1,draggable:!1,addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>({videoid:{default:null},provider:{default:"youtube"}}),parseHTML:()=>[{tag:"figure",getAttrs:e=>{if("string"==typeof e)return!1;if(!(e instanceof HTMLElement))return!1;const t=e.getAttribute("videoid");return!!t&&{videoid:t,provider:"youtube"}}}],renderHTML({HTMLAttributes:e}){return["figure",aR({class:"doc-video-player"},this.options.HTMLAttributes,e)]},renderText:({node:e})=>`[Cuttle video embed: https://youtu.be/${e.attrs.videoid}]\n\n`,addNodeView(){return e=>{const{node:t,HTMLAttributes:n}=e,i=document.createElement("figure");i.classList.add("doc-video-player");const r=aR({class:"doc-video-player"},this.options.HTMLAttributes,n);for(let h of Object.keys(r))i.setAttribute(h,r[h]);const s=document.createElement("div");s.classList.add("doc-video-player-iframe-wrapper"),i.appendChild(s);const o={src:`https://www.youtube-nocookie.com/embed/${n.videoid}?rel=0&modestbranding=1&playsinline=1`,allow:"fullscreen; picture-in-picture;"},a=document.createElement("iframe");a.setAttribute("src",o.src),a.setAttribute("allow",o.allow),s.appendChild(a);const l=document.createElement("figcaption"),c=document.createElement("a");c.setAttribute("href",`https://youtu.be/${n.videoid}`),c.setAttribute("target","_blank"),c.setAttribute("rel","noreferrer noopener nofollow"),c.textContent="Watch on YouTube",l.appendChild(c),i.appendChild(l);return{dom:i,...NX(i,e)}}},addCommands(){return{insertVideoPlayer:e=>({chain:t,editor:n})=>{const{url:i}=e,r=QX(i);if(r){const{selection:e}=n.state,i=e.$head;return t().insertContentAt(i.before(),[{type:this.name,attrs:{videoid:r,provider:"youtube"}}]).run()}return!1}}},addProseMirrorPlugins(){return[new n_({key:new s_("handlePasteVideoURL"),props:{handlePaste:(e,t,n)=>{if(1!==n.content.childCount)return!1;const{state:i}=e,{selection:r}=i,{empty:s}=r;if(!s)return!1;const o=r.$head;if(o.node().content.size>0)return!1;let a="";n.content.forEach(e=>{a+=e.textContent});const l=QX(a);return!!l&&(this.editor.chain().insertContentAt(o.before(),[{type:this.name,attrs:{videoid:l,provider:"youtube"}}]).run(),!0)}}})]}}),tJ=LR.create({name:"imageUploadExtension",addProseMirrorPlugins:()=>[iJ],addCommands:()=>({cuttleImagePick:()=>({commands:e})=>(TH().then(t=>e.cuttleImageUpload({file:t})),!0),cuttleImageUpload:({file:e})=>({view:t})=>{if(!AH(e))return!1;const n={},i=t.state.tr,r=i.selection.$anchor.before(1);return i.setMeta(nJ,{add:{id:n,pos:r,fileName:e.name}}),t.dispatch(i),Oj.storage.uploadFile(e).then(e=>{const i=function(e,t){const n=iJ.getState(e).find(void 0,void 0,e=>e.id==t);return n.length?n[0].from:void 0}(t.state,n);void 0!==i&&(t.dispatch(t.state.tr.replaceWith(i,i,[t.state.schema.nodes.cuttleImage.create({path:e})]).setMeta(iJ,{remove:{id:n}})),rJ(t))},()=>{const e=t.state.tr;t.dispatch(e.setMeta(iJ,{remove:{id:n}}))}),rJ(t),!0}})}),nJ=new s_("cuttleImageUploadPlaceholder"),iJ=new n_({state:{init:()=>zN.empty,apply(e,t){t=t.map(e.mapping,e.doc);const n=e.getMeta(nJ);if(n&&n.add){const{id:i,pos:r,fileName:s}=n.add,o=document.createElement("placeholder");o.textContent=`Uploading ${s}...`;const a=jN.widget(r,o,{id:i});t=t.add(e.doc,[a])}else n&&n.remove&&(t=t.remove(t.find(void 0,void 0,e=>e.id==n.remove.id)));return t}},props:{decorations(e){return this.getState(e)},handlePaste(e,t){var n;const i=Oj.activeDocEditor;if(!i)return!1;const r=null==(n=null==t?void 0:t.clipboardData)?void 0:n.files;if(!r||!r.length)return!1;const s=r[0];if(!s)return!1;return i.chain().focus().cuttleImageUpload({file:s}).run()}},key:nJ});function rJ(e){setTimeout(()=>{e.dom.blur(),e.focus()})}const sJ=e=>{e.stopPropagation()},oJ=e=>{let t,n=e;return{view(e){n=e;const{editable:i}=e.attrs,r=eo({"is-empty":null==t?void 0:t.isEmpty});return Oe(".doc-editor",{oncontextmenu:sJ,className:r},[Oe(MU,{editable:i}),Oe(".doc-editor-wrap"),i&&[Oe(".doc-editor-menu-selection-wrap",Oe(aJ,{editor:t})),Oe(".doc-editor-menu-line-wrap",Oe(lJ,{editor:t}))]])},oncreate(e){const i=uo(e),r=i.querySelector(".doc-editor-wrap"),s=i.querySelector(".doc-editor-menu-selection-wrap"),o=i.querySelector(".doc-editor-menu-line-wrap"),{doc:a,editable:l}=e.attrs,c=()=>{(null==t?void 0:t.view)&&t.view.dom.setAttribute("spellcheck",String(t.view.hasFocus()))},h=[lY.configure({heading:{levels:[1,2,3]}}),wK.configure({openOnClick:!0})],u=[RX,VX,eJ,qX];for(const t of u)h.push(t.extend({selectable:l,draggable:l}));let d={};l&&(h.push(xZ.configure({element:s,tippyOptions:{maxWidth:"80ch",placement:"top-start",zIndex:99},shouldShow:({editor:e,view:t,state:n,from:i,to:r})=>{if(!t.hasFocus())return!1;const{doc:s,selection:o}=n,a=NR(o);if(!a)return!1;return!(o.empty||a&&0===s.textBetween(i,r).length)&&!e.isActive("codeBlock")}}),SZ.configure({element:o,tippyOptions:{offset:[0,36],maxWidth:"100%",zIndex:99}}),CU.configure({placeholder:"Click here to write notes about your project or upload images..."}),tJ,XX),d={onUpdate({editor:e}){n.attrs.onchange(e.getJSON())},onSelectionUpdate(){Oe.redraw()},onCreate({editor:e}){Oj.activeDocEditor=e,c()},onDestroy(){Oj.activeDocEditor=void 0},onFocus(){c()},onBlur(){c()}});const p=l?a:(e=>{if(!e.content)return e;const t=e.content.filter(e=>"paragraph"!==e.type&&"heading"!==e.type||!(!e.content||0===e.content.length)&&e.content.map(e=>e.text||"").join("").trim().length>0);return{...e,content:t}})(a);t=new pF({content:p,editable:l,element:r,extensions:h,...d,editorProps:{transformPastedHTML:OB}}),Oe.redraw()},onremove(){t&&t.destroy()}}},aJ={view:({attrs:{editor:e}})=>{if(!e)return;const t=eo({active:e.isActive("bold")}),n=eo({active:e.isActive("italic")}),i=eo({active:e.isActive("code")}),r=e.isActive("link"),s=eo({active:r});return Oe(".doc-editor-menu.doc-editor-menu-selection",[Oe("button.secondary",{onclick:()=>{e.chain().focus().toggleBold().run()},className:t},"Bold"),Oe("button.secondary",{onclick:()=>{e.chain().focus().toggleItalic().run()},className:n},"Italic"),Oe("button.secondary",{onclick:()=>{e.chain().focus().toggleCode().run()},className:i},"Code"),Oe(".doc-editor-menu-seperator"),!r&&Oe("button.secondary",{onclick:t=>{Jj({spawnFrom:t.target,label:"URL",placeholder:"https://",autofocus:!0,onsubmit:t=>{t?e.chain().focus().setLink({href:t}).run():e.view.focus()},oncancel:()=>{e.view.focus()}})},className:s},"Link"),r&&[Oe("button.secondary",{onclick:()=>{e.chain().focus().extendMarkRange("link").unsetLink().cuttleAllowSelectionMenu().run()},className:s},"Unlink"),Oe("a",{href:e.getAttributes("link").href,target:"_blank",rel:"noreferrer noopener nofollow"},"Visit Link ")],Oe(".doc-editor-menu-seperator"),Oe(lJ,{editor:e,inSelectionMenu:!0})])}},lJ={view:({attrs:{editor:e,inSelectionMenu:t}})=>{if(!e)return;const n=eo({active:e.isActive("heading",{level:1})}),i=eo({active:e.isActive("heading",{level:2})}),r=eo({active:e.isActive("bulletList")}),s=eo({active:e.isActive("orderedList")}),o=[];Oj.project.components.forEach(t=>{var n;if(t.isImmutable)return;const i=null==(n=Oj.tracesByDefinition.get(t))?void 0:n.result;o.push({label:t.name,icon:()=>Oe(".doc-editor-line-menu-components-thumbnail",Oe(YW,{graphic:i,width:20,height:20,padding:2})),action:()=>{e.chain().focus().insertCuttleComponent({component:t}).run()}})});const a=[!t&&[Oe("button.secondary",{onclick:()=>{e.chain().focus().cuttleImagePick().run()}},"Image"),Oe("button.secondary",{onclick:t=>{Jj({spawnFrom:t.target,label:"YouTube Link",placeholder:"https://youtu.be/",autofocus:!0,onsubmit:t=>{e.chain().focus().insertVideoPlayer({url:t}).run()||jT.showBasic({type:"warning",message:"YouTube link not found."})},oncancel:()=>{e.view.focus()}})}},"Video"),Oe("button.secondary",{onclick:e=>{Wo({className:"doc-editor-line-menu-components",menuItems:o,spawnFrom:e.target,placement:"bottom-start"})}},"Component"),Oe("button.secondary",{onclick:t=>{Jj({spawnFrom:t.target,label:"Cuttle Project Link",placeholder:hr+"/",autofocus:!0,onsubmit:t=>{e.chain().focus().insertCuttleProjectCard({url:t}).run()||jT.showBasic({type:"warning",message:"Cuttle project link not found."})},oncancel:()=>{e.view.focus()}})}},"Project")],Oe("button.secondary",{onclick:()=>{e.chain().focus().toggleHeading({level:1}).run()},className:n},t?"H1":"# Heading 1"),Oe("button.secondary",{onclick:()=>{e.chain().focus().toggleHeading({level:2}).run()},className:i},t?"H2":"## Heading 2"),Oe("button.secondary",{onclick:()=>{e.chain().focus().toggleBulletList().run()},className:r},t?"* List":"* Bulleted List"),Oe("button.secondary",{onclick:()=>{e.chain().focus().toggleOrderedList().run()},className:s},t?"1. List":"1. Numbered List")];return t?a:Oe(".doc-editor-menu.doc-editor-menu-line",a)}},cJ={oncreate(e){const t=uo(e),n=e=>{var t,n;return Boolean(null==(n=null==(t=e.dataTransfer)?void 0:t.types)?void 0:n.includes("Files"))},i=()=>{t.style.display="none"},r=e=>{n(e)&&(e.dataTransfer.dropEffect="copy",e.preventDefault())};window.addEventListener("dragenter",e=>{n(e)&&(t.style.display="block")}),t.addEventListener("dragenter",r),t.addEventListener("dragover",r),t.addEventListener("dragleave",i),t.addEventListener("drop",t=>{n(t)&&(t.preventDefault(),e.attrs.onDropFiles(t),i())})},view:()=>Oe(".file-drop-zone")},hJ={view:()=>Oe(cJ,{onDropFiles:e=>{UH(Array.from(e.dataTransfer.files))}})},uJ={view(e){const{size:t,onclick:n,hidePlayButton:i}=e.attrs,r=Oe(".play-button-overlay-container",{onclick:n},[Oe(".play-button-overlay",{style:{width:`${t}px`,height:`${t}px`}},[Oe(Qo,{icon:"play_button_overlay"})])]);return Oe(".play-button-overlayed",[e.children,i?null:r])}},dJ={view:({attrs:{gettingStartedState:e,isSmallWindow:t}})=>{const n=e.mode;return Oe(".getting-started","watch"===n?Oe(pJ,{gettingStartedState:e}):Oe(mJ,{gettingStartedState:e,isSmallWindow:t}))}},pJ={view:e=>{const t=e.attrs.gettingStartedState,n=t.currentStep(),i=DS.get(n.videoUrl),r=DS.get(n.captionsUrl),s=()=>{t.goto(t.stepIndex,"try")};return Oe(".modal-container",[Oe(".modal-background-overlay"),Oe(".editor-modal-box",[Oe(".lesson-title",[Oe("h1",[n.title,Oe("span.step-counter",t.stepIndex+1,"/",t.steps.length)])]),Oe("svg.lesson-ratio",{viewBox:"0 0 16 9"}),Oe(".lesson",[Oe(fJ,{videoSrc:i,captionsSrc:r,autoplay:!t.isFirstStep(),onended:s})]),Oe(".lesson-transcript",n.transcript),Oe(".lesson-actions",[Oe("button.secondary",{onclick:s},"Try it now ")])])])}},fJ=e=>{let t=e.attrs.autoplay;return{view:e=>{const{videoSrc:n,captionsSrc:i,autoplay:r,onended:s}=e.attrs;return Oe(uJ,{size:120,hidePlayButton:t,onclick:()=>{t=!0;const n=uo(e).querySelector("video");null==n||n.play()}},[Oe("video",{key:n+i,controls:!0,autoplay:r,preload:"auto",onended:s,crossorigin:"anonymous"},[Oe("source",{src:n,type:"video/mp4"}),Oe("track",{src:i,label:"English",kind:"captions",srclang:"en",default:!0})])])}}},mJ={view:({attrs:{gettingStartedState:e,isSmallWindow:t}})=>{const n=e.currentStep(),i=DS.get(n.videoThumbUrl);return Oe(".try",[t&&Oe(vJ),Oe("video.step-video-thumb",{src:i,controls:!1,autoplay:!0,loop:!0,muted:!0,crossorigin:"anonymous"}),Oe(".step-prompt",n.prompt),Oe(".step-actions",[Oe("button.secondary",{onclick:()=>{e.goto(e.stepIndex,"watch")}},"Watch Video Again"),e.isLastStep()?Oe(gJ):Oe("button",{onclick:()=>{e.goto(e.stepIndex+1,"watch")}},"Next ")])])}},gJ=()=>{let e=!1;const t=async()=>{if(e)return;e=!0,await va.storageUpdate({hasCompletedIntroSequence:!0});const t=await Oj.snapshotPayload();await Oj.storage.saveCopy(t)?(Oj.closeGettingStartedSequence(),jT.showBasic({type:"info",message:"You made a copy. Your changes will now save to your account."})):(e=!1,Oe.redraw())};return{view:()=>Oe("button",{onclick:t,disabled:e,classNames:{secondary:e}},e?"Saving":"Finish ")}},vJ={view:()=>Oe(yU,{icon:"warning"},"Note: you'll need a larger window (720px or more) to do the interactive steps.")},yJ={view:()=>Oe("svg#global-svg-patterns",{style:{width:0,height:0,position:"absolute",top:"-1000px"}},[Oe("defs",[Oe("pattern",{id:"alpha-background-checkerboard",x:0,y:0,width:8,height:8,patternUnits:"userSpaceOnUse"},[Oe("rect",{width:8,height:8,fill:"white"}),Oe("rect",{width:4,height:4,fill:"#DDDDDD"}),Oe("rect",{x:4,y:4,width:4,height:4,fill:"#DDDDDD"})])])])},bJ={view({attrs:{node:e,modifier:t,index:n}}){const i=new sS(e,t),r=Oj.traceForNode(e),s=null==r?void 0:r.modifiers.find(e=>e.source===t),o=s&&!s.isSuccess();return Oe(".modifier-badge",{onpointerover:e=>{0===e.buttons&&(e.stopPropagation(),Oj.project.selectableExistsAndIsValid(i)&&(Oj.project.hoveredItem=i))},onpointerdown:e=>{e.stopPropagation(),_A(e,{cursor:()=>"grabbing",onConsummate(){let e;e=Oj.project.selection.contains(i)?Oj.project.selection.directlySelectedInstances().mutables():new hS([i]),e.isEmpty()||(Oj.modifierReorder={selectableInstances:e.items})},onUp(){const{modifierReorder:e}=Oj;if((null==e?void 0:e.hoveredInsertionNode)&&void 0!==e.hoveredInsertionIndex){let{hoveredInsertionNode:t,hoveredInsertionIndex:n}=e;for(let{node:i,instance:r}of e.selectableInstances){const e=i.source.modifiers.indexOf(r);i.source===t.source&&e<n&&n--,i.source.modifiers.splice(e,1)}t.source.modifiers.splice(n,0,...e.selectableInstances.map(e=>e.instance)),Oj.project.selectItems(e.selectableInstances.map(({instance:e})=>new sS(t,e)))}Oj.modifierReorder=null},onCancel(){Oj.modifierReorder=null,e.shiftKey?Oj.project.toggleSelectItem(i):Oj.project.selectItem(i)}})},className:eo({selected:Oj.project.selection.contains(i),"selected-indirect":Oj.project.selection.isInstanceIndirectlySelected(i.instance),hovered:Oj.project.isItemHovered(i),disabled:!t.isEnabled,error:o})},[Oe(wJ,{where:"before",insertionNode:e,insertionIndex:n}),Oe(".modifier-badge-pill",[t.definition instanceof Nb&&void 0!==t.definition.icon?Oe(".modifier-badge-icon",Oe(Jo,{icon:t.definition.icon})):null,Oe(".modifier-badge-name",t.definition.name)]),Oe(wJ,{where:"after",insertionNode:e,insertionIndex:n+1})])}},wJ={view({attrs:{where:e,insertionNode:t,insertionIndex:n}}){var i;if(!Oj.modifierReorder)return null;const r=eo({hovered:(null==(i=Oj.modifierReorder.hoveredInsertionNode)?void 0:i.equalsNode(t))&&Oj.modifierReorder.hoveredInsertionIndex===n,[e]:!0});return Oe(".outline-modifier-reorder-hit-target",{className:r,onpointerenter:()=>{Oj.modifierReorder&&(Oj.modifierReorder.hoveredInsertionNode=t,Oj.modifierReorder.hoveredInsertionIndex=n)},onpointerleave:()=>{Oj.modifierReorder&&(Oj.modifierReorder.hoveredInsertionNode=void 0,Oj.modifierReorder.hoveredInsertionIndex=void 0)}})}},xJ=(e,t,n)=>{const i=new sS(e,t);return{onpointerover:e=>{0===e.buttons&&(e.stopPropagation(),Oj.project.selectableExistsAndIsValid(i)&&(Oj.project.hoveredItem=i))},onpointerdown:e=>{e.stopPropagation(),e.shiftKey?Oj.project.toggleSelectItem(i):Oj.project.selectItem(i)},className:eo({selected:Oj.project.selection.contains(i),"selected-indirect":Oj.project.selection.isInstanceIndirectlySelected(i.instance),hovered:Oj.project.isItemHovered(i),disabled:!i.instance.isEnabled,error:n})}},CJ={view({attrs:{node:e}}){var t,n,i;const r=Oj.traceForNode(e);if(!r)return;const{transform:s,fill:o,stroke:a}=r;let l,c,h;return(null==(t=e.source.transform)?void 0:t.isEnabled)&&(l=Oe(".badge.transform",{...xJ(e,e.source.transform,!(null==s?void 0:s.isSuccess())),title:"Transform"},Oe(Jo,{icon:"outline_transform"}))),(null==(n=e.source.fill)?void 0:n.isEnabled)&&(c=SJ(e,e.source.fill,o)),(null==(i=e.source.stroke)?void 0:i.isEnabled)&&(h=kJ(e,e.source.stroke,a)),l||c||h||!(e.source.modifiers.length<1)?[l,c,h,e.source.modifiers.map((t,n)=>Oe(bJ,{node:e,modifier:t,index:n}))]:void 0}},SJ=(e,t,n)=>{var i,r,s,o;const a=!n||!n.isSuccess(),l=xJ(e,t,a);if(n){const e=null==(i=n.args.type)?void 0:i.evaluationResult;if("color"===e){const e=null==(r=n.args.color)?void 0:r.evaluationResult;if("none"===e)return Oe(".badge",{...l,title:"Fill None"},Oe(Jo,{icon:"outline_fill_none"}));if(e instanceof Gn){let t="outline_fill";return 1===e.r&&1===e.g&&1===e.b&&1===e.a&&(t="outline_fill_white"),Oe(".badge",{...l,title:"Fill",style:{color:e.toCSSString()}},Oe(Jo,{icon:t}))}}if("image"===e){const e=null==(s=n.args.image)?void 0:s.evaluationResult;if(Ys(e)){let t=1;const i=null==(o=n.args.opacity)?void 0:o.evaluationResult;return Ks(i)&&(t=St(i)),Oe(".badge",{...l,title:"Fill",style:{color:"transparent"}},[Oe(Jo,{icon:"outline_fill"}),Oe(".image-fill",{style:{backgroundImage:`url("${br(ec(e))}")`,opacity:t}})])}}}return Oe(".badge",{...l,title:"Fill"},Oe(Jo,{icon:"outline_fill"}))},kJ=(e,t,n)=>{var i;const r=!n||!n.isSuccess(),s=xJ(e,t,r);if(n){const e=null==(i=n.args.color)?void 0:i.evaluationResult;if("none"===e)return Oe(".badge",{...s,title:"Stroke None"},Oe(Jo,{icon:"outline_stroke_none"}));if(e instanceof Gn){let t="outline_stroke";return 1===e.r&&1===e.g&&1===e.b&&1===e.a&&(t="outline_stroke_white"),Oe(".badge",{...s,title:"Stroke",style:{color:e.toCSSString()}},Oe(Jo,{icon:t}))}}return Oe(".badge",{...s,title:"Stroke"},Oe(Jo,{icon:"outline_stroke"}))},LJ={view(e){var t;const{node:n}=e.attrs,i=n.source,{project:r}=Oj;Ps(r.focus instanceof CC);const s=r.isNodeExpanded(n),o=!s&&r.selection.allNodes().items.some(e=>n.isAncestorOfNode(e.node)),a=r.selection.isNodeDirectlySelected(n),l=!a&&r.selection.isNodeIndirectlySelected(n),c=!n.hasChildNodes(),h=!s&&!n.canAddChildren(),u=Oj.traceForNode(n),d=Boolean(u&&(s?!u.isSuccess():!u.isAllSuccess())),p=eo({expanded:s,childless:c,"hide-expander":h,selected:a,focused:n.equalsNode(r.focus.node),"selected-indirect":l,"hides-selection":o,hovered:Oj.project.isNodeHovered(n),dragging:null==(t=Oj.outlineReorder)?void 0:t.nodes.some(e=>e.equalsNode(n)),error:d});return Oe(".outline-item",{onpointerdown:e=>{const t=co(e),i=ho(e),s=e.shiftKey,o=e.ctrlKey||e.metaKey;if(i)return Oj.project.selection.isNodeDirectlySelected(n)||Oj.project.selectNode(n),void mW(e);_A(e,{cursor:()=>"grabbing",onConsummate(){let e;e=Oj.project.selection.isNodeDirectlySelected(n)?Oj.project.selection.directlySelectedNodes().sortInDocumentOrder().mutables():new hS([new rS(n)]),e.isEmpty()||(Oj.outlineReorder={nodes:e.toNodes()})},onUp(){const{outlineReorder:e}=Oj;if(null==e?void 0:e.hoveredInsertionParent){const t=r.reparentNodes(e.nodes,e.hoveredInsertionParent,e.hoveredInsertionIndex);t&&Oj.project.selectNodes(t)}Oj.outlineReorder=null},onCancel(){if(Oj.outlineReorder=null,s)(e=>{const t=Oj.project,n=t.selection.directlySelectedNodes();if(n.isEmpty())return void t.selectNode(e);if(n.isMultiple())return void t.toggleSelectNode(e);const i=n.items[0].node,r=i.parent;if(!r.equalsNode(e.parent))return void t.toggleSelectNode(e);let s=i.indexInParent(),o=e.indexInParent();s>o&&([s,o]=[o,s]);const a=r.childNodes().slice(s,o+1);t.selectNodes(a)})(n);else{if(!o)return t&&n.hasChildNodes()&&!n.isImmutableChildren()?(Oj.project.clearSelection(),void Oj.project.focusNode(n)):void Oj.project.selectNode(n);Oj.project.toggleSelectNode(n)}}})},onpointerover:e=>{0===e.buttons&&Oj.project.nodeExists(n)&&(Oj.project.hoveredItem=new rS(n))},onpointerleave:()=>{Oj.project.hoveredItem=null},class:p},[Oe(wJ,{where:"inside",insertionNode:n,insertionIndex:n.source.modifiers.length}),Oe(cY,{expanded:s,onpointerdown:e=>{e.stopPropagation(),Oj.project.toggleExpandedNode(n)}}),Oe(".outline-item-main",[Oe("span.outline-item-name",[n.isImmutable()?i.name:Oe(MV,{value:i.name,onchange:e=>{Oj.project.renameElement(n.source,e)}})]),BS.showMemoizationInOutline?Oe(MJ,{node:n}):null,Oe(CJ,{node:n})]),Oe(".extra",[Oe(ea,{icon:"show-all-as-guides"===i.guidesDisplay?"all_guides":"hide"===i.guidesDisplay?"hide_guides":"show_guides",label:"show-all-as-guides"===i.guidesDisplay?"Show Shapes As Guides":"Show Guides",onpointerdown:e=>{e.stopPropagation(),n.isImmutable()||(i.guidesDisplay="show"===i.guidesDisplay?"show-all-as-guides":"show")},className:eo({"extra-hidden":"show"===i.guidesDisplay})}),Oe(ea,{icon:i.isLocked?"locked":"unlocked",label:i.isLocked?"Locked":"Unlocked",onpointerdown:e=>{e.stopPropagation(),n.isImmutable()||(i.isLocked=!i.isLocked)},className:eo({"extra-hidden":!i.isLocked})}),Oe(ea,{icon:i.isVisible?"visible":"invisible",label:i.isVisible?"Visible":"Hidden",onpointerdown:e=>{e.stopPropagation(),n.isImmutable()||(i.isVisible=!i.isVisible)},className:eo({"extra-hidden":i.isVisible})})])])}},EJ={view({attrs:{node:e}}){const t=Oj.project.isNodeExpanded(e),n=eo({"reorder-parent":Oj.outlineReorder&&Oj.outlineReorder.hoveredInsertionParent&&Oj.outlineReorder.hoveredInsertionParent.equalsNode(e)}),i=e.parent;return Oe(".outline-node",{class:n},[Oe(TJ,{where:"after",insertionParent:i,insertionIndex:e.indexInParent()}),!t&&e.canAddChildren()?Oe(TJ,{where:"inside",insertionParent:e,insertionIndex:e.childCount()}):void 0,Oe(LJ,{node:e}),t?Oe(PJ,{node:e}):void 0])}},PJ={view({attrs:{node:e}}){const t=e.childNodes();if(0==t.length)return;t.reverse();const n=eo({"new-context":e.createsNewContext(),"within-focus":Oj.project.isNodeFocused(e)});return Oe(".outline-children",{class:n},[t.map(e=>Oe(EJ,{node:e})),Oe(TJ,{where:"before",insertionParent:e,insertionIndex:t.length})])}},TJ={view({attrs:{where:e,insertionParent:t,insertionIndex:n}}){var i,r,s;if(!Oj.outlineReorder)return;if(t.isImmutableChildren()||t.isImmutable())return;if(Oj.outlineReorder.nodes.some(e=>e.equalsNode(t)||e.isAncestorOfNode(t)))return;if(1===Oj.outlineReorder.nodes.length){const e=Oj.outlineReorder.nodes[0];if(e.hasParentEqualToNode(t)){const t=e.indexInParent();if(n===t||n===t+1)return}}const o=eo({hovered:(null==(r=null==(i=Oj.outlineReorder)?void 0:i.hoveredInsertionParent)?void 0:r.equalsNode(t))&&(null==(s=Oj.outlineReorder)?void 0:s.hoveredInsertionIndex)===n,[e]:!0});return Oe(".outline-reorder-hit-target",{className:o,onpointerenter:()=>{Oj.outlineReorder&&(Oj.outlineReorder.hoveredInsertionParent=t,Oj.outlineReorder.hoveredInsertionIndex=n)},onpointerleave:()=>{Oj.outlineReorder&&(Oj.outlineReorder.hoveredInsertionParent=void 0,Oj.outlineReorder.hoveredInsertionIndex=void 0)}})}},AJ={view({attrs:{heightFactor:e}}){const t=Oj.project.topNode();if(!t)return;const n=eo({reordering:null!==Oj.outlineReorder}),i=`flex-basis: ${(100*e).toFixed(3)}vh`;return Oe(".outline.scrollable",{className:n,style:i,onpointerdown:e=>{if(e.target.classList.contains("outline")){const t=Oj.project;Ps(t.focus instanceof CC),t.clearSelection(),co(e)&&t.focus.node.parent&&t.focusNode(t.focus.node.parent)}}},[Oe(PJ,{node:t})])}},MJ={view({attrs:{node:e}}){const t=Oj.traceForNode(e);if(!t)return;const n=Oj.evaluateElementMemoizer.findEntryForTrace(t);if(!n)return;const i=Oj.evaluateElementMemoizer.entriesComputedLastFrame.has(n);return Oe("span",{style:{padding:"0 6px 0 2px",borderRadius:"40px",...i?{backgroundColor:"red"}:{transition:"background-color 0.5s",backgroundColor:"transparent"}},onclick:()=>{}},"")}},IJ={view:function({children:e}){return Na.isMinisite()?Oe(Da,e):Oe(Ta,{className:"read-only"},e)},oncreate:function(){var e,t;null==(e=document.querySelector("html"))||e.classList.add("read-only"),null==(t=document.querySelector("body"))||t.classList.add("read-only")},onremove:function(){var e,t;null==(e=document.querySelector("html"))||e.classList.remove("read-only"),null==(t=document.querySelector("body"))||t.classList.remove("read-only")}},_J=["PDF Only","PDF and SVG"],OJ={view({attrs:{settings:e}}){let t=null;const n=Oj.storage.getProjectForkedFrom();n&&(t=Oe(".project-settings-comment",["Remixed from ",Oe("a",{href:hr+Co(n),target:"_blank"},n.name)," by ",Oe("u",n.owner)]));const i=`Decimal (${CH(.1,e.units,"decimal")})`,r=`Fractional (${CH(.125,e.units,"fractional")})`;return Oe(".project-settings",[Oe(kU,{value:Oj.storage.getProjectName(),editable:Oj.storage.hasWritePermission(),onchange:e=>Oj.storage.setProjectName(e)}),Oe(".editor-form",[t,Oe("h2","Project Settings"),Oe(".editor-form-key-values",[Oe(".editor-form-key","Units"),Oe(".editor-form-value",[Oe(eH,{options:Zr.map(e=>qr[e]),selected:qr[Oj.project.settings.units],onchange:e=>{const t=es(e);Oj.deviceStorage.projectUnits=t,Oj.project.settings.units=t}})]),Oe(".editor-form-key","Grid Divisions"),Oe(".editor-form-value",[Oe(eH,{options:[i,r],selected:"fractional"===e.gridDivisions?r:i,onchange:t=>{e.gridDivisions=t===r?"fractional":"decimal"}})])]),Oe("h2","Export Settings"),Oe(".editor-form-key-values",[Oe(".editor-form-key",`Hairline Stroke Width (${qr[Oj.project.settings.units]})`),Oe(".editor-form-value",[Oe(cB,{value:String(Oj.project.settings.hairlineStrokeWidth),onchange:e=>{Oj.project.settings.hairlineStrokeWidth=parseFloat(e)}})]),Oe(".editor-form-comment",["Hairline strokes will always appear thin in the Cuttle interface. This setting controls the ",Oe("em","exported")," stroke width of hairlines. Some laser cutters are strict about stroke widths that they recognize as cut paths."]),Oe(".editor-form-key","Rasterize Images"),Oe(".editor-form-value",[Oe(eH,{options:_J,selected:_J[Oj.project.settings.rasterizeExportedImages?1:0],onchange:e=>{Oj.project.settings.rasterizeExportedImages=e===_J[1]}})]),Oe(".editor-form-comment",["Removes transforms from all images and re-renders them at a fixed resolution. This setting is suggested when exporting images for laser engraving."]),Oe(".editor-form-key","Rasterizing Resolution (pixels per inch)"),Oe(".editor-form-value",[Oe(cB,{value:String(Oj.project.settings.rasterizeExportedImagesPixelsPerInch),onchange:e=>Oj.project.settings.rasterizeExportedImagesPixelsPerInch=parseFloat(e)})]),Oe(".editor-form-comment",["When rasterizing, images will be resampled at this resolution."])])])])}},NJ={view({attrs:{toolName:e,icon:t,tooltip:n,accelerator:i}}){var r,s;const o=null==(s=(r=Oj.tools[e]).isDisabled)?void 0:s.call(r),a=eo({disabled:o,active:Oj.activeToolName===e});return Oe(Zo,{message:()=>[n,i&&Oe("span.tooltip-accelerator",i.toString())]},[Oe(`.tool-button.${e}`,{className:a,onclick:o?void 0:t=>{t.stopPropagation(),t.stopImmediatePropagation(),Oj.activateTool(e)}},Oe(Jo,{icon:t}))])}},DJ={view({attrs:{icon:e,isActive:t,tooltip:n,accelerator:i,onclick:r,className:s}}){let o=eo({active:t});return s&&(o+=" "+s),Oe(Zo,{message:()=>[n,i&&Oe("span.tooltip-accelerator",i.toString())]},[Oe(".tool-button",{className:o,onclick:r},Oe(Jo,{icon:e}))])}},RJ={view:()=>Oe(".viewport-top-bar",[Oe(".toolbar-left"),Oe(".toolbar",[Oe(NJ,{toolName:"Select",icon:"select",tooltip:"Select",accelerator:new qj("v")}),Oe(NJ,{toolName:"Pen",icon:"pen",tooltip:"Pen",accelerator:new qj("p")}),Oe(".divider"),Oe(NJ,{toolName:"Rotate",icon:"rotate",tooltip:"Rotate",accelerator:new qj("r")}),Oe(NJ,{toolName:"Scale",icon:"scale",tooltip:"Scale Uniform",accelerator:new qj("s")}),Oe(NJ,{toolName:"Scale 1D",icon:"scale_linear",tooltip:"Scale Stretch"}),Oe(".divider"),Oe(DJ,{icon:"grid_snap",tooltip:"Grid Snapping",isActive:Oj.deviceStorage.gridSnappingEnabled,accelerator:new qj("g"),onclick:()=>Oj.deviceStorage.gridSnappingEnabled=!Oj.deviceStorage.gridSnappingEnabled}),Oe(DJ,{icon:"geometry_snap",isActive:Oj.deviceStorage.geometrySnappingEnabled,tooltip:"Geometry Snapping",accelerator:new qj("u"),onclick:()=>Oj.deviceStorage.geometrySnappingEnabled=!Oj.deviceStorage.geometrySnappingEnabled})]),Oe(".toolbar-right")])};let FJ,BJ=!1;const VJ={view:function(e){const t=eo({active:BJ});return Oe("button.menu-button",{className:t,onclick:()=>{const t=uo(e);FJ=Vo({spawnFrom:t,view:()=>Oe(jJ),className:"top-menu-small-popup",placement:"bottom-start",onclose:()=>{BJ=!1}}),BJ=!0}},[Oe(".menu-button-icon",Oe(Jo,{icon:"hamburger"})),Oe(".menu-button-label",Oj.storage.getProjectName())])}},jJ={view:function(e){const t=Oj.project.focusedDocumentation(),n=Oj.project.focusedComponent(),i=eo({active:Boolean(t)});return[Oe("a.menu-small-item",{href:"/",target:"_top"},[Oe(".menu-small-item-icon",Oe(Jo,{icon:"cuttle_logo"})),Oe(".menu-small-item-label","About Cuttle")]),Oe(".menu-small-separator"),Oe(".menu-small-item",{className:i,onclick:()=>{Oj.project.focusItem(Oj.project.documentation),null==FJ||FJ.close()}},[Oe(".menu-small-item-icon",Oe(Jo,{icon:"doc"})),Oe(".menu-small-item-label",Oj.project.documentation.name)]),Oe(".menu-small-separator"),...Oj.project.components.map(e=>{var t;const i=null==(t=Oj.tracesByDefinition.get(e))?void 0:t.result,r=eo({active:n===e});return Oe(".menu-small-item",{className:r,onclick:()=>{Oj.project.focusItem(e),Oj.zoomViewportToFitAll(),qT(),null==FJ||FJ.close()}},[Oe(".menu-small-item-icon",Oe(YW,{graphic:i,width:20,height:20,padding:2})),Oe(".menu-small-item-label",e.name)])})]}},HJ={oninit:()=>{Oj.storage.refreshSnapshots()},view:()=>{const e=Oj.storage.getSnapshots();let t;if(e){const n=e.filter(e=>!e.isAutosave);n.sort((e,t)=>js(t.lastModified).valueOf()-js(e.lastModified).valueOf());const i=e.filter(e=>e.isAutosave);i.sort((e,t)=>js(t.lastModified).valueOf()-js(e.lastModified).valueOf()),t=[Oe(".version-history-section",[Oe(".version-history-section-name","Saved Versions"),Oe(".version-history-section-description","A saved version is created every time you export, print, publish, or explicitly save a version of your project."),n.map(e=>Oe(UJ,{snapshot:e}))]),Oe(".version-history-section",[Oe(".version-history-section-name","Auto-saves"),Oe(".version-history-section-description","An auto-save is created for each editing session."),i.map(e=>Oe(UJ,{snapshot:e}))])]}else t="Loading...";return Oe(".version-history",[Oe(".version-history-header",[Oe(".version-history-header-name","Version History"),Oe(ea,{icon:"x",onpointerdown:()=>Oj.isVersionHistoryOpen=!1})]),Oe(".version-history-scroller",t)])}},UJ={view(e){const{attrs:{snapshot:t}}=e,n=js(t.lastModified).fromNow(),i=t.isAutosave?"Auto-save":t.name,r=Oj.storage.getCurrentSnapshotId()===t.snapshotId,s=Oj.storage.getPublishedSnapshotId()===t.snapshotId,o=!r,a=!r&&!s,l=eo({"version-history-current":r});let c=[Oe(".version-history-name",[i,s?Oe(".version-history-badge","Published"):null])];t.isAutosave||c.push(Oe(".version-history-description",[Oe(zJ,{value:t.description,onchange:e=>{Oj.storage.updateSnapshotDescription(t.snapshotId,e)}})]));const h=async()=>{if(!o)return;const e=await Oj.storage.restoreSnapshot(t.snapshotId);if(e){const t=Oj.storage.getProjectId();Oj.loadProjectSnapshot(e,t),Oj.storage.refreshSnapshots(),Oj.checkpointAfterNextEvaluation(),Oe.redraw()}},u=[{label:"Restore this version",action:h,enabled:()=>o},{type:"separator"},{label:"Delete this version",action:async()=>{a&&await Oj.storage.deleteSnapshot(t.snapshotId)},enabled:()=>a}];return Oe(".version-history-snapshot",{className:l},[Oe(".version-history-extra",[o&&Oe("button",{onclick:h},"Restore"),Oe(ea,{icon:"dotdotdot",className:"version-history-dotdotdot",onpointerdown:()=>{const t=uo(e).querySelector(".version-history-dotdotdot");Wo({menuItems:u,spawnFrom:t,placement:"bottom-end"})}})]),Oe("img.version-history-preview",{src:t.previewImage}),c,Oe(".version-history-date",n)])}},zJ=()=>{let e=!1;return{view:({attrs:{value:t,onchange:n}})=>Oe(".editable-comment",[e?Oe(EW,{value:t,initialSelection:{start:0,end:0},onchange:n,onblur:()=>e=!1}):[Oe(".editable-comment-value",t),Oe(".editable-comment-edit",{onclick:()=>e=!0},WJ(t)?"Add Description":"Edit Description")]])}},WJ=e=>!e||!/[^\s]/.test(e),GJ={view(){var e;const t=Oj.project.focusedComponent();if(!t)return;const n=Oj.traceForComponent(t);if(!n)return;const i=null==(e=n.result)?void 0:e.boundingBox();if(!i)return;const r=Oj.viewportManager.viewportForComponent(t).worldBoundingBox(Oj.canvasDimensions);if(0===r.area())return;const s=Math.max(i.width()/r.width(),i.height()/r.height());return(s>0&&s<.004||s>20||!r.overlapsBoundingBox(i))&&Oe("button.zoom-hint",{onclick:()=>Oj.zoomViewportToFitAll()},[Oe(".zoom-hint-thumbnail",Oe(YW,{graphic:n.result,width:96,height:96,padding:8})),Oe(".zoom-hint-label","Reset Zoom")])}};window.addEventListener("keydown",e=>{if("Alt"===e.key)Oj.isAltDown=!0;else if("Shift"===e.key)Oj.isShiftDown=!0;else if("Control"===e.key)Oj.isControlDown=!0;else if("Meta"===e.key)Oj.isMetaDown=!0;else if(" "===e.key){if(e.ctrlKey||e.altKey||e.metaKey)return;Oj.isSpaceDown=!0}},!0),window.addEventListener("keyup",e=>{"Alt"===e.key?Oj.isAltDown=!1:"Shift"===e.key?Oj.isShiftDown=!1:"Control"===e.key?Oj.isControlDown=!1:"Meta"===e.key?Oj.isMetaDown=!1:" "===e.key&&(Oj.isSpaceDown=!1)},!0),window.addEventListener("keydown",e=>{var t,n;ro(e)||(e=>{if(ro(e))return!1;if(so(e)&&!(to()?e.metaKey:e.ctrlKey))return!1;for(let{accelerator:t,action:n}of Kj)if(t.matchesEvent(e))return e.preventDefault(),n(),Oe.redraw(),!0})(e),io()||Oj.project.hasFocusedComponent()&&(null==(n=(t=Oj.ensureEnabledActiveTool()).onKeyDown)||n.call(t,e)),Oe.redraw()}),window.addEventListener("keyup",e=>{Oe.redraw()}),window.addEventListener("keydown",e=>{var t;"Shift"!==(t=e.key)&&"Alt"!==t&&"Control"!==t&&"Meta"!==t&&Gj()},!0),window.addEventListener("pointerdown",()=>Oj.checkpointAfterNextEvaluation(),!0),window.addEventListener("pointerup",()=>Oj.checkpointAfterNextEvaluation(),!0),document.addEventListener("cut",()=>Oj.checkpointAfterNextEvaluation()),document.addEventListener("paste",()=>Oj.checkpointAfterNextEvaluation()),window.addEventListener("wheel",Gj,!0),window.addEventListener("gesturestart",Gj,!0),window.addEventListener("gesturechange",Gj,!0),window.addEventListener("gestureend",Gj,!0),/Macintosh|iPad|iPhone|iPod/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>1&&!window.MSStream&&(()=>{let e=document.querySelector("meta[name=viewport]");if(e){let t=e.getAttribute("content"),n=/maximum\-scale=[0-9\.]+/g;t=t&&n.test(t)?t.replace(n,"maximum-scale=1.0"):[t,"maximum-scale=1.0"].join(", "),e.setAttribute("content",t)}else e=document.createElement("meta"),e.setAttribute("name","viewport"),e.setAttribute("content","maximum-scale=1.0"),document.querySelector("head").appendChild(e)})(),ef.subscribe(()=>Oe.redraw()),ql.subscribe(()=>Oe.redraw()),oc.subscribe(()=>Oe.redraw()),aL.subscribe(()=>Oe.redraw()),window.addEventListener("resize",()=>Oe.redraw());const $J=()=>{const e=e=>e.preventDefault(),t=async()=>{"visible"===document.visibilityState&&(Oj.isFirstRedrawAfterBecameVisible=!0,Oe.redraw(),await va.refreshLoggedInUser(),Oe.redraw())};return{oninit(){RT()&&Yj(new qj("1",{shift:!0,command:!0}),MW)},oncreate(){document.addEventListener("visibilitychange",t)},onupdate(){Oj.isFirstRedrawAfterBecameVisible=!1},view(){Oj.project.hasFocusedComponent()&&Oj.ensureEnabledActiveTool(),Oj.updateEvaluation();const t=Oj.storage.getAccessError();if(t)return Oe(XJ,{accessError:t});const n=Oj.project.focusedComponent(),i=Oj.project.focusedDocumentation(),r=new DOMRect(0,0,window.innerWidth,window.innerHeight),s=r.width<700,o=s?32:28,a=s?0:200,l=s?0:Math.min(Oj.deviceStorage.rightSidebarWidth,r.width-330-200),c=new It(Math.max(0,r.width-a-l),r.height-o);Oj.canvasRectPixels=new DOMRect(a,o,c.x,c.y);const h=new De(new It(wH,wH+(s?0:44)),c),u=new ik(c,h);let d;if(Oj.canvasDimensions=u,n)if(s)d=Oe(SX,{component:n,canvasDimensions:u,zoomViewport:!0});else{const e=Oj.viewportManager.viewportForComponent(n);d=[Oe(zW,{viewport:e,canvasDimensions:u}),n&&Oe(RJ),Oe(GJ)]}else if(i){const e=Oj.storage.hasWritePermission()&&Oj.isEditingMode();d=Oe(oJ,{doc:i.doc,editable:e,onchange:t=>{i&&e&&(i.doc=t,Oj.checkpointAfterNextEvaluation())}})}else Oj.project.focus instanceof LC&&(d=Oe(OJ,{settings:Oj.project.focus.settings}));d=Oe(".viewport",d);if(!Oj.isEditingMode())return[Oe(IJ,d),Oe(UT)];return Oe(".app",{oncontextmenu:e},Oe(Pa,[Oe(tj),Oe(yJ),s?[Oe(".panel-top-small",[Oe(VJ)]),Oe(".main",d)]:[Oe(".panel-top",[Oe(CW,{rightPanelWidth:l})]),Oe(".main",[Oe(".panel-left",Oe(tG)),d,(n||Oj.isVersionHistoryOpen)&&Oe(".panel-right",{style:{width:l+"px"}},[Oe(qJ,{rightPanelWidth:l}),Oe(ZJ,{component:n})])])],Oe(BW),Oe(UT),Oj.gettingStartedState&&Oe(dJ,{gettingStartedState:Oj.gettingStartedState,isSmallWindow:s}),Oe(hJ),Oe(nj),Pr()&&!Oj.debug_hideInfoInspector&&Oe(YJ)]))}}},ZJ={view:({attrs:{component:e}})=>Oj.isVersionHistoryOpen?Oe(HJ):e?Oe(yL,{className:"outline-inspector",view:t=>e instanceof yb?Oe(yX,{component:e}):[Oe(AJ,{heightFactor:Oj.deviceStorage.rightSidebarSplit}),Oe(".outline-inspector-divider",Oe(KJ,{rect:t})),Oe(yX,{component:e,heightFactor:1-Oj.deviceStorage.rightSidebarSplit})]}):void 0},qJ={view({attrs:{rightPanelWidth:e}}){if(Oj.outlineReorder)return null;return Oe(".panel-right-resizer",{onpointerdown:t=>{const n=t.clientX,i=e;_A(t,{cursor:()=>"ew-resize",onMove(e){const t=e.clientX-n;Oj.deviceStorage.rightSidebarWidth=Math.max(170,Math.round(i-t))}})}})}},KJ={view({attrs:{rect:e}}){if(Oj.outlineReorder)return null;return Oe(".outline-inspector-resizer",{onpointerdown:t=>{const n=t.clientY,i=e.height*Oj.deviceStorage.rightSidebarSplit;_A(t,{onMove(t){const r=t.clientY-n;Oj.deviceStorage.rightSidebarSplit=Ct((i+r)/e.height,.05,.95)},cursor:()=>"ns-resize"})}})}},YJ={view:()=>Oe(".debug-inspector",[Oe(".debug-inspector-name","DEBUG"),Oe(".debug-inspector-value",Oe(ea,{icon:"x",onclick:()=>Oj.debug_hideInfoInspector=!0})),Oe(".debug-inspector-name","Undo stack size"),Oe(".debug-inspector-value",Oj.editHistory.undoStack.length),Oe(".debug-inspector-name","Redo stack size"),Oe(".debug-inspector-value",Oj.editHistory.redoStack.length),Oe(".debug-inspector-name","Last difference"),Oe(".debug-inspector-value",Oj.debug_lastCheckpointDifference??"none"),Oe(".debug-inspector-name","Saved"),Oe(".debug-inspector-value",Boolean(Oj.debug_lastCheckpointSaved).toString()),Oe(".debug-inspector-name","Mid gesture"),Oe(".debug-inspector-value",Oj.isMidGesture()&&Array.from(Oj.gestureIds).map(e=>e.description+" "))])},XJ={view:({attrs:{accessError:e}})=>Oe(".project-error-message-private","refresh-to-update"===e?[Oe("p","You caught us during an update. "),Oe("p","Please refresh this page to load the newest version.")]:["private"===e?[Oe("p","This project is private."),Oe("p",'The owner of this project needs to change its share status to "Unlisted" or "Public" in order for you to view it.')]:[Oe("p","Page not found."),Oe("p",["If this seems like a bug, email ",Oe("a",{href:"mailto:support@cuttle.xyz"},"support@cuttle.xyz")," and we'll try to fix it!"])],Oe("p",[Oe("a",{href:"/explore",target:"_top"},"Explore public projects.")])])},JJ={oncreate(){window.addEventListener("message",e=>{const t=e.data;if(Js(t)){const{action:e}=t;if("setProjectParameter"===e){const{name:e,expressionCode:n}=t;if(Ys(e)&&Ys(n)){const t=Oj.project.parameterWithName(e);t&&(t.expression=new _b(n),Oe.redraw())}}}}),parent.postMessage({status:"ready"})},view(){Oj.updateEvaluation();const e=Oj.project.documentation.firstComponentEmbedIds()||[Oj.project.previewComponent().id];return 0===e.length?"Embed error: no component found.":Oe(".app-embed",Oe(Pa,[Oe(AX,{componentIds:e,hideActionsAndDimensions:!0,hideParameters:!0,hideRulers:!0})]))}};Wj("editor index.js"),Oe.route.set=(e,t,n)=>{window.location.href=e},Oe.route.Link={view:({attrs:e,children:t})=>Oe("a",e,t)},async function(){(()=>{const e=window.location.href,t=document.referrer,n=Io(),i=navigator.userAgent||"unknown";Ao("pageview",{url:e,referrer:t,device:n,userAgent:i}),_o()})(),Function.prototype.constructor=null,Object.defineProperty(async function(){}.constructor.prototype,"constructor",{value:null,configurable:!1,writable:!1}),Object.defineProperty(async function*(){}.constructor.prototype,"constructor",{value:null,configurable:!1,writable:!1}),Object.defineProperty(function*(){}.constructor.prototype,"constructor",{value:null,configurable:!1,writable:!1}),await async function(){js.extend(zj),await Ts(e=>ql.getImageFromURL(e))}(),Wj("pathkit"),document.head.appendChild(qL.element);const{projectId:e,edit:t,view:n,embed:i}=Sr(),r=await Oj.storage.init(e);if(r){const e=Oj.storage.getProjectId();Oj.loadProjectSnapshot(r,e),Oj.resetEditHistory()}if(i)return Oj.enterViewingMode(),Oe.mount(document.body,JJ),void Wj("mount app");Oj.initFocus({projectId:e,edit:t,view:n,embed:i}),"intro"===Oj.storage.sequenceToLoad()&&Oj.openGettingStartedSequence(),window.Cuttle=Nj,Oe.mount(document.body,$J),Wj("mount app")}();export{lE as J,rE as a,N as c,D as g};
